(()=>{function c(t,e){let a=t.createProgram();e.shaders.forEach((r,o)=>R(t,r,o,a,e)),t.linkProgram(a),t.useProgram(a),e.uniforms&&Object.keys(e.uniforms).forEach(r=>{let o=t.getUniformLocation(a,r),i=t[`uniform${e.uniforms[r]}`];e.uniforms[r]=e.uniforms[r].indexOf("atri")>-1?f=>i.call(t,o,!1,f):f=>i.call(t,o,...f)});let n=[_(t,a,"v",2,new Float32Array(e.vertices))];return e.draw=r=>{t.useProgram(a);let o=e.uniforms;r&&Object.keys(r).forEach(i=>o&&o[i]&&o[i](Array.isArray(r[i])?r[i]:[r[i]])),n.forEach(i=>i()),t.drawArraysInstanced(t.TRIANGLES,0,e.vertices.length/2,e.instances||1)},e}function R(t,e,a,n,r){let o=t.createShader(a?t.FRAGMENT_SHADER:t.VERTEX_SHADER);e=`#version 300 es
precision highp float;
`+(r.patch||"")+e,t.shaderSource(o,e),t.compileShader(o),t.attachShader(n,o)}function _(t,e,a,n,r){let o=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW);let i=t.getAttribLocation(e,a);return t.enableVertexAttribArray(i),()=>{t.bindBuffer(t.ARRAY_BUFFER,o),t.vertexAttribPointer(i,n,t.FLOAT,!1,0,0)}}function l(t,e,a,n){let r=innerWidth,o=innerHeight,i=r/o<a,f=t.style;t.width=i?r:o*a,t.height=i?r/a:o,f.width=t.width+"px",f.height=t.height+"px",f.margin=`${o/2-t.height/2}px 0 0 ${r/2-t.width/2}px`,t.width=t.width*n|0,t.height=t.height*n|0,e.viewport(0,0,t.width,t.height)}var d="in vec2 v;uniform float t;out vec2 uv;out vec2 UV;void main(){vec2 s=1./vec2(c,-r);float i=float(gl_InstanceID);uv=v/2.+0.5;UV=vec2(mod(i,c),floor(i/c));vec2 p=s*(v+1.+UV+UV)+vec2(-1,1);gl_Position=vec4(p,0,1);}";var x="out vec4 o;in vec2 uv;in vec2 UV;uniform float t;mat2 rotate(float a){float c=cos(a),s=sin(a);return mat2(c,s,-s,c);}float sdCircle(float x,float y,float r){return length(vec2(x,y))-r;}float sdBox(float x,float y,float w,float h){vec2 uv=vec2(x,y);uv=abs(uv)-vec2(w,h);return length(max(uv,0.))+min(max(uv.x,uv.y),0.);}float ss(float d){return smoothstep(0.,0.0001,d);}float xByIndex(float i){return sin(i)>0.?-.2:.3;}float rotByIndex(float i){return sin(i)*3.;}float rand(vec2 n){return fract(sin(dot(n,vec2(12.9898,4.1414)))*43758.5453);}float noise(float x,float y){vec2 p=vec2(x,y);vec2 ip=floor(p);vec2 u=fract(p);u=u*u*(3.0-2.0*u);float res=mix(mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);return res*res;}float picture(vec2 uv,float i,float t){float d=0.;d+=ss(sdBox(uv.x+sin(i*2.+1.)*0.1,(uv.y-0.05)*((uv.x+0.5)*sin(i)*0.15+1.),0.7,0.7/ir));float cx=sign(xByIndex(i))*0.4;float cy=0.;d+=ss(sdCircle(uv.x-cx,uv.y-cy,0.15))*2.;float ni=noise(-i*3.,t/3.);float ni2=noise(i*5.,-t/4.);d+=ss(sdCircle(uv.x-cx-0.3*ni,uv.y-cy-0.3*ni2,0.05))*2.;uv*=rotate(ni2);d+=ss(sdBox(uv.x-cx,uv.y-cy,0.2,0.02));d+=ss(sdBox(uv.x-0.74,uv.y,0.04,0.2));return d;}float pixelColor(vec2 uv){float d=0.;float flt=floor(t);float frt=fract(t);for(int i=0;i<5;i++)frt=smoothstep(0.,1.,frt);frt=pow(frt,2.);float scale=mix(1.,2.5,frt);uv/=scale;uv*=rotate(mix(0.,-rotByIndex(flt),frt));uv.x+=mix(0.,-xByIndex(flt),frt);uv.y+=mix(0.,0.05,frt);uv/=2.5;uv*=rotate(-rotByIndex(-1.+flt));uv.y-=-0.05;uv.x-=xByIndex(-1.+flt);for(float i=-1.;i<6.;i++){d+=picture(uv,i+flt,t);uv.x+=xByIndex(i+flt);uv.y+=-0.05;uv*=rotate(rotByIndex(i+flt));uv*=2.5;}return d-flt;}float ch(float s){float d=length((uv+vec2(0,s)-0.5)*vec2(1,2));vec2 st=(UV/vec2(c,r)-0.5)*vec2(ir,1);float l=pixelColor(st);l=mod(abs(l+99.),5.);if(l<1.)return 0.;if(l<2.)return smoothstep(0.3,0.2,d);if(l<3.)return smoothstep(0.2,0.1,abs(d-0.35));if(l<4.)return smoothstep(0.2,0.1,abs(uv.x-0.5))*smoothstep(0.5,0.4,abs(uv.y-0.5));return smoothstep(0.5,0.4,abs(uv.x-0.5))*smoothstep(0.5,0.4,abs(uv.y-0.5));;}void main(){vec2 p=UV/vec2(c,r)-0.5;float d1=max(0.,sin(t*13.+p.y*3.)-0.99)*20.;float d2=max(0.,sin(t*11.+p.y*3.)-0.99)*20.;float d3=0.;o=vec4(ch(d3-d1),ch(d3+d3),ch(d3+d2),1);o.a=max(o.r,max(o.g,o.b));}";var m="in vec2 v;void main(){gl_Position=vec4(v,0,1);}";var h="out vec4 o;uniform float opacity;void main(){o=vec4(0,0,0,opacity);}";var b=window.c,v=80,u=252,F=9/16,A=u/v*F,P=1.5,s=b.getContext("webgl2",{preserveDrawingBuffer:!0,alpha:!0});l(b,s,A,P);var w=[-1,-1,-1,1,1,-1,1,-1,-1,1,1,1],p=c(s,{vertices:w,instances:v*u,uniforms:{t:"1f"},shaders:[d,x],patch:`float c=${u}.,r=${v}.,ir=${A};
`}),B=c(s,{vertices:w,uniforms:{opacity:"1f"},instances:1,shaders:[m,h]}),y=requestAnimationFrame;s.enable(s.BLEND);s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA);B.draw({opacity:1});$fx.isPreview?p.draw({t:0}):y(function t(e){B.draw({opacity:.2}),p.draw({t:e/5e3}),y(t)});})();
