(()=>{function f(t,e){let a=t.createProgram();e.shaders.forEach((o,r)=>E(t,o,r,a,e)),t.linkProgram(a),t.useProgram(a),e.uniforms&&Object.keys(e.uniforms).forEach(o=>{let r=t.getUniformLocation(a,o),i=t[`uniform${e.uniforms[o]}`];e.uniforms[o]=e.uniforms[o].indexOf("atri")>-1?s=>i.call(t,r,!1,s):s=>i.call(t,r,...s)});let c=[I(t,a,"v",2,new Float32Array(e.vertices))];return e.draw=o=>{t.useProgram(a);let r=e.uniforms;o&&Object.keys(o).forEach(i=>r&&r[i]&&r[i](Array.isArray(o[i])?o[i]:[o[i]])),c.forEach(i=>i()),t.drawArraysInstanced(t.TRIANGLES,0,e.vertices.length/2,e.instances||1)},e}function E(t,e,a,c,o){let r=t.createShader(a?t.FRAGMENT_SHADER:t.VERTEX_SHADER);e=`#version 300 es
precision highp float;
`+(o.patch||"")+e,t.shaderSource(r,e),t.compileShader(r);let i=t.getShaderInfoLog(r);if(t.attachShader(c,r),i.length>0)throw console.log(e.split(`
`).map((s,R)=>`${1+R}`.padStart(4,"0")+": "+s).join(`
`)),i}function I(t,e,a,c,o){let r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,o,t.STATIC_DRAW);let i=t.getAttribLocation(e,a);return t.enableVertexAttribArray(i),()=>{t.bindBuffer(t.ARRAY_BUFFER,r),t.vertexAttribPointer(i,c,t.FLOAT,!1,0,0)}}function v(t,e,a,c){let o=innerWidth,r=innerHeight,i=o/r<a,s=t.style;t.width=i?o:r*a,t.height=i?o/a:r,s.width=t.width+"px",s.height=t.height+"px",s.margin=`${r/2-t.height/2}px 0 0 ${o/2-t.width/2}px`,t.width=t.width*c|0,t.height=t.height*c|0,e.viewport(0,0,t.width,t.height)}var m="in vec2 v;uniform float t;out vec2 uv;out vec2 UV;out float pixel;out vec3 dc;mat2 rotate(float a){float c=cos(a),s=sin(a);return mat2(c,s,-s,c);}float sdCircle(float x,float y,float r){return length(vec2(x,y))-r;}float sdBox(float x,float y,float w,float h){vec2 uv=vec2(x,y);uv=abs(uv)-vec2(w,h);return length(max(uv,0.))+min(max(uv.x,uv.y),0.);}float ss(float d){return smoothstep(0.,0.0001,d);}float xByIndex(float i){return sin(i)>0.?-.2:.3;}float rotByIndex(float i){return sin(i)*3.;}float rand(vec2 n){return fract(sin(dot(n,vec2(12.9898,4.1414)))*43758.5453);}float noise(float x,float y){vec2 p=vec2(x,y);vec2 ip=floor(p);vec2 u=fract(p);u=u*u*(3.0-2.0*u);float res=mix(mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);return res*res;}float picture(vec2 uv,float i,float t){float ni=noise(-i*3.+2.,t/3.);float ni2=noise(i*5.-2.,-t/4.);float d=0.;d+=ss(sdBox(uv.x+sin(i*2.+1.)*0.1,(uv.y-0.05)*((uv.x+0.5)*sin(i)*0.15+1.),0.7,0.7/ir));d+=ss(sdCircle(uv.x+ni2,uv.y-0.29,0.03))*2.;float cx=sign(xByIndex(i))*0.4+ni*0.1;float cy=ni2*0.2;d+=ss(sdCircle(uv.x-cx,uv.y-cy,0.15))*2.;d+=ss(sdCircle(uv.x-cx-0.3*ni,uv.y-cy-0.3*ni2,0.05))*2.;uv*=rotate(-cy);d+=ss(sdBox(uv.x-cx,uv.y-cy+0.05,0.015,0.2));uv*=rotate(ni2);d+=ss(sdBox(uv.x-cx,uv.y-cy,0.2,0.02));uv*=rotate(ni2-ni);d+=ss(sdBox(uv.x-0.74-cy,uv.y,0.04,0.2));return d;}float pixelColor(vec2 uv){float d=0.;float flt=floor(t);float frt=fract(t);for(int i=0;i<5;i++)frt=smoothstep(0.,1.,frt);frt=pow(frt,2.);float scale=mix(1.,2.5,frt);uv/=scale;uv*=rotate(mix(0.,-rotByIndex(flt),frt));uv.x+=mix(0.,-xByIndex(flt),frt);uv.y+=mix(0.,0.05,frt);uv/=2.5;uv*=rotate(-rotByIndex(-1.+flt));uv.y-=-0.05;uv.x-=xByIndex(-1.+flt);for(float i=-1.;i<6.;i++){d+=picture(uv,i+flt,t);uv.x+=xByIndex(i+flt);uv.y+=-0.05;uv*=rotate(rotByIndex(i+flt));uv*=2.5;}return d-flt;}void main(){vec2 s=1./vec2(c,-r);float i=float(gl_InstanceID);uv=v/2.+0.5;UV=vec2(mod(i,c),floor(i/c));vec2 st=(UV/vec2(c,r)-0.5)*vec2(ir,1);pixel=pixelColor(st);vec2 p=s*(v+1.+UV+UV)+vec2(-1,1);p.x+=0.1*(noise(t*111.,UV.y*13.)-0.5)*ss(max(0.,noise(t*4.,UV.y*10.)-0.98));p.x+=.2*(noise(t*1112.,p.y*3.)-0.5)*max(0.,noise(t,p.y)-0.7);gl_Position=vec4(p,0,1);dc=max(vec3(0),vec3(noise(t*13.,p.y*3.),noise(-t*11.,p.y*4.),noise(-t*22.,p.y*5.))-0.95)*10.;}";var h="out vec4 o;in vec2 uv;in vec2 UV;in float pixel;in vec3 dc;uniform float t;float ch(float s){vec2 st=(uv+vec2(0,s)-0.5)*vec2(1,2);float l=pixel;l=mod(abs(l+99.),5.);if(l<1.)return 0.;if(l<2.)return smoothstep(0.3,0.2,length(st));if(l<3.)return smoothstep(0.09,0.08,abs(length(st*vec2(1,0.5))-0.3));if(l<4.)return smoothstep(0.1,0.05,abs(uv.x-0.5))*smoothstep(0.51,0.5,abs(uv.y-0.5));return smoothstep(0.45,0.35,abs(uv.x-0.5))*smoothstep(0.5,0.4,abs(uv.y-0.5));;}void main(){vec2 p=UV/vec2(c,r)-0.5;o=vec4(ch(dc.z+dc.x),ch(dc.x+dc.y),ch(dc.z+dc.y),1);o.a=max(o.r,max(o.g,o.b));}";var p="in vec2 v;void main(){gl_Position=vec4(v,0,1);}";var y="out vec4 o;uniform float opacity;void main(){o=vec4(0,0,0,opacity);}";var d=window.c,u=80,l=252,L=9/16,x=l/u*L,w=1.5,n=d.getContext("webgl2",{preserveDrawingBuffer:!0,alpha:!0});v(d,n,x,w);addEventListener("resize",t=>v(d,n,x,w));var B=[-1,-1,-1,1,1,-1,1,-1,-1,1,1,1],A=f(n,{vertices:B,instances:u*l,uniforms:{t:"1f"},shaders:[m,h],patch:`float c=${l}.,r=${u}.,ir=${x};
`}),_=f(n,{vertices:B,uniforms:{opacity:"1f"},instances:1,shaders:[p,y]}),b=requestAnimationFrame;n.enable(n.BLEND);_.draw({opacity:1});$fx.isPreview?A.draw({t:2}):b(function t(e){n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),_.draw({opacity:.2}),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),A.draw({t:2+e/5e3}),b(t)});})();
