(()=>{var e,t,f,a,r,l,n=(e,t)=>({x:e,y:t}),c=Math,{abs:p,sin:d,cos:h,max:i,min:u,atan2:s,hypot:y}=c,m=c.PI,x=m/2,o=2*m,b=(e,t)=>[...Array(0|e)].map((e,f)=>t(f)),g=(e,t,f=1)=>b(e,a=>t(a/(e-1)*f)),F=(e=tokenData.hash,t=new Uint32Array([1,3,f=a=2,4].map(t=>((e,t,f)=>parseInt(e.substr(t,8),16))(e,8*t))),e=>(a=t[3],t[3]=t[2],t[2]=t[1],t[1]=f=t[0],t[0]^=(a^=a<<11)^a>>>8^f>>>19,t[0]/2**32)),v=(e=1,t=0)=>F()*e+t,w=(e=2,t=0)=>t+v(0|e)|0,D=(e=.5)=>v()>e,C=(e=1)=>v(e)-e/2,I=e=>w(4)*m/2,k=e=>e[w(e.length)],A="F2F1DFF2BD1DD94711591812181212#e8d5b9c07a38df3146f5b3490e2430#f3efeff7b32b0c6291b80c09091e05#f1faeee63946a8ccdc457b9d1d3557#dff3e4bca2cd7d73c6684da2171738#dccfa39f8f6544443bc6110f12130b#fff7f4ffc6c6ff2f4ec60a5f820a5f#faf1dcff871fb8000041764b29293d#ccc9a1f0ffcea53f2b60290e280004#ecf39e90a9554f772d31572c132a13#fdf0d5669bbcc1121f780000003049#e0fbfc98c1d9ee6c4d3d5a80293241#fbfffe96031a1b1b1e6d676efaa916#fffcf2ccc5b9503d39252422eb5e28#8ecae6219ebc023047ffb703fb8500#000000FFFFFFdddddd444444888888#ffffff375ba9000000d6d6d6fca311#f4ca55284862d6644a3a8acafffeef#C20F002374C6FFDD22ffffff000000".split("#").map(e=>e.match(/.{6}/g).map(e=>"#"+e)),E=.618,L=.5/E,M=w(5),N=[0,0,m/2,m/4,v(o)][M],P=w(19),R=(w(4),D(),D(.1)),$=D(),j=(k([0,1]),D()),B=w(3),H=D(),S=(e,t,f)=>e+(t-e)*f,U=(e,t)=>{let f=h(t),a=d(t);return n(e.x*f+e.y*a,-e.x*a+e.y*f)},W=(e,t,f=1)=>(e.x+=t.x*f,e.y+=t.y*f,e),Z=(e,t)=>n(h(e)*t,d(e)*t),q=(e,t)=>y(e.x-t.x,e.y-t.y),z=(e,t)=>s(t.y-e.y,t.x-e.x),G=(e,t,f)=>n(S(e.x,t.x,f),S(e.y,t.y,f)),J=(e,t,f,a)=>f.map(f=>W(Z(f,a(f)),{x:e,y:t})),K=(e,t,f,a)=>{let r=[];for(let l=e;l<t;l+=v(a,f))r.push(l);return r.push(t),r},O=(e,t,f)=>J(e,t,K(0,o,.03,.05),e=>f),Q=(e,t,f)=>U(n(e,t),f),T=(e,t,f)=>e.map(e=>W(e,{x:t,y:f})),V=(e,t,f,a,r=0)=>T([Q(-f,-a,-r),Q(f,-a,-r),Q(f,a,-r),Q(-f,a,-r)],e,t),X=(e,t,f,a)=>{let r=[],l=D(),c=a||w(4,2),p=v(1,.5),d=v(1.5,1.5);for(let e=0;e<c;e++){let t=e/c*f-f/2,a=C(p)*f,n=f/c/2*d*(l?v(.5,.5):1),h=v(p/3*2,p/3)*f;r.push(V(t,a,n,h*(D(.2)?1:4)))}let h=n(e,t),i=I()+N,u=w(2);return r.map(e=>{let t=u&&w(2)*x,f=i+t;return t&&u--,e.map(e=>U(e,f)).map(e=>W(e,h)).map(e=>$?n(e.x+C(.01),e.y+C(.01)):e)})},Y=(e,t,f)=>[...O(e,t,f),...O(e,t,f*v(.22,.55)).reverse()],_=(e,t,f,a,r=0)=>{let l=f/2,n=a/2;return T([Q(-f,-a,r=-r),Q(f,-a,r),Q(f,a,r),Q(-f,a,r),Q(-f,-a,r),Q(-l,-n,r),Q(-l,n,r),Q(l,n,r),Q(l,-n,r),Q(-l,-n,r)],e,t)},ee=(e,t,f)=>{let a=x+C(.2);return J(e,t+.1,K(0,o,.03,.05),e=>f*(h(e+a)**2+h(e+a)+3.5)*.2)},te=e=>e.reduce((t,f,a)=>t+f.x*(a=e[a+1]||e[0]).y-f.y*a.x,0)/2,fe=(e,t)=>({p:e,a:te(e)}),ae=(e,t)=>e[(t+1)%e.length],re=e=>e.map((t,f)=>[t,ae(e,f)]),le=(e,t,f)=>G(e,t,u(.5,f/q(e,t))),ne=(e,t,f)=>!(e-1e-7<=t&&t<=f+1e-7),ce=(e,t,f,a)=>{a&&e.push({...f},{...a}),t.push({...a||f})},pe=(e,t)=>{let f=[],a=[],r=0;return((e,t)=>{re(e).map(t)})(e,e=>{let l=(([e,t],[f,a])=>((e,t,f,a,r,l,n,c)=>{let p=e*a-t*f,d=r*c-l*n,h=e-f,i=t-a,u=r-n,s=l-c,y=h*s-i*u,m=(p*u-h*d)/y,x=(p*s-i*d)/y;if(isNaN(m+x))return!1;if(e>=f){if(ne(f,m,e))return!1}else if(ne(e,m,f))return!1;if(t>=a){if(ne(a,x,t))return!1}else if(ne(t,x,a))return!1;if(r>=n){if(ne(n,m,r))return!1}else if(ne(r,m,n))return!1;if(l>=c){if(ne(c,x,l))return!1}else if(ne(l,x,c))return!1;return{x:m,y:x}})(e.x,e.y,t.x,t.y,f.x,f.y,a.x,a.y))(t,e);l&&r++,r%2?ce(f,a,e[0],l):ce(a,f,e[0],l)}),r<2?[e]:[f,a]},de=e=>{e[1]&&e.sort((e,t)=>te(t)-te(e)).pop()},he=(e,t,f,a,r)=>{for(let l=0;l<t.length;l++){let n=[],c=z(...t[l]),p=Z(c,.025*w(3));e.map(f=>{if(D(1-a)&&e.length>1||e.length>9)return n.push(f);let c=pe(f,t[l]);D(1-r)&&c[0].map(e=>W(e,p)),n.push(...c)}),D(1-f)&&de(n),e=n}return e},ie=(e,t,f,a,r)=>{let l={x:f,y:a},c=((e,t,f=!1)=>{let[a,r]=e,l=r.x-a.x,c=r.y-a.y,p=((t.x-a.x)*l+(t.y-a.y)*c)/(l*l+c*c);return f&&(p=u(1,i(p,0))),n(a.x+p*l,a.y+p*c)})([e,t],l,!0);return q(c,l)<r},ue=[[n(-.5,-9),n(-.5,9)],[n(.5,-9),n(.5,9)],[n(-9,0-L),n(9,0-L)],[n(-9,L-0),n(9,L-0)]],se=e=>!e.some(e=>(e=>p(e.x)>.5||p(e.y)>L-0)(e)),ye=v(10,10),me=e=>e.map(e=>H&&D()&&e.length<6?((e,t)=>re(re(e)).map(([[e],[f,a]])=>{let r=t();return((e,t,f)=>g(33,a=>G(G(e,t,a),G(t,f,a),a)))(le(f,e,r),f,le(f,a,r))}).flat())(e,()=>E/ye):e),xe=e=>{r=b(k([1,2,3]),e=>{let t=C(1),f=I()+N;return[U(n(-9,t),f),U(n(9,t),f)]});let t=v(.3,.4),f=D()?C(E):0,a=w(8)*m/4-N;l=D(.7)?X(0,f,t,t):[k([Y,Y,O,O,ee,ee,_,V])(0,f,t,t,a)],l=he(me(l),r,k([0,.1,.5]),0,.5),((e,t,f)=>{for(let e=0;e<99;e++){let e=v(.3,.2),t=C(.7-e),a=C(1-e),r=!0;for(let f=0;f<l.length&&r;f++){let n=l[f];for(let f=0;f<n.length&&r;f++)ie(n[f],n[(f+1)%n.length],t,a,1*e)&&(r=!1)}if(R&&!r||!R&&r)return f(t,a,e)}})(0,0,(e,t,f)=>{let a=he(me(X(e,t,f)),r.map(([f,a])=>[W({...f},{x:e,y:t}),W({...a},{x:e,y:t})]),k([0,.1]),.1,.5);return l.push(...a)}),l=(l=he(l,ue,0,0,0)).filter(se).map(fe)},oe=(e,t)=>e.fillStyle=t,be=(e,t,f)=>{oe(e,f),e.fill(((e,t=!0)=>new Path2D(((e,t=!0)=>"M"+e.map(e=>[e.x,e.y]).join("L")+(t?"Z":""))(e,t)))(t))},ge=e=>e.canvas,Fe=e=>ge(e).width,ve=(e=>e.map(e=>[e,v()]).sort((e,t)=>e[1]-t[1]).map(e=>e[0]))(A[P]),we=((e=1,t=1,f=!0)=>((e=1,t=1,f=!0)=>{let a=document.createElement("canvas");f&&(e=>{window.onload=()=>document.body.append(e)})(a);let r=innerWidth,l=innerHeight,n=e<r/l,c=a.style;return c.width=n?`calc(100vh*${e})`:"100vw",c.height=n?"100vh":`calc(100vw/${e})`,a.width=(0|(n?l*e:r))*t,a.height=(0|(n?l:r/e))*t,a})(e,t,f).getContext("2d"))(E,2);(e=>{(e=>{e.translate(Fe(e)/2,(e=>ge(e).height)(e)/2)})(e),(e=>{e.scale(Fe(e),Fe(e))})(e)})(we);var De=()=>{if(l.filter(e=>e.a>.1).length<4)return!0;we.clearRect(-4,-4,8,8),l.map(e=>be(we,e.p,"#f0f"));let{width:e,height:t}=we.canvas,f=we.getImageData(0,0,e,t).data,a=0;b(999,r=>{let l=0*e,n=l+v(e-2*l)|0,c=l+v(t-2*l)|0;f[4*(n+c*e)]>2&&a++});let r=a/999;return console.log("total area",r.toFixed(3)),r<.4||r>.8||l.length<5},Ce=e=>{let t=l.map((e,t)=>[e.a,t]).sort((e,t)=>t[0]-e[0]);if(!t.length)return;let f=t[t.length/2|0][1],a=l[f];l.splice(f,1);let c=-z(...r[0])+e,p=D()?w(33,44):w(11,22),d=g(2*p,e=>[U(n(2,2*e-1),c),U(n(-2,2*e-1),c)]),h=k([0,0,.1,.5]),i=k([0,0,.1,.5]),u=k([0,0,.1,.5]),s=he([a.p],d,u,h,i);l.push(...s.map(fe))},Ie=(e,t)=>{be(we,e.p,ve[t%ve.length])},ke=e=>{do{xe()}while(De());Ce(x+C(.1)),Ce(C(.1)),j&&l.push(...[X,(e,t,f)=>b(2,a=>{let r=[e,t+a*C(f),f/(a+1)];return O(...r)}),(e,t,f)=>b(2,a=>{let r=f/(a+1),l=[e,t+a*C(f),r,r,-N+(D(.2)?0:m/4)];return V(...l)})][B](C(.7),C(E),v(.1,.1)).map(fe));let t=ve.pop();oe(we,t),we.fillRect(-4,-4,8,8),l.sort((e,t)=>t.a-e.a).filter(e=>e.a>.001).map(Ie),ve.push(t)};ke(),addEventListener("click",ke)})();
//!yShift && rndb() ? rnds(0.4) : 0;