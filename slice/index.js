var e,t,r,f,n,a,l,c,i,p,d,u,s,h,y,x,o=(e,t)=>({x:e,y:t}),m=Math,{abs:b,sin:g,cos:F,max:w,min:v,atan2:D,sign:H,hypot:A}=m,B=m.PI,C=B/2,M=2*B,N=(e,t)=>[...Array(0|e)].map((e,r)=>t(r)),T=(e,t,r=1)=>N(e,f=>t(f/(e-1)*r)),L=(e,t,r,f)=>(t=new Uint32Array([0,1,r=f=2,3].map(t=>((e,t,r)=>parseInt(e.substr(t,8),16))(e,8*t))),e=>(f=t[3],t[3]=t[2],t[2]=t[1],t[1]=r=t[0],t[0]^=(f^=f<<11)^f>>>8^r>>>19,t[0]/2**32)),$=(t=1,r=0)=>e()*t+r,k=(e=2,t=0)=>t+$(0|e)|0,E=(e=.5)=>$()>e,I=(e=1)=>$(e)-e/2,P=e=>k(4)*B/2,S=e=>k(8)*B/4,j=e=>e[k(e.length)],R="F2F1DFF2BD1DD94711591812181212#e8d5b9c07a38df3146f5b3490e2430#f3efeff7b32b0c6291b80c09091e05#f1faeee63946a8ccdc457b9d1d3557#dff3e4bca2cd7d73c6684da2171738#dccfa39f8f6544443bc6110f12130b#fff7f4ffc6c6ff2f4ec60a5f820a5f#faf1dcff871fb8000041764b29293d#ccc9a1f0ffcea53f2b60290e280004#ecf39e90a9554f772d31572c132a13#fdf0d5669bbcc1121f780000003049#e0fbfc98c1d9ee6c4d3d5a80293241#fbfffe96031a1b1b1e6d676efaa916#fffcf2ccc5b9503d39252422eb5e28#8ecae6219ebc023047ffb703fb8500#000000FFFFFFdddddd444444888888#25232370798cf5f1eddad2bca99985#ffffff375ba9000000d6d6d6fca311#f4ca55284862d6644a3a8acafffeef#C20F00FFDD22ffffff2374C6000000#e4e1dbD96B0BBF13048C13084465A6#f4ebc5F29F05233479569cc7F20505#001427708d81f4d58dbf06038d0801#8c1c13bf4342e7d7c1a78a7f735751".split("#").map(e=>e.match(/.{6}/g).map(e=>"#"+e)),U=.618,W=.5/U,Y=n=>{(t=>{e=t})(((e,t=0,r=L(e.substr(2)),f=L(e.substr(34)))=>e=>++t%2?r():f())(n)),t=k(24),r=$(),f=k(8),a=j([0,.01,.03,.06]),l=E(.1)||r<.05,c=E(.2),i=E(.7),r<.35&&(i=!1)},Z=(e,t,r)=>e+(t-e)*r,q=(e,t)=>{let r=F(t),f=g(t);return o(e.x*r+e.y*f,-e.x*f+e.y*r)},z=(e,t,r)=>G(q(G({...e},t,-1),r),t),G=(e,t,r=1)=>(e.x+=t.x*r,e.y+=t.y*r,e),J=(e,t)=>o(F(e)*t,g(e)*t),K=(e,t)=>A(e.x-t.x,e.y-t.y),O=(e,t)=>D(t.y-e.y,t.x-e.x),Q=(e,t,r)=>o(Z(e.x,t.x,r),Z(e.y,t.y,r)),V=e=>e.reduce((t,r,f)=>t+r.x*(f=e[f+1]||e[0]).y-r.y*f.x,0)/2,X=(e,t)=>({p:e,i:t,a:V(e)}),_=(e,t)=>e[(t+1)%e.length],ee=e=>e.map((t,r)=>[t,_(e,r)]),te=(e,t,r)=>Q(e,t,v(.5,r/K(e,t))),re=(e,t,r)=>!(e-1e-7<=t&&t<=r+1e-7),fe=(e,t,r,f)=>{f&&e.push({...r},{...f}),t.push({...f||r})},ne=(e,t)=>{let r=[],f=[],n=0;return((e,t)=>{ee(e).map(t)})(e,e=>{let a=(([e,t],[r,f])=>((e,t,r,f,n,a,l,c)=>{let i=e*f-t*r,p=n*c-a*l,d=e-r,u=t-f,s=n-l,h=a-c,y=d*h-u*s,x=(i*s-d*p)/y,o=(i*h-u*p)/y;if(isNaN(x+o))return!1;if(e>=r){if(re(r,x,e))return!1}else if(re(e,x,r))return!1;if(t>=f){if(re(f,o,t))return!1}else if(re(t,o,f))return!1;if(n>=l){if(re(l,x,n))return!1}else if(re(n,x,l))return!1;if(a>=c){if(re(c,o,a))return!1}else if(re(a,o,c))return!1;return{x:x,y:o}})(e.x,e.y,t.x,t.y,r.x,r.y,f.x,f.y))(t,e);a&&n++,n%2?fe(r,f,e[0],a):fe(f,r,e[0],a)}),n<2?[e]:[r,f]},ae=e=>{e[1]&&e.sort((e,t)=>V(t)-V(e)).pop()},le=(e,t,r,f,n)=>{for(let a=0;a<t.length;a++){let l=[],c=O(...t[a]),i=J(c+P(),j([$(.02,.01),$(.03,.03),0]));e.map(r=>{if(E(1-f)&&e.length>1||e.length>9)return l.push(r);let c=ne(r,t[a]);E(1-n)&&c[0].map(e=>G(e,i)),l.push(...c)}),E(1-r)&&ae(l),e=l}return e},ce=(e,t,r,f,n)=>{let a={x:r,y:f},l=((e,t,r=!1)=>{let[f,n]=e,a=n.x-f.x,l=n.y-f.y,c=((t.x-f.x)*a+(t.y-f.y)*l)/(a*a+l*l);return r&&(c=v(1,w(c,0))),o(f.x+c*a,f.y+c*l)})([e,t],a,!0);return K(l,a)<n},ie=(e,t,r,f,n,a)=>{for(let l=0;l<t;l++){let t=n(),l=I(.9-t),c=I(1.5-t),i=!0;for(let e=0;e<d.length&&i;e++){let f=d[e].p||d[e];for(let e=0;e<f.length&&i;e++)ce(f[e],f[(e+1)%f.length],l,c,t*r)&&(i=!1)}if((e&&!i||!e&&i)&&(!a||a(l,c,t)))return f(l,c,t,a&&a(l,c,t))}},pe=(e,t,r)=>q(o(e,t),r),de=(e,t,r,f,n=0)=>((e,t,r)=>e.map(e=>G(e,{x:t,y:r})))([pe(-r,-f,n),pe(r,-f,n),pe(r,f,n),pe(-r,f,n)],e,t),ue=(e,t,r,f)=>{let a=[],l=E(),i=f||k(3,2),p=$(.5,.5),d=$(1.5,.2),u=j([0,0,$(.1)]);for(let e=0;e<i;e++){let t=e/i*r-r/2,f=I(p)*r,n=r/i/2*d*(l?$(.7,.3):1),c=$(p/3*2,p/3)*r,s=de(t,f,n,c*(E(.2)?1:4),I(u));a.push(s)}let s=o(e,t),h=n,y=k(2);return a.map(e=>{let t=y&&k(2)*C,r=h+t;return t&&y--,e.map(e=>q(e,r)).map(e=>G(e,s)).map(e=>c?o(e.x+I(.01),e.y+I(.01)):e)})},se=(e,t,r,f)=>r.map(r=>G(J(r,f(r)),{x:e,y:t})),he=(e,t,r)=>{let f=N(c?k(3,1):0,e=>{let t=j([2,3,5]),f=$(.01,.001),n=$(99);return e=>r*g(e*t+n)*f});return se(e,t,((e,t,r,f)=>{let n=[];for(let e=0;e<t;e+=$(.05,.03))n.push(e);return n.push(t),n})(0,M),e=>f.reduce((t,r)=>r(e)+t,r))},ye=(e,t,r)=>[...he(e,t,r),...he(e,t,r*$(.22,.55)).reverse()],xe=(e,t,r)=>[o(e-r,t-r*$(.5,1)),o(e+r,t-r*$(.5,1)),o(e+r,t+r*$(.5,1)),o(e-r,t+r*$(.5,1))],oe=(e,t,r,f,n=0)=>{n=j([C,-C]);let a=c?1+I(.15):1;return se(e,t,[-n,2*B/3-n,-n-2*B/3],e=>r*a)},me=e=>!e.some(e=>(e=>b(e.x)>.5-a||b(e.y)>W-a)(e)),be=e=>{p=N(j([2,3,4,5]),e=>{let t=I(.7),r=P()+n+I(j([0,0,$(.1)]));return[q(o(-9,t),r),q(o(9,t),r)]});let t=$(.28,.2),f=E(),c=f?I(.7):0,u=!f&&E(.7)?I(.2):0;d=((e,t,r=0)=>N(t.length/2,e=>[r+=t[2*e],t[2*e+1]]).find(t=>e<t[0])[1])(r,[.05,ye,.3,he,.3,ue,.2,(e,t,r,f,n)=>de(e,t,r,f,(e=>E()?e+S():S())(n)),.05,xe,.1,oe])(u,c,t,t,n),isNaN(d[0].x)||(d=[d]),d=le((e=>{let t=j([3,7,13,21]);return e.map(e=>i&&E()&&e.length<6?((e,t)=>ee(ee(e)).map(([[e],[r,f]])=>{let n=t();return((e,t,r)=>T(33,f=>Q(Q(e,t,f),Q(t,r,f),f)))(te(r,e,n),r,te(r,f,n))}).flat())(e,()=>U/t):e)})(d),p,0,.1,j([.05,.1,.5])),r<.9&&((d=d.sort((e,t)=>V(e)-V(t))).splice(d.length/2|0,1),d.length>3&&d.splice(1,1),d.length>3&&d.splice(1,1)),ie(l,999,1,(e,t,r)=>{let f=le(ue(e,t,r),p,j([0,.1]),.1,.5);return d.push(...f)},e=>$(.3,.3)),d=(d=le(d,[[o(-.5+a,-9),o(-.5+a,9)],[o(.5-a,-9),o(.5-a,9)],[o(-9,-W+a),o(9,-W+a)],[o(-9,W-a),o(9,W-a)]],0,0,0)).filter(me).sort((e,t)=>V(t)-V(e)).map(X)},ge=(e,t,r)=>d.reduce((f,n)=>e(f,n.p.reduce((t,f)=>e(t,r?f.x:f.y),t)),t),Fe=e=>d.filter(t=>t.a>e).length,we=e=>{if(Fe(.1)<2||Fe(.35))return!0;let t=ge(v,9),r=ge(w,-9),f=ge(v,9,!0),n=ge(w,-9,!0);if(r<.5||t>-.5)return!0;if(n<.3||f>-.3)return!0;let a=d.reduce((e,t)=>e+V(t.p),0);return a<.3||a>.8||d.length<5},ve=(e,t,r)=>N(k(2,1),f=>{let n=[e+f*I(r/2),t+f*I(r/2),r/(f+1)];return he(...n)}),De=(e,t,r)=>N(k(2,1),f=>{let a=r/(f+1),l=[e,t+f*I(r/2),a,a,n];return de(...l)}),He=(e,t)=>e.fillStyle=t,Ae=e=>e.canvas,Be=e=>Ae(e).width,Ce=e=>e.reduce((t,r)=>G(t,r,1/e.length),o(0,0)),Me=e=>{let t=o(1e9,1e9),r=o(-1e9,-1e9);return e.map(e=>{t.x=v(t.x,e.x),t.y=v(t.y,e.y),r.x=w(r.x,e.x),r.y=w(r.y,e.y)}),[t,r]},Ne=([{x:e,y:t},{x:r,y:f}])=>v(b(e-r),b(t-f)),Te=e=>{let t=d.map((e,t)=>[e.a,t]).sort((e,t)=>t[0]-e[0]);if(!t.length)return;let r=t[t.length/2|0][1],f=d[r];d.splice(r,1);let n=-O(...p[0])+e,a=E()?k(33,44):k(11,22),l=T(2*a,e=>[q(o(2,2*e-1),n),q(o(-2,2*e-1),n)]),c=j([0,0,.1,.2]),i=j([0,0,.1]),u=j([0,0,.1]),s=le([f.p],l,u,c,i);d.push(...s.map(t=>{let r=V(t)<.05&&(0===e||e===B/2)&&E(.93)?B/2:0,f=Ce(t);return t.map(e=>G(q(G(e,f,-1),r),f,1))}).map(e=>{let t=(e=>{let t=Ce(e),r=T(180,r=>{let f=r*B,n=e.map(e=>z(e,t,f));return[Me(n),f]}).sort((e,t)=>Ne(e[0])-Ne(t[0]));return(([{x:e,y:t},{x:r,y:f}])=>[o(e,t),o(r,t),o(r,f),o(e,f)])(r[0][0]).map(e=>z(e,t,-r[0][1]))})(e);return V(t)/V(e)<1.2?t:e}).map((e,t)=>X(e,t+f.i)))},Le=(e,t=k(8))=>{(e=>{n=[0,0,0,B/2,B/2,B/2,$(1,.2)*H(I()),$(.1,.1)*H(I())][e]})(t);let r=1e3;do{be()}while(we()&&--r>0);Te(C),ie(!1,9999,1.3,(e,t,r,f)=>d.push(...[ue,ve,ve,De,(e,t,r)=>[oe(e,t,r,0,n)]][k(5)](e,t,r).map((e,t)=>X(e,f.i+t+1))),e=>j([.075,.1,.1]),(e,t)=>d.find(r=>t<0&&(({x:e,y:t},r)=>{let f=!1;for(let n=0,a=r.length-1;n<r.length;a=n++){let l=r[n].x,c=r[n].y,i=r[a].x,p=r[a].y;c>t!=p>t&&e<(i-l)*(t-c)/(p-c)+l&&(f=!f)}return f})({x:e,y:t},r.p))),Te(0),E()&&Te(j([B/4+I(.1),0,C]));let f=x.pop();He(e,f),e.fillRect(-4,-4,8,8),d.sort((e,t)=>t.a-e.a).filter(e=>e.a>1e-4).map(t=>((e,t,r)=>{He(e,r),e.fill(((e,t=!0)=>new Path2D(((e,t=!0)=>"M"+e.map(e=>[e.x,e.y]).join("L")+(t?"Z":""))(e,t)))(t))})(e,t.p,x[t.i%x.length])),x.push(f)},$e=clearTimeout,ke=setTimeout;newHash=(e,r)=>{Y(e),x=(e=>e.map(e=>[e,$()]).sort((e,t)=>e[1]-t[1]).map(e=>e[0]))(R[t]),Le(r,f)};var Ee,Ie=e=>s=ke(e=>Ie(Le(Se)),1e3*u),Pe=e=>{if(!h){let e=(h=document.createElement("div")).style;e.textAlign="center",e.position="fixed",e.width="100%",e.top="10px",document.body.append(h)}h.innerHTML=`<span style="padding:0 5px;user-select:none;font:25px Arial;background:#fff">Slideshow ${u?u+" sec":"off"}</span>`,$e(y),y=ke(()=>h.innerHTML="",2e3)},Se=((e=1,t=1)=>((e=1,t=1)=>{let r=document.createElement("canvas"),f=innerWidth,n=innerHeight,a=e<f/n,l=r.style;return l.width=a?`calc(100vh*${e})`:"100vw",l.height=a?"100vh":`calc(100vw/${e})`,r.width=(0|(a?n*e:f))*t,r.height=(0|(a?n:f/e))*t,r})(e,t).getContext("2d"))(U,2);(e=>{e.translate(Be(e)/2,(e=>Ae(e).height)(e)/2)})(Ee=Se),(e=>{e.scale(Be(e),Be(e))})(Ee),newHash(tokenData.hash,Se),window.onload=()=>document.body.append(Ae(Se)),Se.canvas.onpointerdown=e=>{e.button||(e.clientY>innerHeight/2?u?($e(s),Pe(u=0)):Le(Se):(u?u=(u+1)%10:Ie(u=1),Pe(!u&&$e(s))))}