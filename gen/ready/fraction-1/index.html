<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>fract</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:image" content="thumbnail.gif" />
</head>
<body>
<script src="100.js"></script>
<script src="lib.js"></script>
<script>
    let prog
    function newArt() {
        prog = program(recreateCanvas(), `

uniform float time;

${glslNoise2dFunction()}
${glslGetColorFunction()}

void main() {
    vec2 uv = gl_FragCoord.xy/resolution - 0.5;
    uv.x *= resolution.x/resolution.y;
    vec2 UV = uv;

    uv *= ${rnd(25)+25};

    vec2 p = floor(uv);
    uv = fract(uv) - 0.5;

    for (float i=0.; i<${5+rnd(5)*2}; i++) {

        p = abs(p) / dot(p,p);
        p -= ${0.5+rnd(0.1)} + sin(time*0.01)*0.2;
    }


    vec3 color1 = getColor(p.x+noise2d(p/2.+${rnd(4444)})*0.1);
    vec3 color2 = getColor(1.+p.y+noise2d(p/2.+${rnd(4444)})*.4);
    vec3 color = mix(color1, color2, noise2d(p-time*0.1) + fract(p.x*${rnd(11)}+time*0.1));
    color *= 1.-length(uv-vec2(noise2d(p+time*0.1),noise2d(p-time*0.1))*noise2d(p));
    gl_FragColor = vec4(color, 1.0);
}

        `);


    }
    let time = 0, playing = true, t0 = 0;

    requestAnimationFrame(function animate(t){
        let dt = t - t0;
        t0 = t;
        if (playing)
            time += dt/1000;
        prog &&prog.uf1('time', time)
        prog &&prog.draw();
        requestAnimationFrame(animate)
    })


    addEventListener('pointerdown', ev => (!ev || ev.button === 0) && newArt());
    addEventListener('resize', ev => prog.draw());
    addEventListener('keyup', ev => {
        playing = !playing;
    })
    newArt();
</script>
</body>
</html>