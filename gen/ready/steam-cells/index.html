<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Steam cellS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:image" content="thumbnail.gif" />
</head>
<body>
<script src="lib.js"></script>
<script>
    let prog
    function newArt() {
        prog = program(recreateCanvas(), `

        ${glslNoise2dFunction()}

        ${glslVignetteFunction()}

        ${glslGetColorFunction()}

vec3 draw(vec2 uv) {
    uv += vec2(${rnd(1)-0.5},${rnd(1)-0.5});
    uv *= ${rotate2d(rnd(77))};
    float PI = 3.1415;
    float id = ${1 + rnd(7)};

    vec4 s = vec4(${2 + rnd(5)}, ${2 + rnd(5)}, ${2 + rnd(5)}, ${2 + rnd(5)});

    float amp =
        s.x * cos(PI*s.z*uv.x) * cos(PI*s.w*uv.y) +
        s.y * sin(PI*s.w*uv.x) * sin(PI*s.z*uv.y);

    id += amp/${2+rnd(15)} +
          length(uv)*${rnd(5)} +
          fract(sin(length(uv)*${rnd(3)})*atan(uv.x, uv.y)*${rnd(2)});

    vec3 color1 = getColor(id);
    vec3 color2 = getColor(id + 1.0);
    vec3 color3 = getColor(id - 1.0);
    float v = sin(uv.x*${rnd(5)}+id) + noise2d(id+uv*${155+rnd(499)});
    v = clamp(0.0, 1.0, v);
    vec3 color = mix(color1, color2, v);
    color = mix(color, color3, clamp(0.0, 1.0, sin(uv.y*${rnd(5)}+id+ noise2d(id+uv*${155+rnd(499)}))));

    return color;
}

void main() {
    vec2 uv = gl_FragCoord.xy/resolution - 0.5;
    uv.x *= resolution.x/resolution.y;
    vec3 color;
    color += draw(uv + vec2(-0.2, -0.2)/resolution);
    color += draw(uv + vec2(+0.2, -0.2)/resolution);
    color += draw(uv + vec2(-0.2, +0.2)/resolution);
    color += draw(uv + vec2(+0.2, +0.2)/resolution);
    color /= 4.;
    // color *= vignette(${0.2 + rnd(0.2)});
    gl_FragColor = vec4(color, 1.0);
}

        `);
        prog.draw();

    }

    addEventListener('pointerdown', e => (!e || e.button === 0) && newArt());
    addEventListener('resize', e => prog.draw());
    newArt();
</script>
</body>
</html>