(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/*!
 * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */


(function (t) {
    t["ru"] = Object.assign(t["ru"] || {}, require('../../ru'))
})(window.CKEDITOR_TRANSLATIONS || (window.CKEDITOR_TRANSLATIONS = {}));
(function t(e, i) {
    if (typeof exports === "object" && typeof module === "object") module.exports = i(); else if (typeof define === "function" && define.amd) define([], i); else if (typeof exports === "object") exports["BalloonEditor"] = i(); else e["BalloonEditor"] = i()
})(window, (function () {
    return function (t) {
        var e = {};

        function i(n) {
            if (e[n]) {
                return e[n].exports
            }
            var o = e[n] = {i: n, l: false, exports: {}};
            t[n].call(o.exports, o, o.exports, i);
            o.l = true;
            return o.exports
        }

        i.m = t;
        i.c = e;
        i.d = function (t, e, n) {
            if (!i.o(t, e)) {
                Object.defineProperty(t, e, {enumerable: true, get: n})
            }
        };
        i.r = function (t) {
            if (typeof Symbol !== "undefined" && Symbol.toStringTag) {
                Object.defineProperty(t, Symbol.toStringTag, {value: "Module"})
            }
            Object.defineProperty(t, "__esModule", {value: true})
        };
        i.t = function (t, e) {
            if (e & 1) t = i(t);
            if (e & 8) return t;
            if (e & 4 && typeof t === "object" && t && t.__esModule) return t;
            var n = Object.create(null);
            i.r(n);
            Object.defineProperty(n, "default", {enumerable: true, value: t});
            if (e & 2 && typeof t != "string") for (var o in t) i.d(n, o, function (e) {
                return t[e]
            }.bind(null, o));
            return n
        };
        i.n = function (t) {
            var e = t && t.__esModule ? function e() {
                return t["default"]
            } : function e() {
                return t
            };
            i.d(e, "a", e);
            return e
        };
        i.o = function (t, e) {
            return Object.prototype.hasOwnProperty.call(t, e)
        };
        i.p = "";
        return i(i.s = 114)
    }([function (t, e, i) {
        "use strict";
        i.d(e, "b", (function () {
            return o
        }));
        i.d(e, "a", (function () {
            return r
        }));
        const n = "https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html";

        class o extends Error {
            constructor(t, e, i) {
                t = r(t);
                if (i) {
                    t += " " + JSON.stringify(i)
                }
                super(t);
                this.name = "CKEditorError";
                this.context = e;
                this.data = i
            }

            is(t) {
                return t === "CKEditorError"
            }

            static rethrowUnexpectedError(t, e) {
                if (t.is && t.is("CKEditorError")) {
                    throw t
                }
                const i = new o(t.message, e);
                i.stack = t.stack;
                throw i
            }
        }

        function r(t) {
            const e = t.match(/^([^:]+):/);
            if (!e) {
                return t
            }
            return t + ` Read more: ${n}#error-${e[1]}\n`
        }
    }, function (t, e, i) {
        "use strict";
        var n = function t() {
            var e;
            return function t() {
                if (typeof e === "undefined") {
                    e = Boolean(window && document && document.all && !window.atob)
                }
                return e
            }
        }();
        var o = function t() {
            var e = {};
            return function t(i) {
                if (typeof e[i] === "undefined") {
                    var n = document.querySelector(i);
                    if (window.HTMLIFrameElement && n instanceof window.HTMLIFrameElement) {
                        try {
                            n = n.contentDocument.head
                        } catch (t) {
                            n = null
                        }
                    }
                    e[i] = n
                }
                return e[i]
            }
        }();
        var r = [];

        function s(t) {
            var e = -1;
            for (var i = 0; i < r.length; i++) {
                if (r[i].identifier === t) {
                    e = i;
                    break
                }
            }
            return e
        }

        function a(t, e) {
            var i = {};
            var n = [];
            for (var o = 0; o < t.length; o++) {
                var a = t[o];
                var c = e.base ? a[0] + e.base : a[0];
                var l = i[c] || 0;
                var d = "".concat(c, " ").concat(l);
                i[c] = l + 1;
                var u = s(d);
                var h = {css: a[1], media: a[2], sourceMap: a[3]};
                if (u !== -1) {
                    r[u].references++;
                    r[u].updater(h)
                } else {
                    r.push({identifier: d, updater: m(h, e), references: 1})
                }
                n.push(d)
            }
            return n
        }

        function c(t) {
            var e = document.createElement("style");
            var n = t.attributes || {};
            if (typeof n.nonce === "undefined") {
                var r = true ? i.nc : undefined;
                if (r) {
                    n.nonce = r
                }
            }
            Object.keys(n).forEach((function (t) {
                e.setAttribute(t, n[t])
            }));
            if (typeof t.insert === "function") {
                t.insert(e)
            } else {
                var s = o(t.insert || "head");
                if (!s) {
                    throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.")
                }
                s.appendChild(e)
            }
            return e
        }

        function l(t) {
            if (t.parentNode === null) {
                return false
            }
            t.parentNode.removeChild(t)
        }

        var d = function t() {
            var e = [];
            return function t(i, n) {
                e[i] = n;
                return e.filter(Boolean).join("\n")
            }
        }();

        function u(t, e, i, n) {
            var o = i ? "" : n.media ? "@media ".concat(n.media, " {").concat(n.css, "}") : n.css;
            if (t.styleSheet) {
                t.styleSheet.cssText = d(e, o)
            } else {
                var r = document.createTextNode(o);
                var s = t.childNodes;
                if (s[e]) {
                    t.removeChild(s[e])
                }
                if (s.length) {
                    t.insertBefore(r, s[e])
                } else {
                    t.appendChild(r)
                }
            }
        }

        function h(t, e, i) {
            var n = i.css;
            var o = i.media;
            var r = i.sourceMap;
            if (o) {
                t.setAttribute("media", o)
            } else {
                t.removeAttribute("media")
            }
            if (r && btoa) {
                n += "\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r)))), " */")
            }
            if (t.styleSheet) {
                t.styleSheet.cssText = n
            } else {
                while (t.firstChild) {
                    t.removeChild(t.firstChild)
                }
                t.appendChild(document.createTextNode(n))
            }
        }

        var f = null;
        var g = 0;

        function m(t, e) {
            var i;
            var n;
            var o;
            if (e.singleton) {
                var r = g++;
                i = f || (f = c(e));
                n = u.bind(null, i, r, false);
                o = u.bind(null, i, r, true)
            } else {
                i = c(e);
                n = h.bind(null, i, e);
                o = function t() {
                    l(i)
                }
            }
            n(t);
            return function e(i) {
                if (i) {
                    if (i.css === t.css && i.media === t.media && i.sourceMap === t.sourceMap) {
                        return
                    }
                    n(t = i)
                } else {
                    o()
                }
            }
        }

        t.exports = function (t, e) {
            e = e || {};
            if (!e.singleton && typeof e.singleton !== "boolean") {
                e.singleton = n()
            }
            t = t || [];
            var i = a(t, e);
            return function t(n) {
                n = n || [];
                if (Object.prototype.toString.call(n) !== "[object Array]") {
                    return
                }
                for (var o = 0; o < i.length; o++) {
                    var c = i[o];
                    var l = s(c);
                    r[l].references--
                }
                var d = a(n, e);
                for (var u = 0; u < i.length; u++) {
                    var h = i[u];
                    var f = s(h);
                    if (r[f].references === 0) {
                        r[f].updater();
                        r.splice(f, 1)
                    }
                }
                i = d
            }
        }
    }, , function (t, e, i) {
        "use strict";
        var n = i(7);
        var o = typeof self == "object" && self && self.Object === Object && self;
        var r = n["a"] || o || Function("return this")();
        e["a"] = r
    }, function (t, e, i) {
        "use strict";
        (function (t) {
            var n = i(3);
            var o = i(14);
            var r = typeof exports == "object" && exports && !exports.nodeType && exports;
            var s = r && typeof t == "object" && t && !t.nodeType && t;
            var a = s && s.exports === r;
            var c = a ? n["a"].Buffer : undefined;
            var l = c ? c.isBuffer : undefined;
            var d = l || o["a"];
            e["a"] = d
        }).call(this, i(9)(t))
    }, function (t, e, i) {
        "use strict";
        (function (t) {
            var n = i(7);
            var o = typeof exports == "object" && exports && !exports.nodeType && exports;
            var r = o && typeof t == "object" && t && !t.nodeType && t;
            var s = r && r.exports === o;
            var a = s && n["a"].process;
            var c = function () {
                try {
                    var t = r && r.require && r.require("util").types;
                    if (t) {
                        return t
                    }
                    return a && a.binding && a.binding("util")
                } catch (t) {
                }
            }();
            e["a"] = c
        }).call(this, i(9)(t))
    }, function (t, e, i) {
        "use strict";
        (function (t) {
            var e = i(0);
            const n = "18.0.0";
            const o = typeof window === "object" ? window : t;
            if (o.CKEDITOR_VERSION) {
                throw new e["b"]("ckeditor-duplicated-modules: Some CKEditor 5 modules are duplicated.", null)
            } else {
                o.CKEDITOR_VERSION = n
            }
        }).call(this, i(10))
    }, function (t, e, i) {
        "use strict";
        (function (t) {
            var i = typeof t == "object" && t && t.Object === Object && t;
            e["a"] = i
        }).call(this, i(10))
    }, function (t, e, i) {
        "use strict";
        (function (t) {
            var n = i(3);
            var o = typeof exports == "object" && exports && !exports.nodeType && exports;
            var r = o && typeof t == "object" && t && !t.nodeType && t;
            var s = r && r.exports === o;
            var a = s ? n["a"].Buffer : undefined, c = a ? a.allocUnsafe : undefined;

            function l(t, e) {
                if (e) {
                    return t.slice()
                }
                var i = t.length, n = c ? c(i) : new t.constructor(i);
                t.copy(n);
                return n
            }

            e["a"] = l
        }).call(this, i(9)(t))
    }, function (t, e) {
        t.exports = function (t) {
            if (!t.webpackPolyfill) {
                var e = Object.create(t);
                if (!e.children) e.children = [];
                Object.defineProperty(e, "loaded", {
                    enumerable: true, get: function () {
                        return e.l
                    }
                });
                Object.defineProperty(e, "id", {
                    enumerable: true, get: function () {
                        return e.i
                    }
                });
                Object.defineProperty(e, "exports", {enumerable: true});
                e.webpackPolyfill = 1
            }
            return e
        }
    }, function (t, e) {
        var i;
        i = function () {
            return this
        }();
        try {
            i = i || new Function("return this")()
        } catch (t) {
            if (typeof window === "object") i = window
        }
        t.exports = i
    }, function (t, e, i) {
        var n = i(1);
        var o = i(55);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e, i) {
        var n = i(1);
        var o = i(108);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e, i) {
        var n = i(1);
        var o = i(109);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e, i) {
        "use strict";

        function n() {
            return false
        }

        e["a"] = n
    }, function (t, e, i) {
        var n = i(1);
        var o = i(16);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999);--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border:#1f89e5;--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#5c5c5c;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(18);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(-1*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:before{right:25%;margin-right:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:before{left:25%;margin-left:calc(2*var(--ck-balloon-arrow-half-width));bottom:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:before{right:25%;margin-right:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:before{left:25%;margin-left:calc(2*var(--ck-balloon-arrow-half-width));top:calc(-1*var(--ck-balloon-arrow-height))}'
    }, function (t, e, i) {
        var n = i(1);
        var o = i(20);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(22);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = '.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_n{top:calc(-1*var(--ck-tooltip-arrow-size));transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(-1*var(--ck-tooltip-arrow-size));transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}'
    }, function (t, e, i) {
        var n = i(1);
        var o = i(24);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(-1*var(--ck-spacing-small));margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(-1*var(--ck-spacing-small));margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(26);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(28);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(30);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}:root{--ck-dropdown-arrow-size:calc(0.5*var(--ck-icon-size))}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown__panel{border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-dropdown__panel.ck-dropdown__panel_se{border-top-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_sw{border-top-right-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_ne{border-bottom-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_nw{border-bottom-right-radius:0}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(32);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(0.2*var(--ck-line-height-base)*var(--ck-font-size-base)) calc(0.4*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(1.2*var(--ck-line-height-base)*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(34);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:1.3846153847em}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(2*var(--ck-spacing-large))}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(2*var(--ck-spacing-large))}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(0.5*var(--ck-border-radius))}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(-1*var(--ck-switch-button-translation)))}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(36);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-toolbar-dropdown .ck.ck-toolbar .ck.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar-dropdown .ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(38);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(40);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;margin-top:0;margin-bottom:0;background:var(--ck-color-toolbar-border)}.ck.ck-toolbar>.ck-toolbar__items>*{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small);margin-right:var(--ck-spacing-small)}.ck.ck-toolbar>.ck-toolbar__items:empty+.ck.ck-toolbar__separator{display:none}.ck.ck-toolbar>.ck-toolbar__items>*,.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar.ck-toolbar_compact{padding:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>*{margin:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>:not(:first-child):not(:last-child){border-radius:0}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck{margin-right:0}.ck.ck-toolbar[dir=rtl]:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__separator,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__separator,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-right:var(--ck-spacing-small)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(42);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-placeholder:before,.ck .ck-placeholder:before{content:attr(data-placeholder);pointer-events:none}.ck.ck-read-only .ck-placeholder:before{display:none}.ck.ck-placeholder:before,.ck .ck-placeholder:before{cursor:text;color:var(--ck-color-engine-placeholder-text)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(44);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(46);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(48);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-color-grid{display:grid}:root{--ck-color-grid-tile-size:24px;--ck-color-color-grid-check-icon:#000}.ck.ck-color-grid{grid-gap:5px;padding:8px}.ck.ck-color-grid__tile{width:var(--ck-color-grid-tile-size);height:var(--ck-color-grid-tile-size);min-width:var(--ck-color-grid-tile-size);min-height:var(--ck-color-grid-tile-size);padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-color-grid__tile.ck-disabled{cursor:unset;transition:unset}.ck.ck-color-grid__tile.ck-color-table__color-tile_bordered{box-shadow:0 0 0 1px var(--ck-color-base-border)}.ck.ck-color-grid__tile .ck.ck-icon{display:none;color:var(--ck-color-color-grid-check-icon)}.ck.ck-color-grid__tile.ck-on{box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-base-text)}.ck.ck-color-grid__tile.ck-on .ck.ck-icon{display:block}.ck.ck-color-grid__tile.ck-on,.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){border:0}.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-color-grid__label{padding:0 var(--ck-spacing-standard)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(50);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(52);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck .ck-button.ck-color-table__remove-color{display:flex;align-items:center;width:100%}label.ck.ck-color-grid__label{font-weight:unset}.ck .ck-button.ck-color-table__remove-color{padding:calc(var(--ck-spacing-standard)/2) var(--ck-spacing-standard);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck .ck-button.ck-color-table__remove-color:not(:focus){border-bottom:1px solid var(--ck-color-base-border)}[dir=ltr] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-left:var(--ck-spacing-standard)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(54);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".text-tiny{font-size:.7em}.text-small{font-size:.85em}.text-big{font-size:1.4em}.text-huge{font-size:1.8em}"
    }, function (t, e) {
        t.exports = ".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(57);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck-editor__editable .ck-horizontal-line{overflow:hidden}.ck-content hr{border:solid #5e5e5e;border-width:1px 0 0;margin:0}.ck-editor__editable .ck-horizontal-line{padding:5px 0}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(59);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-resizer-size:10px;--ck-resizer-border-width:1px;--ck-resizer-border-radius:2px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-tooltip-offset:10px;--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2}.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:var(--ck-spacing-small)}.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness))}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle .ck-widget__selection-handle:hover,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck-editor__editable.ck-read-only .ck-widget{--ck-widget-outline-thickness:0}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(61);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-labeled-input .ck-labeled-input__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-input .ck-labeled-input__status_error{color:var(--ck-color-base-error)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(63);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{box-shadow:var(--ck-inner-shadow),0 0;background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .2s ease-in-out,border .2s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),var(--ck-inner-shadow)}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),var(--ck-inner-shadow)}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(65);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-input{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-input{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}.ck.ck-text-alternative-form{padding:var(--ck-spacing-standard)}.ck.ck-text-alternative-form:focus{outline:none}[dir=ltr] .ck.ck-text-alternative-form>:not(:first-child),[dir=rtl] .ck.ck-text-alternative-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-text-alternative-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-text-alternative-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-text-alternative-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-text-alternative-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-text-alternative-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-text-alternative-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-text-alternative-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(67);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck-content .image{display:table;clear:both;text-align:center;margin:1em auto}.ck-content .image>img{display:block;margin:0 auto;max-width:100%;min-width:50px}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(69);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ":root{--ck-image-style-spacing:1.5em}.ck-content .image-style-align-center,.ck-content .image-style-align-left,.ck-content .image-style-align-right,.ck-content .image-style-side{max-width:50%}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(71);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck .ck-widget_with-resizer{position:relative}.ck .ck-widget__resizer{display:none;position:absolute;pointer-events:none;left:0;top:0;outline:1px solid var(--ck-color-resizer)}.ck-focused .ck-widget_with-resizer.ck-widget_selected>.ck-widget__resizer{display:block}.ck .ck-widget__resizer__handle{position:absolute;pointer-events:all;width:var(--ck-resizer-size);height:var(--ck-resizer-size);background:var(--ck-color-focus-border);border:var(--ck-resizer-border-width) solid #fff;border-radius:var(--ck-resizer-border-radius)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{top:var(--ck-resizer-offset);left:var(--ck-resizer-offset);cursor:nwse-resize}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{top:var(--ck-resizer-offset);right:var(--ck-resizer-offset);cursor:nesw-resize}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right{bottom:var(--ck-resizer-offset);right:var(--ck-resizer-offset);cursor:nwse-resize}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left{bottom:var(--ck-resizer-offset);left:var(--ck-resizer-offset);cursor:nesw-resize}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(73);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck-content .image.image_resized{max-width:100%;display:block;box-sizing:border-box}.ck-content .image.image_resized img{width:100%}.ck-content .image.image_resized>figcaption{display:block}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(75);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-editor__editable .image{position:relative}.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(77);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = '.ck-image-upload-complete-icon{display:block;position:absolute;top:10px;right:10px;border-radius:50%}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20px;--ck-image-upload-icon-width:2px}.ck-image-upload-complete-icon{width:var(--ck-image-upload-icon-size);height:var(--ck-image-upload-icon-size);opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:var(--ck-image-upload-icon-size);animation-delay:0ms,3s}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}'
    }, function (t, e, i) {
        var n = i(1);
        var o = i(79);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = '.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}'
    }, function (t, e, i) {
        var n = i(1);
        var o = i(81);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck .ck-link_selected{background:var(--ck-color-link-selected-background)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(83);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-input{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form{padding:var(--ck-spacing-standard)}.ck.ck-link-form:focus{outline:none}[dir=ltr] .ck.ck-link-form>:not(:first-child),[dir=rtl] .ck.ck-link-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-form{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-form .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-form .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form .ck-button{padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-link-form .ck-button{margin-left:0}[dir=ltr] .ck.ck-link-form .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-form .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-input{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-input .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button:first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin-left:0}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(85);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions{padding:var(--ck-spacing-standard)}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}.ck.ck-link-actions:focus{outline:none}[dir=ltr] .ck.ck-link-actions .ck-button:not(:first-child),[dir=rtl] .ck.ck-link-actions .ck-button:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions{padding:0;width:calc(0.8*var(--ck-input-text-width))}.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-standard);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):first-of-type{border-right:1px solid var(--ck-color-base-border)}[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview):last-of-type{border-right:1px solid var(--ck-color-base-border)}}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(87);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-character-grid .ck-character-grid__tiles{display:grid;grid-template-columns:repeat(10,1fr)}:root{--ck-character-grid-tile-size:24px}.ck.ck-character-grid{overflow-y:auto;overflow-x:hidden;width:350px;max-height:200px}.ck.ck-character-grid .ck-character-grid__tiles{margin:var(--ck-spacing-standard);grid-gap:var(--ck-spacing-standard)}.ck.ck-character-grid .ck-character-grid__tile{width:var(--ck-character-grid-tile-size);height:var(--ck-character-grid-tile-size);min-width:var(--ck-character-grid-tile-size);min-height:var(--ck-character-grid-tile-size);font-size:1.2em;padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-character-grid .ck-character-grid__tile:focus:not(.ck-disabled),.ck.ck-character-grid .ck-character-grid__tile:hover:not(.ck-disabled){border:0;box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-character-grid .ck-character-grid__tile .ck-button__label{line-height:var(--ck-character-grid-tile-size);width:100%;text-align:center}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(89);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-character-info{display:flex;justify-content:space-between;padding:var(--ck-spacing-small) var(--ck-spacing-standard);border-top:1px solid var(--ck-color-base-border)}.ck.ck-character-info>*{text-transform:uppercase;font-size:var(--ck-font-size-small)}.ck.ck-character-info .ck-character-info__name{max-width:280px;text-overflow:ellipsis;overflow:hidden}.ck.ck-character-info .ck-character-info__code{opacity:.6}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(91);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-special-characters-navigation{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:space-between;border-bottom:1px solid var(--ck-color-base-border);padding:var(--ck-spacing-standard)}[dir=ltr] .ck.ck-special-characters-navigation{padding-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-special-characters-navigation{padding-right:var(--ck-spacing-large)}.ck.ck-special-characters-navigation>.ck-label{max-width:160px;text-overflow:ellipsis;overflow:hidden}.ck.ck-special-characters-navigation>.ck-dropdown .ck-dropdown__panel{max-height:250px;overflow-y:auto;overflow-x:hidden}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(93);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ":root{--ck-color-table-focused-cell-background:rgba(158,207,250,0.3)}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table td.ck-editor__nested-editable:focus,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable:focus{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(95);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(97);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ":root{--ck-table-selected-cell-background:#cee5fd}.ck.ck-editor__editable .table table td.ck-editor__editable_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected{background-color:var(--ck-table-selected-cell-background)!important;caret-color:transparent;outline:unset;box-shadow:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table th.ck-editor__editable_selected ::selection{background-color:transparent}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget_selected{outline:unset}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(99);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck-content .table{margin:1em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;width:100%;height:100%;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border-color:#bfbfbf}.ck-content .table table th{font-weight:700;background:hsla(0,0%,0%,5%)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(101);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-labeled-view .ck-labeled-view__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-view .ck-labeled-view__status_error{color:var(--ck-color-base-error)}.ck.ck-labeled-view>.ck.ck-label{width:100%;text-overflow:ellipsis;overflow:hidden}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(103);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-input-color{width:100%;display:flex}.ck.ck-input-color>input.ck.ck-input-text{min-width:auto;flex-grow:1}.ck.ck-input-color>input.ck.ck-input-text:active,.ck.ck-input-color>input.ck.ck-input-text:focus{z-index:var(--ck-z-default)}.ck.ck-input-color>div.ck.ck-dropdown{min-width:auto}.ck.ck-input-color>div.ck.ck-dropdown>.ck-input-color__button .ck-dropdown__arrow{display:none}.ck.ck-input-color .ck.ck-input-color__button .ck.ck-input-color__button__preview{position:relative;overflow:hidden}.ck.ck-input-color .ck.ck-input-color__button .ck.ck-input-color__button__preview>.ck.ck-input-color__button__preview__no-color-indicator{position:absolute;display:block}[dir=ltr] .ck.ck-input-color>.ck.ck-input-text{border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .ck.ck-input-color>.ck.ck-input-text{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button{padding:0}[dir=ltr] .ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button{border-top-left-radius:0;border-bottom-left-radius:0;margin-left:-1px}[dir=rtl] .ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button{border-top-right-radius:0;border-bottom-right-radius:0;margin-right:-1px}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button.ck-disabled{background:var(--ck-color-input-disabled-background)}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button>.ck.ck-input-color__button__preview{border-radius:0}.ck-rounded-corners .ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button>.ck.ck-input-color__button__preview,.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button>.ck.ck-input-color__button__preview.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button>.ck.ck-input-color__button__preview{width:20px;height:20px;border:1px solid var(--ck-color-input-border)}.ck.ck-input-color>.ck.ck-dropdown>.ck.ck-input-color__button>.ck.ck-input-color__button__preview>.ck.ck-input-color__button__preview__no-color-indicator{top:-30%;left:50%;height:150%;width:8%;background:red;border-radius:2px;transform:rotate(45deg);transform-origin:50%}.ck.ck-input-color .ck.ck-input-color__remove-color{width:100%;border-bottom:1px solid var(--ck-color-input-border);padding:calc(var(--ck-spacing-standard)/2) var(--ck-spacing-standard);border-bottom-left-radius:0;border-bottom-right-radius:0}[dir=ltr] .ck.ck-input-color .ck.ck-input-color__remove-color{border-top-right-radius:0}[dir=rtl] .ck.ck-input-color .ck.ck-input-color__remove-color{border-top-left-radius:0}.ck.ck-input-color .ck.ck-input-color__remove-color .ck.ck-icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-input-color .ck.ck-input-color__remove-color .ck.ck-icon{margin-right:0;margin-left:var(--ck-spacing-standard)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(105);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-form__row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.ck.ck-form__row>:not(.ck-label){flex-grow:1}.ck.ck-form__row.ck-table-form__action-row .ck-button-cancel,.ck.ck-form__row.ck-table-form__action-row .ck-button-save{justify-content:center}.ck.ck-form__row{padding:var(--ck-spacing-standard) var(--ck-spacing-large) 0}[dir=ltr] .ck.ck-form__row>:not(.ck-label)+*{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-form__row>:not(.ck-label)+*{margin-right:var(--ck-spacing-large)}.ck.ck-form__row>.ck-label{width:100%;min-width:100%}.ck.ck-form__row.ck-table-form__action-row{margin-top:var(--ck-spacing-large)}.ck.ck-form__row.ck-table-form__action-row .ck-button .ck-button__label{color:var(--ck-color-text)}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(107);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ":root{--ck-table-form-header-height:38px}.ck.ck-form__header{padding:0 var(--ck-spacing-large);height:var(--ck-table-form-header-height);line-height:var(--ck-table-form-header-height);border-bottom:1px solid var(--ck-color-base-border)}.ck.ck-form__header .ck-form__header__label{font-weight:700}"
    }, function (t, e) {
        t.exports = ".ck.ck-form{padding:0 0 var(--ck-spacing-large)}.ck.ck-form:focus{outline:none}.ck.ck-form .ck.ck-input-text{min-width:100%;width:0}.ck.ck-form .ck.ck-dropdown{min-width:100%}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button:not(:focus){border:1px solid var(--ck-color-base-border)}.ck.ck-form .ck.ck-dropdown .ck-dropdown__button .ck-button__label{width:100%}"
    }, function (t, e) {
        t.exports = '.ck.ck-table-form .ck-form__row.ck-table-form__border-row{flex-wrap:wrap}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-labeled-view{display:flex;flex-direction:column-reverse}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-labeled-view .ck.ck-dropdown,.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-table-form__border-style,.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-table-form__border-width{flex-grow:0}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row{flex-wrap:wrap;align-items:center}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-labeled-view{display:flex;flex-direction:column-reverse;align-items:center}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-labeled-view .ck.ck-dropdown,.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimension-operator{flex-grow:0}.ck.ck-table-form .ck.ck-labeled-view{position:relative}.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status{position:absolute;left:50%;bottom:calc(-1*var(--ck-table-properties-error-arrow-size));transform:translate(-50%,100%);z-index:1}.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status:after{content:"";position:absolute;top:calc(-1*var(--ck-table-properties-error-arrow-size));left:50%;transform:translateX(-50%)}:root{--ck-table-properties-error-arrow-size:6px;--ck-table-properties-min-error-width:150px}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-labeled-view>.ck-label{font-size:var(--ck-font-size-tiny);text-align:center}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-table-form__border-style{width:80px;min-width:80px}.ck.ck-table-form .ck-form__row.ck-table-form__border-row .ck-table-form__border-width{width:50px;min-width:50px}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row{padding:0}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-labeled-view>.ck-label{font-size:10px;text-align:center}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimensions-row__height,.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimensions-row__width{margin:0}.ck.ck-table-form .ck-form__row.ck-table-form__dimensions-row .ck-table-form__dimension-operator{align-self:start;display:inline-block;height:var(--ck-ui-component-min-height);line-height:var(--ck-ui-component-min-height);margin:0 var(--ck-spacing-small)}.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status{border-radius:0}.ck-rounded-corners .ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status,.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status{background:var(--ck-color-base-error);color:var(--ck-color-base-background);padding:var(--ck-spacing-small) var(--ck-spacing-medium);min-width:var(--ck-table-properties-min-error-width);text-align:center}.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status:after{border-left:var(--ck-table-properties-error-arrow-size) solid transparent;border-bottom:var(--ck-table-properties-error-arrow-size) solid var(--ck-color-base-error);border-right:var(--ck-table-properties-error-arrow-size) solid transparent;border-top:0 solid transparent}.ck.ck-table-form .ck.ck-labeled-view .ck.ck-labeled-view__status{animation:ck-table-form-labeled-view-status-appear .15s ease both}.ck.ck-table-form .ck.ck-labeled-view .ck-input.ck-error:not(:focus)+.ck.ck-labeled-view__status{display:none}@keyframes ck-table-form-labeled-view-status-appear{0%{opacity:0}to{opacity:1}}'
    }, function (t, e, i) {
        var n = i(1);
        var o = i(111);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row{flex-wrap:wrap}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row .ck.ck-toolbar{flex-grow:0}.ck.ck-table-cell-properties-form{width:320px}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__padding-row{padding:0;width:35%}.ck.ck-table-cell-properties-form .ck-form__row.ck-table-cell-properties-form__alignment-row .ck.ck-toolbar{background:none}"
    }, function (t, e, i) {
        var n = i(1);
        var o = i(113);
        o = o.__esModule ? o.default : o;
        if (typeof o === "string") {
            o = [[t.i, o, ""]]
        }
        var r = {injectType: "singletonStyleTag"};
        r.insert = "head";
        r.singleton = true;
        var s = n(o, r);
        var a = o.locals ? o.locals : {};
        t.exports = a
    }, function (t, e) {
        t.exports = ".ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row{flex-wrap:wrap;flex-basis:0;align-content:baseline}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row .ck.ck-toolbar .ck-toolbar__items{flex-wrap:nowrap}.ck.ck-table-properties-form{width:320px}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row{padding:0}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row .ck.ck-toolbar{background:none}.ck.ck-table-properties-form .ck-form__row.ck-table-properties-form__alignment-row .ck.ck-toolbar .ck-toolbar__items>*{width:40px}"
    }, function (t, e, i) {
        "use strict";
        i.r(e);
        i.d(e, "default", (function () {
            return _I
        }));
        var n = i(3);
        var o = n["a"].Symbol;
        var r = o;
        var s = Object.prototype;
        var a = s.hasOwnProperty;
        var c = s.toString;
        var l = r ? r.toStringTag : undefined;

        function d(t) {
            var e = a.call(t, l), i = t[l];
            try {
                t[l] = undefined;
                var n = true
            } catch (t) {
            }
            var o = c.call(t);
            if (n) {
                if (e) {
                    t[l] = i
                } else {
                    delete t[l]
                }
            }
            return o
        }

        var u = d;
        var h = Object.prototype;
        var f = h.toString;

        function g(t) {
            return f.call(t)
        }

        var m = g;
        var p = "[object Null]", b = "[object Undefined]";
        var w = r ? r.toStringTag : undefined;

        function k(t) {
            if (t == null) {
                return t === undefined ? b : p
            }
            return w && w in Object(t) ? u(t) : m(t)
        }

        var _ = k;

        function v(t, e) {
            return function (i) {
                return t(e(i))
            }
        }

        var y = v;
        var x = y(Object.getPrototypeOf, Object);
        var C = x;

        function A(t) {
            return t != null && typeof t == "object"
        }

        var T = A;
        var P = "[object Object]";
        var S = Function.prototype, E = Object.prototype;
        var R = S.toString;
        var O = E.hasOwnProperty;
        var I = R.call(Object);

        function V(t) {
            if (!T(t) || _(t) != P) {
                return false
            }
            var e = C(t);
            if (e === null) {
                return true
            }
            var i = O.call(e, "constructor") && e.constructor;
            return typeof i == "function" && i instanceof i && R.call(i) == I
        }

        var N = V;

        function M() {
            this.__data__ = [];
            this.size = 0
        }

        var B = M;

        function z(t, e) {
            return t === e || t !== t && e !== e
        }

        var L = z;

        function F(t, e) {
            var i = t.length;
            while (i--) {
                if (L(t[i][0], e)) {
                    return i
                }
            }
            return -1
        }

        var D = F;
        var j = Array.prototype;
        var H = j.splice;

        function W(t) {
            var e = this.__data__, i = D(e, t);
            if (i < 0) {
                return false
            }
            var n = e.length - 1;
            if (i == n) {
                e.pop()
            } else {
                H.call(e, i, 1)
            }
            --this.size;
            return true
        }

        var q = W;

        function U(t) {
            var e = this.__data__, i = D(e, t);
            return i < 0 ? undefined : e[i][1]
        }

        var $ = U;

        function G(t) {
            return D(this.__data__, t) > -1
        }

        var K = G;

        function J(t, e) {
            var i = this.__data__, n = D(i, t);
            if (n < 0) {
                ++this.size;
                i.push([t, e])
            } else {
                i[n][1] = e
            }
            return this
        }

        var Y = J;

        function Q(t) {
            var e = -1, i = t == null ? 0 : t.length;
            this.clear();
            while (++e < i) {
                var n = t[e];
                this.set(n[0], n[1])
            }
        }

        Q.prototype.clear = B;
        Q.prototype["delete"] = q;
        Q.prototype.get = $;
        Q.prototype.has = K;
        Q.prototype.set = Y;
        var X = Q;

        function Z() {
            this.__data__ = new X;
            this.size = 0
        }

        var tt = Z;

        function et(t) {
            var e = this.__data__, i = e["delete"](t);
            this.size = e.size;
            return i
        }

        var it = et;

        function nt(t) {
            return this.__data__.get(t)
        }

        var ot = nt;

        function rt(t) {
            return this.__data__.has(t)
        }

        var st = rt;

        function at(t) {
            var e = typeof t;
            return t != null && (e == "object" || e == "function")
        }

        var ct = at;
        var lt = "[object AsyncFunction]", dt = "[object Function]", ut = "[object GeneratorFunction]",
            ht = "[object Proxy]";

        function ft(t) {
            if (!ct(t)) {
                return false
            }
            var e = _(t);
            return e == dt || e == ut || e == lt || e == ht
        }

        var gt = ft;
        var mt = n["a"]["__core-js_shared__"];
        var pt = mt;
        var bt = function () {
            var t = /[^.]+$/.exec(pt && pt.keys && pt.keys.IE_PROTO || "");
            return t ? "Symbol(src)_1." + t : ""
        }();

        function wt(t) {
            return !!bt && bt in t
        }

        var kt = wt;
        var _t = Function.prototype;
        var vt = _t.toString;

        function yt(t) {
            if (t != null) {
                try {
                    return vt.call(t)
                } catch (t) {
                }
                try {
                    return t + ""
                } catch (t) {
                }
            }
            return ""
        }

        var xt = yt;
        var Ct = /[\\^$.*+?()[\]{}|]/g;
        var At = /^\[object .+?Constructor\]$/;
        var Tt = Function.prototype, Pt = Object.prototype;
        var St = Tt.toString;
        var Et = Pt.hasOwnProperty;
        var Rt = RegExp("^" + St.call(Et).replace(Ct, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$");

        function Ot(t) {
            if (!ct(t) || kt(t)) {
                return false
            }
            var e = gt(t) ? Rt : At;
            return e.test(xt(t))
        }

        var It = Ot;

        function Vt(t, e) {
            return t == null ? undefined : t[e]
        }

        var Nt = Vt;

        function Mt(t, e) {
            var i = Nt(t, e);
            return It(i) ? i : undefined
        }

        var Bt = Mt;
        var zt = Bt(n["a"], "Map");
        var Lt = zt;
        var Ft = Bt(Object, "create");
        var Dt = Ft;

        function jt() {
            this.__data__ = Dt ? Dt(null) : {};
            this.size = 0
        }

        var Ht = jt;

        function Wt(t) {
            var e = this.has(t) && delete this.__data__[t];
            this.size -= e ? 1 : 0;
            return e
        }

        var qt = Wt;
        var Ut = "__lodash_hash_undefined__";
        var $t = Object.prototype;
        var Gt = $t.hasOwnProperty;

        function Kt(t) {
            var e = this.__data__;
            if (Dt) {
                var i = e[t];
                return i === Ut ? undefined : i
            }
            return Gt.call(e, t) ? e[t] : undefined
        }

        var Jt = Kt;
        var Yt = Object.prototype;
        var Qt = Yt.hasOwnProperty;

        function Xt(t) {
            var e = this.__data__;
            return Dt ? e[t] !== undefined : Qt.call(e, t)
        }

        var Zt = Xt;
        var te = "__lodash_hash_undefined__";

        function ee(t, e) {
            var i = this.__data__;
            this.size += this.has(t) ? 0 : 1;
            i[t] = Dt && e === undefined ? te : e;
            return this
        }

        var ie = ee;

        function ne(t) {
            var e = -1, i = t == null ? 0 : t.length;
            this.clear();
            while (++e < i) {
                var n = t[e];
                this.set(n[0], n[1])
            }
        }

        ne.prototype.clear = Ht;
        ne.prototype["delete"] = qt;
        ne.prototype.get = Jt;
        ne.prototype.has = Zt;
        ne.prototype.set = ie;
        var oe = ne;

        function re() {
            this.size = 0;
            this.__data__ = {hash: new oe, map: new (Lt || X), string: new oe}
        }

        var se = re;

        function ae(t) {
            var e = typeof t;
            return e == "string" || e == "number" || e == "symbol" || e == "boolean" ? t !== "__proto__" : t === null
        }

        var ce = ae;

        function le(t, e) {
            var i = t.__data__;
            return ce(e) ? i[typeof e == "string" ? "string" : "hash"] : i.map
        }

        var de = le;

        function ue(t) {
            var e = de(this, t)["delete"](t);
            this.size -= e ? 1 : 0;
            return e
        }

        var he = ue;

        function fe(t) {
            return de(this, t).get(t)
        }

        var ge = fe;

        function me(t) {
            return de(this, t).has(t)
        }

        var pe = me;

        function be(t, e) {
            var i = de(this, t), n = i.size;
            i.set(t, e);
            this.size += i.size == n ? 0 : 1;
            return this
        }

        var we = be;

        function ke(t) {
            var e = -1, i = t == null ? 0 : t.length;
            this.clear();
            while (++e < i) {
                var n = t[e];
                this.set(n[0], n[1])
            }
        }

        ke.prototype.clear = se;
        ke.prototype["delete"] = he;
        ke.prototype.get = ge;
        ke.prototype.has = pe;
        ke.prototype.set = we;
        var _e = ke;
        var ve = 200;

        function ye(t, e) {
            var i = this.__data__;
            if (i instanceof X) {
                var n = i.__data__;
                if (!Lt || n.length < ve - 1) {
                    n.push([t, e]);
                    this.size = ++i.size;
                    return this
                }
                i = this.__data__ = new _e(n)
            }
            i.set(t, e);
            this.size = i.size;
            return this
        }

        var xe = ye;

        function Ce(t) {
            var e = this.__data__ = new X(t);
            this.size = e.size
        }

        Ce.prototype.clear = tt;
        Ce.prototype["delete"] = it;
        Ce.prototype.get = ot;
        Ce.prototype.has = st;
        Ce.prototype.set = xe;
        var Ae = Ce;

        function Te(t, e) {
            var i = -1, n = t == null ? 0 : t.length;
            while (++i < n) {
                if (e(t[i], i, t) === false) {
                    break
                }
            }
            return t
        }

        var Pe = Te;
        var Se = function () {
            try {
                var t = Bt(Object, "defineProperty");
                t({}, "", {});
                return t
            } catch (t) {
            }
        }();
        var Ee = Se;

        function Re(t, e, i) {
            if (e == "__proto__" && Ee) {
                Ee(t, e, {configurable: true, enumerable: true, value: i, writable: true})
            } else {
                t[e] = i
            }
        }

        var Oe = Re;
        var Ie = Object.prototype;
        var Ve = Ie.hasOwnProperty;

        function Ne(t, e, i) {
            var n = t[e];
            if (!(Ve.call(t, e) && L(n, i)) || i === undefined && !(e in t)) {
                Oe(t, e, i)
            }
        }

        var Me = Ne;

        function Be(t, e, i, n) {
            var o = !i;
            i || (i = {});
            var r = -1, s = e.length;
            while (++r < s) {
                var a = e[r];
                var c = n ? n(i[a], t[a], a, i, t) : undefined;
                if (c === undefined) {
                    c = t[a]
                }
                if (o) {
                    Oe(i, a, c)
                } else {
                    Me(i, a, c)
                }
            }
            return i
        }

        var ze = Be;

        function Le(t, e) {
            var i = -1, n = Array(t);
            while (++i < t) {
                n[i] = e(i)
            }
            return n
        }

        var Fe = Le;
        var De = "[object Arguments]";

        function je(t) {
            return T(t) && _(t) == De
        }

        var He = je;
        var We = Object.prototype;
        var qe = We.hasOwnProperty;
        var Ue = We.propertyIsEnumerable;
        var $e = He(function () {
            return arguments
        }()) ? He : function (t) {
            return T(t) && qe.call(t, "callee") && !Ue.call(t, "callee")
        };
        var Ge = $e;
        var Ke = Array.isArray;
        var Je = Ke;
        var Ye = i(4);
        var Qe = 9007199254740991;
        var Xe = /^(?:0|[1-9]\d*)$/;

        function Ze(t, e) {
            var i = typeof t;
            e = e == null ? Qe : e;
            return !!e && (i == "number" || i != "symbol" && Xe.test(t)) && (t > -1 && t % 1 == 0 && t < e)
        }

        var ti = Ze;
        var ei = 9007199254740991;

        function ii(t) {
            return typeof t == "number" && t > -1 && t % 1 == 0 && t <= ei
        }

        var ni = ii;
        var oi = "[object Arguments]", ri = "[object Array]", si = "[object Boolean]", ai = "[object Date]",
            ci = "[object Error]", li = "[object Function]", di = "[object Map]", ui = "[object Number]",
            hi = "[object Object]", fi = "[object RegExp]", gi = "[object Set]", mi = "[object String]",
            pi = "[object WeakMap]";
        var bi = "[object ArrayBuffer]", wi = "[object DataView]", ki = "[object Float32Array]",
            _i = "[object Float64Array]", vi = "[object Int8Array]", yi = "[object Int16Array]",
            xi = "[object Int32Array]", Ci = "[object Uint8Array]", Ai = "[object Uint8ClampedArray]",
            Ti = "[object Uint16Array]", Pi = "[object Uint32Array]";
        var Si = {};
        Si[ki] = Si[_i] = Si[vi] = Si[yi] = Si[xi] = Si[Ci] = Si[Ai] = Si[Ti] = Si[Pi] = true;
        Si[oi] = Si[ri] = Si[bi] = Si[si] = Si[wi] = Si[ai] = Si[ci] = Si[li] = Si[di] = Si[ui] = Si[hi] = Si[fi] = Si[gi] = Si[mi] = Si[pi] = false;

        function Ei(t) {
            return T(t) && ni(t.length) && !!Si[_(t)]
        }

        var Ri = Ei;

        function Oi(t) {
            return function (e) {
                return t(e)
            }
        }

        var Ii = Oi;
        var Vi = i(5);
        var Ni = Vi["a"] && Vi["a"].isTypedArray;
        var Mi = Ni ? Ii(Ni) : Ri;
        var Bi = Mi;
        var zi = Object.prototype;
        var Li = zi.hasOwnProperty;

        function Fi(t, e) {
            var i = Je(t), n = !i && Ge(t), o = !i && !n && Object(Ye["a"])(t), r = !i && !n && !o && Bi(t),
                s = i || n || o || r, a = s ? Fe(t.length, String) : [], c = a.length;
            for (var l in t) {
                if ((e || Li.call(t, l)) && !(s && (l == "length" || o && (l == "offset" || l == "parent") || r && (l == "buffer" || l == "byteLength" || l == "byteOffset") || ti(l, c)))) {
                    a.push(l)
                }
            }
            return a
        }

        var Di = Fi;
        var ji = Object.prototype;

        function Hi(t) {
            var e = t && t.constructor, i = typeof e == "function" && e.prototype || ji;
            return t === i
        }

        var Wi = Hi;
        var qi = y(Object.keys, Object);
        var Ui = qi;
        var $i = Object.prototype;
        var Gi = $i.hasOwnProperty;

        function Ki(t) {
            if (!Wi(t)) {
                return Ui(t)
            }
            var e = [];
            for (var i in Object(t)) {
                if (Gi.call(t, i) && i != "constructor") {
                    e.push(i)
                }
            }
            return e
        }

        var Ji = Ki;

        function Yi(t) {
            return t != null && ni(t.length) && !gt(t)
        }

        var Qi = Yi;

        function Xi(t) {
            return Qi(t) ? Di(t) : Ji(t)
        }

        var Zi = Xi;

        function tn(t, e) {
            return t && ze(e, Zi(e), t)
        }

        var en = tn;

        function nn(t) {
            var e = [];
            if (t != null) {
                for (var i in Object(t)) {
                    e.push(i)
                }
            }
            return e
        }

        var on = nn;
        var rn = Object.prototype;
        var sn = rn.hasOwnProperty;

        function an(t) {
            if (!ct(t)) {
                return on(t)
            }
            var e = Wi(t), i = [];
            for (var n in t) {
                if (!(n == "constructor" && (e || !sn.call(t, n)))) {
                    i.push(n)
                }
            }
            return i
        }

        var cn = an;

        function ln(t) {
            return Qi(t) ? Di(t, true) : cn(t)
        }

        var dn = ln;

        function un(t, e) {
            return t && ze(e, dn(e), t)
        }

        var hn = un;
        var fn = i(8);

        function gn(t, e) {
            var i = -1, n = t.length;
            e || (e = Array(n));
            while (++i < n) {
                e[i] = t[i]
            }
            return e
        }

        var mn = gn;

        function pn(t, e) {
            var i = -1, n = t == null ? 0 : t.length, o = 0, r = [];
            while (++i < n) {
                var s = t[i];
                if (e(s, i, t)) {
                    r[o++] = s
                }
            }
            return r
        }

        var bn = pn;

        function wn() {
            return []
        }

        var kn = wn;
        var _n = Object.prototype;
        var vn = _n.propertyIsEnumerable;
        var yn = Object.getOwnPropertySymbols;
        var xn = !yn ? kn : function (t) {
            if (t == null) {
                return []
            }
            t = Object(t);
            return bn(yn(t), (function (e) {
                return vn.call(t, e)
            }))
        };
        var Cn = xn;

        function An(t, e) {
            return ze(t, Cn(t), e)
        }

        var Tn = An;

        function Pn(t, e) {
            var i = -1, n = e.length, o = t.length;
            while (++i < n) {
                t[o + i] = e[i]
            }
            return t
        }

        var Sn = Pn;
        var En = Object.getOwnPropertySymbols;
        var Rn = !En ? kn : function (t) {
            var e = [];
            while (t) {
                Sn(e, Cn(t));
                t = C(t)
            }
            return e
        };
        var On = Rn;

        function In(t, e) {
            return ze(t, On(t), e)
        }

        var Vn = In;

        function Nn(t, e, i) {
            var n = e(t);
            return Je(t) ? n : Sn(n, i(t))
        }

        var Mn = Nn;

        function Bn(t) {
            return Mn(t, Zi, Cn)
        }

        var zn = Bn;

        function Ln(t) {
            return Mn(t, dn, On)
        }

        var Fn = Ln;
        var Dn = Bt(n["a"], "DataView");
        var jn = Dn;
        var Hn = Bt(n["a"], "Promise");
        var Wn = Hn;
        var qn = Bt(n["a"], "Set");
        var Un = qn;
        var $n = Bt(n["a"], "WeakMap");
        var Gn = $n;
        var Kn = "[object Map]", Jn = "[object Object]", Yn = "[object Promise]", Qn = "[object Set]",
            Xn = "[object WeakMap]";
        var Zn = "[object DataView]";
        var to = xt(jn), eo = xt(Lt), io = xt(Wn), no = xt(Un), oo = xt(Gn);
        var ro = _;
        if (jn && ro(new jn(new ArrayBuffer(1))) != Zn || Lt && ro(new Lt) != Kn || Wn && ro(Wn.resolve()) != Yn || Un && ro(new Un) != Qn || Gn && ro(new Gn) != Xn) {
            ro = function (t) {
                var e = _(t), i = e == Jn ? t.constructor : undefined, n = i ? xt(i) : "";
                if (n) {
                    switch (n) {
                        case to:
                            return Zn;
                        case eo:
                            return Kn;
                        case io:
                            return Yn;
                        case no:
                            return Qn;
                        case oo:
                            return Xn
                    }
                }
                return e
            }
        }
        var so = ro;
        var ao = Object.prototype;
        var co = ao.hasOwnProperty;

        function lo(t) {
            var e = t.length, i = new t.constructor(e);
            if (e && typeof t[0] == "string" && co.call(t, "index")) {
                i.index = t.index;
                i.input = t.input
            }
            return i
        }

        var uo = lo;
        var ho = n["a"].Uint8Array;
        var fo = ho;

        function go(t) {
            var e = new t.constructor(t.byteLength);
            new fo(e).set(new fo(t));
            return e
        }

        var mo = go;

        function po(t, e) {
            var i = e ? mo(t.buffer) : t.buffer;
            return new t.constructor(i, t.byteOffset, t.byteLength)
        }

        var bo = po;
        var wo = /\w*$/;

        function ko(t) {
            var e = new t.constructor(t.source, wo.exec(t));
            e.lastIndex = t.lastIndex;
            return e
        }

        var _o = ko;
        var vo = r ? r.prototype : undefined, yo = vo ? vo.valueOf : undefined;

        function xo(t) {
            return yo ? Object(yo.call(t)) : {}
        }

        var Co = xo;

        function Ao(t, e) {
            var i = e ? mo(t.buffer) : t.buffer;
            return new t.constructor(i, t.byteOffset, t.length)
        }

        var To = Ao;
        var Po = "[object Boolean]", So = "[object Date]", Eo = "[object Map]", Ro = "[object Number]",
            Oo = "[object RegExp]", Io = "[object Set]", Vo = "[object String]", No = "[object Symbol]";
        var Mo = "[object ArrayBuffer]", Bo = "[object DataView]", zo = "[object Float32Array]",
            Lo = "[object Float64Array]", Fo = "[object Int8Array]", Do = "[object Int16Array]",
            jo = "[object Int32Array]", Ho = "[object Uint8Array]", Wo = "[object Uint8ClampedArray]",
            qo = "[object Uint16Array]", Uo = "[object Uint32Array]";

        function $o(t, e, i) {
            var n = t.constructor;
            switch (e) {
                case Mo:
                    return mo(t);
                case Po:
                case So:
                    return new n(+t);
                case Bo:
                    return bo(t, i);
                case zo:
                case Lo:
                case Fo:
                case Do:
                case jo:
                case Ho:
                case Wo:
                case qo:
                case Uo:
                    return To(t, i);
                case Eo:
                    return new n;
                case Ro:
                case Vo:
                    return new n(t);
                case Oo:
                    return _o(t);
                case Io:
                    return new n;
                case No:
                    return Co(t)
            }
        }

        var Go = $o;
        var Ko = Object.create;
        var Jo = function () {
            function t() {
            }

            return function (e) {
                if (!ct(e)) {
                    return {}
                }
                if (Ko) {
                    return Ko(e)
                }
                t.prototype = e;
                var i = new t;
                t.prototype = undefined;
                return i
            }
        }();
        var Yo = Jo;

        function Qo(t) {
            return typeof t.constructor == "function" && !Wi(t) ? Yo(C(t)) : {}
        }

        var Xo = Qo;
        var Zo = "[object Map]";

        function tr(t) {
            return T(t) && so(t) == Zo
        }

        var er = tr;
        var ir = Vi["a"] && Vi["a"].isMap;
        var nr = ir ? Ii(ir) : er;
        var or = nr;
        var rr = "[object Set]";

        function sr(t) {
            return T(t) && so(t) == rr
        }

        var ar = sr;
        var cr = Vi["a"] && Vi["a"].isSet;
        var lr = cr ? Ii(cr) : ar;
        var dr = lr;
        var ur = 1, hr = 2, fr = 4;
        var gr = "[object Arguments]", mr = "[object Array]", pr = "[object Boolean]", br = "[object Date]",
            wr = "[object Error]", kr = "[object Function]", _r = "[object GeneratorFunction]", vr = "[object Map]",
            yr = "[object Number]", xr = "[object Object]", Cr = "[object RegExp]", Ar = "[object Set]",
            Tr = "[object String]", Pr = "[object Symbol]", Sr = "[object WeakMap]";
        var Er = "[object ArrayBuffer]", Rr = "[object DataView]", Or = "[object Float32Array]",
            Ir = "[object Float64Array]", Vr = "[object Int8Array]", Nr = "[object Int16Array]",
            Mr = "[object Int32Array]", Br = "[object Uint8Array]", zr = "[object Uint8ClampedArray]",
            Lr = "[object Uint16Array]", Fr = "[object Uint32Array]";
        var Dr = {};
        Dr[gr] = Dr[mr] = Dr[Er] = Dr[Rr] = Dr[pr] = Dr[br] = Dr[Or] = Dr[Ir] = Dr[Vr] = Dr[Nr] = Dr[Mr] = Dr[vr] = Dr[yr] = Dr[xr] = Dr[Cr] = Dr[Ar] = Dr[Tr] = Dr[Pr] = Dr[Br] = Dr[zr] = Dr[Lr] = Dr[Fr] = true;
        Dr[wr] = Dr[kr] = Dr[Sr] = false;

        function jr(t, e, i, n, o, r) {
            var s, a = e & ur, c = e & hr, l = e & fr;
            if (i) {
                s = o ? i(t, n, o, r) : i(t)
            }
            if (s !== undefined) {
                return s
            }
            if (!ct(t)) {
                return t
            }
            var d = Je(t);
            if (d) {
                s = uo(t);
                if (!a) {
                    return mn(t, s)
                }
            } else {
                var u = so(t), h = u == kr || u == _r;
                if (Object(Ye["a"])(t)) {
                    return Object(fn["a"])(t, a)
                }
                if (u == xr || u == gr || h && !o) {
                    s = c || h ? {} : Xo(t);
                    if (!a) {
                        return c ? Vn(t, hn(s, t)) : Tn(t, en(s, t))
                    }
                } else {
                    if (!Dr[u]) {
                        return o ? t : {}
                    }
                    s = Go(t, u, a)
                }
            }
            r || (r = new Ae);
            var f = r.get(t);
            if (f) {
                return f
            }
            r.set(t, s);
            if (dr(t)) {
                t.forEach((function (n) {
                    s.add(jr(n, e, i, n, t, r))
                }))
            } else if (or(t)) {
                t.forEach((function (n, o) {
                    s.set(o, jr(n, e, i, o, t, r))
                }))
            }
            var g = l ? c ? Fn : zn : c ? keysIn : Zi;
            var m = d ? undefined : g(t);
            Pe(m || t, (function (n, o) {
                if (m) {
                    o = n;
                    n = t[o]
                }
                Me(s, o, jr(n, e, i, o, t, r))
            }));
            return s
        }

        var Hr = jr;
        var Wr = 1, qr = 4;

        function Ur(t, e) {
            e = typeof e == "function" ? e : undefined;
            return Hr(t, Wr | qr, e)
        }

        var $r = Ur;

        function Gr(t) {
            return T(t) && t.nodeType === 1 && !N(t)
        }

        var Kr = Gr;

        class Jr {
            constructor(t, e) {
                this._config = {};
                if (e) {
                    this.define(Yr(e))
                }
                if (t) {
                    this._setObjectToTarget(this._config, t)
                }
            }

            set(t, e) {
                this._setToTarget(this._config, t, e)
            }

            define(t, e) {
                const i = true;
                this._setToTarget(this._config, t, e, i)
            }

            get(t) {
                return this._getFromSource(this._config, t)
            }

            * names() {
                for (const t of Object.keys(this._config)) {
                    yield t
                }
            }

            _setToTarget(t, e, i, n = false) {
                if (N(e)) {
                    this._setObjectToTarget(t, e, n);
                    return
                }
                const o = e.split(".");
                e = o.pop();
                for (const e of o) {
                    if (!N(t[e])) {
                        t[e] = {}
                    }
                    t = t[e]
                }
                if (N(i)) {
                    if (!N(t[e])) {
                        t[e] = {}
                    }
                    t = t[e];
                    this._setObjectToTarget(t, i, n);
                    return
                }
                if (n && typeof t[e] != "undefined") {
                    return
                }
                t[e] = i
            }

            _getFromSource(t, e) {
                const i = e.split(".");
                e = i.pop();
                for (const e of i) {
                    if (!N(t[e])) {
                        t = null;
                        break
                    }
                    t = t[e]
                }
                return t ? Yr(t[e]) : undefined
            }

            _setObjectToTarget(t, e, i) {
                Object.keys(e).forEach(n => {
                    this._setToTarget(t, n, e[n], i)
                })
            }
        }

        function Yr(t) {
            return $r(t, Qr)
        }

        function Qr(t) {
            return Kr(t) ? t : undefined
        }

        function Xr() {
            return function t() {
                t.called = true
            }
        }

        var Zr = Xr;

        class ts {
            constructor(t, e) {
                this.source = t;
                this.name = e;
                this.path = [];
                this.stop = Zr();
                this.off = Zr()
            }
        }

        const es = new Array(256).fill().map((t, e) => ("0" + e.toString(16)).slice(-2));

        function is() {
            const t = Math.random() * 4294967296 >>> 0;
            const e = Math.random() * 4294967296 >>> 0;
            const i = Math.random() * 4294967296 >>> 0;
            const n = Math.random() * 4294967296 >>> 0;
            return "e" + es[t >> 0 & 255] + es[t >> 8 & 255] + es[t >> 16 & 255] + es[t >> 24 & 255] + es[e >> 0 & 255] + es[e >> 8 & 255] + es[e >> 16 & 255] + es[e >> 24 & 255] + es[i >> 0 & 255] + es[i >> 8 & 255] + es[i >> 16 & 255] + es[i >> 24 & 255] + es[n >> 0 & 255] + es[n >> 8 & 255] + es[n >> 16 & 255] + es[n >> 24 & 255]
        }

        const ns = {
            get(t) {
                if (typeof t != "number") {
                    return this[t] || this.normal
                } else {
                    return t
                }
            }, highest: 1e5, high: 1e3, normal: 0, low: -1e3, lowest: -1e5
        };
        var os = ns;
        var rs = i(6);
        var ss = i(0);
        const as = Symbol("listeningTo");
        const cs = Symbol("emitterId");
        const ls = {
            on(t, e, i = {}) {
                this.listenTo(this, t, e, i)
            }, once(t, e, i) {
                let n = false;
                const o = function (t, ...i) {
                    if (!n) {
                        n = true;
                        t.off();
                        e.call(this, t, ...i)
                    }
                };
                this.listenTo(this, t, o, i)
            }, off(t, e) {
                this.stopListening(this, t, e)
            }, listenTo(t, e, i, n = {}) {
                let o, r;
                if (!this[as]) {
                    this[as] = {}
                }
                const s = this[as];
                if (!fs(t)) {
                    hs(t)
                }
                const a = fs(t);
                if (!(o = s[a])) {
                    o = s[a] = {emitter: t, callbacks: {}}
                }
                if (!(r = o.callbacks[e])) {
                    r = o.callbacks[e] = []
                }
                r.push(i);
                ps(t, e);
                const c = bs(t, e);
                const l = os.get(n.priority);
                const d = {callback: i, priority: l};
                for (const t of c) {
                    let e = false;
                    for (let i = 0; i < t.length; i++) {
                        if (t[i].priority < l) {
                            t.splice(i, 0, d);
                            e = true;
                            break
                        }
                    }
                    if (!e) {
                        t.push(d)
                    }
                }
            }, stopListening(t, e, i) {
                const n = this[as];
                let o = t && fs(t);
                const r = n && o && n[o];
                const s = r && e && r.callbacks[e];
                if (!n || t && !r || e && !s) {
                    return
                }
                if (i) {
                    _s(t, e, i)
                } else if (s) {
                    while (i = s.pop()) {
                        _s(t, e, i)
                    }
                    delete r.callbacks[e]
                } else if (r) {
                    for (e in r.callbacks) {
                        this.stopListening(t, e)
                    }
                    delete n[o]
                } else {
                    for (o in n) {
                        this.stopListening(n[o].emitter)
                    }
                    delete this[as]
                }
            }, fire(t, ...e) {
                try {
                    const i = t instanceof ts ? t : new ts(this, t);
                    const n = i.name;
                    let o = ws(this, n);
                    i.path.push(this);
                    if (o) {
                        const t = [i, ...e];
                        o = Array.from(o);
                        for (let e = 0; e < o.length; e++) {
                            o[e].callback.apply(this, t);
                            if (i.off.called) {
                                delete i.off.called;
                                _s(this, n, o[e].callback)
                            }
                            if (i.stop.called) {
                                break
                            }
                        }
                    }
                    if (this._delegations) {
                        const t = this._delegations.get(n);
                        const o = this._delegations.get("*");
                        if (t) {
                            ks(t, i, e)
                        }
                        if (o) {
                            ks(o, i, e)
                        }
                    }
                    return i.return
                } catch (t) {
                    ss["b"].rethrowUnexpectedError(t, this)
                }
            }, delegate(...t) {
                return {
                    to: (e, i) => {
                        if (!this._delegations) {
                            this._delegations = new Map
                        }
                        t.forEach(t => {
                            const n = this._delegations.get(t);
                            if (!n) {
                                this._delegations.set(t, new Map([[e, i]]))
                            } else {
                                n.set(e, i)
                            }
                        })
                    }
                }
            }, stopDelegating(t, e) {
                if (!this._delegations) {
                    return
                }
                if (!t) {
                    this._delegations.clear()
                } else if (!e) {
                    this._delegations.delete(t)
                } else {
                    const i = this._delegations.get(t);
                    if (i) {
                        i.delete(e)
                    }
                }
            }
        };
        var ds = ls;

        function us(t, e) {
            if (t[as] && t[as][e]) {
                return t[as][e].emitter
            }
            return null
        }

        function hs(t, e) {
            if (!t[cs]) {
                t[cs] = e || is()
            }
        }

        function fs(t) {
            return t[cs]
        }

        function gs(t) {
            if (!t._events) {
                Object.defineProperty(t, "_events", {value: {}})
            }
            return t._events
        }

        function ms() {
            return {callbacks: [], childEvents: []}
        }

        function ps(t, e) {
            const i = gs(t);
            if (i[e]) {
                return
            }
            let n = e;
            let o = null;
            const r = [];
            while (n !== "") {
                if (i[n]) {
                    break
                }
                i[n] = ms();
                r.push(i[n]);
                if (o) {
                    i[n].childEvents.push(o)
                }
                o = n;
                n = n.substr(0, n.lastIndexOf(":"))
            }
            if (n !== "") {
                for (const t of r) {
                    t.callbacks = i[n].callbacks.slice()
                }
                i[n].childEvents.push(o)
            }
        }

        function bs(t, e) {
            const i = gs(t)[e];
            if (!i) {
                return []
            }
            let n = [i.callbacks];
            for (let e = 0; e < i.childEvents.length; e++) {
                const o = bs(t, i.childEvents[e]);
                n = n.concat(o)
            }
            return n
        }

        function ws(t, e) {
            let i;
            if (!t._events || !(i = t._events[e]) || !i.callbacks.length) {
                if (e.indexOf(":") > -1) {
                    return ws(t, e.substr(0, e.lastIndexOf(":")))
                } else {
                    return null
                }
            }
            return i.callbacks
        }

        function ks(t, e, i) {
            for (let [n, o] of t) {
                if (!o) {
                    o = e.name
                } else if (typeof o == "function") {
                    o = o(e.name)
                }
                const t = new ts(e.source, o);
                t.path = [...e.path];
                n.fire(t, ...i)
            }
        }

        function _s(t, e, i) {
            const n = bs(t, e);
            for (const t of n) {
                for (let e = 0; e < t.length; e++) {
                    if (t[e].callback == i) {
                        t.splice(e, 1);
                        e--
                    }
                }
            }
        }

        function vs(t, ...e) {
            e.forEach(e => {
                Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(i => {
                    if (i in t.prototype) {
                        return
                    }
                    const n = Object.getOwnPropertyDescriptor(e, i);
                    n.enumerable = false;
                    Object.defineProperty(t.prototype, i, n)
                })
            })
        }

        class ys {
            constructor(t = {}) {
                this._items = [];
                this._itemMap = new Map;
                this._idProperty = t.idProperty || "id";
                this._bindToExternalToInternalMap = new WeakMap;
                this._bindToInternalToExternalMap = new WeakMap;
                this._skippedIndexesFromExternal = []
            }

            get length() {
                return this._items.length
            }

            get first() {
                return this._items[0] || null
            }

            get last() {
                return this._items[this.length - 1] || null
            }

            add(t, e) {
                let i;
                const n = this._idProperty;
                if (n in t) {
                    i = t[n];
                    if (typeof i != "string") {
                        throw new ss["b"]("collection-add-invalid-id", this)
                    }
                    if (this.get(i)) {
                        throw new ss["b"]("collection-add-item-already-exists", this)
                    }
                } else {
                    t[n] = i = is()
                }
                if (e === undefined) {
                    e = this._items.length
                } else if (e > this._items.length || e < 0) {
                    throw new ss["b"]("collection-add-item-invalid-index", this)
                }
                this._items.splice(e, 0, t);
                this._itemMap.set(i, t);
                this.fire("add", t, e);
                return this
            }

            get(t) {
                let e;
                if (typeof t == "string") {
                    e = this._itemMap.get(t)
                } else if (typeof t == "number") {
                    e = this._items[t]
                } else {
                    throw new ss["b"]("collection-get-invalid-arg: Index or id must be given.", this)
                }
                return e || null
            }

            has(t) {
                if (typeof t == "string") {
                    return this._itemMap.has(t)
                } else {
                    const e = this._idProperty;
                    const i = t[e];
                    return this._itemMap.has(i)
                }
            }

            getIndex(t) {
                let e;
                if (typeof t == "string") {
                    e = this._itemMap.get(t)
                } else {
                    e = t
                }
                return this._items.indexOf(e)
            }

            remove(t) {
                let e, i, n;
                let o = false;
                const r = this._idProperty;
                if (typeof t == "string") {
                    i = t;
                    n = this._itemMap.get(i);
                    o = !n;
                    if (n) {
                        e = this._items.indexOf(n)
                    }
                } else if (typeof t == "number") {
                    e = t;
                    n = this._items[e];
                    o = !n;
                    if (n) {
                        i = n[r]
                    }
                } else {
                    n = t;
                    i = n[r];
                    e = this._items.indexOf(n);
                    o = e == -1 || !this._itemMap.get(i)
                }
                if (o) {
                    throw new ss["b"]("collection-remove-404: Item not found.", this)
                }
                this._items.splice(e, 1);
                this._itemMap.delete(i);
                const s = this._bindToInternalToExternalMap.get(n);
                this._bindToInternalToExternalMap.delete(n);
                this._bindToExternalToInternalMap.delete(s);
                this.fire("remove", n, e);
                return n
            }

            map(t, e) {
                return this._items.map(t, e)
            }

            find(t, e) {
                return this._items.find(t, e)
            }

            filter(t, e) {
                return this._items.filter(t, e)
            }

            clear() {
                if (this._bindToCollection) {
                    this.stopListening(this._bindToCollection);
                    this._bindToCollection = null
                }
                while (this.length) {
                    this.remove(0)
                }
            }

            bindTo(t) {
                if (this._bindToCollection) {
                    throw new ss["b"]("collection-bind-to-rebind: The collection cannot be bound more than once.", this)
                }
                this._bindToCollection = t;
                return {
                    as: t => {
                        this._setUpBindToBinding(e => new t(e))
                    }, using: t => {
                        if (typeof t == "function") {
                            this._setUpBindToBinding(e => t(e))
                        } else {
                            this._setUpBindToBinding(e => e[t])
                        }
                    }
                }
            }

            _setUpBindToBinding(t) {
                const e = this._bindToCollection;
                const i = (i, n, o) => {
                    const r = e._bindToCollection == this;
                    const s = e._bindToInternalToExternalMap.get(n);
                    if (r && s) {
                        this._bindToExternalToInternalMap.set(n, s);
                        this._bindToInternalToExternalMap.set(s, n)
                    } else {
                        const i = t(n);
                        if (!i) {
                            this._skippedIndexesFromExternal.push(o);
                            return
                        }
                        let r = o;
                        for (const t of this._skippedIndexesFromExternal) {
                            if (o > t) {
                                r--
                            }
                        }
                        for (const t of e._skippedIndexesFromExternal) {
                            if (r >= t) {
                                r++
                            }
                        }
                        this._bindToExternalToInternalMap.set(n, i);
                        this._bindToInternalToExternalMap.set(i, n);
                        this.add(i, r);
                        for (let t = 0; t < e._skippedIndexesFromExternal.length; t++) {
                            if (r <= e._skippedIndexesFromExternal[t]) {
                                e._skippedIndexesFromExternal[t]++
                            }
                        }
                    }
                };
                for (const t of e) {
                    i(null, t, e.getIndex(t))
                }
                this.listenTo(e, "add", i);
                this.listenTo(e, "remove", (t, e, i) => {
                    const n = this._bindToExternalToInternalMap.get(e);
                    if (n) {
                        this.remove(n)
                    }
                    this._skippedIndexesFromExternal = this._skippedIndexesFromExternal.reduce((t, e) => {
                        if (i < e) {
                            t.push(e - 1)
                        }
                        if (i > e) {
                            t.push(e)
                        }
                        return t
                    }, [])
                })
            }

            [Symbol.iterator]() {
                return this._items[Symbol.iterator]()
            }
        }

        vs(ys, ds);

        class xs {
            constructor(t, e = [], i = []) {
                this._context = t;
                this._plugins = new Map;
                this._availablePlugins = new Map;
                for (const t of e) {
                    if (t.pluginName) {
                        this._availablePlugins.set(t.pluginName, t)
                    }
                }
                this._contextPlugins = new Map;
                for (const [t, e] of i) {
                    this._contextPlugins.set(t, e);
                    this._contextPlugins.set(e, t);
                    if (t.pluginName) {
                        this._availablePlugins.set(t.pluginName, t)
                    }
                }
            }

            * [Symbol.iterator]() {
                for (const t of this._plugins) {
                    if (typeof t[0] == "function") {
                        yield t
                    }
                }
            }

            get(t) {
                const e = this._plugins.get(t);
                if (!e) {
                    const e = "plugincollection-plugin-not-loaded: The requested plugin is not loaded.";
                    let i = t;
                    if (typeof t == "function") {
                        i = t.pluginName || t.name
                    }
                    throw new ss["b"](e, this._context, {plugin: i})
                }
                return e
            }

            has(t) {
                return this._plugins.has(t)
            }

            init(t, e = []) {
                const i = this;
                const n = this._context;
                const o = new Set;
                const r = [];
                const s = g(t);
                const a = g(e);
                const c = f(t);
                if (c) {
                    const t = "plugincollection-plugin-not-found: Some plugins are not available and could not be loaded.";
                    console.error(Object(ss["a"])(t), {plugins: c});
                    return Promise.reject(new ss["b"](t, n, {plugins: c}))
                }
                return Promise.all(s.map(l)).then(() => d(r, "init")).then(() => d(r, "afterInit")).then(() => r);

                function l(t) {
                    if (a.includes(t)) {
                        return
                    }
                    if (i._plugins.has(t) || o.has(t)) {
                        return
                    }
                    return u(t).catch(e => {
                        console.error(Object(ss["a"])("plugincollection-load: It was not possible to load the plugin."), {plugin: t});
                        throw e
                    })
                }

                function d(t, e) {
                    return t.reduce((t, n) => {
                        if (!n[e]) {
                            return t
                        }
                        if (i._contextPlugins.has(n)) {
                            return t
                        }
                        return t.then(n[e].bind(n))
                    }, Promise.resolve())
                }

                function u(t) {
                    return new Promise(s => {
                        o.add(t);
                        if (t.requires) {
                            t.requires.forEach(i => {
                                const o = h(i);
                                if (t.isContextPlugin && !o.isContextPlugin) {
                                    throw new ss["b"]("plugincollection-context-required: Context plugin can not require plugin which is not a context plugin", null, {
                                        plugin: o.name,
                                        requiredBy: t.name
                                    })
                                }
                                if (e.includes(o)) {
                                    throw new ss["b"]("plugincollection-required: Cannot load a plugin because one of its dependencies is listed in" + "the `removePlugins` option.", n, {
                                        plugin: o.name,
                                        requiredBy: t.name
                                    })
                                }
                                l(o)
                            })
                        }
                        const a = i._contextPlugins.get(t) || new t(n);
                        i._add(t, a);
                        r.push(a);
                        s()
                    })
                }

                function h(t) {
                    if (typeof t == "function") {
                        return t
                    }
                    return i._availablePlugins.get(t)
                }

                function f(t) {
                    const e = [];
                    for (const i of t) {
                        if (!h(i)) {
                            e.push(i)
                        }
                    }
                    return e.length ? e : null
                }

                function g(t) {
                    return t.map(t => h(t)).filter(t => !!t)
                }
            }

            destroy() {
                const t = [];
                for (const [, e] of this) {
                    if (typeof e.destroy == "function" && !this._contextPlugins.has(e)) {
                        t.push(e.destroy())
                    }
                }
                return Promise.all(t)
            }

            _add(t, e) {
                this._plugins.set(t, e);
                const i = t.pluginName;
                if (!i) {
                    return
                }
                if (this._plugins.has(i)) {
                    throw new ss["b"]("plugincollection-plugin-name-conflict: Two plugins with the same name were loaded.", null, {
                        pluginName: i,
                        plugin1: this._plugins.get(i).constructor,
                        plugin2: t
                    })
                }
                this._plugins.set(i, e)
            }
        }

        vs(xs, ds);
        if (!window.CKEDITOR_TRANSLATIONS) {
            window.CKEDITOR_TRANSLATIONS = {}
        }

        function Cs(t, e) {
            const i = window.CKEDITOR_TRANSLATIONS[t] || (window.CKEDITOR_TRANSLATIONS[t] = {});
            Object.assign(i, e)
        }

        function As(t, e) {
            const i = Ss();
            if (i === 1) {
                t = Object.keys(window.CKEDITOR_TRANSLATIONS)[0]
            }
            if (i === 0 || !Ps(t, e)) {
                return e.replace(/ \[context: [^\]]+\]$/, "")
            }
            const n = window.CKEDITOR_TRANSLATIONS[t];
            return n[e].replace(/ \[context: [^\]]+\]$/, "")
        }

        function Ts() {
            window.CKEDITOR_TRANSLATIONS = {}
        }

        function Ps(t, e) {
            return t in window.CKEDITOR_TRANSLATIONS && e in window.CKEDITOR_TRANSLATIONS[t]
        }

        function Ss() {
            return Object.keys(window.CKEDITOR_TRANSLATIONS).length
        }

        const Es = ["ar", "fa", "he", "ku", "ug"];

        class Rs {
            constructor(t = {}) {
                this.uiLanguage = t.uiLanguage || "en";
                this.contentLanguage = t.contentLanguage || this.uiLanguage;
                this.uiLanguageDirection = Os(this.uiLanguage);
                this.contentLanguageDirection = Os(this.contentLanguage);
                this.t = (...t) => this._t(...t)
            }

            get language() {
                console.warn("locale-deprecated-language-property: " + "The Locale#language property has been deprecated and will be removed in the near future. " + "Please use #uiLanguage and #contentLanguage properties instead.");
                return this.uiLanguage
            }

            _t(t, e) {
                let i = As(this.uiLanguage, t);
                if (e) {
                    i = i.replace(/%(\d+)/g, (t, i) => i < e.length ? e[i] : t)
                }
                return i
            }
        }

        function Os(t) {
            return Es.includes(t) ? "rtl" : "ltr"
        }

        class Is {
            constructor(t) {
                this.config = new Jr(t, this.constructor.defaultConfig);
                const e = this.constructor.builtinPlugins;
                this.config.define("plugins", e);
                this.plugins = new xs(this, e);
                const i = this.config.get("language") || {};
                this.locale = new Rs({
                    uiLanguage: typeof i === "string" ? i : i.ui,
                    contentLanguage: this.config.get("language.content")
                });
                this.t = this.locale.t;
                this.editors = new ys;
                this._contextOwner = null
            }

            initPlugins() {
                const t = this.config.get("plugins") || [];
                for (const e of t) {
                    if (typeof e != "function") {
                        throw new ss["b"]("context-initplugins-constructor-only: Only a constructor function is allowed as a context plugin.", null, {Plugin: e})
                    }
                    if (e.isContextPlugin !== true) {
                        throw new ss["b"]("context-initplugins-invalid-plugin: Only a plugin marked as a context plugin is allowed to be used with a context.", null, {Plugin: e})
                    }
                }
                return this.plugins.init(t)
            }

            destroy() {
                return Promise.all(Array.from(this.editors, t => t.destroy())).then(() => this.plugins.destroy())
            }

            _addEditor(t, e) {
                if (this._contextOwner) {
                    throw new ss["b"]("context-addEditor-private-context: Cannot add multiple editors to the context which is created by the editor.")
                }
                this.editors.add(t);
                if (e) {
                    this._contextOwner = t
                }
            }

            _removeEditor(t) {
                if (this.editors.has(t)) {
                    this.editors.remove(t)
                }
                if (this._contextOwner === t) {
                    return this.destroy()
                }
                return Promise.resolve()
            }

            _getEditorConfig() {
                const t = {};
                for (const e of this.config.names()) {
                    if (!["plugins", "removePlugins", "extraPlugins"].includes(e)) {
                        t[e] = this.config.get(e)
                    }
                }
                return t
            }

            static create(t) {
                return new Promise(e => {
                    const i = new this(t);
                    e(i.initPlugins().then(() => i))
                })
            }
        }

        function Vs(t, e) {
            const i = Math.min(t.length, e.length);
            for (let n = 0; n < i; n++) {
                if (t[n] != e[n]) {
                    return n
                }
            }
            if (t.length == e.length) {
                return "same"
            } else if (t.length < e.length) {
                return "prefix"
            } else {
                return "extension"
            }
        }

        var Ns = 4;

        function Ms(t) {
            return Hr(t, Ns)
        }

        var Bs = Ms;

        class zs {
            constructor(t) {
                this.document = t;
                this.parent = null
            }

            get index() {
                let t;
                if (!this.parent) {
                    return null
                }
                if ((t = this.parent.getChildIndex(this)) == -1) {
                    throw new ss["b"]("view-node-not-found-in-parent: The node's parent does not contain this node.", this)
                }
                return t
            }

            get nextSibling() {
                const t = this.index;
                return t !== null && this.parent.getChild(t + 1) || null
            }

            get previousSibling() {
                const t = this.index;
                return t !== null && this.parent.getChild(t - 1) || null
            }

            get root() {
                let t = this;
                while (t.parent) {
                    t = t.parent
                }
                return t
            }

            isAttached() {
                return this.root.is("rootElement")
            }

            getPath() {
                const t = [];
                let e = this;
                while (e.parent) {
                    t.unshift(e.index);
                    e = e.parent
                }
                return t
            }

            getAncestors(t = {includeSelf: false, parentFirst: false}) {
                const e = [];
                let i = t.includeSelf ? this : this.parent;
                while (i) {
                    e[t.parentFirst ? "push" : "unshift"](i);
                    i = i.parent
                }
                return e
            }

            getCommonAncestor(t, e = {}) {
                const i = this.getAncestors(e);
                const n = t.getAncestors(e);
                let o = 0;
                while (i[o] == n[o] && i[o]) {
                    o++
                }
                return o === 0 ? null : i[o - 1]
            }

            isBefore(t) {
                if (this == t) {
                    return false
                }
                if (this.root !== t.root) {
                    return false
                }
                const e = this.getPath();
                const i = t.getPath();
                const n = Vs(e, i);
                switch (n) {
                    case"prefix":
                        return true;
                    case"extension":
                        return false;
                    default:
                        return e[n] < i[n]
                }
            }

            isAfter(t) {
                if (this == t) {
                    return false
                }
                if (this.root !== t.root) {
                    return false
                }
                return !this.isBefore(t)
            }

            _remove() {
                this.parent._removeChildren(this.index)
            }

            _fireChange(t, e) {
                this.fire("change:" + t, e);
                if (this.parent) {
                    this.parent._fireChange(t, e)
                }
            }

            toJSON() {
                const t = Bs(this);
                delete t.parent;
                return t
            }

            is(t) {
                return t == "node" || t == "view:node"
            }
        }

        vs(zs, ds);

        class Ls extends zs {
            constructor(t, e) {
                super(t);
                this._textData = e
            }

            is(t) {
                return t == "text" || t == "view:text" || super.is(t)
            }

            get data() {
                return this._textData
            }

            get _data() {
                return this.data
            }

            set _data(t) {
                this._fireChange("text", this);
                this._textData = t
            }

            isSimilar(t) {
                if (!(t instanceof Ls)) {
                    return false
                }
                return this === t || this.data === t.data
            }

            _clone() {
                return new Ls(this.document, this.data)
            }
        }

        class Fs {
            constructor(t, e, i) {
                this.textNode = t;
                if (e < 0 || e > t.data.length) {
                    throw new ss["b"]("view-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.", this)
                }
                if (i < 0 || e + i > t.data.length) {
                    throw new ss["b"]("view-textproxy-wrong-length: Given length value is incorrect.", this)
                }
                this.data = t.data.substring(e, e + i);
                this.offsetInText = e
            }

            get offsetSize() {
                return this.data.length
            }

            get isPartial() {
                return this.data.length !== this.textNode.data.length
            }

            get parent() {
                return this.textNode.parent
            }

            get root() {
                return this.textNode.root
            }

            get document() {
                return this.textNode.document
            }

            is(t) {
                return t == "textProxy" || t == "view:textProxy"
            }

            getAncestors(t = {includeSelf: false, parentFirst: false}) {
                const e = [];
                let i = t.includeSelf ? this.textNode : this.parent;
                while (i !== null) {
                    e[t.parentFirst ? "push" : "unshift"](i);
                    i = i.parent
                }
                return e
            }
        }

        function Ds(t) {
            const e = new Map;
            for (const i in t) {
                e.set(i, t[i])
            }
            return e
        }

        function js(t) {
            return !!(t && t[Symbol.iterator])
        }

        function Hs(t) {
            if (js(t)) {
                return new Map(t)
            } else {
                return Ds(t)
            }
        }

        class Ws {
            constructor(...t) {
                this._patterns = [];
                this.add(...t)
            }

            add(...t) {
                for (let e of t) {
                    if (typeof e == "string" || e instanceof RegExp) {
                        e = {name: e}
                    }
                    if (e.classes && (typeof e.classes == "string" || e.classes instanceof RegExp)) {
                        e.classes = [e.classes]
                    }
                    this._patterns.push(e)
                }
            }

            match(...t) {
                for (const e of t) {
                    for (const t of this._patterns) {
                        const i = qs(e, t);
                        if (i) {
                            return {element: e, pattern: t, match: i}
                        }
                    }
                }
                return null
            }

            matchAll(...t) {
                const e = [];
                for (const i of t) {
                    for (const t of this._patterns) {
                        const n = qs(i, t);
                        if (n) {
                            e.push({element: i, pattern: t, match: n})
                        }
                    }
                }
                return e.length > 0 ? e : null
            }

            getElementName() {
                if (this._patterns.length !== 1) {
                    return null
                }
                const t = this._patterns[0];
                const e = t.name;
                return typeof t != "function" && e && !(e instanceof RegExp) ? e : null
            }
        }

        function qs(t, e) {
            if (typeof e == "function") {
                return e(t)
            }
            const i = {};
            if (e.name) {
                i.name = Us(e.name, t.name);
                if (!i.name) {
                    return null
                }
            }
            if (e.attributes) {
                i.attributes = $s(e.attributes, t);
                if (!i.attributes) {
                    return null
                }
            }
            if (e.classes) {
                i.classes = Gs(e.classes, t);
                if (!i.classes) {
                    return false
                }
            }
            if (e.styles) {
                i.styles = Ks(e.styles, t);
                if (!i.styles) {
                    return false
                }
            }
            return i
        }

        function Us(t, e) {
            if (t instanceof RegExp) {
                return t.test(e)
            }
            return t === e
        }

        function $s(t, e) {
            const i = [];
            for (const n in t) {
                const o = t[n];
                if (e.hasAttribute(n)) {
                    const t = e.getAttribute(n);
                    if (o === true) {
                        i.push(n)
                    } else if (o instanceof RegExp) {
                        if (o.test(t)) {
                            i.push(n)
                        } else {
                            return null
                        }
                    } else if (t === o) {
                        i.push(n)
                    } else {
                        return null
                    }
                } else {
                    return null
                }
            }
            return i
        }

        function Gs(t, e) {
            const i = [];
            for (const n of t) {
                if (n instanceof RegExp) {
                    const t = e.getClassNames();
                    for (const e of t) {
                        if (n.test(e)) {
                            i.push(e)
                        }
                    }
                    if (i.length === 0) {
                        return null
                    }
                } else if (e.hasClass(n)) {
                    i.push(n)
                } else {
                    return null
                }
            }
            return i
        }

        function Ks(t, e) {
            const i = [];
            for (const n in t) {
                const o = t[n];
                if (e.hasStyle(n)) {
                    const t = e.getStyle(n);
                    if (o instanceof RegExp) {
                        if (o.test(t)) {
                            i.push(n)
                        } else {
                            return null
                        }
                    } else if (t === o) {
                        i.push(n)
                    } else {
                        return null
                    }
                } else {
                    return null
                }
            }
            return i
        }

        var Js = "[object Symbol]";

        function Ys(t) {
            return typeof t == "symbol" || T(t) && _(t) == Js
        }

        var Qs = Ys;
        var Xs = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, Zs = /^\w*$/;

        function ta(t, e) {
            if (Je(t)) {
                return false
            }
            var i = typeof t;
            if (i == "number" || i == "symbol" || i == "boolean" || t == null || Qs(t)) {
                return true
            }
            return Zs.test(t) || !Xs.test(t) || e != null && t in Object(e)
        }

        var ea = ta;
        var ia = "Expected a function";

        function na(t, e) {
            if (typeof t != "function" || e != null && typeof e != "function") {
                throw new TypeError(ia)
            }
            var i = function () {
                var n = arguments, o = e ? e.apply(this, n) : n[0], r = i.cache;
                if (r.has(o)) {
                    return r.get(o)
                }
                var s = t.apply(this, n);
                i.cache = r.set(o, s) || r;
                return s
            };
            i.cache = new (na.Cache || _e);
            return i
        }

        na.Cache = _e;
        var oa = na;
        var ra = 500;

        function sa(t) {
            var e = oa(t, (function (t) {
                if (i.size === ra) {
                    i.clear()
                }
                return t
            }));
            var i = e.cache;
            return e
        }

        var aa = sa;
        var ca = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;
        var la = /\\(\\)?/g;
        var da = aa((function (t) {
            var e = [];
            if (t.charCodeAt(0) === 46) {
                e.push("")
            }
            t.replace(ca, (function (t, i, n, o) {
                e.push(n ? o.replace(la, "$1") : i || t)
            }));
            return e
        }));
        var ua = da;

        function ha(t, e) {
            var i = -1, n = t == null ? 0 : t.length, o = Array(n);
            while (++i < n) {
                o[i] = e(t[i], i, t)
            }
            return o
        }

        var fa = ha;
        var ga = 1 / 0;
        var ma = r ? r.prototype : undefined, pa = ma ? ma.toString : undefined;

        function ba(t) {
            if (typeof t == "string") {
                return t
            }
            if (Je(t)) {
                return fa(t, ba) + ""
            }
            if (Qs(t)) {
                return pa ? pa.call(t) : ""
            }
            var e = t + "";
            return e == "0" && 1 / t == -ga ? "-0" : e
        }

        var wa = ba;

        function ka(t) {
            return t == null ? "" : wa(t)
        }

        var _a = ka;

        function va(t, e) {
            if (Je(t)) {
                return t
            }
            return ea(t, e) ? [t] : ua(_a(t))
        }

        var ya = va;

        function xa(t) {
            var e = t == null ? 0 : t.length;
            return e ? t[e - 1] : undefined
        }

        var Ca = xa;
        var Aa = 1 / 0;

        function Ta(t) {
            if (typeof t == "string" || Qs(t)) {
                return t
            }
            var e = t + "";
            return e == "0" && 1 / t == -Aa ? "-0" : e
        }

        var Pa = Ta;

        function Sa(t, e) {
            e = ya(e, t);
            var i = 0, n = e.length;
            while (t != null && i < n) {
                t = t[Pa(e[i++])]
            }
            return i && i == n ? t : undefined
        }

        var Ea = Sa;

        function Ra(t, e, i) {
            var n = -1, o = t.length;
            if (e < 0) {
                e = -e > o ? 0 : o + e
            }
            i = i > o ? o : i;
            if (i < 0) {
                i += o
            }
            o = e > i ? 0 : i - e >>> 0;
            e >>>= 0;
            var r = Array(o);
            while (++n < o) {
                r[n] = t[n + e]
            }
            return r
        }

        var Oa = Ra;

        function Ia(t, e) {
            return e.length < 2 ? t : Ea(t, Oa(e, 0, -1))
        }

        var Va = Ia;

        function Na(t, e) {
            e = ya(e, t);
            t = Va(t, e);
            return t == null || delete t[Pa(Ca(e))]
        }

        var Ma = Na;

        function Ba(t, e) {
            return t == null ? true : Ma(t, e)
        }

        var za = Ba;

        function La(t, e, i) {
            var n = t == null ? undefined : Ea(t, e);
            return n === undefined ? i : n
        }

        var Fa = La;

        function Da(t, e, i) {
            if (i !== undefined && !L(t[e], i) || i === undefined && !(e in t)) {
                Oe(t, e, i)
            }
        }

        var ja = Da;

        function Ha(t) {
            return function (e, i, n) {
                var o = -1, r = Object(e), s = n(e), a = s.length;
                while (a--) {
                    var c = s[t ? a : ++o];
                    if (i(r[c], c, r) === false) {
                        break
                    }
                }
                return e
            }
        }

        var Wa = Ha;
        var qa = Wa();
        var Ua = qa;

        function $a(t) {
            return T(t) && Qi(t)
        }

        var Ga = $a;

        function Ka(t, e) {
            if (e === "constructor" && typeof t[e] === "function") {
                return
            }
            if (e == "__proto__") {
                return
            }
            return t[e]
        }

        var Ja = Ka;

        function Ya(t) {
            return ze(t, dn(t))
        }

        var Qa = Ya;

        function Xa(t, e, i, n, o, r, s) {
            var a = Ja(t, i), c = Ja(e, i), l = s.get(c);
            if (l) {
                ja(t, i, l);
                return
            }
            var d = r ? r(a, c, i + "", t, e, s) : undefined;
            var u = d === undefined;
            if (u) {
                var h = Je(c), f = !h && Object(Ye["a"])(c), g = !h && !f && Bi(c);
                d = c;
                if (h || f || g) {
                    if (Je(a)) {
                        d = a
                    } else if (Ga(a)) {
                        d = mn(a)
                    } else if (f) {
                        u = false;
                        d = Object(fn["a"])(c, true)
                    } else if (g) {
                        u = false;
                        d = To(c, true)
                    } else {
                        d = []
                    }
                } else if (N(c) || Ge(c)) {
                    d = a;
                    if (Ge(a)) {
                        d = Qa(a)
                    } else if (!ct(a) || gt(a)) {
                        d = Xo(c)
                    }
                } else {
                    u = false
                }
            }
            if (u) {
                s.set(c, d);
                o(d, c, n, r, s);
                s["delete"](c)
            }
            ja(t, i, d)
        }

        var Za = Xa;

        function tc(t, e, i, n, o) {
            if (t === e) {
                return
            }
            Ua(e, (function (r, s) {
                o || (o = new Ae);
                if (ct(r)) {
                    Za(t, e, s, i, tc, n, o)
                } else {
                    var a = n ? n(Ja(t, s), r, s + "", t, e, o) : undefined;
                    if (a === undefined) {
                        a = r
                    }
                    ja(t, s, a)
                }
            }), dn)
        }

        var ec = tc;

        function ic(t) {
            return t
        }

        var nc = ic;

        function oc(t, e, i) {
            switch (i.length) {
                case 0:
                    return t.call(e);
                case 1:
                    return t.call(e, i[0]);
                case 2:
                    return t.call(e, i[0], i[1]);
                case 3:
                    return t.call(e, i[0], i[1], i[2])
            }
            return t.apply(e, i)
        }

        var rc = oc;
        var sc = Math.max;

        function ac(t, e, i) {
            e = sc(e === undefined ? t.length - 1 : e, 0);
            return function () {
                var n = arguments, o = -1, r = sc(n.length - e, 0), s = Array(r);
                while (++o < r) {
                    s[o] = n[e + o]
                }
                o = -1;
                var a = Array(e + 1);
                while (++o < e) {
                    a[o] = n[o]
                }
                a[e] = i(s);
                return rc(t, this, a)
            }
        }

        var cc = ac;

        function lc(t) {
            return function () {
                return t
            }
        }

        var dc = lc;
        var uc = !Ee ? nc : function (t, e) {
            return Ee(t, "toString", {configurable: true, enumerable: false, value: dc(e), writable: true})
        };
        var hc = uc;
        var fc = 800, gc = 16;
        var mc = Date.now;

        function pc(t) {
            var e = 0, i = 0;
            return function () {
                var n = mc(), o = gc - (n - i);
                i = n;
                if (o > 0) {
                    if (++e >= fc) {
                        return arguments[0]
                    }
                } else {
                    e = 0
                }
                return t.apply(undefined, arguments)
            }
        }

        var bc = pc;
        var wc = bc(hc);
        var kc = wc;

        function _c(t, e) {
            return kc(cc(t, e, nc), t + "")
        }

        var vc = _c;

        function yc(t, e, i) {
            if (!ct(i)) {
                return false
            }
            var n = typeof e;
            if (n == "number" ? Qi(i) && ti(e, i.length) : n == "string" && e in i) {
                return L(i[e], t)
            }
            return false
        }

        var xc = yc;

        function Cc(t) {
            return vc((function (e, i) {
                var n = -1, o = i.length, r = o > 1 ? i[o - 1] : undefined, s = o > 2 ? i[2] : undefined;
                r = t.length > 3 && typeof r == "function" ? (o--, r) : undefined;
                if (s && xc(i[0], i[1], s)) {
                    r = o < 3 ? undefined : r;
                    o = 1
                }
                e = Object(e);
                while (++n < o) {
                    var a = i[n];
                    if (a) {
                        t(e, a, n, r)
                    }
                }
                return e
            }))
        }

        var Ac = Cc;
        var Tc = Ac((function (t, e, i) {
            ec(t, e, i)
        }));
        var Pc = Tc;

        function Sc(t, e, i, n) {
            if (!ct(t)) {
                return t
            }
            e = ya(e, t);
            var o = -1, r = e.length, s = r - 1, a = t;
            while (a != null && ++o < r) {
                var c = Pa(e[o]), l = i;
                if (o != s) {
                    var d = a[c];
                    l = n ? n(d, c, a) : undefined;
                    if (l === undefined) {
                        l = ct(d) ? d : ti(e[o + 1]) ? [] : {}
                    }
                }
                Me(a, c, l);
                a = a[c]
            }
            return t
        }

        var Ec = Sc;

        function Rc(t, e, i) {
            return t == null ? t : Ec(t, e, i)
        }

        var Oc = Rc;

        class Ic {
            constructor(t) {
                this._styles = {};
                this._styleProcessor = t
            }

            get isEmpty() {
                const t = Object.entries(this._styles);
                const e = Array.from(t);
                return !e.length
            }

            get size() {
                if (this.isEmpty) {
                    return 0
                }
                return this.getStyleNames().length
            }

            setTo(t) {
                this.clear();
                const e = Array.from(Nc(t).entries());
                for (const [t, i] of e) {
                    this._styleProcessor.toNormalizedForm(t, i, this._styles)
                }
            }

            has(t) {
                if (this.isEmpty) {
                    return false
                }
                const e = this._styleProcessor.getReducedForm(t, this._styles);
                const i = e.find(([e]) => e === t);
                return Array.isArray(i)
            }

            set(t, e) {
                if (ct(t)) {
                    for (const [e, i] of Object.entries(t)) {
                        this._styleProcessor.toNormalizedForm(e, i, this._styles)
                    }
                } else {
                    this._styleProcessor.toNormalizedForm(t, e, this._styles)
                }
            }

            remove(t) {
                const e = Mc(t);
                za(this._styles, e);
                delete this._styles[t];
                this._cleanEmptyObjectsOnPath(e)
            }

            getNormalized(t) {
                return this._styleProcessor.getNormalized(t, this._styles)
            }

            toString() {
                if (this.isEmpty) {
                    return ""
                }
                return this._getStylesEntries().map(t => t.join(":")).sort().join(";") + ";"
            }

            getAsString(t) {
                if (this.isEmpty) {
                    return
                }
                if (this._styles[t] && !ct(this._styles[t])) {
                    return this._styles[t]
                }
                const e = this._styleProcessor.getReducedForm(t, this._styles);
                const i = e.find(([e]) => e === t);
                if (Array.isArray(i)) {
                    return i[1]
                }
            }

            getStyleNames() {
                if (this.isEmpty) {
                    return []
                }
                const t = this._getStylesEntries();
                return t.map(([t]) => t)
            }

            clear() {
                this._styles = {}
            }

            _getStylesEntries() {
                const t = [];
                const e = Object.keys(this._styles);
                for (const i of e) {
                    t.push(...this._styleProcessor.getReducedForm(i, this._styles))
                }
                return t
            }

            _cleanEmptyObjectsOnPath(t) {
                const e = t.split(".");
                const i = e.length > 1;
                if (!i) {
                    return
                }
                const n = e.splice(0, e.length - 1).join(".");
                const o = Fa(this._styles, n);
                if (!o) {
                    return
                }
                const r = !Array.from(Object.keys(o)).length;
                if (r) {
                    this.remove(n)
                }
            }
        }

        class Vc {
            constructor() {
                this._normalizers = new Map;
                this._extractors = new Map;
                this._reducers = new Map;
                this._consumables = new Map
            }

            toNormalizedForm(t, e, i) {
                if (ct(e)) {
                    Bc(i, Mc(t), e);
                    return
                }
                if (this._normalizers.has(t)) {
                    const n = this._normalizers.get(t);
                    const {path: o, value: r} = n(e);
                    Bc(i, o, r)
                } else {
                    Bc(i, t, e)
                }
            }

            getNormalized(t, e) {
                if (!t) {
                    return Pc({}, e)
                }
                if (e[t] !== undefined) {
                    return e[t]
                }
                if (this._extractors.has(t)) {
                    const i = this._extractors.get(t);
                    if (typeof i === "string") {
                        return Fa(e, i)
                    }
                    const n = i(t, e);
                    if (n) {
                        return n
                    }
                }
                return Fa(e, Mc(t))
            }

            getReducedForm(t, e) {
                const i = this.getNormalized(t, e);
                if (i === undefined) {
                    return []
                }
                if (this._reducers.has(t)) {
                    const e = this._reducers.get(t);
                    return e(i)
                }
                return [[t, i]]
            }

            getRelatedStyles(t) {
                return this._consumables.get(t) || []
            }

            setNormalizer(t, e) {
                this._normalizers.set(t, e)
            }

            setExtractor(t, e) {
                this._extractors.set(t, e)
            }

            setReducer(t, e) {
                this._reducers.set(t, e)
            }

            setStyleRelation(t, e) {
                this._mapStyleNames(t, e);
                for (const i of e) {
                    this._mapStyleNames(i, [t])
                }
            }

            _mapStyleNames(t, e) {
                if (!this._consumables.has(t)) {
                    this._consumables.set(t, [])
                }
                this._consumables.get(t).push(...e)
            }
        }

        function Nc(t) {
            let e = null;
            let i = 0;
            let n = 0;
            let o = null;
            const r = new Map;
            if (t === "") {
                return r
            }
            if (t.charAt(t.length - 1) != ";") {
                t = t + ";"
            }
            for (let s = 0; s < t.length; s++) {
                const a = t.charAt(s);
                if (e === null) {
                    switch (a) {
                        case":":
                            if (!o) {
                                o = t.substr(i, s - i);
                                n = s + 1
                            }
                            break;
                        case'"':
                        case"'":
                            e = a;
                            break;
                        case";": {
                            const e = t.substr(n, s - n);
                            if (o) {
                                r.set(o.trim(), e.trim())
                            }
                            o = null;
                            i = s + 1;
                            break
                        }
                    }
                } else if (a === e) {
                    e = null
                }
            }
            return r
        }

        function Mc(t) {
            return t.replace("-", ".")
        }

        function Bc(t, e, i) {
            let n = i;
            if (ct(i)) {
                n = Pc({}, Fa(t, e), i)
            }
            Oc(t, e, n)
        }

        class zc extends zs {
            constructor(t, e, i, n) {
                super(t);
                this.name = e;
                this._attrs = Lc(i);
                this._children = [];
                if (n) {
                    this._insertChild(0, n)
                }
                this._classes = new Set;
                if (this._attrs.has("class")) {
                    const t = this._attrs.get("class");
                    Fc(this._classes, t);
                    this._attrs.delete("class")
                }
                this._styles = new Ic(this.document.stylesProcessor);
                if (this._attrs.has("style")) {
                    this._styles.setTo(this._attrs.get("style"));
                    this._attrs.delete("style")
                }
                this._customProperties = new Map
            }

            get childCount() {
                return this._children.length
            }

            get isEmpty() {
                return this._children.length === 0
            }

            is(t, e = null) {
                const i = t.replace(/^view:/, "");
                if (!e) {
                    return i == "element" || i == this.name || super.is(t)
                } else {
                    return i == "element" && e == this.name
                }
            }

            getChild(t) {
                return this._children[t]
            }

            getChildIndex(t) {
                return this._children.indexOf(t)
            }

            getChildren() {
                return this._children[Symbol.iterator]()
            }

            * getAttributeKeys() {
                if (this._classes.size > 0) {
                    yield"class"
                }
                if (!this._styles.isEmpty) {
                    yield"style"
                }
                yield* this._attrs.keys()
            }

            * getAttributes() {
                yield* this._attrs.entries();
                if (this._classes.size > 0) {
                    yield["class", this.getAttribute("class")]
                }
                if (!this._styles.isEmpty) {
                    yield["style", this.getAttribute("style")]
                }
            }

            getAttribute(t) {
                if (t == "class") {
                    if (this._classes.size > 0) {
                        return [...this._classes].join(" ")
                    }
                    return undefined
                }
                if (t == "style") {
                    const t = this._styles.toString();
                    return t == "" ? undefined : t
                }
                return this._attrs.get(t)
            }

            hasAttribute(t) {
                if (t == "class") {
                    return this._classes.size > 0
                }
                if (t == "style") {
                    return !this._styles.isEmpty
                }
                return this._attrs.has(t)
            }

            isSimilar(t) {
                if (!(t instanceof zc)) {
                    return false
                }
                if (this === t) {
                    return true
                }
                if (this.name != t.name) {
                    return false
                }
                if (this._attrs.size !== t._attrs.size || this._classes.size !== t._classes.size || this._styles.size !== t._styles.size) {
                    return false
                }
                for (const [e, i] of this._attrs) {
                    if (!t._attrs.has(e) || t._attrs.get(e) !== i) {
                        return false
                    }
                }
                for (const e of this._classes) {
                    if (!t._classes.has(e)) {
                        return false
                    }
                }
                for (const e of this._styles.getStyleNames()) {
                    if (!t._styles.has(e) || t._styles.getAsString(e) !== this._styles.getAsString(e)) {
                        return false
                    }
                }
                return true
            }

            hasClass(...t) {
                for (const e of t) {
                    if (!this._classes.has(e)) {
                        return false
                    }
                }
                return true
            }

            getClassNames() {
                return this._classes.keys()
            }

            getStyle(t) {
                return this._styles.getAsString(t)
            }

            getNormalizedStyle(t) {
                return this._styles.getNormalized(t)
            }

            getStyleNames() {
                return this._styles.getStyleNames()
            }

            hasStyle(...t) {
                for (const e of t) {
                    if (!this._styles.has(e)) {
                        return false
                    }
                }
                return true
            }

            findAncestor(...t) {
                const e = new Ws(...t);
                let i = this.parent;
                while (i) {
                    if (e.match(i)) {
                        return i
                    }
                    i = i.parent
                }
                return null
            }

            getCustomProperty(t) {
                return this._customProperties.get(t)
            }

            * getCustomProperties() {
                yield* this._customProperties.entries()
            }

            getIdentity() {
                const t = Array.from(this._classes).sort().join(",");
                const e = this._styles.toString();
                const i = Array.from(this._attrs).map(t => `${t[0]}="${t[1]}"`).sort().join(" ");
                return this.name + (t == "" ? "" : ` class="${t}"`) + (!e ? "" : ` style="${e}"`) + (i == "" ? "" : ` ${i}`)
            }

            _clone(t = false) {
                const e = [];
                if (t) {
                    for (const i of this.getChildren()) {
                        e.push(i._clone(t))
                    }
                }
                const i = new this.constructor(this.document, this.name, this._attrs, e);
                i._classes = new Set(this._classes);
                i._styles.set(this._styles.getNormalized());
                i._customProperties = new Map(this._customProperties);
                i.getFillerOffset = this.getFillerOffset;
                return i
            }

            _appendChild(t) {
                return this._insertChild(this.childCount, t)
            }

            _insertChild(t, e) {
                this._fireChange("children", this);
                let i = 0;
                const n = Dc(this.document, e);
                for (const e of n) {
                    if (e.parent !== null) {
                        e._remove()
                    }
                    e.parent = this;
                    e.document = this.document;
                    this._children.splice(t, 0, e);
                    t++;
                    i++
                }
                return i
            }

            _removeChildren(t, e = 1) {
                this._fireChange("children", this);
                for (let i = t; i < t + e; i++) {
                    this._children[i].parent = null
                }
                return this._children.splice(t, e)
            }

            _setAttribute(t, e) {
                e = String(e);
                this._fireChange("attributes", this);
                if (t == "class") {
                    Fc(this._classes, e)
                } else if (t == "style") {
                    this._styles.setTo(e)
                } else {
                    this._attrs.set(t, e)
                }
            }

            _removeAttribute(t) {
                this._fireChange("attributes", this);
                if (t == "class") {
                    if (this._classes.size > 0) {
                        this._classes.clear();
                        return true
                    }
                    return false
                }
                if (t == "style") {
                    if (!this._styles.isEmpty) {
                        this._styles.clear();
                        return true
                    }
                    return false
                }
                return this._attrs.delete(t)
            }

            _addClass(t) {
                this._fireChange("attributes", this);
                t = Array.isArray(t) ? t : [t];
                t.forEach(t => this._classes.add(t))
            }

            _removeClass(t) {
                this._fireChange("attributes", this);
                t = Array.isArray(t) ? t : [t];
                t.forEach(t => this._classes.delete(t))
            }

            _setStyle(t, e) {
                this._fireChange("attributes", this);
                this._styles.set(t, e)
            }

            _removeStyle(t) {
                this._fireChange("attributes", this);
                t = Array.isArray(t) ? t : [t];
                t.forEach(t => this._styles.remove(t))
            }

            _setCustomProperty(t, e) {
                this._customProperties.set(t, e)
            }

            _removeCustomProperty(t) {
                return this._customProperties.delete(t)
            }
        }

        function Lc(t) {
            t = Hs(t);
            for (const [e, i] of t) {
                if (i === null) {
                    t.delete(e)
                } else if (typeof i != "string") {
                    t.set(e, String(i))
                }
            }
            return t
        }

        function Fc(t, e) {
            const i = e.split(/\s+/);
            t.clear();
            i.forEach(e => t.add(e))
        }

        function Dc(t, e) {
            if (typeof e == "string") {
                return [new Ls(t, e)]
            }
            if (!js(e)) {
                e = [e]
            }
            return Array.from(e).map(e => {
                if (typeof e == "string") {
                    return new Ls(t, e)
                }
                if (e instanceof Fs) {
                    return new Ls(t, e.data)
                }
                return e
            })
        }

        class jc extends zc {
            constructor(t, e, i, n) {
                super(t, e, i, n);
                this.getFillerOffset = Hc
            }

            is(t, e = null) {
                const i = t && t.replace(/^view:/, "");
                if (!e) {
                    return i == "containerElement" || super.is(t)
                } else {
                    return i == "containerElement" && e == this.name || super.is(t, e)
                }
            }
        }

        function Hc() {
            const t = [...this.getChildren()];
            const e = t[this.childCount - 1];
            if (e && e.is("element", "br")) {
                return this.childCount
            }
            for (const e of t) {
                if (!e.is("uiElement")) {
                    return null
                }
            }
            return this.childCount
        }

        var Wc = Ac((function (t, e) {
            ze(e, dn(e), t)
        }));
        var qc = Wc;
        const Uc = Symbol("observableProperties");
        const $c = Symbol("boundObservables");
        const Gc = Symbol("boundProperties");
        const Kc = {
            set(t, e) {
                if (ct(t)) {
                    Object.keys(t).forEach(e => {
                        this.set(e, t[e])
                    }, this);
                    return
                }
                Yc(this);
                const i = this[Uc];
                if (t in this && !i.has(t)) {
                    throw new ss["b"]("observable-set-cannot-override: Cannot override an existing property.", this)
                }
                Object.defineProperty(this, t, {
                    enumerable: true, configurable: true, get() {
                        return i.get(t)
                    }, set(e) {
                        const n = i.get(t);
                        let o = this.fire("set:" + t, t, e, n);
                        if (o === undefined) {
                            o = e
                        }
                        if (n !== o || !i.has(t)) {
                            i.set(t, o);
                            this.fire("change:" + t, t, o, n)
                        }
                    }
                });
                this[t] = e
            }, bind(...t) {
                if (!t.length || !tl(t)) {
                    throw new ss["b"]("observable-bind-wrong-properties: All properties must be strings.", this)
                }
                if (new Set(t).size !== t.length) {
                    throw new ss["b"]("observable-bind-duplicate-properties: Properties must be unique.", this)
                }
                Yc(this);
                const e = this[Gc];
                t.forEach(t => {
                    if (e.has(t)) {
                        throw new ss["b"]("observable-bind-rebind: Cannot bind the same property more than once.", this)
                    }
                });
                const i = new Map;
                t.forEach(t => {
                    const n = {property: t, to: []};
                    e.set(t, n);
                    i.set(t, n)
                });
                return {to: Qc, toMany: Xc, _observable: this, _bindProperties: t, _to: [], _bindings: i}
            }, unbind(...t) {
                if (!(Uc in this)) {
                    return
                }
                const e = this[Gc];
                const i = this[$c];
                if (t.length) {
                    if (!tl(t)) {
                        throw new ss["b"]("observable-unbind-wrong-properties: Properties must be strings.", this)
                    }
                    t.forEach(t => {
                        const n = e.get(t);
                        if (!n) {
                            return
                        }
                        let o, r, s, a;
                        n.to.forEach(t => {
                            o = t[0];
                            r = t[1];
                            s = i.get(o);
                            a = s[r];
                            a.delete(n);
                            if (!a.size) {
                                delete s[r]
                            }
                            if (!Object.keys(s).length) {
                                i.delete(o);
                                this.stopListening(o, "change")
                            }
                        });
                        e.delete(t)
                    })
                } else {
                    i.forEach((t, e) => {
                        this.stopListening(e, "change")
                    });
                    i.clear();
                    e.clear()
                }
            }, decorate(t) {
                const e = this[t];
                if (!e) {
                    throw new ss["b"]("observablemixin-cannot-decorate-undefined: Cannot decorate an undefined method.", this, {
                        object: this,
                        methodName: t
                    })
                }
                this.on(t, (t, i) => {
                    t.return = e.apply(this, i)
                });
                this[t] = function (...e) {
                    return this.fire(t, e)
                }
            }
        };
        qc(Kc, ds);
        var Jc = Kc;

        function Yc(t) {
            if (Uc in t) {
                return
            }
            Object.defineProperty(t, Uc, {value: new Map});
            Object.defineProperty(t, $c, {value: new Map});
            Object.defineProperty(t, Gc, {value: new Map})
        }

        function Qc(...t) {
            const e = el(...t);
            const i = Array.from(this._bindings.keys());
            const n = i.length;
            if (!e.callback && e.to.length > 1) {
                throw new ss["b"]("observable-bind-to-no-callback: Binding multiple observables only possible with callback.", this)
            }
            if (n > 1 && e.callback) {
                throw new ss["b"]("observable-bind-to-extra-callback: Cannot bind multiple properties and use a callback in one binding.", this)
            }
            e.to.forEach(t => {
                if (t.properties.length && t.properties.length !== n) {
                    throw new ss["b"]("observable-bind-to-properties-length: The number of properties must match.", this)
                }
                if (!t.properties.length) {
                    t.properties = this._bindProperties
                }
            });
            this._to = e.to;
            if (e.callback) {
                this._bindings.get(i[0]).callback = e.callback
            }
            rl(this._observable, this._to);
            nl(this);
            this._bindProperties.forEach(t => {
                ol(this._observable, t)
            })
        }

        function Xc(t, e, i) {
            if (this._bindings.size > 1) {
                throw new ss["b"]("observable-bind-to-many-not-one-binding: Cannot bind multiple properties with toMany().", this)
            }
            this.to(...Zc(t, e), i)
        }

        function Zc(t, e) {
            const i = t.map(t => [t, e]);
            return Array.prototype.concat.apply([], i)
        }

        function tl(t) {
            return t.every(t => typeof t == "string")
        }

        function el(...t) {
            if (!t.length) {
                throw new ss["b"]("observable-bind-to-parse-error: Invalid argument syntax in `to()`.", null)
            }
            const e = {to: []};
            let i;
            if (typeof t[t.length - 1] == "function") {
                e.callback = t.pop()
            }
            t.forEach(t => {
                if (typeof t == "string") {
                    i.properties.push(t)
                } else if (typeof t == "object") {
                    i = {observable: t, properties: []};
                    e.to.push(i)
                } else {
                    throw new ss["b"]("observable-bind-to-parse-error: Invalid argument syntax in `to()`.", null)
                }
            });
            return e
        }

        function il(t, e, i, n) {
            const o = t[$c];
            const r = o.get(i);
            const s = r || {};
            if (!s[n]) {
                s[n] = new Set
            }
            s[n].add(e);
            if (!r) {
                o.set(i, s)
            }
        }

        function nl(t) {
            let e;
            t._bindings.forEach((i, n) => {
                t._to.forEach(o => {
                    e = o.properties[i.callback ? 0 : t._bindProperties.indexOf(n)];
                    i.to.push([o.observable, e]);
                    il(t._observable, i, o.observable, e)
                })
            })
        }

        function ol(t, e) {
            const i = t[Gc];
            const n = i.get(e);
            let o;
            if (n.callback) {
                o = n.callback.apply(t, n.to.map(t => t[0][t[1]]))
            } else {
                o = n.to[0];
                o = o[0][o[1]]
            }
            if (t.hasOwnProperty(e)) {
                t[e] = o
            } else {
                t.set(e, o)
            }
        }

        function rl(t, e) {
            e.forEach(e => {
                const i = t[$c];
                let n;
                if (!i.get(e.observable)) {
                    t.listenTo(e.observable, "change", (o, r) => {
                        n = i.get(e.observable)[r];
                        if (n) {
                            n.forEach(e => {
                                ol(t, e.property)
                            })
                        }
                    })
                }
            })
        }

        class sl extends jc {
            constructor(t, e, i, n) {
                super(t, e, i, n);
                this.set("isReadOnly", false);
                this.set("isFocused", false);
                this.bind("isReadOnly").to(t);
                this.bind("isFocused").to(t, "isFocused", e => e && t.selection.editableElement == this);
                this.listenTo(t.selection, "change", () => {
                    this.isFocused = t.isFocused && t.selection.editableElement == this
                })
            }

            is(t, e = null) {
                const i = t && t.replace(/^view:/, "");
                if (!e) {
                    return i == "editableElement" || super.is(t)
                } else {
                    return i == "editableElement" && e == this.name || super.is(t, e)
                }
            }

            destroy() {
                this.stopListening()
            }
        }

        vs(sl, Jc);
        const al = Symbol("rootName");

        class cl extends sl {
            constructor(t, e) {
                super(t, e);
                this.rootName = "main"
            }

            is(t, e = null) {
                const i = t.replace(/^view:/, "");
                if (!e) {
                    return i == "rootElement" || super.is(t)
                } else {
                    return i == "rootElement" && e == this.name || super.is(t, e)
                }
            }

            get rootName() {
                return this.getCustomProperty(al)
            }

            set rootName(t) {
                this._setCustomProperty(al, t)
            }

            set _name(t) {
                this.name = t
            }
        }

        class ll {
            constructor(t = {}) {
                if (!t.boundaries && !t.startPosition) {
                    throw new ss["b"]("view-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.", null)
                }
                if (t.direction && t.direction != "forward" && t.direction != "backward") {
                    throw new ss["b"]("view-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.", t.startPosition, {direction: t.direction})
                }
                this.boundaries = t.boundaries || null;
                if (t.startPosition) {
                    this.position = dl._createAt(t.startPosition)
                } else {
                    this.position = dl._createAt(t.boundaries[t.direction == "backward" ? "end" : "start"])
                }
                this.direction = t.direction || "forward";
                this.singleCharacters = !!t.singleCharacters;
                this.shallow = !!t.shallow;
                this.ignoreElementEnd = !!t.ignoreElementEnd;
                this._boundaryStartParent = this.boundaries ? this.boundaries.start.parent : null;
                this._boundaryEndParent = this.boundaries ? this.boundaries.end.parent : null
            }

            [Symbol.iterator]() {
                return this
            }

            skip(t) {
                let e, i, n;
                do {
                    n = this.position;
                    ({done: e, value: i} = this.next())
                } while (!e && t(i));
                if (!e) {
                    this.position = n
                }
            }

            next() {
                if (this.direction == "forward") {
                    return this._next()
                } else {
                    return this._previous()
                }
            }

            _next() {
                let t = this.position.clone();
                const e = this.position;
                const i = t.parent;
                if (i.parent === null && t.offset === i.childCount) {
                    return {done: true}
                }
                if (i === this._boundaryEndParent && t.offset == this.boundaries.end.offset) {
                    return {done: true}
                }
                let n;
                if (i instanceof Ls) {
                    if (t.isAtEnd) {
                        this.position = dl._createAfter(i);
                        return this._next()
                    }
                    n = i.data[t.offset]
                } else {
                    n = i.getChild(t.offset)
                }
                if (n instanceof zc) {
                    if (!this.shallow) {
                        t = new dl(n, 0)
                    } else {
                        t.offset++
                    }
                    this.position = t;
                    return this._formatReturnValue("elementStart", n, e, t, 1)
                } else if (n instanceof Ls) {
                    if (this.singleCharacters) {
                        t = new dl(n, 0);
                        this.position = t;
                        return this._next()
                    } else {
                        let i = n.data.length;
                        let o;
                        if (n == this._boundaryEndParent) {
                            i = this.boundaries.end.offset;
                            o = new Fs(n, 0, i);
                            t = dl._createAfter(o)
                        } else {
                            o = new Fs(n, 0, n.data.length);
                            t.offset++
                        }
                        this.position = t;
                        return this._formatReturnValue("text", o, e, t, i)
                    }
                } else if (typeof n == "string") {
                    let n;
                    if (this.singleCharacters) {
                        n = 1
                    } else {
                        const e = i === this._boundaryEndParent ? this.boundaries.end.offset : i.data.length;
                        n = e - t.offset
                    }
                    const o = new Fs(i, t.offset, n);
                    t.offset += n;
                    this.position = t;
                    return this._formatReturnValue("text", o, e, t, n)
                } else {
                    t = dl._createAfter(i);
                    this.position = t;
                    if (this.ignoreElementEnd) {
                        return this._next()
                    } else {
                        return this._formatReturnValue("elementEnd", i, e, t)
                    }
                }
            }

            _previous() {
                let t = this.position.clone();
                const e = this.position;
                const i = t.parent;
                if (i.parent === null && t.offset === 0) {
                    return {done: true}
                }
                if (i == this._boundaryStartParent && t.offset == this.boundaries.start.offset) {
                    return {done: true}
                }
                let n;
                if (i instanceof Ls) {
                    if (t.isAtStart) {
                        this.position = dl._createBefore(i);
                        return this._previous()
                    }
                    n = i.data[t.offset - 1]
                } else {
                    n = i.getChild(t.offset - 1)
                }
                if (n instanceof zc) {
                    if (!this.shallow) {
                        t = new dl(n, n.childCount);
                        this.position = t;
                        if (this.ignoreElementEnd) {
                            return this._previous()
                        } else {
                            return this._formatReturnValue("elementEnd", n, e, t)
                        }
                    } else {
                        t.offset--;
                        this.position = t;
                        return this._formatReturnValue("elementStart", n, e, t, 1)
                    }
                } else if (n instanceof Ls) {
                    if (this.singleCharacters) {
                        t = new dl(n, n.data.length);
                        this.position = t;
                        return this._previous()
                    } else {
                        let i = n.data.length;
                        let o;
                        if (n == this._boundaryStartParent) {
                            const e = this.boundaries.start.offset;
                            o = new Fs(n, e, n.data.length - e);
                            i = o.data.length;
                            t = dl._createBefore(o)
                        } else {
                            o = new Fs(n, 0, n.data.length);
                            t.offset--
                        }
                        this.position = t;
                        return this._formatReturnValue("text", o, e, t, i)
                    }
                } else if (typeof n == "string") {
                    let n;
                    if (!this.singleCharacters) {
                        const e = i === this._boundaryStartParent ? this.boundaries.start.offset : 0;
                        n = t.offset - e
                    } else {
                        n = 1
                    }
                    t.offset -= n;
                    const o = new Fs(i, t.offset, n);
                    this.position = t;
                    return this._formatReturnValue("text", o, e, t, n)
                } else {
                    t = dl._createBefore(i);
                    this.position = t;
                    return this._formatReturnValue("elementStart", i, e, t, 1)
                }
            }

            _formatReturnValue(t, e, i, n, o) {
                if (e instanceof Fs) {
                    if (e.offsetInText + e.data.length == e.textNode.data.length) {
                        if (this.direction == "forward" && !(this.boundaries && this.boundaries.end.isEqual(this.position))) {
                            n = dl._createAfter(e.textNode);
                            this.position = n
                        } else {
                            i = dl._createAfter(e.textNode)
                        }
                    }
                    if (e.offsetInText === 0) {
                        if (this.direction == "backward" && !(this.boundaries && this.boundaries.start.isEqual(this.position))) {
                            n = dl._createBefore(e.textNode);
                            this.position = n
                        } else {
                            i = dl._createBefore(e.textNode)
                        }
                    }
                }
                return {done: false, value: {type: t, item: e, previousPosition: i, nextPosition: n, length: o}}
            }
        }

        class dl {
            constructor(t, e) {
                this.parent = t;
                this.offset = e
            }

            get nodeAfter() {
                if (this.parent.is("text")) {
                    return null
                }
                return this.parent.getChild(this.offset) || null
            }

            get nodeBefore() {
                if (this.parent.is("text")) {
                    return null
                }
                return this.parent.getChild(this.offset - 1) || null
            }

            get isAtStart() {
                return this.offset === 0
            }

            get isAtEnd() {
                const t = this.parent.is("text") ? this.parent.data.length : this.parent.childCount;
                return this.offset === t
            }

            get root() {
                return this.parent.root
            }

            get editableElement() {
                let t = this.parent;
                while (!(t instanceof sl)) {
                    if (t.parent) {
                        t = t.parent
                    } else {
                        return null
                    }
                }
                return t
            }

            getShiftedBy(t) {
                const e = dl._createAt(this);
                const i = e.offset + t;
                e.offset = i < 0 ? 0 : i;
                return e
            }

            getLastMatchingPosition(t, e = {}) {
                e.startPosition = this;
                const i = new ll(e);
                i.skip(t);
                return i.position
            }

            getAncestors() {
                if (this.parent.is("documentFragment")) {
                    return [this.parent]
                } else {
                    return this.parent.getAncestors({includeSelf: true})
                }
            }

            getCommonAncestor(t) {
                const e = this.getAncestors();
                const i = t.getAncestors();
                let n = 0;
                while (e[n] == i[n] && e[n]) {
                    n++
                }
                return n === 0 ? null : e[n - 1]
            }

            is(t) {
                return t == "position" || t == "view:position"
            }

            isEqual(t) {
                return this.parent == t.parent && this.offset == t.offset
            }

            isBefore(t) {
                return this.compareWith(t) == "before"
            }

            isAfter(t) {
                return this.compareWith(t) == "after"
            }

            compareWith(t) {
                if (this.root !== t.root) {
                    return "different"
                }
                if (this.isEqual(t)) {
                    return "same"
                }
                const e = this.parent.is("node") ? this.parent.getPath() : [];
                const i = t.parent.is("node") ? t.parent.getPath() : [];
                e.push(this.offset);
                i.push(t.offset);
                const n = Vs(e, i);
                switch (n) {
                    case"prefix":
                        return "before";
                    case"extension":
                        return "after";
                    default:
                        return e[n] < i[n] ? "before" : "after"
                }
            }

            getWalker(t = {}) {
                t.startPosition = this;
                return new ll(t)
            }

            clone() {
                return new dl(this.parent, this.offset)
            }

            static _createAt(t, e) {
                if (t instanceof dl) {
                    return new this(t.parent, t.offset)
                } else {
                    const i = t;
                    if (e == "end") {
                        e = i.is("text") ? i.data.length : i.childCount
                    } else if (e == "before") {
                        return this._createBefore(i)
                    } else if (e == "after") {
                        return this._createAfter(i)
                    } else if (e !== 0 && !e) {
                        throw new ss["b"]("view-createPositionAt-offset-required: " + "View#createPositionAt() requires the offset when the first parameter is a view item.", i)
                    }
                    return new dl(i, e)
                }
            }

            static _createAfter(t) {
                if (t.is("textProxy")) {
                    return new dl(t.textNode, t.offsetInText + t.data.length)
                }
                if (!t.parent) {
                    throw new ss["b"]("view-position-after-root: You can not make position after root.", t, {root: t})
                }
                return new dl(t.parent, t.index + 1)
            }

            static _createBefore(t) {
                if (t.is("textProxy")) {
                    return new dl(t.textNode, t.offsetInText)
                }
                if (!t.parent) {
                    throw new ss["b"]("view-position-before-root: You can not make position before root.", t, {root: t})
                }
                return new dl(t.parent, t.index)
            }
        }

        class ul {
            constructor(t, e = null) {
                this.start = t.clone();
                this.end = e ? e.clone() : t.clone()
            }

            * [Symbol.iterator]() {
                yield* new ll({boundaries: this, ignoreElementEnd: true})
            }

            get isCollapsed() {
                return this.start.isEqual(this.end)
            }

            get isFlat() {
                return this.start.parent === this.end.parent
            }

            get root() {
                return this.start.root
            }

            getEnlarged() {
                let t = this.start.getLastMatchingPosition(hl, {direction: "backward"});
                let e = this.end.getLastMatchingPosition(hl);
                if (t.parent.is("text") && t.isAtStart) {
                    t = dl._createBefore(t.parent)
                }
                if (e.parent.is("text") && e.isAtEnd) {
                    e = dl._createAfter(e.parent)
                }
                return new ul(t, e)
            }

            getTrimmed() {
                let t = this.start.getLastMatchingPosition(hl);
                if (t.isAfter(this.end) || t.isEqual(this.end)) {
                    return new ul(t, t)
                }
                let e = this.end.getLastMatchingPosition(hl, {direction: "backward"});
                const i = t.nodeAfter;
                const n = e.nodeBefore;
                if (i && i.is("text")) {
                    t = new dl(i, 0)
                }
                if (n && n.is("text")) {
                    e = new dl(n, n.data.length)
                }
                return new ul(t, e)
            }

            isEqual(t) {
                return this == t || this.start.isEqual(t.start) && this.end.isEqual(t.end)
            }

            containsPosition(t) {
                return t.isAfter(this.start) && t.isBefore(this.end)
            }

            containsRange(t, e = false) {
                if (t.isCollapsed) {
                    e = false
                }
                const i = this.containsPosition(t.start) || e && this.start.isEqual(t.start);
                const n = this.containsPosition(t.end) || e && this.end.isEqual(t.end);
                return i && n
            }

            getDifference(t) {
                const e = [];
                if (this.isIntersecting(t)) {
                    if (this.containsPosition(t.start)) {
                        e.push(new ul(this.start, t.start))
                    }
                    if (this.containsPosition(t.end)) {
                        e.push(new ul(t.end, this.end))
                    }
                } else {
                    e.push(this.clone())
                }
                return e
            }

            getIntersection(t) {
                if (this.isIntersecting(t)) {
                    let e = this.start;
                    let i = this.end;
                    if (this.containsPosition(t.start)) {
                        e = t.start
                    }
                    if (this.containsPosition(t.end)) {
                        i = t.end
                    }
                    return new ul(e, i)
                }
                return null
            }

            getWalker(t = {}) {
                t.boundaries = this;
                return new ll(t)
            }

            getCommonAncestor() {
                return this.start.getCommonAncestor(this.end)
            }

            getContainedElement() {
                if (this.isCollapsed) {
                    return null
                }
                let t = this.start.nodeAfter;
                let e = this.end.nodeBefore;
                if (this.start.parent.is("text") && this.start.isAtEnd && this.start.parent.nextSibling) {
                    t = this.start.parent.nextSibling
                }
                if (this.end.parent.is("text") && this.end.isAtStart && this.end.parent.previousSibling) {
                    e = this.end.parent.previousSibling
                }
                if (t && t.is("element") && t === e) {
                    return t
                }
                return null
            }

            clone() {
                return new ul(this.start, this.end)
            }

            * getItems(t = {}) {
                t.boundaries = this;
                t.ignoreElementEnd = true;
                const e = new ll(t);
                for (const t of e) {
                    yield t.item
                }
            }

            * getPositions(t = {}) {
                t.boundaries = this;
                const e = new ll(t);
                yield e.position;
                for (const t of e) {
                    yield t.nextPosition
                }
            }

            is(t) {
                return t == "range" || t == "view:range"
            }

            isIntersecting(t) {
                return this.start.isBefore(t.end) && this.end.isAfter(t.start)
            }

            static _createFromParentsAndOffsets(t, e, i, n) {
                return new this(new dl(t, e), new dl(i, n))
            }

            static _createFromPositionAndShift(t, e) {
                const i = t;
                const n = t.getShiftedBy(e);
                return e > 0 ? new this(i, n) : new this(n, i)
            }

            static _createIn(t) {
                return this._createFromParentsAndOffsets(t, 0, t, t.childCount)
            }

            static _createOn(t) {
                const e = t.is("textProxy") ? t.offsetSize : 1;
                return this._createFromPositionAndShift(dl._createBefore(t), e)
            }
        }

        function hl(t) {
            if (t.item.is("attributeElement") || t.item.is("uiElement")) {
                return true
            }
            return false
        }

        function fl(t) {
            let e = 0;
            for (const i of t) {
                e++
            }
            return e
        }

        class gl {
            constructor(t = null, e, i) {
                this._ranges = [];
                this._lastRangeBackward = false;
                this._isFake = false;
                this._fakeSelectionLabel = "";
                this.setTo(t, e, i)
            }

            get isFake() {
                return this._isFake
            }

            get fakeSelectionLabel() {
                return this._fakeSelectionLabel
            }

            get anchor() {
                if (!this._ranges.length) {
                    return null
                }
                const t = this._ranges[this._ranges.length - 1];
                const e = this._lastRangeBackward ? t.end : t.start;
                return e.clone()
            }

            get focus() {
                if (!this._ranges.length) {
                    return null
                }
                const t = this._ranges[this._ranges.length - 1];
                const e = this._lastRangeBackward ? t.start : t.end;
                return e.clone()
            }

            get isCollapsed() {
                return this.rangeCount === 1 && this._ranges[0].isCollapsed
            }

            get rangeCount() {
                return this._ranges.length
            }

            get isBackward() {
                return !this.isCollapsed && this._lastRangeBackward
            }

            get editableElement() {
                if (this.anchor) {
                    return this.anchor.editableElement
                }
                return null
            }

            * getRanges() {
                for (const t of this._ranges) {
                    yield t.clone()
                }
            }

            getFirstRange() {
                let t = null;
                for (const e of this._ranges) {
                    if (!t || e.start.isBefore(t.start)) {
                        t = e
                    }
                }
                return t ? t.clone() : null
            }

            getLastRange() {
                let t = null;
                for (const e of this._ranges) {
                    if (!t || e.end.isAfter(t.end)) {
                        t = e
                    }
                }
                return t ? t.clone() : null
            }

            getFirstPosition() {
                const t = this.getFirstRange();
                return t ? t.start.clone() : null
            }

            getLastPosition() {
                const t = this.getLastRange();
                return t ? t.end.clone() : null
            }

            isEqual(t) {
                if (this.isFake != t.isFake) {
                    return false
                }
                if (this.isFake && this.fakeSelectionLabel != t.fakeSelectionLabel) {
                    return false
                }
                if (this.rangeCount != t.rangeCount) {
                    return false
                } else if (this.rangeCount === 0) {
                    return true
                }
                if (!this.anchor.isEqual(t.anchor) || !this.focus.isEqual(t.focus)) {
                    return false
                }
                for (const e of this._ranges) {
                    let i = false;
                    for (const n of t._ranges) {
                        if (e.isEqual(n)) {
                            i = true;
                            break
                        }
                    }
                    if (!i) {
                        return false
                    }
                }
                return true
            }

            isSimilar(t) {
                if (this.isBackward != t.isBackward) {
                    return false
                }
                const e = fl(this.getRanges());
                const i = fl(t.getRanges());
                if (e != i) {
                    return false
                }
                if (e == 0) {
                    return true
                }
                for (let e of this.getRanges()) {
                    e = e.getTrimmed();
                    let i = false;
                    for (let n of t.getRanges()) {
                        n = n.getTrimmed();
                        if (e.start.isEqual(n.start) && e.end.isEqual(n.end)) {
                            i = true;
                            break
                        }
                    }
                    if (!i) {
                        return false
                    }
                }
                return true
            }

            getSelectedElement() {
                if (this.rangeCount !== 1) {
                    return null
                }
                return this.getFirstRange().getContainedElement()
            }

            setTo(t, e, i) {
                if (t === null) {
                    this._setRanges([]);
                    this._setFakeOptions(e)
                } else if (t instanceof gl || t instanceof ml) {
                    this._setRanges(t.getRanges(), t.isBackward);
                    this._setFakeOptions({fake: t.isFake, label: t.fakeSelectionLabel})
                } else if (t instanceof ul) {
                    this._setRanges([t], e && e.backward);
                    this._setFakeOptions(e)
                } else if (t instanceof dl) {
                    this._setRanges([new ul(t)]);
                    this._setFakeOptions(e)
                } else if (t instanceof zs) {
                    const n = !!i && !!i.backward;
                    let o;
                    if (e === undefined) {
                        throw new ss["b"]("view-selection-setTo-required-second-parameter: " + "selection.setTo requires the second parameter when the first parameter is a node.", this)
                    } else if (e == "in") {
                        o = ul._createIn(t)
                    } else if (e == "on") {
                        o = ul._createOn(t)
                    } else {
                        o = new ul(dl._createAt(t, e))
                    }
                    this._setRanges([o], n);
                    this._setFakeOptions(i)
                } else if (js(t)) {
                    this._setRanges(t, e && e.backward);
                    this._setFakeOptions(e)
                } else {
                    throw new ss["b"]("view-selection-setTo-not-selectable: Cannot set selection to given place.", this)
                }
                this.fire("change")
            }

            setFocus(t, e) {
                if (this.anchor === null) {
                    throw new ss["b"]("view-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.", this)
                }
                const i = dl._createAt(t, e);
                if (i.compareWith(this.focus) == "same") {
                    return
                }
                const n = this.anchor;
                this._ranges.pop();
                if (i.compareWith(n) == "before") {
                    this._addRange(new ul(i, n), true)
                } else {
                    this._addRange(new ul(n, i))
                }
                this.fire("change")
            }

            is(t) {
                return t == "selection" || t == "view:selection"
            }

            _setRanges(t, e = false) {
                t = Array.from(t);
                this._ranges = [];
                for (const e of t) {
                    this._addRange(e)
                }
                this._lastRangeBackward = !!e
            }

            _setFakeOptions(t = {}) {
                this._isFake = !!t.fake;
                this._fakeSelectionLabel = t.fake ? t.label || "" : ""
            }

            _addRange(t, e = false) {
                if (!(t instanceof ul)) {
                    throw new ss["b"]("view-selection-add-range-not-range: " + "Selection range set to an object that is not an instance of view.Range", this)
                }
                this._pushRange(t);
                this._lastRangeBackward = !!e
            }

            _pushRange(t) {
                for (const e of this._ranges) {
                    if (t.isIntersecting(e)) {
                        throw new ss["b"]("view-selection-range-intersects: Trying to add a range that intersects with another range from selection.", this, {
                            addedRange: t,
                            intersectingRange: e
                        })
                    }
                }
                this._ranges.push(new ul(t.start, t.end))
            }
        }

        vs(gl, ds);

        class ml {
            constructor(t = null, e, i) {
                this._selection = new gl;
                this._selection.delegate("change").to(this);
                this._selection.setTo(t, e, i)
            }

            get isFake() {
                return this._selection.isFake
            }

            get fakeSelectionLabel() {
                return this._selection.fakeSelectionLabel
            }

            get anchor() {
                return this._selection.anchor
            }

            get focus() {
                return this._selection.focus
            }

            get isCollapsed() {
                return this._selection.isCollapsed
            }

            get rangeCount() {
                return this._selection.rangeCount
            }

            get isBackward() {
                return this._selection.isBackward
            }

            get editableElement() {
                return this._selection.editableElement
            }

            get _ranges() {
                return this._selection._ranges
            }

            * getRanges() {
                yield* this._selection.getRanges()
            }

            getFirstRange() {
                return this._selection.getFirstRange()
            }

            getLastRange() {
                return this._selection.getLastRange()
            }

            getFirstPosition() {
                return this._selection.getFirstPosition()
            }

            getLastPosition() {
                return this._selection.getLastPosition()
            }

            getSelectedElement() {
                return this._selection.getSelectedElement()
            }

            isEqual(t) {
                return this._selection.isEqual(t)
            }

            isSimilar(t) {
                return this._selection.isSimilar(t)
            }

            is(t) {
                return t == "selection" || t == "documentSelection" || t == "view:selection" || t == "view:documentSelection"
            }

            _setTo(t, e, i) {
                this._selection.setTo(t, e, i)
            }

            _setFocus(t, e) {
                this._selection.setFocus(t, e)
            }
        }

        vs(ml, ds);

        class pl {
            constructor(t) {
                this.selection = new ml;
                this.roots = new ys({idProperty: "rootName"});
                this.stylesProcessor = t;
                this.set("isReadOnly", false);
                this.set("isFocused", false);
                this.set("isComposing", false);
                this._postFixers = new Set
            }

            getRoot(t = "main") {
                return this.roots.get(t)
            }

            registerPostFixer(t) {
                this._postFixers.add(t)
            }

            destroy() {
                this.roots.map(t => t.destroy());
                this.stopListening()
            }

            _callPostFixers(t) {
                let e = false;
                do {
                    for (const i of this._postFixers) {
                        e = i(t);
                        if (e) {
                            break
                        }
                    }
                } while (e)
            }
        }

        vs(pl, Jc);
        const bl = 10;

        class wl extends zc {
            constructor(t, e, i, n) {
                super(t, e, i, n);
                this.getFillerOffset = kl;
                this._priority = bl;
                this._id = null;
                this._clonesGroup = null
            }

            get priority() {
                return this._priority
            }

            get id() {
                return this._id
            }

            getElementsWithSameId() {
                if (this.id === null) {
                    throw new ss["b"]("attribute-element-get-elements-with-same-id-no-id: " + "Cannot get elements with the same id for an attribute element without id.", this)
                }
                return new Set(this._clonesGroup)
            }

            is(t, e = null) {
                const i = t && t.replace(/^view:/, "");
                if (!e) {
                    return i == "attributeElement" || super.is(t)
                } else {
                    return i == "attributeElement" && e == this.name || super.is(t, e)
                }
            }

            isSimilar(t) {
                if (this.id !== null || t.id !== null) {
                    return this.id === t.id
                }
                return super.isSimilar(t) && this.priority == t.priority
            }

            _clone(t) {
                const e = super._clone(t);
                e._priority = this._priority;
                e._id = this._id;
                return e
            }
        }

        wl.DEFAULT_PRIORITY = bl;

        function kl() {
            if (_l(this)) {
                return null
            }
            let t = this.parent;
            while (t && t.is("attributeElement")) {
                if (_l(t) > 1) {
                    return null
                }
                t = t.parent
            }
            if (!t || _l(t) > 1) {
                return null
            }
            return this.childCount
        }

        function _l(t) {
            return Array.from(t.getChildren()).filter(t => !t.is("uiElement")).length
        }

        class vl extends zc {
            constructor(t, e, i, n) {
                super(t, e, i, n);
                this.getFillerOffset = yl
            }

            is(t, e = null) {
                const i = t.replace(/^view:/, "");
                if (!e) {
                    return i == "emptyElement" || super.is(t)
                } else {
                    return i == "emptyElement" && e == this.name || super.is(t, e)
                }
            }

            _insertChild(t, e) {
                if (e && (e instanceof zs || Array.from(e).length > 0)) {
                    throw new ss["b"]("view-emptyelement-cannot-add: Cannot add child nodes to EmptyElement instance.", [this, e])
                }
            }
        }

        function yl() {
            return null
        }

        const xl = navigator.userAgent.toLowerCase();
        const Cl = {
            isMac: Tl(xl),
            isEdge: Pl(xl),
            isGecko: Sl(xl),
            isSafari: El(xl),
            isAndroid: Rl(xl),
            features: {isRegExpUnicodePropertySupported: Ol()}
        };
        var Al = Cl;

        function Tl(t) {
            return t.indexOf("macintosh") > -1
        }

        function Pl(t) {
            return !!t.match(/edge\/(\d+.?\d*)/)
        }

        function Sl(t) {
            return !!t.match(/gecko\/\d+/)
        }

        function El(t) {
            return t.indexOf(" applewebkit/") > -1 && t.indexOf("chrome") === -1
        }

        function Rl(t) {
            return t.indexOf("android") > -1
        }

        function Ol() {
            let t = false;
            try {
                t = "".search(new RegExp("[\\p{L}]", "u")) === 0
            } catch (t) {
            }
            return t
        }

        const Il = {"": "ctrl", "": "shift", "": "alt"};
        const Vl = {ctrl: "", shift: "", alt: ""};
        const Nl = Ll();

        function Ml(t) {
            let e;
            if (typeof t == "string") {
                e = Nl[t.toLowerCase()];
                if (!e) {
                    throw new ss["b"]("keyboard-unknown-key: Unknown key name.", null, {key: t})
                }
            } else {
                e = t.keyCode + (t.altKey ? Nl.alt : 0) + (t.ctrlKey ? Nl.ctrl : 0) + (t.shiftKey ? Nl.shift : 0)
            }
            return e
        }

        function Bl(t) {
            if (typeof t == "string") {
                t = Fl(t)
            }
            return t.map(t => typeof t == "string" ? Ml(t) : t).reduce((t, e) => e + t, 0)
        }

        function zl(t) {
            if (!Al.isMac) {
                return t
            }
            return Fl(t).map(t => Vl[t.toLowerCase()] || t).reduce((t, e) => {
                if (t.slice(-1) in Il) {
                    return t + e
                } else {
                    return t + "+" + e
                }
            })
        }

        function Ll() {
            const t = {
                arrowleft: 37,
                arrowup: 38,
                arrowright: 39,
                arrowdown: 40,
                backspace: 8,
                delete: 46,
                enter: 13,
                space: 32,
                esc: 27,
                tab: 9,
                ctrl: 1114112,
                cmd: 1114112,
                shift: 2228224,
                alt: 4456448
            };
            for (let e = 65; e <= 90; e++) {
                const i = String.fromCharCode(e);
                t[i.toLowerCase()] = e
            }
            for (let e = 48; e <= 57; e++) {
                t[e - 48] = e
            }
            for (let e = 112; e <= 123; e++) {
                t["f" + (e - 111)] = e
            }
            return t
        }

        function Fl(t) {
            return t.split(/\s*\+\s*/)
        }

        class Dl extends zc {
            constructor(t, e, i, n) {
                super(t, e, i, n);
                this.getFillerOffset = Hl
            }

            is(t, e = null) {
                const i = t.replace(/^view:/, "");
                if (!e) {
                    return i == "uiElement" || super.is(t)
                } else {
                    return i == "uiElement" && e == this.name || super.is(t, e)
                }
            }

            _insertChild(t, e) {
                if (e && (e instanceof zs || Array.from(e).length > 0)) {
                    throw new ss["b"]("view-uielement-cannot-add: Cannot add child nodes to UIElement instance.", this)
                }
            }

            render(t) {
                return this.toDomElement(t)
            }

            toDomElement(t) {
                const e = t.createElement(this.name);
                for (const t of this.getAttributeKeys()) {
                    e.setAttribute(t, this.getAttribute(t))
                }
                return e
            }
        }

        function jl(t) {
            t.document.on("keydown", (e, i) => Wl(e, i, t.domConverter))
        }

        function Hl() {
            return null
        }

        function Wl(t, e, i) {
            if (e.keyCode == Nl.arrowright) {
                const t = e.domTarget.ownerDocument.defaultView.getSelection();
                const n = t.rangeCount == 1 && t.getRangeAt(0).collapsed;
                if (n || e.shiftKey) {
                    const e = t.focusNode;
                    const o = t.focusOffset;
                    const r = i.domPositionToView(e, o);
                    if (r === null) {
                        return
                    }
                    let s = false;
                    const a = r.getLastMatchingPosition(t => {
                        if (t.item.is("uiElement")) {
                            s = true
                        }
                        if (t.item.is("uiElement") || t.item.is("attributeElement")) {
                            return true
                        }
                        return false
                    });
                    if (s) {
                        const e = i.viewPositionToDom(a);
                        if (n) {
                            t.collapse(e.parent, e.offset)
                        } else {
                            t.extend(e.parent, e.offset)
                        }
                    }
                }
            }
        }

        class ql {
            constructor(t, e) {
                this.document = t;
                this._children = [];
                if (e) {
                    this._insertChild(0, e)
                }
            }

            [Symbol.iterator]() {
                return this._children[Symbol.iterator]()
            }

            get childCount() {
                return this._children.length
            }

            get isEmpty() {
                return this.childCount === 0
            }

            get root() {
                return this
            }

            get parent() {
                return null
            }

            is(t) {
                return t == "documentFragment" || t == "view:documentFragment"
            }

            _appendChild(t) {
                return this._insertChild(this.childCount, t)
            }

            getChild(t) {
                return this._children[t]
            }

            getChildIndex(t) {
                return this._children.indexOf(t)
            }

            getChildren() {
                return this._children[Symbol.iterator]()
            }

            _insertChild(t, e) {
                this._fireChange("children", this);
                let i = 0;
                const n = Ul(this.document, e);
                for (const e of n) {
                    if (e.parent !== null) {
                        e._remove()
                    }
                    e.parent = this;
                    this._children.splice(t, 0, e);
                    t++;
                    i++
                }
                return i
            }

            _removeChildren(t, e = 1) {
                this._fireChange("children", this);
                for (let i = t; i < t + e; i++) {
                    this._children[i].parent = null
                }
                return this._children.splice(t, e)
            }

            _fireChange(t, e) {
                this.fire("change:" + t, e)
            }
        }

        vs(ql, ds);

        function Ul(t, e) {
            if (typeof e == "string") {
                return [new Ls(t, e)]
            }
            if (!js(e)) {
                e = [e]
            }
            return Array.from(e).map(e => {
                if (typeof e == "string") {
                    return new Ls(t, e)
                }
                if (e instanceof Fs) {
                    return new Ls(t, e.data)
                }
                return e
            })
        }

        class $l {
            constructor(t) {
                this.document = t;
                this._cloneGroups = new Map
            }

            setSelection(t, e, i) {
                this.document.selection._setTo(t, e, i)
            }

            setSelectionFocus(t, e) {
                this.document.selection._setFocus(t, e)
            }

            createText(t) {
                return new Ls(this.document, t)
            }

            createAttributeElement(t, e, i = {}) {
                const n = new wl(this.document, t, e);
                if (i.priority) {
                    n._priority = i.priority
                }
                if (i.id) {
                    n._id = i.id
                }
                return n
            }

            createContainerElement(t, e) {
                return new jc(this.document, t, e)
            }

            createEditableElement(t, e) {
                const i = new sl(this.document, t, e);
                i._document = this.document;
                return i
            }

            createEmptyElement(t, e) {
                return new vl(this.document, t, e)
            }

            createUIElement(t, e, i) {
                const n = new Dl(this.document, t, e);
                if (i) {
                    n.render = i
                }
                return n
            }

            setAttribute(t, e, i) {
                i._setAttribute(t, e)
            }

            removeAttribute(t, e) {
                e._removeAttribute(t)
            }

            addClass(t, e) {
                e._addClass(t)
            }

            removeClass(t, e) {
                e._removeClass(t)
            }

            setStyle(t, e, i) {
                if (N(t) && i === undefined) {
                    i = e
                }
                i._setStyle(t, e)
            }

            removeStyle(t, e) {
                e._removeStyle(t)
            }

            setCustomProperty(t, e, i) {
                i._setCustomProperty(t, e)
            }

            removeCustomProperty(t, e) {
                return e._removeCustomProperty(t)
            }

            breakAttributes(t) {
                if (t instanceof dl) {
                    return this._breakAttributes(t)
                } else {
                    return this._breakAttributesRange(t)
                }
            }

            breakContainer(t) {
                const e = t.parent;
                if (!e.is("containerElement")) {
                    throw new ss["b"]("view-writer-break-non-container-element: Trying to break an element which is not a container element.", this.document)
                }
                if (!e.parent) {
                    throw new ss["b"]("view-writer-break-root: Trying to break root element.", this.document)
                }
                if (t.isAtStart) {
                    return dl._createBefore(e)
                } else if (!t.isAtEnd) {
                    const i = e._clone(false);
                    this.insert(dl._createAfter(e), i);
                    const n = new ul(t, dl._createAt(e, "end"));
                    const o = new dl(i, 0);
                    this.move(n, o)
                }
                return dl._createAfter(e)
            }

            mergeAttributes(t) {
                const e = t.offset;
                const i = t.parent;
                if (i.is("text")) {
                    return t
                }
                if (i.is("attributeElement") && i.childCount === 0) {
                    const t = i.parent;
                    const e = i.index;
                    i._remove();
                    this._removeFromClonedElementsGroup(i);
                    return this.mergeAttributes(new dl(t, e))
                }
                const n = i.getChild(e - 1);
                const o = i.getChild(e);
                if (!n || !o) {
                    return t
                }
                if (n.is("text") && o.is("text")) {
                    return Xl(n, o)
                } else if (n.is("attributeElement") && o.is("attributeElement") && n.isSimilar(o)) {
                    const t = n.childCount;
                    n._appendChild(o.getChildren());
                    o._remove();
                    this._removeFromClonedElementsGroup(o);
                    return this.mergeAttributes(new dl(n, t))
                }
                return t
            }

            mergeContainers(t) {
                const e = t.nodeBefore;
                const i = t.nodeAfter;
                if (!e || !i || !e.is("containerElement") || !i.is("containerElement")) {
                    throw new ss["b"]("view-writer-merge-containers-invalid-position: " + "Element before and after given position cannot be merged.", this.document)
                }
                const n = e.getChild(e.childCount - 1);
                const o = n instanceof Ls ? dl._createAt(n, "end") : dl._createAt(e, "end");
                this.move(ul._createIn(i), dl._createAt(e, "end"));
                this.remove(ul._createOn(i));
                return o
            }

            insert(t, e) {
                e = js(e) ? [...e] : [e];
                Zl(e, this.document);
                const i = Kl(t);
                if (!i) {
                    throw new ss["b"]("view-writer-invalid-position-container", this.document)
                }
                const n = this._breakAttributes(t, true);
                const o = i._insertChild(n.offset, e);
                for (const t of e) {
                    this._addToClonedElementsGroup(t)
                }
                const r = n.getShiftedBy(o);
                const s = this.mergeAttributes(n);
                if (o === 0) {
                    return new ul(s, s)
                } else {
                    if (!s.isEqual(n)) {
                        r.offset--
                    }
                    const t = this.mergeAttributes(r);
                    return new ul(s, t)
                }
            }

            remove(t) {
                const e = t instanceof ul ? t : ul._createOn(t);
                id(e, this.document);
                if (e.isCollapsed) {
                    return new ql(this.document)
                }
                const {start: i, end: n} = this._breakAttributesRange(e, true);
                const o = i.parent;
                const r = n.offset - i.offset;
                const s = o._removeChildren(i.offset, r);
                for (const t of s) {
                    this._removeFromClonedElementsGroup(t)
                }
                const a = this.mergeAttributes(i);
                e.start = a;
                e.end = a.clone();
                return new ql(this.document, s)
            }

            clear(t, e) {
                id(t, this.document);
                const i = t.getWalker({direction: "backward", ignoreElementEnd: true});
                for (const n of i) {
                    const i = n.item;
                    let o;
                    if (i.is("element") && e.isSimilar(i)) {
                        o = ul._createOn(i)
                    } else if (!n.nextPosition.isAfter(t.start) && i.is("textProxy")) {
                        const t = i.getAncestors().find(t => t.is("element") && e.isSimilar(t));
                        if (t) {
                            o = ul._createIn(t)
                        }
                    }
                    if (o) {
                        if (o.end.isAfter(t.end)) {
                            o.end = t.end
                        }
                        if (o.start.isBefore(t.start)) {
                            o.start = t.start
                        }
                        this.remove(o)
                    }
                }
            }

            move(t, e) {
                let i;
                if (e.isAfter(t.end)) {
                    e = this._breakAttributes(e, true);
                    const n = e.parent;
                    const o = n.childCount;
                    t = this._breakAttributesRange(t, true);
                    i = this.remove(t);
                    e.offset += n.childCount - o
                } else {
                    i = this.remove(t)
                }
                return this.insert(e, i)
            }

            wrap(t, e) {
                if (!(e instanceof wl)) {
                    throw new ss["b"]("view-writer-wrap-invalid-attribute", this.document)
                }
                id(t, this.document);
                if (!t.isCollapsed) {
                    return this._wrapRange(t, e)
                } else {
                    let i = t.start;
                    if (i.parent.is("element") && !Gl(i.parent)) {
                        i = i.getLastMatchingPosition(t => t.item.is("uiElement"))
                    }
                    i = this._wrapPosition(i, e);
                    const n = this.document.selection;
                    if (n.isCollapsed && n.getFirstPosition().isEqual(t.start)) {
                        this.setSelection(i)
                    }
                    return new ul(i)
                }
            }

            unwrap(t, e) {
                if (!(e instanceof wl)) {
                    throw new ss["b"]("view-writer-unwrap-invalid-attribute", this.document)
                }
                id(t, this.document);
                if (t.isCollapsed) {
                    return t
                }
                const {start: i, end: n} = this._breakAttributesRange(t, true);
                const o = i.parent;
                const r = this._unwrapChildren(o, i.offset, n.offset, e);
                const s = this.mergeAttributes(r.start);
                if (!s.isEqual(r.start)) {
                    r.end.offset--
                }
                const a = this.mergeAttributes(r.end);
                return new ul(s, a)
            }

            rename(t, e) {
                const i = new jc(this.document, t, e.getAttributes());
                this.insert(dl._createAfter(e), i);
                this.move(ul._createIn(e), dl._createAt(i, 0));
                this.remove(ul._createOn(e));
                return i
            }

            clearClonedElementsGroup(t) {
                this._cloneGroups.delete(t)
            }

            createPositionAt(t, e) {
                return dl._createAt(t, e)
            }

            createPositionAfter(t) {
                return dl._createAfter(t)
            }

            createPositionBefore(t) {
                return dl._createBefore(t)
            }

            createRange(t, e) {
                return new ul(t, e)
            }

            createRangeOn(t) {
                return ul._createOn(t)
            }

            createRangeIn(t) {
                return ul._createIn(t)
            }

            createSelection(t, e, i) {
                return new gl(t, e, i)
            }

            _wrapChildren(t, e, i, n) {
                let o = e;
                const r = [];
                while (o < i) {
                    const e = t.getChild(o);
                    const i = e.is("text");
                    const s = e.is("attributeElement");
                    const a = e.is("emptyElement");
                    const c = e.is("uiElement");
                    if (s && this._wrapAttributeElement(n, e)) {
                        r.push(new dl(t, o))
                    } else if (i || a || c || s && Jl(n, e)) {
                        const i = n._clone();
                        e._remove();
                        i._appendChild(e);
                        t._insertChild(o, i);
                        this._addToClonedElementsGroup(i);
                        r.push(new dl(t, o))
                    } else if (s) {
                        this._wrapChildren(e, 0, e.childCount, n)
                    }
                    o++
                }
                let s = 0;
                for (const t of r) {
                    t.offset -= s;
                    if (t.offset == e) {
                        continue
                    }
                    const n = this.mergeAttributes(t);
                    if (!n.isEqual(t)) {
                        s++;
                        i--
                    }
                }
                return ul._createFromParentsAndOffsets(t, e, t, i)
            }

            _unwrapChildren(t, e, i, n) {
                let o = e;
                const r = [];
                while (o < i) {
                    const e = t.getChild(o);
                    if (!e.is("attributeElement")) {
                        o++;
                        continue
                    }
                    if (e.isSimilar(n)) {
                        const n = e.getChildren();
                        const s = e.childCount;
                        e._remove();
                        t._insertChild(o, n);
                        this._removeFromClonedElementsGroup(e);
                        r.push(new dl(t, o), new dl(t, o + s));
                        o += s;
                        i += s - 1;
                        continue
                    }
                    if (this._unwrapAttributeElement(n, e)) {
                        r.push(new dl(t, o), new dl(t, o + 1));
                        o++;
                        continue
                    }
                    this._unwrapChildren(e, 0, e.childCount, n);
                    o++
                }
                let s = 0;
                for (const t of r) {
                    t.offset -= s;
                    if (t.offset == e || t.offset == i) {
                        continue
                    }
                    const n = this.mergeAttributes(t);
                    if (!n.isEqual(t)) {
                        s++;
                        i--
                    }
                }
                return ul._createFromParentsAndOffsets(t, e, t, i)
            }

            _wrapRange(t, e) {
                const {start: i, end: n} = this._breakAttributesRange(t, true);
                const o = i.parent;
                const r = this._wrapChildren(o, i.offset, n.offset, e);
                const s = this.mergeAttributes(r.start);
                if (!s.isEqual(r.start)) {
                    r.end.offset--
                }
                const a = this.mergeAttributes(r.end);
                return new ul(s, a)
            }

            _wrapPosition(t, e) {
                if (e.isSimilar(t.parent)) {
                    return Yl(t.clone())
                }
                if (t.parent.is("text")) {
                    t = Ql(t)
                }
                const i = this.createAttributeElement();
                i._priority = Number.POSITIVE_INFINITY;
                i.isSimilar = () => false;
                t.parent._insertChild(t.offset, i);
                const n = new ul(t, t.getShiftedBy(1));
                this.wrap(n, e);
                const o = new dl(i.parent, i.index);
                i._remove();
                const r = o.nodeBefore;
                const s = o.nodeAfter;
                if (r instanceof Ls && s instanceof Ls) {
                    return Xl(r, s)
                }
                return Yl(o)
            }

            _wrapAttributeElement(t, e) {
                if (!nd(t, e)) {
                    return false
                }
                if (t.name !== e.name || t.priority !== e.priority) {
                    return false
                }
                for (const i of t.getAttributeKeys()) {
                    if (i === "class" || i === "style") {
                        continue
                    }
                    if (e.hasAttribute(i) && e.getAttribute(i) !== t.getAttribute(i)) {
                        return false
                    }
                }
                for (const i of t.getStyleNames()) {
                    if (e.hasStyle(i) && e.getStyle(i) !== t.getStyle(i)) {
                        return false
                    }
                }
                for (const i of t.getAttributeKeys()) {
                    if (i === "class" || i === "style") {
                        continue
                    }
                    if (!e.hasAttribute(i)) {
                        this.setAttribute(i, t.getAttribute(i), e)
                    }
                }
                for (const i of t.getStyleNames()) {
                    if (!e.hasStyle(i)) {
                        this.setStyle(i, t.getStyle(i), e)
                    }
                }
                for (const i of t.getClassNames()) {
                    if (!e.hasClass(i)) {
                        this.addClass(i, e)
                    }
                }
                return true
            }

            _unwrapAttributeElement(t, e) {
                if (!nd(t, e)) {
                    return false
                }
                if (t.name !== e.name || t.priority !== e.priority) {
                    return false
                }
                for (const i of t.getAttributeKeys()) {
                    if (i === "class" || i === "style") {
                        continue
                    }
                    if (!e.hasAttribute(i) || e.getAttribute(i) !== t.getAttribute(i)) {
                        return false
                    }
                }
                if (!e.hasClass(...t.getClassNames())) {
                    return false
                }
                for (const i of t.getStyleNames()) {
                    if (!e.hasStyle(i) || e.getStyle(i) !== t.getStyle(i)) {
                        return false
                    }
                }
                for (const i of t.getAttributeKeys()) {
                    if (i === "class" || i === "style") {
                        continue
                    }
                    this.removeAttribute(i, e)
                }
                this.removeClass(Array.from(t.getClassNames()), e);
                this.removeStyle(Array.from(t.getStyleNames()), e);
                return true
            }

            _breakAttributesRange(t, e = false) {
                const i = t.start;
                const n = t.end;
                id(t, this.document);
                if (t.isCollapsed) {
                    const i = this._breakAttributes(t.start, e);
                    return new ul(i, i)
                }
                const o = this._breakAttributes(n, e);
                const r = o.parent.childCount;
                const s = this._breakAttributes(i, e);
                o.offset += o.parent.childCount - r;
                return new ul(s, o)
            }

            _breakAttributes(t, e = false) {
                const i = t.offset;
                const n = t.parent;
                if (t.parent.is("emptyElement")) {
                    throw new ss["b"]("view-writer-cannot-break-empty-element", this.document)
                }
                if (t.parent.is("uiElement")) {
                    throw new ss["b"]("view-writer-cannot-break-ui-element", this.document)
                }
                if (!e && n.is("text") && ed(n.parent)) {
                    return t.clone()
                }
                if (ed(n)) {
                    return t.clone()
                }
                if (n.is("text")) {
                    return this._breakAttributes(Ql(t), e)
                }
                const o = n.childCount;
                if (i == o) {
                    const t = new dl(n.parent, n.index + 1);
                    return this._breakAttributes(t, e)
                } else {
                    if (i === 0) {
                        const t = new dl(n.parent, n.index);
                        return this._breakAttributes(t, e)
                    } else {
                        const t = n.index + 1;
                        const o = n._clone();
                        n.parent._insertChild(t, o);
                        this._addToClonedElementsGroup(o);
                        const r = n.childCount - i;
                        const s = n._removeChildren(i, r);
                        o._appendChild(s);
                        const a = new dl(n.parent, t);
                        return this._breakAttributes(a, e)
                    }
                }
            }

            _addToClonedElementsGroup(t) {
                if (!t.root.is("rootElement")) {
                    return
                }
                if (t.is("element")) {
                    for (const e of t.getChildren()) {
                        this._addToClonedElementsGroup(e)
                    }
                }
                const e = t.id;
                if (!e) {
                    return
                }
                let i = this._cloneGroups.get(e);
                if (!i) {
                    i = new Set;
                    this._cloneGroups.set(e, i)
                }
                i.add(t);
                t._clonesGroup = i
            }

            _removeFromClonedElementsGroup(t) {
                if (t.is("element")) {
                    for (const e of t.getChildren()) {
                        this._removeFromClonedElementsGroup(e)
                    }
                }
                const e = t.id;
                if (!e) {
                    return
                }
                const i = this._cloneGroups.get(e);
                if (!i) {
                    return
                }
                i.delete(t)
            }
        }

        function Gl(t) {
            return Array.from(t.getChildren()).some(t => !t.is("uiElement"))
        }

        function Kl(t) {
            let e = t.parent;
            while (!ed(e)) {
                if (!e) {
                    return undefined
                }
                e = e.parent
            }
            return e
        }

        function Jl(t, e) {
            if (t.priority < e.priority) {
                return true
            } else if (t.priority > e.priority) {
                return false
            }
            return t.getIdentity() < e.getIdentity()
        }

        function Yl(t) {
            const e = t.nodeBefore;
            if (e && e.is("text")) {
                return new dl(e, e.data.length)
            }
            const i = t.nodeAfter;
            if (i && i.is("text")) {
                return new dl(i, 0)
            }
            return t
        }

        function Ql(t) {
            if (t.offset == t.parent.data.length) {
                return new dl(t.parent.parent, t.parent.index + 1)
            }
            if (t.offset === 0) {
                return new dl(t.parent.parent, t.parent.index)
            }
            const e = t.parent.data.slice(t.offset);
            t.parent._data = t.parent.data.slice(0, t.offset);
            t.parent.parent._insertChild(t.parent.index + 1, new Ls(t.root.document, e));
            return new dl(t.parent.parent, t.parent.index + 1)
        }

        function Xl(t, e) {
            const i = t.data.length;
            t._data += e.data;
            e._remove();
            return new dl(t, i)
        }

        function Zl(t, e) {
            for (const i of t) {
                if (!td.some(t => i instanceof t)) {
                    throw new ss["b"]("view-writer-insert-invalid-node", e)
                }
                if (!i.is("text")) {
                    Zl(i.getChildren(), e)
                }
            }
        }

        const td = [Ls, wl, jc, vl, Dl];

        function ed(t) {
            return t && (t.is("containerElement") || t.is("documentFragment"))
        }

        function id(t, e) {
            const i = Kl(t.start);
            const n = Kl(t.end);
            if (!i || !n || i !== n) {
                throw new ss["b"]("view-writer-invalid-range-container", e)
            }
        }

        function nd(t, e) {
            return t.id === null && e.id === null
        }

        function od(t) {
            return Object.prototype.toString.call(t) == "[object Text]"
        }

        const rd = t => t.createTextNode("");
        const sd = t => {
            const e = t.createElement("br");
            e.dataset.ckeFiller = true;
            return e
        };
        const ad = 7;
        const cd = (() => {
            let t = "";
            for (let e = 0; e < ad; e++) {
                t += ""
            }
            return t
        })();

        function ld(t) {
            return od(t) && t.data.substr(0, ad) === cd
        }

        function dd(t) {
            return t.data.length == ad && ld(t)
        }

        function ud(t) {
            if (ld(t)) {
                return t.data.slice(ad)
            } else {
                return t.data
            }
        }

        function hd(t) {
            t.document.on("keydown", fd)
        }

        function fd(t, e) {
            if (e.keyCode == Nl.arrowleft) {
                const t = e.domTarget.ownerDocument.defaultView.getSelection();
                if (t.rangeCount == 1 && t.getRangeAt(0).collapsed) {
                    const e = t.getRangeAt(0).startContainer;
                    const i = t.getRangeAt(0).startOffset;
                    if (ld(e) && i <= ad) {
                        t.collapse(e, 0)
                    }
                }
            }
        }

        function gd(t, e, i, n = false) {
            i = i || function (t, e) {
                return t === e
            };
            if (!Array.isArray(t)) {
                t = Array.from(t)
            }
            if (!Array.isArray(e)) {
                e = Array.from(e)
            }
            const o = md(t, e, i);
            return n ? kd(o, e.length) : wd(e, o)
        }

        function md(t, e, i) {
            const n = pd(t, e, i);
            if (n === -1) {
                return {firstIndex: -1, lastIndexOld: -1, lastIndexNew: -1}
            }
            const o = bd(t, n);
            const r = bd(e, n);
            const s = pd(o, r, i);
            const a = t.length - s;
            const c = e.length - s;
            return {firstIndex: n, lastIndexOld: a, lastIndexNew: c}
        }

        function pd(t, e, i) {
            for (let n = 0; n < Math.max(t.length, e.length); n++) {
                if (t[n] === undefined || e[n] === undefined || !i(t[n], e[n])) {
                    return n
                }
            }
            return -1
        }

        function bd(t, e) {
            return t.slice(e).reverse()
        }

        function wd(t, e) {
            const i = [];
            const {firstIndex: n, lastIndexOld: o, lastIndexNew: r} = e;
            if (r - n > 0) {
                i.push({index: n, type: "insert", values: t.slice(n, r)})
            }
            if (o - n > 0) {
                i.push({index: n + (r - n), type: "delete", howMany: o - n})
            }
            return i
        }

        function kd(t, e) {
            const {firstIndex: i, lastIndexOld: n, lastIndexNew: o} = t;
            if (i === -1) {
                return Array(e).fill("equal")
            }
            let r = [];
            if (i > 0) {
                r = r.concat(Array(i).fill("equal"))
            }
            if (o - i > 0) {
                r = r.concat(Array(o - i).fill("insert"))
            }
            if (n - i > 0) {
                r = r.concat(Array(n - i).fill("delete"))
            }
            if (o < e) {
                r = r.concat(Array(e - o).fill("equal"))
            }
            return r
        }

        function _d(t, e, i) {
            i = i || function (t, e) {
                return t === e
            };
            const n = t.length;
            const o = e.length;
            if (n > 200 || o > 200 || n + o > 300) {
                return _d.fastDiff(t, e, i, true)
            }
            let r, s;
            if (o < n) {
                const i = t;
                t = e;
                e = i;
                r = "delete";
                s = "insert"
            } else {
                r = "insert";
                s = "delete"
            }
            const a = t.length;
            const c = e.length;
            const l = c - a;
            const d = {};
            const u = {};

            function h(n) {
                const o = (u[n - 1] !== undefined ? u[n - 1] : -1) + 1;
                const l = u[n + 1] !== undefined ? u[n + 1] : -1;
                const h = o > l ? -1 : 1;
                if (d[n + h]) {
                    d[n] = d[n + h].slice(0)
                }
                if (!d[n]) {
                    d[n] = []
                }
                d[n].push(o > l ? r : s);
                let f = Math.max(o, l);
                let g = f - n;
                while (g < a && f < c && i(t[g], e[f])) {
                    g++;
                    f++;
                    d[n].push("equal")
                }
                return f
            }

            let f = 0;
            let g;
            do {
                for (g = -f; g < l; g++) {
                    u[g] = h(g)
                }
                for (g = l + f; g > l; g--) {
                    u[g] = h(g)
                }
                u[l] = h(l);
                f++
            } while (u[l] !== c);
            return d[l].slice(1)
        }

        _d.fastDiff = gd;

        function vd(t, e, i) {
            t.insertBefore(i, t.childNodes[e] || null)
        }

        function yd(t) {
            const e = t.parentNode;
            if (e) {
                e.removeChild(t)
            }
        }

        function xd(t) {
            if (t) {
                if (t.defaultView) {
                    return t instanceof t.defaultView.Document
                } else if (t.ownerDocument && t.ownerDocument.defaultView) {
                    return t instanceof t.ownerDocument.defaultView.Node
                }
            }
            return false
        }

        class Cd {
            constructor(t, e) {
                this.domDocuments = new Set;
                this.domConverter = t;
                this.markedAttributes = new Set;
                this.markedChildren = new Set;
                this.markedTexts = new Set;
                this.selection = e;
                this.isFocused = false;
                this._inlineFiller = null;
                this._fakeSelectionContainer = null
            }

            markToSync(t, e) {
                if (t === "text") {
                    if (this.domConverter.mapViewToDom(e.parent)) {
                        this.markedTexts.add(e)
                    }
                } else {
                    if (!this.domConverter.mapViewToDom(e)) {
                        return
                    }
                    if (t === "attributes") {
                        this.markedAttributes.add(e)
                    } else if (t === "children") {
                        this.markedChildren.add(e)
                    } else {
                        throw new ss["b"]("view-renderer-unknown-type: Unknown type passed to Renderer.markToSync.", this)
                    }
                }
            }

            render() {
                let t;
                for (const t of this.markedChildren) {
                    this._updateChildrenMappings(t)
                }
                if (this._inlineFiller && !this._isSelectionInInlineFiller()) {
                    this._removeInlineFiller()
                }
                if (this._inlineFiller) {
                    t = this._getInlineFillerPosition()
                } else if (this._needsInlineFillerAtSelection()) {
                    t = this.selection.getFirstPosition();
                    this.markedChildren.add(t.parent)
                }
                for (const t of this.markedAttributes) {
                    this._updateAttrs(t)
                }
                for (const e of this.markedChildren) {
                    this._updateChildren(e, {inlineFillerPosition: t})
                }
                for (const e of this.markedTexts) {
                    if (!this.markedChildren.has(e.parent) && this.domConverter.mapViewToDom(e.parent)) {
                        this._updateText(e, {inlineFillerPosition: t})
                    }
                }
                if (t) {
                    const e = this.domConverter.viewPositionToDom(t);
                    const i = e.parent.ownerDocument;
                    if (!ld(e.parent)) {
                        this._inlineFiller = Td(i, e.parent, e.offset)
                    } else {
                        this._inlineFiller = e.parent
                    }
                } else {
                    this._inlineFiller = null
                }
                this._updateSelection();
                this._updateFocus();
                this.markedTexts.clear();
                this.markedAttributes.clear();
                this.markedChildren.clear()
            }

            _updateChildrenMappings(t) {
                const e = this.domConverter.mapViewToDom(t);
                if (!e) {
                    return
                }
                const i = this.domConverter.mapViewToDom(t).childNodes;
                const n = Array.from(this.domConverter.viewChildrenToDom(t, e.ownerDocument, {withChildren: false}));
                const o = this._diffNodeLists(i, n);
                const r = this._findReplaceActions(o, i, n);
                if (r.indexOf("replace") !== -1) {
                    const e = {equal: 0, insert: 0, delete: 0};
                    for (const o of r) {
                        if (o === "replace") {
                            const o = e.equal + e.insert;
                            const r = e.equal + e.delete;
                            const s = t.getChild(o);
                            if (s && !s.is("uiElement")) {
                                this._updateElementMappings(s, i[r])
                            }
                            yd(n[o]);
                            e.equal++
                        } else {
                            e[o]++
                        }
                    }
                }
            }

            _updateElementMappings(t, e) {
                this.domConverter.unbindDomElement(e);
                this.domConverter.bindElements(e, t);
                this.markedChildren.add(t);
                this.markedAttributes.add(t)
            }

            _getInlineFillerPosition() {
                const t = this.selection.getFirstPosition();
                if (t.parent.is("text")) {
                    return dl._createBefore(this.selection.getFirstPosition().parent)
                } else {
                    return t
                }
            }

            _isSelectionInInlineFiller() {
                if (this.selection.rangeCount != 1 || !this.selection.isCollapsed) {
                    return false
                }
                const t = this.selection.getFirstPosition();
                const e = this.domConverter.viewPositionToDom(t);
                if (e && od(e.parent) && ld(e.parent)) {
                    return true
                }
                return false
            }

            _removeInlineFiller() {
                const t = this._inlineFiller;
                if (!ld(t)) {
                    throw new ss["b"]("view-renderer-filler-was-lost: The inline filler node was lost.", this)
                }
                if (dd(t)) {
                    t.parentNode.removeChild(t)
                } else {
                    t.data = t.data.substr(ad)
                }
                this._inlineFiller = null
            }

            _needsInlineFillerAtSelection() {
                if (this.selection.rangeCount != 1 || !this.selection.isCollapsed) {
                    return false
                }
                const t = this.selection.getFirstPosition();
                const e = t.parent;
                const i = t.offset;
                if (!this.domConverter.mapViewToDom(e.root)) {
                    return false
                }
                if (!e.is("element")) {
                    return false
                }
                if (!Ad(e)) {
                    return false
                }
                if (i === e.getFillerOffset()) {
                    return false
                }
                const n = t.nodeBefore;
                const o = t.nodeAfter;
                if (n instanceof Ls || o instanceof Ls) {
                    return false
                }
                return true
            }

            _updateText(t, e) {
                const i = this.domConverter.findCorrespondingDomText(t);
                const n = this.domConverter.viewToDom(t, i.ownerDocument);
                const o = i.data;
                let r = n.data;
                const s = e.inlineFillerPosition;
                if (s && s.parent == t.parent && s.offset == t.index) {
                    r = cd + r
                }
                if (o != r) {
                    const t = gd(o, r);
                    for (const e of t) {
                        if (e.type === "insert") {
                            i.insertData(e.index, e.values.join(""))
                        } else {
                            i.deleteData(e.index, e.howMany)
                        }
                    }
                }
            }

            _updateAttrs(t) {
                const e = this.domConverter.mapViewToDom(t);
                if (!e) {
                    return
                }
                const i = Array.from(e.attributes).map(t => t.name);
                const n = t.getAttributeKeys();
                for (const i of n) {
                    e.setAttribute(i, t.getAttribute(i))
                }
                for (const n of i) {
                    if (!t.hasAttribute(n)) {
                        e.removeAttribute(n)
                    }
                }
            }

            _updateChildren(t, e) {
                const i = this.domConverter.mapViewToDom(t);
                if (!i) {
                    return
                }
                const n = e.inlineFillerPosition;
                const o = this.domConverter.mapViewToDom(t).childNodes;
                const r = Array.from(this.domConverter.viewChildrenToDom(t, i.ownerDocument, {
                    bind: true,
                    inlineFillerPosition: n
                }));
                if (n && n.parent === t) {
                    Td(i.ownerDocument, r, n.offset)
                }
                const s = this._diffNodeLists(o, r);
                let a = 0;
                const c = new Set;
                for (const t of s) {
                    if (t === "delete") {
                        c.add(o[a]);
                        yd(o[a])
                    } else if (t === "equal") {
                        a++
                    }
                }
                a = 0;
                for (const t of s) {
                    if (t === "insert") {
                        vd(i, a, r[a]);
                        a++
                    } else if (t === "equal") {
                        this._markDescendantTextToSync(this.domConverter.domToView(r[a]));
                        a++
                    }
                }
                for (const t of c) {
                    if (!t.parentNode) {
                        this.domConverter.unbindDomElement(t)
                    }
                }
            }

            _diffNodeLists(t, e) {
                t = Rd(t, this._fakeSelectionContainer);
                return _d(t, e, Sd.bind(null, this.domConverter))
            }

            _findReplaceActions(t, e, i) {
                if (t.indexOf("insert") === -1 || t.indexOf("delete") === -1) {
                    return t
                }
                let n = [];
                let o = [];
                let r = [];
                const s = {equal: 0, insert: 0, delete: 0};
                for (const a of t) {
                    if (a === "insert") {
                        r.push(i[s.equal + s.insert])
                    } else if (a === "delete") {
                        o.push(e[s.equal + s.delete])
                    } else {
                        n = n.concat(_d(o, r, Pd).map(t => t === "equal" ? "replace" : t));
                        n.push("equal");
                        o = [];
                        r = []
                    }
                    s[a]++
                }
                return n.concat(_d(o, r, Pd).map(t => t === "equal" ? "replace" : t))
            }

            _markDescendantTextToSync(t) {
                if (!t) {
                    return
                }
                if (t.is("text")) {
                    this.markedTexts.add(t)
                } else if (t.is("element")) {
                    for (const e of t.getChildren()) {
                        this._markDescendantTextToSync(e)
                    }
                }
            }

            _updateSelection() {
                if (this.selection.rangeCount === 0) {
                    this._removeDomSelection();
                    this._removeFakeSelection();
                    return
                }
                const t = this.domConverter.mapViewToDom(this.selection.editableElement);
                if (!this.isFocused || !t) {
                    return
                }
                if (this.selection.isFake) {
                    this._updateFakeSelection(t)
                } else {
                    this._removeFakeSelection();
                    this._updateDomSelection(t)
                }
            }

            _updateFakeSelection(t) {
                const e = t.ownerDocument;
                if (!this._fakeSelectionContainer) {
                    this._fakeSelectionContainer = Od(e)
                }
                const i = this._fakeSelectionContainer;
                this.domConverter.bindFakeSelection(i, this.selection);
                if (!this._fakeSelectionNeedsUpdate(t)) {
                    return
                }
                if (!i.parentElement || i.parentElement != t) {
                    t.appendChild(i)
                }
                i.textContent = this.selection.fakeSelectionLabel || "";
                const n = e.getSelection();
                const o = e.createRange();
                n.removeAllRanges();
                o.selectNodeContents(i);
                n.addRange(o)
            }

            _updateDomSelection(t) {
                const e = t.ownerDocument.defaultView.getSelection();
                if (!this._domSelectionNeedsUpdate(e)) {
                    return
                }
                const i = this.domConverter.viewPositionToDom(this.selection.anchor);
                const n = this.domConverter.viewPositionToDom(this.selection.focus);
                t.focus();
                e.collapse(i.parent, i.offset);
                e.extend(n.parent, n.offset);
                if (Al.isGecko) {
                    Ed(n, e)
                }
            }

            _domSelectionNeedsUpdate(t) {
                if (!this.domConverter.isDomSelectionCorrect(t)) {
                    return true
                }
                const e = t && this.domConverter.domSelectionToView(t);
                if (e && this.selection.isEqual(e)) {
                    return false
                }
                if (!this.selection.isCollapsed && this.selection.isSimilar(e)) {
                    return false
                }
                return true
            }

            _fakeSelectionNeedsUpdate(t) {
                const e = this._fakeSelectionContainer;
                const i = t.ownerDocument.getSelection();
                if (!e || e.parentElement !== t) {
                    return true
                }
                if (i.anchorNode !== e && !e.contains(i.anchorNode)) {
                    return true
                }
                return e.textContent !== this.selection.fakeSelectionLabel
            }

            _removeDomSelection() {
                for (const t of this.domDocuments) {
                    const e = t.getSelection();
                    if (e.rangeCount) {
                        const e = t.activeElement;
                        const i = this.domConverter.mapDomToView(e);
                        if (e && i) {
                            t.getSelection().removeAllRanges()
                        }
                    }
                }
            }

            _removeFakeSelection() {
                const t = this._fakeSelectionContainer;
                if (t) {
                    t.remove()
                }
            }

            _updateFocus() {
                if (this.isFocused) {
                    const t = this.selection.editableElement;
                    if (t) {
                        this.domConverter.focus(t)
                    }
                }
            }
        }

        vs(Cd, Jc);

        function Ad(t) {
            if (t.getAttribute("contenteditable") == "false") {
                return false
            }
            const e = t.findAncestor(t => t.hasAttribute("contenteditable"));
            return !e || e.getAttribute("contenteditable") == "true"
        }

        function Td(t, e, i) {
            const n = e instanceof Array ? e : e.childNodes;
            const o = n[i];
            if (od(o)) {
                o.data = cd + o.data;
                return o
            } else {
                const o = t.createTextNode(cd);
                if (Array.isArray(e)) {
                    n.splice(i, 0, o)
                } else {
                    vd(e, i, o)
                }
                return o
            }
        }

        function Pd(t, e) {
            return xd(t) && xd(e) && !od(t) && !od(e) && t.tagName.toLowerCase() === e.tagName.toLowerCase()
        }

        function Sd(t, e, i) {
            if (e === i) {
                return true
            } else if (od(e) && od(i)) {
                return e.data === i.data
            } else if (t.isBlockFiller(e) && t.isBlockFiller(i)) {
                return true
            }
            return false
        }

        function Ed(t, e) {
            const i = t.parent;
            if (i.nodeType != Node.ELEMENT_NODE || t.offset != i.childNodes.length - 1) {
                return
            }
            const n = i.childNodes[t.offset];
            if (n && n.tagName == "BR") {
                e.addRange(e.getRangeAt(0))
            }
        }

        function Rd(t, e) {
            const i = Array.from(t);
            if (i.length == 0 || !e) {
                return i
            }
            const n = i[i.length - 1];
            if (n == e) {
                i.pop()
            }
            return i
        }

        function Od(t) {
            const e = t.createElement("div");
            Object.assign(e.style, {position: "fixed", top: 0, left: "-9999px", width: "42px"});
            e.textContent = "";
            return e
        }

        var Id = {window: window, document: document};

        function Vd(t) {
            let e = 0;
            while (t.previousSibling) {
                t = t.previousSibling;
                e++
            }
            return e
        }

        function Nd(t) {
            const e = [];
            while (t && t.nodeType != Node.DOCUMENT_NODE) {
                e.unshift(t);
                t = t.parentNode
            }
            return e
        }

        function Md(t, e) {
            const i = Nd(t);
            const n = Nd(e);
            let o = 0;
            while (i[o] == n[o] && i[o]) {
                o++
            }
            return o === 0 ? null : i[o - 1]
        }

        const Bd = sd(document);

        class zd {
            constructor(t, e = {}) {
                this.document = t;
                this.blockFillerMode = e.blockFillerMode || "br";
                this.preElements = ["pre"];
                this.blockElements = ["p", "div", "h1", "h2", "h3", "h4", "h5", "h6", "li", "dd", "dt", "figcaption"];
                this._blockFiller = this.blockFillerMode == "br" ? sd : rd;
                this._domToViewMapping = new WeakMap;
                this._viewToDomMapping = new WeakMap;
                this._fakeSelectionMapping = new WeakMap
            }

            bindFakeSelection(t, e) {
                this._fakeSelectionMapping.set(t, new gl(e))
            }

            fakeSelectionToView(t) {
                return this._fakeSelectionMapping.get(t)
            }

            bindElements(t, e) {
                this._domToViewMapping.set(t, e);
                this._viewToDomMapping.set(e, t)
            }

            unbindDomElement(t) {
                const e = this._domToViewMapping.get(t);
                if (e) {
                    this._domToViewMapping.delete(t);
                    this._viewToDomMapping.delete(e);
                    for (const e of Array.from(t.childNodes)) {
                        this.unbindDomElement(e)
                    }
                }
            }

            bindDocumentFragments(t, e) {
                this._domToViewMapping.set(t, e);
                this._viewToDomMapping.set(e, t)
            }

            viewToDom(t, e, i = {}) {
                if (t.is("text")) {
                    const i = this._processDataFromViewText(t);
                    return e.createTextNode(i)
                } else {
                    if (this.mapViewToDom(t)) {
                        return this.mapViewToDom(t)
                    }
                    let n;
                    if (t.is("documentFragment")) {
                        n = e.createDocumentFragment();
                        if (i.bind) {
                            this.bindDocumentFragments(n, t)
                        }
                    } else if (t.is("uiElement")) {
                        n = t.render(e);
                        if (i.bind) {
                            this.bindElements(n, t)
                        }
                        return n
                    } else {
                        if (t.hasAttribute("xmlns")) {
                            n = e.createElementNS(t.getAttribute("xmlns"), t.name)
                        } else {
                            n = e.createElement(t.name)
                        }
                        if (i.bind) {
                            this.bindElements(n, t)
                        }
                        for (const e of t.getAttributeKeys()) {
                            n.setAttribute(e, t.getAttribute(e))
                        }
                    }
                    if (i.withChildren || i.withChildren === undefined) {
                        for (const o of this.viewChildrenToDom(t, e, i)) {
                            n.appendChild(o)
                        }
                    }
                    return n
                }
            }

            * viewChildrenToDom(t, e, i = {}) {
                const n = t.getFillerOffset && t.getFillerOffset();
                let o = 0;
                for (const r of t.getChildren()) {
                    if (n === o) {
                        yield this._blockFiller(e)
                    }
                    yield this.viewToDom(r, e, i);
                    o++
                }
                if (n === o) {
                    yield this._blockFiller(e)
                }
            }

            viewRangeToDom(t) {
                const e = this.viewPositionToDom(t.start);
                const i = this.viewPositionToDom(t.end);
                const n = document.createRange();
                n.setStart(e.parent, e.offset);
                n.setEnd(i.parent, i.offset);
                return n
            }

            viewPositionToDom(t) {
                const e = t.parent;
                if (e.is("text")) {
                    const i = this.findCorrespondingDomText(e);
                    if (!i) {
                        return null
                    }
                    let n = t.offset;
                    if (ld(i)) {
                        n += ad
                    }
                    return {parent: i, offset: n}
                } else {
                    let i, n, o;
                    if (t.offset === 0) {
                        i = this.mapViewToDom(e);
                        if (!i) {
                            return null
                        }
                        o = i.childNodes[0]
                    } else {
                        const e = t.nodeBefore;
                        n = e.is("text") ? this.findCorrespondingDomText(e) : this.mapViewToDom(t.nodeBefore);
                        if (!n) {
                            return null
                        }
                        i = n.parentNode;
                        o = n.nextSibling
                    }
                    if (od(o) && ld(o)) {
                        return {parent: o, offset: ad}
                    }
                    const r = n ? Vd(n) + 1 : 0;
                    return {parent: i, offset: r}
                }
            }

            domToView(t, e = {}) {
                if (this.isBlockFiller(t, this.blockFillerMode)) {
                    return null
                }
                const i = this.getParentUIElement(t, this._domToViewMapping);
                if (i) {
                    return i
                }
                if (od(t)) {
                    if (dd(t)) {
                        return null
                    } else {
                        const e = this._processDataFromDomText(t);
                        return e === "" ? null : new Ls(this.document, e)
                    }
                } else if (this.isComment(t)) {
                    return null
                } else {
                    if (this.mapDomToView(t)) {
                        return this.mapDomToView(t)
                    }
                    let i;
                    if (this.isDocumentFragment(t)) {
                        i = new ql(this.document);
                        if (e.bind) {
                            this.bindDocumentFragments(t, i)
                        }
                    } else {
                        const n = e.keepOriginalCase ? t.tagName : t.tagName.toLowerCase();
                        i = new zc(this.document, n);
                        if (e.bind) {
                            this.bindElements(t, i)
                        }
                        const o = t.attributes;
                        for (let t = o.length - 1; t >= 0; t--) {
                            i._setAttribute(o[t].name, o[t].value)
                        }
                    }
                    if (e.withChildren || e.withChildren === undefined) {
                        for (const n of this.domChildrenToView(t, e)) {
                            i._appendChild(n)
                        }
                    }
                    return i
                }
            }

            * domChildrenToView(t, e = {}) {
                for (let i = 0; i < t.childNodes.length; i++) {
                    const n = t.childNodes[i];
                    const o = this.domToView(n, e);
                    if (o !== null) {
                        yield o
                    }
                }
            }

            domSelectionToView(t) {
                if (t.rangeCount === 1) {
                    let e = t.getRangeAt(0).startContainer;
                    if (od(e)) {
                        e = e.parentNode
                    }
                    const i = this.fakeSelectionToView(e);
                    if (i) {
                        return i
                    }
                }
                const e = this.isDomSelectionBackward(t);
                const i = [];
                for (let e = 0; e < t.rangeCount; e++) {
                    const n = t.getRangeAt(e);
                    const o = this.domRangeToView(n);
                    if (o) {
                        i.push(o)
                    }
                }
                return new gl(i, {backward: e})
            }

            domRangeToView(t) {
                const e = this.domPositionToView(t.startContainer, t.startOffset);
                const i = this.domPositionToView(t.endContainer, t.endOffset);
                if (e && i) {
                    return new ul(e, i)
                }
                return null
            }

            domPositionToView(t, e) {
                if (this.isBlockFiller(t, this.blockFillerMode)) {
                    return this.domPositionToView(t.parentNode, Vd(t))
                }
                const i = this.mapDomToView(t);
                if (i && i.is("uiElement")) {
                    return dl._createBefore(i)
                }
                if (od(t)) {
                    if (dd(t)) {
                        return this.domPositionToView(t.parentNode, Vd(t))
                    }
                    const i = this.findCorrespondingViewText(t);
                    let n = e;
                    if (!i) {
                        return null
                    }
                    if (ld(t)) {
                        n -= ad;
                        n = n < 0 ? 0 : n
                    }
                    return new dl(i, n)
                } else {
                    if (e === 0) {
                        const e = this.mapDomToView(t);
                        if (e) {
                            return new dl(e, 0)
                        }
                    } else {
                        const i = t.childNodes[e - 1];
                        const n = od(i) ? this.findCorrespondingViewText(i) : this.mapDomToView(i);
                        if (n && n.parent) {
                            return new dl(n.parent, n.index + 1)
                        }
                    }
                    return null
                }
            }

            mapDomToView(t) {
                return this.getParentUIElement(t) || this._domToViewMapping.get(t)
            }

            findCorrespondingViewText(t) {
                if (dd(t)) {
                    return null
                }
                const e = this.getParentUIElement(t);
                if (e) {
                    return e
                }
                const i = t.previousSibling;
                if (i) {
                    if (!this.isElement(i)) {
                        return null
                    }
                    const t = this.mapDomToView(i);
                    if (t) {
                        const e = t.nextSibling;
                        if (e instanceof Ls) {
                            return t.nextSibling
                        } else {
                            return null
                        }
                    }
                } else {
                    const e = this.mapDomToView(t.parentNode);
                    if (e) {
                        const t = e.getChild(0);
                        if (t instanceof Ls) {
                            return t
                        } else {
                            return null
                        }
                    }
                }
                return null
            }

            mapViewToDom(t) {
                return this._viewToDomMapping.get(t)
            }

            findCorrespondingDomText(t) {
                const e = t.previousSibling;
                if (e && this.mapViewToDom(e)) {
                    return this.mapViewToDom(e).nextSibling
                }
                if (!e && t.parent && this.mapViewToDom(t.parent)) {
                    return this.mapViewToDom(t.parent).childNodes[0]
                }
                return null
            }

            focus(t) {
                const e = this.mapViewToDom(t);
                if (e && e.ownerDocument.activeElement !== e) {
                    const {scrollX: t, scrollY: i} = Id.window;
                    const n = [];
                    Fd(e, t => {
                        const {scrollLeft: e, scrollTop: i} = t;
                        n.push([e, i])
                    });
                    e.focus();
                    Fd(e, t => {
                        const [e, i] = n.shift();
                        t.scrollLeft = e;
                        t.scrollTop = i
                    });
                    Id.window.scrollTo(t, i)
                }
            }

            isElement(t) {
                return t && t.nodeType == Node.ELEMENT_NODE
            }

            isDocumentFragment(t) {
                return t && t.nodeType == Node.DOCUMENT_FRAGMENT_NODE
            }

            isComment(t) {
                return t && t.nodeType == Node.COMMENT_NODE
            }

            isBlockFiller(t) {
                if (this.blockFillerMode == "br") {
                    return t.isEqualNode(Bd)
                }
                if (t.tagName === "BR" && jd(t, this.blockElements) && t.parentNode.childNodes.length === 1) {
                    return true
                }
                return Dd(t, this.blockElements)
            }

            isDomSelectionBackward(t) {
                if (t.isCollapsed) {
                    return false
                }
                const e = document.createRange();
                e.setStart(t.anchorNode, t.anchorOffset);
                e.setEnd(t.focusNode, t.focusOffset);
                const i = e.collapsed;
                e.detach();
                return i
            }

            getParentUIElement(t) {
                const e = Nd(t);
                e.pop();
                while (e.length) {
                    const t = e.pop();
                    const i = this._domToViewMapping.get(t);
                    if (i && i.is("uiElement")) {
                        return i
                    }
                }
                return null
            }

            isDomSelectionCorrect(t) {
                return this._isDomSelectionPositionCorrect(t.anchorNode, t.anchorOffset) && this._isDomSelectionPositionCorrect(t.focusNode, t.focusOffset)
            }

            _isDomSelectionPositionCorrect(t, e) {
                if (od(t) && ld(t) && e < ad) {
                    return false
                }
                if (this.isElement(t) && ld(t.childNodes[e])) {
                    return false
                }
                const i = this.mapDomToView(t);
                if (i && i.is("uiElement")) {
                    return false
                }
                return true
            }

            _processDataFromViewText(t) {
                let e = t.data;
                if (t.getAncestors().some(t => this.preElements.includes(t.name))) {
                    return e
                }
                if (e.charAt(0) == " ") {
                    const i = this._getTouchingViewTextNode(t, false);
                    const n = i && this._nodeEndsWithSpace(i);
                    if (n || !i) {
                        e = "" + e.substr(1)
                    }
                }
                if (e.charAt(e.length - 1) == " ") {
                    const i = this._getTouchingViewTextNode(t, true);
                    if (e.charAt(e.length - 2) == " " || !i || i.data.charAt(0) == " ") {
                        e = e.substr(0, e.length - 1) + ""
                    }
                }
                return e.replace(/ {2}/g, " ")
            }

            _nodeEndsWithSpace(t) {
                if (t.getAncestors().some(t => this.preElements.includes(t.name))) {
                    return false
                }
                const e = this._processDataFromViewText(t);
                return e.charAt(e.length - 1) == " "
            }

            _processDataFromDomText(t) {
                let e = t.data;
                if (Ld(t, this.preElements)) {
                    return ud(t)
                }
                e = e.replace(/[ \n\t\r]{1,}/g, " ");
                const i = this._getTouchingInlineDomNode(t, false);
                const n = this._getTouchingInlineDomNode(t, true);
                const o = this._checkShouldLeftTrimDomText(i);
                const r = this._checkShouldRightTrimDomText(t, n);
                if (o) {
                    e = e.replace(/^ /, "")
                }
                if (r) {
                    e = e.replace(/ $/, "")
                }
                e = ud(new Text(e));
                e = e.replace(/ \u00A0/g, "  ");
                if (/( |\u00A0)\u00A0$/.test(e) || !n || n.data && n.data.charAt(0) == " ") {
                    e = e.replace(/\u00A0$/, " ")
                }
                if (o) {
                    e = e.replace(/^\u00A0/, " ")
                }
                return e
            }

            _checkShouldLeftTrimDomText(t) {
                if (!t) {
                    return true
                }
                if (Kr(t)) {
                    return true
                }
                return /[^\S\u00A0]/.test(t.data.charAt(t.data.length - 1))
            }

            _checkShouldRightTrimDomText(t, e) {
                if (e) {
                    return false
                }
                return !ld(t)
            }

            _getTouchingViewTextNode(t, e) {
                const i = new ll({
                    startPosition: e ? dl._createAfter(t) : dl._createBefore(t),
                    direction: e ? "forward" : "backward"
                });
                for (const t of i) {
                    if (t.item.is("containerElement")) {
                        return null
                    } else if (t.item.is("br")) {
                        return null
                    } else if (t.item.is("textProxy")) {
                        return t.item
                    }
                }
                return null
            }

            _getTouchingInlineDomNode(t, e) {
                if (!t.parentNode) {
                    return null
                }
                const i = e ? "nextNode" : "previousNode";
                const n = t.ownerDocument;
                const o = Nd(t)[0];
                const r = n.createTreeWalker(o, NodeFilter.SHOW_TEXT | NodeFilter.SHOW_ELEMENT, {
                    acceptNode(t) {
                        if (od(t)) {
                            return NodeFilter.FILTER_ACCEPT
                        }
                        if (t.tagName == "BR") {
                            return NodeFilter.FILTER_ACCEPT
                        }
                        return NodeFilter.FILTER_SKIP
                    }
                });
                r.currentNode = t;
                const s = r[i]();
                if (s !== null) {
                    const e = Md(t, s);
                    if (e && !Ld(t, this.blockElements, e) && !Ld(s, this.blockElements, e)) {
                        return s
                    }
                }
                return null
            }
        }

        function Ld(t, e, i) {
            let n = Nd(t);
            if (i) {
                n = n.slice(n.indexOf(i) + 1)
            }
            return n.some(t => t.tagName && e.includes(t.tagName.toLowerCase()))
        }

        function Fd(t, e) {
            while (t && t != Id.document) {
                e(t);
                t = t.parentNode
            }
        }

        function Dd(t, e) {
            const i = od(t) && t.data == "";
            return i && jd(t, e) && t.parentNode.childNodes.length === 1
        }

        function jd(t, e) {
            const i = t.parentNode;
            return i && i.tagName && e.includes(i.tagName.toLowerCase())
        }

        function Hd(t) {
            const e = Object.prototype.toString.apply(t);
            if (e == "[object Window]") {
                return true
            }
            if (e == "[object global]") {
                return true
            }
            return false
        }

        const Wd = qc({}, ds, {
            listenTo(t, ...e) {
                if (xd(t) || Hd(t)) {
                    const i = this._getProxyEmitter(t) || new Ud(t);
                    i.attach(...e);
                    t = i
                }
                ds.listenTo.call(this, t, ...e)
            }, stopListening(t, e, i) {
                if (xd(t) || Hd(t)) {
                    const e = this._getProxyEmitter(t);
                    if (!e) {
                        return
                    }
                    t = e
                }
                ds.stopListening.call(this, t, e, i);
                if (t instanceof Ud) {
                    t.detach(e)
                }
            }, _getProxyEmitter(t) {
                return us(this, $d(t))
            }
        });
        var qd = Wd;

        class Ud {
            constructor(t) {
                hs(this, $d(t));
                this._domNode = t
            }
        }

        qc(Ud.prototype, ds, {
            attach(t, e, i = {}) {
                if (this._domListeners && this._domListeners[t]) {
                    return
                }
                const n = this._createDomListener(t, !!i.useCapture);
                this._domNode.addEventListener(t, n, !!i.useCapture);
                if (!this._domListeners) {
                    this._domListeners = {}
                }
                this._domListeners[t] = n
            }, detach(t) {
                let e;
                if (this._domListeners[t] && (!(e = this._events[t]) || !e.callbacks.length)) {
                    this._domListeners[t].removeListener()
                }
            }, _createDomListener(t, e) {
                const i = e => {
                    this.fire(t, e)
                };
                i.removeListener = () => {
                    this._domNode.removeEventListener(t, i, e);
                    delete this._domListeners[t]
                };
                return i
            }
        });

        function $d(t) {
            return t["data-ck-expando"] || (t["data-ck-expando"] = is())
        }

        class Gd {
            constructor(t) {
                this.view = t;
                this.document = t.document;
                this.isEnabled = false
            }

            enable() {
                this.isEnabled = true
            }

            disable() {
                this.isEnabled = false
            }

            destroy() {
                this.disable();
                this.stopListening()
            }
        }

        vs(Gd, qd);
        var Kd = "__lodash_hash_undefined__";

        function Jd(t) {
            this.__data__.set(t, Kd);
            return this
        }

        var Yd = Jd;

        function Qd(t) {
            return this.__data__.has(t)
        }

        var Xd = Qd;

        function Zd(t) {
            var e = -1, i = t == null ? 0 : t.length;
            this.__data__ = new _e;
            while (++e < i) {
                this.add(t[e])
            }
        }

        Zd.prototype.add = Zd.prototype.push = Yd;
        Zd.prototype.has = Xd;
        var tu = Zd;

        function eu(t, e) {
            var i = -1, n = t == null ? 0 : t.length;
            while (++i < n) {
                if (e(t[i], i, t)) {
                    return true
                }
            }
            return false
        }

        var iu = eu;

        function nu(t, e) {
            return t.has(e)
        }

        var ou = nu;
        var ru = 1, su = 2;

        function au(t, e, i, n, o, r) {
            var s = i & ru, a = t.length, c = e.length;
            if (a != c && !(s && c > a)) {
                return false
            }
            var l = r.get(t);
            if (l && r.get(e)) {
                return l == e
            }
            var d = -1, u = true, h = i & su ? new tu : undefined;
            r.set(t, e);
            r.set(e, t);
            while (++d < a) {
                var f = t[d], g = e[d];
                if (n) {
                    var m = s ? n(g, f, d, e, t, r) : n(f, g, d, t, e, r)
                }
                if (m !== undefined) {
                    if (m) {
                        continue
                    }
                    u = false;
                    break
                }
                if (h) {
                    if (!iu(e, (function (t, e) {
                        if (!ou(h, e) && (f === t || o(f, t, i, n, r))) {
                            return h.push(e)
                        }
                    }))) {
                        u = false;
                        break
                    }
                } else if (!(f === g || o(f, g, i, n, r))) {
                    u = false;
                    break
                }
            }
            r["delete"](t);
            r["delete"](e);
            return u
        }

        var cu = au;

        function lu(t) {
            var e = -1, i = Array(t.size);
            t.forEach((function (t, n) {
                i[++e] = [n, t]
            }));
            return i
        }

        var du = lu;

        function uu(t) {
            var e = -1, i = Array(t.size);
            t.forEach((function (t) {
                i[++e] = t
            }));
            return i
        }

        var hu = uu;
        var fu = 1, gu = 2;
        var mu = "[object Boolean]", pu = "[object Date]", bu = "[object Error]", wu = "[object Map]",
            ku = "[object Number]", _u = "[object RegExp]", vu = "[object Set]", yu = "[object String]",
            xu = "[object Symbol]";
        var Cu = "[object ArrayBuffer]", Au = "[object DataView]";
        var Tu = r ? r.prototype : undefined, Pu = Tu ? Tu.valueOf : undefined;

        function Su(t, e, i, n, o, r, s) {
            switch (i) {
                case Au:
                    if (t.byteLength != e.byteLength || t.byteOffset != e.byteOffset) {
                        return false
                    }
                    t = t.buffer;
                    e = e.buffer;
                case Cu:
                    if (t.byteLength != e.byteLength || !r(new fo(t), new fo(e))) {
                        return false
                    }
                    return true;
                case mu:
                case pu:
                case ku:
                    return L(+t, +e);
                case bu:
                    return t.name == e.name && t.message == e.message;
                case _u:
                case yu:
                    return t == e + "";
                case wu:
                    var a = du;
                case vu:
                    var c = n & fu;
                    a || (a = hu);
                    if (t.size != e.size && !c) {
                        return false
                    }
                    var l = s.get(t);
                    if (l) {
                        return l == e
                    }
                    n |= gu;
                    s.set(t, e);
                    var d = cu(a(t), a(e), n, o, r, s);
                    s["delete"](t);
                    return d;
                case xu:
                    if (Pu) {
                        return Pu.call(t) == Pu.call(e)
                    }
            }
            return false
        }

        var Eu = Su;
        var Ru = 1;
        var Ou = Object.prototype;
        var Iu = Ou.hasOwnProperty;

        function Vu(t, e, i, n, o, r) {
            var s = i & Ru, a = zn(t), c = a.length, l = zn(e), d = l.length;
            if (c != d && !s) {
                return false
            }
            var u = c;
            while (u--) {
                var h = a[u];
                if (!(s ? h in e : Iu.call(e, h))) {
                    return false
                }
            }
            var f = r.get(t);
            if (f && r.get(e)) {
                return f == e
            }
            var g = true;
            r.set(t, e);
            r.set(e, t);
            var m = s;
            while (++u < c) {
                h = a[u];
                var p = t[h], b = e[h];
                if (n) {
                    var w = s ? n(b, p, h, e, t, r) : n(p, b, h, t, e, r)
                }
                if (!(w === undefined ? p === b || o(p, b, i, n, r) : w)) {
                    g = false;
                    break
                }
                m || (m = h == "constructor")
            }
            if (g && !m) {
                var k = t.constructor, _ = e.constructor;
                if (k != _ && ("constructor" in t && "constructor" in e) && !(typeof k == "function" && k instanceof k && typeof _ == "function" && _ instanceof _)) {
                    g = false
                }
            }
            r["delete"](t);
            r["delete"](e);
            return g
        }

        var Nu = Vu;
        var Mu = 1;
        var Bu = "[object Arguments]", zu = "[object Array]", Lu = "[object Object]";
        var Fu = Object.prototype;
        var Du = Fu.hasOwnProperty;

        function ju(t, e, i, n, o, r) {
            var s = Je(t), a = Je(e), c = s ? zu : so(t), l = a ? zu : so(e);
            c = c == Bu ? Lu : c;
            l = l == Bu ? Lu : l;
            var d = c == Lu, u = l == Lu, h = c == l;
            if (h && Object(Ye["a"])(t)) {
                if (!Object(Ye["a"])(e)) {
                    return false
                }
                s = true;
                d = false
            }
            if (h && !d) {
                r || (r = new Ae);
                return s || Bi(t) ? cu(t, e, i, n, o, r) : Eu(t, e, c, i, n, o, r)
            }
            if (!(i & Mu)) {
                var f = d && Du.call(t, "__wrapped__"), g = u && Du.call(e, "__wrapped__");
                if (f || g) {
                    var m = f ? t.value() : t, p = g ? e.value() : e;
                    r || (r = new Ae);
                    return o(m, p, i, n, r)
                }
            }
            if (!h) {
                return false
            }
            r || (r = new Ae);
            return Nu(t, e, i, n, o, r)
        }

        var Hu = ju;

        function Wu(t, e, i, n, o) {
            if (t === e) {
                return true
            }
            if (t == null || e == null || !T(t) && !T(e)) {
                return t !== t && e !== e
            }
            return Hu(t, e, i, n, Wu, o)
        }

        var qu = Wu;

        function Uu(t, e, i) {
            i = typeof i == "function" ? i : undefined;
            var n = i ? i(t, e) : undefined;
            return n === undefined ? qu(t, e, undefined, i) : !!n
        }

        var $u = Uu;

        class Gu extends Gd {
            constructor(t) {
                super(t);
                this._config = {childList: true, characterData: true, characterDataOldValue: true, subtree: true};
                this.domConverter = t.domConverter;
                this.renderer = t._renderer;
                this._domElements = [];
                this._mutationObserver = new window.MutationObserver(this._onMutations.bind(this))
            }

            flush() {
                this._onMutations(this._mutationObserver.takeRecords())
            }

            observe(t) {
                this._domElements.push(t);
                if (this.isEnabled) {
                    this._mutationObserver.observe(t, this._config)
                }
            }

            enable() {
                super.enable();
                for (const t of this._domElements) {
                    this._mutationObserver.observe(t, this._config)
                }
            }

            disable() {
                super.disable();
                this._mutationObserver.disconnect()
            }

            destroy() {
                super.destroy();
                this._mutationObserver.disconnect()
            }

            _onMutations(t) {
                if (t.length === 0) {
                    return
                }
                const e = this.domConverter;
                const i = new Map;
                const n = new Set;
                for (const i of t) {
                    if (i.type === "childList") {
                        const t = e.mapDomToView(i.target);
                        if (t && t.is("uiElement")) {
                            continue
                        }
                        if (t && !this._isBogusBrMutation(i)) {
                            n.add(t)
                        }
                    }
                }
                for (const o of t) {
                    const t = e.mapDomToView(o.target);
                    if (t && t.is("uiElement")) {
                        continue
                    }
                    if (o.type === "characterData") {
                        const t = e.findCorrespondingViewText(o.target);
                        if (t && !n.has(t.parent)) {
                            i.set(t, {type: "text", oldText: t.data, newText: ud(o.target), node: t})
                        } else if (!t && ld(o.target)) {
                            n.add(e.mapDomToView(o.target.parentNode))
                        }
                    }
                }
                const o = [];
                for (const t of i.values()) {
                    this.renderer.markToSync("text", t.node);
                    o.push(t)
                }
                for (const t of n) {
                    const i = e.mapViewToDom(t);
                    const n = Array.from(t.getChildren());
                    const r = Array.from(e.domChildrenToView(i, {withChildren: false}));
                    if (!$u(n, r, a)) {
                        this.renderer.markToSync("children", t);
                        o.push({type: "children", oldChildren: n, newChildren: r, node: t})
                    }
                }
                const r = t[0].target.ownerDocument.getSelection();
                let s = null;
                if (r && r.anchorNode) {
                    const t = e.domPositionToView(r.anchorNode, r.anchorOffset);
                    const i = e.domPositionToView(r.focusNode, r.focusOffset);
                    if (t && i) {
                        s = new gl(t);
                        s.setFocus(i)
                    }
                }
                if (o.length) {
                    this.document.fire("mutations", o, s);
                    this.view.forceRender()
                }

                function a(t, e) {
                    if (Array.isArray(t)) {
                        return
                    }
                    if (t === e) {
                        return true
                    } else if (t.is("text") && e.is("text")) {
                        return t.data === e.data
                    }
                    return false
                }
            }

            _isBogusBrMutation(t) {
                let e = null;
                if (t.nextSibling === null && t.removedNodes.length === 0 && t.addedNodes.length == 1) {
                    e = this.domConverter.domToView(t.addedNodes[0], {withChildren: false})
                }
                return e && e.is("element", "br")
            }
        }

        class Ku {
            constructor(t, e, i) {
                this.view = t;
                this.document = t.document;
                this.domEvent = e;
                this.domTarget = e.target;
                qc(this, i)
            }

            get target() {
                return this.view.domConverter.mapDomToView(this.domTarget)
            }

            preventDefault() {
                this.domEvent.preventDefault()
            }

            stopPropagation() {
                this.domEvent.stopPropagation()
            }
        }

        class Ju extends Gd {
            constructor(t) {
                super(t);
                this.useCapture = false
            }

            observe(t) {
                const e = typeof this.domEventType == "string" ? [this.domEventType] : this.domEventType;
                e.forEach(e => {
                    this.listenTo(t, e, (t, e) => {
                        if (this.isEnabled) {
                            this.onDomEvent(e)
                        }
                    }, {useCapture: this.useCapture})
                })
            }

            fire(t, e, i) {
                if (this.isEnabled) {
                    this.document.fire(t, new Ku(this.view, e, i))
                }
            }
        }

        class Yu extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = ["keydown", "keyup"]
            }

            onDomEvent(t) {
                this.fire(t.type, t, {
                    keyCode: t.keyCode,
                    altKey: t.altKey,
                    ctrlKey: t.ctrlKey || t.metaKey,
                    shiftKey: t.shiftKey,
                    get keystroke() {
                        return Ml(this)
                    }
                })
            }
        }

        var Qu = function () {
            return n["a"].Date.now()
        };
        var Xu = Qu;
        var Zu = 0 / 0;
        var th = /^\s+|\s+$/g;
        var eh = /^[-+]0x[0-9a-f]+$/i;
        var ih = /^0b[01]+$/i;
        var nh = /^0o[0-7]+$/i;
        var oh = parseInt;

        function rh(t) {
            if (typeof t == "number") {
                return t
            }
            if (Qs(t)) {
                return Zu
            }
            if (ct(t)) {
                var e = typeof t.valueOf == "function" ? t.valueOf() : t;
                t = ct(e) ? e + "" : e
            }
            if (typeof t != "string") {
                return t === 0 ? t : +t
            }
            t = t.replace(th, "");
            var i = ih.test(t);
            return i || nh.test(t) ? oh(t.slice(2), i ? 2 : 8) : eh.test(t) ? Zu : +t
        }

        var sh = rh;
        var ah = "Expected a function";
        var ch = Math.max, lh = Math.min;

        function dh(t, e, i) {
            var n, o, r, s, a, c, l = 0, d = false, u = false, h = true;
            if (typeof t != "function") {
                throw new TypeError(ah)
            }
            e = sh(e) || 0;
            if (ct(i)) {
                d = !!i.leading;
                u = "maxWait" in i;
                r = u ? ch(sh(i.maxWait) || 0, e) : r;
                h = "trailing" in i ? !!i.trailing : h
            }

            function f(e) {
                var i = n, r = o;
                n = o = undefined;
                l = e;
                s = t.apply(r, i);
                return s
            }

            function g(t) {
                l = t;
                a = setTimeout(b, e);
                return d ? f(t) : s
            }

            function m(t) {
                var i = t - c, n = t - l, o = e - i;
                return u ? lh(o, r - n) : o
            }

            function p(t) {
                var i = t - c, n = t - l;
                return c === undefined || i >= e || i < 0 || u && n >= r
            }

            function b() {
                var t = Xu();
                if (p(t)) {
                    return w(t)
                }
                a = setTimeout(b, m(t))
            }

            function w(t) {
                a = undefined;
                if (h && n) {
                    return f(t)
                }
                n = o = undefined;
                return s
            }

            function k() {
                if (a !== undefined) {
                    clearTimeout(a)
                }
                l = 0;
                n = c = o = a = undefined
            }

            function _() {
                return a === undefined ? s : w(Xu())
            }

            function v() {
                var t = Xu(), i = p(t);
                n = arguments;
                o = this;
                c = t;
                if (i) {
                    if (a === undefined) {
                        return g(c)
                    }
                    if (u) {
                        clearTimeout(a);
                        a = setTimeout(b, e);
                        return f(c)
                    }
                }
                if (a === undefined) {
                    a = setTimeout(b, e)
                }
                return s
            }

            v.cancel = k;
            v.flush = _;
            return v
        }

        var uh = dh;

        class hh extends Gd {
            constructor(t) {
                super(t);
                this._fireSelectionChangeDoneDebounced = uh(t => this.document.fire("selectionChangeDone", t), 200)
            }

            observe() {
                const t = this.document;
                t.on("keydown", (e, i) => {
                    const n = t.selection;
                    if (n.isFake && fh(i.keyCode) && this.isEnabled) {
                        i.preventDefault();
                        this._handleSelectionMove(i.keyCode)
                    }
                }, {priority: "lowest"})
            }

            destroy() {
                super.destroy();
                this._fireSelectionChangeDoneDebounced.cancel()
            }

            _handleSelectionMove(t) {
                const e = this.document.selection;
                const i = new gl(e.getRanges(), {backward: e.isBackward, fake: false});
                if (t == Nl.arrowleft || t == Nl.arrowup) {
                    i.setTo(i.getFirstPosition())
                }
                if (t == Nl.arrowright || t == Nl.arrowdown) {
                    i.setTo(i.getLastPosition())
                }
                const n = {oldSelection: e, newSelection: i, domSelection: null};
                this.document.fire("selectionChange", n);
                this._fireSelectionChangeDoneDebounced(n)
            }
        }

        function fh(t) {
            return t == Nl.arrowright || t == Nl.arrowleft || t == Nl.arrowup || t == Nl.arrowdown
        }

        class gh extends Gd {
            constructor(t) {
                super(t);
                this.mutationObserver = t.getObserver(Gu);
                this.selection = this.document.selection;
                this.domConverter = t.domConverter;
                this._documents = new WeakSet;
                this._fireSelectionChangeDoneDebounced = uh(t => this.document.fire("selectionChangeDone", t), 200);
                this._clearInfiniteLoopInterval = setInterval(() => this._clearInfiniteLoop(), 1e3);
                this._loopbackCounter = 0
            }

            observe(t) {
                const e = t.ownerDocument;
                if (this._documents.has(e)) {
                    return
                }
                this.listenTo(e, "selectionchange", () => {
                    this._handleSelectionChange(e)
                });
                this._documents.add(e)
            }

            destroy() {
                super.destroy();
                clearInterval(this._clearInfiniteLoopInterval);
                this._fireSelectionChangeDoneDebounced.cancel()
            }

            _handleSelectionChange(t) {
                if (!this.isEnabled) {
                    return
                }
                this.mutationObserver.flush();
                const e = t.defaultView.getSelection();
                const i = this.domConverter.domSelectionToView(e);
                if (i.rangeCount == 0) {
                    return
                }
                if (this.selection.isEqual(i) && this.domConverter.isDomSelectionCorrect(e)) {
                    return
                }
                if (++this._loopbackCounter > 60) {
                    return
                }
                if (this.selection.isSimilar(i)) {
                    this.view.forceRender()
                } else {
                    const t = {oldSelection: this.selection, newSelection: i, domSelection: e};
                    this.document.fire("selectionChange", t);
                    this._fireSelectionChangeDoneDebounced(t)
                }
            }

            _clearInfiniteLoop() {
                this._loopbackCounter = 0
            }
        }

        class mh extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = ["focus", "blur"];
                this.useCapture = true;
                const e = this.document;
                e.on("focus", () => {
                    e.isFocused = true;
                    this._renderTimeoutId = setTimeout(() => t.forceRender(), 50)
                });
                e.on("blur", (i, n) => {
                    const o = e.selection.editableElement;
                    if (o === null || o === n.target) {
                        e.isFocused = false;
                        t.forceRender()
                    }
                })
            }

            onDomEvent(t) {
                this.fire(t.type, t)
            }

            destroy() {
                if (this._renderTimeoutId) {
                    clearTimeout(this._renderTimeoutId)
                }
                super.destroy()
            }
        }

        class ph extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = ["compositionstart", "compositionupdate", "compositionend"];
                const e = this.document;
                e.on("compositionstart", () => {
                    e.isComposing = true
                });
                e.on("compositionend", () => {
                    e.isComposing = false
                })
            }

            onDomEvent(t) {
                this.fire(t.type, t)
            }
        }

        class bh extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = ["beforeinput"]
            }

            onDomEvent(t) {
                this.fire(t.type, t)
            }
        }

        function wh(t) {
            return Object.prototype.toString.apply(t) == "[object Range]"
        }

        function kh(t) {
            const e = t.ownerDocument.defaultView.getComputedStyle(t);
            return {
                top: parseInt(e.borderTopWidth, 10),
                right: parseInt(e.borderRightWidth, 10),
                bottom: parseInt(e.borderBottomWidth, 10),
                left: parseInt(e.borderLeftWidth, 10)
            }
        }

        const _h = ["top", "right", "bottom", "left", "width", "height"];

        class vh {
            constructor(t) {
                const e = wh(t);
                Object.defineProperty(this, "_source", {value: t._source || t, writable: true, enumerable: false});
                if (Kr(t) || e) {
                    if (e) {
                        yh(this, vh.getDomRangeRects(t)[0])
                    } else {
                        yh(this, t.getBoundingClientRect())
                    }
                } else if (Hd(t)) {
                    const {innerWidth: e, innerHeight: i} = t;
                    yh(this, {top: 0, right: e, bottom: i, left: 0, width: e, height: i})
                } else {
                    yh(this, t)
                }
            }

            clone() {
                return new vh(this)
            }

            moveTo(t, e) {
                this.top = e;
                this.right = t + this.width;
                this.bottom = e + this.height;
                this.left = t;
                return this
            }

            moveBy(t, e) {
                this.top += e;
                this.right += t;
                this.left += t;
                this.bottom += e;
                return this
            }

            getIntersection(t) {
                const e = {
                    top: Math.max(this.top, t.top),
                    right: Math.min(this.right, t.right),
                    bottom: Math.min(this.bottom, t.bottom),
                    left: Math.max(this.left, t.left)
                };
                e.width = e.right - e.left;
                e.height = e.bottom - e.top;
                if (e.width < 0 || e.height < 0) {
                    return null
                } else {
                    return new vh(e)
                }
            }

            getIntersectionArea(t) {
                const e = this.getIntersection(t);
                if (e) {
                    return e.getArea()
                } else {
                    return 0
                }
            }

            getArea() {
                return this.width * this.height
            }

            getVisible() {
                const t = this._source;
                let e = this.clone();
                if (!xh(t)) {
                    let i = t.parentNode || t.commonAncestorContainer;
                    while (i && !xh(i)) {
                        const t = new vh(i);
                        const n = e.getIntersection(t);
                        if (n) {
                            if (n.getArea() < e.getArea()) {
                                e = n
                            }
                        } else {
                            return null
                        }
                        i = i.parentNode
                    }
                }
                return e
            }

            isEqual(t) {
                for (const e of _h) {
                    if (this[e] !== t[e]) {
                        return false
                    }
                }
                return true
            }

            contains(t) {
                const e = this.getIntersection(t);
                return !!(e && e.isEqual(t))
            }

            excludeScrollbarsAndBorders() {
                const t = this._source;
                let e, i, n;
                if (Hd(t)) {
                    e = t.innerWidth - t.document.documentElement.clientWidth;
                    i = t.innerHeight - t.document.documentElement.clientHeight;
                    n = t.getComputedStyle(t.document.documentElement).direction
                } else {
                    const o = kh(this._source);
                    e = t.offsetWidth - t.clientWidth - o.left - o.right;
                    i = t.offsetHeight - t.clientHeight - o.top - o.bottom;
                    n = t.ownerDocument.defaultView.getComputedStyle(t).direction;
                    this.left += o.left;
                    this.top += o.top;
                    this.right -= o.right;
                    this.bottom -= o.bottom;
                    this.width = this.right - this.left;
                    this.height = this.bottom - this.top
                }
                this.width -= e;
                if (n === "ltr") {
                    this.right -= e
                } else {
                    this.left += e
                }
                this.height -= i;
                this.bottom -= i;
                return this
            }

            static getDomRangeRects(t) {
                const e = [];
                const i = Array.from(t.getClientRects());
                if (i.length) {
                    for (const t of i) {
                        e.push(new vh(t))
                    }
                } else {
                    let i = t.startContainer;
                    if (od(i)) {
                        i = i.parentNode
                    }
                    const n = new vh(i.getBoundingClientRect());
                    n.right = n.left;
                    n.width = 0;
                    e.push(n)
                }
                return e
            }
        }

        function yh(t, e) {
            for (const i of _h) {
                t[i] = e[i]
            }
        }

        function xh(t) {
            if (!Kr(t)) {
                return false
            }
            return t === t.ownerDocument.body
        }

        const Ch = {};

        function Ah({target: t, viewportOffset: e = 0}) {
            const i = Vh(t);
            let n = i;
            let o = null;
            while (n) {
                let r;
                if (n == i) {
                    r = Nh(t)
                } else {
                    r = Nh(o)
                }
                Sh(r, () => Mh(t, n));
                const s = Mh(t, n);
                Ph(n, s, e);
                if (n.parent != n) {
                    o = n.frameElement;
                    n = n.parent;
                    if (!o) {
                        return
                    }
                } else {
                    n = null
                }
            }
        }

        function Th(t) {
            const e = Nh(t);
            Sh(e, () => new vh(t))
        }

        Object.assign(Ch, {scrollViewportToShowTarget: Ah, scrollAncestorsToShowTarget: Th});

        function Ph(t, e, i) {
            const n = e.clone().moveBy(0, i);
            const o = e.clone().moveBy(0, -i);
            const r = new vh(t).excludeScrollbarsAndBorders();
            const s = [o, n];
            if (!s.every(t => r.contains(t))) {
                let {scrollX: s, scrollY: a} = t;
                if (Rh(o, r)) {
                    a -= r.top - e.top + i
                } else if (Eh(n, r)) {
                    a += e.bottom - r.bottom + i
                }
                if (Oh(e, r)) {
                    s -= r.left - e.left + i
                } else if (Ih(e, r)) {
                    s += e.right - r.right + i
                }
                t.scrollTo(s, a)
            }
        }

        function Sh(t, e) {
            const i = Vh(t);
            let n, o;
            while (t != i.document.body) {
                o = e();
                n = new vh(t).excludeScrollbarsAndBorders();
                if (!n.contains(o)) {
                    if (Rh(o, n)) {
                        t.scrollTop -= n.top - o.top
                    } else if (Eh(o, n)) {
                        t.scrollTop += o.bottom - n.bottom
                    }
                    if (Oh(o, n)) {
                        t.scrollLeft -= n.left - o.left
                    } else if (Ih(o, n)) {
                        t.scrollLeft += o.right - n.right
                    }
                }
                t = t.parentNode
            }
        }

        function Eh(t, e) {
            return t.bottom > e.bottom
        }

        function Rh(t, e) {
            return t.top < e.top
        }

        function Oh(t, e) {
            return t.left < e.left
        }

        function Ih(t, e) {
            return t.right > e.right
        }

        function Vh(t) {
            if (wh(t)) {
                return t.startContainer.ownerDocument.defaultView
            } else {
                return t.ownerDocument.defaultView
            }
        }

        function Nh(t) {
            if (wh(t)) {
                let e = t.commonAncestorContainer;
                if (od(e)) {
                    e = e.parentNode
                }
                return e
            } else {
                return t.parentNode
            }
        }

        function Mh(t, e) {
            const i = Vh(t);
            const n = new vh(t);
            if (i === e) {
                return n
            } else {
                let t = i;
                while (t != e) {
                    const e = t.frameElement;
                    const i = new vh(e).excludeScrollbarsAndBorders();
                    n.moveBy(i.left, i.top);
                    t = t.parent
                }
            }
            return n
        }

        class Bh {
            constructor(t) {
                this.document = new pl(t);
                this.domConverter = new zd(this.document);
                this.domRoots = new Map;
                this.set("isRenderingInProgress", false);
                this._renderer = new Cd(this.domConverter, this.document.selection);
                this._renderer.bind("isFocused").to(this.document);
                this._initialDomRootAttributes = new WeakMap;
                this._observers = new Map;
                this._ongoingChange = false;
                this._postFixersInProgress = false;
                this._renderingDisabled = false;
                this._hasChangedSinceTheLastRendering = false;
                this._writer = new $l(this.document);
                this.addObserver(Gu);
                this.addObserver(gh);
                this.addObserver(mh);
                this.addObserver(Yu);
                this.addObserver(hh);
                this.addObserver(ph);
                if (Al.isAndroid) {
                    this.addObserver(bh)
                }
                hd(this);
                jl(this);
                this.on("render", () => {
                    this._render();
                    this.document.fire("layoutChanged");
                    this._hasChangedSinceTheLastRendering = false
                });
                this.listenTo(this.document.selection, "change", () => {
                    this._hasChangedSinceTheLastRendering = true
                })
            }

            attachDomRoot(t, e = "main") {
                const i = this.document.getRoot(e);
                i._name = t.tagName.toLowerCase();
                const n = {};
                for (const {name: e, value: o} of Array.from(t.attributes)) {
                    n[e] = o;
                    if (e === "class") {
                        this._writer.addClass(o.split(" "), i)
                    } else {
                        this._writer.setAttribute(e, o, i)
                    }
                }
                this._initialDomRootAttributes.set(t, n);
                const o = () => {
                    this._writer.setAttribute("contenteditable", !i.isReadOnly, i);
                    if (i.isReadOnly) {
                        this._writer.addClass("ck-read-only", i)
                    } else {
                        this._writer.removeClass("ck-read-only", i)
                    }
                };
                o();
                this.domRoots.set(e, t);
                this.domConverter.bindElements(t, i);
                this._renderer.markToSync("children", i);
                this._renderer.markToSync("attributes", i);
                this._renderer.domDocuments.add(t.ownerDocument);
                i.on("change:children", (t, e) => this._renderer.markToSync("children", e));
                i.on("change:attributes", (t, e) => this._renderer.markToSync("attributes", e));
                i.on("change:text", (t, e) => this._renderer.markToSync("text", e));
                i.on("change:isReadOnly", () => this.change(o));
                i.on("change", () => {
                    this._hasChangedSinceTheLastRendering = true
                });
                for (const i of this._observers.values()) {
                    i.observe(t, e)
                }
            }

            detachDomRoot(t) {
                const e = this.domRoots.get(t);
                Array.from(e.attributes).forEach(({name: t}) => e.removeAttribute(t));
                const i = this._initialDomRootAttributes.get(e);
                for (const t in i) {
                    e.setAttribute(t, i[t])
                }
                this.domRoots.delete(t);
                this.domConverter.unbindDomElement(e)
            }

            getDomRoot(t = "main") {
                return this.domRoots.get(t)
            }

            addObserver(t) {
                let e = this._observers.get(t);
                if (e) {
                    return e
                }
                e = new t(this);
                this._observers.set(t, e);
                for (const [t, i] of this.domRoots) {
                    e.observe(i, t)
                }
                e.enable();
                return e
            }

            getObserver(t) {
                return this._observers.get(t)
            }

            disableObservers() {
                for (const t of this._observers.values()) {
                    t.disable()
                }
            }

            enableObservers() {
                for (const t of this._observers.values()) {
                    t.enable()
                }
            }

            scrollToTheSelection() {
                const t = this.document.selection.getFirstRange();
                if (t) {
                    Ah({target: this.domConverter.viewRangeToDom(t), viewportOffset: 20})
                }
            }

            focus() {
                if (!this.document.isFocused) {
                    const t = this.document.selection.editableElement;
                    if (t) {
                        this.domConverter.focus(t);
                        this.forceRender()
                    } else {
                    }
                }
            }

            change(t) {
                if (this.isRenderingInProgress || this._postFixersInProgress) {
                    throw new ss["b"]("cannot-change-view-tree: " + "Attempting to make changes to the view when it is in an incorrect state: rendering or post-fixers are in progress. " + "This may cause some unexpected behavior and inconsistency between the DOM and the view.", this)
                }
                try {
                    if (this._ongoingChange) {
                        return t(this._writer)
                    }
                    this._ongoingChange = true;
                    const e = t(this._writer);
                    this._ongoingChange = false;
                    if (!this._renderingDisabled && this._hasChangedSinceTheLastRendering) {
                        this._postFixersInProgress = true;
                        this.document._callPostFixers(this._writer);
                        this._postFixersInProgress = false;
                        this.fire("render")
                    }
                    return e
                } catch (t) {
                    ss["b"].rethrowUnexpectedError(t, this)
                }
            }

            forceRender() {
                this._hasChangedSinceTheLastRendering = true;
                this.change(() => {
                })
            }

            destroy() {
                for (const t of this._observers.values()) {
                    t.destroy()
                }
                this.document.destroy();
                this.stopListening()
            }

            createPositionAt(t, e) {
                return dl._createAt(t, e)
            }

            createPositionAfter(t) {
                return dl._createAfter(t)
            }

            createPositionBefore(t) {
                return dl._createBefore(t)
            }

            createRange(t, e) {
                return new ul(t, e)
            }

            createRangeOn(t) {
                return ul._createOn(t)
            }

            createRangeIn(t) {
                return ul._createIn(t)
            }

            createSelection(t, e, i) {
                return new gl(t, e, i)
            }

            _disableRendering(t) {
                this._renderingDisabled = t;
                if (t == false) {
                    this.change(() => {
                    })
                }
            }

            _render() {
                this.isRenderingInProgress = true;
                this.disableObservers();
                this._renderer.render();
                this.enableObservers();
                this.isRenderingInProgress = false
            }
        }

        vs(Bh, Jc);

        class zh {
            constructor(t) {
                this.parent = null;
                this._attrs = Hs(t)
            }

            get index() {
                let t;
                if (!this.parent) {
                    return null
                }
                if ((t = this.parent.getChildIndex(this)) === null) {
                    throw new ss["b"]("model-node-not-found-in-parent: The node's parent does not contain this node.", this)
                }
                return t
            }

            get startOffset() {
                let t;
                if (!this.parent) {
                    return null
                }
                if ((t = this.parent.getChildStartOffset(this)) === null) {
                    throw new ss["b"]("model-node-not-found-in-parent: The node's parent does not contain this node.", this)
                }
                return t
            }

            get offsetSize() {
                return 1
            }

            get endOffset() {
                if (!this.parent) {
                    return null
                }
                return this.startOffset + this.offsetSize
            }

            get nextSibling() {
                const t = this.index;
                return t !== null && this.parent.getChild(t + 1) || null
            }

            get previousSibling() {
                const t = this.index;
                return t !== null && this.parent.getChild(t - 1) || null
            }

            get root() {
                let t = this;
                while (t.parent) {
                    t = t.parent
                }
                return t
            }

            isAttached() {
                return this.root.is("rootElement")
            }

            getPath() {
                const t = [];
                let e = this;
                while (e.parent) {
                    t.unshift(e.startOffset);
                    e = e.parent
                }
                return t
            }

            getAncestors(t = {includeSelf: false, parentFirst: false}) {
                const e = [];
                let i = t.includeSelf ? this : this.parent;
                while (i) {
                    e[t.parentFirst ? "push" : "unshift"](i);
                    i = i.parent
                }
                return e
            }

            getCommonAncestor(t, e = {}) {
                const i = this.getAncestors(e);
                const n = t.getAncestors(e);
                let o = 0;
                while (i[o] == n[o] && i[o]) {
                    o++
                }
                return o === 0 ? null : i[o - 1]
            }

            isBefore(t) {
                if (this == t) {
                    return false
                }
                if (this.root !== t.root) {
                    return false
                }
                const e = this.getPath();
                const i = t.getPath();
                const n = Vs(e, i);
                switch (n) {
                    case"prefix":
                        return true;
                    case"extension":
                        return false;
                    default:
                        return e[n] < i[n]
                }
            }

            isAfter(t) {
                if (this == t) {
                    return false
                }
                if (this.root !== t.root) {
                    return false
                }
                return !this.isBefore(t)
            }

            hasAttribute(t) {
                return this._attrs.has(t)
            }

            getAttribute(t) {
                return this._attrs.get(t)
            }

            getAttributes() {
                return this._attrs.entries()
            }

            getAttributeKeys() {
                return this._attrs.keys()
            }

            toJSON() {
                const t = {};
                if (this._attrs.size) {
                    t.attributes = Array.from(this._attrs).reduce((t, e) => {
                        t[e[0]] = e[1];
                        return t
                    }, {})
                }
                return t
            }

            is(t) {
                return t == "node" || t == "model:node"
            }

            _clone() {
                return new zh(this._attrs)
            }

            _remove() {
                this.parent._removeChildren(this.index)
            }

            _setAttribute(t, e) {
                this._attrs.set(t, e)
            }

            _setAttributesTo(t) {
                this._attrs = Hs(t)
            }

            _removeAttribute(t) {
                return this._attrs.delete(t)
            }

            _clearAttributes() {
                this._attrs.clear()
            }
        }

        class Lh extends zh {
            constructor(t, e) {
                super(e);
                this._data = t || ""
            }

            get offsetSize() {
                return this.data.length
            }

            get data() {
                return this._data
            }

            is(t) {
                return t == "text" || t == "model:text" || super.is(t)
            }

            toJSON() {
                const t = super.toJSON();
                t.data = this.data;
                return t
            }

            _clone() {
                return new Lh(this.data, this.getAttributes())
            }

            static fromJSON(t) {
                return new Lh(t.data, t.attributes)
            }
        }

        class Fh {
            constructor(t, e, i) {
                this.textNode = t;
                if (e < 0 || e > t.offsetSize) {
                    throw new ss["b"]("model-textproxy-wrong-offsetintext: Given offsetInText value is incorrect.", this)
                }
                if (i < 0 || e + i > t.offsetSize) {
                    throw new ss["b"]("model-textproxy-wrong-length: Given length value is incorrect.", this)
                }
                this.data = t.data.substring(e, e + i);
                this.offsetInText = e
            }

            get startOffset() {
                return this.textNode.startOffset !== null ? this.textNode.startOffset + this.offsetInText : null
            }

            get offsetSize() {
                return this.data.length
            }

            get endOffset() {
                return this.startOffset !== null ? this.startOffset + this.offsetSize : null
            }

            get isPartial() {
                return this.offsetSize !== this.textNode.offsetSize
            }

            get parent() {
                return this.textNode.parent
            }

            get root() {
                return this.textNode.root
            }

            is(t) {
                return t == "textProxy" || t == "model:textProxy"
            }

            getPath() {
                const t = this.textNode.getPath();
                if (t.length > 0) {
                    t[t.length - 1] += this.offsetInText
                }
                return t
            }

            getAncestors(t = {includeSelf: false, parentFirst: false}) {
                const e = [];
                let i = t.includeSelf ? this : this.parent;
                while (i) {
                    e[t.parentFirst ? "push" : "unshift"](i);
                    i = i.parent
                }
                return e
            }

            hasAttribute(t) {
                return this.textNode.hasAttribute(t)
            }

            getAttribute(t) {
                return this.textNode.getAttribute(t)
            }

            getAttributes() {
                return this.textNode.getAttributes()
            }

            getAttributeKeys() {
                return this.textNode.getAttributeKeys()
            }
        }

        class Dh {
            constructor(t) {
                this._nodes = [];
                if (t) {
                    this._insertNodes(0, t)
                }
            }

            [Symbol.iterator]() {
                return this._nodes[Symbol.iterator]()
            }

            get length() {
                return this._nodes.length
            }

            get maxOffset() {
                return this._nodes.reduce((t, e) => t + e.offsetSize, 0)
            }

            getNode(t) {
                return this._nodes[t] || null
            }

            getNodeIndex(t) {
                const e = this._nodes.indexOf(t);
                return e == -1 ? null : e
            }

            getNodeStartOffset(t) {
                const e = this.getNodeIndex(t);
                return e === null ? null : this._nodes.slice(0, e).reduce((t, e) => t + e.offsetSize, 0)
            }

            indexToOffset(t) {
                if (t == this._nodes.length) {
                    return this.maxOffset
                }
                const e = this._nodes[t];
                if (!e) {
                    throw new ss["b"]("model-nodelist-index-out-of-bounds: Given index cannot be found in the node list.", this)
                }
                return this.getNodeStartOffset(e)
            }

            offsetToIndex(t) {
                let e = 0;
                for (const i of this._nodes) {
                    if (t >= e && t < e + i.offsetSize) {
                        return this.getNodeIndex(i)
                    }
                    e += i.offsetSize
                }
                if (e != t) {
                    throw new ss["b"]("model-nodelist-offset-out-of-bounds: Given offset cannot be found in the node list.", this, {
                        offset: t,
                        nodeList: this
                    })
                }
                return this.length
            }

            _insertNodes(t, e) {
                for (const t of e) {
                    if (!(t instanceof zh)) {
                        throw new ss["b"]("model-nodelist-insertNodes-not-node: Trying to insert an object which is not a Node instance.", this)
                    }
                }
                this._nodes.splice(t, 0, ...e)
            }

            _removeNodes(t, e = 1) {
                return this._nodes.splice(t, e)
            }

            toJSON() {
                return this._nodes.map(t => t.toJSON())
            }
        }

        class jh extends zh {
            constructor(t, e, i) {
                super(e);
                this.name = t;
                this._children = new Dh;
                if (i) {
                    this._insertChild(0, i)
                }
            }

            get childCount() {
                return this._children.length
            }

            get maxOffset() {
                return this._children.maxOffset
            }

            get isEmpty() {
                return this.childCount === 0
            }

            is(t, e = null) {
                const i = t.replace(/^model:/, "");
                if (!e) {
                    return i == "element" || i == this.name || super.is(t)
                } else {
                    return i == "element" && e == this.name
                }
            }

            getChild(t) {
                return this._children.getNode(t)
            }

            getChildren() {
                return this._children[Symbol.iterator]()
            }

            getChildIndex(t) {
                return this._children.getNodeIndex(t)
            }

            getChildStartOffset(t) {
                return this._children.getNodeStartOffset(t)
            }

            offsetToIndex(t) {
                return this._children.offsetToIndex(t)
            }

            getNodeByPath(t) {
                let e = this;
                for (const i of t) {
                    e = e.getChild(e.offsetToIndex(i))
                }
                return e
            }

            toJSON() {
                const t = super.toJSON();
                t.name = this.name;
                if (this._children.length > 0) {
                    t.children = [];
                    for (const e of this._children) {
                        t.children.push(e.toJSON())
                    }
                }
                return t
            }

            _clone(t = false) {
                const e = t ? Array.from(this._children).map(t => t._clone(true)) : null;
                return new jh(this.name, this.getAttributes(), e)
            }

            _appendChild(t) {
                this._insertChild(this.childCount, t)
            }

            _insertChild(t, e) {
                const i = Hh(e);
                for (const t of i) {
                    if (t.parent !== null) {
                        t._remove()
                    }
                    t.parent = this
                }
                this._children._insertNodes(t, i)
            }

            _removeChildren(t, e = 1) {
                const i = this._children._removeNodes(t, e);
                for (const t of i) {
                    t.parent = null
                }
                return i
            }

            static fromJSON(t) {
                let e = null;
                if (t.children) {
                    e = [];
                    for (const i of t.children) {
                        if (i.name) {
                            e.push(jh.fromJSON(i))
                        } else {
                            e.push(Lh.fromJSON(i))
                        }
                    }
                }
                return new jh(t.name, t.attributes, e)
            }
        }

        function Hh(t) {
            if (typeof t == "string") {
                return [new Lh(t)]
            }
            if (!js(t)) {
                t = [t]
            }
            return Array.from(t).map(t => {
                if (typeof t == "string") {
                    return new Lh(t)
                }
                if (t instanceof Fh) {
                    return new Lh(t.data, t.getAttributes())
                }
                return t
            })
        }

        class Wh {
            constructor(t = {}) {
                if (!t.boundaries && !t.startPosition) {
                    throw new ss["b"]("model-tree-walker-no-start-position: Neither boundaries nor starting position have been defined.", null)
                }
                const e = t.direction || "forward";
                if (e != "forward" && e != "backward") {
                    throw new ss["b"]("model-tree-walker-unknown-direction: Only `backward` and `forward` direction allowed.", t, {direction: e})
                }
                this.direction = e;
                this.boundaries = t.boundaries || null;
                if (t.startPosition) {
                    this.position = t.startPosition.clone()
                } else {
                    this.position = Uh._createAt(this.boundaries[this.direction == "backward" ? "end" : "start"])
                }
                this.position.stickiness = "toNone";
                this.singleCharacters = !!t.singleCharacters;
                this.shallow = !!t.shallow;
                this.ignoreElementEnd = !!t.ignoreElementEnd;
                this._boundaryStartParent = this.boundaries ? this.boundaries.start.parent : null;
                this._boundaryEndParent = this.boundaries ? this.boundaries.end.parent : null;
                this._visitedParent = this.position.parent
            }

            [Symbol.iterator]() {
                return this
            }

            skip(t) {
                let e, i, n, o;
                do {
                    n = this.position;
                    o = this._visitedParent;
                    ({done: e, value: i} = this.next())
                } while (!e && t(i));
                if (!e) {
                    this.position = n;
                    this._visitedParent = o
                }
            }

            next() {
                if (this.direction == "forward") {
                    return this._next()
                } else {
                    return this._previous()
                }
            }

            _next() {
                const t = this.position;
                const e = this.position.clone();
                const i = this._visitedParent;
                if (i.parent === null && e.offset === i.maxOffset) {
                    return {done: true}
                }
                if (i === this._boundaryEndParent && e.offset == this.boundaries.end.offset) {
                    return {done: true}
                }
                const n = e.textNode ? e.textNode : e.nodeAfter;
                if (n instanceof jh) {
                    if (!this.shallow) {
                        e.path.push(0);
                        this._visitedParent = n
                    } else {
                        e.offset++
                    }
                    this.position = e;
                    return qh("elementStart", n, t, e, 1)
                } else if (n instanceof Lh) {
                    let o;
                    if (this.singleCharacters) {
                        o = 1
                    } else {
                        let t = n.endOffset;
                        if (this._boundaryEndParent == i && this.boundaries.end.offset < t) {
                            t = this.boundaries.end.offset
                        }
                        o = t - e.offset
                    }
                    const r = e.offset - n.startOffset;
                    const s = new Fh(n, r, o);
                    e.offset += o;
                    this.position = e;
                    return qh("text", s, t, e, o)
                } else {
                    e.path.pop();
                    e.offset++;
                    this.position = e;
                    this._visitedParent = i.parent;
                    if (this.ignoreElementEnd) {
                        return this._next()
                    } else {
                        return qh("elementEnd", i, t, e)
                    }
                }
            }

            _previous() {
                const t = this.position;
                const e = this.position.clone();
                const i = this._visitedParent;
                if (i.parent === null && e.offset === 0) {
                    return {done: true}
                }
                if (i == this._boundaryStartParent && e.offset == this.boundaries.start.offset) {
                    return {done: true}
                }
                const n = e.textNode ? e.textNode : e.nodeBefore;
                if (n instanceof jh) {
                    e.offset--;
                    if (!this.shallow) {
                        e.path.push(n.maxOffset);
                        this.position = e;
                        this._visitedParent = n;
                        if (this.ignoreElementEnd) {
                            return this._previous()
                        } else {
                            return qh("elementEnd", n, t, e)
                        }
                    } else {
                        this.position = e;
                        return qh("elementStart", n, t, e, 1)
                    }
                } else if (n instanceof Lh) {
                    let o;
                    if (this.singleCharacters) {
                        o = 1
                    } else {
                        let t = n.startOffset;
                        if (this._boundaryStartParent == i && this.boundaries.start.offset > t) {
                            t = this.boundaries.start.offset
                        }
                        o = e.offset - t
                    }
                    const r = e.offset - n.startOffset;
                    const s = new Fh(n, r - o, o);
                    e.offset -= o;
                    this.position = e;
                    return qh("text", s, t, e, o)
                } else {
                    e.path.pop();
                    this.position = e;
                    this._visitedParent = i.parent;
                    return qh("elementStart", i, t, e, 1)
                }
            }
        }

        function qh(t, e, i, n, o) {
            return {done: false, value: {type: t, item: e, previousPosition: i, nextPosition: n, length: o}}
        }

        class Uh {
            constructor(t, e, i = "toNone") {
                if (!t.is("element") && !t.is("documentFragment")) {
                    throw new ss["b"]("model-position-root-invalid: Position root invalid.", t)
                }
                if (!(e instanceof Array) || e.length === 0) {
                    throw new ss["b"]("model-position-path-incorrect-format: Position path must be an array with at least one item.", t, {path: e})
                }
                e = t.getPath().concat(e);
                t = t.root;
                this.root = t;
                this.path = e;
                this.stickiness = i
            }

            get offset() {
                return Ca(this.path)
            }

            set offset(t) {
                this.path[this.path.length - 1] = t
            }

            get parent() {
                let t = this.root;
                for (let e = 0; e < this.path.length - 1; e++) {
                    t = t.getChild(t.offsetToIndex(this.path[e]));
                    if (!t) {
                        throw new ss["b"]("model-position-path-incorrect: The position's path is incorrect.", this, {position: this})
                    }
                }
                if (t.is("text")) {
                    throw new ss["b"]("model-position-path-incorrect: The position's path is incorrect.", this, {position: this})
                }
                return t
            }

            get index() {
                return this.parent.offsetToIndex(this.offset)
            }

            get textNode() {
                const t = this.parent.getChild(this.index);
                return t instanceof Lh && t.startOffset < this.offset ? t : null
            }

            get nodeAfter() {
                return this.textNode === null ? this.parent.getChild(this.index) : null
            }

            get nodeBefore() {
                return this.textNode === null ? this.parent.getChild(this.index - 1) : null
            }

            get isAtStart() {
                return this.offset === 0
            }

            get isAtEnd() {
                return this.offset == this.parent.maxOffset
            }

            compareWith(t) {
                if (this.root != t.root) {
                    return "different"
                }
                const e = Vs(this.path, t.path);
                switch (e) {
                    case"same":
                        return "same";
                    case"prefix":
                        return "before";
                    case"extension":
                        return "after";
                    default:
                        return this.path[e] < t.path[e] ? "before" : "after"
                }
            }

            getLastMatchingPosition(t, e = {}) {
                e.startPosition = this;
                const i = new Wh(e);
                i.skip(t);
                return i.position
            }

            getParentPath() {
                return this.path.slice(0, -1)
            }

            getAncestors() {
                if (this.parent.is("documentFragment")) {
                    return [this.parent]
                } else {
                    return this.parent.getAncestors({includeSelf: true})
                }
            }

            getCommonPath(t) {
                if (this.root != t.root) {
                    return []
                }
                const e = Vs(this.path, t.path);
                const i = typeof e == "string" ? Math.min(this.path.length, t.path.length) : e;
                return this.path.slice(0, i)
            }

            getCommonAncestor(t) {
                const e = this.getAncestors();
                const i = t.getAncestors();
                let n = 0;
                while (e[n] == i[n] && e[n]) {
                    n++
                }
                return n === 0 ? null : e[n - 1]
            }

            getShiftedBy(t) {
                const e = this.clone();
                const i = e.offset + t;
                e.offset = i < 0 ? 0 : i;
                return e
            }

            isAfter(t) {
                return this.compareWith(t) == "after"
            }

            isBefore(t) {
                return this.compareWith(t) == "before"
            }

            isEqual(t) {
                return this.compareWith(t) == "same"
            }

            isTouching(t) {
                let e = null;
                let i = null;
                const n = this.compareWith(t);
                switch (n) {
                    case"same":
                        return true;
                    case"before":
                        e = Uh._createAt(this);
                        i = Uh._createAt(t);
                        break;
                    case"after":
                        e = Uh._createAt(t);
                        i = Uh._createAt(this);
                        break;
                    default:
                        return false
                }
                let o = e.parent;
                while (e.path.length + i.path.length) {
                    if (e.isEqual(i)) {
                        return true
                    }
                    if (e.path.length > i.path.length) {
                        if (e.offset !== o.maxOffset) {
                            return false
                        }
                        e.path = e.path.slice(0, -1);
                        o = o.parent;
                        e.offset++
                    } else {
                        if (i.offset !== 0) {
                            return false
                        }
                        i.path = i.path.slice(0, -1)
                    }
                }
            }

            is(t) {
                return t == "position" || t == "model:position"
            }

            hasSameParentAs(t) {
                if (this.root !== t.root) {
                    return false
                }
                const e = this.getParentPath();
                const i = t.getParentPath();
                return Vs(e, i) == "same"
            }

            getTransformedByOperation(t) {
                let e;
                switch (t.type) {
                    case"insert":
                        e = this._getTransformedByInsertOperation(t);
                        break;
                    case"move":
                    case"remove":
                    case"reinsert":
                        e = this._getTransformedByMoveOperation(t);
                        break;
                    case"split":
                        e = this._getTransformedBySplitOperation(t);
                        break;
                    case"merge":
                        e = this._getTransformedByMergeOperation(t);
                        break;
                    default:
                        e = Uh._createAt(this);
                        break
                }
                return e
            }

            _getTransformedByInsertOperation(t) {
                return this._getTransformedByInsertion(t.position, t.howMany)
            }

            _getTransformedByMoveOperation(t) {
                return this._getTransformedByMove(t.sourcePosition, t.targetPosition, t.howMany)
            }

            _getTransformedBySplitOperation(t) {
                const e = t.movedRange;
                const i = e.containsPosition(this) || e.start.isEqual(this) && this.stickiness == "toNext";
                if (i) {
                    return this._getCombined(t.splitPosition, t.moveTargetPosition)
                } else {
                    if (t.graveyardPosition) {
                        return this._getTransformedByMove(t.graveyardPosition, t.insertionPosition, 1)
                    } else {
                        return this._getTransformedByInsertion(t.insertionPosition, 1)
                    }
                }
            }

            _getTransformedByMergeOperation(t) {
                const e = t.movedRange;
                const i = e.containsPosition(this) || e.start.isEqual(this);
                let n;
                if (i) {
                    n = this._getCombined(t.sourcePosition, t.targetPosition);
                    if (t.sourcePosition.isBefore(t.targetPosition)) {
                        n = n._getTransformedByDeletion(t.deletionPosition, 1)
                    }
                } else if (this.isEqual(t.deletionPosition)) {
                    n = Uh._createAt(t.deletionPosition)
                } else {
                    n = this._getTransformedByMove(t.deletionPosition, t.graveyardPosition, 1)
                }
                return n
            }

            _getTransformedByDeletion(t, e) {
                const i = Uh._createAt(this);
                if (this.root != t.root) {
                    return i
                }
                if (Vs(t.getParentPath(), this.getParentPath()) == "same") {
                    if (t.offset < this.offset) {
                        if (t.offset + e > this.offset) {
                            return null
                        } else {
                            i.offset -= e
                        }
                    }
                } else if (Vs(t.getParentPath(), this.getParentPath()) == "prefix") {
                    const n = t.path.length - 1;
                    if (t.offset <= this.path[n]) {
                        if (t.offset + e > this.path[n]) {
                            return null
                        } else {
                            i.path[n] -= e
                        }
                    }
                }
                return i
            }

            _getTransformedByInsertion(t, e) {
                const i = Uh._createAt(this);
                if (this.root != t.root) {
                    return i
                }
                if (Vs(t.getParentPath(), this.getParentPath()) == "same") {
                    if (t.offset < this.offset || t.offset == this.offset && this.stickiness != "toPrevious") {
                        i.offset += e
                    }
                } else if (Vs(t.getParentPath(), this.getParentPath()) == "prefix") {
                    const n = t.path.length - 1;
                    if (t.offset <= this.path[n]) {
                        i.path[n] += e
                    }
                }
                return i
            }

            _getTransformedByMove(t, e, i) {
                e = e._getTransformedByDeletion(t, i);
                if (t.isEqual(e)) {
                    return Uh._createAt(this)
                }
                const n = this._getTransformedByDeletion(t, i);
                const o = n === null || t.isEqual(this) && this.stickiness == "toNext" || t.getShiftedBy(i).isEqual(this) && this.stickiness == "toPrevious";
                if (o) {
                    return this._getCombined(t, e)
                } else {
                    return n._getTransformedByInsertion(e, i)
                }
            }

            _getCombined(t, e) {
                const i = t.path.length - 1;
                const n = Uh._createAt(e);
                n.stickiness = this.stickiness;
                n.offset = n.offset + this.path[i] - t.offset;
                n.path = n.path.concat(this.path.slice(i + 1));
                return n
            }

            toJSON() {
                return {root: this.root.toJSON(), path: Array.from(this.path), stickiness: this.stickiness}
            }

            clone() {
                return new this.constructor(this.root, this.path, this.stickiness)
            }

            static _createAt(t, e, i = "toNone") {
                if (t instanceof Uh) {
                    return new Uh(t.root, t.path, t.stickiness)
                } else {
                    const n = t;
                    if (e == "end") {
                        e = n.maxOffset
                    } else if (e == "before") {
                        return this._createBefore(n, i)
                    } else if (e == "after") {
                        return this._createAfter(n, i)
                    } else if (e !== 0 && !e) {
                        throw new ss["b"]("model-createPositionAt-offset-required: " + "Model#createPositionAt() requires the offset when the first parameter is a model item.", [this, t])
                    }
                    if (!n.is("element") && !n.is("documentFragment")) {
                        throw new ss["b"]("model-position-parent-incorrect: Position parent have to be a element or document fragment.", [this, t])
                    }
                    const o = n.getPath();
                    o.push(e);
                    return new this(n.root, o, i)
                }
            }

            static _createAfter(t, e) {
                if (!t.parent) {
                    throw new ss["b"]("model-position-after-root: You cannot make a position after root.", [this, t], {root: t})
                }
                return this._createAt(t.parent, t.endOffset, e)
            }

            static _createBefore(t, e) {
                if (!t.parent) {
                    throw new ss["b"]("model-position-before-root: You cannot make a position before root.", t, {root: t})
                }
                return this._createAt(t.parent, t.startOffset, e)
            }

            static fromJSON(t, e) {
                if (t.root === "$graveyard") {
                    const i = new Uh(e.graveyard, t.path);
                    i.stickiness = t.stickiness;
                    return i
                }
                if (!e.getRoot(t.root)) {
                    throw new ss["b"]("model-position-fromjson-no-root: Cannot create position for document. Root with specified name does not exist.", e, {rootName: t.root})
                }
                return new Uh(e.getRoot(t.root), t.path, t.stickiness)
            }
        }

        class $h {
            constructor(t, e = null) {
                this.start = Uh._createAt(t);
                this.end = e ? Uh._createAt(e) : Uh._createAt(t);
                this.start.stickiness = this.isCollapsed ? "toNone" : "toNext";
                this.end.stickiness = this.isCollapsed ? "toNone" : "toPrevious"
            }

            * [Symbol.iterator]() {
                yield* new Wh({boundaries: this, ignoreElementEnd: true})
            }

            get isCollapsed() {
                return this.start.isEqual(this.end)
            }

            get isFlat() {
                const t = this.start.getParentPath();
                const e = this.end.getParentPath();
                return Vs(t, e) == "same"
            }

            get root() {
                return this.start.root
            }

            containsPosition(t) {
                return t.isAfter(this.start) && t.isBefore(this.end)
            }

            containsRange(t, e = false) {
                if (t.isCollapsed) {
                    e = false
                }
                const i = this.containsPosition(t.start) || e && this.start.isEqual(t.start);
                const n = this.containsPosition(t.end) || e && this.end.isEqual(t.end);
                return i && n
            }

            containsItem(t) {
                const e = Uh._createBefore(t);
                return this.containsPosition(e) || this.start.isEqual(e)
            }

            is(t) {
                return t == "range" || t == "model:range"
            }

            isEqual(t) {
                return this.start.isEqual(t.start) && this.end.isEqual(t.end)
            }

            isIntersecting(t) {
                return this.start.isBefore(t.end) && this.end.isAfter(t.start)
            }

            getDifference(t) {
                const e = [];
                if (this.isIntersecting(t)) {
                    if (this.containsPosition(t.start)) {
                        e.push(new $h(this.start, t.start))
                    }
                    if (this.containsPosition(t.end)) {
                        e.push(new $h(t.end, this.end))
                    }
                } else {
                    e.push(new $h(this.start, this.end))
                }
                return e
            }

            getIntersection(t) {
                if (this.isIntersecting(t)) {
                    let e = this.start;
                    let i = this.end;
                    if (this.containsPosition(t.start)) {
                        e = t.start
                    }
                    if (this.containsPosition(t.end)) {
                        i = t.end
                    }
                    return new $h(e, i)
                }
                return null
            }

            getMinimalFlatRanges() {
                const t = [];
                const e = this.start.getCommonPath(this.end).length;
                const i = Uh._createAt(this.start);
                let n = i.parent;
                while (i.path.length > e + 1) {
                    const e = n.maxOffset - i.offset;
                    if (e !== 0) {
                        t.push(new $h(i, i.getShiftedBy(e)))
                    }
                    i.path = i.path.slice(0, -1);
                    i.offset++;
                    n = n.parent
                }
                while (i.path.length <= this.end.path.length) {
                    const e = this.end.path[i.path.length - 1];
                    const n = e - i.offset;
                    if (n !== 0) {
                        t.push(new $h(i, i.getShiftedBy(n)))
                    }
                    i.offset = e;
                    i.path.push(0)
                }
                return t
            }

            getWalker(t = {}) {
                t.boundaries = this;
                return new Wh(t)
            }

            * getItems(t = {}) {
                t.boundaries = this;
                t.ignoreElementEnd = true;
                const e = new Wh(t);
                for (const t of e) {
                    yield t.item
                }
            }

            * getPositions(t = {}) {
                t.boundaries = this;
                const e = new Wh(t);
                yield e.position;
                for (const t of e) {
                    yield t.nextPosition
                }
            }

            getTransformedByOperation(t) {
                switch (t.type) {
                    case"insert":
                        return this._getTransformedByInsertOperation(t);
                    case"move":
                    case"remove":
                    case"reinsert":
                        return this._getTransformedByMoveOperation(t);
                    case"split":
                        return [this._getTransformedBySplitOperation(t)];
                    case"merge":
                        return [this._getTransformedByMergeOperation(t)]
                }
                return [new $h(this.start, this.end)]
            }

            getTransformedByOperations(t) {
                const e = [new $h(this.start, this.end)];
                for (const i of t) {
                    for (let t = 0; t < e.length; t++) {
                        const n = e[t].getTransformedByOperation(i);
                        e.splice(t, 1, ...n);
                        t += n.length - 1
                    }
                }
                for (let t = 0; t < e.length; t++) {
                    const i = e[t];
                    for (let n = t + 1; n < e.length; n++) {
                        const t = e[n];
                        if (i.containsRange(t) || t.containsRange(i) || i.isEqual(t)) {
                            e.splice(n, 1)
                        }
                    }
                }
                return e
            }

            getCommonAncestor() {
                return this.start.getCommonAncestor(this.end)
            }

            getContainedElement() {
                if (this.isCollapsed) {
                    return null
                }
                const t = this.start.nodeAfter;
                const e = this.end.nodeBefore;
                if (t && t.is("element") && t === e) {
                    return t
                }
                return null
            }

            toJSON() {
                return {start: this.start.toJSON(), end: this.end.toJSON()}
            }

            clone() {
                return new this.constructor(this.start, this.end)
            }

            _getTransformedByInsertOperation(t, e = false) {
                return this._getTransformedByInsertion(t.position, t.howMany, e)
            }

            _getTransformedByMoveOperation(t, e = false) {
                const i = t.sourcePosition;
                const n = t.howMany;
                const o = t.targetPosition;
                return this._getTransformedByMove(i, o, n, e)
            }

            _getTransformedBySplitOperation(t) {
                const e = this.start._getTransformedBySplitOperation(t);
                let i = this.end._getTransformedBySplitOperation(t);
                if (this.end.isEqual(t.insertionPosition)) {
                    i = this.end.getShiftedBy(1)
                }
                if (e.root != i.root) {
                    i = this.end.getShiftedBy(-1)
                }
                return new $h(e, i)
            }

            _getTransformedByMergeOperation(t) {
                if (this.start.isEqual(t.targetPosition) && this.end.isEqual(t.deletionPosition)) {
                    return new $h(this.start)
                }
                let e = this.start._getTransformedByMergeOperation(t);
                let i = this.end._getTransformedByMergeOperation(t);
                if (e.root != i.root) {
                    i = this.end.getShiftedBy(-1)
                }
                if (e.isAfter(i)) {
                    if (t.sourcePosition.isBefore(t.targetPosition)) {
                        e = Uh._createAt(i);
                        e.offset = 0
                    } else {
                        if (!t.deletionPosition.isEqual(e)) {
                            i = t.deletionPosition
                        }
                        e = t.targetPosition
                    }
                    return new $h(e, i)
                }
                return new $h(e, i)
            }

            _getTransformedByInsertion(t, e, i = false) {
                if (i && this.containsPosition(t)) {
                    return [new $h(this.start, t), new $h(t.getShiftedBy(e), this.end._getTransformedByInsertion(t, e))]
                } else {
                    const i = new $h(this.start, this.end);
                    i.start = i.start._getTransformedByInsertion(t, e);
                    i.end = i.end._getTransformedByInsertion(t, e);
                    return [i]
                }
            }

            _getTransformedByMove(t, e, i, n = false) {
                if (this.isCollapsed) {
                    const n = this.start._getTransformedByMove(t, e, i);
                    return [new $h(n)]
                }
                const o = $h._createFromPositionAndShift(t, i);
                const r = e._getTransformedByDeletion(t, i);
                if (this.containsPosition(e) && !n) {
                    if (o.containsPosition(this.start) || o.containsPosition(this.end)) {
                        const n = this.start._getTransformedByMove(t, e, i);
                        const o = this.end._getTransformedByMove(t, e, i);
                        return [new $h(n, o)]
                    }
                }
                let s;
                const a = this.getDifference(o);
                let c = null;
                const l = this.getIntersection(o);
                if (a.length == 1) {
                    c = new $h(a[0].start._getTransformedByDeletion(t, i), a[0].end._getTransformedByDeletion(t, i))
                } else if (a.length == 2) {
                    c = new $h(this.start, this.end._getTransformedByDeletion(t, i))
                }
                if (c) {
                    s = c._getTransformedByInsertion(r, i, l !== null || n)
                } else {
                    s = []
                }
                if (l) {
                    const t = new $h(l.start._getCombined(o.start, r), l.end._getCombined(o.start, r));
                    if (s.length == 2) {
                        s.splice(1, 0, t)
                    } else {
                        s.push(t)
                    }
                }
                return s
            }

            _getTransformedByDeletion(t, e) {
                let i = this.start._getTransformedByDeletion(t, e);
                let n = this.end._getTransformedByDeletion(t, e);
                if (i == null && n == null) {
                    return null
                }
                if (i == null) {
                    i = t
                }
                if (n == null) {
                    n = t
                }
                return new $h(i, n)
            }

            static _createFromPositionAndShift(t, e) {
                const i = t;
                const n = t.getShiftedBy(e);
                return e > 0 ? new this(i, n) : new this(n, i)
            }

            static _createIn(t) {
                return new this(Uh._createAt(t, 0), Uh._createAt(t, t.maxOffset))
            }

            static _createOn(t) {
                return this._createFromPositionAndShift(Uh._createBefore(t), t.offsetSize)
            }

            static _createFromRanges(t) {
                if (t.length === 0) {
                    throw new ss["b"]("range-create-from-ranges-empty-array: At least one range has to be passed.", null)
                } else if (t.length == 1) {
                    return t[0].clone()
                }
                const e = t[0];
                t.sort((t, e) => t.start.isAfter(e.start) ? 1 : -1);
                const i = t.indexOf(e);
                const n = new this(e.start, e.end);
                if (i > 0) {
                    for (let e = i - 1; true; e++) {
                        if (t[e].end.isEqual(n.start)) {
                            n.start = Uh._createAt(t[e].start)
                        } else {
                            break
                        }
                    }
                }
                for (let e = i + 1; e < t.length; e++) {
                    if (t[e].start.isEqual(n.end)) {
                        n.end = Uh._createAt(t[e].end)
                    } else {
                        break
                    }
                }
                return n
            }

            static fromJSON(t, e) {
                return new this(Uh.fromJSON(t.start, e), Uh.fromJSON(t.end, e))
            }
        }

        class Gh {
            constructor() {
                this._modelToViewMapping = new WeakMap;
                this._viewToModelMapping = new WeakMap;
                this._viewToModelLengthCallbacks = new Map;
                this._markerNameToElements = new Map;
                this._elementToMarkerNames = new Map;
                this._unboundMarkerNames = new Set;
                this.on("modelToViewPosition", (t, e) => {
                    if (e.viewPosition) {
                        return
                    }
                    const i = this._modelToViewMapping.get(e.modelPosition.parent);
                    e.viewPosition = this._findPositionIn(i, e.modelPosition.offset)
                }, {priority: "low"});
                this.on("viewToModelPosition", (t, e) => {
                    if (e.modelPosition) {
                        return
                    }
                    const i = this.findMappedViewAncestor(e.viewPosition);
                    const n = this._viewToModelMapping.get(i);
                    const o = this._toModelOffset(e.viewPosition.parent, e.viewPosition.offset, i);
                    e.modelPosition = Uh._createAt(n, o)
                }, {priority: "low"})
            }

            bindElements(t, e) {
                this._modelToViewMapping.set(t, e);
                this._viewToModelMapping.set(e, t)
            }

            unbindViewElement(t) {
                const e = this.toModelElement(t);
                this._viewToModelMapping.delete(t);
                if (this._elementToMarkerNames.has(t)) {
                    for (const e of this._elementToMarkerNames.get(t)) {
                        this._unboundMarkerNames.add(e)
                    }
                }
                if (this._modelToViewMapping.get(e) == t) {
                    this._modelToViewMapping.delete(e)
                }
            }

            unbindModelElement(t) {
                const e = this.toViewElement(t);
                this._modelToViewMapping.delete(t);
                if (this._viewToModelMapping.get(e) == t) {
                    this._viewToModelMapping.delete(e)
                }
            }

            bindElementToMarker(t, e) {
                const i = this._markerNameToElements.get(e) || new Set;
                i.add(t);
                const n = this._elementToMarkerNames.get(t) || new Set;
                n.add(e);
                this._markerNameToElements.set(e, i);
                this._elementToMarkerNames.set(t, n)
            }

            unbindElementFromMarkerName(t, e) {
                const i = this._markerNameToElements.get(e);
                if (i) {
                    i.delete(t);
                    if (i.size == 0) {
                        this._markerNameToElements.delete(e)
                    }
                }
                const n = this._elementToMarkerNames.get(t);
                if (n) {
                    n.delete(e);
                    if (n.size == 0) {
                        this._elementToMarkerNames.delete(t)
                    }
                }
            }

            flushUnboundMarkerNames() {
                const t = Array.from(this._unboundMarkerNames);
                this._unboundMarkerNames.clear();
                return t
            }

            clearBindings() {
                this._modelToViewMapping = new WeakMap;
                this._viewToModelMapping = new WeakMap;
                this._markerNameToElements = new Map;
                this._elementToMarkerNames = new Map;
                this._unboundMarkerNames = new Set
            }

            toModelElement(t) {
                return this._viewToModelMapping.get(t)
            }

            toViewElement(t) {
                return this._modelToViewMapping.get(t)
            }

            toModelRange(t) {
                return new $h(this.toModelPosition(t.start), this.toModelPosition(t.end))
            }

            toViewRange(t) {
                return new ul(this.toViewPosition(t.start), this.toViewPosition(t.end))
            }

            toModelPosition(t) {
                const e = {viewPosition: t, mapper: this};
                this.fire("viewToModelPosition", e);
                return e.modelPosition
            }

            toViewPosition(t, e = {isPhantom: false}) {
                const i = {modelPosition: t, mapper: this, isPhantom: e.isPhantom};
                this.fire("modelToViewPosition", i);
                return i.viewPosition
            }

            markerNameToElements(t) {
                const e = this._markerNameToElements.get(t);
                if (!e) {
                    return null
                }
                const i = new Set;
                for (const t of e) {
                    if (t.is("attributeElement")) {
                        for (const e of t.getElementsWithSameId()) {
                            i.add(e)
                        }
                    } else {
                        i.add(t)
                    }
                }
                return i
            }

            registerViewToModelLength(t, e) {
                this._viewToModelLengthCallbacks.set(t, e)
            }

            findMappedViewAncestor(t) {
                let e = t.parent;
                while (!this._viewToModelMapping.has(e)) {
                    e = e.parent
                }
                return e
            }

            _toModelOffset(t, e, i) {
                if (i != t) {
                    const n = this._toModelOffset(t.parent, t.index, i);
                    const o = this._toModelOffset(t, e, t);
                    return n + o
                }
                if (t.is("text")) {
                    return e
                }
                let n = 0;
                for (let i = 0; i < e; i++) {
                    n += this.getModelLength(t.getChild(i))
                }
                return n
            }

            getModelLength(t) {
                if (this._viewToModelLengthCallbacks.get(t.name)) {
                    const e = this._viewToModelLengthCallbacks.get(t.name);
                    return e(t)
                } else if (this._viewToModelMapping.has(t)) {
                    return 1
                } else if (t.is("text")) {
                    return t.data.length
                } else if (t.is("uiElement")) {
                    return 0
                } else {
                    let e = 0;
                    for (const i of t.getChildren()) {
                        e += this.getModelLength(i)
                    }
                    return e
                }
            }

            _findPositionIn(t, e) {
                let i;
                let n = 0;
                let o = 0;
                let r = 0;
                if (t.is("text")) {
                    return new dl(t, e)
                }
                while (o < e) {
                    i = t.getChild(r);
                    n = this.getModelLength(i);
                    o += n;
                    r++
                }
                if (o == e) {
                    return this._moveViewPositionToTextNode(new dl(t, r))
                } else {
                    return this._findPositionIn(i, e - (o - n))
                }
            }

            _moveViewPositionToTextNode(t) {
                const e = t.nodeBefore;
                const i = t.nodeAfter;
                if (e instanceof Ls) {
                    return new dl(e, e.data.length)
                } else if (i instanceof Ls) {
                    return new dl(i, 0)
                }
                return t
            }
        }

        vs(Gh, ds);

        class Kh {
            constructor() {
                this._consumable = new Map;
                this._textProxyRegistry = new Map
            }

            add(t, e) {
                e = Jh(e);
                if (t instanceof Fh) {
                    t = this._getSymbolForTextProxy(t)
                }
                if (!this._consumable.has(t)) {
                    this._consumable.set(t, new Map)
                }
                this._consumable.get(t).set(e, true)
            }

            consume(t, e) {
                e = Jh(e);
                if (t instanceof Fh) {
                    t = this._getSymbolForTextProxy(t)
                }
                if (this.test(t, e)) {
                    this._consumable.get(t).set(e, false);
                    return true
                } else {
                    return false
                }
            }

            test(t, e) {
                e = Jh(e);
                if (t instanceof Fh) {
                    t = this._getSymbolForTextProxy(t)
                }
                const i = this._consumable.get(t);
                if (i === undefined) {
                    return null
                }
                const n = i.get(e);
                if (n === undefined) {
                    return null
                }
                return n
            }

            revert(t, e) {
                e = Jh(e);
                if (t instanceof Fh) {
                    t = this._getSymbolForTextProxy(t)
                }
                const i = this.test(t, e);
                if (i === false) {
                    this._consumable.get(t).set(e, true);
                    return true
                } else if (i === true) {
                    return false
                }
                return null
            }

            _getSymbolForTextProxy(t) {
                let e = null;
                const i = this._textProxyRegistry.get(t.startOffset);
                if (i) {
                    const n = i.get(t.endOffset);
                    if (n) {
                        e = n.get(t.parent)
                    }
                }
                if (!e) {
                    e = this._addSymbolForTextProxy(t.startOffset, t.endOffset, t.parent)
                }
                return e
            }

            _addSymbolForTextProxy(t, e, i) {
                const n = Symbol("textProxySymbol");
                let o, r;
                o = this._textProxyRegistry.get(t);
                if (!o) {
                    o = new Map;
                    this._textProxyRegistry.set(t, o)
                }
                r = o.get(e);
                if (!r) {
                    r = new Map;
                    o.set(e, r)
                }
                r.set(i, n);
                return n
            }
        }

        function Jh(t) {
            const e = t.split(":");
            return e.length > 1 ? e[0] + ":" + e[1] : e[0]
        }

        class Yh {
            constructor(t) {
                this.conversionApi = qc({dispatcher: this}, t)
            }

            convertChanges(t, e, i) {
                for (const e of t.getMarkersToRemove()) {
                    this.convertMarkerRemove(e.name, e.range, i)
                }
                for (const e of t.getChanges()) {
                    if (e.type == "insert") {
                        this.convertInsert($h._createFromPositionAndShift(e.position, e.length), i)
                    } else if (e.type == "remove") {
                        this.convertRemove(e.position, e.length, e.name, i)
                    } else {
                        this.convertAttribute(e.range, e.attributeKey, e.attributeOldValue, e.attributeNewValue, i)
                    }
                }
                for (const t of this.conversionApi.mapper.flushUnboundMarkerNames()) {
                    const n = e.get(t).getRange();
                    this.convertMarkerRemove(t, n, i);
                    this.convertMarkerAdd(t, n, i)
                }
                for (const e of t.getMarkersToAdd()) {
                    this.convertMarkerAdd(e.name, e.range, i)
                }
            }

            convertInsert(t, e) {
                this.conversionApi.writer = e;
                this.conversionApi.consumable = this._createInsertConsumable(t);
                for (const e of t) {
                    const t = e.item;
                    const i = $h._createFromPositionAndShift(e.previousPosition, e.length);
                    const n = {item: t, range: i};
                    this._testAndFire("insert", n);
                    for (const e of t.getAttributeKeys()) {
                        n.attributeKey = e;
                        n.attributeOldValue = null;
                        n.attributeNewValue = t.getAttribute(e);
                        this._testAndFire(`attribute:${e}`, n)
                    }
                }
                this._clearConversionApi()
            }

            convertRemove(t, e, i, n) {
                this.conversionApi.writer = n;
                this.fire("remove:" + i, {position: t, length: e}, this.conversionApi);
                this._clearConversionApi()
            }

            convertAttribute(t, e, i, n, o) {
                this.conversionApi.writer = o;
                this.conversionApi.consumable = this._createConsumableForRange(t, `attribute:${e}`);
                for (const o of t) {
                    const t = o.item;
                    const r = $h._createFromPositionAndShift(o.previousPosition, o.length);
                    const s = {item: t, range: r, attributeKey: e, attributeOldValue: i, attributeNewValue: n};
                    this._testAndFire(`attribute:${e}`, s)
                }
                this._clearConversionApi()
            }

            convertSelection(t, e, i) {
                const n = Array.from(e.getMarkersAtPosition(t.getFirstPosition()));
                this.conversionApi.writer = i;
                this.conversionApi.consumable = this._createSelectionConsumable(t, n);
                this.fire("selection", {selection: t}, this.conversionApi);
                if (!t.isCollapsed) {
                    return
                }
                for (const e of n) {
                    const i = e.getRange();
                    if (!Qh(t.getFirstPosition(), e, this.conversionApi.mapper)) {
                        continue
                    }
                    const n = {item: t, markerName: e.name, markerRange: i};
                    if (this.conversionApi.consumable.test(t, "addMarker:" + e.name)) {
                        this.fire("addMarker:" + e.name, n, this.conversionApi)
                    }
                }
                for (const e of t.getAttributeKeys()) {
                    const i = {
                        item: t,
                        range: t.getFirstRange(),
                        attributeKey: e,
                        attributeOldValue: null,
                        attributeNewValue: t.getAttribute(e)
                    };
                    if (this.conversionApi.consumable.test(t, "attribute:" + i.attributeKey)) {
                        this.fire("attribute:" + i.attributeKey + ":$text", i, this.conversionApi)
                    }
                }
                this._clearConversionApi()
            }

            convertMarkerAdd(t, e, i) {
                if (!e.root.document || e.root.rootName == "$graveyard") {
                    return
                }
                this.conversionApi.writer = i;
                const n = "addMarker:" + t;
                const o = new Kh;
                o.add(e, n);
                this.conversionApi.consumable = o;
                this.fire(n, {markerName: t, markerRange: e}, this.conversionApi);
                if (!o.test(e, n)) {
                    return
                }
                this.conversionApi.consumable = this._createConsumableForRange(e, n);
                for (const i of e.getItems()) {
                    if (!this.conversionApi.consumable.test(i, n)) {
                        continue
                    }
                    const o = {item: i, range: $h._createOn(i), markerName: t, markerRange: e};
                    this.fire(n, o, this.conversionApi)
                }
                this._clearConversionApi()
            }

            convertMarkerRemove(t, e, i) {
                if (!e.root.document || e.root.rootName == "$graveyard") {
                    return
                }
                this.conversionApi.writer = i;
                this.fire("removeMarker:" + t, {markerName: t, markerRange: e}, this.conversionApi);
                this._clearConversionApi()
            }

            _createInsertConsumable(t) {
                const e = new Kh;
                for (const i of t) {
                    const t = i.item;
                    e.add(t, "insert");
                    for (const i of t.getAttributeKeys()) {
                        e.add(t, "attribute:" + i)
                    }
                }
                return e
            }

            _createConsumableForRange(t, e) {
                const i = new Kh;
                for (const n of t.getItems()) {
                    i.add(n, e)
                }
                return i
            }

            _createSelectionConsumable(t, e) {
                const i = new Kh;
                i.add(t, "selection");
                for (const n of e) {
                    i.add(t, "addMarker:" + n.name)
                }
                for (const e of t.getAttributeKeys()) {
                    i.add(t, "attribute:" + e)
                }
                return i
            }

            _testAndFire(t, e) {
                if (!this.conversionApi.consumable.test(e.item, t)) {
                    return
                }
                const i = e.item.name || "$text";
                this.fire(t + ":" + i, e, this.conversionApi)
            }

            _clearConversionApi() {
                delete this.conversionApi.writer;
                delete this.conversionApi.consumable
            }
        }

        vs(Yh, ds);

        function Qh(t, e, i) {
            const n = e.getRange();
            const o = Array.from(t.getAncestors());
            o.shift();
            o.reverse();
            const r = o.some(t => {
                if (n.containsItem(t)) {
                    const e = i.toViewElement(t);
                    return !!e.getCustomProperty("addHighlight")
                }
            });
            return !r
        }

        class Xh {
            constructor(t, e, i) {
                this._lastRangeBackward = false;
                this._ranges = [];
                this._attrs = new Map;
                if (t) {
                    this.setTo(t, e, i)
                }
            }

            get anchor() {
                if (this._ranges.length > 0) {
                    const t = this._ranges[this._ranges.length - 1];
                    return this._lastRangeBackward ? t.end : t.start
                }
                return null
            }

            get focus() {
                if (this._ranges.length > 0) {
                    const t = this._ranges[this._ranges.length - 1];
                    return this._lastRangeBackward ? t.start : t.end
                }
                return null
            }

            get isCollapsed() {
                const t = this._ranges.length;
                if (t === 1) {
                    return this._ranges[0].isCollapsed
                } else {
                    return false
                }
            }

            get rangeCount() {
                return this._ranges.length
            }

            get isBackward() {
                return !this.isCollapsed && this._lastRangeBackward
            }

            isEqual(t) {
                if (this.rangeCount != t.rangeCount) {
                    return false
                } else if (this.rangeCount === 0) {
                    return true
                }
                if (!this.anchor.isEqual(t.anchor) || !this.focus.isEqual(t.focus)) {
                    return false
                }
                for (const e of this._ranges) {
                    let i = false;
                    for (const n of t._ranges) {
                        if (e.isEqual(n)) {
                            i = true;
                            break
                        }
                    }
                    if (!i) {
                        return false
                    }
                }
                return true
            }

            * getRanges() {
                for (const t of this._ranges) {
                    yield new $h(t.start, t.end)
                }
            }

            getFirstRange() {
                let t = null;
                for (const e of this._ranges) {
                    if (!t || e.start.isBefore(t.start)) {
                        t = e
                    }
                }
                return t ? new $h(t.start, t.end) : null
            }

            getLastRange() {
                let t = null;
                for (const e of this._ranges) {
                    if (!t || e.end.isAfter(t.end)) {
                        t = e
                    }
                }
                return t ? new $h(t.start, t.end) : null
            }

            getFirstPosition() {
                const t = this.getFirstRange();
                return t ? t.start.clone() : null
            }

            getLastPosition() {
                const t = this.getLastRange();
                return t ? t.end.clone() : null
            }

            setTo(t, e, i) {
                if (t === null) {
                    this._setRanges([])
                } else if (t instanceof Xh) {
                    this._setRanges(t.getRanges(), t.isBackward)
                } else if (t && typeof t.getRanges == "function") {
                    this._setRanges(t.getRanges(), t.isBackward)
                } else if (t instanceof $h) {
                    this._setRanges([t], !!e && !!e.backward)
                } else if (t instanceof Uh) {
                    this._setRanges([new $h(t)])
                } else if (t instanceof zh) {
                    const n = !!i && !!i.backward;
                    let o;
                    if (e == "in") {
                        o = $h._createIn(t)
                    } else if (e == "on") {
                        o = $h._createOn(t)
                    } else if (e !== undefined) {
                        o = new $h(Uh._createAt(t, e))
                    } else {
                        throw new ss["b"]("model-selection-setTo-required-second-parameter: " + "selection.setTo requires the second parameter when the first parameter is a node.", [this, t])
                    }
                    this._setRanges([o], n)
                } else if (js(t)) {
                    this._setRanges(t, e && !!e.backward)
                } else {
                    throw new ss["b"]("model-selection-setTo-not-selectable: Cannot set the selection to the given place.", [this, t])
                }
            }

            _setRanges(t, e = false) {
                t = Array.from(t);
                const i = t.some(e => {
                    if (!(e instanceof $h)) {
                        throw new ss["b"]("model-selection-set-ranges-not-range: " + "Selection range set to an object that is not an instance of model.Range.", [this, t])
                    }
                    return this._ranges.every(t => !t.isEqual(e))
                });
                if (t.length === this._ranges.length && !i) {
                    return
                }
                this._removeAllRanges();
                for (const e of t) {
                    this._pushRange(e)
                }
                this._lastRangeBackward = !!e;
                this.fire("change:range", {directChange: true})
            }

            setFocus(t, e) {
                if (this.anchor === null) {
                    throw new ss["b"]("model-selection-setFocus-no-ranges: Cannot set selection focus if there are no ranges in selection.", [this, t])
                }
                const i = Uh._createAt(t, e);
                if (i.compareWith(this.focus) == "same") {
                    return
                }
                const n = this.anchor;
                if (this._ranges.length) {
                    this._popRange()
                }
                if (i.compareWith(n) == "before") {
                    this._pushRange(new $h(i, n));
                    this._lastRangeBackward = true
                } else {
                    this._pushRange(new $h(n, i));
                    this._lastRangeBackward = false
                }
                this.fire("change:range", {directChange: true})
            }

            getAttribute(t) {
                return this._attrs.get(t)
            }

            getAttributes() {
                return this._attrs.entries()
            }

            getAttributeKeys() {
                return this._attrs.keys()
            }

            hasAttribute(t) {
                return this._attrs.has(t)
            }

            removeAttribute(t) {
                if (this.hasAttribute(t)) {
                    this._attrs.delete(t);
                    this.fire("change:attribute", {attributeKeys: [t], directChange: true})
                }
            }

            setAttribute(t, e) {
                if (this.getAttribute(t) !== e) {
                    this._attrs.set(t, e);
                    this.fire("change:attribute", {attributeKeys: [t], directChange: true})
                }
            }

            getSelectedElement() {
                if (this.rangeCount !== 1) {
                    return null
                }
                return this.getFirstRange().getContainedElement()
            }

            is(t) {
                return t == "selection" || t == "model:selection"
            }

            * getSelectedBlocks() {
                const t = new WeakSet;
                for (const e of this.getRanges()) {
                    const i = ef(e.start, t);
                    if (i && nf(i, e)) {
                        yield i
                    }
                    for (const i of e.getWalker()) {
                        const n = i.item;
                        if (i.type == "elementEnd" && tf(n, t, e)) {
                            yield n
                        }
                    }
                    const n = ef(e.end, t);
                    if (n && !e.end.isTouching(Uh._createAt(n, 0)) && nf(n, e)) {
                        yield n
                    }
                }
            }

            containsEntireContent(t = this.anchor.root) {
                const e = Uh._createAt(t, 0);
                const i = Uh._createAt(t, "end");
                return e.isTouching(this.getFirstPosition()) && i.isTouching(this.getLastPosition())
            }

            _pushRange(t) {
                this._checkRange(t);
                this._ranges.push(new $h(t.start, t.end))
            }

            _checkRange(t) {
                for (let e = 0; e < this._ranges.length; e++) {
                    if (t.isIntersecting(this._ranges[e])) {
                        throw new ss["b"]("model-selection-range-intersects: Trying to add a range that intersects with another range in the selection.", [this, t], {
                            addedRange: t,
                            intersectingRange: this._ranges[e]
                        })
                    }
                }
            }

            _removeAllRanges() {
                while (this._ranges.length > 0) {
                    this._popRange()
                }
            }

            _popRange() {
                this._ranges.pop()
            }
        }

        vs(Xh, ds);

        function Zh(t, e) {
            if (e.has(t)) {
                return false
            }
            e.add(t);
            return t.root.document.model.schema.isBlock(t) && t.parent
        }

        function tf(t, e, i) {
            return Zh(t, e) && nf(t, i)
        }

        function ef(t, e) {
            const i = t.parent;
            const n = i.root.document.model.schema;
            const o = t.parent.getAncestors({parentFirst: true, includeSelf: true});
            let r = false;
            const s = o.find(t => {
                if (r) {
                    return false
                }
                r = n.isLimit(t);
                return !r && Zh(t, e)
            });
            o.forEach(t => e.add(t));
            return s
        }

        function nf(t, e) {
            const i = of(t);
            if (!i) {
                return true
            }
            const n = e.containsRange($h._createOn(i), true);
            return !n
        }

        function of(t) {
            const e = t.root.document.model.schema;
            let i = t.parent;
            while (i) {
                if (e.isBlock(i)) {
                    return i
                }
                i = i.parent
            }
        }

        class rf extends $h {
            constructor(t, e) {
                super(t, e);
                sf.call(this)
            }

            detach() {
                this.stopListening()
            }

            is(t) {
                return t == "liveRange" || t == "model:liveRange" || super.is(t)
            }

            toRange() {
                return new $h(this.start, this.end)
            }

            static fromRange(t) {
                return new rf(t.start, t.end)
            }
        }

        function sf() {
            this.listenTo(this.root.document.model, "applyOperation", (t, e) => {
                const i = e[0];
                if (!i.isDocumentOperation) {
                    return
                }
                af.call(this, i)
            }, {priority: "low"})
        }

        function af(t) {
            const e = this.getTransformedByOperation(t);
            const i = $h._createFromRanges(e);
            const n = !i.isEqual(this);
            const o = cf(this, t);
            let r = null;
            if (n) {
                if (i.root.rootName == "$graveyard") {
                    if (t.type == "remove") {
                        r = t.sourcePosition
                    } else {
                        r = t.deletionPosition
                    }
                }
                const e = this.toRange();
                this.start = i.start;
                this.end = i.end;
                this.fire("change:range", e, {deletionPosition: r})
            } else if (o) {
                this.fire("change:content", this.toRange(), {deletionPosition: r})
            }
        }

        function cf(t, e) {
            switch (e.type) {
                case"insert":
                    return t.containsPosition(e.position);
                case"move":
                case"remove":
                case"reinsert":
                case"merge":
                    return t.containsPosition(e.sourcePosition) || t.start.isEqual(e.sourcePosition) || t.containsPosition(e.targetPosition);
                case"split":
                    return t.containsPosition(e.splitPosition) || t.containsPosition(e.insertionPosition)
            }
            return false
        }

        vs(rf, ds);
        const lf = "selection:";

        class df {
            constructor(t) {
                this._selection = new uf(t);
                this._selection.delegate("change:range").to(this);
                this._selection.delegate("change:attribute").to(this);
                this._selection.delegate("change:marker").to(this)
            }

            get isCollapsed() {
                return this._selection.isCollapsed
            }

            get anchor() {
                return this._selection.anchor
            }

            get focus() {
                return this._selection.focus
            }

            get rangeCount() {
                return this._selection.rangeCount
            }

            get hasOwnRange() {
                return this._selection.hasOwnRange
            }

            get isBackward() {
                return this._selection.isBackward
            }

            get isGravityOverridden() {
                return this._selection.isGravityOverridden
            }

            get markers() {
                return this._selection.markers
            }

            get _ranges() {
                return this._selection._ranges
            }

            getRanges() {
                return this._selection.getRanges()
            }

            getFirstPosition() {
                return this._selection.getFirstPosition()
            }

            getLastPosition() {
                return this._selection.getLastPosition()
            }

            getFirstRange() {
                return this._selection.getFirstRange()
            }

            getLastRange() {
                return this._selection.getLastRange()
            }

            getSelectedBlocks() {
                return this._selection.getSelectedBlocks()
            }

            getSelectedElement() {
                return this._selection.getSelectedElement()
            }

            containsEntireContent(t) {
                return this._selection.containsEntireContent(t)
            }

            destroy() {
                this._selection.destroy()
            }

            getAttributeKeys() {
                return this._selection.getAttributeKeys()
            }

            getAttributes() {
                return this._selection.getAttributes()
            }

            getAttribute(t) {
                return this._selection.getAttribute(t)
            }

            hasAttribute(t) {
                return this._selection.hasAttribute(t)
            }

            refresh() {
                this._selection._updateMarkers();
                this._selection._updateAttributes(false)
            }

            is(t) {
                return t == "selection" || t == "model:selection" || t == "documentSelection" || t == "model:documentSelection"
            }

            _setFocus(t, e) {
                this._selection.setFocus(t, e)
            }

            _setTo(t, e, i) {
                this._selection.setTo(t, e, i)
            }

            _setAttribute(t, e) {
                this._selection.setAttribute(t, e)
            }

            _removeAttribute(t) {
                this._selection.removeAttribute(t)
            }

            _getStoredAttributes() {
                return this._selection._getStoredAttributes()
            }

            _overrideGravity() {
                return this._selection.overrideGravity()
            }

            _restoreGravity(t) {
                this._selection.restoreGravity(t)
            }

            static _getStoreAttributeKey(t) {
                return lf + t
            }

            static _isStoreAttributeKey(t) {
                return t.startsWith(lf)
            }
        }

        vs(df, ds);

        class uf extends Xh {
            constructor(t) {
                super();
                this.markers = new ys({idProperty: "name"});
                this._model = t.model;
                this._document = t;
                this._attributePriority = new Map;
                this._fixGraveyardRangesData = [];
                this._hasChangedRange = false;
                this._overriddenGravityRegister = new Set;
                this.listenTo(this._model, "applyOperation", (t, e) => {
                    const i = e[0];
                    if (!i.isDocumentOperation || i.type == "marker" || i.type == "rename" || i.type == "noop") {
                        return
                    }
                    while (this._fixGraveyardRangesData.length) {
                        const {liveRange: t, sourcePosition: e} = this._fixGraveyardRangesData.shift();
                        this._fixGraveyardSelection(t, e)
                    }
                    if (this._hasChangedRange) {
                        this._hasChangedRange = false;
                        this.fire("change:range", {directChange: false})
                    }
                }, {priority: "lowest"});
                this.on("change:range", () => {
                    for (const t of this.getRanges()) {
                        if (!this._document._validateSelectionRange(t)) {
                            throw new ss["b"]("document-selection-wrong-position: Range from document selection starts or ends at incorrect position.", this, {range: t})
                        }
                    }
                });
                this.listenTo(this._model.markers, "update", () => this._updateMarkers());
                this.listenTo(this._document, "change", (t, e) => {
                    ff(this._model, e)
                })
            }

            get isCollapsed() {
                const t = this._ranges.length;
                return t === 0 ? this._document._getDefaultRange().isCollapsed : super.isCollapsed
            }

            get anchor() {
                return super.anchor || this._document._getDefaultRange().start
            }

            get focus() {
                return super.focus || this._document._getDefaultRange().end
            }

            get rangeCount() {
                return this._ranges.length ? this._ranges.length : 1
            }

            get hasOwnRange() {
                return this._ranges.length > 0
            }

            get isGravityOverridden() {
                return !!this._overriddenGravityRegister.size
            }

            destroy() {
                for (let t = 0; t < this._ranges.length; t++) {
                    this._ranges[t].detach()
                }
                this.stopListening()
            }

            * getRanges() {
                if (this._ranges.length) {
                    yield* super.getRanges()
                } else {
                    yield this._document._getDefaultRange()
                }
            }

            getFirstRange() {
                return super.getFirstRange() || this._document._getDefaultRange()
            }

            getLastRange() {
                return super.getLastRange() || this._document._getDefaultRange()
            }

            setTo(t, e, i) {
                super.setTo(t, e, i);
                this._updateAttributes(true);
                this._updateMarkers()
            }

            setFocus(t, e) {
                super.setFocus(t, e);
                this._updateAttributes(true);
                this._updateMarkers()
            }

            setAttribute(t, e) {
                if (this._setAttribute(t, e)) {
                    const e = [t];
                    this.fire("change:attribute", {attributeKeys: e, directChange: true})
                }
            }

            removeAttribute(t) {
                if (this._removeAttribute(t)) {
                    const e = [t];
                    this.fire("change:attribute", {attributeKeys: e, directChange: true})
                }
            }

            overrideGravity() {
                const t = is();
                this._overriddenGravityRegister.add(t);
                if (this._overriddenGravityRegister.size === 1) {
                    this._updateAttributes(true)
                }
                return t
            }

            restoreGravity(t) {
                if (!this._overriddenGravityRegister.has(t)) {
                    throw new ss["b"]("document-selection-gravity-wrong-restore: Attempting to restore the selection gravity for an unknown UID.", this, {uid: t})
                }
                this._overriddenGravityRegister.delete(t);
                if (!this.isGravityOverridden) {
                    this._updateAttributes(true)
                }
            }

            _popRange() {
                this._ranges.pop().detach()
            }

            _pushRange(t) {
                const e = this._prepareRange(t);
                if (e) {
                    this._ranges.push(e)
                }
            }

            _prepareRange(t) {
                this._checkRange(t);
                if (t.root == this._document.graveyard) {
                    return
                }
                const e = rf.fromRange(t);
                e.on("change:range", (t, i, n) => {
                    this._hasChangedRange = true;
                    if (e.root == this._document.graveyard) {
                        this._fixGraveyardRangesData.push({liveRange: e, sourcePosition: n.deletionPosition})
                    }
                });
                return e
            }

            _updateMarkers() {
                const t = [];
                let e = false;
                for (const e of this._model.markers) {
                    const i = e.getRange();
                    for (const n of this.getRanges()) {
                        if (i.containsRange(n, !n.isCollapsed)) {
                            t.push(e)
                        }
                    }
                }
                const i = Array.from(this.markers);
                for (const i of t) {
                    if (!this.markers.has(i)) {
                        this.markers.add(i);
                        e = true
                    }
                }
                for (const i of Array.from(this.markers)) {
                    if (!t.includes(i)) {
                        this.markers.remove(i);
                        e = true
                    }
                }
                if (e) {
                    this.fire("change:marker", {oldMarkers: i, directChange: false})
                }
            }

            _updateAttributes(t) {
                const e = Hs(this._getSurroundingAttributes());
                const i = Hs(this.getAttributes());
                if (t) {
                    this._attributePriority = new Map;
                    this._attrs = new Map
                } else {
                    for (const [t, e] of this._attributePriority) {
                        if (e == "low") {
                            this._attrs.delete(t);
                            this._attributePriority.delete(t)
                        }
                    }
                }
                this._setAttributesTo(e);
                const n = [];
                for (const [t, e] of this.getAttributes()) {
                    if (!i.has(t) || i.get(t) !== e) {
                        n.push(t)
                    }
                }
                for (const [t] of i) {
                    if (!this.hasAttribute(t)) {
                        n.push(t)
                    }
                }
                if (n.length > 0) {
                    this.fire("change:attribute", {attributeKeys: n, directChange: false})
                }
            }

            _setAttribute(t, e, i = true) {
                const n = i ? "normal" : "low";
                if (n == "low" && this._attributePriority.get(t) == "normal") {
                    return false
                }
                const o = super.getAttribute(t);
                if (o === e) {
                    return false
                }
                this._attrs.set(t, e);
                this._attributePriority.set(t, n);
                return true
            }

            _removeAttribute(t, e = true) {
                const i = e ? "normal" : "low";
                if (i == "low" && this._attributePriority.get(t) == "normal") {
                    return false
                }
                this._attributePriority.set(t, i);
                if (!super.hasAttribute(t)) {
                    return false
                }
                this._attrs.delete(t);
                return true
            }

            _setAttributesTo(t) {
                const e = new Set;
                for (const [e, i] of this.getAttributes()) {
                    if (t.get(e) === i) {
                        continue
                    }
                    this._removeAttribute(e, false)
                }
                for (const [i, n] of t) {
                    const t = this._setAttribute(i, n, false);
                    if (t) {
                        e.add(i)
                    }
                }
                return e
            }

            * _getStoredAttributes() {
                const t = this.getFirstPosition().parent;
                if (this.isCollapsed && t.isEmpty) {
                    for (const e of t.getAttributeKeys()) {
                        if (e.startsWith(lf)) {
                            const i = e.substr(lf.length);
                            yield[i, t.getAttribute(e)]
                        }
                    }
                }
            }

            _getSurroundingAttributes() {
                const t = this.getFirstPosition();
                const e = this._model.schema;
                let i = null;
                if (!this.isCollapsed) {
                    const t = this.getFirstRange();
                    for (const n of t) {
                        if (n.item.is("element") && e.isObject(n.item)) {
                            break
                        }
                        if (n.type == "text") {
                            i = n.item.getAttributes();
                            break
                        }
                    }
                } else {
                    const e = t.textNode ? t.textNode : t.nodeBefore;
                    const n = t.textNode ? t.textNode : t.nodeAfter;
                    if (!this.isGravityOverridden) {
                        i = hf(e)
                    }
                    if (!i) {
                        i = hf(n)
                    }
                    if (!this.isGravityOverridden && !i) {
                        let t = e;
                        while (t && !i) {
                            t = t.previousSibling;
                            i = hf(t)
                        }
                    }
                    if (!i) {
                        let t = n;
                        while (t && !i) {
                            t = t.nextSibling;
                            i = hf(t)
                        }
                    }
                    if (!i) {
                        i = this._getStoredAttributes()
                    }
                }
                return i
            }

            _fixGraveyardSelection(t, e) {
                const i = e.clone();
                const n = this._model.schema.getNearestSelectionRange(i);
                const o = this._ranges.indexOf(t);
                this._ranges.splice(o, 1);
                t.detach();
                if (n) {
                    const t = this._prepareRange(n);
                    this._ranges.splice(o, 0, t)
                }
            }
        }

        function hf(t) {
            if (t instanceof Fh || t instanceof Lh) {
                return t.getAttributes()
            }
            return null
        }

        function ff(t, e) {
            const i = t.document.differ;
            for (const n of i.getChanges()) {
                if (n.type != "insert") {
                    continue
                }
                const i = n.position.parent;
                const o = n.length === i.maxOffset;
                if (o) {
                    t.enqueueChange(e, t => {
                        const e = Array.from(i.getAttributeKeys()).filter(t => t.startsWith(lf));
                        for (const n of e) {
                            t.removeAttribute(n, i)
                        }
                    })
                }
            }
        }

        class gf {
            constructor(t) {
                this._dispatchers = t
            }

            add(t) {
                for (const e of this._dispatchers) {
                    t(e)
                }
                return this
            }
        }

        var mf = 1, pf = 4;

        function bf(t) {
            return Hr(t, mf | pf)
        }

        var wf = bf;

        class kf extends gf {
            elementToElement(t) {
                return this.add(Nf(t))
            }

            attributeToElement(t) {
                return this.add(Mf(t))
            }

            attributeToAttribute(t) {
                return this.add(Bf(t))
            }

            markerToElement(t) {
                return this.add(zf(t))
            }

            markerToHighlight(t) {
                return this.add(Lf(t))
            }
        }

        function _f() {
            return (t, e, i) => {
                if (!i.consumable.consume(e.item, "insert")) {
                    return
                }
                const n = i.writer;
                const o = i.mapper.toViewPosition(e.range.start);
                const r = n.createText(e.item.data);
                n.insert(o, r)
            }
        }

        function vf() {
            return (t, e, i) => {
                const n = i.mapper.toViewPosition(e.position);
                const o = e.position.getShiftedBy(e.length);
                const r = i.mapper.toViewPosition(o, {isPhantom: true});
                const s = i.writer.createRange(n, r);
                const a = i.writer.remove(s.getTrimmed());
                for (const t of i.writer.createRangeIn(a).getItems()) {
                    i.mapper.unbindViewElement(t)
                }
            }
        }

        function yf(t, e) {
            const i = t.createAttributeElement("span", e.attributes);
            if (e.classes) {
                i._addClass(e.classes)
            }
            if (e.priority) {
                i._priority = e.priority
            }
            i._id = e.id;
            return i
        }

        function xf() {
            return (t, e, i) => {
                const n = e.selection;
                if (n.isCollapsed) {
                    return
                }
                if (!i.consumable.consume(n, "selection")) {
                    return
                }
                const o = [];
                for (const t of n.getRanges()) {
                    const e = i.mapper.toViewRange(t);
                    o.push(e)
                }
                i.writer.setSelection(o, {backward: n.isBackward})
            }
        }

        function Cf() {
            return (t, e, i) => {
                const n = e.selection;
                if (!n.isCollapsed) {
                    return
                }
                if (!i.consumable.consume(n, "selection")) {
                    return
                }
                const o = i.writer;
                const r = n.getFirstPosition();
                const s = i.mapper.toViewPosition(r);
                const a = o.breakAttributes(s);
                o.setSelection(a)
            }
        }

        function Af() {
            return (t, e, i) => {
                const n = i.writer;
                const o = n.document.selection;
                for (const t of o.getRanges()) {
                    if (t.isCollapsed) {
                        if (t.end.parent.isAttached()) {
                            i.writer.mergeAttributes(t.start)
                        }
                    }
                }
                n.setSelection(null)
            }
        }

        function Tf(t) {
            return (e, i, n) => {
                const o = t(i.attributeOldValue, n.writer);
                const r = t(i.attributeNewValue, n.writer);
                if (!o && !r) {
                    return
                }
                if (!n.consumable.consume(i.item, e.name)) {
                    return
                }
                const s = n.writer;
                const a = s.document.selection;
                if (i.item instanceof Xh || i.item instanceof df) {
                    s.wrap(a.getFirstRange(), r)
                } else {
                    let t = n.mapper.toViewRange(i.range);
                    if (i.attributeOldValue !== null && o) {
                        t = s.unwrap(t, o)
                    }
                    if (i.attributeNewValue !== null && r) {
                        s.wrap(t, r)
                    }
                }
            }
        }

        function Pf(t) {
            return (e, i, n) => {
                const o = t(i.item, n.writer);
                if (!o) {
                    return
                }
                if (!n.consumable.consume(i.item, "insert")) {
                    return
                }
                const r = n.mapper.toViewPosition(i.range.start);
                n.mapper.bindElements(i.item, o);
                n.writer.insert(r, o)
            }
        }

        function Sf(t) {
            return (e, i, n) => {
                i.isOpening = true;
                const o = t(i, n.writer);
                i.isOpening = false;
                const r = t(i, n.writer);
                if (!o || !r) {
                    return
                }
                const s = i.markerRange;
                if (s.isCollapsed && !n.consumable.consume(s, e.name)) {
                    return
                }
                for (const t of s) {
                    if (!n.consumable.consume(t.item, e.name)) {
                        return
                    }
                }
                const a = n.mapper;
                const c = n.writer;
                c.insert(a.toViewPosition(s.start), o);
                n.mapper.bindElementToMarker(o, i.markerName);
                if (!s.isCollapsed) {
                    c.insert(a.toViewPosition(s.end), r);
                    n.mapper.bindElementToMarker(r, i.markerName)
                }
                e.stop()
            }
        }

        function Ef() {
            return (t, e, i) => {
                const n = i.mapper.markerNameToElements(e.markerName);
                if (!n) {
                    return
                }
                for (const t of n) {
                    i.mapper.unbindElementFromMarkerName(t, e.markerName);
                    i.writer.clear(i.writer.createRangeOn(t), t)
                }
                i.writer.clearClonedElementsGroup(e.markerName);
                t.stop()
            }
        }

        function Rf(t) {
            return (e, i, n) => {
                const o = t(i.attributeOldValue, i);
                const r = t(i.attributeNewValue, i);
                if (!o && !r) {
                    return
                }
                if (!n.consumable.consume(i.item, e.name)) {
                    return
                }
                const s = n.mapper.toViewElement(i.item);
                const a = n.writer;
                if (!s) {
                    throw new ss["b"]("conversion-attribute-to-attribute-on-text: " + "Trying to convert text node's attribute with attribute-to-attribute converter.", [i, n])
                }
                if (i.attributeOldValue !== null && o) {
                    if (o.key == "class") {
                        const t = Array.isArray(o.value) ? o.value : [o.value];
                        for (const e of t) {
                            a.removeClass(e, s)
                        }
                    } else if (o.key == "style") {
                        const t = Object.keys(o.value);
                        for (const e of t) {
                            a.removeStyle(e, s)
                        }
                    } else {
                        a.removeAttribute(o.key, s)
                    }
                }
                if (i.attributeNewValue !== null && r) {
                    if (r.key == "class") {
                        const t = Array.isArray(r.value) ? r.value : [r.value];
                        for (const e of t) {
                            a.addClass(e, s)
                        }
                    } else if (r.key == "style") {
                        const t = Object.keys(r.value);
                        for (const e of t) {
                            a.setStyle(e, r.value[e], s)
                        }
                    } else {
                        a.setAttribute(r.key, r.value, s)
                    }
                }
            }
        }

        function Of(t) {
            return (e, i, n) => {
                if (!i.item) {
                    return
                }
                if (!(i.item instanceof Xh || i.item instanceof df) && !i.item.is("textProxy")) {
                    return
                }
                const o = Wf(t, i, n);
                if (!o) {
                    return
                }
                if (!n.consumable.consume(i.item, e.name)) {
                    return
                }
                const r = n.writer;
                const s = yf(r, o);
                const a = r.document.selection;
                if (i.item instanceof Xh || i.item instanceof df) {
                    r.wrap(a.getFirstRange(), s, a)
                } else {
                    const t = n.mapper.toViewRange(i.range);
                    const e = r.wrap(t, s);
                    for (const t of e.getItems()) {
                        if (t.is("attributeElement") && t.isSimilar(s)) {
                            n.mapper.bindElementToMarker(t, i.markerName);
                            break
                        }
                    }
                }
            }
        }

        function If(t) {
            return (e, i, n) => {
                if (!i.item) {
                    return
                }
                if (!(i.item instanceof jh)) {
                    return
                }
                const o = Wf(t, i, n);
                if (!o) {
                    return
                }
                if (!n.consumable.test(i.item, e.name)) {
                    return
                }
                const r = n.mapper.toViewElement(i.item);
                if (r && r.getCustomProperty("addHighlight")) {
                    n.consumable.consume(i.item, e.name);
                    for (const t of $h._createIn(i.item)) {
                        n.consumable.consume(t.item, e.name)
                    }
                    r.getCustomProperty("addHighlight")(r, o, n.writer);
                    n.mapper.bindElementToMarker(r, i.markerName)
                }
            }
        }

        function Vf(t) {
            return (e, i, n) => {
                if (i.markerRange.isCollapsed) {
                    return
                }
                const o = Wf(t, i, n);
                if (!o) {
                    return
                }
                const r = yf(n.writer, o);
                const s = n.mapper.markerNameToElements(i.markerName);
                if (!s) {
                    return
                }
                for (const t of s) {
                    n.mapper.unbindElementFromMarkerName(t, i.markerName);
                    if (t.is("attributeElement")) {
                        n.writer.unwrap(n.writer.createRangeOn(t), r)
                    } else {
                        t.getCustomProperty("removeHighlight")(t, o.id, n.writer)
                    }
                }
                n.writer.clearClonedElementsGroup(i.markerName);
                e.stop()
            }
        }

        function Nf(t) {
            t = wf(t);
            t.view = Ff(t.view, "container");
            return e => {
                e.on("insert:" + t.model, Pf(t.view), {priority: t.converterPriority || "normal"})
            }
        }

        function Mf(t) {
            t = wf(t);
            const e = t.model.key ? t.model.key : t.model;
            let i = "attribute:" + e;
            if (t.model.name) {
                i += ":" + t.model.name
            }
            if (t.model.values) {
                for (const e of t.model.values) {
                    t.view[e] = Ff(t.view[e], "attribute")
                }
            } else {
                t.view = Ff(t.view, "attribute")
            }
            const n = jf(t);
            return e => {
                e.on(i, Tf(n), {priority: t.converterPriority || "normal"})
            }
        }

        function Bf(t) {
            t = wf(t);
            const e = t.model.key ? t.model.key : t.model;
            let i = "attribute:" + e;
            if (t.model.name) {
                i += ":" + t.model.name
            }
            if (t.model.values) {
                for (const e of t.model.values) {
                    t.view[e] = Hf(t.view[e])
                }
            } else {
                t.view = Hf(t.view)
            }
            const n = jf(t);
            return e => {
                e.on(i, Rf(n), {priority: t.converterPriority || "normal"})
            }
        }

        function zf(t) {
            t = wf(t);
            t.view = Ff(t.view, "ui");
            return e => {
                e.on("addMarker:" + t.model, Sf(t.view), {priority: t.converterPriority || "normal"});
                e.on("removeMarker:" + t.model, Ef(t.view), {priority: t.converterPriority || "normal"})
            }
        }

        function Lf(t) {
            return e => {
                e.on("addMarker:" + t.model, Of(t.view), {priority: t.converterPriority || "normal"});
                e.on("addMarker:" + t.model, If(t.view), {priority: t.converterPriority || "normal"});
                e.on("removeMarker:" + t.model, Vf(t.view), {priority: t.converterPriority || "normal"})
            }
        }

        function Ff(t, e) {
            if (typeof t == "function") {
                return t
            }
            return (i, n) => Df(t, n, e)
        }

        function Df(t, e, i) {
            if (typeof t == "string") {
                t = {name: t}
            }
            let n;
            const o = Object.assign({}, t.attributes);
            if (i == "container") {
                n = e.createContainerElement(t.name, o)
            } else if (i == "attribute") {
                const i = {priority: t.priority || wl.DEFAULT_PRIORITY};
                n = e.createAttributeElement(t.name, o, i)
            } else {
                n = e.createUIElement(t.name, o)
            }
            if (t.styles) {
                const i = Object.keys(t.styles);
                for (const o of i) {
                    e.setStyle(o, t.styles[o], n)
                }
            }
            if (t.classes) {
                const i = t.classes;
                if (typeof i == "string") {
                    e.addClass(i, n)
                } else {
                    for (const t of i) {
                        e.addClass(t, n)
                    }
                }
            }
            return n
        }

        function jf(t) {
            if (t.model.values) {
                return (e, i) => {
                    const n = t.view[e];
                    if (n) {
                        return n(e, i)
                    }
                    return null
                }
            } else {
                return t.view
            }
        }

        function Hf(t) {
            if (typeof t == "string") {
                return e => ({key: t, value: e})
            } else if (typeof t == "object") {
                if (t.value) {
                    return () => t
                } else {
                    return e => ({key: t.key, value: e})
                }
            } else {
                return t
            }
        }

        function Wf(t, e, i) {
            const n = typeof t == "function" ? t(e, i) : t;
            if (!n) {
                return null
            }
            if (!n.priority) {
                n.priority = 10
            }
            if (!n.id) {
                n.id = e.markerName
            }
            return n
        }

        class qf extends gf {
            elementToElement(t) {
                return this.add(Kf(t))
            }

            elementToAttribute(t) {
                return this.add(Jf(t))
            }

            attributeToAttribute(t) {
                return this.add(Yf(t))
            }

            elementToMarker(t) {
                return this.add(Qf(t))
            }
        }

        function Uf() {
            return (t, e, i) => {
                if (!e.modelRange && i.consumable.consume(e.viewItem, {name: true})) {
                    const {modelRange: t, modelCursor: n} = i.convertChildren(e.viewItem, e.modelCursor);
                    e.modelRange = t;
                    e.modelCursor = n
                }
            }
        }

        function $f() {
            return (t, e, i) => {
                if (i.schema.checkChild(e.modelCursor, "$text")) {
                    if (i.consumable.consume(e.viewItem)) {
                        const t = i.writer.createText(e.viewItem.data);
                        i.writer.insert(t, e.modelCursor);
                        e.modelRange = $h._createFromPositionAndShift(e.modelCursor, t.offsetSize);
                        e.modelCursor = e.modelRange.end
                    }
                }
            }
        }

        function Gf(t, e) {
            return (i, n) => {
                const o = n.newSelection;
                const r = new Xh;
                const s = [];
                for (const t of o.getRanges()) {
                    s.push(e.toModelRange(t))
                }
                r.setTo(s, {backward: o.isBackward});
                if (!r.isEqual(t.document.selection)) {
                    t.change(t => {
                        t.setSelection(r)
                    })
                }
            }
        }

        function Kf(t) {
            t = wf(t);
            const e = Zf(t);
            const i = Xf(t.view);
            const n = i ? "element:" + i : "element";
            return i => {
                i.on(n, e, {priority: t.converterPriority || "normal"})
            }
        }

        function Jf(t) {
            t = wf(t);
            ig(t);
            const e = ng(t, false);
            const i = Xf(t.view);
            const n = i ? "element:" + i : "element";
            return i => {
                i.on(n, e, {priority: t.converterPriority || "low"})
            }
        }

        function Yf(t) {
            t = wf(t);
            let e = null;
            if (typeof t.view == "string" || t.view.key) {
                e = eg(t)
            }
            ig(t, e);
            const i = ng(t, true);
            return e => {
                e.on("element", i, {priority: t.converterPriority || "low"})
            }
        }

        function Qf(t) {
            t = wf(t);
            sg(t);
            return Kf(t)
        }

        function Xf(t) {
            if (typeof t == "string") {
                return t
            }
            if (typeof t == "object" && typeof t.name == "string") {
                return t.name
            }
            return null
        }

        function Zf(t) {
            const e = t.view ? new Ws(t.view) : null;
            return (i, n, o) => {
                let r = {};
                if (e) {
                    const t = e.match(n.viewItem);
                    if (!t) {
                        return
                    }
                    r = t.match
                }
                r.name = true;
                const s = tg(t.model, n.viewItem, o.writer);
                if (!s) {
                    return
                }
                if (!o.consumable.test(n.viewItem, r)) {
                    return
                }
                const a = o.splitToAllowedParent(s, n.modelCursor);
                if (!a) {
                    return
                }
                o.writer.insert(s, a.position);
                o.convertChildren(n.viewItem, o.writer.createPositionAt(s, 0));
                o.consumable.consume(n.viewItem, r);
                const c = o.getSplitParts(s);
                n.modelRange = new $h(o.writer.createPositionBefore(s), o.writer.createPositionAfter(c[c.length - 1]));
                if (a.cursorParent) {
                    n.modelCursor = o.writer.createPositionAt(a.cursorParent, 0)
                } else {
                    n.modelCursor = n.modelRange.end
                }
            }
        }

        function tg(t, e, i) {
            if (t instanceof Function) {
                return t(e, i)
            } else {
                return i.createElement(t)
            }
        }

        function eg(t) {
            if (typeof t.view == "string") {
                t.view = {key: t.view}
            }
            const e = t.view.key;
            let i;
            if (e == "class" || e == "style") {
                const n = e == "class" ? "classes" : "styles";
                i = {[n]: t.view.value}
            } else {
                const n = typeof t.view.value == "undefined" ? /[\s\S]*/ : t.view.value;
                i = {attributes: {[e]: n}}
            }
            if (t.view.name) {
                i.name = t.view.name
            }
            t.view = i;
            return e
        }

        function ig(t, e = null) {
            const i = e === null ? true : t => t.getAttribute(e);
            const n = typeof t.model != "object" ? t.model : t.model.key;
            const o = typeof t.model != "object" || typeof t.model.value == "undefined" ? i : t.model.value;
            t.model = {key: n, value: o}
        }

        function ng(t, e) {
            const i = new Ws(t.view);
            return (n, o, r) => {
                const s = i.match(o.viewItem);
                if (!s) {
                    return
                }
                const a = t.model.key;
                const c = typeof t.model.value == "function" ? t.model.value(o.viewItem) : t.model.value;
                if (c === null) {
                    return
                }
                if (og(t.view, o.viewItem)) {
                    s.match.name = true
                } else {
                    delete s.match.name
                }
                if (!r.consumable.test(o.viewItem, s.match)) {
                    return
                }
                if (!o.modelRange) {
                    o = Object.assign(o, r.convertChildren(o.viewItem, o.modelCursor))
                }
                const l = rg(o.modelRange, {key: a, value: c}, e, r);
                if (l) {
                    r.consumable.consume(o.viewItem, s.match)
                }
            }
        }

        function og(t, e) {
            const i = typeof t == "function" ? t(e) : t;
            if (typeof i == "object" && !Xf(i)) {
                return false
            }
            return !i.classes && !i.attributes && !i.styles
        }

        function rg(t, e, i, n) {
            let o = false;
            for (const r of Array.from(t.getItems({shallow: i}))) {
                if (n.schema.checkAttribute(r, e.key)) {
                    n.writer.setAttribute(e.key, e.value, r);
                    o = true
                }
            }
            return o
        }

        function sg(t) {
            const e = t.model;
            t.model = (t, i) => {
                const n = typeof e == "string" ? e : e(t);
                return i.createElement("$marker", {"data-name": n})
            }
        }

        class ag {
            constructor(t, e) {
                this.model = t;
                this.view = new Bh(e);
                this.mapper = new Gh;
                this.downcastDispatcher = new Yh({mapper: this.mapper});
                const i = this.model.document;
                const n = i.selection;
                const o = this.model.markers;
                this.listenTo(this.model, "_beforeChanges", () => {
                    this.view._disableRendering(true)
                }, {priority: "highest"});
                this.listenTo(this.model, "_afterChanges", () => {
                    this.view._disableRendering(false)
                }, {priority: "lowest"});
                this.listenTo(i, "change", () => {
                    this.view.change(t => {
                        this.downcastDispatcher.convertChanges(i.differ, o, t);
                        this.downcastDispatcher.convertSelection(n, o, t)
                    })
                }, {priority: "low"});
                this.listenTo(this.view.document, "selectionChange", Gf(this.model, this.mapper));
                this.downcastDispatcher.on("insert:$text", _f(), {priority: "lowest"});
                this.downcastDispatcher.on("remove", vf(), {priority: "low"});
                this.downcastDispatcher.on("selection", Af(), {priority: "low"});
                this.downcastDispatcher.on("selection", xf(), {priority: "low"});
                this.downcastDispatcher.on("selection", Cf(), {priority: "low"});
                this.view.document.roots.bindTo(this.model.document.roots).using(t => {
                    if (t.rootName == "$graveyard") {
                        return null
                    }
                    const e = new cl(this.view.document, t.name);
                    e.rootName = t.rootName;
                    this.mapper.bindElements(t, e);
                    return e
                })
            }

            destroy() {
                this.view.destroy();
                this.stopListening()
            }
        }

        vs(ag, Jc);

        class cg {
            constructor() {
                this._commands = new Map
            }

            add(t, e) {
                this._commands.set(t, e)
            }

            get(t) {
                return this._commands.get(t)
            }

            execute(t, ...e) {
                const i = this.get(t);
                if (!i) {
                    throw new ss["b"]("commandcollection-command-not-found: Command does not exist.", this, {commandName: t})
                }
                i.execute(...e)
            }

            * names() {
                yield* this._commands.keys()
            }

            * commands() {
                yield* this._commands.values()
            }

            [Symbol.iterator]() {
                return this._commands[Symbol.iterator]()
            }

            destroy() {
                for (const t of this.commands()) {
                    t.destroy()
                }
            }
        }

        class lg {
            constructor() {
                this._consumables = new Map
            }

            add(t, e) {
                let i;
                if (t.is("text") || t.is("documentFragment")) {
                    this._consumables.set(t, true);
                    return
                }
                if (!this._consumables.has(t)) {
                    i = new dg(t);
                    this._consumables.set(t, i)
                } else {
                    i = this._consumables.get(t)
                }
                i.add(e)
            }

            test(t, e) {
                const i = this._consumables.get(t);
                if (i === undefined) {
                    return null
                }
                if (t.is("text") || t.is("documentFragment")) {
                    return i
                }
                return i.test(e)
            }

            consume(t, e) {
                if (this.test(t, e)) {
                    if (t.is("text") || t.is("documentFragment")) {
                        this._consumables.set(t, false)
                    } else {
                        this._consumables.get(t).consume(e)
                    }
                    return true
                }
                return false
            }

            revert(t, e) {
                const i = this._consumables.get(t);
                if (i !== undefined) {
                    if (t.is("text") || t.is("documentFragment")) {
                        this._consumables.set(t, true)
                    } else {
                        i.revert(e)
                    }
                }
            }

            static consumablesFromElement(t) {
                const e = {element: t, name: true, attributes: [], classes: [], styles: []};
                const i = t.getAttributeKeys();
                for (const t of i) {
                    if (t == "style" || t == "class") {
                        continue
                    }
                    e.attributes.push(t)
                }
                const n = t.getClassNames();
                for (const t of n) {
                    e.classes.push(t)
                }
                const o = t.getStyleNames();
                for (const t of o) {
                    e.styles.push(t)
                }
                return e
            }

            static createFrom(t, e) {
                if (!e) {
                    e = new lg(t)
                }
                if (t.is("text")) {
                    e.add(t);
                    return e
                }
                if (t.is("element")) {
                    e.add(t, lg.consumablesFromElement(t))
                }
                if (t.is("documentFragment")) {
                    e.add(t)
                }
                for (const i of t.getChildren()) {
                    e = lg.createFrom(i, e)
                }
                return e
            }
        }

        class dg {
            constructor(t) {
                this.element = t;
                this._canConsumeName = null;
                this._consumables = {attributes: new Map, styles: new Map, classes: new Map}
            }

            add(t) {
                if (t.name) {
                    this._canConsumeName = true
                }
                for (const e in this._consumables) {
                    if (e in t) {
                        this._add(e, t[e])
                    }
                }
            }

            test(t) {
                if (t.name && !this._canConsumeName) {
                    return this._canConsumeName
                }
                for (const e in this._consumables) {
                    if (e in t) {
                        const i = this._test(e, t[e]);
                        if (i !== true) {
                            return i
                        }
                    }
                }
                return true
            }

            consume(t) {
                if (t.name) {
                    this._canConsumeName = false
                }
                for (const e in this._consumables) {
                    if (e in t) {
                        this._consume(e, t[e])
                    }
                }
            }

            revert(t) {
                if (t.name) {
                    this._canConsumeName = true
                }
                for (const e in this._consumables) {
                    if (e in t) {
                        this._revert(e, t[e])
                    }
                }
            }

            _add(t, e) {
                const i = Je(e) ? e : [e];
                const n = this._consumables[t];
                for (const e of i) {
                    if (t === "attributes" && (e === "class" || e === "style")) {
                        throw new ss["b"]("viewconsumable-invalid-attribute: Classes and styles should be handled separately.", this)
                    }
                    n.set(e, true);
                    if (t === "styles") {
                        for (const t of this.element.document.stylesProcessor.getRelatedStyles(e)) {
                            n.set(t, true)
                        }
                    }
                }
            }

            _test(t, e) {
                const i = Je(e) ? e : [e];
                const n = this._consumables[t];
                for (const e of i) {
                    if (t === "attributes" && (e === "class" || e === "style")) {
                        const t = e == "class" ? "classes" : "styles";
                        const i = this._test(t, [...this._consumables[t].keys()]);
                        if (i !== true) {
                            return i
                        }
                    } else {
                        const t = n.get(e);
                        if (t === undefined) {
                            return null
                        }
                        if (!t) {
                            return false
                        }
                    }
                }
                return true
            }

            _consume(t, e) {
                const i = Je(e) ? e : [e];
                const n = this._consumables[t];
                for (const e of i) {
                    if (t === "attributes" && (e === "class" || e === "style")) {
                        const t = e == "class" ? "classes" : "styles";
                        this._consume(t, [...this._consumables[t].keys()])
                    } else {
                        n.set(e, false);
                        if (t == "styles") {
                            for (const t of this.element.document.stylesProcessor.getRelatedStyles(e)) {
                                n.set(t, false)
                            }
                        }
                    }
                }
            }

            _revert(t, e) {
                const i = Je(e) ? e : [e];
                const n = this._consumables[t];
                for (const e of i) {
                    if (t === "attributes" && (e === "class" || e === "style")) {
                        const t = e == "class" ? "classes" : "styles";
                        this._revert(t, [...this._consumables[t].keys()])
                    } else {
                        const t = n.get(e);
                        if (t === false) {
                            n.set(e, true)
                        }
                    }
                }
            }
        }

        class ug {
            constructor() {
                this._sourceDefinitions = {};
                this._attributeProperties = {};
                this.decorate("checkChild");
                this.decorate("checkAttribute");
                this.on("checkAttribute", (t, e) => {
                    e[0] = new hg(e[0])
                }, {priority: "highest"});
                this.on("checkChild", (t, e) => {
                    e[0] = new hg(e[0]);
                    e[1] = this.getDefinition(e[1])
                }, {priority: "highest"})
            }

            register(t, e) {
                if (this._sourceDefinitions[t]) {
                    throw new ss["b"]("schema-cannot-register-item-twice: A single item cannot be registered twice in the schema.", this, {itemName: t})
                }
                this._sourceDefinitions[t] = [Object.assign({}, e)];
                this._clearCache()
            }

            extend(t, e) {
                if (!this._sourceDefinitions[t]) {
                    throw new ss["b"]("schema-cannot-extend-missing-item: Cannot extend an item which was not registered yet.", this, {itemName: t})
                }
                this._sourceDefinitions[t].push(Object.assign({}, e));
                this._clearCache()
            }

            getDefinitions() {
                if (!this._compiledDefinitions) {
                    this._compile()
                }
                return this._compiledDefinitions
            }

            getDefinition(t) {
                let e;
                if (typeof t == "string") {
                    e = t
                } else if (t.is && (t.is("text") || t.is("textProxy"))) {
                    e = "$text"
                } else {
                    e = t.name
                }
                return this.getDefinitions()[e]
            }

            isRegistered(t) {
                return !!this.getDefinition(t)
            }

            isBlock(t) {
                const e = this.getDefinition(t);
                return !!(e && e.isBlock)
            }

            isLimit(t) {
                const e = this.getDefinition(t);
                if (!e) {
                    return false
                }
                return !!(e.isLimit || e.isObject)
            }

            isObject(t) {
                const e = this.getDefinition(t);
                return !!(e && e.isObject)
            }

            isInline(t) {
                const e = this.getDefinition(t);
                return !!(e && e.isInline)
            }

            checkChild(t, e) {
                if (!e) {
                    return false
                }
                return this._checkContextMatch(e, t)
            }

            checkAttribute(t, e) {
                const i = this.getDefinition(t.last);
                if (!i) {
                    return false
                }
                return i.allowAttributes.includes(e)
            }

            checkMerge(t, e = null) {
                if (t instanceof Uh) {
                    const e = t.nodeBefore;
                    const i = t.nodeAfter;
                    if (!(e instanceof jh)) {
                        throw new ss["b"]("schema-check-merge-no-element-before: The node before the merge position must be an element.", this)
                    }
                    if (!(i instanceof jh)) {
                        throw new ss["b"]("schema-check-merge-no-element-after: The node after the merge position must be an element.", this)
                    }
                    return this.checkMerge(e, i)
                }
                for (const i of e.getChildren()) {
                    if (!this.checkChild(t, i)) {
                        return false
                    }
                }
                return true
            }

            addChildCheck(t) {
                this.on("checkChild", (e, [i, n]) => {
                    if (!n) {
                        return
                    }
                    const o = t(i, n);
                    if (typeof o == "boolean") {
                        e.stop();
                        e.return = o
                    }
                }, {priority: "high"})
            }

            addAttributeCheck(t) {
                this.on("checkAttribute", (e, [i, n]) => {
                    const o = t(i, n);
                    if (typeof o == "boolean") {
                        e.stop();
                        e.return = o
                    }
                }, {priority: "high"})
            }

            setAttributeProperties(t, e) {
                this._attributeProperties[t] = Object.assign(this.getAttributeProperties(t), e)
            }

            getAttributeProperties(t) {
                return this._attributeProperties[t] || {}
            }

            getLimitElement(t) {
                let e;
                if (t instanceof Uh) {
                    e = t.parent
                } else {
                    const i = t instanceof $h ? [t] : Array.from(t.getRanges());
                    e = i.reduce((t, e) => {
                        const i = e.getCommonAncestor();
                        if (!t) {
                            return i
                        }
                        return t.getCommonAncestor(i, {includeSelf: true})
                    }, null)
                }
                while (!this.isLimit(e)) {
                    if (e.parent) {
                        e = e.parent
                    } else {
                        break
                    }
                }
                return e
            }

            checkAttributeInSelection(t, e) {
                if (t.isCollapsed) {
                    const i = t.getFirstPosition();
                    const n = [...i.getAncestors(), new Lh("", t.getAttributes())];
                    return this.checkAttribute(n, e)
                } else {
                    const i = t.getRanges();
                    for (const t of i) {
                        for (const i of t) {
                            if (this.checkAttribute(i.item, e)) {
                                return true
                            }
                        }
                    }
                }
                return false
            }

            * getValidRanges(t, e) {
                t = Pg(t);
                for (const i of t) {
                    yield* this._getValidRangesForRange(i, e)
                }
            }

            getNearestSelectionRange(t, e = "both") {
                if (this.checkChild(t, "$text")) {
                    return new $h(t)
                }
                let i, n;
                const o = t.getAncestors().reverse().find(t => this.isLimit(t)) || t.root;
                if (e == "both" || e == "backward") {
                    i = new Wh({boundaries: $h._createIn(o), startPosition: t, direction: "backward"})
                }
                if (e == "both" || e == "forward") {
                    n = new Wh({boundaries: $h._createIn(o), startPosition: t})
                }
                for (const t of Tg(i, n)) {
                    const e = t.walker == i ? "elementEnd" : "elementStart";
                    const n = t.value;
                    if (n.type == e && this.isObject(n.item)) {
                        return $h._createOn(n.item)
                    }
                    if (this.checkChild(n.nextPosition, "$text")) {
                        return new $h(n.nextPosition)
                    }
                }
                return null
            }

            findAllowedParent(t, e) {
                let i = t.parent;
                while (i) {
                    if (this.checkChild(i, e)) {
                        return i
                    }
                    if (this.isLimit(i)) {
                        return null
                    }
                    i = i.parent
                }
                return null
            }

            removeDisallowedAttributes(t, e) {
                for (const i of t) {
                    if (i.is("text")) {
                        Sg(this, i, e)
                    } else {
                        const t = $h._createIn(i);
                        const n = t.getPositions();
                        for (const t of n) {
                            const i = t.nodeBefore || t.parent;
                            Sg(this, i, e)
                        }
                    }
                }
            }

            createContext(t) {
                return new hg(t)
            }

            _clearCache() {
                this._compiledDefinitions = null
            }

            _compile() {
                const t = {};
                const e = this._sourceDefinitions;
                const i = Object.keys(e);
                for (const n of i) {
                    t[n] = fg(e[n], n)
                }
                for (const e of i) {
                    gg(t, e)
                }
                for (const e of i) {
                    mg(t, e)
                }
                for (const e of i) {
                    pg(t, e);
                    bg(t, e)
                }
                for (const e of i) {
                    wg(t, e);
                    kg(t, e)
                }
                this._compiledDefinitions = t
            }

            _checkContextMatch(t, e, i = e.length - 1) {
                const n = e.getItem(i);
                if (t.allowIn.includes(n.name)) {
                    if (i == 0) {
                        return true
                    } else {
                        const t = this.getDefinition(n);
                        return this._checkContextMatch(t, e, i - 1)
                    }
                } else {
                    return false
                }
            }

            * _getValidRangesForRange(t, e) {
                let i = t.start;
                let n = t.start;
                for (const o of t.getItems({shallow: true})) {
                    if (o.is("element")) {
                        yield* this._getValidRangesForRange($h._createIn(o), e)
                    }
                    if (!this.checkAttribute(o, e)) {
                        if (!i.isEqual(n)) {
                            yield new $h(i, n)
                        }
                        i = Uh._createAfter(o)
                    }
                    n = Uh._createAfter(o)
                }
                if (!i.isEqual(n)) {
                    yield new $h(i, n)
                }
            }
        }

        vs(ug, Jc);

        class hg {
            constructor(t) {
                if (t instanceof hg) {
                    return t
                }
                if (typeof t == "string") {
                    t = [t]
                } else if (!Array.isArray(t)) {
                    t = t.getAncestors({includeSelf: true})
                }
                if (t[0] && typeof t[0] != "string" && t[0].is("documentFragment")) {
                    t.shift()
                }
                this._items = t.map(Ag)
            }

            get length() {
                return this._items.length
            }

            get last() {
                return this._items[this._items.length - 1]
            }

            [Symbol.iterator]() {
                return this._items[Symbol.iterator]()
            }

            push(t) {
                const e = new hg([t]);
                e._items = [...this._items, ...e._items];
                return e
            }

            getItem(t) {
                return this._items[t]
            }

            * getNames() {
                yield* this._items.map(t => t.name)
            }

            endsWith(t) {
                return Array.from(this.getNames()).join(" ").endsWith(t)
            }

            startsWith(t) {
                return Array.from(this.getNames()).join(" ").startsWith(t)
            }
        }

        function fg(t, e) {
            const i = {
                name: e,
                allowIn: [],
                allowContentOf: [],
                allowWhere: [],
                allowAttributes: [],
                allowAttributesOf: [],
                inheritTypesFrom: []
            };
            _g(t, i);
            vg(t, i, "allowIn");
            vg(t, i, "allowContentOf");
            vg(t, i, "allowWhere");
            vg(t, i, "allowAttributes");
            vg(t, i, "allowAttributesOf");
            vg(t, i, "inheritTypesFrom");
            yg(t, i);
            return i
        }

        function gg(t, e) {
            for (const i of t[e].allowContentOf) {
                if (t[i]) {
                    const n = xg(t, i);
                    n.forEach(t => {
                        t.allowIn.push(e)
                    })
                }
            }
            delete t[e].allowContentOf
        }

        function mg(t, e) {
            for (const i of t[e].allowWhere) {
                const n = t[i];
                if (n) {
                    const i = n.allowIn;
                    t[e].allowIn.push(...i)
                }
            }
            delete t[e].allowWhere
        }

        function pg(t, e) {
            for (const i of t[e].allowAttributesOf) {
                const n = t[i];
                if (n) {
                    const i = n.allowAttributes;
                    t[e].allowAttributes.push(...i)
                }
            }
            delete t[e].allowAttributesOf
        }

        function bg(t, e) {
            const i = t[e];
            for (const e of i.inheritTypesFrom) {
                const n = t[e];
                if (n) {
                    const t = Object.keys(n).filter(t => t.startsWith("is"));
                    for (const e of t) {
                        if (!(e in i)) {
                            i[e] = n[e]
                        }
                    }
                }
            }
            delete i.inheritTypesFrom
        }

        function wg(t, e) {
            const i = t[e];
            const n = i.allowIn.filter(e => t[e]);
            i.allowIn = Array.from(new Set(n))
        }

        function kg(t, e) {
            const i = t[e];
            i.allowAttributes = Array.from(new Set(i.allowAttributes))
        }

        function _g(t, e) {
            for (const i of t) {
                const t = Object.keys(i).filter(t => t.startsWith("is"));
                for (const n of t) {
                    e[n] = i[n]
                }
            }
        }

        function vg(t, e, i) {
            for (const n of t) {
                if (typeof n[i] == "string") {
                    e[i].push(n[i])
                } else if (Array.isArray(n[i])) {
                    e[i].push(...n[i])
                }
            }
        }

        function yg(t, e) {
            for (const i of t) {
                const t = i.inheritAllFrom;
                if (t) {
                    e.allowContentOf.push(t);
                    e.allowWhere.push(t);
                    e.allowAttributesOf.push(t);
                    e.inheritTypesFrom.push(t)
                }
            }
        }

        function xg(t, e) {
            const i = t[e];
            return Cg(t).filter(t => t.allowIn.includes(i.name))
        }

        function Cg(t) {
            return Object.keys(t).map(e => t[e])
        }

        function Ag(t) {
            if (typeof t == "string") {
                return {
                    name: t, * getAttributeKeys() {
                    }, getAttribute() {
                    }
                }
            } else {
                return {
                    name: t.is("element") ? t.name : "$text", * getAttributeKeys() {
                        yield* t.getAttributeKeys()
                    }, getAttribute(e) {
                        return t.getAttribute(e)
                    }
                }
            }
        }

        function* Tg(t, e) {
            let i = false;
            while (!i) {
                i = true;
                if (t) {
                    const e = t.next();
                    if (!e.done) {
                        i = false;
                        yield{walker: t, value: e.value}
                    }
                }
                if (e) {
                    const t = e.next();
                    if (!t.done) {
                        i = false;
                        yield{walker: e, value: t.value}
                    }
                }
            }
        }

        function* Pg(t) {
            for (const e of t) {
                yield* e.getMinimalFlatRanges()
            }
        }

        function Sg(t, e, i) {
            for (const n of e.getAttributeKeys()) {
                if (!t.checkAttribute(e, n)) {
                    i.removeAttribute(n, e)
                }
            }
        }

        class Eg {
            constructor(t = {}) {
                this._splitParts = new Map;
                this._modelCursor = null;
                this.conversionApi = Object.assign({}, t);
                this.conversionApi.convertItem = this._convertItem.bind(this);
                this.conversionApi.convertChildren = this._convertChildren.bind(this);
                this.conversionApi.splitToAllowedParent = this._splitToAllowedParent.bind(this);
                this.conversionApi.getSplitParts = this._getSplitParts.bind(this)
            }

            convert(t, e, i = ["$root"]) {
                this.fire("viewCleanup", t);
                this._modelCursor = Og(i, e);
                this.conversionApi.writer = e;
                this.conversionApi.consumable = lg.createFrom(t);
                this.conversionApi.store = {};
                const {modelRange: n} = this._convertItem(t, this._modelCursor);
                const o = e.createDocumentFragment();
                if (n) {
                    this._removeEmptyElements();
                    for (const t of Array.from(this._modelCursor.parent.getChildren())) {
                        e.append(t, o)
                    }
                    o.markers = Rg(o, e)
                }
                this._modelCursor = null;
                this._splitParts.clear();
                this.conversionApi.writer = null;
                this.conversionApi.store = null;
                return o
            }

            _convertItem(t, e) {
                const i = Object.assign({viewItem: t, modelCursor: e, modelRange: null});
                if (t.is("element")) {
                    this.fire("element:" + t.name, i, this.conversionApi)
                } else if (t.is("text")) {
                    this.fire("text", i, this.conversionApi)
                } else {
                    this.fire("documentFragment", i, this.conversionApi)
                }
                if (i.modelRange && !(i.modelRange instanceof $h)) {
                    throw new ss["b"]("view-conversion-dispatcher-incorrect-result: Incorrect conversion result was dropped.", this)
                }
                return {modelRange: i.modelRange, modelCursor: i.modelCursor}
            }

            _convertChildren(t, e) {
                const i = new $h(e);
                let n = e;
                for (const e of Array.from(t.getChildren())) {
                    const t = this._convertItem(e, n);
                    if (t.modelRange instanceof $h) {
                        i.end = t.modelRange.end;
                        n = t.modelCursor
                    }
                }
                return {modelRange: i, modelCursor: n}
            }

            _splitToAllowedParent(t, e) {
                const i = this.conversionApi.schema.findAllowedParent(e, t);
                if (!i) {
                    return null
                }
                if (i === e.parent) {
                    return {position: e}
                }
                if (this._modelCursor.parent.getAncestors().includes(i)) {
                    return null
                }
                const n = this.conversionApi.writer.split(e, i);
                const o = [];
                for (const t of n.range.getWalker()) {
                    if (t.type == "elementEnd") {
                        o.push(t.item)
                    } else {
                        const e = o.pop();
                        const i = t.item;
                        this._registerSplitPair(e, i)
                    }
                }
                return {position: n.position, cursorParent: n.range.end.parent}
            }

            _registerSplitPair(t, e) {
                if (!this._splitParts.has(t)) {
                    this._splitParts.set(t, [t])
                }
                const i = this._splitParts.get(t);
                this._splitParts.set(e, i);
                i.push(e)
            }

            _getSplitParts(t) {
                let e;
                if (!this._splitParts.has(t)) {
                    e = [t]
                } else {
                    e = this._splitParts.get(t)
                }
                return e
            }

            _removeEmptyElements() {
                let t = false;
                for (const e of this._splitParts.keys()) {
                    if (e.isEmpty) {
                        this.conversionApi.writer.remove(e);
                        this._splitParts.delete(e);
                        t = true
                    }
                }
                if (t) {
                    this._removeEmptyElements()
                }
            }
        }

        vs(Eg, ds);

        function Rg(t, e) {
            const i = new Set;
            const n = new Map;
            const o = $h._createIn(t).getItems();
            for (const t of o) {
                if (t.name == "$marker") {
                    i.add(t)
                }
            }
            for (const t of i) {
                const i = t.getAttribute("data-name");
                const o = e.createPositionBefore(t);
                if (!n.has(i)) {
                    n.set(i, new $h(o.clone()))
                } else {
                    n.get(i).end = o.clone()
                }
                e.remove(t)
            }
            return n
        }

        function Og(t, e) {
            let i;
            for (const n of new hg(t)) {
                const t = {};
                for (const e of n.getAttributeKeys()) {
                    t[e] = n.getAttribute(e)
                }
                const o = e.createElement(n.name, t);
                if (i) {
                    e.append(o, i)
                }
                i = Uh._createAt(o, 0)
            }
            return i
        }

        class Ig {
            constructor(t, e) {
                this.model = t;
                this.stylesProcessor = e;
                this.processor;
                this.mapper = new Gh;
                this.downcastDispatcher = new Yh({mapper: this.mapper});
                this.downcastDispatcher.on("insert:$text", _f(), {priority: "lowest"});
                this.upcastDispatcher = new Eg({schema: t.schema});
                this.viewDocument = new pl(e);
                this._viewWriter = new $l(this.viewDocument);
                this.upcastDispatcher.on("text", $f(), {priority: "lowest"});
                this.upcastDispatcher.on("element", Uf(), {priority: "lowest"});
                this.upcastDispatcher.on("documentFragment", Uf(), {priority: "lowest"});
                this.decorate("init");
                this.on("init", () => {
                    this.fire("ready")
                }, {priority: "lowest"})
            }

            get(t) {
                const {rootName: e = "main", trim: i = "empty"} = t || {};
                if (!this._checkIfRootsExists([e])) {
                    throw new ss["b"]("datacontroller-get-non-existent-root: Attempting to get data from a non-existing root.", this)
                }
                const n = this.model.document.getRoot(e);
                if (i === "empty" && !this.model.hasContent(n, {ignoreWhitespaces: true})) {
                    return ""
                }
                return this.stringify(n)
            }

            stringify(t) {
                const e = this.toView(t);
                return this.processor.toData(e)
            }

            toView(t) {
                const e = this.viewDocument;
                const i = this._viewWriter;
                this.mapper.clearBindings();
                const n = $h._createIn(t);
                const o = new ql(e);
                this.mapper.bindElements(t, o);
                this.downcastDispatcher.convertInsert(n, i);
                if (!t.is("documentFragment")) {
                    const e = Vg(t);
                    for (const [t, n] of e) {
                        this.downcastDispatcher.convertMarkerAdd(t, n, i)
                    }
                }
                return o
            }

            init(t) {
                if (this.model.document.version) {
                    throw new ss["b"]("datacontroller-init-document-not-empty: Trying to set initial data to not empty document.", this)
                }
                let e = {};
                if (typeof t === "string") {
                    e.main = t
                } else {
                    e = t
                }
                if (!this._checkIfRootsExists(Object.keys(e))) {
                    throw new ss["b"]("datacontroller-init-non-existent-root: Attempting to init data on a non-existing root.", this)
                }
                this.model.enqueueChange("transparent", t => {
                    for (const i of Object.keys(e)) {
                        const n = this.model.document.getRoot(i);
                        t.insert(this.parse(e[i], n), n, 0)
                    }
                });
                return Promise.resolve()
            }

            set(t) {
                let e = {};
                if (typeof t === "string") {
                    e.main = t
                } else {
                    e = t
                }
                if (!this._checkIfRootsExists(Object.keys(e))) {
                    throw new ss["b"]("datacontroller-set-non-existent-root: Attempting to set data on a non-existing root.", this)
                }
                this.model.enqueueChange("transparent", t => {
                    t.setSelection(null);
                    t.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());
                    for (const i of Object.keys(e)) {
                        const n = this.model.document.getRoot(i);
                        t.remove(t.createRangeIn(n));
                        t.insert(this.parse(e[i], n), n, 0)
                    }
                })
            }

            parse(t, e = "$root") {
                const i = this.processor.toView(t);
                return this.toModel(i, e)
            }

            toModel(t, e = "$root") {
                return this.model.change(i => this.upcastDispatcher.convert(t, i, e))
            }

            addStyleProcessorRules(t) {
                t(this.stylesProcessor)
            }

            destroy() {
                this.stopListening()
            }

            _checkIfRootsExists(t) {
                for (const e of t) {
                    if (!this.model.document.getRootNames().includes(e)) {
                        return false
                    }
                }
                return true
            }
        }

        vs(Ig, Jc);

        function Vg(t) {
            const e = [];
            const i = t.root.document;
            if (!i) {
                return []
            }
            const n = $h._createIn(t);
            for (const t of i.model.markers) {
                const i = n.getIntersection(t.getRange());
                if (i) {
                    e.push([t.name, i])
                }
            }
            return e
        }

        class Ng {
            constructor(t, e) {
                this._helpers = new Map;
                this._downcast = Array.isArray(t) ? t : [t];
                this._createConversionHelpers({name: "downcast", dispatchers: this._downcast, isDowncast: true});
                this._upcast = Array.isArray(e) ? e : [e];
                this._createConversionHelpers({name: "upcast", dispatchers: this._upcast, isDowncast: false})
            }

            addAlias(t, e) {
                const i = this._downcast.includes(e);
                const n = this._upcast.includes(e);
                if (!n && !i) {
                    throw new ss["b"]("conversion-add-alias-dispatcher-not-registered: " + "Trying to register and alias for a dispatcher that nas not been registered.", this)
                }
                this._createConversionHelpers({name: t, dispatchers: [e], isDowncast: i})
            }

            for(t) {
                if (!this._helpers.has(t)) {
                    throw new ss["b"]("conversion-for-unknown-group: Trying to add a converter to an unknown dispatchers group.", this)
                }
                return this._helpers.get(t)
            }

            elementToElement(t) {
                this.for("downcast").elementToElement(t);
                for (const {model: e, view: i} of Mg(t)) {
                    this.for("upcast").elementToElement({model: e, view: i, converterPriority: t.converterPriority})
                }
            }

            attributeToElement(t) {
                this.for("downcast").attributeToElement(t);
                for (const {model: e, view: i} of Mg(t)) {
                    this.for("upcast").elementToAttribute({view: i, model: e, converterPriority: t.converterPriority})
                }
            }

            attributeToAttribute(t) {
                this.for("downcast").attributeToAttribute(t);
                for (const {model: e, view: i} of Mg(t)) {
                    this.for("upcast").attributeToAttribute({view: i, model: e})
                }
            }

            _createConversionHelpers({name: t, dispatchers: e, isDowncast: i}) {
                if (this._helpers.has(t)) {
                    throw new ss["b"]("conversion-group-exists: Trying to register a group name that has already been registered.", this)
                }
                const n = i ? new kf(e) : new qf(e);
                this._helpers.set(t, n)
            }
        }

        function* Mg(t) {
            if (t.model.values) {
                for (const e of t.model.values) {
                    const i = {key: t.model.key, value: e};
                    const n = t.view[e];
                    const o = t.upcastAlso ? t.upcastAlso[e] : undefined;
                    yield* Bg(i, n, o)
                }
            } else {
                yield* Bg(t.model, t.view, t.upcastAlso)
            }
        }

        function* Bg(t, e, i) {
            yield{model: t, view: e};
            if (i) {
                i = Array.isArray(i) ? i : [i];
                for (const e of i) {
                    yield{model: t, view: e}
                }
            }
        }

        class zg {
            constructor(t = "default") {
                this.operations = [];
                this.type = t
            }

            get baseVersion() {
                for (const t of this.operations) {
                    if (t.baseVersion !== null) {
                        return t.baseVersion
                    }
                }
                return null
            }

            addOperation(t) {
                t.batch = this;
                this.operations.push(t);
                return t
            }
        }

        class Lg {
            constructor(t) {
                this.baseVersion = t;
                this.isDocumentOperation = this.baseVersion !== null;
                this.batch = null
            }

            _validate() {
            }

            toJSON() {
                const t = Object.assign({}, this);
                t.__className = this.constructor.className;
                delete t.batch;
                delete t.isDocumentOperation;
                return t
            }

            static get className() {
                return "Operation"
            }

            static fromJSON(t) {
                return new this(t.baseVersion)
            }
        }

        class Fg {
            constructor(t) {
                this.markers = new Map;
                this._children = new Dh;
                if (t) {
                    this._insertChild(0, t)
                }
            }

            [Symbol.iterator]() {
                return this.getChildren()
            }

            get childCount() {
                return this._children.length
            }

            get maxOffset() {
                return this._children.maxOffset
            }

            get isEmpty() {
                return this.childCount === 0
            }

            get root() {
                return this
            }

            get parent() {
                return null
            }

            is(t) {
                return t == "documentFragment" || t == "model:documentFragment"
            }

            getChild(t) {
                return this._children.getNode(t)
            }

            getChildren() {
                return this._children[Symbol.iterator]()
            }

            getChildIndex(t) {
                return this._children.getNodeIndex(t)
            }

            getChildStartOffset(t) {
                return this._children.getNodeStartOffset(t)
            }

            getPath() {
                return []
            }

            getNodeByPath(t) {
                let e = this;
                for (const i of t) {
                    e = e.getChild(e.offsetToIndex(i))
                }
                return e
            }

            offsetToIndex(t) {
                return this._children.offsetToIndex(t)
            }

            toJSON() {
                const t = [];
                for (const e of this._children) {
                    t.push(e.toJSON())
                }
                return t
            }

            static fromJSON(t) {
                const e = [];
                for (const i of t) {
                    if (i.name) {
                        e.push(jh.fromJSON(i))
                    } else {
                        e.push(Lh.fromJSON(i))
                    }
                }
                return new Fg(e)
            }

            _appendChild(t) {
                this._insertChild(this.childCount, t)
            }

            _insertChild(t, e) {
                const i = Dg(e);
                for (const t of i) {
                    if (t.parent !== null) {
                        t._remove()
                    }
                    t.parent = this
                }
                this._children._insertNodes(t, i)
            }

            _removeChildren(t, e = 1) {
                const i = this._children._removeNodes(t, e);
                for (const t of i) {
                    t.parent = null
                }
                return i
            }
        }

        function Dg(t) {
            if (typeof t == "string") {
                return [new Lh(t)]
            }
            if (!js(t)) {
                t = [t]
            }
            return Array.from(t).map(t => {
                if (typeof t == "string") {
                    return new Lh(t)
                }
                if (t instanceof Fh) {
                    return new Lh(t.data, t.getAttributes())
                }
                return t
            })
        }

        function jg(t, e) {
            e = Ug(e);
            const i = e.reduce((t, e) => t + e.offsetSize, 0);
            const n = t.parent;
            Gg(t);
            const o = t.index;
            n._insertChild(o, e);
            $g(n, o + e.length);
            $g(n, o);
            return new $h(t, t.getShiftedBy(i))
        }

        function Hg(t) {
            if (!t.isFlat) {
                throw new ss["b"]("operation-utils-remove-range-not-flat: " + "Trying to remove a range which starts and ends in different element.", this)
            }
            const e = t.start.parent;
            Gg(t.start);
            Gg(t.end);
            const i = e._removeChildren(t.start.index, t.end.index - t.start.index);
            $g(e, t.start.index);
            return i
        }

        function Wg(t, e) {
            if (!t.isFlat) {
                throw new ss["b"]("operation-utils-move-range-not-flat: " + "Trying to move a range which starts and ends in different element.", this)
            }
            const i = Hg(t);
            e = e._getTransformedByDeletion(t.start, t.end.offset - t.start.offset);
            return jg(e, i)
        }

        function qg(t, e, i) {
            Gg(t.start);
            Gg(t.end);
            for (const n of t.getItems({shallow: true})) {
                const t = n.is("textProxy") ? n.textNode : n;
                if (i !== null) {
                    t._setAttribute(e, i)
                } else {
                    t._removeAttribute(e)
                }
                $g(t.parent, t.index)
            }
            $g(t.end.parent, t.end.index)
        }

        function Ug(t) {
            const e = [];
            if (!(t instanceof Array)) {
                t = [t]
            }
            for (let i = 0; i < t.length; i++) {
                if (typeof t[i] == "string") {
                    e.push(new Lh(t[i]))
                } else if (t[i] instanceof Fh) {
                    e.push(new Lh(t[i].data, t[i].getAttributes()))
                } else if (t[i] instanceof Fg || t[i] instanceof Dh) {
                    for (const n of t[i]) {
                        e.push(n)
                    }
                } else if (t[i] instanceof zh) {
                    e.push(t[i])
                }
            }
            for (let t = 1; t < e.length; t++) {
                const i = e[t];
                const n = e[t - 1];
                if (i instanceof Lh && n instanceof Lh && Kg(i, n)) {
                    e.splice(t - 1, 2, new Lh(n.data + i.data, n.getAttributes()));
                    t--
                }
            }
            return e
        }

        function $g(t, e) {
            const i = t.getChild(e - 1);
            const n = t.getChild(e);
            if (i && n && i.is("text") && n.is("text") && Kg(i, n)) {
                const o = new Lh(i.data + n.data, i.getAttributes());
                t._removeChildren(e - 1, 2);
                t._insertChild(e - 1, o)
            }
        }

        function Gg(t) {
            const e = t.textNode;
            const i = t.parent;
            if (e) {
                const n = t.offset - e.startOffset;
                const o = e.index;
                i._removeChildren(o, 1);
                const r = new Lh(e.data.substr(0, n), e.getAttributes());
                const s = new Lh(e.data.substr(n), e.getAttributes());
                i._insertChild(o, [r, s])
            }
        }

        function Kg(t, e) {
            const i = t.getAttributes();
            const n = e.getAttributes();
            for (const t of i) {
                if (t[1] !== e.getAttribute(t[0])) {
                    return false
                }
                n.next()
            }
            return n.next().done
        }

        function Jg(t, e) {
            return qu(t, e)
        }

        var Yg = Jg;

        class Qg extends Lg {
            constructor(t, e, i, n, o) {
                super(o);
                this.range = t.clone();
                this.key = e;
                this.oldValue = i === undefined ? null : i;
                this.newValue = n === undefined ? null : n
            }

            get type() {
                if (this.oldValue === null) {
                    return "addAttribute"
                } else if (this.newValue === null) {
                    return "removeAttribute"
                } else {
                    return "changeAttribute"
                }
            }

            clone() {
                return new Qg(this.range, this.key, this.oldValue, this.newValue, this.baseVersion)
            }

            getReversed() {
                return new Qg(this.range, this.key, this.newValue, this.oldValue, this.baseVersion + 1)
            }

            toJSON() {
                const t = super.toJSON();
                t.range = this.range.toJSON();
                return t
            }

            _validate() {
                if (!this.range.isFlat) {
                    throw new ss["b"]("attribute-operation-range-not-flat: The range to change is not flat.", this)
                }
                for (const t of this.range.getItems({shallow: true})) {
                    if (this.oldValue !== null && !Yg(t.getAttribute(this.key), this.oldValue)) {
                        throw new ss["b"]("attribute-operation-wrong-old-value: Changed node has different attribute value than operation's " + "old attribute value.", this, {
                            item: t,
                            key: this.key,
                            value: this.oldValue
                        })
                    }
                    if (this.oldValue === null && this.newValue !== null && t.hasAttribute(this.key)) {
                        throw new ss["b"]("attribute-operation-attribute-exists: The attribute with given key already exists.", this, {
                            node: t,
                            key: this.key
                        })
                    }
                }
            }

            _execute() {
                if (!Yg(this.oldValue, this.newValue)) {
                    qg(this.range, this.key, this.newValue)
                }
            }

            static get className() {
                return "AttributeOperation"
            }

            static fromJSON(t, e) {
                return new Qg($h.fromJSON(t.range, e), t.key, t.oldValue, t.newValue, t.baseVersion)
            }
        }

        class Xg extends Lg {
            constructor(t, e) {
                super(null);
                this.sourcePosition = t.clone();
                this.howMany = e
            }

            get type() {
                return "detach"
            }

            toJSON() {
                const t = super.toJSON();
                t.sourcePosition = this.sourcePosition.toJSON();
                return t
            }

            _validate() {
                if (this.sourcePosition.root.document) {
                    throw new ss["b"]("detach-operation-on-document-node: Cannot detach document node.", this)
                }
            }

            _execute() {
                Hg($h._createFromPositionAndShift(this.sourcePosition, this.howMany))
            }

            static get className() {
                return "DetachOperation"
            }
        }

        class Zg extends Lg {
            constructor(t, e, i, n) {
                super(n);
                this.sourcePosition = t.clone();
                this.sourcePosition.stickiness = "toNext";
                this.howMany = e;
                this.targetPosition = i.clone();
                this.targetPosition.stickiness = "toNone"
            }

            get type() {
                if (this.targetPosition.root.rootName == "$graveyard") {
                    return "remove"
                } else if (this.sourcePosition.root.rootName == "$graveyard") {
                    return "reinsert"
                }
                return "move"
            }

            clone() {
                return new this.constructor(this.sourcePosition, this.howMany, this.targetPosition, this.baseVersion)
            }

            getMovedRangeStart() {
                return this.targetPosition._getTransformedByDeletion(this.sourcePosition, this.howMany)
            }

            getReversed() {
                const t = this.sourcePosition._getTransformedByInsertion(this.targetPosition, this.howMany);
                return new this.constructor(this.getMovedRangeStart(), this.howMany, t, this.baseVersion + 1)
            }

            _validate() {
                const t = this.sourcePosition.parent;
                const e = this.targetPosition.parent;
                const i = this.sourcePosition.offset;
                const n = this.targetPosition.offset;
                if (i + this.howMany > t.maxOffset) {
                    throw new ss["b"]("move-operation-nodes-do-not-exist: The nodes which should be moved do not exist.", this)
                } else if (t === e && i < n && n < i + this.howMany) {
                    throw new ss["b"]("move-operation-range-into-itself: Trying to move a range of nodes to the inside of that range.", this)
                } else if (this.sourcePosition.root == this.targetPosition.root) {
                    if (Vs(this.sourcePosition.getParentPath(), this.targetPosition.getParentPath()) == "prefix") {
                        const t = this.sourcePosition.path.length - 1;
                        if (this.targetPosition.path[t] >= i && this.targetPosition.path[t] < i + this.howMany) {
                            throw new ss["b"]("move-operation-node-into-itself: Trying to move a range of nodes into one of nodes from that range.", this)
                        }
                    }
                }
            }

            _execute() {
                Wg($h._createFromPositionAndShift(this.sourcePosition, this.howMany), this.targetPosition)
            }

            toJSON() {
                const t = super.toJSON();
                t.sourcePosition = this.sourcePosition.toJSON();
                t.targetPosition = this.targetPosition.toJSON();
                return t
            }

            static get className() {
                return "MoveOperation"
            }

            static fromJSON(t, e) {
                const i = Uh.fromJSON(t.sourcePosition, e);
                const n = Uh.fromJSON(t.targetPosition, e);
                return new this(i, t.howMany, n, t.baseVersion)
            }
        }

        class tm extends Lg {
            constructor(t, e, i) {
                super(i);
                this.position = t.clone();
                this.position.stickiness = "toNone";
                this.nodes = new Dh(Ug(e));
                this.shouldReceiveAttributes = false
            }

            get type() {
                return "insert"
            }

            get howMany() {
                return this.nodes.maxOffset
            }

            clone() {
                const t = new Dh([...this.nodes].map(t => t._clone(true)));
                const e = new tm(this.position, t, this.baseVersion);
                e.shouldReceiveAttributes = this.shouldReceiveAttributes;
                return e
            }

            getReversed() {
                const t = this.position.root.document.graveyard;
                const e = new Uh(t, [0]);
                return new Zg(this.position, this.nodes.maxOffset, e, this.baseVersion + 1)
            }

            _validate() {
                const t = this.position.parent;
                if (!t || t.maxOffset < this.position.offset) {
                    throw new ss["b"]("insert-operation-position-invalid: Insertion position is invalid.", this)
                }
            }

            _execute() {
                const t = this.nodes;
                this.nodes = new Dh([...t].map(t => t._clone(true)));
                jg(this.position, t)
            }

            toJSON() {
                const t = super.toJSON();
                t.position = this.position.toJSON();
                t.nodes = this.nodes.toJSON();
                return t
            }

            static get className() {
                return "InsertOperation"
            }

            static fromJSON(t, e) {
                const i = [];
                for (const e of t.nodes) {
                    if (e.name) {
                        i.push(jh.fromJSON(e))
                    } else {
                        i.push(Lh.fromJSON(e))
                    }
                }
                const n = new tm(Uh.fromJSON(t.position, e), i, t.baseVersion);
                n.shouldReceiveAttributes = t.shouldReceiveAttributes;
                return n
            }
        }

        class em extends Lg {
            constructor(t, e, i, n, o, r) {
                super(r);
                this.name = t;
                this.oldRange = e ? e.clone() : null;
                this.newRange = i ? i.clone() : null;
                this.affectsData = o;
                this._markers = n
            }

            get type() {
                return "marker"
            }

            clone() {
                return new em(this.name, this.oldRange, this.newRange, this._markers, this.affectsData, this.baseVersion)
            }

            getReversed() {
                return new em(this.name, this.newRange, this.oldRange, this._markers, this.affectsData, this.baseVersion + 1)
            }

            _execute() {
                const t = this.newRange ? "_set" : "_remove";
                this._markers[t](this.name, this.newRange, true, this.affectsData)
            }

            toJSON() {
                const t = super.toJSON();
                if (this.oldRange) {
                    t.oldRange = this.oldRange.toJSON()
                }
                if (this.newRange) {
                    t.newRange = this.newRange.toJSON()
                }
                delete t._markers;
                return t
            }

            static get className() {
                return "MarkerOperation"
            }

            static fromJSON(t, e) {
                return new em(t.name, t.oldRange ? $h.fromJSON(t.oldRange, e) : null, t.newRange ? $h.fromJSON(t.newRange, e) : null, e.model.markers, t.affectsData, t.baseVersion)
            }
        }

        class im extends Lg {
            constructor(t, e, i, n) {
                super(n);
                this.position = t;
                this.position.stickiness = "toNext";
                this.oldName = e;
                this.newName = i
            }

            get type() {
                return "rename"
            }

            clone() {
                return new im(this.position.clone(), this.oldName, this.newName, this.baseVersion)
            }

            getReversed() {
                return new im(this.position.clone(), this.newName, this.oldName, this.baseVersion + 1)
            }

            _validate() {
                const t = this.position.nodeAfter;
                if (!(t instanceof jh)) {
                    throw new ss["b"]("rename-operation-wrong-position: Given position is invalid or node after it is not an instance of Element.", this)
                } else if (t.name !== this.oldName) {
                    throw new ss["b"]("rename-operation-wrong-name: Element to change has different name than operation's old name.", this)
                }
            }

            _execute() {
                const t = this.position.nodeAfter;
                t.name = this.newName
            }

            toJSON() {
                const t = super.toJSON();
                t.position = this.position.toJSON();
                return t
            }

            static get className() {
                return "RenameOperation"
            }

            static fromJSON(t, e) {
                return new im(Uh.fromJSON(t.position, e), t.oldName, t.newName, t.baseVersion)
            }
        }

        class nm extends Lg {
            constructor(t, e, i, n, o) {
                super(o);
                this.root = t;
                this.key = e;
                this.oldValue = i;
                this.newValue = n
            }

            get type() {
                if (this.oldValue === null) {
                    return "addRootAttribute"
                } else if (this.newValue === null) {
                    return "removeRootAttribute"
                } else {
                    return "changeRootAttribute"
                }
            }

            clone() {
                return new nm(this.root, this.key, this.oldValue, this.newValue, this.baseVersion)
            }

            getReversed() {
                return new nm(this.root, this.key, this.newValue, this.oldValue, this.baseVersion + 1)
            }

            _validate() {
                if (this.root != this.root.root || this.root.is("documentFragment")) {
                    throw new ss["b"]("rootattribute-operation-not-a-root: The element to change is not a root element.", this, {
                        root: this.root,
                        key: this.key
                    })
                }
                if (this.oldValue !== null && this.root.getAttribute(this.key) !== this.oldValue) {
                    throw new ss["b"]("rootattribute-operation-wrong-old-value: Changed node has different attribute value than operation's " + "old attribute value.", this, {
                        root: this.root,
                        key: this.key
                    })
                }
                if (this.oldValue === null && this.newValue !== null && this.root.hasAttribute(this.key)) {
                    throw new ss["b"]("rootattribute-operation-attribute-exists: The attribute with given key already exists.", this, {
                        root: this.root,
                        key: this.key
                    })
                }
            }

            _execute() {
                if (this.newValue !== null) {
                    this.root._setAttribute(this.key, this.newValue)
                } else {
                    this.root._removeAttribute(this.key)
                }
            }

            toJSON() {
                const t = super.toJSON();
                t.root = this.root.toJSON();
                return t
            }

            static get className() {
                return "RootAttributeOperation"
            }

            static fromJSON(t, e) {
                if (!e.getRoot(t.root)) {
                    throw new ss["b"]("rootattribute-operation-fromjson-no-root: Cannot create RootAttributeOperation. Root with specified name does not exist.", this, {rootName: t.root})
                }
                return new nm(e.getRoot(t.root), t.key, t.oldValue, t.newValue, t.baseVersion)
            }
        }

        class om extends Lg {
            constructor(t, e, i, n, o) {
                super(o);
                this.sourcePosition = t.clone();
                this.sourcePosition.stickiness = "toPrevious";
                this.howMany = e;
                this.targetPosition = i.clone();
                this.targetPosition.stickiness = "toNext";
                this.graveyardPosition = n.clone()
            }

            get type() {
                return "merge"
            }

            get deletionPosition() {
                return new Uh(this.sourcePosition.root, this.sourcePosition.path.slice(0, -1))
            }

            get movedRange() {
                const t = this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);
                return new $h(this.sourcePosition, t)
            }

            clone() {
                return new this.constructor(this.sourcePosition, this.howMany, this.targetPosition, this.graveyardPosition, this.baseVersion)
            }

            getReversed() {
                const t = this.targetPosition._getTransformedByMergeOperation(this);
                const e = this.sourcePosition.path.slice(0, -1);
                const i = new Uh(this.sourcePosition.root, e)._getTransformedByMergeOperation(this);
                const n = new rm(t, this.howMany, this.graveyardPosition, this.baseVersion + 1);
                n.insertionPosition = i;
                return n
            }

            _validate() {
                const t = this.sourcePosition.parent;
                const e = this.targetPosition.parent;
                if (!t.parent) {
                    throw new ss["b"]("merge-operation-source-position-invalid: Merge source position is invalid.", this)
                } else if (!e.parent) {
                    throw new ss["b"]("merge-operation-target-position-invalid: Merge target position is invalid.", this)
                } else if (this.howMany != t.maxOffset) {
                    throw new ss["b"]("merge-operation-how-many-invalid: Merge operation specifies wrong number of nodes to move.", this)
                }
            }

            _execute() {
                const t = this.sourcePosition.parent;
                const e = $h._createIn(t);
                Wg(e, this.targetPosition);
                Wg($h._createOn(t), this.graveyardPosition)
            }

            toJSON() {
                const t = super.toJSON();
                t.sourcePosition = t.sourcePosition.toJSON();
                t.targetPosition = t.targetPosition.toJSON();
                t.graveyardPosition = t.graveyardPosition.toJSON();
                return t
            }

            static get className() {
                return "MergeOperation"
            }

            static fromJSON(t, e) {
                const i = Uh.fromJSON(t.sourcePosition, e);
                const n = Uh.fromJSON(t.targetPosition, e);
                const o = Uh.fromJSON(t.graveyardPosition, e);
                return new this(i, t.howMany, n, o, t.baseVersion)
            }
        }

        class rm extends Lg {
            constructor(t, e, i, n) {
                super(n);
                this.splitPosition = t.clone();
                this.splitPosition.stickiness = "toNext";
                this.howMany = e;
                this.insertionPosition = rm.getInsertionPosition(t);
                this.insertionPosition.stickiness = "toNone";
                this.graveyardPosition = i ? i.clone() : null;
                if (this.graveyardPosition) {
                    this.graveyardPosition.stickiness = "toNext"
                }
            }

            get type() {
                return "split"
            }

            get moveTargetPosition() {
                const t = this.insertionPosition.path.slice();
                t.push(0);
                return new Uh(this.insertionPosition.root, t)
            }

            get movedRange() {
                const t = this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);
                return new $h(this.splitPosition, t)
            }

            clone() {
                const t = new this.constructor(this.splitPosition, this.howMany, this.graveyardPosition, this.baseVersion);
                t.insertionPosition = this.insertionPosition;
                return t
            }

            getReversed() {
                const t = this.splitPosition.root.document.graveyard;
                const e = new Uh(t, [0]);
                return new om(this.moveTargetPosition, this.howMany, this.splitPosition, e, this.baseVersion + 1)
            }

            _validate() {
                const t = this.splitPosition.parent;
                const e = this.splitPosition.offset;
                if (!t || t.maxOffset < e) {
                    throw new ss["b"]("split-operation-position-invalid: Split position is invalid.", this)
                } else if (!t.parent) {
                    throw new ss["b"]("split-operation-split-in-root: Cannot split root element.", this)
                } else if (this.howMany != t.maxOffset - this.splitPosition.offset) {
                    throw new ss["b"]("split-operation-how-many-invalid: Split operation specifies wrong number of nodes to move.", this)
                } else if (this.graveyardPosition && !this.graveyardPosition.nodeAfter) {
                    throw new ss["b"]("split-operation-graveyard-position-invalid: Graveyard position invalid.", this)
                }
            }

            _execute() {
                const t = this.splitPosition.parent;
                if (this.graveyardPosition) {
                    Wg($h._createFromPositionAndShift(this.graveyardPosition, 1), this.insertionPosition)
                } else {
                    const e = t._clone();
                    jg(this.insertionPosition, e)
                }
                const e = new $h(Uh._createAt(t, this.splitPosition.offset), Uh._createAt(t, t.maxOffset));
                Wg(e, this.moveTargetPosition)
            }

            toJSON() {
                const t = super.toJSON();
                t.splitPosition = this.splitPosition.toJSON();
                t.insertionPosition = this.insertionPosition.toJSON();
                if (this.graveyardPosition) {
                    t.graveyardPosition = this.graveyardPosition.toJSON()
                }
                return t
            }

            static get className() {
                return "SplitOperation"
            }

            static getInsertionPosition(t) {
                const e = t.path.slice(0, -1);
                e[e.length - 1]++;
                return new Uh(t.root, e)
            }

            static fromJSON(t, e) {
                const i = Uh.fromJSON(t.splitPosition, e);
                const n = Uh.fromJSON(t.insertionPosition, e);
                const o = t.graveyardPosition ? Uh.fromJSON(t.graveyardPosition, e) : null;
                const r = new this(i, t.howMany, o, t.baseVersion);
                r.insertionPosition = n;
                return r
            }
        }

        class sm extends jh {
            constructor(t, e, i = "main") {
                super(e);
                this._document = t;
                this.rootName = i
            }

            get document() {
                return this._document
            }

            is(t, e) {
                const i = t.replace("model:", "");
                if (!e) {
                    return i == "rootElement" || super.is(t)
                } else {
                    return i == "rootElement" && e == this.name || super.is(t, e)
                }
            }

            toJSON() {
                return this.rootName
            }
        }

        class am {
            constructor(t, e) {
                this.model = t;
                this.batch = e
            }

            createText(t, e) {
                return new Lh(t, e)
            }

            createElement(t, e) {
                return new jh(t, e)
            }

            createDocumentFragment() {
                return new Fg
            }

            insert(t, e, i = 0) {
                this._assertWriterUsedCorrectly();
                if (t instanceof Lh && t.data == "") {
                    return
                }
                const n = Uh._createAt(e, i);
                if (t.parent) {
                    if (hm(t.root, n.root)) {
                        this.move($h._createOn(t), n);
                        return
                    } else {
                        if (t.root.document) {
                            throw new ss["b"]("model-writer-insert-forbidden-move: " + "Cannot move a node from a document to a different tree. " + "It is forbidden to move a node that was already in a document outside of it.", this)
                        } else {
                            this.remove(t)
                        }
                    }
                }
                const o = n.root.document ? n.root.document.version : null;
                const r = new tm(n, t, o);
                if (t instanceof Lh) {
                    r.shouldReceiveAttributes = true
                }
                this.batch.addOperation(r);
                this.model.applyOperation(r);
                if (t instanceof Fg) {
                    for (const [e, i] of t.markers) {
                        const t = Uh._createAt(i.root, 0);
                        const o = new $h(i.start._getCombined(t, n), i.end._getCombined(t, n));
                        const r = {range: o, usingOperation: true, affectsData: true};
                        if (this.model.markers.has(e)) {
                            this.updateMarker(e, r)
                        } else {
                            this.addMarker(e, r)
                        }
                    }
                }
            }

            insertText(t, e, i, n) {
                if (e instanceof Fg || e instanceof jh || e instanceof Uh) {
                    this.insert(this.createText(t), e, i)
                } else {
                    this.insert(this.createText(t, e), i, n)
                }
            }

            insertElement(t, e, i, n) {
                if (e instanceof Fg || e instanceof jh || e instanceof Uh) {
                    this.insert(this.createElement(t), e, i)
                } else {
                    this.insert(this.createElement(t, e), i, n)
                }
            }

            append(t, e) {
                this.insert(t, e, "end")
            }

            appendText(t, e, i) {
                if (e instanceof Fg || e instanceof jh) {
                    this.insert(this.createText(t), e, "end")
                } else {
                    this.insert(this.createText(t, e), i, "end")
                }
            }

            appendElement(t, e, i) {
                if (e instanceof Fg || e instanceof jh) {
                    this.insert(this.createElement(t), e, "end")
                } else {
                    this.insert(this.createElement(t, e), i, "end")
                }
            }

            setAttribute(t, e, i) {
                this._assertWriterUsedCorrectly();
                if (i instanceof $h) {
                    const n = i.getMinimalFlatRanges();
                    for (const i of n) {
                        cm(this, t, e, i)
                    }
                } else {
                    lm(this, t, e, i)
                }
            }

            setAttributes(t, e) {
                for (const [i, n] of Hs(t)) {
                    this.setAttribute(i, n, e)
                }
            }

            removeAttribute(t, e) {
                this._assertWriterUsedCorrectly();
                if (e instanceof $h) {
                    const i = e.getMinimalFlatRanges();
                    for (const e of i) {
                        cm(this, t, null, e)
                    }
                } else {
                    lm(this, t, null, e)
                }
            }

            clearAttributes(t) {
                this._assertWriterUsedCorrectly();
                const e = t => {
                    for (const e of t.getAttributeKeys()) {
                        this.removeAttribute(e, t)
                    }
                };
                if (!(t instanceof $h)) {
                    e(t)
                } else {
                    for (const i of t.getItems()) {
                        e(i)
                    }
                }
            }

            move(t, e, i) {
                this._assertWriterUsedCorrectly();
                if (!(t instanceof $h)) {
                    throw new ss["b"]("writer-move-invalid-range: Invalid range to move.", this)
                }
                if (!t.isFlat) {
                    throw new ss["b"]("writer-move-range-not-flat: Range to move is not flat.", this)
                }
                const n = Uh._createAt(e, i);
                if (n.isEqual(t.start)) {
                    return
                }
                this._addOperationForAffectedMarkers("move", t);
                if (!hm(t.root, n.root)) {
                    throw new ss["b"]("writer-move-different-document: Range is going to be moved between different documents.", this)
                }
                const o = t.root.document ? t.root.document.version : null;
                const r = new Zg(t.start, t.end.offset - t.start.offset, n, o);
                this.batch.addOperation(r);
                this.model.applyOperation(r)
            }

            remove(t) {
                this._assertWriterUsedCorrectly();
                const e = t instanceof $h ? t : $h._createOn(t);
                const i = e.getMinimalFlatRanges().reverse();
                for (const t of i) {
                    this._addOperationForAffectedMarkers("move", t);
                    um(t.start, t.end.offset - t.start.offset, this.batch, this.model)
                }
            }

            merge(t) {
                this._assertWriterUsedCorrectly();
                const e = t.nodeBefore;
                const i = t.nodeAfter;
                this._addOperationForAffectedMarkers("merge", t);
                if (!(e instanceof jh)) {
                    throw new ss["b"]("writer-merge-no-element-before: Node before merge position must be an element.", this)
                }
                if (!(i instanceof jh)) {
                    throw new ss["b"]("writer-merge-no-element-after: Node after merge position must be an element.", this)
                }
                if (!t.root.document) {
                    this._mergeDetached(t)
                } else {
                    this._merge(t)
                }
            }

            createPositionFromPath(t, e, i) {
                return this.model.createPositionFromPath(t, e, i)
            }

            createPositionAt(t, e) {
                return this.model.createPositionAt(t, e)
            }

            createPositionAfter(t) {
                return this.model.createPositionAfter(t)
            }

            createPositionBefore(t) {
                return this.model.createPositionBefore(t)
            }

            createRange(t, e) {
                return this.model.createRange(t, e)
            }

            createRangeIn(t) {
                return this.model.createRangeIn(t)
            }

            createRangeOn(t) {
                return this.model.createRangeOn(t)
            }

            createSelection(t, e, i) {
                return this.model.createSelection(t, e, i)
            }

            _mergeDetached(t) {
                const e = t.nodeBefore;
                const i = t.nodeAfter;
                this.move($h._createIn(i), Uh._createAt(e, "end"));
                this.remove(i)
            }

            _merge(t) {
                const e = Uh._createAt(t.nodeBefore, "end");
                const i = Uh._createAt(t.nodeAfter, 0);
                const n = t.root.document.graveyard;
                const o = new Uh(n, [0]);
                const r = t.root.document.version;
                const s = new om(i, t.nodeAfter.maxOffset, e, o, r);
                this.batch.addOperation(s);
                this.model.applyOperation(s)
            }

            rename(t, e) {
                this._assertWriterUsedCorrectly();
                if (!(t instanceof jh)) {
                    throw new ss["b"]("writer-rename-not-element-instance: Trying to rename an object which is not an instance of Element.", this)
                }
                const i = t.root.document ? t.root.document.version : null;
                const n = new im(Uh._createBefore(t), t.name, e, i);
                this.batch.addOperation(n);
                this.model.applyOperation(n)
            }

            split(t, e) {
                this._assertWriterUsedCorrectly();
                let i = t.parent;
                if (!i.parent) {
                    throw new ss["b"]("writer-split-element-no-parent: Element with no parent can not be split.", this)
                }
                if (!e) {
                    e = i.parent
                }
                if (!t.parent.getAncestors({includeSelf: true}).includes(e)) {
                    throw new ss["b"]("writer-split-invalid-limit-element: Limit element is not a position ancestor.", this)
                }
                let n, o;
                do {
                    const e = i.root.document ? i.root.document.version : null;
                    const r = i.maxOffset - t.offset;
                    const s = new rm(t, r, null, e);
                    this.batch.addOperation(s);
                    this.model.applyOperation(s);
                    if (!n && !o) {
                        n = i;
                        o = t.parent.nextSibling
                    }
                    t = this.createPositionAfter(t.parent);
                    i = t.parent
                } while (i !== e);
                return {position: t, range: new $h(Uh._createAt(n, "end"), Uh._createAt(o, 0))}
            }

            wrap(t, e) {
                this._assertWriterUsedCorrectly();
                if (!t.isFlat) {
                    throw new ss["b"]("writer-wrap-range-not-flat: Range to wrap is not flat.", this)
                }
                const i = e instanceof jh ? e : new jh(e);
                if (i.childCount > 0) {
                    throw new ss["b"]("writer-wrap-element-not-empty: Element to wrap with is not empty.", this)
                }
                if (i.parent !== null) {
                    throw new ss["b"]("writer-wrap-element-attached: Element to wrap with is already attached to tree model.", this)
                }
                this.insert(i, t.start);
                const n = new $h(t.start.getShiftedBy(1), t.end.getShiftedBy(1));
                this.move(n, Uh._createAt(i, 0))
            }

            unwrap(t) {
                this._assertWriterUsedCorrectly();
                if (t.parent === null) {
                    throw new ss["b"]("writer-unwrap-element-no-parent: Trying to unwrap an element which has no parent.", this)
                }
                this.move($h._createIn(t), this.createPositionAfter(t));
                this.remove(t)
            }

            addMarker(t, e) {
                this._assertWriterUsedCorrectly();
                if (!e || typeof e.usingOperation != "boolean") {
                    throw new ss["b"]("writer-addMarker-no-usingOperation: The options.usingOperation parameter is required when adding a new marker.", this)
                }
                const i = e.usingOperation;
                const n = e.range;
                const o = e.affectsData === undefined ? false : e.affectsData;
                if (this.model.markers.has(t)) {
                    throw new ss["b"]("writer-addMarker-marker-exists: Marker with provided name already exists.", this)
                }
                if (!n) {
                    throw new ss["b"]("writer-addMarker-no-range: Range parameter is required when adding a new marker.", this)
                }
                if (!i) {
                    return this.model.markers._set(t, n, i, o)
                }
                dm(this, t, null, n, o);
                return this.model.markers.get(t)
            }

            updateMarker(t, e) {
                this._assertWriterUsedCorrectly();
                const i = typeof t == "string" ? t : t.name;
                const n = this.model.markers.get(i);
                if (!n) {
                    throw new ss["b"]("writer-updateMarker-marker-not-exists: Marker with provided name does not exists.", this)
                }
                if (!e) {
                    this.model.markers._refresh(n);
                    return
                }
                const o = typeof e.usingOperation == "boolean";
                const r = typeof e.affectsData == "boolean";
                const s = r ? e.affectsData : n.affectsData;
                if (!o && !e.range && !r) {
                    throw new ss["b"]("writer-updateMarker-wrong-options: One of the options is required - provide range, usingOperations or affectsData.", this)
                }
                const a = n.getRange();
                const c = e.range ? e.range : a;
                if (o && e.usingOperation !== n.managedUsingOperations) {
                    if (e.usingOperation) {
                        dm(this, i, null, c, s)
                    } else {
                        dm(this, i, a, null, s);
                        this.model.markers._set(i, c, undefined, s)
                    }
                    return
                }
                if (n.managedUsingOperations) {
                    dm(this, i, a, c, s)
                } else {
                    this.model.markers._set(i, c, undefined, s)
                }
            }

            removeMarker(t) {
                this._assertWriterUsedCorrectly();
                const e = typeof t == "string" ? t : t.name;
                if (!this.model.markers.has(e)) {
                    throw new ss["b"]("writer-removeMarker-no-marker: Trying to remove marker which does not exist.", this)
                }
                const i = this.model.markers.get(e);
                if (!i.managedUsingOperations) {
                    this.model.markers._remove(e);
                    return
                }
                const n = i.getRange();
                dm(this, e, n, null, i.affectsData)
            }

            setSelection(t, e, i) {
                this._assertWriterUsedCorrectly();
                this.model.document.selection._setTo(t, e, i)
            }

            setSelectionFocus(t, e) {
                this._assertWriterUsedCorrectly();
                this.model.document.selection._setFocus(t, e)
            }

            setSelectionAttribute(t, e) {
                this._assertWriterUsedCorrectly();
                if (typeof t === "string") {
                    this._setSelectionAttribute(t, e)
                } else {
                    for (const [e, i] of Hs(t)) {
                        this._setSelectionAttribute(e, i)
                    }
                }
            }

            removeSelectionAttribute(t) {
                this._assertWriterUsedCorrectly();
                if (typeof t === "string") {
                    this._removeSelectionAttribute(t)
                } else {
                    for (const e of t) {
                        this._removeSelectionAttribute(e)
                    }
                }
            }

            overrideSelectionGravity() {
                return this.model.document.selection._overrideGravity()
            }

            restoreSelectionGravity(t) {
                this.model.document.selection._restoreGravity(t)
            }

            _setSelectionAttribute(t, e) {
                const i = this.model.document.selection;
                if (i.isCollapsed && i.anchor.parent.isEmpty) {
                    const n = df._getStoreAttributeKey(t);
                    this.setAttribute(n, e, i.anchor.parent)
                }
                i._setAttribute(t, e)
            }

            _removeSelectionAttribute(t) {
                const e = this.model.document.selection;
                if (e.isCollapsed && e.anchor.parent.isEmpty) {
                    const i = df._getStoreAttributeKey(t);
                    this.removeAttribute(i, e.anchor.parent)
                }
                e._removeAttribute(t)
            }

            _assertWriterUsedCorrectly() {
                if (this.model._currentWriter !== this) {
                    throw new ss["b"]("writer-incorrect-use: Trying to use a writer outside the change() block.", this)
                }
            }

            _addOperationForAffectedMarkers(t, e) {
                for (const i of this.model.markers) {
                    if (!i.managedUsingOperations) {
                        continue
                    }
                    const n = i.getRange();
                    let o = false;
                    if (t == "move") {
                        o = e.containsPosition(n.start) || e.start.isEqual(n.start) || e.containsPosition(n.end) || e.end.isEqual(n.end)
                    } else {
                        const t = e.nodeBefore;
                        const i = e.nodeAfter;
                        const r = n.start.parent == t && n.start.isAtEnd;
                        const s = n.end.parent == i && n.end.offset == 0;
                        const a = n.end.nodeAfter == i;
                        const c = n.start.nodeAfter == i;
                        o = r || s || a || c
                    }
                    if (o) {
                        this.updateMarker(i.name, {range: n})
                    }
                }
            }
        }

        function cm(t, e, i, n) {
            const o = t.model;
            const r = o.document;
            let s = n.start;
            let a;
            let c;
            let l;
            for (const t of n.getWalker({shallow: true})) {
                l = t.item.getAttribute(e);
                if (a && c != l) {
                    if (c != i) {
                        d()
                    }
                    s = a
                }
                a = t.nextPosition;
                c = l
            }
            if (a instanceof Uh && a != s && c != i) {
                d()
            }

            function d() {
                const n = new $h(s, a);
                const l = n.root.document ? r.version : null;
                const d = new Qg(n, e, c, i, l);
                t.batch.addOperation(d);
                o.applyOperation(d)
            }
        }

        function lm(t, e, i, n) {
            const o = t.model;
            const r = o.document;
            const s = n.getAttribute(e);
            let a, c;
            if (s != i) {
                const l = n.root === n;
                if (l) {
                    const t = n.document ? r.version : null;
                    c = new nm(n, e, s, i, t)
                } else {
                    a = new $h(Uh._createBefore(n), t.createPositionAfter(n));
                    const o = a.root.document ? r.version : null;
                    c = new Qg(a, e, s, i, o)
                }
                t.batch.addOperation(c);
                o.applyOperation(c)
            }
        }

        function dm(t, e, i, n, o) {
            const r = t.model;
            const s = r.document;
            const a = new em(e, i, n, r.markers, o, s.version);
            t.batch.addOperation(a);
            r.applyOperation(a)
        }

        function um(t, e, i, n) {
            let o;
            if (t.root.document) {
                const i = n.document;
                const r = new Uh(i.graveyard, [0]);
                o = new Zg(t, e, r, i.version)
            } else {
                o = new Xg(t, e)
            }
            i.addOperation(o);
            n.applyOperation(o)
        }

        function hm(t, e) {
            if (t === e) {
                return true
            }
            if (t instanceof sm && e instanceof sm) {
                return true
            }
            return false
        }

        class fm {
            constructor(t) {
                this._markerCollection = t;
                this._changesInElement = new Map;
                this._elementSnapshots = new Map;
                this._changedMarkers = new Map;
                this._changeCount = 0;
                this._cachedChanges = null;
                this._cachedChangesWithGraveyard = null
            }

            get isEmpty() {
                return this._changesInElement.size == 0 && this._changedMarkers.size == 0
            }

            refreshItem(t) {
                if (this._isInInsertedElement(t.parent)) {
                    return
                }
                this._markRemove(t.parent, t.startOffset, t.offsetSize);
                this._markInsert(t.parent, t.startOffset, t.offsetSize);
                const e = $h._createOn(t);
                for (const t of this._markerCollection.getMarkersIntersectingRange(e)) {
                    const e = t.getRange();
                    this.bufferMarkerChange(t.name, e, e, t.affectsData)
                }
                this._cachedChanges = null
            }

            bufferOperation(t) {
                switch (t.type) {
                    case"insert": {
                        if (this._isInInsertedElement(t.position.parent)) {
                            return
                        }
                        this._markInsert(t.position.parent, t.position.offset, t.nodes.maxOffset);
                        break
                    }
                    case"addAttribute":
                    case"removeAttribute":
                    case"changeAttribute": {
                        for (const e of t.range.getItems({shallow: true})) {
                            if (this._isInInsertedElement(e.parent)) {
                                continue
                            }
                            this._markAttribute(e)
                        }
                        break
                    }
                    case"remove":
                    case"move":
                    case"reinsert": {
                        if (t.sourcePosition.isEqual(t.targetPosition) || t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition)) {
                            return
                        }
                        const e = this._isInInsertedElement(t.sourcePosition.parent);
                        const i = this._isInInsertedElement(t.targetPosition.parent);
                        if (!e) {
                            this._markRemove(t.sourcePosition.parent, t.sourcePosition.offset, t.howMany)
                        }
                        if (!i) {
                            this._markInsert(t.targetPosition.parent, t.getMovedRangeStart().offset, t.howMany)
                        }
                        break
                    }
                    case"rename": {
                        if (this._isInInsertedElement(t.position.parent)) {
                            return
                        }
                        this._markRemove(t.position.parent, t.position.offset, 1);
                        this._markInsert(t.position.parent, t.position.offset, 1);
                        const e = $h._createFromPositionAndShift(t.position, 1);
                        for (const t of this._markerCollection.getMarkersIntersectingRange(e)) {
                            const e = t.getRange();
                            this.bufferMarkerChange(t.name, e, e, t.affectsData)
                        }
                        break
                    }
                    case"split": {
                        const e = t.splitPosition.parent;
                        if (!this._isInInsertedElement(e)) {
                            this._markRemove(e, t.splitPosition.offset, t.howMany)
                        }
                        if (!this._isInInsertedElement(t.insertionPosition.parent)) {
                            this._markInsert(t.insertionPosition.parent, t.insertionPosition.offset, 1)
                        }
                        if (t.graveyardPosition) {
                            this._markRemove(t.graveyardPosition.parent, t.graveyardPosition.offset, 1)
                        }
                        break
                    }
                    case"merge": {
                        const e = t.sourcePosition.parent;
                        if (!this._isInInsertedElement(e.parent)) {
                            this._markRemove(e.parent, e.startOffset, 1)
                        }
                        const i = t.graveyardPosition.parent;
                        this._markInsert(i, t.graveyardPosition.offset, 1);
                        const n = t.targetPosition.parent;
                        if (!this._isInInsertedElement(n)) {
                            this._markInsert(n, t.targetPosition.offset, e.maxOffset)
                        }
                        break
                    }
                }
                this._cachedChanges = null
            }

            bufferMarkerChange(t, e, i, n) {
                const o = this._changedMarkers.get(t);
                if (!o) {
                    this._changedMarkers.set(t, {oldRange: e, newRange: i, affectsData: n})
                } else {
                    o.newRange = i;
                    o.affectsData = n;
                    if (o.oldRange == null && o.newRange == null) {
                        this._changedMarkers.delete(t)
                    }
                }
            }

            getMarkersToRemove() {
                const t = [];
                for (const [e, i] of this._changedMarkers) {
                    if (i.oldRange != null) {
                        t.push({name: e, range: i.oldRange})
                    }
                }
                return t
            }

            getMarkersToAdd() {
                const t = [];
                for (const [e, i] of this._changedMarkers) {
                    if (i.newRange != null) {
                        t.push({name: e, range: i.newRange})
                    }
                }
                return t
            }

            getChangedMarkers() {
                return Array.from(this._changedMarkers).map(t => ({
                    name: t[0],
                    data: {oldRange: t[1].oldRange, newRange: t[1].newRange}
                }))
            }

            hasDataChanges() {
                for (const [, t] of this._changedMarkers) {
                    if (t.affectsData) {
                        return true
                    }
                }
                return this._changesInElement.size > 0
            }

            getChanges(t = {includeChangesInGraveyard: false}) {
                if (this._cachedChanges) {
                    if (t.includeChangesInGraveyard) {
                        return this._cachedChangesWithGraveyard.slice()
                    } else {
                        return this._cachedChanges.slice()
                    }
                }
                const e = [];
                for (const t of this._changesInElement.keys()) {
                    const i = this._changesInElement.get(t).sort((t, e) => {
                        if (t.offset === e.offset) {
                            if (t.type != e.type) {
                                return t.type == "remove" ? -1 : 1
                            }
                            return 0
                        }
                        return t.offset < e.offset ? -1 : 1
                    });
                    const n = this._elementSnapshots.get(t);
                    const o = gm(t.getChildren());
                    const r = mm(n.length, i);
                    let s = 0;
                    let a = 0;
                    for (const i of r) {
                        if (i === "i") {
                            e.push(this._getInsertDiff(t, s, o[s].name));
                            s++
                        } else if (i === "r") {
                            e.push(this._getRemoveDiff(t, s, n[a].name));
                            a++
                        } else if (i === "a") {
                            const i = o[s].attributes;
                            const r = n[a].attributes;
                            let c;
                            if (o[s].name == "$text") {
                                c = new $h(Uh._createAt(t, s), Uh._createAt(t, s + 1))
                            } else {
                                const e = t.offsetToIndex(s);
                                c = new $h(Uh._createAt(t, s), Uh._createAt(t.getChild(e), 0))
                            }
                            e.push(...this._getAttributesDiff(c, r, i));
                            s++;
                            a++
                        } else {
                            s++;
                            a++
                        }
                    }
                }
                e.sort((t, e) => {
                    if (t.position.root != e.position.root) {
                        return t.position.root.rootName < e.position.root.rootName ? -1 : 1
                    }
                    if (t.position.isEqual(e.position)) {
                        return t.changeCount - e.changeCount
                    }
                    return t.position.isBefore(e.position) ? -1 : 1
                });
                for (let t = 1; t < e.length; t++) {
                    const i = e[t - 1];
                    const n = e[t];
                    const o = i.type == "remove" && n.type == "remove" && i.name == "$text" && n.name == "$text" && i.position.isEqual(n.position);
                    const r = i.type == "insert" && n.type == "insert" && i.name == "$text" && n.name == "$text" && i.position.parent == n.position.parent && i.position.offset + i.length == n.position.offset;
                    const s = i.type == "attribute" && n.type == "attribute" && i.position.parent == n.position.parent && i.range.isFlat && n.range.isFlat && i.position.offset + i.length == n.position.offset && i.attributeKey == n.attributeKey && i.attributeOldValue == n.attributeOldValue && i.attributeNewValue == n.attributeNewValue;
                    if (o || r || s) {
                        e[t - 1].length++;
                        if (s) {
                            e[t - 1].range.end = e[t - 1].range.end.getShiftedBy(1)
                        }
                        e.splice(t, 1);
                        t--
                    }
                }
                for (const t of e) {
                    delete t.changeCount;
                    if (t.type == "attribute") {
                        delete t.position;
                        delete t.length
                    }
                }
                this._changeCount = 0;
                this._cachedChangesWithGraveyard = e.slice();
                this._cachedChanges = e.slice().filter(pm);
                if (t.includeChangesInGraveyard) {
                    return this._cachedChangesWithGraveyard
                } else {
                    return this._cachedChanges
                }
            }

            reset() {
                this._changesInElement.clear();
                this._elementSnapshots.clear();
                this._changedMarkers.clear();
                this._cachedChanges = null
            }

            _markInsert(t, e, i) {
                const n = {type: "insert", offset: e, howMany: i, count: this._changeCount++};
                this._markChange(t, n)
            }

            _markRemove(t, e, i) {
                const n = {type: "remove", offset: e, howMany: i, count: this._changeCount++};
                this._markChange(t, n);
                this._removeAllNestedChanges(t, e, i)
            }

            _markAttribute(t) {
                const e = {type: "attribute", offset: t.startOffset, howMany: t.offsetSize, count: this._changeCount++};
                this._markChange(t.parent, e)
            }

            _markChange(t, e) {
                this._makeSnapshot(t);
                const i = this._getChangesForElement(t);
                this._handleChange(e, i);
                i.push(e);
                for (let t = 0; t < i.length; t++) {
                    if (i[t].howMany < 1) {
                        i.splice(t, 1);
                        t--
                    }
                }
            }

            _getChangesForElement(t) {
                let e;
                if (this._changesInElement.has(t)) {
                    e = this._changesInElement.get(t)
                } else {
                    e = [];
                    this._changesInElement.set(t, e)
                }
                return e
            }

            _makeSnapshot(t) {
                if (!this._elementSnapshots.has(t)) {
                    this._elementSnapshots.set(t, gm(t.getChildren()))
                }
            }

            _handleChange(t, e) {
                t.nodesToHandle = t.howMany;
                for (const i of e) {
                    const n = t.offset + t.howMany;
                    const o = i.offset + i.howMany;
                    if (t.type == "insert") {
                        if (i.type == "insert") {
                            if (t.offset <= i.offset) {
                                i.offset += t.howMany
                            } else if (t.offset < o) {
                                i.howMany += t.nodesToHandle;
                                t.nodesToHandle = 0
                            }
                        }
                        if (i.type == "remove") {
                            if (t.offset < i.offset) {
                                i.offset += t.howMany
                            }
                        }
                        if (i.type == "attribute") {
                            if (t.offset <= i.offset) {
                                i.offset += t.howMany
                            } else if (t.offset < o) {
                                const o = i.howMany;
                                i.howMany = t.offset - i.offset;
                                e.unshift({
                                    type: "attribute",
                                    offset: n,
                                    howMany: o - i.howMany,
                                    count: this._changeCount++
                                })
                            }
                        }
                    }
                    if (t.type == "remove") {
                        if (i.type == "insert") {
                            if (n <= i.offset) {
                                i.offset -= t.howMany
                            } else if (n <= o) {
                                if (t.offset < i.offset) {
                                    const e = n - i.offset;
                                    i.offset = t.offset;
                                    i.howMany -= e;
                                    t.nodesToHandle -= e
                                } else {
                                    i.howMany -= t.nodesToHandle;
                                    t.nodesToHandle = 0
                                }
                            } else {
                                if (t.offset <= i.offset) {
                                    t.nodesToHandle -= i.howMany;
                                    i.howMany = 0
                                } else if (t.offset < o) {
                                    const e = o - t.offset;
                                    i.howMany -= e;
                                    t.nodesToHandle -= e
                                }
                            }
                        }
                        if (i.type == "remove") {
                            if (n <= i.offset) {
                                i.offset -= t.howMany
                            } else if (t.offset < i.offset) {
                                t.nodesToHandle += i.howMany;
                                i.howMany = 0
                            }
                        }
                        if (i.type == "attribute") {
                            if (n <= i.offset) {
                                i.offset -= t.howMany
                            } else if (t.offset < i.offset) {
                                const e = n - i.offset;
                                i.offset = t.offset;
                                i.howMany -= e
                            } else if (t.offset < o) {
                                if (n <= o) {
                                    const n = i.howMany;
                                    i.howMany = t.offset - i.offset;
                                    const o = n - i.howMany - t.nodesToHandle;
                                    e.unshift({
                                        type: "attribute",
                                        offset: t.offset,
                                        howMany: o,
                                        count: this._changeCount++
                                    })
                                } else {
                                    i.howMany -= o - t.offset
                                }
                            }
                        }
                    }
                    if (t.type == "attribute") {
                        if (i.type == "insert") {
                            if (t.offset < i.offset && n > i.offset) {
                                if (n > o) {
                                    const t = {
                                        type: "attribute",
                                        offset: o,
                                        howMany: n - o,
                                        count: this._changeCount++
                                    };
                                    this._handleChange(t, e);
                                    e.push(t)
                                }
                                t.nodesToHandle = i.offset - t.offset;
                                t.howMany = t.nodesToHandle
                            } else if (t.offset >= i.offset && t.offset < o) {
                                if (n > o) {
                                    t.nodesToHandle = n - o;
                                    t.offset = o
                                } else {
                                    t.nodesToHandle = 0
                                }
                            }
                        }
                        if (i.type == "remove") {
                            if (t.offset < i.offset && n > i.offset) {
                                const o = {
                                    type: "attribute",
                                    offset: i.offset,
                                    howMany: n - i.offset,
                                    count: this._changeCount++
                                };
                                this._handleChange(o, e);
                                e.push(o);
                                t.nodesToHandle = i.offset - t.offset;
                                t.howMany = t.nodesToHandle
                            }
                        }
                        if (i.type == "attribute") {
                            if (t.offset >= i.offset && n <= o) {
                                t.nodesToHandle = 0;
                                t.howMany = 0;
                                t.offset = 0
                            } else if (t.offset <= i.offset && n >= o) {
                                i.howMany = 0
                            }
                        }
                    }
                }
                t.howMany = t.nodesToHandle;
                delete t.nodesToHandle
            }

            _getInsertDiff(t, e, i) {
                return {
                    type: "insert",
                    position: Uh._createAt(t, e),
                    name: i,
                    length: 1,
                    changeCount: this._changeCount++
                }
            }

            _getRemoveDiff(t, e, i) {
                return {
                    type: "remove",
                    position: Uh._createAt(t, e),
                    name: i,
                    length: 1,
                    changeCount: this._changeCount++
                }
            }

            _getAttributesDiff(t, e, i) {
                const n = [];
                i = new Map(i);
                for (const [o, r] of e) {
                    const e = i.has(o) ? i.get(o) : null;
                    if (e !== r) {
                        n.push({
                            type: "attribute",
                            position: t.start,
                            range: t.clone(),
                            length: 1,
                            attributeKey: o,
                            attributeOldValue: r,
                            attributeNewValue: e,
                            changeCount: this._changeCount++
                        })
                    }
                    i.delete(o)
                }
                for (const [e, o] of i) {
                    n.push({
                        type: "attribute",
                        position: t.start,
                        range: t.clone(),
                        length: 1,
                        attributeKey: e,
                        attributeOldValue: null,
                        attributeNewValue: o,
                        changeCount: this._changeCount++
                    })
                }
                return n
            }

            _isInInsertedElement(t) {
                const e = t.parent;
                if (!e) {
                    return false
                }
                const i = this._changesInElement.get(e);
                const n = t.startOffset;
                if (i) {
                    for (const t of i) {
                        if (t.type == "insert" && n >= t.offset && n < t.offset + t.howMany) {
                            return true
                        }
                    }
                }
                return this._isInInsertedElement(e)
            }

            _removeAllNestedChanges(t, e, i) {
                const n = new $h(Uh._createAt(t, e), Uh._createAt(t, e + i));
                for (const t of n.getItems({shallow: true})) {
                    if (t.is("element")) {
                        this._elementSnapshots.delete(t);
                        this._changesInElement.delete(t);
                        this._removeAllNestedChanges(t, 0, t.maxOffset)
                    }
                }
            }
        }

        function gm(t) {
            const e = [];
            for (const i of t) {
                if (i.is("text")) {
                    for (let t = 0; t < i.data.length; t++) {
                        e.push({name: "$text", attributes: new Map(i.getAttributes())})
                    }
                } else {
                    e.push({name: i.name, attributes: new Map(i.getAttributes())})
                }
            }
            return e
        }

        function mm(t, e) {
            const i = [];
            let n = 0;
            let o = 0;
            for (const t of e) {
                if (t.offset > n) {
                    for (let e = 0; e < t.offset - n; e++) {
                        i.push("e")
                    }
                    o += t.offset - n
                }
                if (t.type == "insert") {
                    for (let e = 0; e < t.howMany; e++) {
                        i.push("i")
                    }
                    n = t.offset + t.howMany
                } else if (t.type == "remove") {
                    for (let e = 0; e < t.howMany; e++) {
                        i.push("r")
                    }
                    n = t.offset;
                    o += t.howMany
                } else {
                    i.push(..."a".repeat(t.howMany).split(""));
                    n = t.offset + t.howMany;
                    o += t.howMany
                }
            }
            if (o < t) {
                for (let e = 0; e < t - o - n; e++) {
                    i.push("e")
                }
            }
            return i
        }

        function pm(t) {
            const e = t.position && t.position.root.rootName == "$graveyard";
            const i = t.range && t.range.root.rootName == "$graveyard";
            return !e && !i
        }

        class bm {
            constructor() {
                this._operations = [];
                this._undoPairs = new Map;
                this._undoneOperations = new Set
            }

            addOperation(t) {
                if (this._operations.includes(t)) {
                    return
                }
                this._operations.push(t)
            }

            getOperations(t = 0, e = Number.POSITIVE_INFINITY) {
                if (t < 0) {
                    return []
                }
                return this._operations.slice(t, e)
            }

            getOperation(t) {
                return this._operations[t]
            }

            setOperationAsUndone(t, e) {
                this._undoPairs.set(e, t);
                this._undoneOperations.add(t)
            }

            isUndoingOperation(t) {
                return this._undoPairs.has(t)
            }

            isUndoneOperation(t) {
                return this._undoneOperations.has(t)
            }

            getUndoneOperation(t) {
                return this._undoPairs.get(t)
            }
        }

        function wm(t) {
            return !!t && t.length == 1 && /[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(t)
        }

        function km(t) {
            return !!t && t.length == 1 && /[\ud800-\udbff]/.test(t)
        }

        function _m(t) {
            return !!t && t.length == 1 && /[\udc00-\udfff]/.test(t)
        }

        function vm(t, e) {
            return km(t.charAt(e - 1)) && _m(t.charAt(e))
        }

        function ym(t, e) {
            return wm(t.charAt(e))
        }

        const xm = "$graveyard";

        class Cm {
            constructor(t) {
                this.model = t;
                this.version = 0;
                this.history = new bm(this);
                this.selection = new df(this);
                this.roots = new ys({idProperty: "rootName"});
                this.differ = new fm(t.markers);
                this._postFixers = new Set;
                this._hasSelectionChangedFromTheLastChangeBlock = false;
                this.createRoot("$root", xm);
                this.listenTo(t, "applyOperation", (t, e) => {
                    const i = e[0];
                    if (i.isDocumentOperation && i.baseVersion !== this.version) {
                        throw new ss["b"]("model-document-applyOperation-wrong-version: Only operations with matching versions can be applied.", this, {operation: i})
                    }
                }, {priority: "highest"});
                this.listenTo(t, "applyOperation", (t, e) => {
                    const i = e[0];
                    if (i.isDocumentOperation) {
                        this.differ.bufferOperation(i)
                    }
                }, {priority: "high"});
                this.listenTo(t, "applyOperation", (t, e) => {
                    const i = e[0];
                    if (i.isDocumentOperation) {
                        this.version++;
                        this.history.addOperation(i)
                    }
                }, {priority: "low"});
                this.listenTo(this.selection, "change", () => {
                    this._hasSelectionChangedFromTheLastChangeBlock = true
                });
                this.listenTo(t.markers, "update", (t, e, i, n) => {
                    this.differ.bufferMarkerChange(e.name, i, n, e.affectsData);
                    if (i === null) {
                        e.on("change", (t, i) => {
                            this.differ.bufferMarkerChange(e.name, i, e.getRange(), e.affectsData)
                        })
                    }
                })
            }

            get graveyard() {
                return this.getRoot(xm)
            }

            createRoot(t = "$root", e = "main") {
                if (this.roots.get(e)) {
                    throw new ss["b"]("model-document-createRoot-name-exists: Root with specified name already exists.", this, {name: e})
                }
                const i = new sm(this, t, e);
                this.roots.add(i);
                return i
            }

            destroy() {
                this.selection.destroy();
                this.stopListening()
            }

            getRoot(t = "main") {
                return this.roots.get(t)
            }

            getRootNames() {
                return Array.from(this.roots, t => t.rootName).filter(t => t != xm)
            }

            registerPostFixer(t) {
                this._postFixers.add(t)
            }

            toJSON() {
                const t = Bs(this);
                t.selection = "[engine.model.DocumentSelection]";
                t.model = "[engine.model.Model]";
                return t
            }

            _handleChangeBlock(t) {
                if (this._hasDocumentChangedFromTheLastChangeBlock()) {
                    this._callPostFixers(t);
                    this.selection.refresh();
                    if (this.differ.hasDataChanges()) {
                        this.fire("change:data", t.batch)
                    } else {
                        this.fire("change", t.batch)
                    }
                    this.selection.refresh();
                    this.differ.reset()
                }
                this._hasSelectionChangedFromTheLastChangeBlock = false
            }

            _hasDocumentChangedFromTheLastChangeBlock() {
                return !this.differ.isEmpty || this._hasSelectionChangedFromTheLastChangeBlock
            }

            _getDefaultRoot() {
                for (const t of this.roots) {
                    if (t !== this.graveyard) {
                        return t
                    }
                }
                return this.graveyard
            }

            _getDefaultRange() {
                const t = this._getDefaultRoot();
                const e = this.model;
                const i = e.schema;
                const n = e.createPositionFromPath(t, [0]);
                const o = i.getNearestSelectionRange(n);
                return o || e.createRange(n)
            }

            _validateSelectionRange(t) {
                return Am(t.start) && Am(t.end)
            }

            _callPostFixers(t) {
                let e = false;
                do {
                    for (const i of this._postFixers) {
                        this.selection.refresh();
                        e = i(t);
                        if (e) {
                            break
                        }
                    }
                } while (e)
            }
        }

        vs(Cm, ds);

        function Am(t) {
            const e = t.textNode;
            if (e) {
                const i = e.data;
                const n = t.offset - e.startOffset;
                return !vm(i, n) && !ym(i, n)
            }
            return true
        }

        class Tm {
            constructor() {
                this._markers = new Map
            }

            [Symbol.iterator]() {
                return this._markers.values()
            }

            has(t) {
                return this._markers.has(t)
            }

            get(t) {
                return this._markers.get(t) || null
            }

            _set(t, e, i = false, n = false) {
                const o = t instanceof Pm ? t.name : t;
                const r = this._markers.get(o);
                if (r) {
                    const t = r.getRange();
                    let s = false;
                    if (!t.isEqual(e)) {
                        r._attachLiveRange(rf.fromRange(e));
                        s = true
                    }
                    if (i != r.managedUsingOperations) {
                        r._managedUsingOperations = i;
                        s = true
                    }
                    if (typeof n === "boolean" && n != r.affectsData) {
                        r._affectsData = n;
                        s = true
                    }
                    if (s) {
                        this.fire("update:" + o, r, t, e)
                    }
                    return r
                }
                const s = rf.fromRange(e);
                const a = new Pm(o, s, i, n);
                this._markers.set(o, a);
                this.fire("update:" + o, a, null, e);
                return a
            }

            _remove(t) {
                const e = t instanceof Pm ? t.name : t;
                const i = this._markers.get(e);
                if (i) {
                    this._markers.delete(e);
                    this.fire("update:" + e, i, i.getRange(), null);
                    this._destroyMarker(i);
                    return true
                }
                return false
            }

            _refresh(t) {
                const e = t instanceof Pm ? t.name : t;
                const i = this._markers.get(e);
                if (!i) {
                    throw new ss["b"]("markercollection-refresh-marker-not-exists: Marker with provided name does not exists.", this)
                }
                const n = i.getRange();
                this.fire("update:" + e, i, n, n, i.managedUsingOperations, i.affectsData)
            }

            * getMarkersAtPosition(t) {
                for (const e of this) {
                    if (e.getRange().containsPosition(t)) {
                        yield e
                    }
                }
            }

            * getMarkersIntersectingRange(t) {
                for (const e of this) {
                    if (e.getRange().getIntersection(t) !== null) {
                        yield e
                    }
                }
            }

            destroy() {
                for (const t of this._markers.values()) {
                    this._destroyMarker(t)
                }
                this._markers = null;
                this.stopListening()
            }

            * getMarkersGroup(t) {
                for (const e of this._markers.values()) {
                    if (e.name.startsWith(t + ":")) {
                        yield e
                    }
                }
            }

            _destroyMarker(t) {
                t.stopListening();
                t._detachLiveRange()
            }
        }

        vs(Tm, ds);

        class Pm {
            constructor(t, e, i, n) {
                this.name = t;
                this._liveRange = this._attachLiveRange(e);
                this._managedUsingOperations = i;
                this._affectsData = n
            }

            get managedUsingOperations() {
                if (!this._liveRange) {
                    throw new ss["b"]("marker-destroyed: Cannot use a destroyed marker instance.", this)
                }
                return this._managedUsingOperations
            }

            get affectsData() {
                if (!this._liveRange) {
                    throw new ss["b"]("marker-destroyed: Cannot use a destroyed marker instance.", this)
                }
                return this._affectsData
            }

            getStart() {
                if (!this._liveRange) {
                    throw new ss["b"]("marker-destroyed: Cannot use a destroyed marker instance.", this)
                }
                return this._liveRange.start.clone()
            }

            getEnd() {
                if (!this._liveRange) {
                    throw new ss["b"]("marker-destroyed: Cannot use a destroyed marker instance.", this)
                }
                return this._liveRange.end.clone()
            }

            getRange() {
                if (!this._liveRange) {
                    throw new ss["b"]("marker-destroyed: Cannot use a destroyed marker instance.", this)
                }
                return this._liveRange.toRange()
            }

            is(t) {
                return t == "marker" || t == "model:marker"
            }

            _attachLiveRange(t) {
                if (this._liveRange) {
                    this._detachLiveRange()
                }
                t.delegate("change:range").to(this);
                t.delegate("change:content").to(this);
                this._liveRange = t;
                return t
            }

            _detachLiveRange() {
                this._liveRange.stopDelegating("change:range", this);
                this._liveRange.stopDelegating("change:content", this);
                this._liveRange.detach();
                this._liveRange = null
            }
        }

        vs(Pm, ds);

        class Sm extends Lg {
            get type() {
                return "noop"
            }

            clone() {
                return new Sm(this.baseVersion)
            }

            getReversed() {
                return new Sm(this.baseVersion + 1)
            }

            _execute() {
            }

            static get className() {
                return "NoOperation"
            }
        }

        const Em = {};
        Em[Qg.className] = Qg;
        Em[tm.className] = tm;
        Em[em.className] = em;
        Em[Zg.className] = Zg;
        Em[Sm.className] = Sm;
        Em[Lg.className] = Lg;
        Em[im.className] = im;
        Em[nm.className] = nm;
        Em[rm.className] = rm;
        Em[om.className] = om;

        class Rm {
            static fromJSON(t, e) {
                return Em[t.__className].fromJSON(t, e)
            }
        }

        class Om extends Uh {
            constructor(t, e, i = "toNone") {
                super(t, e, i);
                if (!this.root.is("rootElement")) {
                    throw new ss["b"]("model-liveposition-root-not-rootelement: LivePosition's root has to be an instance of RootElement.", t)
                }
                Im.call(this)
            }

            detach() {
                this.stopListening()
            }

            is(t) {
                return t == "livePosition" || t == "model:livePosition" || super.is(t)
            }

            toPosition() {
                return new Uh(this.root, this.path.slice(), this.stickiness)
            }

            static fromPosition(t, e) {
                return new this(t.root, t.path.slice(), e ? e : t.stickiness)
            }
        }

        function Im() {
            this.listenTo(this.root.document.model, "applyOperation", (t, e) => {
                const i = e[0];
                if (!i.isDocumentOperation) {
                    return
                }
                Vm.call(this, i)
            }, {priority: "low"})
        }

        function Vm(t) {
            const e = this.getTransformedByOperation(t);
            if (!this.isEqual(e)) {
                const t = this.toPosition();
                this.path = e.path;
                this.root = e.root;
                this.fire("change", t)
            }
        }

        vs(Om, ds);

        function Nm(t, e, i, n) {
            return t.change(o => {
                let r;
                if (!i) {
                    r = t.document.selection
                } else if (i instanceof Xh || i instanceof df) {
                    r = i
                } else {
                    r = o.createSelection(i, n)
                }
                if (!r.isCollapsed) {
                    t.deleteContent(r, {doNotAutoparagraph: true})
                }
                const s = new Mm(t, o, r.anchor);
                let a;
                if (e.is("documentFragment")) {
                    a = e.getChildren()
                } else {
                    a = [e]
                }
                s.handleNodes(a, {isFirst: true, isLast: true});
                const c = s.getSelectionRange();
                if (c) {
                    if (r instanceof df) {
                        o.setSelection(c)
                    } else {
                        r.setTo(c)
                    }
                } else {
                }
                const l = s.getAffectedRange() || t.createRange(r.anchor);
                s.destroy();
                return l
            })
        }

        class Mm {
            constructor(t, e, i) {
                this.model = t;
                this.writer = e;
                this.position = i;
                this.canMergeWith = new Set([this.position.parent]);
                this.schema = t.schema;
                this._filterAttributesOf = [];
                this._affectedStart = null;
                this._affectedEnd = null
            }

            handleNodes(t, e) {
                t = Array.from(t);
                for (let i = 0; i < t.length; i++) {
                    const n = t[i];
                    this._handleNode(n, {isFirst: i === 0 && e.isFirst, isLast: i === t.length - 1 && e.isLast})
                }
                this.schema.removeDisallowedAttributes(this._filterAttributesOf, this.writer);
                this._filterAttributesOf = []
            }

            getSelectionRange() {
                if (this.nodeToSelect) {
                    return $h._createOn(this.nodeToSelect)
                }
                return this.model.schema.getNearestSelectionRange(this.position)
            }

            getAffectedRange() {
                if (!this._affectedStart) {
                    return null
                }
                return new $h(this._affectedStart, this._affectedEnd)
            }

            destroy() {
                if (this._affectedStart) {
                    this._affectedStart.detach()
                }
                if (this._affectedEnd) {
                    this._affectedEnd.detach()
                }
            }

            _handleNode(t, e) {
                if (this.schema.isObject(t)) {
                    this._handleObject(t, e);
                    return
                }
                const i = this._checkAndSplitToAllowedPosition(t, e);
                if (!i) {
                    this._handleDisallowedNode(t, e);
                    return
                }
                this._insert(t);
                this._mergeSiblingsOf(t, e)
            }

            _handleObject(t, e) {
                if (this._checkAndSplitToAllowedPosition(t)) {
                    this._insert(t)
                } else {
                    this._tryAutoparagraphing(t, e)
                }
            }

            _handleDisallowedNode(t, e) {
                if (t.is("element")) {
                    this.handleNodes(t.getChildren(), e)
                } else {
                    this._tryAutoparagraphing(t, e)
                }
            }

            _insert(t) {
                if (!this.schema.checkChild(this.position, t)) {
                    throw new ss["b"]("insertcontent-wrong-position: Given node cannot be inserted on the given position.", this, {
                        node: t,
                        position: this.position
                    })
                }
                const e = Om.fromPosition(this.position, "toNext");
                this._setAffectedBoundaries(this.position);
                this.writer.insert(t, this.position);
                this.position = e.toPosition();
                e.detach();
                if (this.schema.isObject(t) && !this.schema.checkChild(this.position, "$text")) {
                    this.nodeToSelect = t
                } else {
                    this.nodeToSelect = null
                }
                this._filterAttributesOf.push(t)
            }

            _setAffectedBoundaries(t) {
                if (!this._affectedStart) {
                    this._affectedStart = Om.fromPosition(t, "toPrevious")
                }
                if (!this._affectedEnd || this._affectedEnd.isBefore(t)) {
                    if (this._affectedEnd) {
                        this._affectedEnd.detach()
                    }
                    this._affectedEnd = Om.fromPosition(t, "toNext")
                }
            }

            _mergeSiblingsOf(t, e) {
                if (!(t instanceof jh)) {
                    return
                }
                const i = this._canMergeLeft(t, e);
                const n = this._canMergeRight(t, e);
                const o = Om._createBefore(t);
                o.stickiness = "toNext";
                const r = Om._createAfter(t);
                r.stickiness = "toNext";
                if (i) {
                    const t = Om.fromPosition(this.position);
                    t.stickiness = "toNext";
                    if (this._affectedStart.isEqual(o)) {
                        this._affectedStart.detach();
                        this._affectedStart = Om._createAt(o.nodeBefore, "end", "toPrevious")
                    }
                    this.writer.merge(o);
                    if (o.isEqual(this._affectedEnd) && e.isLast) {
                        this._affectedEnd.detach();
                        this._affectedEnd = Om._createAt(o.nodeBefore, "end", "toNext")
                    }
                    this.position = t.toPosition();
                    t.detach()
                }
                if (n) {
                    if (!this.position.isEqual(r)) {
                        throw new ss["b"]("insertcontent-invalid-insertion-position", this)
                    }
                    this.position = Uh._createAt(r.nodeBefore, "end");
                    const t = Om.fromPosition(this.position, "toPrevious");
                    if (this._affectedEnd.isEqual(r)) {
                        this._affectedEnd.detach();
                        this._affectedEnd = Om._createAt(r.nodeBefore, "end", "toNext")
                    }
                    this.writer.merge(r);
                    if (r.getShiftedBy(-1).isEqual(this._affectedStart) && e.isFirst) {
                        this._affectedStart.detach();
                        this._affectedStart = Om._createAt(r.nodeBefore, 0, "toPrevious")
                    }
                    this.position = t.toPosition();
                    t.detach()
                }
                if (i || n) {
                    this._filterAttributesOf.push(this.position.parent)
                }
                o.detach();
                r.detach()
            }

            _canMergeLeft(t, e) {
                const i = t.previousSibling;
                return e.isFirst && i instanceof jh && this.canMergeWith.has(i) && this.model.schema.checkMerge(i, t)
            }

            _canMergeRight(t, e) {
                const i = t.nextSibling;
                return e.isLast && i instanceof jh && this.canMergeWith.has(i) && this.model.schema.checkMerge(t, i)
            }

            _tryAutoparagraphing(t, e) {
                const i = this.writer.createElement("paragraph");
                if (this._getAllowedIn(i, this.position.parent) && this.schema.checkChild(i, t)) {
                    i._appendChild(t);
                    this._handleNode(i, e)
                }
            }

            _checkAndSplitToAllowedPosition(t) {
                const e = this._getAllowedIn(t, this.position.parent);
                if (!e) {
                    return false
                }
                while (e != this.position.parent) {
                    if (this.schema.isLimit(this.position.parent)) {
                        return false
                    }
                    if (this.position.isAtStart) {
                        const t = this.position.parent;
                        this.position = this.writer.createPositionBefore(t);
                        if (t.isEmpty && t.parent === e) {
                            this.writer.remove(t)
                        }
                    } else if (this.position.isAtEnd) {
                        this.position = this.writer.createPositionAfter(this.position.parent)
                    } else {
                        const t = this.writer.createPositionAfter(this.position.parent);
                        this._setAffectedBoundaries(this.position);
                        this.writer.split(this.position);
                        this.position = t;
                        this.canMergeWith.add(this.position.nodeAfter)
                    }
                }
                return true
            }

            _getAllowedIn(t, e) {
                if (this.schema.checkChild(e, t)) {
                    return e
                }
                if (e.parent) {
                    return this._getAllowedIn(t, e.parent)
                }
                return null
            }
        }

        function Bm(t, e, i = {}) {
            if (e.isCollapsed) {
                return
            }
            const n = e.getFirstRange();
            if (n.root.rootName == "$graveyard") {
                return
            }
            const o = t.schema;
            t.change(t => {
                if (!i.doNotResetEntireContent && Hm(o, e)) {
                    jm(t, e, o);
                    return
                }
                const r = n.start;
                const s = Om.fromPosition(n.end, "toNext");
                if (!n.start.isTouching(n.end)) {
                    t.remove(n)
                }
                if (!i.leaveUnmerged) {
                    zm(t, r, s);
                    o.removeDisallowedAttributes(r.parent.getChildren(), t)
                }
                Wm(t, e, r);
                if (!i.doNotAutoparagraph && Lm(o, r)) {
                    Dm(t, r, e)
                }
                s.detach()
            })
        }

        function zm(t, e, i) {
            const n = e.parent;
            const o = i.parent;
            if (n == o) {
                return
            }
            if (t.model.schema.isLimit(n) || t.model.schema.isLimit(o)) {
                return
            }
            if (!Fm(e, i, t.model.schema)) {
                return
            }
            e = t.createPositionAfter(n);
            i = t.createPositionBefore(o);
            if (!i.isEqual(e)) {
                t.insert(o, e)
            }
            t.merge(e);
            while (i.parent.isEmpty) {
                const e = i.parent;
                i = t.createPositionBefore(e);
                t.remove(e)
            }
            zm(t, e, i)
        }

        function Lm(t, e) {
            const i = t.checkChild(e, "$text");
            const n = t.checkChild(e, "paragraph");
            return !i && n
        }

        function Fm(t, e, i) {
            const n = new $h(t, e);
            for (const t of n.getWalker()) {
                if (i.isLimit(t.item)) {
                    return false
                }
            }
            return true
        }

        function Dm(t, e, i) {
            const n = t.createElement("paragraph");
            t.insert(n, e);
            Wm(t, i, t.createPositionAt(n, 0))
        }

        function jm(t, e) {
            const i = t.model.schema.getLimitElement(e);
            t.remove(t.createRangeIn(i));
            Dm(t, t.createPositionAt(i, 0), e)
        }

        function Hm(t, e) {
            const i = t.getLimitElement(e);
            if (!e.containsEntireContent(i)) {
                return false
            }
            const n = e.getFirstRange();
            if (n.start.parent == n.end.parent) {
                return false
            }
            return t.checkChild(i, "paragraph")
        }

        function Wm(t, e, i) {
            if (e instanceof df) {
                t.setSelection(i)
            } else {
                e.setTo(i)
            }
        }

        const qm = ' ,.?!:;"-()';

        function Um(t, e, i = {}) {
            const n = t.schema;
            const o = i.direction != "backward";
            const r = i.unit ? i.unit : "character";
            const s = e.focus;
            const a = new Wh({boundaries: Jm(s, o), singleCharacters: true, direction: o ? "forward" : "backward"});
            const c = {walker: a, schema: n, isForward: o, unit: r};
            let l;
            while (l = a.next()) {
                if (l.done) {
                    return
                }
                const i = $m(c, l.value);
                if (i) {
                    if (e instanceof df) {
                        t.change(t => {
                            t.setSelectionFocus(i)
                        })
                    } else {
                        e.setFocus(i)
                    }
                    return
                }
            }
        }

        function $m(t, e) {
            if (e.type == "text") {
                if (t.unit === "word") {
                    return Km(t.walker, t.isForward)
                }
                return Gm(t.walker, t.unit, t.isForward)
            }
            if (e.type == (t.isForward ? "elementStart" : "elementEnd")) {
                if (t.schema.isObject(e.item)) {
                    return Uh._createAt(e.item, t.isForward ? "after" : "before")
                }
                if (t.schema.checkChild(e.nextPosition, "$text")) {
                    return e.nextPosition
                }
            } else {
                if (t.schema.isLimit(e.item)) {
                    t.walker.skip(() => true);
                    return
                }
                if (t.schema.checkChild(e.nextPosition, "$text")) {
                    return e.nextPosition
                }
            }
        }

        function Gm(t, e) {
            const i = t.position.textNode;
            if (i) {
                const n = i.data;
                let o = t.position.offset - i.startOffset;
                while (vm(n, o) || e == "character" && ym(n, o)) {
                    t.next();
                    o = t.position.offset - i.startOffset
                }
            }
            return t.position
        }

        function Km(t, e) {
            let i = t.position.textNode;
            if (i) {
                let n = t.position.offset - i.startOffset;
                while (!Ym(i.data, n, e) && !Qm(i, n, e)) {
                    t.next();
                    const o = e ? t.position.nodeAfter : t.position.nodeBefore;
                    if (o && o.is("text")) {
                        const n = o.data.charAt(e ? 0 : o.data.length - 1);
                        if (!qm.includes(n)) {
                            t.next();
                            i = t.position.textNode
                        }
                    }
                    n = t.position.offset - i.startOffset
                }
            }
            return t.position
        }

        function Jm(t, e) {
            const i = t.root;
            const n = Uh._createAt(i, e ? "end" : 0);
            if (e) {
                return new $h(t, n)
            } else {
                return new $h(n, t)
            }
        }

        function Ym(t, e, i) {
            const n = e + (i ? 0 : -1);
            return qm.includes(t.charAt(n))
        }

        function Qm(t, e, i) {
            return e === (i ? t.endOffset : 0)
        }

        function Xm(t, e) {
            return t.change(t => {
                const i = t.createDocumentFragment();
                const n = e.getFirstRange();
                if (!n || n.isCollapsed) {
                    return i
                }
                const o = n.start.root;
                const r = n.start.getCommonPath(n.end);
                const s = o.getNodeByPath(r);
                let a;
                if (n.start.parent == n.end.parent) {
                    a = n
                } else {
                    a = t.createRange(t.createPositionAt(s, n.start.path[r.length]), t.createPositionAt(s, n.end.path[r.length] + 1))
                }
                const c = a.end.offset - a.start.offset;
                for (const e of a.getItems({shallow: true})) {
                    if (e.is("textProxy")) {
                        t.appendText(e.data, e.getAttributes(), i)
                    } else {
                        t.append(e._clone(true), i)
                    }
                }
                if (a != n) {
                    const e = n._getTransformedByMove(a.start, t.createPositionAt(i, 0), c)[0];
                    const o = t.createRange(t.createPositionAt(i, 0), e.start);
                    const r = t.createRange(e.end, t.createPositionAt(i, "end"));
                    Zm(r, t);
                    Zm(o, t)
                }
                return i
            })
        }

        function Zm(t, e) {
            const i = [];
            Array.from(t.getItems({direction: "backward"})).map(t => e.createRangeOn(t)).filter(e => {
                const i = (e.start.isAfter(t.start) || e.start.isEqual(t.start)) && (e.end.isBefore(t.end) || e.end.isEqual(t.end));
                return i
            }).forEach(t => {
                i.push(t.start.parent);
                e.remove(t)
            });
            i.forEach(t => {
                let i = t;
                while (i.parent && i.isEmpty) {
                    const t = e.createRangeOn(i);
                    i = i.parent;
                    e.remove(t)
                }
            })
        }

        function tp(t) {
            t.document.registerPostFixer(e => ep(e, t))
        }

        function ep(t, e) {
            const i = e.document.selection;
            const n = e.schema;
            const o = [];
            let r = false;
            for (const t of i.getRanges()) {
                const e = ip(t, n);
                if (e) {
                    o.push(e);
                    r = true
                } else {
                    o.push(t)
                }
            }
            if (r) {
                t.setSelection(ap(o), {backward: i.isBackward})
            }
        }

        function ip(t, e) {
            if (t.isCollapsed) {
                return np(t, e)
            }
            return op(t, e)
        }

        function np(t, e) {
            const i = t.start;
            const n = e.getNearestSelectionRange(i);
            if (!n) {
                return null
            }
            if (!n.isCollapsed) {
                return n
            }
            const o = n.start;
            if (i.isEqual(o)) {
                return null
            }
            return new $h(o)
        }

        function op(t, e) {
            const i = t.start;
            const n = t.end;
            const o = e.checkChild(i, "$text");
            const r = e.checkChild(n, "$text");
            const s = e.getLimitElement(i);
            const a = e.getLimitElement(n);
            if (s === a) {
                if (o && r) {
                    return null
                }
                if (sp(i, n, e)) {
                    const t = i.nodeAfter && e.isObject(i.nodeAfter);
                    const o = t ? null : e.getNearestSelectionRange(i, "forward");
                    const r = n.nodeBefore && e.isObject(n.nodeBefore);
                    const s = r ? null : e.getNearestSelectionRange(n, "backward");
                    const a = o ? o.start : i;
                    const c = s ? s.start : n;
                    return new $h(a, c)
                }
            }
            const c = s && !s.is("rootElement");
            const l = a && !a.is("rootElement");
            if (c || l) {
                const t = i.nodeAfter && n.nodeBefore && i.nodeAfter.parent === n.nodeBefore.parent;
                const o = c && (!t || !cp(i.nodeAfter, e));
                const r = l && (!t || !cp(n.nodeBefore, e));
                let d = i;
                let u = n;
                if (o) {
                    d = Uh._createBefore(rp(s, e))
                }
                if (r) {
                    u = Uh._createAfter(rp(a, e))
                }
                return new $h(d, u)
            }
            return null
        }

        function rp(t, e) {
            let i = t;
            let n = i;
            while (e.isLimit(n) && n.parent) {
                i = n;
                n = n.parent
            }
            return i
        }

        function sp(t, e, i) {
            const n = t.nodeAfter && !i.isLimit(t.nodeAfter) || i.checkChild(t, "$text");
            const o = e.nodeBefore && !i.isLimit(e.nodeBefore) || i.checkChild(e, "$text");
            return n || o
        }

        function ap(t) {
            const e = [];
            e.push(t.shift());
            for (const i of t) {
                const t = e.pop();
                if (i.isIntersecting(t)) {
                    const n = t.start.isAfter(i.start) ? i.start : t.start;
                    const o = t.end.isAfter(i.end) ? t.end : i.end;
                    const r = new $h(n, o);
                    e.push(r)
                } else {
                    e.push(t);
                    e.push(i)
                }
            }
            return e
        }

        function cp(t, e) {
            return t && e.isObject(t)
        }

        class lp {
            constructor() {
                this.markers = new Tm;
                this.document = new Cm(this);
                this.schema = new ug;
                this._pendingChanges = [];
                this._currentWriter = null;
                ["insertContent", "deleteContent", "modifySelection", "getSelectedContent", "applyOperation"].forEach(t => this.decorate(t));
                this.on("applyOperation", (t, e) => {
                    const i = e[0];
                    i._validate()
                }, {priority: "highest"});
                this.schema.register("$root", {isLimit: true});
                this.schema.register("$block", {allowIn: "$root", isBlock: true});
                this.schema.register("$text", {allowIn: "$block", isInline: true});
                this.schema.register("$clipboardHolder", {allowContentOf: "$root", isLimit: true});
                this.schema.extend("$text", {allowIn: "$clipboardHolder"});
                this.schema.register("$marker");
                this.schema.addChildCheck((t, e) => {
                    if (e.name === "$marker") {
                        return true
                    }
                });
                tp(this)
            }

            change(t) {
                try {
                    if (this._pendingChanges.length === 0) {
                        this._pendingChanges.push({batch: new zg, callback: t});
                        return this._runPendingChanges()[0]
                    } else {
                        return t(this._currentWriter)
                    }
                } catch (t) {
                    ss["b"].rethrowUnexpectedError(t, this)
                }
            }

            enqueueChange(t, e) {
                try {
                    if (typeof t === "string") {
                        t = new zg(t)
                    } else if (typeof t == "function") {
                        e = t;
                        t = new zg
                    }
                    this._pendingChanges.push({batch: t, callback: e});
                    if (this._pendingChanges.length == 1) {
                        this._runPendingChanges()
                    }
                } catch (t) {
                    ss["b"].rethrowUnexpectedError(t, this)
                }
            }

            applyOperation(t) {
                t._execute()
            }

            insertContent(t, e, i) {
                return Nm(this, t, e, i)
            }

            deleteContent(t, e) {
                Bm(this, t, e)
            }

            modifySelection(t, e) {
                Um(this, t, e)
            }

            getSelectedContent(t) {
                return Xm(this, t)
            }

            hasContent(t, e) {
                const i = t instanceof jh ? $h._createIn(t) : t;
                if (i.isCollapsed) {
                    return false
                }
                for (const t of this.markers.getMarkersIntersectingRange(i)) {
                    if (t.affectsData) {
                        return true
                    }
                }
                const {ignoreWhitespaces: n = false} = e || {};
                for (const t of i.getItems()) {
                    if (t.is("textProxy")) {
                        if (!n) {
                            return true
                        } else if (t.data.search(/\S/) !== -1) {
                            return true
                        }
                    } else if (this.schema.isObject(t)) {
                        return true
                    }
                }
                return false
            }

            createPositionFromPath(t, e, i) {
                return new Uh(t, e, i)
            }

            createPositionAt(t, e) {
                return Uh._createAt(t, e)
            }

            createPositionAfter(t) {
                return Uh._createAfter(t)
            }

            createPositionBefore(t) {
                return Uh._createBefore(t)
            }

            createRange(t, e) {
                return new $h(t, e)
            }

            createRangeIn(t) {
                return $h._createIn(t)
            }

            createRangeOn(t) {
                return $h._createOn(t)
            }

            createSelection(t, e, i) {
                return new Xh(t, e, i)
            }

            createBatch(t) {
                return new zg(t)
            }

            createOperationFromJSON(t) {
                return Rm.fromJSON(t, this.document)
            }

            destroy() {
                this.document.destroy();
                this.stopListening()
            }

            _runPendingChanges() {
                const t = [];
                this.fire("_beforeChanges");
                while (this._pendingChanges.length) {
                    const e = this._pendingChanges[0].batch;
                    this._currentWriter = new am(this, e);
                    const i = this._pendingChanges[0].callback(this._currentWriter);
                    t.push(i);
                    this.document._handleChangeBlock(this._currentWriter);
                    this._pendingChanges.shift();
                    this._currentWriter = null
                }
                this.fire("_afterChanges");
                return t
            }
        }

        vs(lp, Jc);

        class dp {
            constructor() {
                this._listener = Object.create(qd)
            }

            listenTo(t) {
                this._listener.listenTo(t, "keydown", (t, e) => {
                    this._listener.fire("_keydown:" + Ml(e), e)
                })
            }

            set(t, e, i = {}) {
                const n = Bl(t);
                const o = i.priority;
                this._listener.listenTo(this._listener, "_keydown:" + n, (t, i) => {
                    e(i, () => {
                        i.preventDefault();
                        i.stopPropagation();
                        t.stop()
                    });
                    t.return = true
                }, {priority: o})
            }

            press(t) {
                return !!this._listener.fire("_keydown:" + Ml(t), t)
            }

            destroy() {
                this._listener.stopListening()
            }
        }

        class up extends dp {
            constructor(t) {
                super();
                this.editor = t
            }

            set(t, e, i = {}) {
                if (typeof e == "string") {
                    const t = e;
                    e = (e, i) => {
                        this.editor.execute(t);
                        i()
                    }
                }
                super.set(t, e, i)
            }
        }

        class hp {
            constructor(t = {}) {
                this._context = t.context || new Is({language: t.language});
                this._context._addEditor(this, !t.context);
                const e = Array.from(this.constructor.builtinPlugins || []);
                this.config = new Jr(t, this.constructor.defaultConfig);
                this.config.define("plugins", e);
                this.config.define(this._context._getEditorConfig());
                this.plugins = new xs(this, e, this._context.plugins);
                this.locale = this._context.locale;
                this.t = this.locale.t;
                this.commands = new cg;
                this.set("state", "initializing");
                this.once("ready", () => this.state = "ready", {priority: "high"});
                this.once("destroy", () => this.state = "destroyed", {priority: "high"});
                this.set("isReadOnly", false);
                this.model = new lp;
                const i = new Vc;
                this.data = new Ig(this.model, i);
                this.editing = new ag(this.model, i);
                this.editing.view.document.bind("isReadOnly").to(this);
                this.conversion = new Ng([this.editing.downcastDispatcher, this.data.downcastDispatcher], this.data.upcastDispatcher);
                this.conversion.addAlias("dataDowncast", this.data.downcastDispatcher);
                this.conversion.addAlias("editingDowncast", this.editing.downcastDispatcher);
                this.keystrokes = new up(this);
                this.keystrokes.listenTo(this.editing.view.document)
            }

            initPlugins() {
                const t = this.config;
                const e = t.get("plugins");
                const i = t.get("removePlugins") || [];
                const n = t.get("extraPlugins") || [];
                return this.plugins.init(e.concat(n), i)
            }

            destroy() {
                let t = Promise.resolve();
                if (this.state == "initializing") {
                    t = new Promise(t => this.once("ready", t))
                }
                return t.then(() => {
                    this.fire("destroy");
                    this.stopListening();
                    this.commands.destroy()
                }).then(() => this.plugins.destroy()).then(() => {
                    this.model.destroy();
                    this.data.destroy();
                    this.editing.destroy();
                    this.keystrokes.destroy()
                }).then(() => this._context._removeEditor(this))
            }

            execute(...t) {
                try {
                    this.commands.execute(...t)
                } catch (t) {
                    ss["b"].rethrowUnexpectedError(t, this)
                }
            }
        }

        vs(hp, Jc);

        class fp {
            getHtml(t) {
                const e = document.implementation.createHTMLDocument("");
                const i = e.createElement("div");
                i.appendChild(t);
                return i.innerHTML
            }
        }

        class gp {
            constructor(t) {
                this._domParser = new DOMParser;
                this._domConverter = new zd(t, {blockFillerMode: "nbsp"});
                this._htmlWriter = new fp
            }

            toData(t) {
                const e = this._domConverter.viewToDom(t, document);
                return this._htmlWriter.getHtml(e)
            }

            toView(t) {
                const e = this._toDom(t);
                return this._domConverter.domToView(e)
            }

            _toDom(t) {
                const e = this._domParser.parseFromString(t, "text/html");
                const i = e.createDocumentFragment();
                const n = e.body.childNodes;
                while (n.length > 0) {
                    i.appendChild(n[0])
                }
                return i
            }
        }

        class mp {
            constructor(t) {
                this.editor = t;
                this.set("isEnabled", true);
                this._disableStack = new Set
            }

            forceDisabled(t) {
                this._disableStack.add(t);
                if (this._disableStack.size == 1) {
                    this.on("set:isEnabled", pp, {priority: "highest"});
                    this.isEnabled = false
                }
            }

            clearForceDisabled(t) {
                this._disableStack.delete(t);
                if (this._disableStack.size == 0) {
                    this.off("set:isEnabled", pp);
                    this.isEnabled = true
                }
            }

            destroy() {
                this.stopListening()
            }

            static get isContextPlugin() {
                return false
            }
        }

        vs(mp, Jc);

        function pp(t) {
            t.return = false;
            t.stop()
        }

        class bp extends ys {
            constructor(t) {
                super({idProperty: "viewUid"});
                this.on("add", (t, e, i) => {
                    if (!e.isRendered) {
                        e.render()
                    }
                    if (e.element && this._parentElement) {
                        this._parentElement.insertBefore(e.element, this._parentElement.children[i])
                    }
                });
                this.on("remove", (t, e) => {
                    if (e.element && this._parentElement) {
                        e.element.remove()
                    }
                });
                this.locale = t;
                this._parentElement = null
            }

            destroy() {
                this.map(t => t.destroy())
            }

            setParent(t) {
                this._parentElement = t
            }

            delegate(...t) {
                if (!t.length || !wp(t)) {
                    throw new ss["b"]("ui-viewcollection-delegate-wrong-events: All event names must be strings.", this)
                }
                return {
                    to: e => {
                        for (const i of this) {
                            for (const n of t) {
                                i.delegate(n).to(e)
                            }
                        }
                        this.on("add", (i, n) => {
                            for (const i of t) {
                                n.delegate(i).to(e)
                            }
                        });
                        this.on("remove", (i, n) => {
                            for (const i of t) {
                                n.stopDelegating(i, e)
                            }
                        })
                    }
                }
            }
        }

        function wp(t) {
            return t.every(t => typeof t == "string")
        }

        const kp = "http://www.w3.org/1999/xhtml";

        class _p {
            constructor(t) {
                Object.assign(this, Op(Rp(t)));
                this._isRendered = false;
                this._revertData = null
            }

            render() {
                const t = this._renderNode({intoFragment: true});
                this._isRendered = true;
                return t
            }

            apply(t) {
                this._revertData = qp();
                this._renderNode({node: t, isApplying: true, revertData: this._revertData});
                return t
            }

            revert(t) {
                if (!this._revertData) {
                    throw new ss["b"]("ui-template-revert-not-applied: Attempting to revert a template which has not been applied yet.", [this, t])
                }
                this._revertTemplateFromNode(t, this._revertData)
            }

            * getViews() {
                function* t(e) {
                    if (e.children) {
                        for (const i of e.children) {
                            if (jp(i)) {
                                yield i
                            } else if (Hp(i)) {
                                yield* t(i)
                            }
                        }
                    }
                }

                yield* t(this)
            }

            static bind(t, e) {
                return {
                    to(i, n) {
                        return new yp({eventNameOrFunction: i, attribute: i, observable: t, emitter: e, callback: n})
                    }, if(i, n, o) {
                        return new xp({observable: t, emitter: e, attribute: i, valueIfTrue: n, callback: o})
                    }
                }
            }

            static extend(t, e) {
                if (t._isRendered) {
                    throw new ss["b"]("template-extend-render: Attempting to extend a template which has already been rendered.", [this, t])
                }
                Fp(t, Op(Rp(e)))
            }

            _renderNode(t) {
                let e;
                if (t.node) {
                    e = this.tag && this.text
                } else {
                    e = this.tag ? this.text : !this.text
                }
                if (e) {
                    throw new ss["b"]('ui-template-wrong-syntax: Node definition must have either "tag" or "text" when rendering a new Node.', this)
                }
                if (this.text) {
                    return this._renderText(t)
                } else {
                    return this._renderElement(t)
                }
            }

            _renderElement(t) {
                let e = t.node;
                if (!e) {
                    e = t.node = document.createElementNS(this.ns || kp, this.tag)
                }
                this._renderAttributes(t);
                this._renderElementChildren(t);
                this._setUpListeners(t);
                return e
            }

            _renderText(t) {
                let e = t.node;
                if (e) {
                    t.revertData.text = e.textContent
                } else {
                    e = t.node = document.createTextNode("")
                }
                if (Cp(this.text)) {
                    this._bindToObservable({schema: this.text, updater: Pp(e), data: t})
                } else {
                    e.textContent = this.text.join("")
                }
                return e
            }

            _renderAttributes(t) {
                let e, i, n, o;
                if (!this.attributes) {
                    return
                }
                const r = t.node;
                const s = t.revertData;
                for (e in this.attributes) {
                    n = r.getAttribute(e);
                    i = this.attributes[e];
                    if (s) {
                        s.attributes[e] = n
                    }
                    o = ct(i[0]) && i[0].ns ? i[0].ns : null;
                    if (Cp(i)) {
                        const a = o ? i[0].value : i;
                        if (s && Up(e)) {
                            a.unshift(n)
                        }
                        this._bindToObservable({schema: a, updater: Sp(r, e, o), data: t})
                    } else if (e == "style" && typeof i[0] !== "string") {
                        this._renderStyleAttribute(i[0], t)
                    } else {
                        if (s && n && Up(e)) {
                            i.unshift(n)
                        }
                        i = i.map(t => t ? t.value || t : t).reduce((t, e) => t.concat(e), []).reduce(zp, "");
                        if (!Dp(i)) {
                            r.setAttributeNS(o, e, i)
                        }
                    }
                }
            }

            _renderStyleAttribute(t, e) {
                const i = e.node;
                for (const n in t) {
                    const o = t[n];
                    if (Cp(o)) {
                        this._bindToObservable({schema: [o], updater: Ep(i, n), data: e})
                    } else {
                        i.style[n] = o
                    }
                }
            }

            _renderElementChildren(t) {
                const e = t.node;
                const i = t.intoFragment ? document.createDocumentFragment() : e;
                const n = t.isApplying;
                let o = 0;
                for (const r of this.children) {
                    if (Wp(r)) {
                        if (!n) {
                            r.setParent(e);
                            for (const t of r) {
                                i.appendChild(t.element)
                            }
                        }
                    } else if (jp(r)) {
                        if (!n) {
                            if (!r.isRendered) {
                                r.render()
                            }
                            i.appendChild(r.element)
                        }
                    } else if (xd(r)) {
                        i.appendChild(r)
                    } else {
                        if (n) {
                            const e = t.revertData;
                            const n = qp();
                            e.children.push(n);
                            r._renderNode({node: i.childNodes[o++], isApplying: true, revertData: n})
                        } else {
                            i.appendChild(r.render())
                        }
                    }
                }
                if (t.intoFragment) {
                    e.appendChild(i)
                }
            }

            _setUpListeners(t) {
                if (!this.eventListeners) {
                    return
                }
                for (const e in this.eventListeners) {
                    const i = this.eventListeners[e].map(i => {
                        const [n, o] = e.split("@");
                        return i.activateDomEventListener(n, o, t)
                    });
                    if (t.revertData) {
                        t.revertData.bindings.push(i)
                    }
                }
            }

            _bindToObservable({schema: t, updater: e, data: i}) {
                const n = i.revertData;
                Tp(t, e, i);
                const o = t.filter(t => !Dp(t)).filter(t => t.observable).map(n => n.activateAttributeListener(t, e, i));
                if (n) {
                    n.bindings.push(o)
                }
            }

            _revertTemplateFromNode(t, e) {
                for (const t of e.bindings) {
                    for (const e of t) {
                        e()
                    }
                }
                if (e.text) {
                    t.textContent = e.text;
                    return
                }
                for (const i in e.attributes) {
                    const n = e.attributes[i];
                    if (n === null) {
                        t.removeAttribute(i)
                    } else {
                        t.setAttribute(i, n)
                    }
                }
                for (let i = 0; i < e.children.length; ++i) {
                    this._revertTemplateFromNode(t.childNodes[i], e.children[i])
                }
            }
        }

        vs(_p, ds);

        class vp {
            constructor(t) {
                Object.assign(this, t)
            }

            getValue(t) {
                const e = this.observable[this.attribute];
                return this.callback ? this.callback(e, t) : e
            }

            activateAttributeListener(t, e, i) {
                const n = () => Tp(t, e, i);
                this.emitter.listenTo(this.observable, "change:" + this.attribute, n);
                return () => {
                    this.emitter.stopListening(this.observable, "change:" + this.attribute, n)
                }
            }
        }

        class yp extends vp {
            activateDomEventListener(t, e, i) {
                const n = (t, i) => {
                    if (!e || i.target.matches(e)) {
                        if (typeof this.eventNameOrFunction == "function") {
                            this.eventNameOrFunction(i)
                        } else {
                            this.observable.fire(this.eventNameOrFunction, i)
                        }
                    }
                };
                this.emitter.listenTo(i.node, t, n);
                return () => {
                    this.emitter.stopListening(i.node, t, n)
                }
            }
        }

        class xp extends vp {
            getValue(t) {
                const e = super.getValue(t);
                return Dp(e) ? false : this.valueIfTrue || true
            }
        }

        function Cp(t) {
            if (!t) {
                return false
            }
            if (t.value) {
                t = t.value
            }
            if (Array.isArray(t)) {
                return t.some(Cp)
            } else if (t instanceof vp) {
                return true
            }
            return false
        }

        function Ap(t, e) {
            return t.map(t => {
                if (t instanceof vp) {
                    return t.getValue(e)
                }
                return t
            })
        }

        function Tp(t, e, {node: i}) {
            let n = Ap(t, i);
            if (t.length == 1 && t[0] instanceof xp) {
                n = n[0]
            } else {
                n = n.reduce(zp, "")
            }
            if (Dp(n)) {
                e.remove()
            } else {
                e.set(n)
            }
        }

        function Pp(t) {
            return {
                set(e) {
                    t.textContent = e
                }, remove() {
                    t.textContent = ""
                }
            }
        }

        function Sp(t, e, i) {
            return {
                set(n) {
                    t.setAttributeNS(i, e, n)
                }, remove() {
                    t.removeAttributeNS(i, e)
                }
            }
        }

        function Ep(t, e) {
            return {
                set(i) {
                    t.style[e] = i
                }, remove() {
                    t.style[e] = null
                }
            }
        }

        function Rp(t) {
            const e = $r(t, t => {
                if (t && (t instanceof vp || Hp(t) || jp(t) || Wp(t))) {
                    return t
                }
            });
            return e
        }

        function Op(t) {
            if (typeof t == "string") {
                t = Np(t)
            } else if (t.text) {
                Mp(t)
            }
            if (t.on) {
                t.eventListeners = Vp(t.on);
                delete t.on
            }
            if (!t.text) {
                if (t.attributes) {
                    Ip(t.attributes)
                }
                const e = [];
                if (t.children) {
                    if (Wp(t.children)) {
                        e.push(t.children)
                    } else {
                        for (const i of t.children) {
                            if (Hp(i) || jp(i) || xd(i)) {
                                e.push(i)
                            } else {
                                e.push(new _p(i))
                            }
                        }
                    }
                }
                t.children = e
            }
            return t
        }

        function Ip(t) {
            for (const e in t) {
                if (t[e].value) {
                    t[e].value = [].concat(t[e].value)
                }
                Bp(t, e)
            }
        }

        function Vp(t) {
            for (const e in t) {
                Bp(t, e)
            }
            return t
        }

        function Np(t) {
            return {text: [t]}
        }

        function Mp(t) {
            if (!Array.isArray(t.text)) {
                t.text = [t.text]
            }
        }

        function Bp(t, e) {
            if (!Array.isArray(t[e])) {
                t[e] = [t[e]]
            }
        }

        function zp(t, e) {
            if (Dp(e)) {
                return t
            } else if (Dp(t)) {
                return e
            } else {
                return `${t} ${e}`
            }
        }

        function Lp(t, e) {
            for (const i in e) {
                if (t[i]) {
                    t[i].push(...e[i])
                } else {
                    t[i] = e[i]
                }
            }
        }

        function Fp(t, e) {
            if (e.attributes) {
                if (!t.attributes) {
                    t.attributes = {}
                }
                Lp(t.attributes, e.attributes)
            }
            if (e.eventListeners) {
                if (!t.eventListeners) {
                    t.eventListeners = {}
                }
                Lp(t.eventListeners, e.eventListeners)
            }
            if (e.text) {
                t.text.push(...e.text)
            }
            if (e.children && e.children.length) {
                if (t.children.length != e.children.length) {
                    throw new ss["b"]("ui-template-extend-children-mismatch: The number of children in extended definition does not match.", t)
                }
                let i = 0;
                for (const n of e.children) {
                    Fp(t.children[i++], n)
                }
            }
        }

        function Dp(t) {
            return !t && t !== 0
        }

        function jp(t) {
            return t instanceof Gp
        }

        function Hp(t) {
            return t instanceof _p
        }

        function Wp(t) {
            return t instanceof bp
        }

        function qp() {
            return {children: [], bindings: [], attributes: {}}
        }

        function Up(t) {
            return t == "class" || t == "style"
        }

        var $p = i(15);

        class Gp {
            constructor(t) {
                this.element = null;
                this.isRendered = false;
                this.locale = t;
                this.t = t && t.t;
                this._viewCollections = new ys;
                this._unboundChildren = this.createCollection();
                this._viewCollections.on("add", (e, i) => {
                    i.locale = t
                });
                this.decorate("render")
            }

            get bindTemplate() {
                if (this._bindTemplate) {
                    return this._bindTemplate
                }
                return this._bindTemplate = _p.bind(this, this)
            }

            createCollection() {
                const t = new bp;
                this._viewCollections.add(t);
                return t
            }

            registerChild(t) {
                if (!js(t)) {
                    t = [t]
                }
                for (const e of t) {
                    this._unboundChildren.add(e)
                }
            }

            deregisterChild(t) {
                if (!js(t)) {
                    t = [t]
                }
                for (const e of t) {
                    this._unboundChildren.remove(e)
                }
            }

            setTemplate(t) {
                this.template = new _p(t)
            }

            extendTemplate(t) {
                _p.extend(this.template, t)
            }

            render() {
                if (this.isRendered) {
                    throw new ss["b"]("ui-view-render-already-rendered: This View has already been rendered.", this)
                }
                if (this.template) {
                    this.element = this.template.render();
                    this.registerChild(this.template.getViews())
                }
                this.isRendered = true
            }

            destroy() {
                this.stopListening();
                this._viewCollections.map(t => t.destroy());
                if (this.template && this.template._revertData) {
                    this.template.revert(this.element)
                }
            }
        }

        vs(Gp, qd);
        vs(Gp, Jc);

        function Kp(t) {
            while (t && t.tagName.toLowerCase() != "html") {
                if (Id.window.getComputedStyle(t).position != "static") {
                    return t
                }
                t = t.parentElement
            }
            return null
        }

        function Jp({element: t, target: e, positions: i, limiter: n, fitInViewport: o}) {
            if (gt(e)) {
                e = e()
            }
            if (gt(n)) {
                n = n()
            }
            const r = Kp(t.parentElement);
            const s = new vh(t);
            const a = new vh(e);
            let c;
            let l;
            if (!n && !o) {
                [l, c] = Yp(i[0], a, s)
            } else {
                const t = n && new vh(n).getVisible();
                const e = o && new vh(Id.window);
                [l, c] = Qp(i, a, s, t, e) || Yp(i[0], a, s)
            }
            let {left: d, top: u} = Xp(c);
            if (r) {
                const t = Xp(new vh(r));
                const e = kh(r);
                d -= t.left;
                u -= t.top;
                d += r.scrollLeft;
                u += r.scrollTop;
                d -= e.left;
                u -= e.top
            }
            return {left: d, top: u, name: l}
        }

        function Yp(t, e, i) {
            const {left: n, top: o, name: r} = t(e, i);
            return [r, i.clone().moveTo(n, o)]
        }

        function Qp(t, e, i, n, o) {
            let r = 0;
            let s = 0;
            let a;
            let c;
            const l = i.getArea();
            t.some(t => {
                const [d, u] = Yp(t, e, i);
                let h;
                let f;
                if (n) {
                    if (o) {
                        const t = n.getIntersection(o);
                        if (t) {
                            h = t.getIntersectionArea(u)
                        } else {
                            h = 0
                        }
                    } else {
                        h = n.getIntersectionArea(u)
                    }
                }
                if (o) {
                    f = o.getIntersectionArea(u)
                }
                if (o && !n) {
                    if (f > s) {
                        g()
                    }
                } else if (!o && n) {
                    if (h > r) {
                        g()
                    }
                } else {
                    if (f > s && h >= r) {
                        g()
                    } else if (f >= s && h > r) {
                        g()
                    }
                }

                function g() {
                    s = f;
                    r = h;
                    a = u;
                    c = d
                }

                return h === l
            });
            return a ? [c, a] : null
        }

        function Xp({left: t, top: e}) {
            const {scrollX: i, scrollY: n} = Id.window;
            return {left: t + i, top: e + n}
        }

        function Zp(t) {
            return e => e + t
        }

        var tb = i(17);
        const eb = Zp("px");
        const ib = Id.document.body;

        class nb extends Gp {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                this.set("top", 0);
                this.set("left", 0);
                this.set("position", "arrow_nw");
                this.set("isVisible", false);
                this.set("withArrow", true);
                this.set("class");
                this.content = this.createCollection();
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-balloon-panel", e.to("position", t => `ck-balloon-panel_${t}`), e.if("isVisible", "ck-balloon-panel_visible"), e.if("withArrow", "ck-balloon-panel_with-arrow"), e.to("class")],
                        style: {top: e.to("top", eb), left: e.to("left", eb)}
                    },
                    children: this.content
                })
            }

            show() {
                this.isVisible = true
            }

            hide() {
                this.isVisible = false
            }

            attachTo(t) {
                this.show();
                const e = nb.defaultPositions;
                const i = Object.assign({}, {
                    element: this.element,
                    positions: [e.southArrowNorth, e.southArrowNorthMiddleWest, e.southArrowNorthMiddleEast, e.southArrowNorthWest, e.southArrowNorthEast, e.northArrowSouth, e.northArrowSouthMiddleWest, e.northArrowSouthMiddleEast, e.northArrowSouthWest, e.northArrowSouthEast],
                    limiter: ib,
                    fitInViewport: true
                }, t);
                const n = nb._getOptimalPosition(i);
                const o = parseInt(n.left);
                const r = parseInt(n.top);
                const s = n.name;
                Object.assign(this, {top: r, left: o, position: s})
            }

            pin(t) {
                this.unpin();
                this._pinWhenIsVisibleCallback = () => {
                    if (this.isVisible) {
                        this._startPinning(t)
                    } else {
                        this._stopPinning()
                    }
                };
                this._startPinning(t);
                this.listenTo(this, "change:isVisible", this._pinWhenIsVisibleCallback)
            }

            unpin() {
                if (this._pinWhenIsVisibleCallback) {
                    this._stopPinning();
                    this.stopListening(this, "change:isVisible", this._pinWhenIsVisibleCallback);
                    this._pinWhenIsVisibleCallback = null;
                    this.hide()
                }
            }

            _startPinning(t) {
                this.attachTo(t);
                const e = ob(t.target);
                const i = t.limiter ? ob(t.limiter) : ib;
                this.listenTo(Id.document, "scroll", (n, o) => {
                    const r = o.target;
                    const s = e && r.contains(e);
                    const a = i && r.contains(i);
                    if (s || a || !e || !i) {
                        this.attachTo(t)
                    }
                }, {useCapture: true});
                this.listenTo(Id.window, "resize", () => {
                    this.attachTo(t)
                })
            }

            _stopPinning() {
                this.stopListening(Id.document, "scroll");
                this.stopListening(Id.window, "resize")
            }
        }

        function ob(t) {
            if (Kr(t)) {
                return t
            }
            if (wh(t)) {
                return t.commonAncestorContainer
            }
            if (typeof t == "function") {
                return ob(t())
            }
            return null
        }

        nb.arrowHorizontalOffset = 25;
        nb.arrowVerticalOffset = 10;
        nb._getOptimalPosition = Jp;
        nb.defaultPositions = {
            northWestArrowSouthWest: (t, e) => ({
                top: rb(t, e),
                left: t.left - nb.arrowHorizontalOffset,
                name: "arrow_sw"
            }),
            northWestArrowSouthMiddleWest: (t, e) => ({
                top: rb(t, e),
                left: t.left - e.width * .25 - nb.arrowHorizontalOffset,
                name: "arrow_smw"
            }),
            northWestArrowSouth: (t, e) => ({top: rb(t, e), left: t.left - e.width / 2, name: "arrow_s"}),
            northWestArrowSouthMiddleEast: (t, e) => ({
                top: rb(t, e),
                left: t.left - e.width * .75 + nb.arrowHorizontalOffset,
                name: "arrow_sme"
            }),
            northWestArrowSouthEast: (t, e) => ({
                top: rb(t, e),
                left: t.left - e.width + nb.arrowHorizontalOffset,
                name: "arrow_se"
            }),
            northArrowSouthWest: (t, e) => ({
                top: rb(t, e),
                left: t.left + t.width / 2 - nb.arrowHorizontalOffset,
                name: "arrow_sw"
            }),
            northArrowSouthMiddleWest: (t, e) => ({
                top: rb(t, e),
                left: t.left + t.width / 2 - e.width * .25 - nb.arrowHorizontalOffset,
                name: "arrow_smw"
            }),
            northArrowSouth: (t, e) => ({top: rb(t, e), left: t.left + t.width / 2 - e.width / 2, name: "arrow_s"}),
            northArrowSouthMiddleEast: (t, e) => ({
                top: rb(t, e),
                left: t.left + t.width / 2 - e.width * .75 + nb.arrowHorizontalOffset,
                name: "arrow_sme"
            }),
            northArrowSouthEast: (t, e) => ({
                top: rb(t, e),
                left: t.left + t.width / 2 - e.width + nb.arrowHorizontalOffset,
                name: "arrow_se"
            }),
            northEastArrowSouthWest: (t, e) => ({
                top: rb(t, e),
                left: t.right - nb.arrowHorizontalOffset,
                name: "arrow_sw"
            }),
            northEastArrowSouthMiddleWest: (t, e) => ({
                top: rb(t, e),
                left: t.right - e.width * .25 - nb.arrowHorizontalOffset,
                name: "arrow_smw"
            }),
            northEastArrowSouth: (t, e) => ({top: rb(t, e), left: t.right - e.width / 2, name: "arrow_s"}),
            northEastArrowSouthMiddleEast: (t, e) => ({
                top: rb(t, e),
                left: t.right - e.width * .75 + nb.arrowHorizontalOffset,
                name: "arrow_sme"
            }),
            northEastArrowSouthEast: (t, e) => ({
                top: rb(t, e),
                left: t.right - e.width + nb.arrowHorizontalOffset,
                name: "arrow_se"
            }),
            southWestArrowNorthWest: (t, e) => ({
                top: sb(t, e),
                left: t.left - nb.arrowHorizontalOffset,
                name: "arrow_nw"
            }),
            southWestArrowNorthMiddleWest: (t, e) => ({
                top: sb(t, e),
                left: t.left - e.width * .25 - nb.arrowHorizontalOffset,
                name: "arrow_nmw"
            }),
            southWestArrowNorth: (t, e) => ({top: sb(t, e), left: t.left - e.width / 2, name: "arrow_n"}),
            southWestArrowNorthMiddleEast: (t, e) => ({
                top: sb(t, e),
                left: t.left - e.width * .75 + nb.arrowHorizontalOffset,
                name: "arrow_nme"
            }),
            southWestArrowNorthEast: (t, e) => ({
                top: sb(t, e),
                left: t.left - e.width + nb.arrowHorizontalOffset,
                name: "arrow_ne"
            }),
            southArrowNorthWest: (t, e) => ({
                top: sb(t, e),
                left: t.left + t.width / 2 - nb.arrowHorizontalOffset,
                name: "arrow_nw"
            }),
            southArrowNorthMiddleWest: (t, e) => ({
                top: sb(t, e),
                left: t.left + t.width / 2 - e.width * .25 - nb.arrowHorizontalOffset,
                name: "arrow_nmw"
            }),
            southArrowNorth: (t, e) => ({top: sb(t, e), left: t.left + t.width / 2 - e.width / 2, name: "arrow_n"}),
            southArrowNorthMiddleEast: (t, e) => ({
                top: sb(t, e),
                left: t.left + t.width / 2 - e.width * .75 + nb.arrowHorizontalOffset,
                name: "arrow_nme"
            }),
            southArrowNorthEast: (t, e) => ({
                top: sb(t, e),
                left: t.left + t.width / 2 - e.width + nb.arrowHorizontalOffset,
                name: "arrow_ne"
            }),
            southEastArrowNorthWest: (t, e) => ({
                top: sb(t, e),
                left: t.right - nb.arrowHorizontalOffset,
                name: "arrow_nw"
            }),
            southEastArrowNorthMiddleWest: (t, e) => ({
                top: sb(t, e),
                left: t.right - e.width * .25 - nb.arrowHorizontalOffset,
                name: "arrow_nmw"
            }),
            southEastArrowNorth: (t, e) => ({top: sb(t, e), left: t.right - e.width / 2, name: "arrow_n"}),
            southEastArrowNorthMiddleEast: (t, e) => ({
                top: sb(t, e),
                left: t.right - e.width * .75 + nb.arrowHorizontalOffset,
                name: "arrow_nme"
            }),
            southEastArrowNorthEast: (t, e) => ({
                top: sb(t, e),
                left: t.right - e.width + nb.arrowHorizontalOffset,
                name: "arrow_ne"
            })
        };

        function rb(t, e) {
            return t.top - e.height - nb.arrowVerticalOffset
        }

        function sb(t) {
            return t.bottom + nb.arrowVerticalOffset
        }

        var ab = i(19);

        class cb extends Gp {
            constructor() {
                super();
                const t = this.bindTemplate;
                this.set("content", "");
                this.set("viewBox", "0 0 20 20");
                this.set("fillColor", "");
                this.setTemplate({
                    tag: "svg",
                    ns: "http://www.w3.org/2000/svg",
                    attributes: {class: ["ck", "ck-icon"], viewBox: t.to("viewBox")}
                })
            }

            render() {
                super.render();
                this._updateXMLContent();
                this._colorFillPaths();
                this.on("change:content", () => {
                    this._updateXMLContent();
                    this._colorFillPaths()
                });
                this.on("change:fillColor", () => {
                    this._colorFillPaths()
                })
            }

            _updateXMLContent() {
                if (this.content) {
                    const t = (new DOMParser).parseFromString(this.content.trim(), "image/svg+xml");
                    const e = t.querySelector("svg");
                    const i = e.getAttribute("viewBox");
                    if (i) {
                        this.viewBox = i
                    }
                    this.element.innerHTML = "";
                    while (e.childNodes.length > 0) {
                        this.element.appendChild(e.childNodes[0])
                    }
                }
            }

            _colorFillPaths() {
                if (this.fillColor) {
                    this.element.querySelectorAll(".ck-icon__fill").forEach(t => {
                        t.style.fill = this.fillColor
                    })
                }
            }
        }

        var lb = i(21);

        class db extends Gp {
            constructor(t) {
                super(t);
                this.set("text", "");
                this.set("position", "s");
                const e = this.bindTemplate;
                this.setTemplate({
                    tag: "span",
                    attributes: {class: ["ck", "ck-tooltip", e.to("position", t => "ck-tooltip_" + t), e.if("text", "ck-hidden", t => !t.trim())]},
                    children: [{
                        tag: "span",
                        attributes: {class: ["ck", "ck-tooltip__text"]},
                        children: [{text: e.to("text")}]
                    }]
                })
            }
        }

        var ub = i(23);

        class hb extends Gp {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                const i = is();
                this.set("class");
                this.set("labelStyle");
                this.set("icon");
                this.set("isEnabled", true);
                this.set("isOn", false);
                this.set("isVisible", true);
                this.set("isToggleable", false);
                this.set("keystroke");
                this.set("label");
                this.set("tabindex", -1);
                this.set("tooltip");
                this.set("tooltipPosition", "s");
                this.set("type", "button");
                this.set("withText", false);
                this.set("withKeystroke", false);
                this.children = this.createCollection();
                this.tooltipView = this._createTooltipView();
                this.labelView = this._createLabelView(i);
                this.iconView = new cb;
                this.iconView.extendTemplate({attributes: {class: "ck-button__icon"}});
                this.keystrokeView = this._createKeystrokeView();
                this.bind("_tooltipString").to(this, "tooltip", this, "label", this, "keystroke", this._getTooltipString.bind(this));
                this.setTemplate({
                    tag: "button",
                    attributes: {
                        class: ["ck", "ck-button", e.to("class"), e.if("isEnabled", "ck-disabled", t => !t), e.if("isVisible", "ck-hidden", t => !t), e.to("isOn", t => t ? "ck-on" : "ck-off"), e.if("withText", "ck-button_with-text"), e.if("withKeystroke", "ck-button_with-keystroke")],
                        type: e.to("type", t => t ? t : "button"),
                        tabindex: e.to("tabindex"),
                        "aria-labelledby": `ck-editor__aria-label_${i}`,
                        "aria-disabled": e.if("isEnabled", true, t => !t),
                        "aria-pressed": e.to("isOn", t => this.isToggleable ? String(t) : false)
                    },
                    children: this.children,
                    on: {
                        mousedown: e.to(t => {
                            t.preventDefault()
                        }), click: e.to(t => {
                            if (this.isEnabled) {
                                this.fire("execute")
                            } else {
                                t.preventDefault()
                            }
                        })
                    }
                })
            }

            render() {
                super.render();
                if (this.icon) {
                    this.iconView.bind("content").to(this, "icon");
                    this.children.add(this.iconView)
                }
                this.children.add(this.tooltipView);
                this.children.add(this.labelView);
                if (this.withKeystroke) {
                    this.children.add(this.keystrokeView)
                }
            }

            focus() {
                this.element.focus()
            }

            _createTooltipView() {
                const t = new db;
                t.bind("text").to(this, "_tooltipString");
                t.bind("position").to(this, "tooltipPosition");
                return t
            }

            _createLabelView(t) {
                const e = new Gp;
                const i = this.bindTemplate;
                e.setTemplate({
                    tag: "span",
                    attributes: {
                        class: ["ck", "ck-button__label"],
                        style: i.to("labelStyle"),
                        id: `ck-editor__aria-label_${t}`
                    },
                    children: [{text: this.bindTemplate.to("label")}]
                });
                return e
            }

            _createKeystrokeView() {
                const t = new Gp;
                t.setTemplate({
                    tag: "span",
                    attributes: {class: ["ck", "ck-button__keystroke"]},
                    children: [{text: this.bindTemplate.to("keystroke", t => zl(t))}]
                });
                return t
            }

            _getTooltipString(t, e, i) {
                if (t) {
                    if (typeof t == "string") {
                        return t
                    } else {
                        if (i) {
                            i = zl(i)
                        }
                        if (t instanceof Function) {
                            return t(e, i)
                        } else {
                            return `${e}${i ? ` (${i})` : ""}`
                        }
                    }
                }
                return ""
            }
        }

        class fb {
            constructor() {
                this.set("isFocused", false);
                this.set("focusedElement", null);
                this._elements = new Set;
                this._nextEventLoopTimeout = null
            }

            add(t) {
                if (this._elements.has(t)) {
                    throw new ss["b"]("focusTracker-add-element-already-exist", this)
                }
                this.listenTo(t, "focus", () => this._focus(t), {useCapture: true});
                this.listenTo(t, "blur", () => this._blur(), {useCapture: true});
                this._elements.add(t)
            }

            remove(t) {
                if (t === this.focusedElement) {
                    this._blur(t)
                }
                if (this._elements.has(t)) {
                    this.stopListening(t);
                    this._elements.delete(t)
                }
            }

            destroy() {
                this.stopListening()
            }

            _focus(t) {
                clearTimeout(this._nextEventLoopTimeout);
                this.focusedElement = t;
                this.isFocused = true
            }

            _blur() {
                clearTimeout(this._nextEventLoopTimeout);
                this._nextEventLoopTimeout = setTimeout(() => {
                    this.focusedElement = null;
                    this.isFocused = false
                }, 0)
            }
        }

        vs(fb, qd);
        vs(fb, Jc);
        var gb = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>';
        var mb = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>';
        var pb = i(25);
        var bb = i(27);
        const wb = Zp("px");

        class kb extends mp {
            static get pluginName() {
                return "ContextualBalloon"
            }

            constructor(t) {
                super(t);
                this.positionLimiter = () => {
                    const t = this.editor.editing.view;
                    const e = t.document;
                    const i = e.selection.editableElement;
                    if (i) {
                        return t.domConverter.mapViewToDom(i.root)
                    }
                    return null
                };
                this.set("visibleView", null);
                this.view = new nb(t.locale);
                t.ui.view.body.add(this.view);
                t.ui.focusTracker.add(this.view.element);
                this._viewToStack = new Map;
                this._idToStack = new Map;
                this.set("_numberOfStacks", 0);
                this.set("_singleViewMode", false);
                this._rotatorView = this._createRotatorView();
                this._fakePanelsView = this._createFakePanelsView()
            }

            hasView(t) {
                return Array.from(this._viewToStack.keys()).includes(t)
            }

            add(t) {
                if (this.hasView(t.view)) {
                    throw new ss["b"]("contextualballoon-add-view-exist: Cannot add configuration of the same view twice.", [this, t])
                }
                const e = t.stackId || "main";
                if (!this._idToStack.has(e)) {
                    this._idToStack.set(e, new Map([[t.view, t]]));
                    this._viewToStack.set(t.view, this._idToStack.get(e));
                    this._numberOfStacks = this._idToStack.size;
                    if (!this._visibleStack || t.singleViewMode) {
                        this.showStack(e)
                    }
                    return
                }
                const i = this._idToStack.get(e);
                if (t.singleViewMode) {
                    this.showStack(e)
                }
                i.set(t.view, t);
                this._viewToStack.set(t.view, i);
                if (i === this._visibleStack) {
                    this._showView(t)
                }
            }

            remove(t) {
                if (!this.hasView(t)) {
                    throw new ss["b"]("contextualballoon-remove-view-not-exist: Cannot remove the configuration of a non-existent view.", [this, t])
                }
                const e = this._viewToStack.get(t);
                if (this._singleViewMode && this.visibleView === t) {
                    this._singleViewMode = false
                }
                if (this.visibleView === t) {
                    if (e.size === 1) {
                        if (this._idToStack.size > 1) {
                            this._showNextStack()
                        } else {
                            this.view.hide();
                            this.visibleView = null;
                            this._rotatorView.hideView()
                        }
                    } else {
                        this._showView(Array.from(e.values())[e.size - 2])
                    }
                }
                if (e.size === 1) {
                    this._idToStack.delete(this._getStackId(e));
                    this._numberOfStacks = this._idToStack.size
                } else {
                    e.delete(t)
                }
                this._viewToStack.delete(t)
            }

            updatePosition(t) {
                if (t) {
                    this._visibleStack.get(this.visibleView).position = t
                }
                this.view.pin(this._getBalloonPosition());
                this._fakePanelsView.updatePosition()
            }

            showStack(t) {
                this.visibleStack = t;
                const e = this._idToStack.get(t);
                if (!e) {
                    throw new ss["b"]("contextualballoon-showstack-stack-not-exist: Cannot show a stack that does not exist.", this)
                }
                if (this._visibleStack === e) {
                    return
                }
                this._showView(Array.from(e.values()).pop())
            }

            get _visibleStack() {
                return this._viewToStack.get(this.visibleView)
            }

            _getStackId(t) {
                const e = Array.from(this._idToStack.entries()).find(e => e[1] === t);
                return e[0]
            }

            _showNextStack() {
                const t = Array.from(this._idToStack.values());
                let e = t.indexOf(this._visibleStack) + 1;
                if (!t[e]) {
                    e = 0
                }
                this.showStack(this._getStackId(t[e]))
            }

            _showPrevStack() {
                const t = Array.from(this._idToStack.values());
                let e = t.indexOf(this._visibleStack) - 1;
                if (!t[e]) {
                    e = t.length - 1
                }
                this.showStack(this._getStackId(t[e]))
            }

            _createRotatorView() {
                const t = new _b(this.editor.locale);
                const e = this.editor.locale.t;
                this.view.content.add(t);
                t.bind("isNavigationVisible").to(this, "_numberOfStacks", this, "_singleViewMode", (t, e) => !e && t > 1);
                t.on("change:isNavigationVisible", () => this.updatePosition(), {priority: "low"});
                t.bind("counter").to(this, "visibleView", this, "_numberOfStacks", (t, i) => {
                    if (i < 2) {
                        return ""
                    }
                    const n = Array.from(this._idToStack.values()).indexOf(this._visibleStack) + 1;
                    return e("lu", [n, i])
                });
                t.buttonNextView.on("execute", () => {
                    if (t.focusTracker.isFocused) {
                        this.editor.editing.view.focus()
                    }
                    this._showNextStack()
                });
                t.buttonPrevView.on("execute", () => {
                    if (t.focusTracker.isFocused) {
                        this.editor.editing.view.focus()
                    }
                    this._showPrevStack()
                });
                return t
            }

            _createFakePanelsView() {
                const t = new vb(this.editor.locale, this.view);
                t.bind("numberOfPanels").to(this, "_numberOfStacks", this, "_singleViewMode", (t, e) => {
                    const i = !e && t >= 2;
                    return i ? Math.min(t - 1, 2) : 0
                });
                t.listenTo(this.view, "change:top", () => t.updatePosition());
                t.listenTo(this.view, "change:left", () => t.updatePosition());
                this.editor.ui.view.body.add(t);
                return t
            }

            _showView({view: t, balloonClassName: e = "", withArrow: i = true, singleViewMode: n = false}) {
                this.view.class = e;
                this.view.withArrow = i;
                this._rotatorView.showView(t);
                this.visibleView = t;
                this.view.pin(this._getBalloonPosition());
                this._fakePanelsView.updatePosition();
                if (n) {
                    this._singleViewMode = true
                }
            }

            _getBalloonPosition() {
                let t = Array.from(this._visibleStack.values()).pop().position;
                if (t && !t.limiter) {
                    t = Object.assign({}, t, {limiter: this.positionLimiter})
                }
                return t
            }
        }

        class _b extends Gp {
            constructor(t) {
                super(t);
                const e = t.t;
                const i = this.bindTemplate;
                this.set("isNavigationVisible", true);
                this.focusTracker = new fb;
                this.buttonPrevView = this._createButtonView(e("lv"), gb);
                this.buttonNextView = this._createButtonView(e("lw"), mb);
                this.content = this.createCollection();
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-balloon-rotator"], "z-index": "-1"},
                    children: [{
                        tag: "div",
                        attributes: {class: ["ck-balloon-rotator__navigation", i.to("isNavigationVisible", t => t ? "" : "ck-hidden")]},
                        children: [this.buttonPrevView, {
                            tag: "span",
                            attributes: {class: ["ck-balloon-rotator__counter"]},
                            children: [{text: i.to("counter")}]
                        }, this.buttonNextView]
                    }, {tag: "div", attributes: {class: "ck-balloon-rotator__content"}, children: this.content}]
                })
            }

            render() {
                super.render();
                this.focusTracker.add(this.element)
            }

            showView(t) {
                this.hideView();
                this.content.add(t)
            }

            hideView() {
                this.content.clear()
            }

            _createButtonView(t, e) {
                const i = new hb(this.locale);
                i.set({label: t, icon: e, tooltip: true});
                return i
            }
        }

        class vb extends Gp {
            constructor(t, e) {
                super(t);
                const i = this.bindTemplate;
                this.set("top", 0);
                this.set("left", 0);
                this.set("height", 0);
                this.set("width", 0);
                this.set("numberOfPanels", 0);
                this.content = this.createCollection();
                this._balloonPanelView = e;
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck-fake-panel", i.to("numberOfPanels", t => t ? "" : "ck-hidden")],
                        style: {
                            top: i.to("top", wb),
                            left: i.to("left", wb),
                            width: i.to("width", wb),
                            height: i.to("height", wb)
                        }
                    },
                    children: this.content
                });
                this.on("change:numberOfPanels", (t, e, i, n) => {
                    if (i > n) {
                        this._addPanels(i - n)
                    } else {
                        this._removePanels(n - i)
                    }
                    this.updatePosition()
                })
            }

            _addPanels(t) {
                while (t--) {
                    const t = new Gp;
                    t.setTemplate({tag: "div"});
                    this.content.add(t);
                    this.registerChild(t)
                }
            }

            _removePanels(t) {
                while (t--) {
                    const t = this.content.last;
                    this.content.remove(t);
                    this.deregisterChild(t);
                    t.destroy()
                }
            }

            updatePosition() {
                if (this.numberOfPanels) {
                    const {top: t, left: e} = this._balloonPanelView;
                    const {width: i, height: n} = new vh(this._balloonPanelView.element);
                    Object.assign(this, {top: t, left: e, width: i, height: n})
                }
            }
        }

        class yb {
            constructor(t) {
                Object.assign(this, t);
                if (t.actions && t.keystrokeHandler) {
                    for (const e in t.actions) {
                        let i = t.actions[e];
                        if (typeof i == "string") {
                            i = [i]
                        }
                        for (const n of i) {
                            t.keystrokeHandler.set(n, (t, i) => {
                                this[e]();
                                i()
                            })
                        }
                    }
                }
            }

            get first() {
                return this.focusables.find(xb) || null
            }

            get last() {
                return this.focusables.filter(xb).slice(-1)[0] || null
            }

            get next() {
                return this._getFocusableItem(1)
            }

            get previous() {
                return this._getFocusableItem(-1)
            }

            get current() {
                let t = null;
                if (this.focusTracker.focusedElement === null) {
                    return null
                }
                this.focusables.find((e, i) => {
                    const n = e.element === this.focusTracker.focusedElement;
                    if (n) {
                        t = i
                    }
                    return n
                });
                return t
            }

            focusFirst() {
                this._focus(this.first)
            }

            focusLast() {
                this._focus(this.last)
            }

            focusNext() {
                this._focus(this.next)
            }

            focusPrevious() {
                this._focus(this.previous)
            }

            _focus(t) {
                if (t) {
                    t.focus()
                }
            }

            _getFocusableItem(t) {
                const e = this.current;
                const i = this.focusables.length;
                if (!i) {
                    return null
                }
                if (e === null) {
                    return this[t === 1 ? "first" : "last"]
                }
                let n = (e + i + t) % i;
                do {
                    const e = this.focusables.get(n);
                    if (xb(e)) {
                        return e
                    }
                    n = (n + i + t) % i
                } while (n !== e);
                return null
            }
        }

        function xb(t) {
            return !!(t.focus && Id.window.getComputedStyle(t.element).display != "none")
        }

        class Cb extends Gp {
            constructor(t) {
                super(t);
                this.setTemplate({tag: "span", attributes: {class: ["ck", "ck-toolbar__separator"]}})
            }
        }

        const Ab = 100;

        class Tb {
            constructor(t, e) {
                if (!Tb._observerInstance) {
                    Tb._createObserver()
                }
                this._element = t;
                this._callback = e;
                Tb._addElementCallback(t, e);
                Tb._observerInstance.observe(t)
            }

            destroy() {
                Tb._deleteElementCallback(this._element, this._callback)
            }

            static _addElementCallback(t, e) {
                if (!Tb._elementCallbacks) {
                    Tb._elementCallbacks = new Map
                }
                let i = Tb._elementCallbacks.get(t);
                if (!i) {
                    i = new Set;
                    Tb._elementCallbacks.set(t, i)
                }
                i.add(e)
            }

            static _deleteElementCallback(t, e) {
                const i = Tb._getElementCallbacks(t);
                if (i) {
                    i.delete(e);
                    if (!i.size) {
                        Tb._elementCallbacks.delete(t);
                        Tb._observerInstance.unobserve(t)
                    }
                }
                if (Tb._elementCallbacks && !Tb._elementCallbacks.size) {
                    Tb._observerInstance = null;
                    Tb._elementCallbacks = null
                }
            }

            static _getElementCallbacks(t) {
                if (!Tb._elementCallbacks) {
                    return null
                }
                return Tb._elementCallbacks.get(t)
            }

            static _createObserver() {
                let t;
                if (typeof Id.window.ResizeObserver === "function") {
                    t = Id.window.ResizeObserver
                } else {
                    t = Pb
                }
                Tb._observerInstance = new t(t => {
                    for (const e of t) {
                        const t = Tb._getElementCallbacks(e.target);
                        if (t) {
                            for (const i of t) {
                                i(e)
                            }
                        }
                    }
                })
            }
        }

        Tb._observerInstance = null;
        Tb._elementCallbacks = null;

        class Pb {
            constructor(t) {
                this._callback = t;
                this._elements = new Set;
                this._previousRects = new Map;
                this._periodicCheckTimeout = null
            }

            observe(t) {
                this._elements.add(t);
                this._checkElementRectsAndExecuteCallback();
                if (this._elements.size === 1) {
                    this._startPeriodicCheck()
                }
            }

            unobserve(t) {
                this._elements.delete(t);
                this._previousRects.delete(t);
                if (!this._elements.size) {
                    this._stopPeriodicCheck()
                }
            }

            _startPeriodicCheck() {
                const t = () => {
                    this._checkElementRectsAndExecuteCallback();
                    this._periodicCheckTimeout = setTimeout(t, Ab)
                };
                this.listenTo(Id.window, "resize", () => {
                    this._checkElementRectsAndExecuteCallback()
                });
                this._periodicCheckTimeout = setTimeout(t, Ab)
            }

            _stopPeriodicCheck() {
                clearTimeout(this._periodicCheckTimeout);
                this.stopListening();
                this._previousRects.clear()
            }

            _checkElementRectsAndExecuteCallback() {
                const t = [];
                for (const e of this._elements) {
                    if (this._hasRectChanged(e)) {
                        t.push({target: e, contentRect: this._previousRects.get(e)})
                    }
                }
                if (t.length) {
                    this._callback(t)
                }
            }

            _hasRectChanged(t) {
                if (!t.ownerDocument.body.contains(t)) {
                    return false
                }
                const e = new vh(t);
                const i = this._previousRects.get(t);
                const n = !i || !i.isEqual(e);
                this._previousRects.set(t, e);
                return n
            }
        }

        vs(Pb, qd);

        function Sb(t) {
            return t.bindTemplate.to(e => {
                if (e.target === t.element) {
                    e.preventDefault()
                }
            })
        }

        class Eb extends Gp {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                this.set("isVisible", false);
                this.set("position", "se");
                this.children = this.createCollection();
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-reset", "ck-dropdown__panel", e.to("position", t => `ck-dropdown__panel_${t}`), e.if("isVisible", "ck-dropdown__panel-visible")]},
                    children: this.children,
                    on: {selectstart: e.to(t => t.preventDefault())}
                })
            }

            focus() {
                if (this.children.length) {
                    this.children.first.focus()
                }
            }

            focusLast() {
                if (this.children.length) {
                    const t = this.children.last;
                    if (typeof t.focusLast === "function") {
                        t.focusLast()
                    } else {
                        t.focus()
                    }
                }
            }
        }

        var Rb = i(29);

        class Ob extends Gp {
            constructor(t, e, i) {
                super(t);
                const n = this.bindTemplate;
                this.buttonView = e;
                this.panelView = i;
                this.set("isOpen", false);
                this.set("isEnabled", true);
                this.set("class");
                this.set("id");
                this.set("panelPosition", "auto");
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-dropdown", n.to("class"), n.if("isEnabled", "ck-disabled", t => !t)],
                        id: n.to("id"),
                        "aria-describedby": n.to("ariaDescribedById")
                    },
                    children: [e, i]
                });
                e.extendTemplate({attributes: {class: ["ck-dropdown__button"]}})
            }

            render() {
                super.render();
                this.listenTo(this.buttonView, "open", () => {
                    this.isOpen = !this.isOpen
                });
                this.panelView.bind("isVisible").to(this, "isOpen");
                this.on("change:isOpen", () => {
                    if (!this.isOpen) {
                        return
                    }
                    if (this.panelPosition === "auto") {
                        this.panelView.position = Ob._getOptimalPosition({
                            element: this.panelView.element,
                            target: this.buttonView.element,
                            fitInViewport: true,
                            positions: this._panelPositions
                        }).name
                    } else {
                        this.panelView.position = this.panelPosition
                    }
                });
                this.keystrokes.listenTo(this.element);
                this.focusTracker.add(this.element);
                const t = (t, e) => {
                    if (this.isOpen) {
                        this.buttonView.focus();
                        this.isOpen = false;
                        e()
                    }
                };
                this.keystrokes.set("arrowdown", (t, e) => {
                    if (this.buttonView.isEnabled && !this.isOpen) {
                        this.isOpen = true;
                        e()
                    }
                });
                this.keystrokes.set("arrowright", (t, e) => {
                    if (this.isOpen) {
                        e()
                    }
                });
                this.keystrokes.set("arrowleft", t);
                this.keystrokes.set("esc", t)
            }

            focus() {
                this.buttonView.focus()
            }

            get _panelPositions() {
                const {southEast: t, southWest: e, northEast: i, northWest: n} = Ob.defaultPanelPositions;
                if (this.locale.uiLanguageDirection === "ltr") {
                    return [t, e, i, n]
                } else {
                    return [e, t, n, i]
                }
            }
        }

        Ob.defaultPanelPositions = {
            southEast: t => ({top: t.bottom, left: t.left, name: "se"}),
            southWest: (t, e) => ({top: t.bottom, left: t.left - e.width + t.width, name: "sw"}),
            northEast: (t, e) => ({top: t.top - e.height, left: t.left, name: "ne"}),
            northWest: (t, e) => ({top: t.bottom - e.height, left: t.left - e.width + t.width, name: "nw"})
        };
        Ob._getOptimalPosition = Jp;
        var Ib = '<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';

        class Vb extends hb {
            constructor(t) {
                super(t);
                this.arrowView = this._createArrowView();
                this.extendTemplate({attributes: {"aria-haspopup": true}});
                this.delegate("execute").to(this, "open")
            }

            render() {
                super.render();
                this.children.add(this.arrowView)
            }

            _createArrowView() {
                const t = new cb;
                t.content = Ib;
                t.extendTemplate({attributes: {class: "ck-dropdown__arrow"}});
                return t
            }
        }

        var Nb = i(31);

        class Mb extends Gp {
            constructor() {
                super();
                this.items = this.createCollection();
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this._focusCycler = new yb({
                    focusables: this.items,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "arrowup", focusNext: "arrowdown"}
                });
                this.setTemplate({tag: "ul", attributes: {class: ["ck", "ck-reset", "ck-list"]}, children: this.items})
            }

            render() {
                super.render();
                for (const t of this.items) {
                    this.focusTracker.add(t.element)
                }
                this.items.on("add", (t, e) => {
                    this.focusTracker.add(e.element)
                });
                this.items.on("remove", (t, e) => {
                    this.focusTracker.remove(e.element)
                });
                this.keystrokes.listenTo(this.element)
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            focusLast() {
                this._focusCycler.focusLast()
            }
        }

        class Bb extends Gp {
            constructor(t) {
                super(t);
                this.children = this.createCollection();
                this.setTemplate({tag: "li", attributes: {class: ["ck", "ck-list__item"]}, children: this.children})
            }

            focus() {
                this.children.first.focus()
            }
        }

        class zb extends Gp {
            constructor(t) {
                super(t);
                this.setTemplate({tag: "li", attributes: {class: ["ck", "ck-list__separator"]}})
            }
        }

        var Lb = i(33);

        class Fb extends hb {
            constructor(t) {
                super(t);
                this.isToggleable = true;
                this.toggleSwitchView = this._createToggleView();
                this.extendTemplate({attributes: {class: "ck-switchbutton"}})
            }

            render() {
                super.render();
                this.children.add(this.toggleSwitchView)
            }

            _createToggleView() {
                const t = new Gp;
                t.setTemplate({
                    tag: "span",
                    attributes: {class: ["ck", "ck-button__toggle"]},
                    children: [{tag: "span", attributes: {class: ["ck", "ck-button__toggle__inner"]}}]
                });
                return t
            }
        }

        function Db({emitter: t, activator: e, callback: i, contextElements: n}) {
            t.listenTo(document, "mousedown", (t, {target: o}) => {
                if (!e()) {
                    return
                }
                for (const t of n) {
                    if (t.contains(o)) {
                        return
                    }
                }
                i()
            })
        }

        var jb = i(35);
        var Hb = i(37);

        function Wb(t, e = Vb) {
            const i = new e(t);
            const n = new Eb(t);
            const o = new Ob(t, i, n);
            i.bind("isEnabled").to(o);
            if (i instanceof Vb) {
                i.bind("isOn").to(o, "isOpen")
            } else {
                i.arrowView.bind("isOn").to(o, "isOpen")
            }
            $b(o);
            return o
        }

        function qb(t, e) {
            const i = t.locale;
            const n = i.t;
            const o = t.toolbarView = new Xb(i);
            o.set("ariaLabel", n("lg"));
            t.extendTemplate({attributes: {class: ["ck-toolbar-dropdown"]}});
            e.map(t => o.items.add(t));
            t.panelView.children.add(o);
            o.items.delegate("execute").to(t)
        }

        function Ub(t, e) {
            const i = t.locale;
            const n = t.listView = new Mb(i);
            n.items.bindTo(e).using(({type: t, model: e}) => {
                if (t === "separator") {
                    return new zb(i)
                } else if (t === "button" || t === "switchbutton") {
                    const n = new Bb(i);
                    let o;
                    if (t === "button") {
                        o = new hb(i)
                    } else {
                        o = new Fb(i)
                    }
                    o.bind(...Object.keys(e)).to(e);
                    o.delegate("execute").to(n);
                    n.children.add(o);
                    return n
                }
            });
            t.panelView.children.add(n);
            n.items.delegate("execute").to(t)
        }

        function $b(t) {
            Gb(t);
            Kb(t);
            Jb(t)
        }

        function Gb(t) {
            t.on("render", () => {
                Db({
                    emitter: t, activator: () => t.isOpen, callback: () => {
                        t.isOpen = false
                    }, contextElements: [t.element]
                })
            })
        }

        function Kb(t) {
            t.on("execute", e => {
                if (e.source instanceof Fb) {
                    return
                }
                t.isOpen = false
            })
        }

        function Jb(t) {
            t.keystrokes.set("arrowdown", (e, i) => {
                if (t.isOpen) {
                    t.panelView.focus();
                    i()
                }
            });
            t.keystrokes.set("arrowup", (e, i) => {
                if (t.isOpen) {
                    t.panelView.focusLast();
                    i()
                }
            })
        }

        var Yb = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';
        var Qb = i(39);

        class Xb extends Gp {
            constructor(t, e) {
                super(t);
                const i = this.bindTemplate;
                const n = this.t;
                this.options = e || {};
                this.set("ariaLabel", n("lr"));
                this.set("maxWidth", "auto");
                this.items = this.createCollection();
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.set("class");
                this.set("isCompact", false);
                this.itemsView = new Zb(t);
                this.children = this.createCollection();
                this.children.add(this.itemsView);
                this.focusables = this.createCollection();
                this._focusCycler = new yb({
                    focusables: this.focusables,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: ["arrowleft", "arrowup"], focusNext: ["arrowright", "arrowdown"]}
                });
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-toolbar", i.to("class"), i.if("isCompact", "ck-toolbar_compact")],
                        role: "toolbar",
                        "aria-label": i.to("ariaLabel"),
                        style: {maxWidth: i.to("maxWidth")}
                    },
                    children: this.children,
                    on: {mousedown: Sb(this)}
                });
                this._behavior = this.options.shouldGroupWhenFull ? new ew(this) : new tw(this)
            }

            render() {
                super.render();
                for (const t of this.items) {
                    this.focusTracker.add(t.element)
                }
                this.items.on("add", (t, e) => {
                    this.focusTracker.add(e.element)
                });
                this.items.on("remove", (t, e) => {
                    this.focusTracker.remove(e.element)
                });
                this.keystrokes.listenTo(this.element);
                this._behavior.render(this)
            }

            destroy() {
                this._behavior.destroy();
                return super.destroy()
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            focusLast() {
                this._focusCycler.focusLast()
            }

            fillFromConfig(t, e) {
                t.map(t => {
                    if (t == "|") {
                        this.items.add(new Cb)
                    } else if (e.has(t)) {
                        this.items.add(e.create(t))
                    } else {
                        console.warn(Object(ss["a"])("toolbarview-item-unavailable: The requested toolbar item is unavailable."), {name: t})
                    }
                })
            }
        }

        class Zb extends Gp {
            constructor(t) {
                super(t);
                this.children = this.createCollection();
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-toolbar__items"]},
                    children: this.children
                })
            }
        }

        class tw {
            constructor(t) {
                const e = t.bindTemplate;
                t.set("isVertical", false);
                t.itemsView.children.bindTo(t.items).using(t => t);
                t.focusables.bindTo(t.items).using(t => t);
                t.extendTemplate({attributes: {class: [e.if("isVertical", "ck-toolbar_vertical")]}})
            }

            render() {
            }

            destroy() {
            }
        }

        class ew {
            constructor(t) {
                this.viewChildren = t.children;
                this.viewFocusables = t.focusables;
                this.viewItemsView = t.itemsView;
                this.viewFocusTracker = t.focusTracker;
                this.viewLocale = t.locale;
                this.ungroupedItems = t.createCollection();
                this.groupedItems = t.createCollection();
                this.groupedItemsDropdown = this._createGroupedItemsDropdown();
                this.resizeObserver = null;
                this.cachedPadding = null;
                t.itemsView.children.bindTo(this.ungroupedItems).using(t => t);
                this.ungroupedItems.on("add", this._updateFocusCycleableItems.bind(this));
                this.ungroupedItems.on("remove", this._updateFocusCycleableItems.bind(this));
                t.children.on("add", this._updateFocusCycleableItems.bind(this));
                t.children.on("remove", this._updateFocusCycleableItems.bind(this));
                t.items.on("add", (t, e, i) => {
                    if (i > this.ungroupedItems.length) {
                        this.groupedItems.add(e, i - this.ungroupedItems.length)
                    } else {
                        this.ungroupedItems.add(e, i)
                    }
                    this._updateGrouping()
                });
                t.items.on("remove", (t, e, i) => {
                    if (i > this.ungroupedItems.length) {
                        this.groupedItems.remove(e)
                    } else {
                        this.ungroupedItems.remove(e)
                    }
                    this._updateGrouping()
                });
                t.extendTemplate({attributes: {class: ["ck-toolbar_grouping"]}})
            }

            render(t) {
                this.viewElement = t.element;
                this._enableGroupingOnResize();
                this._enableGroupingOnMaxWidthChange(t)
            }

            destroy() {
                this.groupedItemsDropdown.destroy();
                this.resizeObserver.destroy()
            }

            _updateGrouping() {
                if (!this.viewElement.ownerDocument.body.contains(this.viewElement)) {
                    return
                }
                let t;
                while (this._areItemsOverflowing) {
                    this._groupLastItem();
                    t = true
                }
                if (!t && this.groupedItems.length) {
                    while (this.groupedItems.length && !this._areItemsOverflowing) {
                        this._ungroupFirstItem()
                    }
                    if (this._areItemsOverflowing) {
                        this._groupLastItem()
                    }
                }
            }

            get _areItemsOverflowing() {
                if (!this.ungroupedItems.length) {
                    return false
                }
                const t = this.viewElement;
                const e = this.viewLocale.uiLanguageDirection;
                const i = new vh(t.lastChild);
                const n = new vh(t);
                if (!this.cachedPadding) {
                    const i = Id.window.getComputedStyle(t);
                    const n = e === "ltr" ? "paddingRight" : "paddingLeft";
                    this.cachedPadding = Number.parseInt(i[n])
                }
                if (e === "ltr") {
                    return i.right > n.right - this.cachedPadding
                } else {
                    return i.left < n.left + this.cachedPadding
                }
            }

            _enableGroupingOnResize() {
                let t;
                this.resizeObserver = new Tb(this.viewElement, e => {
                    if (!t || t !== e.contentRect.width) {
                        this._updateGrouping();
                        t = e.contentRect.width
                    }
                });
                this._updateGrouping()
            }

            _enableGroupingOnMaxWidthChange(t) {
                t.on("change:maxWidth", () => {
                    this._updateGrouping()
                })
            }

            _groupLastItem() {
                if (!this.groupedItems.length) {
                    this.viewChildren.add(new Cb);
                    this.viewChildren.add(this.groupedItemsDropdown);
                    this.viewFocusTracker.add(this.groupedItemsDropdown.element)
                }
                this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last), 0)
            }

            _ungroupFirstItem() {
                this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first));
                if (!this.groupedItems.length) {
                    this.viewChildren.remove(this.groupedItemsDropdown);
                    this.viewChildren.remove(this.viewChildren.last);
                    this.viewFocusTracker.remove(this.groupedItemsDropdown.element)
                }
            }

            _createGroupedItemsDropdown() {
                const t = this.viewLocale;
                const e = t.t;
                const i = Wb(t);
                i.class = "ck-toolbar__grouped-dropdown";
                i.panelPosition = t.uiLanguageDirection === "ltr" ? "sw" : "se";
                qb(i, []);
                i.buttonView.set({label: e("ls"), tooltip: true, icon: Yb});
                i.toolbarView.items.bindTo(this.groupedItems).using(t => t);
                return i
            }

            _updateFocusCycleableItems() {
                this.viewFocusables.clear();
                this.ungroupedItems.map(t => {
                    this.viewFocusables.add(t)
                });
                if (this.groupedItems.length) {
                    this.viewFocusables.add(this.groupedItemsDropdown)
                }
            }
        }

        function iw(t) {
            if (Array.isArray(t)) {
                return {items: t}
            }
            if (!t) {
                return {items: []}
            }
            return Object.assign({items: []}, t)
        }

        const nw = Zp("px");

        class ow extends mp {
            static get pluginName() {
                return "BalloonToolbar"
            }

            static get requires() {
                return [kb]
            }

            constructor(t) {
                super(t);
                this._balloonConfig = iw(t.config.get("balloonToolbar"));
                this.toolbarView = this._createToolbarView();
                this.focusTracker = new fb;
                t.ui.once("ready", () => {
                    this.focusTracker.add(t.ui.getEditableElement());
                    this.focusTracker.add(this.toolbarView.element)
                });
                this._resizeObserver = null;
                this._balloon = t.plugins.get(kb);
                this._fireSelectionChangeDebounced = uh(() => this.fire("_selectionChangeDebounced"), 200);
                this.decorate("show")
            }

            init() {
                const t = this.editor;
                const e = t.model.document.selection;
                this.listenTo(this.focusTracker, "change:isFocused", (t, e, i) => {
                    const n = this._balloon.visibleView === this.toolbarView;
                    if (!i && n) {
                        this.hide()
                    } else if (i) {
                        this.show()
                    }
                });
                this.listenTo(e, "change:range", (t, i) => {
                    if (i.directChange || e.isCollapsed) {
                        this.hide()
                    }
                    this._fireSelectionChangeDebounced()
                });
                this.listenTo(this, "_selectionChangeDebounced", () => {
                    if (this.editor.editing.view.document.isFocused) {
                        this.show()
                    }
                });
                if (!this._balloonConfig.shouldNotGroupWhenFull) {
                    this.listenTo(t, "ready", () => {
                        const e = t.ui.view.editable.element;
                        this._resizeObserver = new Tb(e, () => {
                            this.toolbarView.maxWidth = nw(new vh(e).width * .9)
                        })
                    })
                }
            }

            afterInit() {
                const t = this.editor.ui.componentFactory;
                this.toolbarView.fillFromConfig(this._balloonConfig.items, t)
            }

            _createToolbarView() {
                const t = !this._balloonConfig.shouldNotGroupWhenFull;
                const e = new Xb(this.editor.locale, {shouldGroupWhenFull: t});
                e.extendTemplate({attributes: {class: ["ck-toolbar_floating"]}});
                e.render();
                return e
            }

            show() {
                const t = this.editor;
                if (this._balloon.hasView(this.toolbarView)) {
                    return
                }
                if (t.model.document.selection.isCollapsed) {
                    return
                }
                if (Array.from(this.toolbarView.items).every(t => t.isEnabled !== undefined && !t.isEnabled)) {
                    return
                }
                this.listenTo(this.editor.ui, "update", () => {
                    this._balloon.updatePosition(this._getBalloonPositionData())
                });
                this._balloon.add({
                    view: this.toolbarView,
                    position: this._getBalloonPositionData(),
                    balloonClassName: "ck-toolbar-container"
                })
            }

            hide() {
                if (this._balloon.hasView(this.toolbarView)) {
                    this.stopListening(this.editor.ui, "update");
                    this._balloon.remove(this.toolbarView)
                }
            }

            _getBalloonPositionData() {
                const t = this.editor;
                const e = t.editing.view;
                const i = e.document;
                const n = i.selection;
                const o = i.selection.isBackward;
                return {
                    target: () => {
                        const t = o ? n.getFirstRange() : n.getLastRange();
                        const i = vh.getDomRangeRects(e.domConverter.viewRangeToDom(t));
                        if (o) {
                            return i[0]
                        } else {
                            if (i.length > 1 && i[i.length - 1].width === 0) {
                                i.pop()
                            }
                            return i[i.length - 1]
                        }
                    }, positions: rw(o)
                }
            }

            destroy() {
                super.destroy();
                this.stopListening();
                this._fireSelectionChangeDebounced.cancel();
                this.toolbarView.destroy();
                this.focusTracker.destroy();
                if (this._resizeObserver) {
                    this._resizeObserver.destroy()
                }
            }
        }

        function rw(t) {
            const e = nb.defaultPositions;
            return t ? [e.northWestArrowSouth, e.northWestArrowSouthWest, e.northWestArrowSouthEast, e.northWestArrowSouthMiddleEast, e.northWestArrowSouthMiddleWest, e.southWestArrowNorth, e.southWestArrowNorthWest, e.southWestArrowNorthEast, e.southWestArrowNorthMiddleWest, e.southWestArrowNorthMiddleEast] : [e.southEastArrowNorth, e.southEastArrowNorthEast, e.southEastArrowNorthWest, e.southEastArrowNorthMiddleEast, e.southEastArrowNorthMiddleWest, e.northEastArrowSouth, e.northEastArrowSouthEast, e.northEastArrowSouthWest, e.northEastArrowSouthMiddleEast, e.northEastArrowSouthMiddleWest]
        }

        class sw {
            constructor(t) {
                this.editor = t;
                this._components = new Map
            }

            * names() {
                for (const t of this._components.values()) {
                    yield t.originalName
                }
            }

            add(t, e) {
                if (this.has(t)) {
                    throw new ss["b"]("componentfactory-item-exists: The item already exists in the component factory.", this, {name: t})
                }
                this._components.set(aw(t), {callback: e, originalName: t})
            }

            create(t) {
                if (!this.has(t)) {
                    throw new ss["b"]("componentfactory-item-missing: The required component is not registered in the factory.", this, {name: t})
                }
                return this._components.get(aw(t)).callback(this.editor.locale)
            }

            has(t) {
                return this._components.has(aw(t))
            }
        }

        function aw(t) {
            return String(t).toLowerCase()
        }

        class cw {
            constructor(t) {
                this.editor = t;
                this.componentFactory = new sw(t);
                this.focusTracker = new fb;
                this._editableElementsMap = new Map;
                this.listenTo(t.editing.view.document, "layoutChanged", () => this.update())
            }

            get element() {
                return null
            }

            update() {
                this.fire("update")
            }

            destroy() {
                this.stopListening();
                this.focusTracker.destroy();
                for (const t of this._editableElementsMap.values()) {
                    t.ckeditorInstance = null
                }
                this._editableElementsMap = new Map
            }

            setEditableElement(t, e) {
                this._editableElementsMap.set(t, e);
                if (!e.ckeditorInstance) {
                    e.ckeditorInstance = this.editor
                }
            }

            getEditableElement(t = "main") {
                return this._editableElementsMap.get(t)
            }

            getEditableElementsNames() {
                return this._editableElementsMap.keys()
            }

            get _editableElements() {
                console.warn("editor-ui-deprecated-editable-elements: " + "The EditorUI#_editableElements property has been deprecated and will be removed in the near future.", {editorUI: this});
                return this._editableElementsMap
            }
        }

        vs(cw, ds);

        function lw({origin: t, originKeystrokeHandler: e, originFocusTracker: i, toolbar: n, beforeFocus: o, afterBlur: r}) {
            i.add(n.element);
            e.set("Alt+F10", (t, e) => {
                if (i.isFocused && !n.focusTracker.isFocused) {
                    if (o) {
                        o()
                    }
                    n.focus();
                    e()
                }
            });
            n.keystrokes.set("Esc", (e, i) => {
                if (n.focusTracker.isFocused) {
                    t.focus();
                    if (r) {
                        r()
                    }
                    i()
                }
            })
        }

        var dw = i(41);
        const uw = new WeakMap;

        function hw(t) {
            const {view: e, element: i, text: n, isDirectHost: o = true} = t;
            const r = e.document;
            if (!uw.has(r)) {
                uw.set(r, new Map);
                r.registerPostFixer(t => bw(r, t))
            }
            uw.get(r).set(i, {text: n, isDirectHost: o});
            e.change(t => bw(r, t))
        }

        function fw(t, e) {
            const i = e.document;
            t.change(t => {
                if (!uw.has(i)) {
                    return
                }
                const n = uw.get(i);
                const o = n.get(e);
                t.removeAttribute("data-placeholder", o.hostElement);
                mw(t, o.hostElement);
                n.delete(e)
            })
        }

        function gw(t, e) {
            if (!e.hasClass("ck-placeholder")) {
                t.addClass("ck-placeholder", e);
                return true
            }
            return false
        }

        function mw(t, e) {
            if (e.hasClass("ck-placeholder")) {
                t.removeClass("ck-placeholder", e);
                return true
            }
            return false
        }

        function pw(t) {
            if (!t.isAttached()) {
                return false
            }
            const e = !Array.from(t.getChildren()).some(t => !t.is("uiElement"));
            const i = t.document;
            if (!i.isFocused && e) {
                return true
            }
            const n = i.selection;
            const o = n.anchor;
            if (e && o && o.parent !== t) {
                return true
            }
            return false
        }

        function bw(t, e) {
            const i = uw.get(t);
            let n = false;
            for (const [t, o] of i) {
                if (ww(e, t, o)) {
                    n = true
                }
            }
            return n
        }

        function ww(t, e, i) {
            const {text: n, isDirectHost: o} = i;
            const r = o ? e : kw(e);
            let s = false;
            if (!r) {
                return false
            }
            i.hostElement = r;
            if (r.getAttribute("data-placeholder") !== n) {
                t.setAttribute("data-placeholder", n, r);
                s = true
            }
            if (pw(r)) {
                if (gw(t, r)) {
                    s = true
                }
            } else if (mw(t, r)) {
                s = true
            }
            return s
        }

        function kw(t) {
            if (t.childCount === 1) {
                const e = t.getChild(0);
                if (e.is("element") && !e.is("uiElement")) {
                    return e
                }
            }
            return null
        }

        class _w extends cw {
            constructor(t, e) {
                super(t);
                this.view = e
            }

            get element() {
                return this.view.editable.element
            }

            init() {
                const t = this.editor;
                const e = this.view;
                const i = t.plugins.get("BalloonToolbar");
                const n = t.editing.view;
                const o = e.editable;
                const r = n.document.getRoot();
                o.name = r.rootName;
                e.render();
                const s = o.element;
                this.setEditableElement(o.name, s);
                this.focusTracker.add(s);
                o.bind("isFocused").to(this.focusTracker);
                n.attachDomRoot(s);
                lw({
                    origin: n,
                    originFocusTracker: this.focusTracker,
                    originKeystrokeHandler: t.keystrokes,
                    toolbar: i.toolbarView,
                    beforeFocus() {
                        i.show()
                    },
                    afterBlur() {
                        i.hide()
                    }
                });
                this._initPlaceholder();
                this.fire("ready")
            }

            destroy() {
                const t = this.view;
                const e = this.editor.editing.view;
                e.detachDomRoot(t.editable.name);
                t.destroy();
                super.destroy()
            }

            _initPlaceholder() {
                const t = this.editor;
                const e = t.editing.view;
                const i = e.document.getRoot();
                const n = t.sourceElement;
                const o = t.config.get("placeholder") || n && n.tagName.toLowerCase() === "textarea" && n.getAttribute("placeholder");
                if (o) {
                    hw({view: e, element: i, text: o, isDirectHost: false})
                }
            }
        }

        var vw = "[object String]";

        function yw(t) {
            return typeof t == "string" || !Je(t) && T(t) && _(t) == vw
        }

        var xw = yw;

        function Cw(t, e, i = {}, n = []) {
            const o = i && i.xmlns;
            const r = o ? t.createElementNS(o, e) : t.createElement(e);
            for (const t in i) {
                r.setAttribute(t, i[t])
            }
            if (xw(n) || !js(n)) {
                n = [n]
            }
            for (let e of n) {
                if (xw(e)) {
                    e = t.createTextNode(e)
                }
                r.appendChild(e)
            }
            return r
        }

        class Aw extends bp {
            attachToDom() {
                this._bodyCollectionContainer = new _p({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-reset_all", "ck-body", "ck-rounded-corners"],
                        dir: this.locale.uiLanguageDirection
                    },
                    children: this
                }).render();
                let t = document.querySelector(".ck-body-wrapper");
                if (!t) {
                    t = Cw(document, "div", {class: "ck-body-wrapper"});
                    document.body.appendChild(t)
                }
                t.appendChild(this._bodyCollectionContainer)
            }

            detachFromDom() {
                super.destroy();
                if (this._bodyCollectionContainer) {
                    this._bodyCollectionContainer.remove()
                }
                const t = document.querySelector(".ck-body-wrapper");
                if (t && t.childElementCount == 0) {
                    t.remove()
                }
            }
        }

        var Tw = i(43);

        class Pw extends Gp {
            constructor(t) {
                super(t);
                this.body = new Aw(t)
            }

            render() {
                super.render();
                this.body.attachToDom()
            }

            destroy() {
                this.body.detachFromDom();
                return super.destroy()
            }
        }

        class Sw extends Gp {
            constructor(t, e, i) {
                super(t);
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-content", "ck-editor__editable", "ck-rounded-corners"],
                        lang: t.contentLanguage,
                        dir: t.contentLanguageDirection
                    }
                });
                this.name = null;
                this.set("isFocused", false);
                this._editableElement = i;
                this._hasExternalElement = !!this._editableElement;
                this._editingView = e
            }

            render() {
                super.render();
                if (this._hasExternalElement) {
                    this.template.apply(this.element = this._editableElement)
                } else {
                    this._editableElement = this.element
                }
                this.on("change:isFocused", () => this._updateIsFocusedClasses());
                this._updateIsFocusedClasses()
            }

            destroy() {
                if (this._hasExternalElement) {
                    this.template.revert(this._editableElement)
                }
                super.destroy()
            }

            _updateIsFocusedClasses() {
                const t = this._editingView;
                if (t.isRenderingInProgress) {
                    i(this)
                } else {
                    e(this)
                }

                function e(e) {
                    t.change(i => {
                        const n = t.document.getRoot(e.name);
                        i.addClass(e.isFocused ? "ck-focused" : "ck-blurred", n);
                        i.removeClass(e.isFocused ? "ck-blurred" : "ck-focused", n)
                    })
                }

                function i(n) {
                    t.once("change:isRenderingInProgress", (t, o, r) => {
                        if (!r) {
                            e(n)
                        } else {
                            i(n)
                        }
                    })
                }
            }
        }

        class Ew extends Sw {
            constructor(t, e, i) {
                super(t, e, i);
                this.extendTemplate({attributes: {role: "textbox", class: "ck-editor__editable_inline"}})
            }

            render() {
                super.render();
                const t = this._editingView;
                const e = this.t;
                t.change(i => {
                    const n = t.document.getRoot(this.name);
                    i.setAttribute("aria-label", e("of", [this.name]), n)
                })
            }
        }

        class Rw extends Pw {
            constructor(t, e, i) {
                super(t);
                this.editable = new Ew(t, e, i)
            }

            render() {
                super.render();
                this.registerChild(this.editable)
            }
        }

        function Ow(t, e) {
            if (t instanceof HTMLTextAreaElement) {
                t.value = e
            }
            t.innerHTML = e
        }

        function Iw(t) {
            if (t instanceof HTMLTextAreaElement) {
                return t.value
            }
            return t.innerHTML
        }

        const Vw = {
            setData(t) {
                this.data.set(t)
            }, getData(t) {
                return this.data.get(t)
            }
        };
        var Nw = Vw;
        const Mw = {
            updateSourceElement() {
                if (!this.sourceElement) {
                    throw new ss["b"]("editor-missing-sourceelement: Cannot update the source element of a detached editor.", this)
                }
                Ow(this.sourceElement, this.data.get())
            }
        };
        var Bw = Mw;

        function zw(t) {
            if (!gt(t.updateSourceElement)) {
                throw new ss["b"]("attachtoform-missing-elementapi-interface: Editor passed to attachToForm() must implement ElementApi.", t)
            }
            const e = t.sourceElement;
            if (e && e.tagName.toLowerCase() === "textarea" && e.form) {
                let i;
                const n = e.form;
                const o = () => t.updateSourceElement();
                if (gt(n.submit)) {
                    i = n.submit;
                    n.submit = () => {
                        o();
                        i.apply(n)
                    }
                }
                n.addEventListener("submit", o);
                t.on("destroy", () => {
                    n.removeEventListener("submit", o);
                    if (i) {
                        n.submit = i
                    }
                })
            }
        }

        function Lw(t) {
            const e = t.sourceElement;
            if (!e) {
                return
            }
            if (e.ckeditorInstance) {
                throw new ss["b"]("editor-source-element-already-used: " + "The DOM element cannot be used to create multiple editor instances.", t)
            }
            e.ckeditorInstance = t;
            t.once("destroy", () => {
                delete e.ckeditorInstance
            })
        }

        class Fw extends hp {
            constructor(t, e) {
                super(e);
                if (Kr(t)) {
                    this.sourceElement = t;
                    Lw(this)
                }
                const i = this.config.get("plugins");
                i.push(ow);
                this.config.set("plugins", i);
                this.config.define("balloonToolbar", this.config.get("toolbar"));
                this.data.processor = new gp(this.data.viewDocument);
                this.model.document.createRoot();
                const n = new Rw(this.locale, this.editing.view, this.sourceElement);
                this.ui = new _w(this, n);
                zw(this)
            }

            destroy() {
                const t = this.getData();
                this.ui.destroy();
                return super.destroy().then(() => {
                    if (this.sourceElement) {
                        Ow(this.sourceElement, t)
                    }
                })
            }

            static create(t, e = {}) {
                return new Promise(i => {
                    const n = Kr(t);
                    if (n && t.tagName === "TEXTAREA") {
                        throw new ss["b"]("editor-wrong-element: This type of editor cannot be initialized inside <textarea> element.", null)
                    }
                    const o = new this(t, e);
                    i(o.initPlugins().then(() => {
                        o.ui.init()
                    }).then(() => {
                        if (!n && e.initialData) {
                            throw new ss["b"]("editor-create-initial-data: " + "The config.initialData option cannot be used together with initial data passed in Editor.create().", null)
                        }
                        const i = e.initialData || Dw(t);
                        return o.data.init(i)
                    }).then(() => o.fire("ready")).then(() => o))
                })
            }
        }

        vs(Fw, Nw);
        vs(Fw, Bw);

        function Dw(t) {
            return Kr(t) ? Iw(t) : t
        }

        class jw {
            constructor(t) {
                this.editor = t;
                this.set("value", undefined);
                this.set("isEnabled", false);
                this._disableStack = new Set;
                this.decorate("execute");
                this.listenTo(this.editor.model.document, "change", () => {
                    this.refresh()
                });
                this.on("execute", t => {
                    // kbalashev (image upload button fix)
                    // if (!this.isEnabled) {
                    //     t.stop()
                    // }
                }, {priority: "high"});
                this.listenTo(t, "change:isReadOnly", (t, e, i) => {
                    if (i) {
                        this.forceDisabled("readOnlyMode")
                    } else {
                        this.clearForceDisabled("readOnlyMode")
                    }
                })
            }

            refresh() {
                this.isEnabled = true
            }

            forceDisabled(t) {
                this._disableStack.add(t);
                if (this._disableStack.size == 1) {
                    this.on("set:isEnabled", Hw, {priority: "highest"});
                    this.isEnabled = false
                }
            }

            clearForceDisabled(t) {
                this._disableStack.delete(t);
                if (this._disableStack.size == 0) {
                    this.off("set:isEnabled", Hw);
                    this.refresh()
                }
            }

            execute() {
            }

            destroy() {
                this.stopListening()
            }
        }

        vs(jw, Jc);

        function Hw(t) {
            t.return = false;
            t.stop()
        }

        function Ww(t) {
            const e = t.next();
            if (e.done) {
                return null
            }
            return e.value
        }

        const qw = ["left", "right", "center", "justify"];

        function Uw(t) {
            return qw.includes(t)
        }

        function $w(t, e) {
            if (e.contentLanguageDirection == "rtl") {
                return t === "right"
            } else {
                return t === "left"
            }
        }

        const Gw = "alignment";

        class Kw extends jw {
            refresh() {
                const t = this.editor;
                const e = t.locale;
                const i = Ww(this.editor.model.document.selection.getSelectedBlocks());
                this.isEnabled = !!i && this._canBeAligned(i);
                if (this.isEnabled && i.hasAttribute("alignment")) {
                    this.value = i.getAttribute("alignment")
                } else {
                    this.value = e.contentLanguageDirection === "rtl" ? "right" : "left"
                }
            }

            execute(t = {}) {
                const e = this.editor;
                const i = e.locale;
                const n = e.model;
                const o = n.document;
                const r = t.value;
                n.change(t => {
                    const e = Array.from(o.selection.getSelectedBlocks()).filter(t => this._canBeAligned(t));
                    const n = e[0].getAttribute("alignment");
                    const s = $w(r, i) || n === r || !r;
                    if (s) {
                        Jw(e, t)
                    } else {
                        Yw(e, t, r)
                    }
                })
            }

            _canBeAligned(t) {
                return this.editor.model.schema.checkAttribute(t, Gw)
            }
        }

        function Jw(t, e) {
            for (const i of t) {
                e.removeAttribute(Gw, i)
            }
        }

        function Yw(t, e, i) {
            for (const n of t) {
                e.setAttribute(Gw, i, n)
            }
        }

        class Qw extends mp {
            static get pluginName() {
                return "AlignmentEditing"
            }

            constructor(t) {
                super(t);
                t.config.define("alignment", {options: [...qw]})
            }

            init() {
                const t = this.editor;
                const e = t.locale;
                const i = t.model.schema;
                const n = t.config.get("alignment.options").filter(Uw);
                i.extend("$block", {allowAttributes: "alignment"});
                t.model.schema.setAttributeProperties("alignment", {isFormatting: true});
                const o = Xw(n.filter(t => !$w(t, e)));
                t.conversion.attributeToAttribute(o);
                t.commands.add("alignment", new Kw(t))
            }
        }

        function Xw(t) {
            const e = {model: {key: "alignment", values: t.slice()}, view: {}};
            for (const i of t) {
                e.view[i] = {key: "style", value: {"text-align": i}}
            }
            return e
        }

        var Zw = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>';
        var tk = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>';
        var ek = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>';
        var ik = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>';
        const nk = new Map([["left", Zw], ["right", tk], ["center", ek], ["justify", ik]]);

        class ok extends mp {
            get localizedOptionTitles() {
                const t = this.editor.t;
                return {left: t("iw"), right: t("ix"), center: t("iy"), justify: t("iz")}
            }

            static get pluginName() {
                return "AlignmentUI"
            }

            init() {
                const t = this.editor;
                const e = t.ui.componentFactory;
                const i = t.t;
                const n = t.config.get("alignment.options");
                n.filter(Uw).forEach(t => this._addButton(t));
                e.add("alignment", t => {
                    const o = Wb(t);
                    const r = n.map(t => e.create(`alignment:${t}`));
                    qb(o, r);
                    o.buttonView.set({label: i("ja"), tooltip: true});
                    o.toolbarView.isVertical = true;
                    o.toolbarView.ariaLabel = i("jb");
                    o.extendTemplate({attributes: {class: "ck-alignment-dropdown"}});
                    const s = t.contentLanguageDirection === "rtl" ? tk : Zw;
                    o.buttonView.bind("icon").toMany(r, "isOn", (...t) => {
                        const e = t.findIndex(t => t);
                        if (e < 0) {
                            return s
                        }
                        return r[e].icon
                    });
                    o.bind("isEnabled").toMany(r, "isEnabled", (...t) => t.some(t => t));
                    return o
                })
            }

            _addButton(t) {
                const e = this.editor;
                e.ui.componentFactory.add(`alignment:${t}`, i => {
                    const n = e.commands.get("alignment");
                    const o = new hb(i);
                    o.set({label: this.localizedOptionTitles[t], icon: nk.get(t), tooltip: true, isToggleable: true});
                    o.bind("isEnabled").to(n);
                    o.bind("isOn").to(n, "value", e => e === t);
                    this.listenTo(o, "execute", () => {
                        e.execute("alignment", {value: t});
                        e.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class rk extends mp {
            static get requires() {
                return [Qw, ok]
            }

            static get pluginName() {
                return "Alignment"
            }
        }

        class sk {
            constructor(t) {
                this.context = t
            }

            destroy() {
                this.stopListening()
            }

            static get isContextPlugin() {
                return true
            }
        }

        vs(sk, Jc);

        class ak extends sk {
            static get pluginName() {
                return "PendingActions"
            }

            init() {
                this.set("hasAny", false);
                this._actions = new ys({idProperty: "_id"});
                this._actions.delegate("add", "remove").to(this)
            }

            add(t) {
                if (typeof t !== "string") {
                    throw new ss["b"]("pendingactions-add-invalid-message: The message must be a string.", this)
                }
                const e = Object.create(Jc);
                e.set("message", t);
                this._actions.add(e);
                this.hasAny = true;
                return e
            }

            remove(t) {
                this._actions.remove(t);
                this.hasAny = !!this._actions.length
            }

            get first() {
                return this._actions.get(0)
            }

            [Symbol.iterator]() {
                return this._actions[Symbol.iterator]()
            }
        }

        class ck {
            constructor() {
                const t = new window.FileReader;
                this._reader = t;
                this._data = undefined;
                this.set("loaded", 0);
                t.onprogress = t => {
                    this.loaded = t.loaded
                }
            }

            get error() {
                return this._reader.error
            }

            get data() {
                return this._data
            }

            read(t) {
                const e = this._reader;
                this.total = t.size;
                return new Promise((i, n) => {
                    e.onload = () => {
                        const t = e.result;
                        this._data = t;
                        i(t)
                    };
                    e.onerror = () => {
                        n("error")
                    };
                    e.onabort = () => {
                        n("aborted")
                    };
                    this._reader.readAsDataURL(t)
                })
            }

            abort() {
                this._reader.abort()
            }
        }

        vs(ck, Jc);

        class lk extends mp {
            static get pluginName() {
                return "FileRepository"
            }

            static get requires() {
                return [ak]
            }

            init() {
                this.loaders = new ys;
                this.loaders.on("add", () => this._updatePendingAction());
                this.loaders.on("remove", () => this._updatePendingAction());
                this._loadersMap = new Map;
                this._pendingAction = null;
                this.set("uploaded", 0);
                this.set("uploadTotal", null);
                this.bind("uploadedPercent").to(this, "uploaded", this, "uploadTotal", (t, e) => e ? t / e * 100 : 0)
            }

            getLoader(t) {
                return this._loadersMap.get(t) || null
            }

            createLoader(t) {
                if (!this.createUploadAdapter) {
                    console.warn(Object(ss["a"])("filerepository-no-upload-adapter: Upload adapter is not defined."));
                    return null
                }
                const e = new dk(Promise.resolve(t), this.createUploadAdapter);
                this.loaders.add(e);
                this._loadersMap.set(t, e);
                if (t instanceof Promise) {
                    e.file.then(t => {
                        this._loadersMap.set(t, e)
                    }).catch(() => {
                    })
                }
                e.on("change:uploaded", () => {
                    let t = 0;
                    for (const e of this.loaders) {
                        t += e.uploaded
                    }
                    this.uploaded = t
                });
                e.on("change:uploadTotal", () => {
                    let t = 0;
                    for (const e of this.loaders) {
                        if (e.uploadTotal) {
                            t += e.uploadTotal
                        }
                    }
                    this.uploadTotal = t
                });
                return e
            }

            destroyLoader(t) {
                const e = t instanceof dk ? t : this.getLoader(t);
                e._destroy();
                this.loaders.remove(e);
                this._loadersMap.forEach((t, i) => {
                    if (t === e) {
                        this._loadersMap.delete(i)
                    }
                })
            }

            _updatePendingAction() {
                const t = this.editor.plugins.get(ak);
                if (this.loaders.length) {
                    if (!this._pendingAction) {
                        const e = this.editor.t;
                        const i = t => `${e("lb")} ${parseInt(t)}%.`;
                        this._pendingAction = t.add(i(this.uploadedPercent));
                        this._pendingAction.bind("message").to(this, "uploadedPercent", i)
                    }
                } else {
                    t.remove(this._pendingAction);
                    this._pendingAction = null
                }
            }
        }

        vs(lk, Jc);

        class dk {
            constructor(t, e) {
                this.id = is();
                this._filePromiseWrapper = this._createFilePromiseWrapper(t);
                this._adapter = e(this);
                this._reader = new ck;
                this.set("status", "idle");
                this.set("uploaded", 0);
                this.set("uploadTotal", null);
                this.bind("uploadedPercent").to(this, "uploaded", this, "uploadTotal", (t, e) => e ? t / e * 100 : 0);
                this.set("uploadResponse", null)
            }

            get file() {
                if (!this._filePromiseWrapper) {
                    return Promise.resolve(null)
                } else {
                    return this._filePromiseWrapper.promise.then(t => this._filePromiseWrapper ? t : null)
                }
            }

            get data() {
                return this._reader.data
            }

            read() {
                if (this.status != "idle") {
                    throw new ss["b"]("filerepository-read-wrong-status: You cannot call read if the status is different than idle.", this)
                }
                this.status = "reading";
                return this.file.then(t => this._reader.read(t)).then(t => {
                    this.status = "idle";
                    return t
                }).catch(t => {
                    if (t === "aborted") {
                        this.status = "aborted";
                        throw"aborted"
                    }
                    this.status = "error";
                    throw this._reader.error ? this._reader.error : t
                })
            }

            upload() {
                if (this.status != "idle") {
                    throw new ss["b"]("filerepository-upload-wrong-status: You cannot call upload if the status is different than idle.", this)
                }
                this.status = "uploading";
                return this.file.then(() => this._adapter.upload()).then(t => {
                    this.uploadResponse = t;
                    this.status = "idle";
                    return t
                }).catch(t => {
                    if (this.status === "aborted") {
                        throw"aborted"
                    }
                    this.status = "error";
                    throw t
                })
            }

            abort() {
                const t = this.status;
                this.status = "aborted";
                if (!this._filePromiseWrapper.isFulfilled) {
                    this._filePromiseWrapper.promise.catch(() => {
                    });
                    this._filePromiseWrapper.rejecter("aborted")
                } else if (t == "reading") {
                    this._reader.abort()
                } else if (t == "uploading" && this._adapter.abort) {
                    this._adapter.abort()
                }
                this._destroy()
            }

            _destroy() {
                this._filePromiseWrapper = undefined;
                this._reader = undefined;
                this._adapter = undefined;
                this.uploadResponse = undefined
            }

            _createFilePromiseWrapper(t) {
                const e = {};
                e.promise = new Promise((i, n) => {
                    e.rejecter = n;
                    e.isFulfilled = false;
                    t.then(t => {
                        e.isFulfilled = true;
                        i(t)
                    }).catch(t => {
                        e.isFulfilled = true;
                        n(t)
                    })
                });
                return e
            }
        }

        vs(dk, Jc);

        class uk extends mp {
            static get requires() {
                return [lk]
            }

            static get pluginName() {
                return "Base64UploadAdapter"
            }

            init() {
                this.editor.plugins.get(lk).createUploadAdapter = t => new hk(t)
            }
        }

        class hk {
            constructor(t) {
                this.loader = t
            }

            upload() {
                return new Promise((t, e) => {
                    const i = this.reader = new window.FileReader;
                    i.addEventListener("load", () => {
                        t({default: i.result})
                    });
                    i.addEventListener("error", t => {
                        e(t)
                    });
                    i.addEventListener("abort", () => {
                        e()
                    });
                    this.loader.file.then(t => {
                        i.readAsDataURL(t)
                    })
                })
            }

            abort() {
                this.reader.abort()
            }
        }

        class fk extends jw {
            refresh() {
                this.value = this._getValue();
                this.isEnabled = this._checkEnabled()
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.schema;
                const n = e.document.selection;
                const o = Array.from(n.getSelectedBlocks());
                const r = t.forceValue === undefined ? !this.value : t.forceValue;
                e.change(t => {
                    if (!r) {
                        this._removeQuote(t, o.filter(gk))
                    } else {
                        const e = o.filter(t => gk(t) || pk(i, t));
                        this._applyQuote(t, e)
                    }
                })
            }

            _getValue() {
                const t = this.editor.model.document.selection;
                const e = Ww(t.getSelectedBlocks());
                return !!(e && gk(e))
            }

            _checkEnabled() {
                if (this.value) {
                    return true
                }
                const t = this.editor.model.document.selection;
                const e = this.editor.model.schema;
                const i = Ww(t.getSelectedBlocks());
                if (!i) {
                    return false
                }
                return pk(e, i)
            }

            _removeQuote(t, e) {
                mk(t, e).reverse().forEach(e => {
                    if (e.start.isAtStart && e.end.isAtEnd) {
                        t.unwrap(e.start.parent);
                        return
                    }
                    if (e.start.isAtStart) {
                        const i = t.createPositionBefore(e.start.parent);
                        t.move(e, i);
                        return
                    }
                    if (!e.end.isAtEnd) {
                        t.split(e.end)
                    }
                    const i = t.createPositionAfter(e.end.parent);
                    t.move(e, i)
                })
            }

            _applyQuote(t, e) {
                const i = [];
                mk(t, e).reverse().forEach(e => {
                    let n = gk(e.start);
                    if (!n) {
                        n = t.createElement("blockQuote");
                        t.wrap(e, n)
                    }
                    i.push(n)
                });
                i.reverse().reduce((e, i) => {
                    if (e.nextSibling == i) {
                        t.merge(t.createPositionAfter(e));
                        return e
                    }
                    return i
                })
            }
        }

        function gk(t) {
            return t.parent.name == "blockQuote" ? t.parent : null
        }

        function mk(t, e) {
            let i;
            let n = 0;
            const o = [];
            while (n < e.length) {
                const r = e[n];
                const s = e[n + 1];
                if (!i) {
                    i = t.createPositionBefore(r)
                }
                if (!s || r.nextSibling != s) {
                    o.push(t.createRange(i, t.createPositionAfter(r)));
                    i = null
                }
                n++
            }
            return o
        }

        function pk(t, e) {
            const i = t.checkChild(e.parent, "blockQuote");
            const n = t.checkChild(["$root", "blockQuote"], e);
            return i && n
        }

        class bk extends mp {
            static get pluginName() {
                return "BlockQuoteEditing"
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                t.commands.add("blockQuote", new fk(t));
                e.register("blockQuote", {allowWhere: "$block", allowContentOf: "$root"});
                e.addChildCheck((t, e) => {
                    if (t.endsWith("blockQuote") && e.name == "blockQuote") {
                        return false
                    }
                });
                t.conversion.elementToElement({model: "blockQuote", view: "blockquote"});
                t.model.document.registerPostFixer(i => {
                    const n = t.model.document.differ.getChanges();
                    for (const t of n) {
                        if (t.type == "insert") {
                            const n = t.position.nodeAfter;
                            if (!n) {
                                continue
                            }
                            if (n.is("blockQuote") && n.isEmpty) {
                                i.remove(n);
                                return true
                            } else if (n.is("blockQuote") && !e.checkChild(t.position, n)) {
                                i.unwrap(n);
                                return true
                            } else if (n.is("element")) {
                                const t = i.createRangeIn(n);
                                for (const n of t.getItems()) {
                                    if (n.is("blockQuote") && !e.checkChild(i.createPositionBefore(n), n)) {
                                        i.unwrap(n);
                                        return true
                                    }
                                }
                            }
                        } else if (t.type == "remove") {
                            const e = t.position.parent;
                            if (e.is("blockQuote") && e.isEmpty) {
                                i.remove(e);
                                return true
                            }
                        }
                    }
                    return false
                })
            }

            afterInit() {
                const t = this.editor;
                const e = t.commands.get("blockQuote");
                this.listenTo(this.editor.editing.view.document, "enter", (t, i) => {
                    const n = this.editor.model.document;
                    const o = n.selection.getLastPosition().parent;
                    if (n.selection.isCollapsed && o.isEmpty && e.value) {
                        this.editor.execute("blockQuote");
                        this.editor.editing.view.scrollToTheSelection();
                        i.preventDefault();
                        t.stop()
                    }
                })
            }
        }

        var wk = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>';
        var kk = i(45);

        class _k extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add("blockQuote", i => {
                    const n = t.commands.get("blockQuote");
                    const o = new hb(i);
                    o.set({label: e("jc"), icon: wk, tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute("blockQuote");
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class vk extends mp {
            static get requires() {
                return [bk, _k]
            }

            static get pluginName() {
                return "BlockQuote"
            }
        }

        class yk extends jw {
            constructor(t, e) {
                super(t);
                this.attributeKey = e
            }

            refresh() {
                const t = this.editor.model;
                const e = t.document;
                this.value = this._getValueFromFirstAllowedNode();
                this.isEnabled = t.schema.checkAttributeInSelection(e.selection, this.attributeKey)
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document;
                const n = i.selection;
                const o = t.forceValue === undefined ? !this.value : t.forceValue;
                e.change(t => {
                    if (n.isCollapsed) {
                        if (o) {
                            t.setSelectionAttribute(this.attributeKey, true)
                        } else {
                            t.removeSelectionAttribute(this.attributeKey)
                        }
                    } else {
                        const i = e.schema.getValidRanges(n.getRanges(), this.attributeKey);
                        for (const e of i) {
                            if (o) {
                                t.setAttribute(this.attributeKey, o, e)
                            } else {
                                t.removeAttribute(this.attributeKey, e)
                            }
                        }
                    }
                })
            }

            _getValueFromFirstAllowedNode() {
                const t = this.editor.model;
                const e = t.schema;
                const i = t.document.selection;
                if (i.isCollapsed) {
                    return i.hasAttribute(this.attributeKey)
                }
                for (const t of i.getRanges()) {
                    for (const i of t.getItems()) {
                        if (e.checkAttribute(i, this.attributeKey)) {
                            return i.hasAttribute(this.attributeKey)
                        }
                    }
                }
                return false
            }
        }

        const xk = "bold";

        class Ck extends mp {
            static get pluginName() {
                return "BoldEditing"
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: xk});
                t.model.schema.setAttributeProperties(xk, {isFormatting: true, copyOnEnter: true});
                t.conversion.attributeToElement({
                    model: xk, view: "strong", upcastAlso: ["b", t => {
                        const e = t.getStyle("font-weight");
                        if (!e) {
                            return null
                        }
                        if (e == "bold" || Number(e) >= 600) {
                            return {name: true, styles: ["font-weight"]}
                        }
                    }]
                });
                t.commands.add(xk, new yk(t, xk));
                t.keystrokes.set("CTRL+B", xk)
            }
        }

        var Ak = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>';
        const Tk = "bold";

        class Pk extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(Tk, i => {
                    const n = t.commands.get(Tk);
                    const o = new hb(i);
                    o.set({label: e("ji"), icon: Ak, keystroke: "CTRL+B", tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(Tk);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class Sk extends mp {
            static get requires() {
                return [Ck, Pk]
            }

            static get pluginName() {
                return "Bold"
            }
        }

        class Ek extends jw {
            constructor(t, e) {
                super(t);
                this.attributeKey = e
            }

            refresh() {
                const t = this.editor.model;
                const e = t.document;
                this.value = e.selection.getAttribute(this.attributeKey);
                this.isEnabled = t.schema.checkAttributeInSelection(e.selection, this.attributeKey)
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document;
                const n = i.selection;
                const o = t.value;
                e.change(t => {
                    if (n.isCollapsed) {
                        if (o) {
                            t.setSelectionAttribute(this.attributeKey, o)
                        } else {
                            t.removeSelectionAttribute(this.attributeKey)
                        }
                    } else {
                        const i = e.schema.getValidRanges(n.getRanges(), this.attributeKey);
                        for (const e of i) {
                            if (o) {
                                t.setAttribute(this.attributeKey, o, e)
                            } else {
                                t.removeAttribute(this.attributeKey, e)
                            }
                        }
                    }
                })
            }
        }

        var Rk = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035L8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';

        class Ok extends hb {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                this.set("color");
                this.set("hasBorder");
                this.icon = Rk;
                this.extendTemplate({
                    attributes: {
                        style: {backgroundColor: e.to("color")},
                        class: ["ck", "ck-color-grid__tile", e.if("hasBorder", "ck-color-table__color-tile_bordered")]
                    }
                })
            }

            render() {
                super.render();
                this.iconView.fillColor = "hsl(0, 0%, 100%)"
            }
        }

        var Ik = i(47);

        class Vk extends Gp {
            constructor(t, e) {
                super(t);
                const i = e && e.colorDefinitions || [];
                const n = {};
                if (e && e.columns) {
                    n.gridTemplateColumns = `repeat( ${e.columns}, 1fr)`
                }
                this.set("selectedColor");
                this.items = this.createCollection();
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this._focusCycler = new yb({
                    focusables: this.items,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "arrowleft", focusNext: "arrowright"}
                });
                this.items.on("add", (t, e) => {
                    e.isOn = e.color === this.selectedColor
                });
                i.forEach(t => {
                    const e = new Ok;
                    e.set({color: t.color, label: t.label, tooltip: true, hasBorder: t.options.hasBorder});
                    e.on("execute", () => {
                        this.fire("execute", {value: t.color, hasBorder: t.options.hasBorder, label: t.label})
                    });
                    this.items.add(e)
                });
                this.setTemplate({
                    tag: "div",
                    children: this.items,
                    attributes: {class: ["ck", "ck-color-grid"], style: n}
                });
                this.on("change:selectedColor", (t, e, i) => {
                    for (const t of this.items) {
                        t.isOn = t.color === i
                    }
                })
            }

            focus() {
                if (this.items.length) {
                    this.items.first.focus()
                }
            }

            focusLast() {
                if (this.items.length) {
                    this.items.last.focus()
                }
            }

            render() {
                super.render();
                for (const t of this.items) {
                    this.focusTracker.add(t.element)
                }
                this.items.on("add", (t, e) => {
                    this.focusTracker.add(e.element)
                });
                this.items.on("remove", (t, e) => {
                    this.focusTracker.remove(e.element)
                });
                this.keystrokes.listenTo(this.element)
            }
        }

        var Nk = i(49);

        class Mk extends Gp {
            constructor(t) {
                super(t);
                this.set("text");
                this.set("for");
                this.id = `ck-editor__label_${is()}`;
                const e = this.bindTemplate;
                this.setTemplate({
                    tag: "label",
                    attributes: {class: ["ck", "ck-label"], id: this.id, for: e.to("for")},
                    children: [{text: e.to("text")}]
                })
            }
        }

        class Bk extends ys {
            constructor(t) {
                super(t);
                this.set("isEmpty", true)
            }

            add(t, e) {
                if (this.find(e => e.color === t.color)) {
                    return
                }
                super.add(t, e);
                this.set("isEmpty", false)
            }

            remove(t) {
                const e = super.remove(t);
                if (this.length === 0) {
                    this.set("isEmpty", true)
                }
                return e
            }

            hasColor(t) {
                return !!this.find(e => e.color === t)
            }
        }

        vs(Bk, Jc);
        var zk = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.636 9.531l-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>';
        var Lk = i(51);

        class Fk extends Gp {
            constructor(t, {colors: e, columns: i, removeButtonLabel: n, documentColorsLabel: o, documentColorsCount: r}) {
                super(t);
                this.items = this.createCollection();
                this.colorDefinitions = e;
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.set("selectedColor");
                this.removeButtonLabel = n;
                this.columns = i;
                this.documentColors = new Bk;
                this.documentColorsCount = r;
                this._focusCycler = new yb({
                    focusables: this.items,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "arrowup", focusNext: "arrowdown"}
                });
                this._documentColorsLabel = o;
                this.setTemplate({tag: "div", attributes: {class: ["ck", "ck-color-table"]}, children: this.items});
                this.items.add(this._removeColorButton())
            }

            updateDocumentColors(t, e) {
                const i = t.document;
                const n = this.documentColorsCount;
                this.documentColors.clear();
                for (const o of i.getRootNames()) {
                    const r = i.getRoot(o);
                    const s = t.createRangeIn(r);
                    for (const t of s.getItems()) {
                        if (t.is("textProxy") && t.hasAttribute(e)) {
                            this._addColorToDocumentColors(t.getAttribute(e));
                            if (this.documentColors.length >= n) {
                                return
                            }
                        }
                    }
                }
            }

            updateSelectedColors() {
                const t = this.documentColorsGrid;
                const e = this.staticColorsGrid;
                const i = this.selectedColor;
                e.selectedColor = i;
                if (t) {
                    t.selectedColor = i
                }
            }

            render() {
                super.render();
                for (const t of this.items) {
                    this.focusTracker.add(t.element)
                }
                this.keystrokes.listenTo(this.element)
            }

            appendGrids() {
                if (this.staticColorsGrid) {
                    return
                }
                this.staticColorsGrid = this._createStaticColorsGrid();
                this.items.add(this.staticColorsGrid);
                if (this.documentColorsCount) {
                    const t = _p.bind(this.documentColors, this.documentColors);
                    const e = new Mk(this.locale);
                    e.text = this._documentColorsLabel;
                    e.extendTemplate({attributes: {class: ["ck", "ck-color-grid__label", t.if("isEmpty", "ck-hidden")]}});
                    this.items.add(e);
                    this.documentColorsGrid = this._createDocumentColorsGrid();
                    this.items.add(this.documentColorsGrid)
                }
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            focusLast() {
                this._focusCycler.focusLast()
            }

            _removeColorButton() {
                const t = new hb;
                t.set({withText: true, icon: zk, tooltip: true, label: this.removeButtonLabel});
                t.class = "ck-color-table__remove-color";
                t.on("execute", () => {
                    this.fire("execute", {value: null})
                });
                return t
            }

            _createStaticColorsGrid() {
                const t = new Vk(this.locale, {colorDefinitions: this.colorDefinitions, columns: this.columns});
                t.delegate("execute").to(this);
                return t
            }

            _createDocumentColorsGrid() {
                const t = _p.bind(this.documentColors, this.documentColors);
                const e = new Vk(this.locale, {columns: this.columns});
                e.delegate("execute").to(this);
                e.extendTemplate({attributes: {class: t.if("isEmpty", "ck-hidden")}});
                e.items.bindTo(this.documentColors).using(t => {
                    const e = new Ok;
                    e.set({color: t.color, hasBorder: t.options && t.options.hasBorder});
                    if (t.label) {
                        e.set({label: t.label, tooltip: true})
                    }
                    e.on("execute", () => {
                        this.fire("execute", {value: t.color})
                    });
                    return e
                });
                this.documentColors.on("change:isEmpty", (t, i, n) => {
                    if (n) {
                        e.selectedColor = null
                    }
                });
                return e
            }

            _addColorToDocumentColors(t) {
                const e = this.colorDefinitions.find(e => e.color === t);
                if (!e) {
                    this.documentColors.add({color: t, label: t, options: {hasBorder: false}})
                } else {
                    this.documentColors.add(Object.assign({}, e))
                }
            }
        }

        const Dk = "fontSize";
        const jk = "fontFamily";
        const Hk = "fontColor";
        const Wk = "fontBackgroundColor";

        function qk(t, e) {
            const i = {model: {key: t, values: []}, view: {}, upcastAlso: {}};
            for (const t of e) {
                i.model.values.push(t.model);
                i.view[t.model] = t.view;
                if (t.upcastAlso) {
                    i.upcastAlso[t.model] = t.upcastAlso
                }
            }
            return i
        }

        function Uk(t) {
            return e => Kk(e.getStyle(t))
        }

        function $k(t) {
            return (e, i) => i.createAttributeElement("span", {style: `${t}:${e}`}, {priority: 7})
        }

        function Gk({dropdownView: t, colors: e, columns: i, removeButtonLabel: n, documentColorsLabel: o, documentColorsCount: r}) {
            const s = t.locale;
            const a = new Fk(s, {
                colors: e,
                columns: i,
                removeButtonLabel: n,
                documentColorsLabel: o,
                documentColorsCount: r
            });
            t.colorTableView = a;
            t.panelView.children.add(a);
            a.delegate("execute").to(t, "execute");
            return a
        }

        function Kk(t) {
            return t.replace(/\s/g, "")
        }

        class Jk extends Ek {
            constructor(t) {
                super(t, jk)
            }
        }

        function Yk(t) {
            return t.map(Qk).filter(t => !!t)
        }

        function Qk(t) {
            if (typeof t === "object") {
                return t
            }
            if (t === "default") {
                return {title: "Default", model: undefined}
            }
            if (typeof t !== "string") {
                return
            }
            return Xk(t)
        }

        function Xk(t) {
            const e = t.replace(/"|'/g, "").split(",");
            const i = e[0];
            const n = e.map(Zk).join(", ");
            return {title: i, model: i, view: {name: "span", styles: {"font-family": n}, priority: 7}}
        }

        function Zk(t) {
            t = t.trim();
            if (t.indexOf(" ") > 0) {
                t = `'${t}'`
            }
            return t
        }

        class t_ extends mp {
            static get pluginName() {
                return "FontFamilyEditing"
            }

            constructor(t) {
                super(t);
                t.config.define(jk, {options: ["default", "Arial, Helvetica, sans-serif", "Courier New, Courier, monospace", "Georgia, serif", "Lucida Sans Unicode, Lucida Grande, sans-serif", "Tahoma, Geneva, sans-serif", "Times New Roman, Times, serif", "Trebuchet MS, Helvetica, sans-serif", "Verdana, Geneva, sans-serif"]})
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: jk});
                t.model.schema.setAttributeProperties(jk, {isFormatting: true, copyOnEnter: true});
                const e = Yk(t.config.get("fontFamily.options")).filter(t => t.model);
                const i = qk(jk, e);
                t.conversion.attributeToElement(i);
                t.commands.add(jk, new Jk(t))
            }
        }

        class e_ {
            constructor(t, e) {
                if (e) {
                    qc(this, e)
                }
                if (t) {
                    this.set(t)
                }
            }
        }

        vs(e_, Jc);
        var i_ = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';

        class n_ extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                const i = this._getLocalizedOptions();
                const n = t.commands.get(jk);
                t.ui.componentFactory.add(jk, o => {
                    const r = Wb(o);
                    Ub(r, o_(i, n));
                    r.buttonView.set({label: e("jo"), icon: i_, tooltip: true});
                    r.extendTemplate({attributes: {class: "ck-font-family-dropdown"}});
                    r.bind("isEnabled").to(n);
                    this.listenTo(r, "execute", e => {
                        t.execute(e.source.commandName, {value: e.source.commandParam});
                        t.editing.view.focus()
                    });
                    return r
                })
            }

            _getLocalizedOptions() {
                const t = this.editor;
                const e = t.t;
                const i = Yk(t.config.get(jk).options);
                return i.map(t => {
                    if (t.title === "Default") {
                        t.title = e("jp")
                    }
                    return t
                })
            }
        }

        function o_(t, e) {
            const i = new ys;
            for (const n of t) {
                const t = {
                    type: "button",
                    model: new e_({commandName: jk, commandParam: n.model, label: n.title, withText: true})
                };
                t.model.bind("isOn").to(e, "value", t => t === n.model);
                if (n.view && n.view.styles) {
                    t.model.set("labelStyle", `font-family: ${n.view.styles["font-family"]}`)
                }
                i.add(t)
            }
            return i
        }

        class r_ extends mp {
            static get requires() {
                return [t_, n_]
            }

            static get pluginName() {
                return "FontFamily"
            }
        }

        class s_ extends Ek {
            constructor(t) {
                super(t, Dk)
            }
        }

        function a_(t) {
            return t.map(l_).filter(t => !!t)
        }

        const c_ = {
            tiny: {title: "Tiny", model: "tiny", view: {name: "span", classes: "text-tiny", priority: 7}},
            small: {title: "Small", model: "small", view: {name: "span", classes: "text-small", priority: 7}},
            big: {title: "Big", model: "big", view: {name: "span", classes: "text-big", priority: 7}},
            huge: {title: "Huge", model: "huge", view: {name: "span", classes: "text-huge", priority: 7}}
        };

        function l_(t) {
            if (typeof t === "object") {
                return t
            }
            if (c_[t]) {
                return c_[t]
            }
            if (t === "default") {
                return {model: undefined, title: "Default"}
            }
            const e = parseFloat(t);
            if (isNaN(e)) {
                return
            }
            return d_(e)
        }

        function d_(t) {
            const e = String(t);
            return {title: e, model: t, view: {name: "span", styles: {"font-size": `${t}px`}, priority: 7}}
        }

        class u_ extends mp {
            static get pluginName() {
                return "FontSizeEditing"
            }

            constructor(t) {
                super(t);
                t.config.define(Dk, {options: ["tiny", "small", "default", "big", "huge"]});
                const e = a_(this.editor.config.get("fontSize.options")).filter(t => t.model);
                const i = qk(Dk, e);
                t.conversion.attributeToElement(i);
                t.commands.add(Dk, new s_(t))
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: Dk});
                t.model.schema.setAttributeProperties(Dk, {isFormatting: true, copyOnEnter: true})
            }
        }

        var h_ = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5L7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279l.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';
        var f_ = i(53);

        class g_ extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                const i = this._getLocalizedOptions();
                const n = t.commands.get(Dk);
                t.ui.componentFactory.add(Dk, o => {
                    const r = Wb(o);
                    Ub(r, m_(i, n));
                    r.buttonView.set({label: e("jq"), icon: h_, tooltip: true});
                    r.extendTemplate({attributes: {class: ["ck-font-size-dropdown"]}});
                    r.bind("isEnabled").to(n);
                    this.listenTo(r, "execute", e => {
                        t.execute(e.source.commandName, {value: e.source.commandParam});
                        t.editing.view.focus()
                    });
                    return r
                })
            }

            _getLocalizedOptions() {
                const t = this.editor;
                const e = t.t;
                const i = {Default: e("jp"), Tiny: e("jr"), Small: e("js"), Big: e("jt"), Huge: e("ju")};
                const n = a_(t.config.get(Dk).options);
                return n.map(t => {
                    const e = i[t.title];
                    if (e && e != t.title) {
                        t = Object.assign({}, t, {title: e})
                    }
                    return t
                })
            }
        }

        function m_(t, e) {
            const i = new ys;
            for (const n of t) {
                const t = {
                    type: "button",
                    model: new e_({
                        commandName: Dk,
                        commandParam: n.model,
                        label: n.title,
                        class: "ck-fontsize-option",
                        withText: true
                    })
                };
                if (n.view && n.view.styles) {
                    t.model.set("labelStyle", `font-size:${n.view.styles["font-size"]}`)
                }
                if (n.view && n.view.classes) {
                    t.model.set("class", `${t.model.class} ${n.view.classes}`)
                }
                t.model.bind("isOn").to(e, "value", t => t === n.model);
                i.add(t)
            }
            return i
        }

        class p_ extends mp {
            static get requires() {
                return [u_, g_]
            }

            static get pluginName() {
                return "FontSize"
            }
        }

        class b_ extends Ek {
            constructor(t) {
                super(t, Hk)
            }
        }

        class w_ extends mp {
            static get pluginName() {
                return "FontColorEditing"
            }

            constructor(t) {
                super(t);
                t.config.define(Hk, {
                    colors: [{color: "hsl(0, 0%, 0%)", label: "Black"}, {
                        color: "hsl(0, 0%, 30%)",
                        label: "Dim grey"
                    }, {color: "hsl(0, 0%, 60%)", label: "Grey"}, {
                        color: "hsl(0, 0%, 90%)",
                        label: "Light grey"
                    }, {color: "hsl(0, 0%, 100%)", label: "White", hasBorder: true}, {
                        color: "hsl(0, 75%, 60%)",
                        label: "Red"
                    }, {color: "hsl(30, 75%, 60%)", label: "Orange"}, {
                        color: "hsl(60, 75%, 60%)",
                        label: "Yellow"
                    }, {color: "hsl(90, 75%, 60%)", label: "Light green"}, {
                        color: "hsl(120, 75%, 60%)",
                        label: "Green"
                    }, {color: "hsl(150, 75%, 60%)", label: "Aquamarine"}, {
                        color: "hsl(180, 75%, 60%)",
                        label: "Turquoise"
                    }, {color: "hsl(210, 75%, 60%)", label: "Light blue"}, {
                        color: "hsl(240, 75%, 60%)",
                        label: "Blue"
                    }, {color: "hsl(270, 75%, 60%)", label: "Purple"}], columns: 5
                });
                t.conversion.for("upcast").elementToAttribute({
                    view: {name: "span", styles: {color: /[\s\S]+/}},
                    model: {key: Hk, value: Uk("color")}
                });
                t.conversion.for("downcast").attributeToElement({model: Hk, view: $k("color")});
                t.commands.add(Hk, new b_(t));
                t.model.schema.extend("$text", {allowAttributes: Hk});
                t.model.schema.setAttributeProperties(Hk, {isFormatting: true, copyOnEnter: true})
            }
        }

        function k_(t, e) {
            const i = t.t;
            const n = {
                Black: i("lx"),
                "Dim grey": i("ly"),
                Grey: i("lz"),
                "Light grey": i("ma"),
                White: i("mb"),
                Red: i("mc"),
                Orange: i("md"),
                Yellow: i("me"),
                "Light green": i("mf"),
                Green: i("mg"),
                Aquamarine: i("mh"),
                Turquoise: i("mi"),
                "Light blue": i("mj"),
                Blue: i("mk"),
                Purple: i("ml")
            };
            return e.map(t => {
                const e = n[t.label];
                if (e && e != t.label) {
                    t.label = e
                }
                return t
            })
        }

        function __(t) {
            return t.map(v_).filter(t => !!t)
        }

        function v_(t) {
            if (typeof t === "string") {
                return {
                    model: t.replace(/ /g, ""),
                    label: t,
                    hasBorder: false,
                    view: {name: "span", styles: {color: t}}
                }
            } else {
                return {
                    model: t.color.replace(/ /g, ""),
                    label: t.label || t.color,
                    hasBorder: t.hasBorder === undefined ? false : t.hasBorder,
                    view: {name: "span", styles: {color: `${t.color}`}}
                }
            }
        }

        class y_ extends mp {
            constructor(t, {commandName: e, icon: i, componentName: n, dropdownLabel: o}) {
                super(t);
                this.commandName = e;
                this.componentName = n;
                this.icon = i;
                this.dropdownLabel = o;
                this.columns = t.config.get(`${this.componentName}.columns`);
                this.colorTableView
            }

            init() {
                const t = this.editor;
                const e = t.locale;
                const i = e.t;
                const n = t.commands.get(this.commandName);
                const o = __(t.config.get(this.componentName).colors);
                const r = k_(e, o);
                const s = t.config.get(`${this.componentName}.documentColors`);
                t.ui.componentFactory.add(this.componentName, e => {
                    const o = Wb(e);
                    this.colorTableView = Gk({
                        dropdownView: o,
                        colors: r.map(t => ({label: t.label, color: t.model, options: {hasBorder: t.hasBorder}})),
                        columns: this.columns,
                        removeButtonLabel: i("li"),
                        documentColorsLabel: s !== 0 ? i("lj") : undefined,
                        documentColorsCount: s === undefined ? this.columns : s
                    });
                    this.colorTableView.bind("selectedColor").to(n, "value");
                    o.buttonView.set({label: this.dropdownLabel, icon: this.icon, tooltip: true});
                    o.extendTemplate({attributes: {class: "ck-color-ui-dropdown"}});
                    o.bind("isEnabled").to(n);
                    o.on("execute", (e, i) => {
                        t.execute(this.commandName, i);
                        t.editing.view.focus()
                    });
                    o.on("change:isOpen", (e, i, n) => {
                        o.colorTableView.appendGrids();
                        if (n) {
                            if (s !== 0) {
                                this.colorTableView.updateDocumentColors(t.model, this.componentName)
                            }
                            this.colorTableView.updateSelectedColors()
                        }
                    });
                    return o
                })
            }
        }

        var x_ = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3L10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>';

        class C_ extends y_ {
            constructor(t) {
                const e = t.locale.t;
                super(t, {commandName: Hk, componentName: Hk, icon: x_, dropdownLabel: e("jv")})
            }

            static get pluginName() {
                return "FontColorUI"
            }
        }

        class A_ extends mp {
            static get requires() {
                return [w_, C_]
            }

            static get pluginName() {
                return "FontColor"
            }
        }

        class T_ extends Ek {
            constructor(t) {
                super(t, Wk)
            }
        }

        class P_ extends mp {
            static get pluginName() {
                return "FontBackgroundColorEditing"
            }

            constructor(t) {
                super(t);
                t.config.define(Wk, {
                    colors: [{color: "hsl(0, 0%, 0%)", label: "Black"}, {
                        color: "hsl(0, 0%, 30%)",
                        label: "Dim grey"
                    }, {color: "hsl(0, 0%, 60%)", label: "Grey"}, {
                        color: "hsl(0, 0%, 90%)",
                        label: "Light grey"
                    }, {color: "hsl(0, 0%, 100%)", label: "White", hasBorder: true}, {
                        color: "hsl(0, 75%, 60%)",
                        label: "Red"
                    }, {color: "hsl(30, 75%, 60%)", label: "Orange"}, {
                        color: "hsl(60, 75%, 60%)",
                        label: "Yellow"
                    }, {color: "hsl(90, 75%, 60%)", label: "Light green"}, {
                        color: "hsl(120, 75%, 60%)",
                        label: "Green"
                    }, {color: "hsl(150, 75%, 60%)", label: "Aquamarine"}, {
                        color: "hsl(180, 75%, 60%)",
                        label: "Turquoise"
                    }, {color: "hsl(210, 75%, 60%)", label: "Light blue"}, {
                        color: "hsl(240, 75%, 60%)",
                        label: "Blue"
                    }, {color: "hsl(270, 75%, 60%)", label: "Purple"}], columns: 5
                });
                t.conversion.for("upcast").elementToAttribute({
                    view: {
                        name: "span",
                        styles: {"background-color": /[\s\S]+/}
                    }, model: {key: Wk, value: Uk("background-color")}
                });
                t.conversion.for("downcast").attributeToElement({model: Wk, view: $k("background-color")});
                t.commands.add(Wk, new T_(t));
                t.model.schema.extend("$text", {allowAttributes: Wk});
                t.model.schema.setAttributeProperties(Wk, {isFormatting: true, copyOnEnter: true})
            }
        }

        var S_ = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>';

        class E_ extends y_ {
            constructor(t) {
                const e = t.locale.t;
                super(t, {commandName: Wk, componentName: Wk, icon: S_, dropdownLabel: e("jw")})
            }

            static get pluginName() {
                return "FontBackgroundColorUI"
            }
        }

        class R_ extends mp {
            static get requires() {
                return [P_, E_]
            }

            static get pluginName() {
                return "FontBackgroundColor"
            }
        }

        class O_ extends jw {
            refresh() {
                const t = this.editor.model;
                const e = t.document;
                const i = Ww(e.selection.getSelectedBlocks());
                this.value = !!i && i.is("paragraph");
                this.isEnabled = !!i && I_(i, t.schema)
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document;
                e.change(n => {
                    const o = (t.selection || i.selection).getSelectedBlocks();
                    for (const t of o) {
                        if (!t.is("paragraph") && I_(t, e.schema)) {
                            n.rename(t, "paragraph")
                        }
                    }
                })
            }
        }

        function I_(t, e) {
            return e.checkChild(t.parent, "paragraph") && !e.isObject(t)
        }

        class V_ extends mp {
            static get pluginName() {
                return "Paragraph"
            }

            init() {
                const t = this.editor;
                const e = t.model;
                const i = t.data;
                t.commands.add("paragraph", new O_(t));
                e.schema.register("paragraph", {inheritAllFrom: "$block"});
                t.conversion.elementToElement({model: "paragraph", view: "p"});
                t.conversion.for("upcast").elementToElement({
                    model: (t, e) => {
                        if (!V_.paragraphLikeElements.has(t.name)) {
                            return null
                        }
                        if (t.isEmpty) {
                            return null
                        }
                        return e.createElement("paragraph")
                    }, converterPriority: "low"
                });
                i.upcastDispatcher.on("element", (t, e, i) => {
                    if (!i.consumable.test(e.viewItem, {name: e.viewItem.name})) {
                        return
                    }
                    if (M_(e.viewItem, e.modelCursor, i.schema)) {
                        Object.assign(e, N_(e.viewItem, e.modelCursor, i))
                    }
                }, {priority: "low"});
                i.upcastDispatcher.on("text", (t, e, i) => {
                    if (e.modelRange) {
                        return
                    }
                    if (M_(e.viewItem, e.modelCursor, i.schema)) {
                        Object.assign(e, N_(e.viewItem, e.modelCursor, i))
                    }
                }, {priority: "lowest"});
                e.document.registerPostFixer(t => this._autoparagraphEmptyRoots(t));
                t.data.on("ready", () => {
                    e.enqueueChange("transparent", t => this._autoparagraphEmptyRoots(t))
                }, {priority: "lowest"})
            }

            _autoparagraphEmptyRoots(t) {
                const e = this.editor.model;
                for (const i of e.document.getRootNames()) {
                    const n = e.document.getRoot(i);
                    if (n.isEmpty && n.rootName != "$graveyard") {
                        if (e.schema.checkChild(n, "paragraph")) {
                            t.insertElement("paragraph", n);
                            return true
                        }
                    }
                }
            }
        }

        V_.paragraphLikeElements = new Set(["blockquote", "dd", "div", "dt", "h1", "h2", "h3", "h4", "h5", "h6", "li", "p", "td"]);

        function N_(t, e, i) {
            const n = i.writer.createElement("paragraph");
            i.writer.insert(n, e);
            return i.convertItem(t, i.writer.createPositionAt(n, 0))
        }

        function M_(t, e, i) {
            const n = i.createContext(e);
            if (!i.checkChild(n, "paragraph")) {
                return false
            }
            if (!i.checkChild(n.push("paragraph"), t)) {
                return false
            }
            return true
        }

        class B_ extends jw {
            constructor(t, e) {
                super(t);
                this.modelElements = e
            }

            refresh() {
                const t = Ww(this.editor.model.document.selection.getSelectedBlocks());
                this.value = !!t && this.modelElements.includes(t.name) && t.name;
                this.isEnabled = !!t && this.modelElements.some(e => z_(t, e, this.editor.model.schema))
            }

            execute(t) {
                const e = this.editor.model;
                const i = e.document;
                const n = t.value;
                e.change(t => {
                    const o = Array.from(i.selection.getSelectedBlocks()).filter(t => z_(t, n, e.schema));
                    for (const e of o) {
                        if (!e.is(n)) {
                            t.rename(e, n)
                        }
                    }
                })
            }
        }

        function z_(t, e, i) {
            return i.checkChild(t.parent, e) && !i.isObject(t)
        }

        const L_ = "paragraph";

        class F_ extends mp {
            static get pluginName() {
                return "HeadingEditing"
            }

            constructor(t) {
                super(t);
                t.config.define("heading", {
                    options: [{
                        model: "paragraph",
                        title: "Paragraph",
                        class: "ck-heading_paragraph"
                    }, {
                        model: "heading1",
                        view: "h2",
                        title: "Heading 1",
                        class: "ck-heading_heading1"
                    }, {
                        model: "heading2",
                        view: "h3",
                        title: "Heading 2",
                        class: "ck-heading_heading2"
                    }, {model: "heading3", view: "h4", title: "Heading 3", class: "ck-heading_heading3"}]
                })
            }

            static get requires() {
                return [V_]
            }

            init() {
                const t = this.editor;
                const e = t.config.get("heading.options");
                const i = [];
                for (const n of e) {
                    if (n.model !== L_) {
                        t.model.schema.register(n.model, {inheritAllFrom: "$block"});
                        t.conversion.elementToElement(n);
                        i.push(n.model)
                    }
                }
                this._addDefaultH1Conversion(t);
                t.commands.add("heading", new B_(t, i))
            }

            afterInit() {
                const t = this.editor;
                const e = t.commands.get("enter");
                const i = t.config.get("heading.options");
                if (e) {
                    this.listenTo(e, "afterExecute", (e, n) => {
                        const o = t.model.document.selection.getFirstPosition().parent;
                        const r = i.some(t => o.is(t.model));
                        if (r && !o.is(L_) && o.childCount === 0) {
                            n.writer.rename(o, L_)
                        }
                    })
                }
            }

            _addDefaultH1Conversion(t) {
                t.conversion.for("upcast").elementToElement({
                    model: "heading1",
                    view: "h1",
                    converterPriority: os.get("low") + 1
                })
            }
        }

        function D_(t) {
            const e = t.t;
            const i = {
                Paragraph: e("ny"),
                "Heading 1": e("nz"),
                "Heading 2": e("oa"),
                "Heading 3": e("ob"),
                "Heading 4": e("oc"),
                "Heading 5": e("od"),
                "Heading 6": e("oe")
            };
            return t.config.get("heading.options").map(t => {
                const e = i[t.title];
                if (e && e != t.title) {
                    t.title = e
                }
                return t
            })
        }

        var j_ = i(11);

        class H_ extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                const i = D_(t);
                const n = e("jd");
                const o = e("je");
                t.ui.componentFactory.add("heading", e => {
                    const r = {};
                    const s = new ys;
                    const a = t.commands.get("heading");
                    const c = t.commands.get("paragraph");
                    const l = [a];
                    for (const t of i) {
                        const e = {type: "button", model: new e_({label: t.title, class: t.class, withText: true})};
                        if (t.model === "paragraph") {
                            e.model.bind("isOn").to(c, "value");
                            e.model.set("commandName", "paragraph");
                            l.push(c)
                        } else {
                            e.model.bind("isOn").to(a, "value", e => e === t.model);
                            e.model.set({commandName: "heading", commandValue: t.model})
                        }
                        s.add(e);
                        r[t.model] = t.title
                    }
                    const d = Wb(e);
                    Ub(d, s);
                    d.buttonView.set({isOn: false, withText: true, tooltip: o});
                    d.extendTemplate({attributes: {class: ["ck-heading-dropdown"]}});
                    d.bind("isEnabled").toMany(l, "isEnabled", (...t) => t.some(t => t));
                    d.buttonView.bind("label").to(a, "value", c, "value", (t, e) => {
                        const i = t || e && "paragraph";
                        return r[i] ? r[i] : n
                    });
                    this.listenTo(d, "execute", e => {
                        t.execute(e.source.commandName, e.source.commandValue ? {value: e.source.commandValue} : undefined);
                        t.editing.view.focus()
                    });
                    return d
                })
            }
        }

        class W_ extends mp {
            static get requires() {
                return [F_, H_]
            }

            static get pluginName() {
                return "Heading"
            }
        }

        class q_ {
            constructor() {
                this._stack = []
            }

            add(t, e) {
                const i = this._stack;
                const n = i[0];
                this._insertDescriptor(t);
                const o = i[0];
                if (n !== o && !U_(n, o)) {
                    this.fire("change:top", {oldDescriptor: n, newDescriptor: o, writer: e})
                }
            }

            remove(t, e) {
                const i = this._stack;
                const n = i[0];
                this._removeDescriptor(t);
                const o = i[0];
                if (n !== o && !U_(n, o)) {
                    this.fire("change:top", {oldDescriptor: n, newDescriptor: o, writer: e})
                }
            }

            _insertDescriptor(t) {
                const e = this._stack;
                const i = e.findIndex(e => e.id === t.id);
                if (U_(t, e[i])) {
                    return
                }
                if (i > -1) {
                    e.splice(i, 1)
                }
                let n = 0;
                while (e[n] && $_(e[n], t)) {
                    n++
                }
                e.splice(n, 0, t)
            }

            _removeDescriptor(t) {
                const e = this._stack;
                const i = e.findIndex(e => e.id === t);
                if (i > -1) {
                    e.splice(i, 1)
                }
            }
        }

        vs(q_, ds);

        function U_(t, e) {
            return t && e && t.priority == e.priority && G_(t.classes) == G_(e.classes)
        }

        function $_(t, e) {
            if (t.priority > e.priority) {
                return true
            } else if (t.priority < e.priority) {
                return false
            }
            return G_(t.classes) > G_(e.classes)
        }

        function G_(t) {
            return Array.isArray(t) ? t.sort().join(",") : t
        }

        var K_ = '<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';
        const J_ = "ck-widget";
        const Y_ = "ck-widget_selected";

        function Q_(t) {
            if (!t.is("element")) {
                return false
            }
            return !!t.getCustomProperty("widget")
        }

        function X_(t, e, i = {}) {
            if (!Al.isEdge) {
                e.setAttribute("contenteditable", "false", t)
            }
            e.addClass(J_, t);
            e.setCustomProperty("widget", true, t);
            t.getFillerOffset = rv;
            if (i.label) {
                tv(t, i.label, e)
            }
            if (i.hasSelectionHandle) {
                sv(t, e)
            }
            Z_(t, e, (t, e, i) => i.addClass(n(e.classes), t), (t, e, i) => i.removeClass(n(e.classes), t));
            return t;

            function n(t) {
                return Array.isArray(t) ? t : [t]
            }
        }

        function Z_(t, e, i, n) {
            const o = new q_;
            o.on("change:top", (e, o) => {
                if (o.oldDescriptor) {
                    n(t, o.oldDescriptor, o.writer)
                }
                if (o.newDescriptor) {
                    i(t, o.newDescriptor, o.writer)
                }
            });
            e.setCustomProperty("addHighlight", (t, e, i) => o.add(e, i), t);
            e.setCustomProperty("removeHighlight", (t, e, i) => o.remove(e, i), t)
        }

        function tv(t, e, i) {
            i.setCustomProperty("widgetLabel", e, t)
        }

        function ev(t) {
            const e = t.getCustomProperty("widgetLabel");
            if (!e) {
                return ""
            }
            return typeof e == "function" ? e() : e
        }

        function iv(t, e) {
            e.addClass(["ck-editor__editable", "ck-editor__nested-editable"], t);
            if (!Al.isEdge) {
                e.setAttribute("contenteditable", t.isReadOnly ? "false" : "true", t);
                t.on("change:isReadOnly", (i, n, o) => {
                    e.setAttribute("contenteditable", o ? "false" : "true", t)
                })
            }
            t.on("change:isFocused", (i, n, o) => {
                if (o) {
                    e.addClass("ck-editor__nested-editable_focused", t)
                } else {
                    e.removeClass("ck-editor__nested-editable_focused", t)
                }
            });
            return t
        }

        function nv(t, e) {
            const i = t.getSelectedElement();
            if (i && e.schema.isBlock(i)) {
                return e.createPositionAfter(i)
            }
            const n = t.getSelectedBlocks().next().value;
            if (n) {
                if (n.isEmpty) {
                    return e.createPositionAt(n, 0)
                }
                const i = e.createPositionAfter(n);
                if (t.focus.isTouching(i)) {
                    return i
                }
                return e.createPositionBefore(n)
            }
            return t.focus
        }

        function ov(t, e) {
            return (i, n) => {
                const {mapper: o, viewPosition: r} = n;
                const s = o.findMappedViewAncestor(r);
                if (!e(s)) {
                    return
                }
                const a = o.toModelElement(s);
                n.modelPosition = t.createPositionAt(a, r.isAtStart ? "before" : "after")
            }
        }

        function rv() {
            return null
        }

        function sv(t, e) {
            const i = e.createUIElement("div", {class: "ck ck-widget__selection-handle"}, (function (t) {
                const e = this.toDomElement(t);
                const i = new cb;
                i.set("content", K_);
                i.render();
                e.appendChild(i.element);
                return e
            }));
            e.insert(e.createPositionAt(t, 0), i);
            e.addClass(["ck-widget_with-selection-handle"], t)
        }

        class av extends jw {
            refresh() {
                this.isEnabled = cv(this.editor.model)
            }

            execute() {
                const t = this.editor.model;
                t.change(e => {
                    const i = e.createElement("horizontalLine");
                    t.insertContent(i);
                    let n = i.nextSibling;
                    const o = n && t.schema.checkChild(n, "$text");
                    if (!o && t.schema.checkChild(i.parent, "paragraph")) {
                        n = e.createElement("paragraph");
                        t.insertContent(n, e.createPositionAfter(i))
                    }
                    if (n) {
                        e.setSelection(n, 0)
                    }
                })
            }
        }

        function cv(t) {
            const e = t.schema;
            const i = t.document.selection;
            return lv(i, e, t) && !dv(i, e)
        }

        function lv(t, e, i) {
            const n = uv(t, i);
            return e.checkChild(n, "horizontalLine")
        }

        function dv(t, e) {
            const i = t.getSelectedElement();
            return i && e.isObject(i)
        }

        function uv(t, e) {
            const i = nv(t, e);
            const n = i.parent;
            if (n.isEmpty && !n.is("$root")) {
                return n.parent
            }
            return n
        }

        var hv = i(56);

        class fv extends mp {
            static get pluginName() {
                return "HorizontalLineEditing"
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.t;
                const n = t.conversion;
                e.register("horizontalLine", {isObject: true, allowWhere: "$block"});
                n.for("dataDowncast").elementToElement({
                    model: "horizontalLine",
                    view: (t, e) => e.createEmptyElement("hr")
                });
                n.for("editingDowncast").elementToElement({
                    model: "horizontalLine", view: (t, e) => {
                        const n = i("jf");
                        const o = e.createContainerElement("div");
                        const r = e.createEmptyElement("hr");
                        e.addClass("ck-horizontal-line", o);
                        e.setCustomProperty("hr", true, o);
                        e.insert(e.createPositionAt(o, 0), r);
                        return gv(o, e, n)
                    }
                });
                n.for("upcast").elementToElement({view: "hr", model: "horizontalLine"});
                t.commands.add("horizontalLine", new av(t))
            }
        }

        function gv(t, e, i) {
            e.setCustomProperty("horizontalLine", true, t);
            return X_(t, e, {label: i})
        }

        var mv = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>';

        class pv extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add("horizontalLine", i => {
                    const n = t.commands.get("horizontalLine");
                    const o = new hb(i);
                    o.set({label: e("jf"), icon: mv, tooltip: true});
                    o.bind("isEnabled").to(n, "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute("horizontalLine");
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class bv extends mp {
            static get requires() {
                return [fv, pv]
            }

            static get pluginName() {
                return "HorizontalLine"
            }
        }

        class wv extends Gd {
            observe(t) {
                this.listenTo(t, "load", (t, e) => {
                    const i = e.target;
                    if (i.tagName == "IMG") {
                        this._fireEvents(e)
                    }
                }, {useCapture: true})
            }

            _fireEvents(t) {
                if (this.isEnabled) {
                    this.document.fire("layoutChanged");
                    this.document.fire("imageLoaded", t)
                }
            }
        }

        function kv(t, e, i) {
            e.setCustomProperty("image", true, t);
            return X_(t, e, {label: n});

            function n() {
                const e = Av(t);
                const n = e.getAttribute("alt");
                return n ? `${n} ${i}` : i
            }
        }

        function _v(t) {
            return !!t.getCustomProperty("image") && Q_(t)
        }

        function vv(t) {
            const e = t.getSelectedElement();
            if (e && _v(e)) {
                return e
            }
            return null
        }

        function yv(t) {
            return !!t && t.is("image")
        }

        function xv(t, e, i = {}) {
            const n = t.createElement("image", i);
            const o = nv(e.document.selection, e);
            e.insertContent(n, o);
            if (n.parent) {
                t.setSelection(n, "on")
            }
        }

        function Cv(t) {
            const e = t.schema;
            const i = t.document.selection;
            return Tv(i, e, t) && !Pv(i, e) && Sv(i)
        }

        function Av(t) {
            return Array.from(t.getChildren()).find(t => t.is("img"))
        }

        function Tv(t, e, i) {
            const n = Ev(t, i);
            return e.checkChild(n, "image")
        }

        function Pv(t, e) {
            const i = t.getSelectedElement();
            return i && e.isObject(i)
        }

        function Sv(t) {
            return [...t.focus.getAncestors()].every(t => !t.is("image"))
        }

        function Ev(t, e) {
            const i = nv(t, e);
            const n = i.parent;
            if (n.isEmpty && !n.is("$root")) {
                return n.parent
            }
            return n
        }

        function Rv() {
            return e => {
                e.on("element:figure", t)
            };

            function t(t, e, i) {
                if (!i.consumable.test(e.viewItem, {name: true, classes: "image"})) {
                    return
                }
                const n = Av(e.viewItem);
                if (!n || !n.hasAttribute("src") || !i.consumable.test(n, {name: true})) {
                    return
                }
                const o = i.convertItem(n, e.modelCursor);
                const r = Ww(o.modelRange.getItems());
                if (!r) {
                    return
                }
                i.convertChildren(e.viewItem, i.writer.createPositionAt(r, 0));
                e.modelRange = o.modelRange;
                e.modelCursor = o.modelCursor
            }
        }

        function Ov() {
            return e => {
                e.on("attribute:srcset:image", t)
            };

            function t(t, e, i) {
                if (!i.consumable.consume(e.item, t.name)) {
                    return
                }
                const n = i.writer;
                const o = i.mapper.toViewElement(e.item);
                const r = Av(o);
                if (e.attributeNewValue === null) {
                    const t = e.attributeOldValue;
                    if (t.data) {
                        n.removeAttribute("srcset", r);
                        n.removeAttribute("sizes", r);
                        if (t.width) {
                            n.removeAttribute("width", r)
                        }
                    }
                } else {
                    const t = e.attributeNewValue;
                    if (t.data) {
                        n.setAttribute("srcset", t.data, r);
                        n.setAttribute("sizes", "100vw", r);
                        if (t.width) {
                            n.setAttribute("width", t.width, r)
                        }
                    }
                }
            }
        }

        function Iv(t) {
            return i => {
                i.on(`attribute:${t}:image`, e)
            };

            function e(t, e, i) {
                if (!i.consumable.consume(e.item, t.name)) {
                    return
                }
                const n = i.writer;
                const o = i.mapper.toViewElement(e.item);
                const r = Av(o);
                if (e.attributeNewValue !== null) {
                    n.setAttribute(e.attributeKey, e.attributeNewValue, r)
                } else {
                    n.removeAttribute(e.attributeKey, r)
                }
            }
        }

        class Vv extends jw {
            refresh() {
                this.isEnabled = Cv(this.editor.model)
            }

            execute(t) {
                const e = this.editor.model;
                e.change(i => {
                    const n = Array.isArray(t.source) ? t.source : [t.source];
                    for (const t of n) {
                        xv(i, e, {src: t})
                    }
                })
            }
        }

        class Nv extends mp {
            static get pluginName() {
                return "ImageEditing"
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.t;
                const n = t.conversion;
                t.editing.view.addObserver(wv);
                e.register("image", {
                    isObject: true,
                    isBlock: true,
                    allowWhere: "$block",
                    allowAttributes: ["alt", "src", "srcset"]
                });
                n.for("dataDowncast").elementToElement({model: "image", view: (t, e) => Mv(e)});
                n.for("editingDowncast").elementToElement({model: "image", view: (t, e) => kv(Mv(e), e, i("jx"))});
                n.for("downcast").add(Iv("src")).add(Iv("alt")).add(Ov());
                n.for("upcast").elementToElement({
                    view: {name: "img", attributes: {src: true}},
                    model: (t, e) => e.createElement("image", {src: t.getAttribute("src")})
                }).attributeToAttribute({
                    view: {name: "img", key: "alt"},
                    model: "alt"
                }).attributeToAttribute({
                    view: {name: "img", key: "srcset"}, model: {
                        key: "srcset", value: t => {
                            const e = {data: t.getAttribute("srcset")};
                            if (t.hasAttribute("width")) {
                                e.width = t.getAttribute("width")
                            }
                            return e
                        }
                    }
                }).add(Rv());
                t.commands.add("imageInsert", new Vv(t))
            }
        }

        function Mv(t) {
            const e = t.createEmptyElement("img");
            const i = t.createContainerElement("figure", {class: "image"});
            t.insert(t.createPositionAt(i, 0), e);
            return i
        }

        class Bv extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = "mousedown"
            }

            onDomEvent(t) {
                this.fire(t.type, t)
            }
        }

        var zv = i(58);
        const Lv = Bl("Ctrl+A");

        class Fv extends mp {
            static get pluginName() {
                return "Widget"
            }

            init() {
                const t = this.editor.editing.view;
                const e = t.document;
                this._previouslySelected = new Set;
                this.editor.editing.downcastDispatcher.on("selection", (t, e, i) => {
                    this._clearPreviouslySelectedWidgets(i.writer);
                    const n = i.writer;
                    const o = n.document.selection;
                    const r = o.getSelectedElement();
                    let s = null;
                    for (const t of o.getRanges()) {
                        for (const e of t) {
                            const t = e.item;
                            if (Q_(t) && !Wv(t, s)) {
                                n.addClass(Y_, t);
                                this._previouslySelected.add(t);
                                s = t;
                                if (t == r) {
                                    n.setSelection(o.getRanges(), {fake: true, label: ev(r)})
                                }
                            }
                        }
                    }
                }, {priority: "low"});
                t.addObserver(Bv);
                this.listenTo(e, "mousedown", (...t) => this._onMousedown(...t));
                this.listenTo(e, "keydown", (...t) => this._onKeydown(...t), {priority: "high"});
                this.listenTo(e, "delete", (t, e) => {
                    if (this._handleDelete(e.direction == "forward")) {
                        e.preventDefault();
                        t.stop()
                    }
                }, {priority: "high"})
            }

            _onMousedown(t, e) {
                const i = this.editor;
                const n = i.editing.view;
                const o = n.document;
                let r = e.target;
                if (Hv(r)) {
                    if (Al.isSafari && e.domEvent.detail >= 3) {
                        const t = i.editing.mapper;
                        const n = t.toModelElement(r);
                        this.editor.model.change(t => {
                            e.preventDefault();
                            t.setSelection(n, "in")
                        })
                    }
                    return
                }
                if (!Q_(r)) {
                    r = r.findAncestor(Q_);
                    if (!r) {
                        return
                    }
                }
                e.preventDefault();
                if (!o.isFocused) {
                    n.focus()
                }
                const s = i.editing.mapper.toModelElement(r);
                this._setSelectionOverElement(s)
            }

            _onKeydown(t, e) {
                const i = e.keyCode;
                const n = this.editor.locale.contentLanguageDirection === "ltr";
                const o = i == Nl.arrowdown || i == Nl[n ? "arrowright" : "arrowleft"];
                let r = false;
                if (Dv(i)) {
                    r = this._handleArrowKeys(o)
                } else if (jv(e)) {
                    r = this._selectAllNestedEditableContent() || this._selectAllContent()
                } else if (i === Nl.enter) {
                    r = this._handleEnterKey(e.shiftKey)
                }
                if (r) {
                    e.preventDefault();
                    t.stop()
                }
            }

            _handleDelete(t) {
                if (this.editor.isReadOnly) {
                    return
                }
                const e = this.editor.model.document;
                const i = e.selection;
                if (!i.isCollapsed) {
                    return
                }
                const n = this._getObjectElementNextToSelection(t);
                if (n) {
                    this.editor.model.change(t => {
                        let e = i.anchor.parent;
                        while (e.isEmpty) {
                            const i = e;
                            e = i.parent;
                            t.remove(i)
                        }
                        this._setSelectionOverElement(n)
                    });
                    return true
                }
            }

            _handleArrowKeys(t) {
                const e = this.editor.model;
                const i = e.schema;
                const n = e.document;
                const o = n.selection;
                const r = o.getSelectedElement();
                if (r && i.isObject(r)) {
                    const n = t ? o.getLastPosition() : o.getFirstPosition();
                    const r = i.getNearestSelectionRange(n, t ? "forward" : "backward");
                    if (r) {
                        e.change(t => {
                            t.setSelection(r)
                        })
                    }
                    return true
                }
                if (!o.isCollapsed) {
                    return
                }
                const s = this._getObjectElementNextToSelection(t);
                if (!!s && i.isObject(s)) {
                    this._setSelectionOverElement(s);
                    return true
                }
            }

            _handleEnterKey(t) {
                const e = this.editor.model;
                const i = e.document.selection;
                const n = i.getSelectedElement();
                if (qv(n, e.schema)) {
                    e.change(i => {
                        let o = i.createPositionAt(n, t ? "before" : "after");
                        const r = i.createElement("paragraph");
                        if (e.schema.isBlock(n.parent)) {
                            const t = e.schema.findAllowedParent(o, r);
                            o = i.split(o, t).position
                        }
                        i.insert(r, o);
                        i.setSelection(r, "in")
                    });
                    return true
                }
            }

            _selectAllNestedEditableContent() {
                const t = this.editor.model;
                const e = t.document.selection;
                const i = t.schema.getLimitElement(e);
                if (e.getFirstRange().root == i) {
                    return false
                }
                t.change(t => {
                    t.setSelection(t.createRangeIn(i))
                });
                return true
            }

            _selectAllContent() {
                const t = this.editor.model;
                const e = this.editor.editing;
                const i = e.view;
                const n = i.document;
                const o = n.selection;
                const r = o.getSelectedElement();
                if (r && Q_(r)) {
                    const i = e.mapper.toModelElement(r.parent);
                    t.change(t => {
                        t.setSelection(t.createRangeIn(i))
                    });
                    return true
                }
                return false
            }

            _setSelectionOverElement(t) {
                this.editor.model.change(e => {
                    e.setSelection(e.createRangeOn(t))
                })
            }

            _getObjectElementNextToSelection(t) {
                const e = this.editor.model;
                const i = e.schema;
                const n = e.document.selection;
                const o = e.createSelection(n);
                e.modifySelection(o, {direction: t ? "forward" : "backward"});
                const r = t ? o.focus.nodeBefore : o.focus.nodeAfter;
                if (!!r && i.isObject(r)) {
                    return r
                }
                return null
            }

            _clearPreviouslySelectedWidgets(t) {
                for (const e of this._previouslySelected) {
                    t.removeClass(Y_, e)
                }
                this._previouslySelected.clear()
            }
        }

        function Dv(t) {
            return t == Nl.arrowright || t == Nl.arrowleft || t == Nl.arrowup || t == Nl.arrowdown
        }

        function jv(t) {
            return Ml(t) == Lv
        }

        function Hv(t) {
            while (t) {
                if (t.is("editableElement") && !t.is("rootElement")) {
                    return true
                }
                if (Q_(t)) {
                    return false
                }
                t = t.parent
            }
            return false
        }

        function Wv(t, e) {
            if (!e) {
                return false
            }
            return Array.from(t.getAncestors()).includes(e)
        }

        function qv(t, e) {
            return t && e.isObject(t) && !e.isInline(t)
        }

        class Uv extends jw {
            refresh() {
                const t = this.editor.model.document.selection.getSelectedElement();
                this.isEnabled = yv(t);
                if (yv(t) && t.hasAttribute("alt")) {
                    this.value = t.getAttribute("alt")
                } else {
                    this.value = false
                }
            }

            execute(t) {
                const e = this.editor.model;
                const i = e.document.selection.getSelectedElement();
                e.change(e => {
                    e.setAttribute("alt", t.newValue, i)
                })
            }
        }

        class $v extends mp {
            static get pluginName() {
                return "ImageTextAlternativeEditing"
            }

            init() {
                this.editor.commands.add("imageTextAlternative", new Uv(this.editor))
            }
        }

        var Gv = i(60);

        class Kv extends Gp {
            constructor(t, e) {
                super(t);
                const i = `ck-input-${is()}`;
                const n = `ck-status-${is()}`;
                this.set("label");
                this.set("value");
                this.set("isReadOnly", false);
                this.set("errorText", null);
                this.set("infoText", null);
                this.labelView = this._createLabelView(i);
                this.inputView = this._createInputView(e, i, n);
                this.statusView = this._createStatusView(n);
                this.bind("_statusText").to(this, "errorText", this, "infoText", (t, e) => t || e);
                const o = this.bindTemplate;
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-labeled-input", o.if("isReadOnly", "ck-disabled")]},
                    children: [this.labelView, this.inputView, this.statusView]
                })
            }

            _createLabelView(t) {
                const e = new Mk(this.locale);
                e.for = t;
                e.bind("text").to(this, "label");
                return e
            }

            _createInputView(t, e, i) {
                const n = new t(this.locale, i);
                n.id = e;
                n.ariaDescribedById = i;
                n.bind("value").to(this);
                n.bind("isReadOnly").to(this);
                n.bind("hasError").to(this, "errorText", t => !!t);
                n.on("input", () => {
                    this.errorText = null
                });
                return n
            }

            _createStatusView(t) {
                const e = new Gp(this.locale);
                const i = this.bindTemplate;
                e.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-labeled-input__status", i.if("errorText", "ck-labeled-input__status_error"), i.if("_statusText", "ck-hidden", t => !t)],
                        id: t,
                        role: i.if("errorText", "alert")
                    },
                    children: [{text: i.to("_statusText")}]
                });
                return e
            }

            select() {
                this.inputView.select()
            }

            focus() {
                this.inputView.focus()
            }
        }

        var Jv = i(62);

        class Yv extends Gp {
            constructor(t) {
                super(t);
                this.set("value");
                this.set("id");
                this.set("placeholder");
                this.set("isReadOnly", false);
                this.set("hasError", false);
                this.set("ariaDescribedById");
                const e = this.bindTemplate;
                this.setTemplate({
                    tag: "input",
                    attributes: {
                        type: "text",
                        class: ["ck", "ck-input", "ck-input-text", e.if("hasError", "ck-error")],
                        id: e.to("id"),
                        placeholder: e.to("placeholder"),
                        readonly: e.to("isReadOnly"),
                        "aria-invalid": e.if("hasError", true),
                        "aria-describedby": e.to("ariaDescribedById")
                    },
                    on: {input: e.to("input")}
                })
            }

            render() {
                super.render();
                const t = t => {
                    this.element.value = !t && t !== 0 ? "" : t
                };
                t(this.value);
                this.on("change:value", (e, i, n) => {
                    t(n)
                })
            }

            select() {
                this.element.select()
            }

            focus() {
                this.element.focus()
            }
        }

        function Qv({view: t}) {
            t.listenTo(t.element, "submit", (e, i) => {
                i.preventDefault();
                t.fire("submit")
            }, {useCapture: true})
        }

        var Xv = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>';
        var Zv = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.591 10.177l4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>';
        var ty = i(64);

        class ey extends Gp {
            constructor(t) {
                super(t);
                const e = this.locale.t;
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.labeledInput = this._createLabeledInputView();
                this.saveButtonView = this._createButton(e("lo"), Xv, "ck-button-save");
                this.saveButtonView.type = "submit";
                this.cancelButtonView = this._createButton(e("lp"), Zv, "ck-button-cancel", "cancel");
                this._focusables = new bp;
                this._focusCycler = new yb({
                    focusables: this._focusables,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "shift + tab", focusNext: "tab"}
                });
                this.setTemplate({
                    tag: "form",
                    attributes: {class: ["ck", "ck-text-alternative-form"], tabindex: "-1"},
                    children: [this.labeledInput, this.saveButtonView, this.cancelButtonView]
                })
            }

            render() {
                super.render();
                this.keystrokes.listenTo(this.element);
                Qv({view: this});
                [this.labeledInput, this.saveButtonView, this.cancelButtonView].forEach(t => {
                    this._focusables.add(t);
                    this.focusTracker.add(t.element)
                })
            }

            _createButton(t, e, i, n) {
                const o = new hb(this.locale);
                o.set({label: t, icon: e, tooltip: true});
                o.extendTemplate({attributes: {class: i}});
                if (n) {
                    o.delegate("execute").to(this, n)
                }
                return o
            }

            _createLabeledInputView() {
                const t = this.locale.t;
                const e = new Kv(this.locale, Yv);
                e.label = t("lt");
                e.inputView.placeholder = t("lt");
                return e
            }
        }

        var iy = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22L2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21l-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>';

        function ny(t) {
            const e = t.plugins.get("ContextualBalloon");
            if (vv(t.editing.view.document.selection)) {
                const i = oy(t);
                e.updatePosition(i)
            }
        }

        function oy(t) {
            const e = t.editing.view;
            const i = nb.defaultPositions;
            return {
                target: e.domConverter.viewToDom(e.document.selection.getSelectedElement()),
                positions: [i.northArrowSouth, i.northArrowSouthWest, i.northArrowSouthEast, i.southArrowNorth, i.southArrowNorthWest, i.southArrowNorthEast]
            }
        }

        class ry extends mp {
            static get requires() {
                return [kb]
            }

            static get pluginName() {
                return "ImageTextAlternativeUI"
            }

            init() {
                this._createButton();
                this._createForm()
            }

            destroy() {
                super.destroy();
                this._form.destroy()
            }

            _createButton() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add("imageTextAlternative", i => {
                    const n = t.commands.get("imageTextAlternative");
                    const o = new hb(i);
                    o.set({label: e("lh"), icon: iy, tooltip: true});
                    o.bind("isEnabled").to(n, "isEnabled");
                    this.listenTo(o, "execute", () => {
                        this._showForm()
                    });
                    return o
                })
            }

            _createForm() {
                const t = this.editor;
                const e = t.editing.view;
                const i = e.document;
                this._balloon = this.editor.plugins.get("ContextualBalloon");
                this._form = new ey(t.locale);
                this._form.render();
                this.listenTo(this._form, "submit", () => {
                    t.execute("imageTextAlternative", {newValue: this._form.labeledInput.inputView.element.value});
                    this._hideForm(true)
                });
                this.listenTo(this._form, "cancel", () => {
                    this._hideForm(true)
                });
                this._form.keystrokes.set("Esc", (t, e) => {
                    this._hideForm(true);
                    e()
                });
                this.listenTo(t.ui, "update", () => {
                    if (!vv(i.selection)) {
                        this._hideForm(true)
                    } else if (this._isVisible) {
                        ny(t)
                    }
                });
                Db({
                    emitter: this._form,
                    activator: () => this._isVisible,
                    contextElements: [this._balloon.view.element],
                    callback: () => this._hideForm()
                })
            }

            _showForm() {
                if (this._isVisible) {
                    return
                }
                const t = this.editor;
                const e = t.commands.get("imageTextAlternative");
                const i = this._form.labeledInput;
                if (!this._isInBalloon) {
                    this._balloon.add({view: this._form, position: oy(t)})
                }
                i.value = i.inputView.element.value = e.value || "";
                this._form.labeledInput.select()
            }

            _hideForm(t) {
                if (!this._isInBalloon) {
                    return
                }
                if (this._form.focusTracker.isFocused) {
                    this._form.saveButtonView.focus()
                }
                this._balloon.remove(this._form);
                if (t) {
                    this.editor.editing.view.focus()
                }
            }

            get _isVisible() {
                return this._balloon.visibleView === this._form
            }

            get _isInBalloon() {
                return this._balloon.hasView(this._form)
            }
        }

        class sy extends mp {
            static get requires() {
                return [$v, ry]
            }

            static get pluginName() {
                return "ImageTextAlternative"
            }
        }

        var ay = i(66);

        class cy extends mp {
            static get requires() {
                return [Nv, Fv, sy]
            }

            static get pluginName() {
                return "Image"
            }
        }

        class ly extends mp {
            static get requires() {
                return [kb]
            }

            static get pluginName() {
                return "WidgetToolbarRepository"
            }

            init() {
                const t = this.editor;
                if (t.plugins.has("BalloonToolbar")) {
                    const e = t.plugins.get("BalloonToolbar");
                    this.listenTo(e, "show", e => {
                        if (hy(t.editing.view.document.selection)) {
                            e.stop()
                        }
                    }, {priority: "high"})
                }
                this._toolbarDefinitions = new Map;
                this._balloon = this.editor.plugins.get("ContextualBalloon");
                this.on("change:isEnabled", () => {
                    this._updateToolbarsVisibility()
                });
                this.listenTo(t.ui, "update", () => {
                    this._updateToolbarsVisibility()
                });
                this.listenTo(t.ui.focusTracker, "change:isFocused", () => {
                    this._updateToolbarsVisibility()
                }, {priority: "low"})
            }

            destroy() {
                super.destroy();
                for (const t of this._toolbarDefinitions.values()) {
                    t.view.destroy()
                }
            }

            register(t, {ariaLabel: e, items: i, getRelatedElement: n, balloonClassName: o = "ck-toolbar-container"}) {
                const r = this.editor;
                const s = r.t;
                const a = new Xb(r.locale);
                a.ariaLabel = e || s("kf");
                if (this._toolbarDefinitions.has(t)) {
                    throw new ss["b"]("widget-toolbar-duplicated: Toolbar with the given id was already added.", this, {toolbarId: t})
                }
                a.fillFromConfig(i, r.ui.componentFactory);
                this._toolbarDefinitions.set(t, {view: a, getRelatedElement: n, balloonClassName: o})
            }

            _updateToolbarsVisibility() {
                let t = 0;
                let e = null;
                let i = null;
                for (const n of this._toolbarDefinitions.values()) {
                    const o = n.getRelatedElement(this.editor.editing.view.document.selection);
                    if (!this.isEnabled || !o) {
                        if (this._isToolbarInBalloon(n)) {
                            this._hideToolbar(n)
                        }
                    } else if (!this.editor.ui.focusTracker.isFocused) {
                        if (this._isToolbarVisible(n)) {
                            this._hideToolbar(n)
                        }
                    } else {
                        const r = o.getAncestors().length;
                        if (r > t) {
                            t = r;
                            e = o;
                            i = n
                        }
                    }
                }
                if (i) {
                    this._showToolbar(i, e)
                }
            }

            _hideToolbar(t) {
                this._balloon.remove(t.view);
                this.stopListening(this._balloon, "change:visibleView")
            }

            _showToolbar(t, e) {
                if (this._isToolbarVisible(t)) {
                    dy(this.editor, e)
                } else if (!this._isToolbarInBalloon(t)) {
                    this._balloon.add({
                        view: t.view,
                        position: uy(this.editor, e),
                        balloonClassName: t.balloonClassName
                    });
                    this.listenTo(this._balloon, "change:visibleView", () => {
                        for (const t of this._toolbarDefinitions.values()) {
                            if (this._isToolbarVisible(t)) {
                                const e = t.getRelatedElement(this.editor.editing.view.document.selection);
                                dy(this.editor, e)
                            }
                        }
                    })
                }
            }

            _isToolbarVisible(t) {
                return this._balloon.visibleView === t.view
            }

            _isToolbarInBalloon(t) {
                return this._balloon.hasView(t.view)
            }
        }

        function dy(t, e) {
            const i = t.plugins.get("ContextualBalloon");
            const n = uy(t, e);
            i.updatePosition(n)
        }

        function uy(t, e) {
            const i = t.editing.view;
            const n = nb.defaultPositions;
            return {
                target: i.domConverter.mapViewToDom(e),
                positions: [n.northArrowSouth, n.northArrowSouthWest, n.northArrowSouthEast, n.southArrowNorth, n.southArrowNorthWest, n.southArrowNorthEast]
            }
        }

        function hy(t) {
            const e = t.getSelectedElement();
            return !!(e && Q_(e))
        }

        class fy extends mp {
            static get requires() {
                return [ly]
            }

            static get pluginName() {
                return "ImageToolbar"
            }

            afterInit() {
                const t = this.editor;
                const e = t.t;
                const i = t.plugins.get(ly);
                i.register("image", {
                    ariaLabel: e("a"),
                    items: t.config.get("image.toolbar") || [],
                    getRelatedElement: vv
                })
            }
        }

        class gy extends jw {
            constructor(t, e) {
                super(t);
                this.defaultStyle = false;
                this.styles = e.reduce((t, e) => {
                    t[e.name] = e;
                    if (e.isDefault) {
                        this.defaultStyle = e.name
                    }
                    return t
                }, {})
            }

            refresh() {
                const t = this.editor.model.document.selection.getSelectedElement();
                this.isEnabled = yv(t);
                if (!t) {
                    this.value = false
                } else if (t.hasAttribute("imageStyle")) {
                    const e = t.getAttribute("imageStyle");
                    this.value = this.styles[e] ? e : false
                } else {
                    this.value = this.defaultStyle
                }
            }

            execute(t) {
                const e = t.value;
                const i = this.editor.model;
                const n = i.document.selection.getSelectedElement();
                i.change(t => {
                    if (this.styles[e].isDefault) {
                        t.removeAttribute("imageStyle", n)
                    } else {
                        t.setAttribute("imageStyle", e, n)
                    }
                })
            }
        }

        function my(t) {
            return (e, i, n) => {
                if (!n.consumable.consume(i.item, e.name)) {
                    return
                }
                const o = by(i.attributeNewValue, t);
                const r = by(i.attributeOldValue, t);
                const s = n.mapper.toViewElement(i.item);
                const a = n.writer;
                if (r) {
                    a.removeClass(r.className, s)
                }
                if (o) {
                    a.addClass(o.className, s)
                }
            }
        }

        function py(t) {
            const e = t.filter(t => !t.isDefault);
            return (t, i, n) => {
                if (!i.modelRange) {
                    return
                }
                const o = i.viewItem;
                const r = Ww(i.modelRange.getItems());
                if (!n.schema.checkAttribute(r, "imageStyle")) {
                    return
                }
                for (const t of e) {
                    if (n.consumable.consume(o, {classes: t.className})) {
                        n.writer.setAttribute("imageStyle", t.name, r)
                    }
                }
            }
        }

        function by(t, e) {
            for (const i of e) {
                if (i.name === t) {
                    return i
                }
            }
        }

        var wy = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm2.5 3V12h11V7.5h-11zM4.061 6H15.94c.586 0 1.061.407 1.061.91v5.68c0 .503-.475.91-1.061.91H4.06c-.585 0-1.06-.407-1.06-.91V6.91C3 6.406 3.475 6 4.061 6zM2 16.5V15h16v1.5z"/></svg>';
        var ky = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M18 4.5V3H2v1.5h16zm0 3V6h-5.674v1.5H18zm0 3V9h-5.674v1.5H18zm0 3V12h-5.674v1.5H18zm-8.5-6V12h-6V7.5h6zm.818-1.5H2.682C2.305 6 2 6.407 2 6.91v5.68c0 .503.305.91.682.91h7.636c.377 0 .682-.407.682-.91V6.91c0-.503-.305-.91-.682-.91zM18 16.5V15H2v1.5h16z"/></svg>';
        var _y = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm4.5 3V12h7V7.5h-7zM5.758 6h8.484c.419 0 .758.407.758.91v5.681c0 .502-.34.909-.758.909H5.758c-.419 0-.758-.407-.758-.91V6.91c0-.503.34-.91.758-.91zM2 16.5V15h16v1.5z"/></svg>';
        var vy = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5V3h16v1.5zm0 3V6h5.674v1.5zm0 3V9h5.674v1.5zm0 3V12h5.674v1.5zm8.5-6V12h6V7.5h-6zM9.682 6h7.636c.377 0 .682.407.682.91v5.68c0 .503-.305.91-.682.91H9.682c-.377 0-.682-.407-.682-.91V6.91c0-.503.305-.91.682-.91zM2 16.5V15h16v1.5z"/></svg>';
        const yy = {
            full: {name: "full", title: "Full size image", icon: wy, isDefault: true},
            side: {name: "side", title: "Side image", icon: vy, className: "image-style-side"},
            alignLeft: {name: "alignLeft", title: "Left aligned image", icon: ky, className: "image-style-align-left"},
            alignCenter: {
                name: "alignCenter",
                title: "Centered image",
                icon: _y,
                className: "image-style-align-center"
            },
            alignRight: {
                name: "alignRight",
                title: "Right aligned image",
                icon: vy,
                className: "image-style-align-right"
            }
        };
        const xy = {full: wy, left: ky, right: vy, center: _y};

        function Cy(t = []) {
            return t.map(Ay)
        }

        function Ay(t) {
            if (typeof t == "string") {
                const e = t;
                if (yy[e]) {
                    t = Object.assign({}, yy[e])
                } else {
                    console.warn(Object(ss["a"])("image-style-not-found: There is no such image style of given name."), {name: e});
                    t = {name: e}
                }
            } else if (yy[t.name]) {
                const e = yy[t.name];
                const i = Object.assign({}, t);
                for (const n in e) {
                    if (!t.hasOwnProperty(n)) {
                        i[n] = e[n]
                    }
                }
                t = i
            }
            if (typeof t.icon == "string" && xy[t.icon]) {
                t.icon = xy[t.icon]
            }
            return t
        }

        class Ty extends mp {
            static get pluginName() {
                return "ImageStyleEditing"
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.data;
                const n = t.editing;
                t.config.define("image.styles", ["full", "side"]);
                const o = Cy(t.config.get("image.styles"));
                e.extend("image", {allowAttributes: "imageStyle"});
                const r = my(o);
                n.downcastDispatcher.on("attribute:imageStyle:image", r);
                i.downcastDispatcher.on("attribute:imageStyle:image", r);
                i.upcastDispatcher.on("element:figure", py(o), {priority: "low"});
                t.commands.add("imageStyle", new gy(t, o))
            }
        }

        var Py = i(68);

        class Sy extends mp {
            static get pluginName() {
                return "ImageStyleUI"
            }

            get localizedDefaultStylesTitles() {
                const t = this.editor.t;
                return {
                    "Full size image": t("jy"),
                    "Side image": t("jz"),
                    "Left aligned image": t("ka"),
                    "Centered image": t("kb"),
                    "Right aligned image": t("kc")
                }
            }

            init() {
                const t = this.editor;
                const e = t.config.get("image.styles");
                const i = Ey(Cy(e), this.localizedDefaultStylesTitles);
                for (const t of i) {
                    this._createButton(t)
                }
            }

            _createButton(t) {
                const e = this.editor;
                const i = `imageStyle:${t.name}`;
                e.ui.componentFactory.add(i, i => {
                    const n = e.commands.get("imageStyle");
                    const o = new hb(i);
                    o.set({label: t.title, icon: t.icon, tooltip: true, isToggleable: true});
                    o.bind("isEnabled").to(n, "isEnabled");
                    o.bind("isOn").to(n, "value", e => e === t.name);
                    this.listenTo(o, "execute", () => {
                        e.execute("imageStyle", {value: t.name});
                        e.editing.view.focus()
                    });
                    return o
                })
            }
        }

        function Ey(t, e) {
            for (const i of t) {
                if (e[i.title]) {
                    i.title = e[i.title]
                }
            }
            return t
        }

        class Ry extends mp {
            static get requires() {
                return [Ty, Sy]
            }

            static get pluginName() {
                return "ImageStyle"
            }
        }

        class Oy {
            constructor(t) {
                this.set("activeHandlePosition", null);
                this.set("proposedWidthPercents", null);
                this.set("proposedWidth", null);
                this.set("proposedHeight", null);
                this.set("proposedHandleHostWidth", null);
                this.set("proposedHandleHostHeight", null);
                this._options = t;
                this._referenceCoordinates = null
            }

            begin(t, e, i) {
                const n = new vh(e);
                this.activeHandlePosition = My(t);
                this._referenceCoordinates = Vy(e, By(this.activeHandlePosition));
                this.originalWidth = n.width;
                this.originalHeight = n.height;
                this.aspectRatio = n.width / n.height;
                const o = i.style.width;
                if (o && o.match(/^\d+\.?\d*%$/)) {
                    this.originalWidthPercents = parseFloat(o)
                } else {
                    this.originalWidthPercents = Iy(i, n)
                }
            }

            update(t) {
                this.proposedWidth = t.width;
                this.proposedHeight = t.height;
                this.proposedWidthPercents = t.widthPercents;
                this.proposedHandleHostWidth = t.handleHostWidth;
                this.proposedHandleHostHeight = t.handleHostHeight
            }
        }

        vs(Oy, Jc);

        function Iy(t, e) {
            const i = t.parentElement;
            const n = parseFloat(i.ownerDocument.defaultView.getComputedStyle(i).width);
            return e.width / n * 100
        }

        function Vy(t, e) {
            const i = new vh(t);
            const n = e.split("-");
            const o = {x: n[1] == "right" ? i.right : i.left, y: n[0] == "bottom" ? i.bottom : i.top};
            o.x += t.ownerDocument.defaultView.scrollX;
            o.y += t.ownerDocument.defaultView.scrollY;
            return o
        }

        function Ny(t) {
            return `ck-widget__resizer__handle-${t}`
        }

        function My(t) {
            const e = ["top-left", "top-right", "bottom-right", "bottom-left"];
            for (const i of e) {
                if (t.classList.contains(Ny(i))) {
                    return i
                }
            }
        }

        function By(t) {
            const e = t.split("-");
            const i = {top: "bottom", bottom: "top", left: "right", right: "left"};
            return `${i[e[0]]}-${i[e[1]]}`
        }

        class zy {
            constructor(t) {
                this._options = t;
                this._domResizerWrapper = null;
                this._viewResizerWrapper = null;
                this.set("isEnabled", true);
                this.decorate("begin");
                this.decorate("cancel");
                this.decorate("commit");
                this.decorate("updateSize");
                this.on("commit", t => {
                    if (!this.state.proposedWidth && !this.state.proposedWidthPercents) {
                        this._cleanup();
                        t.stop()
                    }
                }, {priority: "high"})
            }

            attach() {
                const t = this;
                const e = this._options.viewElement;
                const i = this._options.editor.editing.view;
                i.change(i => {
                    const n = i.createUIElement("div", {class: "ck ck-reset_all ck-widget__resizer"}, (function (e) {
                        const i = this.toDomElement(e);
                        t._appendHandles(i);
                        t._appendSizeUI(i);
                        t._domResizerWrapper = i;
                        t.on("change:isEnabled", (t, e, n) => {
                            i.style.display = n ? "" : "none"
                        });
                        i.style.display = t.isEnabled ? "" : "none";
                        return i
                    }));
                    i.insert(i.createPositionAt(e, "end"), n);
                    i.addClass("ck-widget_with-resizer", e);
                    this._viewResizerWrapper = n
                })
            }

            begin(t) {
                this.state = new Oy(this._options);
                this._sizeUI.bindToState(this._options, this.state);
                this.state.begin(t, this._getHandleHost(), this._getResizeHost())
            }

            updateSize(t) {
                const e = this._proposeNewSize(t);
                const i = this._options.editor.editing.view;
                i.change(t => {
                    const i = this._options.unit || "%";
                    const n = (i === "%" ? e.widthPercents : e.width) + i;
                    t.setStyle("width", n, this._options.viewElement)
                });
                const n = this._getHandleHost();
                const o = new vh(n);
                e.handleHostWidth = Math.round(o.width);
                e.handleHostHeight = Math.round(o.height);
                const r = new vh(n);
                e.width = Math.round(r.width);
                e.height = Math.round(r.height);
                this.redraw(o);
                this.state.update(e)
            }

            commit() {
                const t = this._options.unit || "%";
                const e = (t === "%" ? this.state.proposedWidthPercents : this.state.proposedWidth) + t;
                this._options.onCommit(e);
                this._cleanup()
            }

            cancel() {
                this._cleanup()
            }

            destroy() {
                this.cancel()
            }

            redraw(t) {
                const e = this._domResizerWrapper;
                if (i(e)) {
                    this._options.editor.editing.view.change(i => {
                        const n = e.parentElement;
                        const o = this._getHandleHost();
                        const r = t || new vh(o);
                        i.setStyle("width", r.width + "px", this._viewResizerWrapper);
                        i.setStyle("height", r.height + "px", this._viewResizerWrapper);
                        const s = {left: o.offsetLeft, top: o.offsetTop, height: o.offsetHeight, width: o.offsetWidth};
                        if (!n.isSameNode(o)) {
                            i.setStyle("left", s.left + "px", this._viewResizerWrapper);
                            i.setStyle("top", s.top + "px", this._viewResizerWrapper);
                            i.setStyle("height", s.height + "px", this._viewResizerWrapper);
                            i.setStyle("width", s.width + "px", this._viewResizerWrapper)
                        }
                    })
                }

                function i(t) {
                    return t && t.ownerDocument && t.ownerDocument.contains(t)
                }
            }

            containsHandle(t) {
                return this._domResizerWrapper.contains(t)
            }

            static isResizeHandle(t) {
                return t.classList.contains("ck-widget__resizer__handle")
            }

            _cleanup() {
                this._sizeUI.dismiss();
                this._sizeUI.isVisible = false
            }

            _proposeNewSize(t) {
                const e = this.state;
                const i = Dy(t);
                const n = this._options.isCentered ? this._options.isCentered(this) : true;
                const o = {
                    x: e._referenceCoordinates.x - (i.x + e.originalWidth),
                    y: i.y - e.originalHeight - e._referenceCoordinates.y
                };
                if (n && e.activeHandlePosition.endsWith("-right")) {
                    o.x = i.x - (e._referenceCoordinates.x + e.originalWidth)
                }
                if (n) {
                    o.x *= 2
                }
                const r = {width: Math.abs(e.originalWidth + o.x), height: Math.abs(e.originalHeight + o.y)};
                r.dominant = r.width / e.aspectRatio > r.height ? "width" : "height";
                r.max = r[r.dominant];
                const s = {width: r.width, height: r.height};
                if (r.dominant == "width") {
                    s.height = s.width / e.aspectRatio
                } else {
                    s.width = s.height * e.aspectRatio
                }
                return {
                    width: Math.round(s.width),
                    height: Math.round(s.height),
                    widthPercents: Math.min(Math.round(e.originalWidthPercents / e.originalWidth * s.width * 100) / 100, 100)
                }
            }

            _getResizeHost() {
                const t = this._domResizerWrapper.parentElement;
                return this._options.getResizeHost(t)
            }

            _getHandleHost() {
                const t = this._domResizerWrapper.parentElement;
                return this._options.getHandleHost(t)
            }

            _appendHandles(t) {
                const e = ["top-left", "top-right", "bottom-right", "bottom-left"];
                for (const i of e) {
                    t.appendChild(new _p({
                        tag: "div",
                        attributes: {class: `ck-widget__resizer__handle ${Fy(i)}`}
                    }).render())
                }
            }

            _appendSizeUI(t) {
                const e = new Ly;
                e.render();
                this._sizeUI = e;
                t.appendChild(e.element)
            }
        }

        vs(zy, Jc);

        class Ly extends Gp {
            constructor() {
                super();
                const t = this.bindTemplate;
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-size-view", t.to("activeHandlePosition", t => t ? `ck-orientation-${t}` : "")],
                        style: {display: t.if("isVisible", "none", t => !t)}
                    },
                    children: [{text: t.to("label")}]
                })
            }

            bindToState(t, e) {
                this.bind("isVisible").to(e, "proposedWidth", e, "proposedHeight", (t, e) => t !== null && e !== null);
                this.bind("label").to(e, "proposedHandleHostWidth", e, "proposedHandleHostHeight", e, "proposedWidthPercents", (e, i, n) => {
                    if (t.unit === "px") {
                        return `${e}${i}`
                    } else {
                        return `${n}%`
                    }
                });
                this.bind("activeHandlePosition").to(e)
            }

            dismiss() {
                this.unbind();
                this.isVisible = false
            }
        }

        function Fy(t) {
            return `ck-widget__resizer__handle-${t}`
        }

        function Dy(t) {
            return {x: t.pageX, y: t.pageY}
        }

        var jy = "Expected a function";

        function Hy(t, e, i) {
            var n = true, o = true;
            if (typeof t != "function") {
                throw new TypeError(jy)
            }
            if (ct(i)) {
                n = "leading" in i ? !!i.leading : n;
                o = "trailing" in i ? !!i.trailing : o
            }
            return uh(t, e, {leading: n, maxWait: e, trailing: o})
        }

        var Wy = Hy;
        var qy = i(70);

        class Uy extends mp {
            static get pluginName() {
                return "WidgetResize"
            }

            init() {
                this.set("_visibleResizer", null);
                this.set("_activeResizer", null);
                this._resizers = new Map;
                const t = Id.window.document;
                this.editor.model.schema.setAttributeProperties("width", {isFormatting: true});
                this._observer = Object.create(qd);
                this._observer.listenTo(t, "mousedown", this._mouseDownListener.bind(this));
                this._observer.listenTo(t, "mousemove", this._mouseMoveListener.bind(this));
                this._observer.listenTo(t, "mouseup", this._mouseUpListener.bind(this));
                const e = () => {
                    if (this._visibleResizer) {
                        this._visibleResizer.redraw()
                    }
                };
                const i = Wy(e, 200);
                this.on("change:_visibleResizer", e);
                this.editor.ui.on("update", i);
                this._observer.listenTo(Id.window, "resize", i);
                const n = this.editor.editing.view.document.selection;
                n.on("change", () => {
                    const t = n.getSelectedElement();
                    this._visibleResizer = this._getResizerByViewElement(t) || null
                })
            }

            destroy() {
                this._observer.stopListening();
                for (const t of this._resizers.values()) {
                    t.destroy()
                }
            }

            attachTo(t) {
                const e = new zy(t);
                const i = this.editor.plugins;
                e.attach();
                if (i.has("WidgetToolbarRepository")) {
                    const t = i.get("WidgetToolbarRepository");
                    e.on("begin", () => {
                        t.forceDisabled("resize")
                    }, {priority: "lowest"});
                    e.on("cancel", () => {
                        t.clearForceDisabled("resize")
                    }, {priority: "highest"});
                    e.on("commit", () => {
                        t.clearForceDisabled("resize")
                    }, {priority: "highest"})
                }
                this._resizers.set(t.viewElement, e);
                return e
            }

            _getResizerByHandle(t) {
                for (const e of this._resizers.values()) {
                    if (e.containsHandle(t)) {
                        return e
                    }
                }
            }

            _getResizerByViewElement(t) {
                return this._resizers.get(t)
            }

            _mouseDownListener(t, e) {
                if (!zy.isResizeHandle(e.target)) {
                    return
                }
                const i = e.target;
                this._activeResizer = this._getResizerByHandle(i);
                if (this._activeResizer) {
                    this._activeResizer.begin(i)
                }
            }

            _mouseMoveListener(t, e) {
                if (this._activeResizer) {
                    this._activeResizer.updateSize(e)
                }
            }

            _mouseUpListener() {
                if (this._activeResizer) {
                    this._activeResizer.commit();
                    this._activeResizer = null
                }
            }
        }

        vs(Uy, Jc);

        class $y extends jw {
            refresh() {
                const t = this.editor.model.document.selection.getSelectedElement();
                this.isEnabled = yv(t);
                if (!t || !t.hasAttribute("width")) {
                    this.value = null
                } else {
                    this.value = {width: t.getAttribute("width"), height: null}
                }
            }

            execute(t) {
                const e = this.editor.model;
                const i = e.document.selection.getSelectedElement();
                e.change(e => {
                    e.setAttribute("width", t.width, i)
                })
            }
        }

        var Gy = i(72);

        class Ky extends mp {
            static get requires() {
                return [Uy]
            }

            static get pluginName() {
                return "ImageResize"
            }

            init() {
                const t = this.editor;
                const e = new $y(t);
                this._registerSchema();
                this._registerConverters();
                t.commands.add("imageResize", e);
                t.editing.downcastDispatcher.on("insert:image", (i, n, o) => {
                    const r = o.mapper.toViewElement(n.item);
                    const s = t.plugins.get(Uy).attachTo({
                        unit: t.config.get("image.resizeUnit") || "%",
                        modelElement: n.item,
                        viewElement: r,
                        editor: t,
                        getHandleHost(t) {
                            return t.querySelector("img")
                        },
                        getResizeHost(t) {
                            return t
                        },
                        isCentered() {
                            const t = n.item.getAttribute("imageStyle");
                            return !t || t == "full" || t == "alignCenter"
                        },
                        onCommit(e) {
                            t.execute("imageResize", {width: e})
                        }
                    });
                    s.on("updateSize", () => {
                        if (!r.hasClass("image_resized")) {
                            t.editing.view.change(t => {
                                t.addClass("image_resized", r)
                            })
                        }
                    });
                    s.bind("isEnabled").to(e)
                }, {priority: "low"})
            }

            _registerSchema() {
                this.editor.model.schema.extend("image", {allowAttributes: "width"})
            }

            _registerConverters() {
                const t = this.editor;
                t.conversion.for("downcast").add(t => t.on("attribute:width:image", (t, e, i) => {
                    if (!i.consumable.consume(e.item, t.name)) {
                        return
                    }
                    const n = i.writer;
                    const o = i.mapper.toViewElement(e.item);
                    if (e.attributeNewValue !== null) {
                        n.setStyle("width", e.attributeNewValue, o);
                        n.addClass("image_resized", o)
                    } else {
                        n.removeStyle("width", o);
                        n.removeClass("image_resized", o)
                    }
                }));
                t.conversion.for("upcast").attributeToAttribute({
                    view: {name: "figure", styles: {width: /.+/}},
                    model: {key: "width", value: t => t.getStyle("width")}
                })
            }
        }

        class Jy extends Gp {
            constructor(t) {
                super(t);
                this.buttonView = new hb(t);
                this._fileInputView = new Yy(t);
                this._fileInputView.bind("acceptedType").to(this);
                this._fileInputView.bind("allowMultipleFiles").to(this);
                this._fileInputView.delegate("done").to(this);
                this.setTemplate({
                    tag: "span",
                    attributes: {class: "ck-file-dialog-button"},
                    children: [this.buttonView, this._fileInputView]
                });
                this.buttonView.on("execute", () => {
                    this._fileInputView.open()
                })
            }

            focus() {
                this.buttonView.focus()
            }
        }

        class Yy extends Gp {
            constructor(t) {
                super(t);
                this.set("acceptedType");
                this.set("allowMultipleFiles", false);
                const e = this.bindTemplate;
                this.setTemplate({
                    tag: "input",
                    attributes: {
                        class: ["ck-hidden"],
                        type: "file",
                        tabindex: "-1",
                        accept: e.to("acceptedType"),
                        multiple: e.to("allowMultipleFiles")
                    },
                    on: {
                        change: e.to(() => {
                            if (this.element && this.element.files && this.element.files.length) {
                                this.fire("done", this.element.files)
                            }
                            this.element.value = ""
                        })
                    }
                })
            }

            open() {
                this.element.click()
            }
        }

        var Qy = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>';

        function Xy(t) {
            const e = t.map(t => t.replace("+", "\\+"));
            return new RegExp(`^image\\/(${e.join("|")})$`)
        }

        function Zy(t) {
            return new Promise((e, i) => {
                const n = t.getAttribute("src");
                fetch(n).then(t => t.blob()).then(t => {
                    const o = ex(t, n);
                    const r = o.replace("image/", "");
                    const s = `image.${r}`;
                    const a = ix(t, s, o);
                    a ? e(a) : i()
                }).catch(i)
            })
        }

        function tx(t) {
            if (!t.is("element", "img") || !t.getAttribute("src")) {
                return false
            }
            return t.getAttribute("src").match(/^data:image\/\w+;base64,/g) || t.getAttribute("src").match(/^blob:/g)
        }

        function ex(t, e) {
            if (t.type) {
                return t.type
            } else if (e.match(/data:(image\/\w+);base64/)) {
                return e.match(/data:(image\/\w+);base64/)[1].toLowerCase()
            } else {
                return "image/jpeg"
            }
        }

        function ix(t, e, i) {
            try {
                return new File([t], e, {type: i})
            } catch (t) {
                return null
            }
        }

        class nx extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add("imageUpload", i => {
                    const n = new Jy(i);

                    // kbalashev  (image upload button fix)
                    Object.defineProperty(n.buttonView, 'isEnabled', {
                        get: () => true
                    });

                    const o = t.commands.get("imageUpload");
                    const r = t.config.get("image.upload.types");
                    const s = Xy(r);
                    n.set({acceptedType: r.map(t => `image/${t}`).join(","), allowMultipleFiles: true});
                    n.buttonView.set({label: e("kd"), icon: Qy, tooltip: true});
                    n.buttonView.bind("isEnabled").to(o);
                    n.on("done", (e, i) => {
                        const n = Array.from(i).filter(t => s.test(t.type));
                        if (n.length) {
                            t.execute("imageUpload", {file: n})
                        }
                    });
                    return n
                })
            }
        }

        var ox = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>';
        var rx = i(74);
        var sx = i(76);
        var ax = i(78);

        class cx extends mp {
            constructor(t) {
                super(t);
                this.placeholder = "data:image/svg+xml;utf8," + encodeURIComponent(ox)
            }

            init() {
                const t = this.editor;
                t.editing.downcastDispatcher.on("attribute:uploadStatus:image", (...t) => this.uploadStatusChange(...t))
            }

            uploadStatusChange(t, e, i) {
                const n = this.editor;
                const o = e.item;
                const r = o.getAttribute("uploadId");
                if (!i.consumable.consume(e.item, t.name)) {
                    return
                }
                const s = n.plugins.get(lk);
                const a = r ? e.attributeNewValue : null;
                const c = this.placeholder;
                const l = n.editing.mapper.toViewElement(o);
                const d = i.writer;
                if (a == "reading") {
                    lx(l, d);
                    ux(c, l, d);
                    return
                }
                if (a == "uploading") {
                    const t = s.loaders.get(r);
                    lx(l, d);
                    if (!t) {
                        ux(c, l, d)
                    } else {
                        hx(l, d);
                        fx(l, d, t, n.editing.view);
                        _x(l, d, t)
                    }
                    return
                }
                if (a == "complete" && s.loaders.get(r) && !Al.isEdge) {
                    mx(l, d, n.editing.view)
                }
                gx(l, d);
                hx(l, d);
                dx(l, d)
            }
        }

        function lx(t, e) {
            if (!t.hasClass("ck-appear")) {
                e.addClass("ck-appear", t)
            }
        }

        function dx(t, e) {
            e.removeClass("ck-appear", t)
        }

        function ux(t, e, i) {
            if (!e.hasClass("ck-image-upload-placeholder")) {
                i.addClass("ck-image-upload-placeholder", e)
            }
            const n = Av(e);
            if (n.getAttribute("src") !== t) {
                i.setAttribute("src", t, n)
            }
            if (!wx(e, "placeholder")) {
                i.insert(i.createPositionAfter(n), bx(i))
            }
        }

        function hx(t, e) {
            if (t.hasClass("ck-image-upload-placeholder")) {
                e.removeClass("ck-image-upload-placeholder", t)
            }
            kx(t, e, "placeholder")
        }

        function fx(t, e, i, n) {
            const o = px(e);
            e.insert(e.createPositionAt(t, "end"), o);
            i.on("change:uploadedPercent", (t, e, i) => {
                n.change(t => {
                    t.setStyle("width", i + "%", o)
                })
            })
        }

        function gx(t, e) {
            kx(t, e, "progressBar")
        }

        function mx(t, e, i) {
            const n = e.createUIElement("div", {class: "ck-image-upload-complete-icon"});
            e.insert(e.createPositionAt(t, "end"), n);
            setTimeout(() => {
                i.change(t => t.remove(t.createRangeOn(n)))
            }, 3e3)
        }

        function px(t) {
            const e = t.createUIElement("div", {class: "ck-progress-bar"});
            t.setCustomProperty("progressBar", true, e);
            return e
        }

        function bx(t) {
            const e = t.createUIElement("div", {class: "ck-upload-placeholder-loader"});
            t.setCustomProperty("placeholder", true, e);
            return e
        }

        function wx(t, e) {
            for (const i of t.getChildren()) {
                if (i.getCustomProperty(e)) {
                    return i
                }
            }
        }

        function kx(t, e, i) {
            const n = wx(t, i);
            if (n) {
                e.remove(e.createRangeOn(n))
            }
        }

        function _x(t, e, i) {
            if (i.data) {
                const n = Av(t);
                e.setAttribute("src", i.data, n)
            }
        }

        class vx extends sk {
            static get pluginName() {
                return "Notification"
            }

            init() {
                this.on("show:warning", (t, e) => {
                    window.alert(e.message)
                }, {priority: "lowest"})
            }

            showSuccess(t, e = {}) {
                this._showNotification({message: t, type: "success", namespace: e.namespace, title: e.title})
            }

            showInfo(t, e = {}) {
                this._showNotification({message: t, type: "info", namespace: e.namespace, title: e.title})
            }

            showWarning(t, e = {}) {
                this._showNotification({message: t, type: "warning", namespace: e.namespace, title: e.title})
            }

            _showNotification(t) {
                const e = `show:${t.type}` + (t.namespace ? `:${t.namespace}` : "");
                this.fire(e, {message: t.message, type: t.type, title: t.title || ""})
            }
        }

        class yx {
            constructor(t) {
                this.files = xx(t);
                this._native = t
            }

            get types() {
                return this._native.types
            }

            getData(t) {
                return this._native.getData(t)
            }

            setData(t, e) {
                this._native.setData(t, e)
            }
        }

        function xx(t) {
            const e = t.files ? Array.from(t.files) : [];
            const i = t.items ? Array.from(t.items) : [];
            if (e.length) {
                return e
            }
            return i.filter(t => t.kind === "file").map(t => t.getAsFile())
        }

        class Cx extends Ju {
            constructor(t) {
                super(t);
                const e = this.document;
                this.domEventType = ["paste", "copy", "cut", "drop", "dragover"];
                this.listenTo(e, "paste", i, {priority: "low"});
                this.listenTo(e, "drop", i, {priority: "low"});

                function i(t, i) {
                    i.preventDefault();
                    const n = i.dropRange ? [i.dropRange] : Array.from(e.selection.getRanges());
                    const o = new ts(e, "clipboardInput");
                    e.fire(o, {dataTransfer: i.dataTransfer, targetRanges: n});
                    if (o.stop.called) {
                        i.stopPropagation()
                    }
                }
            }

            onDomEvent(t) {
                const e = {dataTransfer: new yx(t.clipboardData ? t.clipboardData : t.dataTransfer)};
                if (t.type == "drop") {
                    e.dropRange = Ax(this.view, t)
                }
                this.fire(t.type, t, e)
            }
        }

        function Ax(t, e) {
            const i = e.target.ownerDocument;
            const n = e.clientX;
            const o = e.clientY;
            let r;
            if (i.caretRangeFromPoint && i.caretRangeFromPoint(n, o)) {
                r = i.caretRangeFromPoint(n, o)
            } else if (e.rangeParent) {
                r = i.createRange();
                r.setStart(e.rangeParent, e.rangeOffset);
                r.collapse(true)
            }
            if (r) {
                return t.domConverter.domRangeToView(r)
            } else {
                return t.document.selection.getFirstRange()
            }
        }

        function Tx(t) {
            t = t.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\n/g, "</p><p>").replace(/^\s/, "&nbsp;").replace(/\s$/, "&nbsp;").replace(/\s\s/g, " &nbsp;");
            if (t.indexOf("</p><p>") > -1) {
                t = `<p>${t}</p>`
            }
            return t
        }

        function Px(t) {
            return t.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g, (t, e) => {
                if (e.length == 1) {
                    return " "
                }
                return e
            })
        }

        const Sx = ["figcaption", "li"];

        function Ex(t) {
            let e = "";
            if (t.is("text") || t.is("textProxy")) {
                e = t.data
            } else if (t.is("img") && t.hasAttribute("alt")) {
                e = t.getAttribute("alt")
            } else {
                let i = null;
                for (const n of t.getChildren()) {
                    const t = Ex(n);
                    if (i && (i.is("containerElement") || n.is("containerElement"))) {
                        if (Sx.includes(i.name) || Sx.includes(n.name)) {
                            e += "\n"
                        } else {
                            e += "\n\n"
                        }
                    }
                    e += t;
                    i = n
                }
            }
            return e
        }

        class Rx extends mp {
            static get pluginName() {
                return "Clipboard"
            }

            init() {
                const t = this.editor;
                const e = t.model.document;
                const i = t.editing.view;
                const n = i.document;
                this._htmlDataProcessor = new gp(n);
                i.addObserver(Cx);
                this.listenTo(n, "clipboardInput", e => {
                    if (t.isReadOnly) {
                        e.stop()
                    }
                }, {priority: "highest"});
                this.listenTo(n, "clipboardInput", (t, e) => {
                    const n = e.dataTransfer;
                    let o = "";
                    if (n.getData("text/html")) {
                        o = Px(n.getData("text/html"))
                    } else if (n.getData("text/plain")) {
                        o = Tx(n.getData("text/plain"))
                    }
                    o = this._htmlDataProcessor.toView(o);
                    this.fire("inputTransformation", {content: o, dataTransfer: n});
                    i.scrollToTheSelection()
                }, {priority: "low"});
                this.listenTo(this, "inputTransformation", (t, e) => {
                    if (!e.content.isEmpty) {
                        const t = this.editor.data;
                        const i = this.editor.model;
                        const n = t.toModel(e.content, "$clipboardHolder");
                        if (n.childCount == 0) {
                            return
                        }
                        i.insertContent(n)
                    }
                }, {priority: "low"});

                function o(i, o) {
                    const r = o.dataTransfer;
                    o.preventDefault();
                    const s = t.data.toView(t.model.getSelectedContent(e.selection));
                    n.fire("clipboardOutput", {dataTransfer: r, content: s, method: i.name})
                }

                this.listenTo(n, "copy", o, {priority: "low"});
                this.listenTo(n, "cut", (e, i) => {
                    if (t.isReadOnly) {
                        i.preventDefault()
                    } else {
                        o(e, i)
                    }
                }, {priority: "low"});
                this.listenTo(n, "clipboardOutput", (i, n) => {
                    if (!n.content.isEmpty) {
                        n.dataTransfer.setData("text/html", this._htmlDataProcessor.toData(n.content));
                        n.dataTransfer.setData("text/plain", Ex(n.content))
                    }
                    if (n.method == "cut") {
                        t.model.deleteContent(e.selection)
                    }
                }, {priority: "low"})
            }
        }

        class Ox {
            constructor(t) {
                this.document = t
            }

            createDocumentFragment(t) {
                return new ql(this.document, t)
            }

            createElement(t, e, i) {
                return new zc(this.document, t, e, i)
            }

            createText(t) {
                return new Ls(this.document, t)
            }

            clone(t, e = false) {
                return t._clone(e)
            }

            appendChild(t, e) {
                return e._appendChild(t)
            }

            insertChild(t, e, i) {
                return i._insertChild(t, e)
            }

            removeChildren(t, e, i) {
                return i._removeChildren(t, e)
            }

            remove(t) {
                const e = t.parent;
                if (e) {
                    return this.removeChildren(e.getChildIndex(t), 1, e)
                }
                return []
            }

            replace(t, e) {
                const i = t.parent;
                if (i) {
                    const n = i.getChildIndex(t);
                    this.removeChildren(n, 1, i);
                    this.insertChild(n, e, i);
                    return true
                }
                return false
            }

            unwrapElement(t) {
                const e = t.parent;
                if (e) {
                    const i = e.getChildIndex(t);
                    this.remove(t);
                    this.insertChild(i, t.getChildren(), e)
                }
            }

            rename(t, e) {
                const i = new zc(this.document, t, e.getAttributes(), e.getChildren());
                return this.replace(e, i) ? i : null
            }

            setAttribute(t, e, i) {
                i._setAttribute(t, e)
            }

            removeAttribute(t, e) {
                e._removeAttribute(t)
            }

            addClass(t, e) {
                e._addClass(t)
            }

            removeClass(t, e) {
                e._removeClass(t)
            }

            setStyle(t, e, i) {
                if (N(t) && i === undefined) {
                    i = e
                }
                i._setStyle(t, e)
            }

            removeStyle(t, e) {
                e._removeStyle(t)
            }

            setCustomProperty(t, e, i) {
                i._setCustomProperty(t, e)
            }

            removeCustomProperty(t, e) {
                return e._removeCustomProperty(t)
            }

            createPositionAt(t, e) {
                return dl._createAt(t, e)
            }

            createPositionAfter(t) {
                return dl._createAfter(t)
            }

            createPositionBefore(t) {
                return dl._createBefore(t)
            }

            createRange(t, e) {
                return new ul(t, e)
            }

            createRangeOn(t) {
                return ul._createOn(t)
            }

            createRangeIn(t) {
                return ul._createIn(t)
            }

            createSelection(t, e, i) {
                return new gl(t, e, i)
            }
        }

        class Ix extends jw {
            refresh() {
                this.isEnabled = Cv(this.editor.model)
            }

            execute(t) {
                const e = this.editor;

                // kbalashev  (image upload button fix)
                e.model.deleteContent(e.model.document.selection   );

                const i = e.model;
                const n = e.plugins.get(lk);
                i.change(e => {
                    const o = Array.isArray(t.file) ? t.file : [t.file];
                    for (const t of o) {
                        Vx(e, i, n, t)
                    }
                })
            }
        }

        function Vx(t, e, i, n) {
            const o = i.createLoader(n);
            if (!o) {
                return
            }
            xv(t, e, {uploadId: o.id})
        }

        class Nx extends mp {
            static get requires() {
                return [lk, vx, Rx]
            }

            static get pluginName() {
                return "ImageUploadEditing"
            }

            constructor(t) {
                super(t);
                t.config.define("image", {upload: {types: ["jpeg", "png", "gif", "bmp", "webp", "tiff"]}})
            }

            init() {
                const t = this.editor;
                const e = t.model.document;
                const i = t.model.schema;
                const n = t.conversion;
                const o = t.plugins.get(lk);
                const r = Xy(t.config.get("image.upload.types"));
                i.extend("image", {allowAttributes: ["uploadId", "uploadStatus"]});
                t.commands.add("imageUpload", new Ix(t));
                n.for("upcast").attributeToAttribute({view: {name: "img", key: "uploadId"}, model: "uploadId"});
                this.listenTo(t.editing.view.document, "clipboardInput", (e, i) => {
                    if (Mx(i.dataTransfer)) {
                        return
                    }
                    const n = Array.from(i.dataTransfer.files).filter(t => {
                        if (!t) {
                            return false
                        }
                        return r.test(t.type)
                    });
                    const o = i.targetRanges.map(e => t.editing.mapper.toModelRange(e));
                    t.model.change(i => {
                        i.setSelection(o);
                        if (n.length) {
                            e.stop();
                            t.model.enqueueChange("default", () => {
                                t.execute("imageUpload", {file: n})
                            })
                        }
                    })
                });
                this.listenTo(t.plugins.get(Rx), "inputTransformation", (e, i) => {
                    const n = Array.from(t.editing.view.createRangeIn(i.content)).filter(t => tx(t.item) && !t.item.getAttribute("uploadProcessed")).map(t => ({
                        promise: Zy(t.item),
                        imageElement: t.item
                    }));
                    if (!n.length) {
                        return
                    }
                    const r = new Ox(t.editing.view.document);
                    for (const t of n) {
                        r.setAttribute("uploadProcessed", true, t.imageElement);
                        const e = o.createLoader(t.promise);
                        if (e) {
                            r.setAttribute("src", "", t.imageElement);
                            r.setAttribute("uploadId", e.id, t.imageElement)
                        }
                    }
                });
                t.editing.view.document.on("dragover", (t, e) => {
                    e.preventDefault()
                });
                e.on("change", () => {
                    const i = e.differ.getChanges({includeChangesInGraveyard: true});
                    for (const e of i) {
                        if (e.type == "insert" && e.name != "$text") {
                            const i = e.position.nodeAfter;
                            const n = e.position.root.rootName == "$graveyard";
                            for (const e of Bx(t, i)) {
                                const t = e.getAttribute("uploadId");
                                if (!t) {
                                    continue
                                }
                                const i = o.loaders.get(t);
                                if (!i) {
                                    continue
                                }
                                if (n) {
                                    i.abort()
                                } else if (i.status == "idle") {
                                    this._readAndUpload(i, e)
                                }
                            }
                        }
                    }
                })
            }

            _readAndUpload(t, e) {
                const i = this.editor;
                const n = i.model;
                const o = i.locale.t;
                const r = i.plugins.get(lk);
                const s = i.plugins.get(vx);
                n.enqueueChange("transparent", t => {
                    t.setAttribute("uploadStatus", "reading", e)
                });
                return t.read().then(() => {
                    const o = t.upload();
                    if (Al.isSafari) {
                        const t = i.editing.mapper.toViewElement(e);
                        const n = Av(t);
                        i.editing.view.once("render", () => {
                            if (!n.parent) {
                                return
                            }
                            const t = i.editing.view.domConverter.mapViewToDom(n.parent);
                            if (!t) {
                                return
                            }
                            const e = t.style.display;
                            t.style.display = "none";
                            t._ckHack = t.offsetHeight;
                            t.style.display = e
                        })
                    }
                    n.enqueueChange("transparent", t => {
                        t.setAttribute("uploadStatus", "uploading", e)
                    });
                    return o
                }).then(t => {
                    n.enqueueChange("transparent", i => {
                        i.setAttributes({uploadStatus: "complete", src: t.default}, e);
                        this._parseAndSetSrcsetAttributeOnImage(t, e, i)
                    });
                    a()
                }).catch(i => {
                    if (t.status !== "error" && t.status !== "aborted") {
                        throw i
                    }
                    if (t.status == "error" && i) {
                        s.showWarning(i, {title: o("ke"), namespace: "upload"})
                    }
                    a();
                    n.enqueueChange("transparent", t => {
                        t.remove(e)
                    })
                });

                function a() {
                    n.enqueueChange("transparent", t => {
                        t.removeAttribute("uploadId", e);
                        t.removeAttribute("uploadStatus", e)
                    });
                    r.destroyLoader(t)
                }
            }

            _parseAndSetSrcsetAttributeOnImage(t, e, i) {
                let n = 0;
                const o = Object.keys(t).filter(t => {
                    const e = parseInt(t, 10);
                    if (!isNaN(e)) {
                        n = Math.max(n, e);
                        return true
                    }
                }).map(e => `${t[e]} ${e}w`).join(", ");
                if (o != "") {
                    i.setAttribute("srcset", {data: o, width: n}, e)
                }
            }
        }

        function Mx(t) {
            return Array.from(t.types).includes("text/html") && t.getData("text/html") !== ""
        }

        function Bx(t, e) {
            return Array.from(t.model.createRangeOn(e)).filter(t => t.item.is("image")).map(t => t.item)
        }

        class zx extends mp {
            static get pluginName() {
                return "ImageUpload"
            }

            static get requires() {
                return [Nx, nx, cx]
            }
        }

        class Lx extends jw {
            constructor(t) {
                super(t);
                this._childCommands = []
            }

            refresh() {
            }

            execute(...t) {
                const e = this._getFirstEnabledCommand();
                e.execute(t)
            }

            registerChildCommand(t) {
                this._childCommands.push(t);
                t.on("change:isEnabled", () => this._checkEnabled());
                this._checkEnabled()
            }

            _checkEnabled() {
                this.isEnabled = !!this._getFirstEnabledCommand()
            }

            _getFirstEnabledCommand() {
                return this._childCommands.find(t => t.isEnabled)
            }
        }

        class Fx extends mp {
            static get pluginName() {
                return "IndentEditing"
            }

            init() {
                const t = this.editor;
                t.commands.add("indent", new Lx(t));
                t.commands.add("outdent", new Lx(t))
            }
        }

        var Dx = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95L5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>';
        var jx = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';

        class Hx extends mp {
            static get pluginName() {
                return "IndentUI"
            }

            init() {
                const t = this.editor;
                const e = t.locale;
                const i = t.t;
                const n = e.uiLanguageDirection == "ltr" ? Dx : jx;
                const o = e.uiLanguageDirection == "ltr" ? jx : Dx;
                this._defineButton("indent", i("jg"), n);
                this._defineButton("outdent", i("jh"), o)
            }

            _defineButton(t, e, i) {
                const n = this.editor;
                n.ui.componentFactory.add(t, o => {
                    const r = n.commands.get(t);
                    const s = new hb(o);
                    s.set({label: e, icon: i, tooltip: true});
                    s.bind("isOn", "isEnabled").to(r, "value", "isEnabled");
                    this.listenTo(s, "execute", () => {
                        n.execute(t);
                        n.editing.view.focus()
                    });
                    return s
                })
            }
        }

        class Wx extends mp {
            static get pluginName() {
                return "Indent"
            }

            static get requires() {
                return [Fx, Hx]
            }
        }

        class qx extends jw {
            constructor(t, e) {
                super(t);
                this._indentBehavior = e
            }

            refresh() {
                const t = this.editor;
                const e = t.model;
                const i = Ww(e.document.selection.getSelectedBlocks());
                if (!i || !e.schema.checkAttribute(i, "blockIndent")) {
                    this.isEnabled = false;
                    return
                }
                this.isEnabled = this._indentBehavior.checkEnabled(i.getAttribute("blockIndent"))
            }

            execute() {
                const t = this.editor.model;
                const e = Ux(t);
                t.change(t => {
                    for (const i of e) {
                        const e = i.getAttribute("blockIndent");
                        const n = this._indentBehavior.getNextIndent(e);
                        if (n) {
                            t.setAttribute("blockIndent", n, i)
                        } else {
                            t.removeAttribute("blockIndent", i)
                        }
                    }
                })
            }
        }

        function Ux(t) {
            const e = t.document.selection;
            const i = t.schema;
            const n = Array.from(e.getSelectedBlocks());
            return n.filter(t => i.checkAttribute(t, "blockIndent"))
        }

        class $x {
            constructor(t) {
                this.isForward = t.direction === "forward";
                this.offset = t.offset;
                this.unit = t.unit
            }

            checkEnabled(t) {
                const e = parseFloat(t || 0);
                return this.isForward || e > 0
            }

            getNextIndent(t) {
                const e = parseFloat(t || 0);
                const i = !t || t.endsWith(this.unit);
                if (!i) {
                    return this.isForward ? this.offset + this.unit : undefined
                }
                const n = this.isForward ? this.offset : -this.offset;
                const o = e + n;
                return o > 0 ? o + this.unit : undefined
            }
        }

        class Gx {
            constructor(t) {
                this.isForward = t.direction === "forward";
                this.classes = t.classes
            }

            checkEnabled(t) {
                const e = this.classes.indexOf(t);
                if (this.isForward) {
                    return e < this.classes.length - 1
                } else {
                    return e >= 0
                }
            }

            getNextIndent(t) {
                const e = this.classes.indexOf(t);
                const i = this.isForward ? 1 : -1;
                return this.classes[e + i]
            }
        }

        const Kx = /^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i;
        const Jx = /^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i;
        const Yx = /^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i;
        const Qx = /^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i;
        const Xx = /^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i;
        const Zx = new Set(["black", "silver", "gray", "white", "maroon", "red", "purple", "fuchsia", "green", "lime", "olive", "yellow", "navy", "blue", "teal", "aqua", "orange", "aliceblue", "antiquewhite", "aquamarine", "azure", "beige", "bisque", "blanchedalmond", "blueviolet", "brown", "burlywood", "cadetblue", "chartreuse", "chocolate", "coral", "cornflowerblue", "cornsilk", "crimson", "cyan", "darkblue", "darkcyan", "darkgoldenrod", "darkgray", "darkgreen", "darkgrey", "darkkhaki", "darkmagenta", "darkolivegreen", "darkorange", "darkorchid", "darkred", "darksalmon", "darkseagreen", "darkslateblue", "darkslategray", "darkslategrey", "darkturquoise", "darkviolet", "deeppink", "deepskyblue", "dimgray", "dimgrey", "dodgerblue", "firebrick", "floralwhite", "forestgreen", "gainsboro", "ghostwhite", "gold", "goldenrod", "greenyellow", "grey", "honeydew", "hotpink", "indianred", "indigo", "ivory", "khaki", "lavender", "lavenderblush", "lawngreen", "lemonchiffon", "lightblue", "lightcoral", "lightcyan", "lightgoldenrodyellow", "lightgray", "lightgreen", "lightgrey", "lightpink", "lightsalmon", "lightseagreen", "lightskyblue", "lightslategray", "lightslategrey", "lightsteelblue", "lightyellow", "limegreen", "linen", "magenta", "mediumaquamarine", "mediumblue", "mediumorchid", "mediumpurple", "mediumseagreen", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "mintcream", "mistyrose", "moccasin", "navajowhite", "oldlace", "olivedrab", "orangered", "orchid", "palegoldenrod", "palegreen", "paleturquoise", "palevioletred", "papayawhip", "peachpuff", "peru", "pink", "plum", "powderblue", "rosybrown", "royalblue", "saddlebrown", "salmon", "sandybrown", "seagreen", "seashell", "sienna", "skyblue", "slateblue", "slategray", "slategrey", "snow", "springgreen", "steelblue", "tan", "thistle", "tomato", "turquoise", "violet", "wheat", "whitesmoke", "yellowgreen", "rebeccapurple", "currentcolor", "transparent"]);

        function tC(t) {
            if (t.startsWith("#")) {
                return Kx.test(t)
            }
            if (t.startsWith("rgb")) {
                return Jx.test(t) || Yx.test(t)
            }
            if (t.startsWith("hsl")) {
                return Qx.test(t) || Xx.test(t)
            }
            return Zx.has(t.toLowerCase())
        }

        const eC = ["none", "hidden", "dotted", "dashed", "solid", "double", "groove", "ridge", "inset", "outset"];

        function iC(t) {
            return eC.includes(t)
        }

        const nC = /^([+-]?[0-9]*[.]?[0-9]+(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;

        function oC(t) {
            return nC.test(t)
        }

        const rC = /^[+-]?[0-9]*[.]?[0-9]+%$/;

        function sC(t) {
            return rC.test(t)
        }

        const aC = ["repeat-x", "repeat-y", "repeat", "space", "round", "no-repeat"];

        function cC(t) {
            return aC.includes(t)
        }

        const lC = ["center", "top", "bottom", "left", "right"];

        function dC(t) {
            return lC.includes(t)
        }

        const uC = ["fixed", "scroll", "local"];

        function hC(t) {
            return uC.includes(t)
        }

        const fC = /^url\(/;

        function gC(t) {
            return fC.test(t)
        }

        function mC(t = "") {
            if (t === "") {
                return {top: undefined, right: undefined, bottom: undefined, left: undefined}
            }
            const e = kC(t);
            const i = e[0];
            const n = e[2] || i;
            const o = e[1] || i;
            const r = e[3] || o;
            return {top: i, bottom: n, right: o, left: r}
        }

        function pC(t) {
            return e => {
                const {top: i, right: n, bottom: o, left: r} = e;
                const s = [];
                if (![i, n, r, o].every(t => !!t)) {
                    if (i) {
                        s.push([t + "-top", i])
                    }
                    if (n) {
                        s.push([t + "-right", n])
                    }
                    if (o) {
                        s.push([t + "-bottom", o])
                    }
                    if (r) {
                        s.push([t + "-left", r])
                    }
                } else {
                    s.push([t, bC(e)])
                }
                return s
            }
        }

        function bC({top: t, right: e, bottom: i, left: n}) {
            const o = [];
            if (n !== e) {
                o.push(t, e, i, n)
            } else if (i !== t) {
                o.push(t, e, i)
            } else if (e !== t) {
                o.push(t, e)
            } else {
                o.push(t)
            }
            return o.join(" ")
        }

        function wC(t) {
            return e => ({path: t, value: mC(e)})
        }

        function kC(t) {
            return t.replace(/, /g, ",").split(" ").map(t => t.replace(/,/g, ", "))
        }

        function _C(t) {
            t.setNormalizer("margin", wC("margin"));
            t.setNormalizer("margin-top", t => ({path: "margin.top", value: t}));
            t.setNormalizer("margin-right", t => ({path: "margin.right", value: t}));
            t.setNormalizer("margin-bottom", t => ({path: "margin.bottom", value: t}));
            t.setNormalizer("margin-left", t => ({path: "margin.left", value: t}));
            t.setReducer("margin", pC("margin"));
            t.setStyleRelation("margin", ["margin-top", "margin-right", "margin-bottom", "margin-left"])
        }

        class vC extends mp {
            constructor(t) {
                super(t);
                t.config.define("indentBlock", {offset: 40, unit: "px"})
            }

            static get pluginName() {
                return "IndentBlock"
            }

            init() {
                const t = this.editor;
                const e = t.config.get("indentBlock");
                const i = !e.classes || !e.classes.length;
                const n = Object.assign({direction: "forward"}, e);
                const o = Object.assign({direction: "backward"}, e);
                if (i) {
                    t.data.addStyleProcessorRules(_C);
                    this._setupConversionUsingOffset(t.conversion);
                    t.commands.add("indentBlock", new qx(t, new $x(n)));
                    t.commands.add("outdentBlock", new qx(t, new $x(o)))
                } else {
                    this._setupConversionUsingClasses(e.classes);
                    t.commands.add("indentBlock", new qx(t, new Gx(n)));
                    t.commands.add("outdentBlock", new qx(t, new Gx(o)))
                }
            }

            afterInit() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.commands.get("indent");
                const n = t.commands.get("outdent");
                const o = ["paragraph", "heading1", "heading2", "heading3", "heading4", "heading5", "heading6"];
                o.forEach(t => {
                    if (e.isRegistered(t)) {
                        e.extend(t, {allowAttributes: "blockIndent"})
                    }
                });
                i.registerChildCommand(t.commands.get("indentBlock"));
                n.registerChildCommand(t.commands.get("outdentBlock"))
            }

            _setupConversionUsingOffset() {
                const t = this.editor.conversion;
                const e = this.editor.locale;
                const i = e.contentLanguageDirection === "rtl" ? "margin-right" : "margin-left";
                t.for("upcast").attributeToAttribute({
                    view: {styles: {[i]: /[\s\S]+/}},
                    model: {key: "blockIndent", value: t => t.getStyle(i)}
                });
                t.for("downcast").attributeToAttribute({
                    model: "blockIndent",
                    view: t => ({key: "style", value: {[i]: t}})
                })
            }

            _setupConversionUsingClasses(t) {
                const e = {model: {key: "blockIndent", values: []}, view: {}};
                for (const i of t) {
                    e.model.values.push(i);
                    e.view[i] = {key: "class", value: [i]}
                }
                this.editor.conversion.attributeToAttribute(e)
            }
        }

        const yC = "italic";

        class xC extends mp {
            static get pluginName() {
                return "ItalicEditing"
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: yC});
                t.model.schema.setAttributeProperties(yC, {isFormatting: true, copyOnEnter: true});
                t.conversion.attributeToElement({
                    model: yC,
                    view: "i",
                    upcastAlso: ["em", {styles: {"font-style": "italic"}}]
                });
                t.commands.add(yC, new yk(t, yC));
                t.keystrokes.set("CTRL+I", yC)
            }
        }

        var CC = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.586 14.633l.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';
        const AC = "italic";

        class TC extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(AC, i => {
                    const n = t.commands.get(AC);
                    const o = new hb(i);
                    o.set({label: e("jj"), icon: CC, keystroke: "CTRL+I", tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(AC);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class PC extends mp {
            static get requires() {
                return [xC, TC]
            }

            static get pluginName() {
                return "Italic"
            }
        }

        function SC(t, e, i) {
            return i.createRange(EC(t, e, true, i), EC(t, e, false, i))
        }

        function EC(t, e, i, n) {
            let o = t.textNode || (i ? t.nodeBefore : t.nodeAfter);
            let r = null;
            while (o && o.getAttribute("linkHref") == e) {
                r = o;
                o = i ? o.previousSibling : o.nextSibling
            }
            return r ? n.createPositionAt(r, i ? "before" : "after") : t
        }

        class RC extends jw {
            constructor(t) {
                super(t);
                this.manualDecorators = new ys
            }

            restoreManualDecoratorStates() {
                for (const t of this.manualDecorators) {
                    t.value = this._getDecoratorStateFromModel(t.id)
                }
            }

            refresh() {
                const t = this.editor.model;
                const e = t.document;
                this.value = e.selection.getAttribute("linkHref");
                for (const t of this.manualDecorators) {
                    t.value = this._getDecoratorStateFromModel(t.id)
                }
                this.isEnabled = t.schema.checkAttributeInSelection(e.selection, "linkHref")
            }

            execute(t, e = {}) {
                const i = this.editor.model;
                const n = i.document.selection;
                const o = [];
                const r = [];
                for (const t in e) {
                    if (e[t]) {
                        o.push(t)
                    } else {
                        r.push(t)
                    }
                }
                i.change(e => {
                    if (n.isCollapsed) {
                        const s = n.getFirstPosition();
                        if (n.hasAttribute("linkHref")) {
                            const a = SC(s, n.getAttribute("linkHref"), i);
                            e.setAttribute("linkHref", t, a);
                            o.forEach(t => {
                                e.setAttribute(t, true, a)
                            });
                            r.forEach(t => {
                                e.removeAttribute(t, a)
                            });
                            e.setSelection(a)
                        } else if (t !== "") {
                            const r = Hs(n.getAttributes());
                            r.set("linkHref", t);
                            o.forEach(t => {
                                r.set(t, true)
                            });
                            const a = e.createText(t, r);
                            i.insertContent(a, s);
                            e.setSelection(e.createRangeOn(a))
                        }
                    } else {
                        const s = i.schema.getValidRanges(n.getRanges(), "linkHref");
                        for (const i of s) {
                            e.setAttribute("linkHref", t, i);
                            o.forEach(t => {
                                e.setAttribute(t, true, i)
                            });
                            r.forEach(t => {
                                e.removeAttribute(t, i)
                            })
                        }
                    }
                })
            }

            _getDecoratorStateFromModel(t) {
                const e = this.editor.model.document;
                return e.selection.getAttribute(t) || false
            }
        }

        class OC extends jw {
            refresh() {
                this.isEnabled = this.editor.model.document.selection.hasAttribute("linkHref")
            }

            execute() {
                const t = this.editor;
                const e = this.editor.model;
                const i = e.document.selection;
                const n = t.commands.get("link");
                e.change(t => {
                    const o = i.isCollapsed ? [SC(i.getFirstPosition(), i.getAttribute("linkHref"), e)] : i.getRanges();
                    for (const e of o) {
                        t.removeAttribute("linkHref", e);
                        if (n) {
                            for (const i of n.manualDecorators) {
                                t.removeAttribute(i.id, e)
                            }
                        }
                    }
                })
            }
        }

        function IC(t, e, i) {
            var n = t.length;
            i = i === undefined ? n : i;
            return !e && i >= n ? t : Oa(t, e, i)
        }

        var VC = IC;
        var NC = "\\ud800-\\udfff", MC = "\\u0300-\\u036f", BC = "\\ufe20-\\ufe2f", zC = "\\u20d0-\\u20ff",
            LC = MC + BC + zC, FC = "\\ufe0e\\ufe0f";
        var DC = "\\u200d";
        var jC = RegExp("[" + DC + NC + LC + FC + "]");

        function HC(t) {
            return jC.test(t)
        }

        var WC = HC;

        function qC(t) {
            return t.split("")
        }

        var UC = qC;
        var $C = "\\ud800-\\udfff", GC = "\\u0300-\\u036f", KC = "\\ufe20-\\ufe2f", JC = "\\u20d0-\\u20ff",
            YC = GC + KC + JC, QC = "\\ufe0e\\ufe0f";
        var XC = "[" + $C + "]", ZC = "[" + YC + "]", tA = "\\ud83c[\\udffb-\\udfff]", eA = "(?:" + ZC + "|" + tA + ")",
            iA = "[^" + $C + "]", nA = "(?:\\ud83c[\\udde6-\\uddff]){2}", oA = "[\\ud800-\\udbff][\\udc00-\\udfff]",
            rA = "\\u200d";
        var sA = eA + "?", aA = "[" + QC + "]?",
            cA = "(?:" + rA + "(?:" + [iA, nA, oA].join("|") + ")" + aA + sA + ")*", lA = aA + sA + cA,
            dA = "(?:" + [iA + ZC + "?", ZC, nA, oA, XC].join("|") + ")";
        var uA = RegExp(tA + "(?=" + tA + ")|" + dA + lA, "g");

        function hA(t) {
            return t.match(uA) || []
        }

        var fA = hA;

        function gA(t) {
            return WC(t) ? fA(t) : UC(t)
        }

        var mA = gA;

        function pA(t) {
            return function (e) {
                e = _a(e);
                var i = WC(e) ? mA(e) : undefined;
                var n = i ? i[0] : e.charAt(0);
                var o = i ? VC(i, 1).join("") : e.slice(1);
                return n[t]() + o
            }
        }

        var bA = pA;
        var wA = bA("toUpperCase");
        var kA = wA;
        const _A = /[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;
        const vA = /^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i;

        function yA(t) {
            return t.is("attributeElement") && !!t.getCustomProperty("link")
        }

        function xA(t, e) {
            const i = e.createAttributeElement("a", {href: t}, {priority: 5});
            e.setCustomProperty("link", true, i);
            return i
        }

        function CA(t) {
            t = String(t);
            return AA(t) ? t : "#"
        }

        function AA(t) {
            const e = t.replace(_A, "");
            return e.match(vA)
        }

        function TA(t, e) {
            const i = {"Open in a new tab": t("mm"), Downloadable: t("mn")};
            e.forEach(t => {
                if (t.label && i[t.label]) {
                    t.label = i[t.label]
                }
                return t
            });
            return e
        }

        function PA(t) {
            const e = [];
            if (t) {
                for (const [i, n] of Object.entries(t)) {
                    const t = Object.assign({}, n, {id: `link${kA(i)}`});
                    e.push(t)
                }
            }
            return e
        }

        class SA {
            constructor() {
                this._definitions = new Set
            }

            get length() {
                return this._definitions.size
            }

            add(t) {
                if (Array.isArray(t)) {
                    t.forEach(t => this._definitions.add(t))
                } else {
                    this._definitions.add(t)
                }
            }

            getDispatcher() {
                return t => {
                    t.on("attribute:linkHref", (t, e, i) => {
                        if (!i.consumable.test(e.item, "attribute:linkHref")) {
                            return
                        }
                        const n = i.writer;
                        const o = n.document.selection;
                        for (const t of this._definitions) {
                            const r = n.createAttributeElement("a", t.attributes, {priority: 5});
                            n.setCustomProperty("link", true, r);
                            if (t.callback(e.attributeNewValue)) {
                                if (e.item.is("selection")) {
                                    n.wrap(o.getFirstRange(), r)
                                } else {
                                    n.wrap(i.mapper.toViewRange(e.range), r)
                                }
                            } else {
                                n.unwrap(i.mapper.toViewRange(e.range), r)
                            }
                        }
                    }, {priority: "high"})
                }
            }
        }

        class EA {
            constructor({id: t, label: e, attributes: i}) {
                this.id = t;
                this.set("value");
                this.label = e;
                this.attributes = i
            }
        }

        vs(EA, Jc);

        function RA({view: t, model: e, emitter: i, attribute: n, locale: o}) {
            const r = new OA(e, i, n);
            const s = e.document.selection;
            i.listenTo(t.document, "keydown", (t, e) => {
                if (!s.isCollapsed) {
                    return
                }
                if (e.shiftKey || e.altKey || e.ctrlKey) {
                    return
                }
                const i = e.keyCode == Nl.arrowright;
                const n = e.keyCode == Nl.arrowleft;
                if (!i && !n) {
                    return
                }
                const a = s.getFirstPosition();
                const c = o.contentLanguageDirection;
                let l;
                if (c === "ltr" && i || c === "rtl" && n) {
                    l = r.handleForwardMovement(a, e)
                } else {
                    l = r.handleBackwardMovement(a, e)
                }
                if (l) {
                    t.stop()
                }
            }, {priority: os.get("high") + 1})
        }

        class OA {
            constructor(t, e, i) {
                this.model = t;
                this.attribute = i;
                this._modelSelection = t.document.selection;
                this._overrideUid = null;
                this._isNextGravityRestorationSkipped = false;
                e.listenTo(this._modelSelection, "change:range", (t, e) => {
                    if (this._isNextGravityRestorationSkipped) {
                        this._isNextGravityRestorationSkipped = false;
                        return
                    }
                    if (!this._isGravityOverridden) {
                        return
                    }
                    if (!e.directChange && IA(this._modelSelection.getFirstPosition(), i)) {
                        return
                    }
                    this._restoreGravity()
                })
            }

            handleForwardMovement(t, e) {
                const i = this.attribute;
                if (this._isGravityOverridden) {
                    return
                }
                if (t.isAtStart && this._hasSelectionAttribute) {
                    return
                }
                if (MA(t, i) && this._hasSelectionAttribute) {
                    this._preventCaretMovement(e);
                    this._removeSelectionAttribute();
                    return true
                }
                if (VA(t, i)) {
                    this._preventCaretMovement(e);
                    this._overrideGravity();
                    return true
                }
                if (NA(t, i) && this._hasSelectionAttribute) {
                    this._preventCaretMovement(e);
                    this._overrideGravity();
                    return true
                }
            }

            handleBackwardMovement(t, e) {
                const i = this.attribute;
                if (this._isGravityOverridden) {
                    if (MA(t, i) && this._hasSelectionAttribute) {
                        this._preventCaretMovement(e);
                        this._restoreGravity();
                        this._removeSelectionAttribute();
                        return true
                    } else {
                        this._preventCaretMovement(e);
                        this._restoreGravity();
                        if (t.isAtStart) {
                            this._removeSelectionAttribute()
                        }
                        return true
                    }
                } else {
                    if (MA(t, i) && !this._hasSelectionAttribute) {
                        this._preventCaretMovement(e);
                        this._setSelectionAttributeFromTheNodeBefore(t);
                        return true
                    }
                    if (t.isAtEnd && NA(t, i)) {
                        if (this._hasSelectionAttribute) {
                            if (BA(t, i)) {
                                this._skipNextAutomaticGravityRestoration();
                                this._overrideGravity()
                            }
                            return
                        } else {
                            this._preventCaretMovement(e);
                            this._setSelectionAttributeFromTheNodeBefore(t);
                            return true
                        }
                    }
                    if (t.isAtStart) {
                        if (this._hasSelectionAttribute) {
                            this._removeSelectionAttribute();
                            this._preventCaretMovement(e);
                            return true
                        }
                        return
                    }
                    if (BA(t, i)) {
                        this._skipNextAutomaticGravityRestoration();
                        this._overrideGravity()
                    }
                }
            }

            get _isGravityOverridden() {
                return !!this._overrideUid
            }

            get _hasSelectionAttribute() {
                return this._modelSelection.hasAttribute(this.attribute)
            }

            _overrideGravity() {
                this._overrideUid = this.model.change(t => t.overrideSelectionGravity())
            }

            _restoreGravity() {
                this.model.change(t => {
                    t.restoreSelectionGravity(this._overrideUid);
                    this._overrideUid = null
                })
            }

            _preventCaretMovement(t) {
                t.preventDefault()
            }

            _removeSelectionAttribute() {
                this.model.change(t => {
                    t.removeSelectionAttribute(this.attribute)
                })
            }

            _setSelectionAttributeFromTheNodeBefore(t) {
                const e = this.attribute;
                this.model.change(i => {
                    i.setSelectionAttribute(this.attribute, t.nodeBefore.getAttribute(e))
                })
            }

            _skipNextAutomaticGravityRestoration() {
                this._isNextGravityRestorationSkipped = true
            }
        }

        function IA(t, e) {
            return VA(t, e) || NA(t, e)
        }

        function VA(t, e) {
            const {nodeBefore: i, nodeAfter: n} = t;
            const o = i ? i.hasAttribute(e) : false;
            const r = n ? n.hasAttribute(e) : false;
            return r && (!o || i.getAttribute(e) !== n.getAttribute(e))
        }

        function NA(t, e) {
            const {nodeBefore: i, nodeAfter: n} = t;
            const o = i ? i.hasAttribute(e) : false;
            const r = n ? n.hasAttribute(e) : false;
            return o && (!r || i.getAttribute(e) !== n.getAttribute(e))
        }

        function MA(t, e) {
            const {nodeBefore: i, nodeAfter: n} = t;
            const o = i ? i.hasAttribute(e) : false;
            const r = n ? n.hasAttribute(e) : false;
            if (!r || !o) {
                return
            }
            return n.getAttribute(e) !== i.getAttribute(e)
        }

        function BA(t, e) {
            return IA(t.getShiftedBy(-1), e)
        }

        var zA = i(80);
        const LA = "ck-link_selected";
        const FA = "automatic";
        const DA = "manual";
        const jA = /^(https?:)?\/\//;

        class HA extends mp {
            static get pluginName() {
                return "LinkEditing"
            }

            constructor(t) {
                super(t);
                t.config.define("link", {addTargetToExternalLinks: false})
            }

            init() {
                const t = this.editor;
                const e = t.locale;
                t.model.schema.extend("$text", {allowAttributes: "linkHref"});
                t.conversion.for("dataDowncast").attributeToElement({model: "linkHref", view: xA});
                t.conversion.for("editingDowncast").attributeToElement({
                    model: "linkHref",
                    view: (t, e) => xA(CA(t), e)
                });
                t.conversion.for("upcast").elementToAttribute({
                    view: {name: "a", attributes: {href: true}},
                    model: {key: "linkHref", value: t => t.getAttribute("href")}
                });
                t.commands.add("link", new RC(t));
                t.commands.add("unlink", new OC(t));
                const i = TA(t.t, PA(t.config.get("link.decorators")));
                this._enableAutomaticDecorators(i.filter(t => t.mode === FA));
                this._enableManualDecorators(i.filter(t => t.mode === DA));
                RA({view: t.editing.view, model: t.model, emitter: this, attribute: "linkHref", locale: e});
                this._setupLinkHighlight()
            }

            _enableAutomaticDecorators(t) {
                const e = this.editor;
                const i = new SA;
                if (e.config.get("link.addTargetToExternalLinks")) {
                    i.add({
                        id: "linkIsExternal",
                        mode: FA,
                        callback: t => jA.test(t),
                        attributes: {target: "_blank", rel: "noopener noreferrer"}
                    })
                }
                i.add(t);
                if (i.length) {
                    e.conversion.for("downcast").add(i.getDispatcher())
                }
            }

            _enableManualDecorators(t) {
                if (!t.length) {
                    return
                }
                const e = this.editor;
                const i = e.commands.get("link");
                const n = i.manualDecorators;
                t.forEach(t => {
                    e.model.schema.extend("$text", {allowAttributes: t.id});
                    n.add(new EA(t));
                    e.conversion.for("downcast").attributeToElement({
                        model: t.id, view: (e, i) => {
                            if (e) {
                                const e = n.get(t.id).attributes;
                                const o = i.createAttributeElement("a", e, {priority: 5});
                                i.setCustomProperty("link", true, o);
                                return o
                            }
                        }
                    });
                    e.conversion.for("upcast").elementToAttribute({
                        view: {
                            name: "a",
                            attributes: n.get(t.id).attributes
                        }, model: {key: t.id}
                    })
                })
            }

            _setupLinkHighlight() {
                const t = this.editor;
                const e = t.editing.view;
                const i = new Set;
                e.document.registerPostFixer(e => {
                    const n = t.model.document.selection;
                    let o = false;
                    if (n.hasAttribute("linkHref")) {
                        const r = SC(n.getFirstPosition(), n.getAttribute("linkHref"), t.model);
                        const s = t.editing.mapper.toViewRange(r);
                        for (const t of s.getItems()) {
                            if (t.is("a") && !t.hasClass(LA)) {
                                e.addClass(LA, t);
                                i.add(t);
                                o = true
                            }
                        }
                    }
                    return o
                });
                t.conversion.for("editingDowncast").add(t => {
                    t.on("insert", n, {priority: "highest"});
                    t.on("remove", n, {priority: "highest"});
                    t.on("attribute", n, {priority: "highest"});
                    t.on("selection", n, {priority: "highest"});

                    function n() {
                        e.change(t => {
                            for (const e of i.values()) {
                                t.removeClass(LA, e);
                                i.delete(e)
                            }
                        })
                    }
                })
            }
        }

        class WA extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = "click"
            }

            onDomEvent(t) {
                this.fire(t.type, t)
            }
        }

        var qA = i(82);

        class UA extends Gp {
            constructor(t, e = []) {
                super(t);
                const i = t.t;
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.urlInputView = this._createUrlInput();
                this.saveButtonView = this._createButton(i("lo"), Xv, "ck-button-save");
                this.saveButtonView.type = "submit";
                this.cancelButtonView = this._createButton(i("lp"), Zv, "ck-button-cancel", "cancel");
                this._manualDecoratorSwitches = this._createManualDecoratorSwitches(e);
                this.children = this._createFormChildren(e);
                this._focusables = new bp;
                this._focusCycler = new yb({
                    focusables: this._focusables,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "shift + tab", focusNext: "tab"}
                });
                const n = ["ck", "ck-link-form"];
                if (e.length) {
                    n.push("ck-link-form_layout-vertical")
                }
                this.setTemplate({tag: "form", attributes: {class: n, tabindex: "-1"}, children: this.children})
            }

            getDecoratorSwitchesState() {
                return Array.from(this._manualDecoratorSwitches).reduce((t, e) => {
                    t[e.name] = e.isOn;
                    return t
                }, {})
            }

            render() {
                super.render();
                Qv({view: this});
                const t = [this.urlInputView, ...this._manualDecoratorSwitches, this.saveButtonView, this.cancelButtonView];
                t.forEach(t => {
                    this._focusables.add(t);
                    this.focusTracker.add(t.element)
                });
                this.keystrokes.listenTo(this.element)
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            _createUrlInput() {
                const t = this.locale.t;
                const e = new Kv(this.locale, Yv);
                e.label = t("lq");
                e.inputView.placeholder = "https://example.com";
                return e
            }

            _createButton(t, e, i, n) {
                const o = new hb(this.locale);
                o.set({label: t, icon: e, tooltip: true});
                o.extendTemplate({attributes: {class: i}});
                if (n) {
                    o.delegate("execute").to(this, n)
                }
                return o
            }

            _createManualDecoratorSwitches(t) {
                const e = this.createCollection();
                for (const i of t) {
                    const t = new Fb(this.locale);
                    t.set({name: i.id, label: i.label, withText: true});
                    t.bind("isOn").to(i, "value");
                    t.on("execute", () => {
                        i.set("value", !t.isOn)
                    });
                    e.add(t)
                }
                return e
            }

            _createFormChildren(t) {
                const e = this.createCollection();
                e.add(this.urlInputView);
                if (t.length) {
                    const t = new Gp;
                    t.setTemplate({
                        tag: "ul",
                        children: this._manualDecoratorSwitches.map(t => ({
                            tag: "li",
                            children: [t],
                            attributes: {class: ["ck", "ck-list__item"]}
                        })),
                        attributes: {class: ["ck", "ck-reset", "ck-list"]}
                    });
                    e.add(t)
                }
                e.add(this.saveButtonView);
                e.add(this.cancelButtonView);
                return e
            }
        }

        var $A = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562l-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';
        var GA = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.3 17.37l-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506L13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5L9.375 17H19v1.5H8z"/></svg>';
        var KA = i(84);

        class JA extends Gp {
            constructor(t) {
                super(t);
                const e = t.t;
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.previewButtonView = this._createPreviewButton();
                this.unlinkButtonView = this._createButton(e("lk"), $A, "unlink");
                this.editButtonView = this._createButton(e("ll"), GA, "edit");
                this.set("href");
                this._focusables = new bp;
                this._focusCycler = new yb({
                    focusables: this._focusables,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "shift + tab", focusNext: "tab"}
                });
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-link-actions"], tabindex: "-1"},
                    children: [this.previewButtonView, this.editButtonView, this.unlinkButtonView]
                })
            }

            render() {
                super.render();
                const t = [this.previewButtonView, this.editButtonView, this.unlinkButtonView];
                t.forEach(t => {
                    this._focusables.add(t);
                    this.focusTracker.add(t.element)
                });
                this.keystrokes.listenTo(this.element)
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            _createButton(t, e, i) {
                const n = new hb(this.locale);
                n.set({label: t, icon: e, tooltip: true});
                n.delegate("execute").to(this, i);
                return n
            }

            _createPreviewButton() {
                const t = new hb(this.locale);
                const e = this.bindTemplate;
                const i = this.t;
                t.set({withText: true, tooltip: i("lm")});
                t.extendTemplate({
                    attributes: {
                        class: ["ck", "ck-link-actions__preview"],
                        href: e.to("href", t => t && CA(t)),
                        target: "_blank",
                        rel: "noopener noreferrer"
                    }
                });
                t.bind("label").to(this, "href", t => t || i("ln"));
                t.bind("isEnabled").to(this, "href", t => !!t);
                t.template.tag = "a";
                t.template.eventListeners = {};
                return t
            }
        }

        var YA = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.077 15l.991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';
        const QA = "Ctrl+K";

        class XA extends mp {
            static get requires() {
                return [kb]
            }

            static get pluginName() {
                return "LinkUI"
            }

            init() {
                const t = this.editor;
                t.editing.view.addObserver(WA);
                this.actionsView = this._createActionsView();
                this.formView = this._createFormView();
                this._balloon = t.plugins.get(kb);
                this._createToolbarLinkButton();
                this._enableUserBalloonInteractions()
            }

            destroy() {
                super.destroy();
                this.formView.destroy()
            }

            _createActionsView() {
                const t = this.editor;
                const e = new JA(t.locale);
                const i = t.commands.get("link");
                const n = t.commands.get("unlink");
                e.bind("href").to(i, "value");
                e.editButtonView.bind("isEnabled").to(i);
                e.unlinkButtonView.bind("isEnabled").to(n);
                this.listenTo(e, "edit", () => {
                    this._addFormView()
                });
                this.listenTo(e, "unlink", () => {
                    t.execute("unlink");
                    this._hideUI()
                });
                e.keystrokes.set("Esc", (t, e) => {
                    this._hideUI();
                    e()
                });
                e.keystrokes.set(QA, (t, e) => {
                    this._addFormView();
                    e()
                });
                return e
            }

            _createFormView() {
                const t = this.editor;
                const e = t.commands.get("link");
                const i = new UA(t.locale, e.manualDecorators);
                i.urlInputView.bind("value").to(e, "value");
                i.urlInputView.bind("isReadOnly").to(e, "isEnabled", t => !t);
                i.saveButtonView.bind("isEnabled").to(e);
                this.listenTo(i, "submit", () => {
                    t.execute("link", i.urlInputView.inputView.element.value, i.getDecoratorSwitchesState());
                    this._closeFormView()
                });
                this.listenTo(i, "cancel", () => {
                    this._closeFormView()
                });
                i.keystrokes.set("Esc", (t, e) => {
                    this._closeFormView();
                    e()
                });
                return i
            }

            _createToolbarLinkButton() {
                const t = this.editor;
                const e = t.commands.get("link");
                const i = t.t;
                t.keystrokes.set(QA, (t, e) => {
                    e();
                    this._showUI(true)
                });
                t.ui.componentFactory.add("link", t => {
                    const n = new hb(t);
                    n.isEnabled = true;
                    n.label = i("lf");
                    n.icon = YA;
                    n.keystroke = QA;
                    n.tooltip = true;
                    n.isToggleable = true;
                    n.bind("isEnabled").to(e, "isEnabled");
                    n.bind("isOn").to(e, "value", t => !!t);
                    this.listenTo(n, "execute", () => this._showUI(true));
                    return n
                })
            }

            _enableUserBalloonInteractions() {
                const t = this.editor.editing.view.document;
                this.listenTo(t, "click", () => {
                    const t = this._getSelectedLinkElement();
                    if (t) {
                        this._showUI()
                    }
                });
                this.editor.keystrokes.set("Tab", (t, e) => {
                    if (this._areActionsVisible && !this.actionsView.focusTracker.isFocused) {
                        this.actionsView.focus();
                        e()
                    }
                }, {priority: "high"});
                this.editor.keystrokes.set("Esc", (t, e) => {
                    if (this._isUIVisible) {
                        this._hideUI();
                        e()
                    }
                });
                Db({
                    emitter: this.formView,
                    activator: () => this._isUIInPanel,
                    contextElements: [this._balloon.view.element],
                    callback: () => this._hideUI()
                })
            }

            _addActionsView() {
                if (this._areActionsInPanel) {
                    return
                }
                this._balloon.add({view: this.actionsView, position: this._getBalloonPositionData()})
            }

            _addFormView() {
                if (this._isFormInPanel) {
                    return
                }
                const t = this.editor;
                const e = t.commands.get("link");
                this._balloon.add({view: this.formView, position: this._getBalloonPositionData()});
                if (this._balloon.visibleView === this.formView) {
                    this.formView.urlInputView.select()
                }
                this.formView.urlInputView.inputView.element.value = e.value || ""
            }

            _closeFormView() {
                const t = this.editor.commands.get("link");
                t.restoreManualDecoratorStates();
                if (t.value !== undefined) {
                    this._removeFormView()
                } else {
                    this._hideUI()
                }
            }

            _removeFormView() {
                if (this._isFormInPanel) {
                    this.formView.saveButtonView.focus();
                    this._balloon.remove(this.formView);
                    this.editor.editing.view.focus()
                }
            }

            _showUI(t = false) {
                if (!this._getSelectedLinkElement()) {
                    this._addActionsView();
                    if (t) {
                        this._balloon.showStack("main")
                    }
                    this._addFormView()
                } else {
                    if (this._areActionsVisible) {
                        this._addFormView()
                    } else {
                        this._addActionsView()
                    }
                    if (t) {
                        this._balloon.showStack("main")
                    }
                }
                this._startUpdatingUI()
            }

            _hideUI() {
                if (!this._isUIInPanel) {
                    return
                }
                const t = this.editor;
                this.stopListening(t.ui, "update");
                this.stopListening(this._balloon, "change:visibleView");
                t.editing.view.focus();
                this._removeFormView();
                this._balloon.remove(this.actionsView)
            }

            _startUpdatingUI() {
                const t = this.editor;
                const e = t.editing.view.document;
                let i = this._getSelectedLinkElement();
                let n = r();
                const o = () => {
                    const t = this._getSelectedLinkElement();
                    const e = r();
                    if (i && !t || !i && e !== n) {
                        this._hideUI()
                    } else if (this._isUIVisible) {
                        this._balloon.updatePosition(this._getBalloonPositionData())
                    }
                    i = t;
                    n = e
                };

                function r() {
                    return e.selection.focus.getAncestors().reverse().find(t => t.is("element"))
                }

                this.listenTo(t.ui, "update", o);
                this.listenTo(this._balloon, "change:visibleView", o)
            }

            get _isFormInPanel() {
                return this._balloon.hasView(this.formView)
            }

            get _areActionsInPanel() {
                return this._balloon.hasView(this.actionsView)
            }

            get _areActionsVisible() {
                return this._balloon.visibleView === this.actionsView
            }

            get _isUIInPanel() {
                return this._isFormInPanel || this._areActionsInPanel
            }

            get _isUIVisible() {
                const t = this._balloon.visibleView;
                return t == this.formView || this._areActionsVisible
            }

            _getBalloonPositionData() {
                const t = this.editor.editing.view;
                const e = t.document;
                const i = this._getSelectedLinkElement();
                const n = i ? t.domConverter.mapViewToDom(i) : t.domConverter.viewRangeToDom(e.selection.getFirstRange());
                return {target: n}
            }

            _getSelectedLinkElement() {
                const t = this.editor.editing.view;
                const e = t.document.selection;
                if (e.isCollapsed) {
                    return ZA(e.getFirstPosition())
                } else {
                    const i = e.getFirstRange().getTrimmed();
                    const n = ZA(i.start);
                    const o = ZA(i.end);
                    if (!n || n != o) {
                        return null
                    }
                    if (t.createRangeIn(n).getTrimmed().isEqual(i)) {
                        return n
                    } else {
                        return null
                    }
                }
            }
        }

        function ZA(t) {
            return t.getAncestors().find(t => yA(t))
        }

        class tT extends mp {
            static get requires() {
                return [HA, XA]
            }

            static get pluginName() {
                return "Link"
            }
        }

        class eT extends jw {
            constructor(t, e) {
                super(t);
                this.type = e
            }

            refresh() {
                this.value = this._getValue();
                this.isEnabled = this._checkEnabled()
            }

            execute() {
                const t = this.editor.model;
                const e = t.document;
                const i = Array.from(e.selection.getSelectedBlocks()).filter(e => nT(e, t.schema));
                const n = this.value === true;
                t.change(t => {
                    if (n) {
                        let e = i[i.length - 1].nextSibling;
                        let n = Number.POSITIVE_INFINITY;
                        let o = [];
                        while (e && e.name == "listItem" && e.getAttribute("listIndent") !== 0) {
                            const t = e.getAttribute("listIndent");
                            if (t < n) {
                                n = t
                            }
                            const i = t - n;
                            o.push({element: e, listIndent: i});
                            e = e.nextSibling
                        }
                        o = o.reverse();
                        for (const e of o) {
                            t.setAttribute("listIndent", e.listIndent, e.element)
                        }
                    }
                    if (!n) {
                        let t = Number.POSITIVE_INFINITY;
                        for (const e of i) {
                            if (e.is("listItem") && e.getAttribute("listIndent") < t) {
                                t = e.getAttribute("listIndent")
                            }
                        }
                        t = t === 0 ? 1 : t;
                        iT(i, true, t);
                        iT(i, false, t)
                    }
                    for (const e of i.reverse()) {
                        if (n && e.name == "listItem") {
                            t.rename(e, "paragraph")
                        } else if (!n && e.name != "listItem") {
                            t.setAttributes({listType: this.type, listIndent: 0}, e);
                            t.rename(e, "listItem")
                        } else if (!n && e.name == "listItem" && e.getAttribute("listType") != this.type) {
                            t.setAttribute("listType", this.type, e)
                        }
                    }
                })
            }

            _getValue() {
                const t = Ww(this.editor.model.document.selection.getSelectedBlocks());
                return !!t && t.is("listItem") && t.getAttribute("listType") == this.type
            }

            _checkEnabled() {
                if (this.value) {
                    return true
                }
                const t = this.editor.model.document.selection;
                const e = this.editor.model.schema;
                const i = Ww(t.getSelectedBlocks());
                if (!i) {
                    return false
                }
                return nT(i, e)
            }
        }

        function iT(t, e, i) {
            const n = e ? t[0] : t[t.length - 1];
            if (n.is("listItem")) {
                let o = n[e ? "previousSibling" : "nextSibling"];
                let r = n.getAttribute("listIndent");
                while (o && o.is("listItem") && o.getAttribute("listIndent") >= i) {
                    if (r > o.getAttribute("listIndent")) {
                        r = o.getAttribute("listIndent")
                    }
                    if (o.getAttribute("listIndent") == r) {
                        t[e ? "unshift" : "push"](o)
                    }
                    o = o[e ? "previousSibling" : "nextSibling"]
                }
            }
        }

        function nT(t, e) {
            return e.checkChild(t.parent, "listItem") && !e.isObject(t)
        }

        class oT extends jw {
            constructor(t, e) {
                super(t);
                this._indentBy = e == "forward" ? 1 : -1
            }

            refresh() {
                this.isEnabled = this._checkEnabled()
            }

            execute() {
                const t = this.editor.model;
                const e = t.document;
                let i = Array.from(e.selection.getSelectedBlocks());
                t.change(t => {
                    const e = i[i.length - 1];
                    let n = e.nextSibling;
                    while (n && n.name == "listItem" && n.getAttribute("listIndent") > e.getAttribute("listIndent")) {
                        i.push(n);
                        n = n.nextSibling
                    }
                    if (this._indentBy < 0) {
                        i = i.reverse()
                    }
                    for (const e of i) {
                        const i = e.getAttribute("listIndent") + this._indentBy;
                        if (i < 0) {
                            t.rename(e, "paragraph")
                        } else {
                            t.setAttribute("listIndent", i, e)
                        }
                    }
                })
            }

            _checkEnabled() {
                const t = Ww(this.editor.model.document.selection.getSelectedBlocks());
                if (!t || !t.is("listItem")) {
                    return false
                }
                if (this._indentBy > 0) {
                    const e = t.getAttribute("listIndent");
                    const i = t.getAttribute("listType");
                    let n = t.previousSibling;
                    while (n && n.is("listItem") && n.getAttribute("listIndent") >= e) {
                        if (n.getAttribute("listIndent") == e) {
                            return n.getAttribute("listType") == i
                        }
                        n = n.previousSibling
                    }
                    return false
                }
                return true
            }
        }

        function rT(t) {
            const e = t.createContainerElement("li");
            e.getFillerOffset = hT;
            return e
        }

        function sT(t, e) {
            const i = e.mapper;
            const n = e.writer;
            const o = t.getAttribute("listType") == "numbered" ? "ol" : "ul";
            const r = rT(n);
            const s = n.createContainerElement(o, null);
            n.insert(n.createPositionAt(s, 0), r);
            i.bindElements(t, r);
            return r
        }

        function aT(t, e, i, n) {
            const o = e.parent;
            const r = i.mapper;
            const s = i.writer;
            let a = r.toViewPosition(n.createPositionBefore(t));
            const c = dT(t.previousSibling, {
                sameIndent: true,
                smallerIndent: true,
                listIndent: t.getAttribute("listIndent")
            });
            const l = t.previousSibling;
            if (c && c.getAttribute("listIndent") == t.getAttribute("listIndent")) {
                const t = r.toViewElement(c);
                a = s.breakContainer(s.createPositionAfter(t))
            } else {
                if (l && l.name == "listItem") {
                    a = r.toViewPosition(n.createPositionAt(l, "end"))
                } else {
                    a = r.toViewPosition(n.createPositionBefore(t))
                }
            }
            a = lT(a);
            s.insert(a, o);
            if (l && l.name == "listItem") {
                const t = r.toViewElement(l);
                const i = s.createRange(s.createPositionAt(t, 0), a);
                const n = i.getWalker({ignoreElementEnd: true});
                for (const t of n) {
                    if (t.item.is("li")) {
                        const i = s.breakContainer(s.createPositionBefore(t.item));
                        const o = t.item.parent;
                        const r = s.createPositionAt(e, "end");
                        cT(s, r.nodeBefore, r.nodeAfter);
                        s.move(s.createRangeOn(o), r);
                        n.position = i
                    }
                }
            } else {
                const i = o.nextSibling;
                if (i && (i.is("ul") || i.is("ol"))) {
                    let n = null;
                    for (const e of i.getChildren()) {
                        const i = r.toModelElement(e);
                        if (i && i.getAttribute("listIndent") > t.getAttribute("listIndent")) {
                            n = e
                        } else {
                            break
                        }
                    }
                    if (n) {
                        s.breakContainer(s.createPositionAfter(n));
                        s.move(s.createRangeOn(n.parent), s.createPositionAt(e, "end"))
                    }
                }
            }
            cT(s, o, o.nextSibling);
            cT(s, o.previousSibling, o)
        }

        function cT(t, e, i) {
            if (!e || !i || e.name != "ul" && e.name != "ol") {
                return null
            }
            if (e.name != i.name || e.getAttribute("class") !== i.getAttribute("class")) {
                return null
            }
            return t.mergeContainers(t.createPositionAfter(e))
        }

        function lT(t) {
            return t.getLastMatchingPosition(t => t.item.is("uiElement"))
        }

        function dT(t, e) {
            const i = !!e.sameIndent;
            const n = !!e.smallerIndent;
            const o = e.listIndent;
            let r = t;
            while (r && r.name == "listItem") {
                const t = r.getAttribute("listIndent");
                if (i && o == t || n && o > t) {
                    return r
                }
                r = r.previousSibling
            }
            return null
        }

        function uT(t, e, i, n) {
            t.ui.componentFactory.add(e, o => {
                const r = t.commands.get(e);
                const s = new hb(o);
                s.set({label: i, icon: n, tooltip: true, isToggleable: true});
                s.bind("isOn", "isEnabled").to(r, "value", "isEnabled");
                s.on("execute", () => {
                    t.execute(e);
                    t.editing.view.focus()
                });
                return s
            })
        }

        function hT() {
            const t = !this.isEmpty && (this.getChild(0).name == "ul" || this.getChild(0).name == "ol");
            if (this.isEmpty || t) {
                return 0
            }
            return Hc.call(this)
        }

        function fT(t) {
            return (e, i, n) => {
                const o = n.consumable;
                if (!o.test(i.item, "insert") || !o.test(i.item, "attribute:listType") || !o.test(i.item, "attribute:listIndent")) {
                    return
                }
                o.consume(i.item, "insert");
                o.consume(i.item, "attribute:listType");
                o.consume(i.item, "attribute:listIndent");
                const r = i.item;
                const s = sT(r, n);
                aT(r, s, n, t)
            }
        }

        function gT(t) {
            return (e, i, n) => {
                const o = n.mapper.toViewPosition(i.position).getLastMatchingPosition(t => !t.item.is("li"));
                const r = o.nodeAfter;
                const s = n.writer;
                s.breakContainer(s.createPositionBefore(r));
                s.breakContainer(s.createPositionAfter(r));
                const a = r.parent;
                const c = a.previousSibling;
                const l = s.createRangeOn(a);
                const d = s.remove(l);
                if (c && c.nextSibling) {
                    cT(s, c, c.nextSibling)
                }
                const u = n.mapper.toModelElement(r);
                ET(u.getAttribute("listIndent") + 1, i.position, l.start, r, n, t);
                for (const t of s.createRangeIn(d).getItems()) {
                    n.mapper.unbindViewElement(t)
                }
                e.stop()
            }
        }

        function mT(t, e, i) {
            if (!i.consumable.consume(e.item, "attribute:listType")) {
                return
            }
            const n = i.mapper.toViewElement(e.item);
            const o = i.writer;
            o.breakContainer(o.createPositionBefore(n));
            o.breakContainer(o.createPositionAfter(n));
            const r = n.parent;
            const s = e.attributeNewValue == "numbered" ? "ol" : "ul";
            o.rename(s, r)
        }

        function pT(t, e, i) {
            const n = i.mapper.toViewElement(e.item);
            const o = n.parent;
            const r = i.writer;
            cT(r, o, o.nextSibling);
            cT(r, o.previousSibling, o);
            for (const t of e.item.getChildren()) {
                i.consumable.consume(t, "insert")
            }
        }

        function bT(t) {
            return (e, i, n) => {
                if (!n.consumable.consume(i.item, "attribute:listIndent")) {
                    return
                }
                const o = n.mapper.toViewElement(i.item);
                const r = n.writer;
                r.breakContainer(r.createPositionBefore(o));
                r.breakContainer(r.createPositionAfter(o));
                const s = o.parent;
                const a = s.previousSibling;
                const c = r.createRangeOn(s);
                r.remove(c);
                if (a && a.nextSibling) {
                    cT(r, a, a.nextSibling)
                }
                ET(i.attributeOldValue + 1, i.range.start, c.start, o, n, t);
                aT(i.item, o, n, t);
                for (const t of i.item.getChildren()) {
                    n.consumable.consume(t, "insert")
                }
            }
        }

        function wT(t, e, i) {
            if (e.item.name != "listItem") {
                let t = i.mapper.toViewPosition(e.range.start);
                const n = i.writer;
                const o = [];
                while (t.parent.name == "ul" || t.parent.name == "ol") {
                    t = n.breakContainer(t);
                    if (t.parent.name != "li") {
                        break
                    }
                    const e = t;
                    const i = n.createPositionAt(t.parent, "end");
                    if (!e.isEqual(i)) {
                        const t = n.remove(n.createRange(e, i));
                        o.push(t)
                    }
                    t = n.createPositionAfter(t.parent)
                }
                if (o.length > 0) {
                    for (let e = 0; e < o.length; e++) {
                        const i = t.nodeBefore;
                        const r = n.insert(t, o[e]);
                        t = r.end;
                        if (e > 0) {
                            const e = cT(n, i, i.nextSibling);
                            if (e && e.parent == i) {
                                t.offset--
                            }
                        }
                    }
                    cT(n, t.nodeBefore, t.nodeAfter)
                }
            }
        }

        function kT(t, e, i) {
            const n = i.mapper.toViewPosition(e.position);
            const o = n.nodeBefore;
            const r = n.nodeAfter;
            cT(i.writer, o, r)
        }

        function _T(t, e, i) {
            if (i.consumable.consume(e.viewItem, {name: true})) {
                const t = i.writer;
                const n = t.createElement("listItem");
                const o = OT(e.viewItem);
                t.setAttribute("listIndent", o, n);
                const r = e.viewItem.parent && e.viewItem.parent.name == "ol" ? "numbered" : "bulleted";
                t.setAttribute("listType", r, n);
                const s = i.splitToAllowedParent(n, e.modelCursor);
                if (!s) {
                    return
                }
                t.insert(n, s.position);
                const a = PT(n, e.viewItem.getChildren(), i);
                e.modelRange = t.createRange(e.modelCursor, a);
                if (s.cursorParent) {
                    e.modelCursor = t.createPositionAt(s.cursorParent, 0)
                } else {
                    e.modelCursor = e.modelRange.end
                }
            }
        }

        function vT(t, e, i) {
            if (i.consumable.test(e.viewItem, {name: true})) {
                const t = Array.from(e.viewItem.getChildren());
                for (const e of t) {
                    const t = !(e.is("li") || RT(e));
                    if (t) {
                        e._remove()
                    }
                }
            }
        }

        function yT(t, e, i) {
            if (i.consumable.test(e.viewItem, {name: true})) {
                if (e.viewItem.childCount === 0) {
                    return
                }
                const t = [...e.viewItem.getChildren()];
                let i = false;
                let n = true;
                for (const e of t) {
                    if (i && !RT(e)) {
                        e._remove()
                    }
                    if (e.is("text")) {
                        if (n) {
                            e._data = e.data.replace(/^\s+/, "")
                        }
                        if (!e.nextSibling || RT(e.nextSibling)) {
                            e._data = e.data.replace(/\s+$/, "")
                        }
                    } else if (RT(e)) {
                        i = true
                    }
                    n = false
                }
            }
        }

        function xT(t) {
            return (e, i) => {
                if (i.isPhantom) {
                    return
                }
                const n = i.modelPosition.nodeBefore;
                if (n && n.is("listItem")) {
                    const e = i.mapper.toViewElement(n);
                    const o = e.getAncestors().find(RT);
                    const r = t.createPositionAt(e, 0).getWalker();
                    for (const t of r) {
                        if (t.type == "elementStart" && t.item.is("li")) {
                            i.viewPosition = t.previousPosition;
                            break
                        } else if (t.type == "elementEnd" && t.item == o) {
                            i.viewPosition = t.nextPosition;
                            break
                        }
                    }
                }
            }
        }

        function CT(t) {
            return (e, i) => {
                const n = i.viewPosition;
                const o = n.parent;
                const r = i.mapper;
                if (o.name == "ul" || o.name == "ol") {
                    if (!n.isAtEnd) {
                        const e = r.toModelElement(n.nodeAfter);
                        i.modelPosition = t.createPositionBefore(e)
                    } else {
                        const e = r.toModelElement(n.nodeBefore);
                        const o = r.getModelLength(n.nodeBefore);
                        i.modelPosition = t.createPositionBefore(e).getShiftedBy(o)
                    }
                    e.stop()
                } else if (o.name == "li" && n.nodeBefore && (n.nodeBefore.name == "ul" || n.nodeBefore.name == "ol")) {
                    const s = r.toModelElement(o);
                    let a = 1;
                    let c = n.nodeBefore;
                    while (c && RT(c)) {
                        a += r.getModelLength(c);
                        c = c.previousSibling
                    }
                    i.modelPosition = t.createPositionBefore(s).getShiftedBy(a);
                    e.stop()
                }
            }
        }

        function AT(t, e) {
            const i = t.document.differ.getChanges();
            const n = new Map;
            let o = false;
            for (const n of i) {
                if (n.type == "insert" && n.name == "listItem") {
                    r(n.position)
                } else if (n.type == "insert" && n.name != "listItem") {
                    if (n.name != "$text") {
                        const i = n.position.nodeAfter;
                        if (i.hasAttribute("listIndent")) {
                            e.removeAttribute("listIndent", i);
                            o = true
                        }
                        if (i.hasAttribute("listType")) {
                            e.removeAttribute("listType", i);
                            o = true
                        }
                        for (const e of Array.from(t.createRangeIn(i)).filter(t => t.item.is("listItem"))) {
                            r(e.previousPosition)
                        }
                    }
                    const i = n.position.getShiftedBy(n.length);
                    r(i)
                } else if (n.type == "remove" && n.name == "listItem") {
                    r(n.position)
                } else if (n.type == "attribute" && n.attributeKey == "listIndent") {
                    r(n.range.start)
                } else if (n.type == "attribute" && n.attributeKey == "listType") {
                    r(n.range.start)
                }
            }
            for (const t of n.values()) {
                s(t);
                a(t)
            }
            return o;

            function r(t) {
                const e = t.nodeBefore;
                if (!e || !e.is("listItem")) {
                    const e = t.nodeAfter;
                    if (e && e.is("listItem")) {
                        n.set(e, e)
                    }
                } else {
                    let i = e;
                    if (n.has(i)) {
                        return
                    }
                    while (i.previousSibling && i.previousSibling.is("listItem")) {
                        i = i.previousSibling;
                        if (n.has(i)) {
                            return
                        }
                    }
                    n.set(t.nodeBefore, i)
                }
            }

            function s(t) {
                let i = 0;
                let n = null;
                while (t && t.is("listItem")) {
                    const r = t.getAttribute("listIndent");
                    if (r > i) {
                        let s;
                        if (n === null) {
                            n = r - i;
                            s = i
                        } else {
                            if (n > r) {
                                n = r
                            }
                            s = r - n
                        }
                        e.setAttribute("listIndent", s, t);
                        o = true
                    } else {
                        n = null;
                        i = t.getAttribute("listIndent") + 1
                    }
                    t = t.nextSibling
                }
            }

            function a(t) {
                let i = [];
                let n = null;
                while (t && t.is("listItem")) {
                    const r = t.getAttribute("listIndent");
                    if (n && n.getAttribute("listIndent") > r) {
                        i = i.slice(0, r + 1)
                    }
                    if (r != 0) {
                        if (i[r]) {
                            const n = i[r];
                            if (t.getAttribute("listType") != n) {
                                e.setAttribute("listType", n, t);
                                o = true
                            }
                        } else {
                            i[r] = t.getAttribute("listType")
                        }
                    }
                    n = t;
                    t = t.nextSibling
                }
            }
        }

        function TT(t, [e, i]) {
            let n = e.is("documentFragment") ? e.getChild(0) : e;
            let o;
            if (!i) {
                o = this.document.selection
            } else {
                o = this.createSelection(i)
            }
            if (n && n.is("listItem")) {
                const t = o.getFirstPosition();
                let e = null;
                if (t.parent.is("listItem")) {
                    e = t.parent
                } else if (t.nodeBefore && t.nodeBefore.is("listItem")) {
                    e = t.nodeBefore
                }
                if (e) {
                    const t = e.getAttribute("listIndent");
                    if (t > 0) {
                        while (n && n.is("listItem")) {
                            n._setAttribute("listIndent", n.getAttribute("listIndent") + t);
                            n = n.nextSibling
                        }
                    }
                }
            }
        }

        function PT(t, e, i) {
            const {writer: n, schema: o} = i;
            let r = n.createPositionAfter(t);
            for (const s of e) {
                if (s.name == "ul" || s.name == "ol") {
                    r = i.convertItem(s, r).modelCursor
                } else {
                    const e = i.convertItem(s, n.createPositionAt(t, "end"));
                    const a = e.modelRange.start.nodeAfter;
                    const c = a && a.is("element") && !o.checkChild(t, a.name);
                    if (c) {
                        if (e.modelCursor.parent.is("listItem")) {
                            t = e.modelCursor.parent
                        } else {
                            t = ST(e.modelCursor)
                        }
                        r = n.createPositionAfter(t)
                    }
                }
            }
            return r
        }

        function ST(t) {
            const e = new Wh({startPosition: t});
            let i;
            do {
                i = e.next()
            } while (!i.value.item.is("listItem"));
            return i.value.item
        }

        function ET(t, e, i, n, o, r) {
            const s = dT(e.nodeBefore, {sameIndent: true, smallerIndent: true, listIndent: t, foo: "b"});
            const a = o.mapper;
            const c = o.writer;
            const l = s ? s.getAttribute("listIndent") : null;
            let d;
            if (!s) {
                d = i
            } else if (l == t) {
                const t = a.toViewElement(s).parent;
                d = c.createPositionAfter(t)
            } else {
                const t = r.createPositionAt(s, "end");
                d = a.toViewPosition(t)
            }
            d = lT(d);
            for (const t of [...n.getChildren()]) {
                if (RT(t)) {
                    d = c.move(c.createRangeOn(t), d).end;
                    cT(c, t, t.nextSibling);
                    cT(c, t.previousSibling, t)
                }
            }
        }

        function RT(t) {
            return t.is("ol") || t.is("ul")
        }

        function OT(t) {
            let e = 0;
            let i = t.parent;
            while (i) {
                if (i.is("li")) {
                    e++
                } else {
                    const t = i.previousSibling;
                    if (t && t.is("li")) {
                        e++
                    }
                }
                i = i.parent
            }
            return e
        }

        class IT extends mp {
            static get pluginName() {
                return "ListEditing"
            }

            static get requires() {
                return [V_]
            }

            init() {
                const t = this.editor;
                t.model.schema.register("listItem", {
                    inheritAllFrom: "$block",
                    allowAttributes: ["listType", "listIndent"]
                });
                const e = t.data;
                const i = t.editing;
                t.model.document.registerPostFixer(e => AT(t.model, e));
                i.mapper.registerViewToModelLength("li", VT);
                e.mapper.registerViewToModelLength("li", VT);
                i.mapper.on("modelToViewPosition", xT(i.view));
                i.mapper.on("viewToModelPosition", CT(t.model));
                e.mapper.on("modelToViewPosition", xT(i.view));
                t.conversion.for("editingDowncast").add(e => {
                    e.on("insert", wT, {priority: "high"});
                    e.on("insert:listItem", fT(t.model));
                    e.on("attribute:listType:listItem", mT, {priority: "high"});
                    e.on("attribute:listType:listItem", pT, {priority: "low"});
                    e.on("attribute:listIndent:listItem", bT(t.model));
                    e.on("remove:listItem", gT(t.model));
                    e.on("remove", kT, {priority: "low"})
                });
                t.conversion.for("dataDowncast").add(e => {
                    e.on("insert", wT, {priority: "high"});
                    e.on("insert:listItem", fT(t.model))
                });
                t.conversion.for("upcast").add(t => {
                    t.on("element:ul", vT, {priority: "high"});
                    t.on("element:ol", vT, {priority: "high"});
                    t.on("element:li", yT, {priority: "high"});
                    t.on("element:li", _T)
                });
                t.model.on("insertContent", TT, {priority: "high"});
                t.commands.add("numberedList", new eT(t, "numbered"));
                t.commands.add("bulletedList", new eT(t, "bulleted"));
                t.commands.add("indentList", new oT(t, "forward"));
                t.commands.add("outdentList", new oT(t, "backward"));
                const n = i.view.document;
                this.listenTo(n, "enter", (t, e) => {
                    const i = this.editor.model.document;
                    const n = i.selection.getLastPosition().parent;
                    if (i.selection.isCollapsed && n.name == "listItem" && n.isEmpty) {
                        this.editor.execute("outdentList");
                        e.preventDefault();
                        t.stop()
                    }
                });
                this.listenTo(n, "delete", (t, e) => {
                    if (e.direction !== "backward") {
                        return
                    }
                    const i = this.editor.model.document.selection;
                    if (!i.isCollapsed) {
                        return
                    }
                    const n = i.getFirstPosition();
                    if (!n.isAtStart) {
                        return
                    }
                    const o = n.parent;
                    if (o.name !== "listItem") {
                        return
                    }
                    const r = o.previousSibling && o.previousSibling.name === "listItem";
                    if (r) {
                        return
                    }
                    this.editor.execute("outdentList");
                    e.preventDefault();
                    t.stop()
                }, {priority: "high"});
                const o = t => (e, i) => {
                    const n = this.editor.commands.get(t);
                    if (n.isEnabled) {
                        this.editor.execute(t);
                        i()
                    }
                };
                t.keystrokes.set("Tab", o("indentList"));
                t.keystrokes.set("Shift+Tab", o("outdentList"))
            }

            afterInit() {
                const t = this.editor.commands;
                const e = t.get("indent");
                const i = t.get("outdent");
                if (e) {
                    e.registerChildCommand(t.get("indentList"))
                }
                if (i) {
                    i.registerChildCommand(t.get("outdentList"))
                }
            }
        }

        function VT(t) {
            let e = 1;
            for (const i of t.getChildren()) {
                if (i.name == "ul" || i.name == "ol") {
                    for (const t of i.getChildren()) {
                        e += VT(t)
                    }
                }
            }
            return e
        }

        var NT = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>';
        var MT = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';

        class BT extends mp {
            init() {
                const t = this.editor.t;
                uT(this.editor, "numberedList", t("lc"), NT);
                uT(this.editor, "bulletedList", t("ld"), MT)
            }
        }

        class zT extends mp {
            static get requires() {
                return [IT, BT]
            }

            static get pluginName() {
                return "List"
            }
        }

        var LT = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>';
        const FT = "removeFormat";

        class DT extends mp {
            static get pluginName() {
                return "RemoveFormatUI"
            }

            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(FT, i => {
                    const n = t.commands.get(FT);
                    const o = new hb(i);
                    o.set({label: e("la"), icon: LT, tooltip: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(FT);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class jT extends jw {
            refresh() {
                const t = this.editor.model;
                this.isEnabled = !!Ww(this._getFormattingItems(t.document.selection, t.schema))
            }

            execute() {
                const t = this.editor.model;
                const e = t.schema;
                t.change(i => {
                    for (const n of this._getFormattingItems(t.document.selection, e)) {
                        if (n.is("selection")) {
                            for (const t of this._getFormattingAttributes(n, e)) {
                                i.removeSelectionAttribute(t)
                            }
                        } else {
                            const t = i.createRangeOn(n);
                            for (const o of this._getFormattingAttributes(n, e)) {
                                i.removeAttribute(o, t)
                            }
                        }
                    }
                })
            }

            * _getFormattingItems(t, e) {
                const i = t => !!Ww(this._getFormattingAttributes(t, e));
                for (const e of t.getRanges()) {
                    for (const t of e.getItems()) {
                        if (i(t)) {
                            yield t
                        }
                    }
                }
                if (i(t)) {
                    yield t
                }
            }

            * _getFormattingAttributes(t, e) {
                for (const [i] of t.getAttributes()) {
                    const t = e.getAttributeProperties(i);
                    if (t && t.isFormatting) {
                        yield i
                    }
                }
            }
        }

        class HT extends mp {
            static get pluginName() {
                return "RemoveFormatEditing"
            }

            init() {
                const t = this.editor;
                t.commands.add("removeFormat", new jT(t))
            }
        }

        class WT extends mp {
            static get requires() {
                return [HT, DT]
            }

            static get pluginName() {
                return "RemoveFormat"
            }
        }

        class qT {
            constructor(t, e = 20) {
                this.model = t;
                this.size = 0;
                this.limit = e;
                this.isLocked = false;
                this._changeCallback = (t, e) => {
                    if (e.type != "transparent" && e !== this._batch) {
                        this._reset(true)
                    }
                };
                this._selectionChangeCallback = () => {
                    this._reset()
                };
                this.model.document.on("change", this._changeCallback);
                this.model.document.selection.on("change:range", this._selectionChangeCallback);
                this.model.document.selection.on("change:attribute", this._selectionChangeCallback)
            }

            get batch() {
                if (!this._batch) {
                    this._batch = this.model.createBatch()
                }
                return this._batch
            }

            input(t) {
                this.size += t;
                if (this.size >= this.limit) {
                    this._reset(true)
                }
            }

            lock() {
                this.isLocked = true
            }

            unlock() {
                this.isLocked = false
            }

            destroy() {
                this.model.document.off("change", this._changeCallback);
                this.model.document.selection.off("change:range", this._selectionChangeCallback);
                this.model.document.selection.off("change:attribute", this._selectionChangeCallback)
            }

            _reset(t) {
                if (!this.isLocked || t) {
                    this._batch = null;
                    this.size = 0
                }
            }
        }

        class UT extends jw {
            constructor(t, e) {
                super(t);
                this._buffer = new qT(t.model, e);
                this._batches = new WeakSet
            }

            get buffer() {
                return this._buffer
            }

            destroy() {
                super.destroy();
                this._buffer.destroy()
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document;
                const n = t.text || "";
                const o = n.length;
                const r = t.range ? e.createSelection(t.range) : i.selection;
                const s = t.resultRange;
                e.enqueueChange(this._buffer.batch, t => {
                    this._buffer.lock();
                    e.deleteContent(r);
                    if (n) {
                        e.insertContent(t.createText(n, i.selection.getAttributes()), r)
                    }
                    if (s) {
                        t.setSelection(s)
                    } else if (!r.is("documentSelection")) {
                        t.setSelection(r)
                    }
                    this._buffer.unlock();
                    this._buffer.input(o);
                    this._batches.add(this._buffer.batch)
                })
            }
        }

        function $T(t) {
            let e = null;
            const i = t.model;
            const n = t.editing.view;
            const o = t.commands.get("input");
            if (Al.isAndroid) {
                n.document.on("beforeinput", (t, e) => r(e), {priority: "lowest"})
            } else {
                n.document.on("keydown", (t, e) => r(e), {priority: "lowest"})
            }
            n.document.on("compositionstart", s, {priority: "lowest"});
            n.document.on("compositionend", () => {
                e = i.createSelection(i.document.selection)
            }, {priority: "lowest"});

            function r(t) {
                const r = i.document;
                const s = n.document.isComposing;
                const c = e && e.isEqual(r.selection);
                e = null;
                if (!o.isEnabled) {
                    return
                }
                if (KT(t) || r.selection.isCollapsed) {
                    return
                }
                if (s && t.keyCode === 229) {
                    return
                }
                if (!s && t.keyCode === 229 && c) {
                    return
                }
                a()
            }

            function s() {
                const t = i.document;
                const e = t.selection.rangeCount === 1 ? t.selection.getFirstRange().isFlat : true;
                if (t.selection.isCollapsed || e) {
                    return
                }
                a()
            }

            function a() {
                const t = o.buffer;
                t.lock();
                i.enqueueChange(t.batch, () => {
                    i.deleteContent(i.document.selection)
                });
                t.unlock()
            }
        }

        const GT = [Ml("arrowUp"), Ml("arrowRight"), Ml("arrowDown"), Ml("arrowLeft"), 9, 16, 17, 18, 19, 20, 27, 33, 34, 35, 36, 45, 91, 93, 144, 145, 173, 174, 175, 176, 177, 178, 179, 255];
        for (let t = 112; t <= 135; t++) {
            GT.push(t)
        }

        function KT(t) {
            if (t.ctrlKey) {
                return true
            }
            return GT.includes(t.keyCode)
        }

        function JT(t, e) {
            const i = [];
            let n = 0;
            let o;
            t.forEach(t => {
                if (t == "equal") {
                    r();
                    n++
                } else if (t == "insert") {
                    if (s("insert")) {
                        o.values.push(e[n])
                    } else {
                        r();
                        o = {type: "insert", index: n, values: [e[n]]}
                    }
                    n++
                } else {
                    if (s("delete")) {
                        o.howMany++
                    } else {
                        r();
                        o = {type: "delete", index: n, howMany: 1}
                    }
                }
            });
            r();
            return i;

            function r() {
                if (o) {
                    i.push(o);
                    o = null
                }
            }

            function s(t) {
                return o && o.type == t
            }
        }

        function YT(t) {
            if (t.length == 0) {
                return false
            }
            for (const e of t) {
                if (e.type === "children" && !QT(e)) {
                    return true
                }
            }
            return false
        }

        function QT(t) {
            if (t.newChildren.length - t.oldChildren.length != 1) {
                return
            }
            const e = _d(t.oldChildren, t.newChildren, XT);
            const i = JT(e, t.newChildren);
            if (i.length > 1) {
                return
            }
            const n = i[0];
            if (!(!!n.values[0] && n.values[0].is("text"))) {
                return
            }
            return n
        }

        function XT(t, e) {
            if (!!t && t.is("text") && !!e && e.is("text")) {
                return t.data === e.data
            } else {
                return t === e
            }
        }

        function ZT(t) {
            t.editing.view.document.on("mutations", (e, i, n) => {
                new tP(t).handle(i, n)
            })
        }

        class tP {
            constructor(t) {
                this.editor = t;
                this.editing = this.editor.editing
            }

            handle(t, e) {
                if (YT(t)) {
                    this._handleContainerChildrenMutations(t, e)
                } else {
                    for (const i of t) {
                        this._handleTextMutation(i, e);
                        this._handleTextNodeInsertion(i)
                    }
                }
            }

            _handleContainerChildrenMutations(t, e) {
                const i = eP(t);
                if (!i) {
                    return
                }
                const n = this.editor.editing.view.domConverter;
                const o = n.mapViewToDom(i);
                const r = new zd(this.editor.editing.view.document);
                const s = this.editor.data.toModel(r.domToView(o)).getChild(0);
                const a = this.editor.editing.mapper.toModelElement(i);
                if (!a) {
                    return
                }
                const c = Array.from(s.getChildren());
                const l = Array.from(a.getChildren());
                const d = c[c.length - 1];
                const u = l[l.length - 1];
                if (d && d.is("softBreak") && u && !u.is("softBreak")) {
                    c.pop()
                }
                const h = this.editor.model.schema;
                if (!iP(c, h) || !iP(l, h)) {
                    return
                }
                const f = c.map(t => t.is("text") ? t.data : "@").join("").replace(/\u00A0/g, " ");
                const g = l.map(t => t.is("text") ? t.data : "@").join("").replace(/\u00A0/g, " ");
                if (g === f) {
                    return
                }
                const m = _d(g, f);
                const {firstChangeAt: p, insertions: b, deletions: w} = nP(m);
                let k = null;
                if (e) {
                    k = this.editing.mapper.toModelRange(e.getFirstRange())
                }
                const _ = f.substr(p, b);
                const v = this.editor.model.createRange(this.editor.model.createPositionAt(a, p), this.editor.model.createPositionAt(a, p + w));
                this.editor.execute("input", {text: _, range: v, resultRange: k})
            }

            _handleTextMutation(t, e) {
                if (t.type != "text") {
                    return
                }
                const i = t.newText.replace(/\u00A0/g, " ");
                const n = t.oldText.replace(/\u00A0/g, " ");
                if (n === i) {
                    return
                }
                const o = _d(n, i);
                const {firstChangeAt: r, insertions: s, deletions: a} = nP(o);
                let c = null;
                if (e) {
                    c = this.editing.mapper.toModelRange(e.getFirstRange())
                }
                const l = this.editing.view.createPositionAt(t.node, r);
                const d = this.editing.mapper.toModelPosition(l);
                const u = this.editor.model.createRange(d, d.getShiftedBy(a));
                const h = i.substr(r, s);
                this.editor.execute("input", {text: h, range: u, resultRange: c})
            }

            _handleTextNodeInsertion(t) {
                if (t.type != "children") {
                    return
                }
                const e = QT(t);
                const i = this.editing.view.createPositionAt(t.node, e.index);
                const n = this.editing.mapper.toModelPosition(i);
                const o = e.values[0].data;
                this.editor.execute("input", {text: o.replace(/\u00A0/g, " "), range: this.editor.model.createRange(n)})
            }
        }

        function eP(t) {
            const e = t.map(t => t.node).reduce((t, e) => t.getCommonAncestor(e, {includeSelf: true}));
            if (!e) {
                return
            }
            return e.getAncestors({
                includeSelf: true,
                parentFirst: true
            }).find(t => t.is("containerElement") || t.is("rootElement"))
        }

        function iP(t, e) {
            return t.every(t => e.isInline(t))
        }

        function nP(t) {
            let e = null;
            let i = null;
            for (let n = 0; n < t.length; n++) {
                const o = t[n];
                if (o != "equal") {
                    e = e === null ? n : e;
                    i = n
                }
            }
            let n = 0;
            let o = 0;
            for (let r = e; r <= i; r++) {
                if (t[r] != "insert") {
                    n++
                }
                if (t[r] != "delete") {
                    o++
                }
            }
            return {insertions: o, deletions: n, firstChangeAt: e}
        }

        class oP extends mp {
            static get pluginName() {
                return "Input"
            }

            init() {
                const t = this.editor;
                const e = new UT(t, t.config.get("typing.undoStep") || 20);
                t.commands.add("input", e);
                $T(t);
                ZT(t)
            }

            isInput(t) {
                const e = this.editor.commands.get("input");
                return e._batches.has(t)
            }
        }

        class rP extends jw {
            constructor(t, e) {
                super(t);
                this.direction = e;
                this._buffer = new qT(t.model, t.config.get("typing.undoStep"))
            }

            get buffer() {
                return this._buffer
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document;
                e.enqueueChange(this._buffer.batch, n => {
                    this._buffer.lock();
                    const o = n.createSelection(t.selection || i.selection);
                    const r = o.isCollapsed;
                    if (o.isCollapsed) {
                        e.modifySelection(o, {direction: this.direction, unit: t.unit})
                    }
                    if (this._shouldEntireContentBeReplacedWithParagraph(t.sequence || 1)) {
                        this._replaceEntireContentWithParagraph(n);
                        return
                    }
                    if (o.isCollapsed) {
                        return
                    }
                    let s = 0;
                    o.getFirstRange().getMinimalFlatRanges().forEach(t => {
                        s += fl(t.getWalker({singleCharacters: true, ignoreElementEnd: true, shallow: true}))
                    });
                    e.deleteContent(o, {doNotResetEntireContent: r, direction: this.direction});
                    this._buffer.input(s);
                    n.setSelection(o);
                    this._buffer.unlock()
                })
            }

            _shouldEntireContentBeReplacedWithParagraph(t) {
                if (t > 1) {
                    return false
                }
                const e = this.editor.model;
                const i = e.document;
                const n = i.selection;
                const o = e.schema.getLimitElement(n);
                const r = n.isCollapsed && n.containsEntireContent(o);
                if (!r) {
                    return false
                }
                if (!e.schema.checkChild(o, "paragraph")) {
                    return false
                }
                const s = o.getChild(0);
                if (s && s.name === "paragraph") {
                    return false
                }
                return true
            }

            _replaceEntireContentWithParagraph(t) {
                const e = this.editor.model;
                const i = e.document;
                const n = i.selection;
                const o = e.schema.getLimitElement(n);
                const r = t.createElement("paragraph");
                t.remove(t.createRangeIn(o));
                t.insert(r, o);
                t.setSelection(r, 0)
            }
        }

        class sP extends Gd {
            constructor(t) {
                super(t);
                const e = t.document;
                let i = 0;
                e.on("keyup", (t, e) => {
                    if (e.keyCode == Nl.delete || e.keyCode == Nl.backspace) {
                        i = 0
                    }
                });
                e.on("keydown", (t, e) => {
                    const o = {};
                    if (e.keyCode == Nl.delete) {
                        o.direction = "forward";
                        o.unit = "character"
                    } else if (e.keyCode == Nl.backspace) {
                        o.direction = "backward";
                        o.unit = "codePoint"
                    } else {
                        return
                    }
                    const r = Al.isMac ? e.altKey : e.ctrlKey;
                    o.unit = r ? "word" : o.unit;
                    o.sequence = ++i;
                    n(t, e.domEvent, o)
                });
                if (Al.isAndroid) {
                    e.on("beforeinput", (e, i) => {
                        if (i.domEvent.inputType != "deleteContentBackward") {
                            return
                        }
                        const o = {unit: "codepoint", direction: "backward", sequence: 1};
                        const r = i.domTarget.ownerDocument.defaultView.getSelection();
                        if (r.anchorNode == r.focusNode && r.anchorOffset + 1 != r.focusOffset) {
                            o.selectionToRemove = t.domConverter.domSelectionToView(r)
                        }
                        n(e, i.domEvent, o)
                    })
                }

                function n(t, i, n) {
                    let o;
                    e.once("delete", t => o = t, {priority: Number.POSITIVE_INFINITY});
                    e.fire("delete", new Ku(e, i, n));
                    if (o && o.stop.called) {
                        t.stop()
                    }
                }
            }

            observe() {
            }
        }

        class aP extends mp {
            static get pluginName() {
                return "Delete"
            }

            init() {
                const t = this.editor;
                const e = t.editing.view;
                const i = e.document;
                e.addObserver(sP);
                t.commands.add("forwardDelete", new rP(t, "forward"));
                t.commands.add("delete", new rP(t, "backward"));
                this.listenTo(i, "delete", (i, n) => {
                    const o = {unit: n.unit, sequence: n.sequence};
                    if (n.selectionToRemove) {
                        const e = t.model.createSelection();
                        const i = [];
                        for (const e of n.selectionToRemove.getRanges()) {
                            i.push(t.editing.mapper.toModelRange(e))
                        }
                        e.setTo(i);
                        o.selection = e
                    }
                    t.execute(n.direction == "forward" ? "forwardDelete" : "delete", o);
                    n.preventDefault();
                    e.scrollToTheSelection()
                });
                if (Al.isAndroid) {
                    let t = null;
                    this.listenTo(i, "delete", (e, i) => {
                        const n = i.domTarget.ownerDocument.defaultView.getSelection();
                        t = {
                            anchorNode: n.anchorNode,
                            anchorOffset: n.anchorOffset,
                            focusNode: n.focusNode,
                            focusOffset: n.focusOffset
                        }
                    }, {priority: "lowest"});
                    this.listenTo(i, "keyup", (e, i) => {
                        if (t) {
                            const e = i.domTarget.ownerDocument.defaultView.getSelection();
                            e.collapse(t.anchorNode, t.anchorOffset);
                            e.extend(t.focusNode, t.focusOffset);
                            t = null
                        }
                    })
                }
            }
        }

        class cP extends mp {
            static get requires() {
                return [oP, aP]
            }

            static get pluginName() {
                return "Typing"
            }
        }

        class lP extends Gp {
            constructor(t, e) {
                super(t);
                const i = t.t;
                this.labelView = new Mk(t);
                this.labelView.text = i("b");
                this.groupDropdownView = this._createGroupDropdown(e);
                this.groupDropdownView.panelPosition = t.uiLanguageDirection === "rtl" ? "se" : "sw";
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-special-characters-navigation"]},
                    children: [this.labelView, this.groupDropdownView]
                })
            }

            get currentGroupName() {
                return this.groupDropdownView.value
            }

            _createGroupDropdown(t) {
                const e = this.locale;
                const i = e.t;
                const n = Wb(e);
                const o = this._getCharacterGroupListItemDefinitions(n, t);
                n.set("value", o.first.model.label);
                n.buttonView.bind("label").to(n, "value");
                n.buttonView.set({isOn: false, withText: true, tooltip: i("le")});
                n.on("execute", t => {
                    n.value = t.source.label
                });
                n.delegate("execute").to(this);
                Ub(n, o);
                return n
            }

            _getCharacterGroupListItemDefinitions(t, e) {
                const i = new ys;
                for (const n of e) {
                    const e = {type: "button", model: new e_({label: n, withText: true})};
                    e.model.bind("isOn").to(t, "value", t => t === e.model.label);
                    i.add(e)
                }
                return i
            }
        }

        var dP = i(86);

        class uP extends Gp {
            constructor(t) {
                super(t);
                this.tiles = this.createCollection();
                this.setTemplate({
                    tag: "div",
                    children: [{
                        tag: "div",
                        attributes: {class: ["ck", "ck-character-grid__tiles"]},
                        children: this.tiles
                    }],
                    attributes: {class: ["ck", "ck-character-grid"]}
                })
            }

            createTile(t, e) {
                const i = new hb(this.locale);
                i.set({label: t, withText: true, class: "ck-character-grid__tile"});
                i.extendTemplate({attributes: {title: e}, on: {mouseover: i.bindTemplate.to("mouseover")}});
                i.on("mouseover", () => {
                    this.fire("tileHover", {name: e, character: t})
                });
                i.on("execute", () => {
                    this.fire("execute", {name: e, character: t})
                });
                return i
            }
        }

        var hP = i(88);

        class fP extends Gp {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                this.set("character", null);
                this.set("name", null);
                this.bind("code").to(this, "character", gP);
                this.setTemplate({
                    tag: "div",
                    children: [{
                        tag: "span",
                        attributes: {class: ["ck-character-info__name"]},
                        children: [{text: e.to("name", t => t ? t : "")}]
                    }, {
                        tag: "span",
                        attributes: {class: ["ck-character-info__code"]},
                        children: [{text: e.to("code")}]
                    }],
                    attributes: {class: ["ck", "ck-character-info"]}
                })
            }
        }

        function gP(t) {
            if (t === null) {
                return ""
            }
            const e = t.codePointAt(0).toString(16);
            return "U+" + ("0000" + e).slice(-4)
        }

        var mP = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2.5a7.47 7.47 0 0 1 4.231 1.31 7.268 7.268 0 0 1 2.703 3.454 7.128 7.128 0 0 1 .199 4.353c-.39 1.436-1.475 2.72-2.633 3.677h2.013c0-.226.092-.443.254-.603a.876.876 0 0 1 1.229 0c.163.16.254.377.254.603v.853c0 .209-.078.41-.22.567a.873.873 0 0 1-.547.28l-.101.006h-4.695a.517.517 0 0 1-.516-.518v-1.265c0-.21.128-.398.317-.489a5.601 5.601 0 0 0 2.492-2.371 5.459 5.459 0 0 0 .552-3.693 5.53 5.53 0 0 0-1.955-3.2A5.71 5.71 0 0 0 10 4.206 5.708 5.708 0 0 0 6.419 5.46 5.527 5.527 0 0 0 4.46 8.663a5.457 5.457 0 0 0 .554 3.695 5.6 5.6 0 0 0 2.497 2.37.55.55 0 0 1 .317.49v1.264c0 .286-.23.518-.516.518H2.618a.877.877 0 0 1-.614-.25.845.845 0 0 1-.254-.603v-.853c0-.226.091-.443.254-.603a.876.876 0 0 1 1.228 0c.163.16.255.377.255.603h1.925c-1.158-.958-2.155-2.241-2.545-3.678a7.128 7.128 0 0 1 .199-4.352 7.268 7.268 0 0 1 2.703-3.455A7.475 7.475 0 0 1 10 2.5z"/></svg>';
        var pP = i(90);
        const bP = "";

        class wP extends mp {
            static get requires() {
                return [cP]
            }

            static get pluginName() {
                return "SpecialCharacters"
            }

            constructor(t) {
                super(t);
                this._characters = new Map;
                this._groups = new Map
            }

            init() {
                const t = this.editor;
                const e = t.t;
                const i = t.commands.get("input");
                t.ui.componentFactory.add("specialCharacters", n => {
                    const o = Wb(n);
                    let r;
                    o.buttonView.set({label: e("b"), icon: mP, tooltip: true});
                    o.bind("isEnabled").to(i);
                    o.on("execute", (e, i) => {
                        t.execute("input", {text: i.character});
                        t.editing.view.focus()
                    });
                    o.on("change:isOpen", () => {
                        if (!r) {
                            r = this._createDropdownPanelContent(n, o);
                            o.panelView.children.add(r.navigationView);
                            o.panelView.children.add(r.gridView);
                            o.panelView.children.add(r.infoView)
                        }
                        r.infoView.set({character: null, name: null})
                    });
                    return o
                })
            }

            addItems(t, e) {
                if (t === bP) {
                    throw new ss["b"](`special-character-invalid-group-name: The name "${bP}" is reserved and cannot be used.`)
                }
                const i = this._getGroup(t);
                for (const t of e) {
                    i.add(t.title);
                    this._characters.set(t.title, t.character)
                }
            }

            getGroups() {
                return this._groups.keys()
            }

            getCharactersForGroup(t) {
                if (t === bP) {
                    return new Set(this._characters.keys())
                }
                return this._groups.get(t)
            }

            getCharacter(t) {
                return this._characters.get(t)
            }

            _getGroup(t) {
                if (!this._groups.has(t)) {
                    this._groups.set(t, new Set)
                }
                return this._groups.get(t)
            }

            _updateGrid(t, e) {
                e.tiles.clear();
                const i = this.getCharactersForGroup(t);
                for (const t of i) {
                    const i = this.getCharacter(t);
                    e.tiles.add(e.createTile(i, t))
                }
            }

            _createDropdownPanelContent(t, e) {
                const i = [...this.getGroups()];
                i.unshift(bP);
                const n = new lP(t, i);
                const o = new uP(t);
                const r = new fP(t);
                o.delegate("execute").to(e);
                o.on("tileHover", (t, e) => {
                    r.set(e)
                });
                n.on("execute", () => {
                    this._updateGrid(n.currentGroupName, o)
                });
                this._updateGrid(n.currentGroupName, o);
                return {navigationView: n, gridView: o, infoView: r}
            }
        }

        class kP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.plugins.get("SpecialCharacters").addItems("", [{character: "$", title: e("u")}, {
                    character: "",
                    title: e("v")
                }, {character: "", title: e("w")}, {character: "", title: e("x")}, {
                    character: "",
                    title: e("y")
                }, {character: "", title: e("z")}, {character: "", title: e("aa")}, {
                    character: "",
                    title: e("ab")
                }, {character: "", title: e("ac")}, {character: "", title: e("ad")}, {
                    character: "",
                    title: e("ae")
                }, {character: "", title: e("af")}, {character: "", title: e("ag")}, {
                    character: "",
                    title: e("ah")
                }, {character: "", title: e("ai")}, {character: "", title: e("aj")}, {
                    character: "",
                    title: e("ak")
                }, {character: "", title: e("al")}, {character: "", title: e("am")}, {
                    character: "",
                    title: e("an")
                }, {character: "", title: e("ao")}, {character: "", title: e("ap")}, {
                    character: "",
                    title: e("aq")
                }, {character: "", title: e("ar")}, {character: "", title: e("as")}, {
                    character: "",
                    title: e("at")
                }, {character: "", title: e("au")}, {character: "", title: e("av")}, {
                    character: "",
                    title: e("aw")
                }, {character: "", title: e("ax")}, {character: "", title: e("ay")}, {
                    character: "",
                    title: e("az")
                }, {character: "", title: e("ba")}, {character: "", title: e("bb")}, {
                    character: "",
                    title: e("bc")
                }, {character: "", title: e("bd")}])
            }
        }

        class _P extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.plugins.get("SpecialCharacters").addItems("", [{
                    character: "<",
                    title: e("gc")
                }, {character: ">", title: e("gd")}, {character: "", title: e("ge")}, {
                    character: "",
                    title: e("gf")
                }, {character: "", title: e("gg")}, {character: "", title: e("gh")}, {
                    character: "",
                    title: e("gi")
                }, {character: "", title: e("gj")}, {character: "", title: e("gk")}, {
                    character: "",
                    title: e("gl")
                }, {character: "", title: e("gm")}, {character: "", title: e("gn")}, {
                    character: "",
                    title: e("go")
                }, {character: "", title: e("gp")}, {character: "", title: e("gq")}, {
                    character: "",
                    title: e("gr")
                }, {character: "", title: e("gs")}, {character: "", title: e("gt")}, {
                    character: "",
                    title: e("gu")
                }, {character: "", title: e("gv")}, {character: "", title: e("gw")}, {
                    character: "",
                    title: e("gx")
                }, {character: "", title: e("gy")}, {character: "", title: e("gz")}, {
                    character: "",
                    title: e("ha")
                }, {character: "", title: e("hb")}, {character: "", title: e("hc")}, {
                    character: "",
                    title: e("hd")
                }, {character: "", title: e("he")}, {character: "", title: e("hf")}, {
                    character: "",
                    title: e("hg")
                }, {character: "", title: e("hh")}, {character: "", title: e("hi")}, {
                    character: "",
                    title: e("hj")
                }, {character: "", title: e("hk")}, {character: "", title: e("hl")}, {
                    character: "",
                    title: e("hm")
                }, {character: "", title: e("hn")}, {character: "", title: e("ho")}, {
                    character: "",
                    title: e("hp")
                }, {character: "", title: e("hq")}, {character: "", title: e("hr")}, {
                    character: "",
                    title: e("hs")
                }, {character: "", title: e("ht")}])
            }
        }

        class vP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.plugins.get("SpecialCharacters").addItems("", [{title: e("c"), character: ""}, {
                    title: e("d"),
                    character: ""
                }, {title: e("e"), character: ""}, {title: e("f"), character: ""}, {
                    title: e("g"),
                    character: ""
                }, {title: e("h"), character: ""}, {title: e("i"), character: ""}, {
                    title: e("j"),
                    character: ""
                }, {title: e("k"), character: ""}, {title: e("l"), character: ""}, {
                    title: e("m"),
                    character: ""
                }, {title: e("n"), character: ""}, {title: e("o"), character: ""}, {
                    title: e("p"),
                    character: ""
                }, {title: e("q"), character: ""}, {title: e("r"), character: ""}, {
                    title: e("s"),
                    character: ""
                }, {title: e("t"), character: ""}])
            }
        }

        class yP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.plugins.get("SpecialCharacters").addItems(" ", [{
                    character: "",
                    title: e("be")
                }, {character: "", title: e("bf")}, {character: "", title: e("bg")}, {
                    character: "",
                    title: e("bh")
                }, {character: "", title: e("bi")}, {character: "", title: e("bj")}, {
                    character: "",
                    title: e("bk")
                }, {character: "", title: e("bl")}, {character: "", title: e("bm")}, {
                    character: "",
                    title: e("bn")
                }, {character: "", title: e("bo")}, {character: "", title: e("bp")}, {
                    character: "",
                    title: e("bq")
                }, {character: "", title: e("br")}, {character: "", title: e("bs")}, {
                    character: "",
                    title: e("bt")
                }, {character: "", title: e("bu")}, {character: "", title: e("bv")}, {
                    character: "",
                    title: e("bw")
                }, {character: "", title: e("bx")}, {character: "", title: e("by")}, {
                    character: "",
                    title: e("bz")
                }, {character: "", title: e("ca")}, {character: "", title: e("cb")}, {
                    character: "",
                    title: e("cc")
                }, {character: "", title: e("cd")}, {character: "", title: e("ce")}, {
                    character: "",
                    title: e("cf")
                }, {character: "", title: e("cg")}, {character: "", title: e("ch")}, {
                    character: "",
                    title: e("ci")
                }, {character: "", title: e("cj")}, {character: "", title: e("ck")}, {
                    character: "",
                    title: e("cl")
                }, {character: "", title: e("cm")}, {character: "", title: e("cn")}, {
                    character: "",
                    title: e("co")
                }, {character: "", title: e("cp")}, {character: "", title: e("cq")}, {
                    character: "",
                    title: e("cr")
                }, {character: "", title: e("cs")}, {character: "", title: e("ct")}, {
                    character: "",
                    title: e("cu")
                }, {character: "", title: e("cv")}, {character: "", title: e("cw")}, {
                    character: "",
                    title: e("cx")
                }, {character: "", title: e("cy")}, {character: "", title: e("cz")}, {
                    character: "",
                    title: e("da")
                }, {character: "", title: e("db")}, {character: "", title: e("dc")}, {
                    character: "",
                    title: e("dd")
                }, {character: "", title: e("de")}, {character: "", title: e("df")}, {
                    character: "",
                    title: e("dg")
                }, {character: "", title: e("dh")}, {character: "", title: e("di")}, {
                    character: "",
                    title: e("dj")
                }, {character: "", title: e("dk")}, {character: "", title: e("dl")}, {
                    character: "",
                    title: e("dm")
                }, {character: "", title: e("dn")}, {character: "", title: e("do")}, {
                    character: "",
                    title: e("dp")
                }, {character: "", title: e("dq")}, {character: "", title: e("dr")}, {
                    character: "",
                    title: e("ds")
                }, {character: "", title: e("dt")}, {character: "", title: e("du")}, {
                    character: "",
                    title: e("dv")
                }, {character: "", title: e("dw")}, {character: "", title: e("dx")}, {
                    character: "",
                    title: e("dy")
                }, {character: "", title: e("dz")}, {character: "", title: e("ea")}, {
                    character: "",
                    title: e("eb")
                }, {character: "", title: e("ec")}, {character: "", title: e("ed")}, {
                    character: "",
                    title: e("ee")
                }, {character: "", title: e("ef")}, {character: "", title: e("eg")}, {
                    character: "",
                    title: e("eh")
                }, {character: "", title: e("ei")}, {character: "", title: e("ej")}, {
                    character: "",
                    title: e("ek")
                }, {character: "", title: e("el")}, {character: "", title: e("em")}, {
                    character: "",
                    title: e("en")
                }, {character: "", title: e("eo")}, {character: "", title: e("ep")}, {
                    character: "",
                    title: e("eq")
                }, {character: "", title: e("er")}, {character: "", title: e("es")}, {
                    character: "",
                    title: e("et")
                }, {character: "", title: e("eu")}, {character: "", title: e("ev")}, {
                    character: "",
                    title: e("ew")
                }, {character: "", title: e("ex")}, {character: "", title: e("ey")}, {
                    character: "",
                    title: e("ez")
                }, {character: "", title: e("fa")}, {character: "", title: e("fb")}, {
                    character: "",
                    title: e("fc")
                }, {character: "", title: e("fd")}, {character: "", title: e("fe")}, {
                    character: "",
                    title: e("ff")
                }, {character: "", title: e("fg")}, {character: "", title: e("fh")}, {
                    character: "",
                    title: e("fi")
                }, {character: "", title: e("fj")}, {character: "", title: e("fk")}, {
                    character: "",
                    title: e("fl")
                }, {character: "", title: e("fm")}, {character: "", title: e("fn")}, {
                    character: "",
                    title: e("fo")
                }, {character: "", title: e("fp")}, {character: "", title: e("fq")}, {
                    character: "",
                    title: e("fr")
                }, {character: "", title: e("fs")}, {character: "", title: e("ft")}, {
                    character: "",
                    title: e("fu")
                }, {character: "", title: e("fv")}, {character: "", title: e("fw")}, {
                    character: "",
                    title: e("fx")
                }, {character: "", title: e("fy")}, {character: "", title: e("fz")}, {
                    character: "",
                    title: e("ga")
                }, {character: "", title: e("gb")}])
            }
        }

        class xP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.plugins.get("SpecialCharacters").addItems(" ", [{
                    character: "",
                    title: e("hu")
                }, {character: "", title: e("hv")}, {character: "", title: e("hw")}, {
                    character: "",
                    title: e("hx")
                }, {character: "", title: e("hy")}, {character: "", title: e("hz")}, {
                    character: "",
                    title: e("ia")
                }, {character: "", title: e("ib")}, {character: "", title: e("ic")}, {
                    character: "",
                    title: e("id")
                }, {character: "", title: e("ie")}, {character: "", title: e("if")}, {
                    character: "",
                    title: e("ig")
                }, {character: "", title: e("ih")}, {character: "", title: e("ii")}, {
                    character: "",
                    title: e("ij")
                }, {character: "", title: e("ik")}, {character: "", title: e("il")}, {
                    character: "",
                    title: e("im")
                }, {character: "", title: e("in")}, {character: "", title: e("io")}, {
                    character: "",
                    title: e("ip")
                }, {character: "", title: e("iq")}, {character: "", title: e("ir")}, {
                    character: "",
                    title: e("is")
                }, {character: "", title: e("it")}, {character: "", title: e("iu")}])
            }
        }

        class CP extends mp {
            static get requires() {
                return [kP, xP, _P, vP, yP]
            }
        }

        const AP = "strikethrough";

        class TP extends mp {
            static get pluginName() {
                return "StrikethroughEditing"
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: AP});
                t.model.schema.setAttributeProperties(AP, {isFormatting: true, copyOnEnter: true});
                t.conversion.attributeToElement({
                    model: AP,
                    view: "s",
                    upcastAlso: ["del", "strike", {styles: {"text-decoration": "line-through"}}]
                });
                t.commands.add(AP, new yk(t, AP));
                t.keystrokes.set("CTRL+SHIFT+X", "strikethrough")
            }
        }

        var PP = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9L6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';
        const SP = "strikethrough";

        class EP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(SP, i => {
                    const n = t.commands.get(SP);
                    const o = new hb(i);
                    o.set({label: e("jk"), icon: PP, keystroke: "CTRL+SHIFT+X", tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(SP);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class RP extends mp {
            static get requires() {
                return [TP, EP]
            }

            static get pluginName() {
                return "Strikethrough"
            }
        }

        const OP = "subscript";

        class IP extends mp {
            static get pluginName() {
                return "SubscriptEditing"
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: OP});
                t.model.schema.setAttributeProperties(OP, {isFormatting: true, copyOnEnter: true});
                t.conversion.attributeToElement({
                    model: OP,
                    view: "sub",
                    upcastAlso: [{styles: {"vertical-align": "sub"}}]
                });
                t.commands.add(OP, new yk(t, OP))
            }
        }

        var VP = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>';
        const NP = "subscript";

        class MP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(NP, i => {
                    const n = t.commands.get(NP);
                    const o = new hb(i);
                    o.set({label: e("jl"), icon: VP, tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(NP);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class BP extends mp {
            static get requires() {
                return [IP, MP]
            }

            static get pluginName() {
                return "Subscript"
            }
        }

        const zP = "superscript";

        class LP extends mp {
            static get pluginName() {
                return "SuperscriptEditing"
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: zP});
                t.model.schema.setAttributeProperties(zP, {isFormatting: true, copyOnEnter: true});
                t.conversion.attributeToElement({
                    model: zP,
                    view: "sup",
                    upcastAlso: [{styles: {"vertical-align": "super"}}]
                });
                t.commands.add(zP, new yk(t, zP))
            }
        }

        var FP = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>';
        const DP = "superscript";

        class jP extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(DP, i => {
                    const n = t.commands.get(DP);
                    const o = new hb(i);
                    o.set({label: e("jm"), icon: FP, tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(DP);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class HP extends mp {
            static get requires() {
                return [LP, jP]
            }

            static get pluginName() {
                return "Superscript"
            }
        }

        function WP(t, e) {
            let i = e.parent;
            while (i) {
                if (i.name === t) {
                    return i
                }
                i = i.parent
            }
        }

        function qP(t, e, i, n, o = 1) {
            if (e > o) {
                n.setAttribute(t, e, i)
            } else {
                n.removeAttribute(t, i)
            }
        }

        function UP(t, e, i = {}) {
            const n = t.createElement("tableCell", i);
            t.insertElement("paragraph", n);
            t.insert(n, e)
        }

        function $P(t) {
            if (!t || !ct(t)) {
                return t
            }
            const {top: e, right: i, bottom: n, left: o} = t;
            if (e == i && i == n && n == o) {
                return e
            }
        }

        function GP(t, e) {
            const i = parseFloat(t);
            if (Number.isNaN(i)) {
                return t
            }
            if (String(i) !== String(t)) {
                return t
            }
            return `${i}${e}`
        }

        function KP(t, e) {
            const i = e.parent.parent;
            const n = parseInt(i.getAttribute("headingColumns") || 0);
            const {column: o} = t.getCellLocation(e);
            return !!n && o < n
        }

        function JP() {
            return t => {
                t.on("element:table", (t, e, i) => {
                    const n = e.viewItem;
                    if (!i.consumable.test(n, {name: true})) {
                        return
                    }
                    const {rows: o, headingRows: r, headingColumns: s} = QP(n);
                    const a = {};
                    if (s) {
                        a.headingColumns = s
                    }
                    if (r) {
                        a.headingRows = r
                    }
                    const c = i.writer.createElement("table", a);
                    const l = i.splitToAllowedParent(c, e.modelCursor);
                    if (!l) {
                        return
                    }
                    i.writer.insert(c, l.position);
                    i.consumable.consume(n, {name: true});
                    if (o.length) {
                        o.forEach(t => i.convertItem(t, i.writer.createPositionAt(c, "end")))
                    } else {
                        const t = i.writer.createElement("tableRow");
                        i.writer.insert(t, i.writer.createPositionAt(c, "end"));
                        UP(i.writer, i.writer.createPositionAt(t, "end"))
                    }
                    e.modelRange = i.writer.createRange(i.writer.createPositionBefore(c), i.writer.createPositionAfter(c));
                    if (l.cursorParent) {
                        e.modelCursor = i.writer.createPositionAt(l.cursorParent, 0)
                    } else {
                        e.modelCursor = e.modelRange.end
                    }
                })
            }
        }

        function YP(t) {
            return e => {
                e.on(`element:${t}`, (t, e, i) => {
                    const n = e.viewItem;
                    if (!i.consumable.test(n, {name: true})) {
                        return
                    }
                    const o = i.writer.createElement("tableCell");
                    const r = i.splitToAllowedParent(o, e.modelCursor);
                    if (!r) {
                        return
                    }
                    i.writer.insert(o, r.position);
                    i.consumable.consume(n, {name: true});
                    const s = i.writer.createPositionAt(o, 0);
                    i.convertChildren(n, s);
                    if (!o.childCount) {
                        i.writer.insertElement("paragraph", s)
                    }
                    e.modelRange = i.writer.createRange(i.writer.createPositionBefore(o), i.writer.createPositionAfter(o));
                    e.modelCursor = e.modelRange.end
                })
            }
        }

        function QP(t) {
            const e = {headingRows: 0, headingColumns: 0};
            const i = [];
            const n = [];
            let o;
            for (const r of Array.from(t.getChildren())) {
                if (r.name === "tbody" || r.name === "thead" || r.name === "tfoot") {
                    if (r.name === "thead" && !o) {
                        o = r
                    }
                    const t = Array.from(r.getChildren()).filter(t => t.is("element", "tr"));
                    for (const r of t) {
                        if (r.parent.name === "thead" && r.parent === o) {
                            e.headingRows++;
                            i.push(r)
                        } else {
                            n.push(r);
                            const t = XP(r, e, o);
                            if (t > e.headingColumns) {
                                e.headingColumns = t
                            }
                        }
                    }
                }
            }
            e.rows = [...i, ...n];
            return e
        }

        function XP(t) {
            let e = 0;
            let i = 0;
            const n = Array.from(t.getChildren()).filter(t => t.name === "th" || t.name === "td");
            while (i < n.length && n[i].name === "th") {
                const t = n[i];
                const o = parseInt(t.getAttribute("colspan") || 1);
                e = e + o;
                i++
            }
            return e
        }

        class ZP {
            constructor(t, e = {}) {
                this.table = t;
                this.startRow = e.startRow || 0;
                this.endRow = typeof e.endRow == "number" ? e.endRow : undefined;
                this.includeSpanned = !!e.includeSpanned;
                this.column = typeof e.column == "number" ? e.column : undefined;
                this._skipRows = new Set;
                this._row = 0;
                this._column = 0;
                this._cellIndex = 0;
                this._spannedCells = new Map;
                this._nextCellAtColumn = -1
            }

            [Symbol.iterator]() {
                return this
            }

            next() {
                const t = this.table.getChild(this._row);
                if (!t || this._isOverEndRow()) {
                    return {done: true}
                }
                let e, i, n;
                if (this._isSpanned(this._row, this._column)) {
                    e = this._getSpanned(this._row, this._column);
                    i = !this.includeSpanned || this._shouldSkipRow() || this._shouldSkipColumn();
                    n = this._formatOutValue(e, this._column, true)
                } else {
                    e = t.getChild(this._cellIndex);
                    if (!e) {
                        this._row++;
                        this._column = 0;
                        this._cellIndex = 0;
                        this._nextCellAtColumn = -1;
                        return this.next()
                    }
                    const o = parseInt(e.getAttribute("colspan") || 1);
                    const r = parseInt(e.getAttribute("rowspan") || 1);
                    if (o > 1 || r > 1) {
                        this._recordSpans(this._row, this._column, r, o, e)
                    }
                    this._nextCellAtColumn = this._column + o;
                    i = this._shouldSkipRow() || this._shouldSkipColumn();
                    n = this._formatOutValue(e, this._column, false, r, o)
                }
                this._column++;
                if (this._column == this._nextCellAtColumn) {
                    this._cellIndex++
                }
                return i ? this.next() : n
            }

            skipRow(t) {
                this._skipRows.add(t)
            }

            _isOverEndRow() {
                return this.endRow !== undefined && this._row > this.endRow
            }

            _formatOutValue(t, e, i, n = 1, o = 1) {
                return {
                    done: false,
                    value: {
                        cell: t,
                        row: this._row,
                        column: e,
                        isSpanned: i,
                        rowspan: n,
                        colspan: o,
                        cellIndex: this._cellIndex
                    }
                }
            }

            _shouldSkipRow() {
                const t = this._row < this.startRow;
                const e = this._skipRows.has(this._row);
                return t || e
            }

            _shouldSkipColumn() {
                if (this.column === undefined) {
                    return false
                }
                return this.column != this._column
            }

            _isSpanned(t, e) {
                if (!this._spannedCells.has(t)) {
                    return false
                }
                const i = this._spannedCells.get(t);
                return i.has(e)
            }

            _getSpanned(t, e) {
                return this._spannedCells.get(t).get(e)
            }

            _recordSpans(t, e, i, n, o) {
                for (let i = e + 1; i <= e + n - 1; i++) {
                    this._markSpannedCell(t, i, o)
                }
                for (let r = t + 1; r < t + i; r++) {
                    for (let t = e; t <= e + n - 1; t++) {
                        this._markSpannedCell(r, t, o)
                    }
                }
            }

            _markSpannedCell(t, e, i) {
                if (!this._spannedCells.has(t)) {
                    this._spannedCells.set(t, new Map)
                }
                const n = this._spannedCells.get(t);
                n.set(e, i)
            }
        }

        function tS(t, e) {
            e.setCustomProperty("table", true, t);
            return X_(t, e, {hasSelectionHandle: true})
        }

        function eS(t) {
            return !!t.getCustomProperty("table") && Q_(t)
        }

        function iS(t) {
            const e = t.getSelectedElement();
            if (e && eS(e)) {
                return e
            }
            return null
        }

        function nS(t) {
            const e = WP("table", t.getFirstPosition());
            if (e && eS(e.parent)) {
                return e.parent
            }
            return null
        }

        function oS(t) {
            const e = [];
            for (const i of aS(t.getRanges())) {
                const t = i.getContainedElement();
                if (t && t.is("tableCell")) {
                    e.push(t)
                }
            }
            return e
        }

        function rS(t) {
            const e = [];
            for (const i of t.getRanges()) {
                const t = WP("tableCell", i.start);
                if (t) {
                    e.push(t)
                }
            }
            return e
        }

        function sS(t) {
            const e = oS(t);
            if (e.length) {
                return e
            }
            return rS(t)
        }

        function aS(t) {
            return Array.from(t).sort(cS)
        }

        function cS(t, e) {
            const i = t.start;
            const n = e.start;
            if (i.isEqual(n)) {
                return 0
            }
            return i.isBefore(n) ? -1 : 1
        }

        function lS(t = {}) {
            return e => e.on("insert:table", (e, i, n) => {
                const o = i.item;
                if (!n.consumable.consume(o, "insert")) {
                    return
                }
                n.consumable.consume(o, "attribute:headingRows:table");
                n.consumable.consume(o, "attribute:headingColumns:table");
                const r = t && t.asWidget;
                const s = n.writer.createContainerElement("figure", {class: "table"});
                const a = n.writer.createContainerElement("table");
                n.writer.insert(n.writer.createPositionAt(s, 0), a);
                let c;
                if (r) {
                    c = tS(s, n.writer)
                }
                const l = new ZP(o);
                const d = {
                    headingRows: o.getAttribute("headingRows") || 0,
                    headingColumns: o.getAttribute("headingColumns") || 0
                };
                const u = new Map;
                for (const e of l) {
                    const {row: i, cell: r} = e;
                    const s = vS(_S(i, d), a, n);
                    const c = o.getChild(i);
                    const l = u.get(i) || wS(c, i, s, n);
                    u.set(i, l);
                    n.consumable.consume(r, "insert");
                    const h = n.writer.createPositionAt(l, "end");
                    bS(e, d, h, n, t)
                }
                const h = n.mapper.toViewPosition(i.range.start);
                n.mapper.bindElements(o, r ? c : s);
                n.writer.insert(h, r ? c : s)
            })
        }

        function dS(t = {}) {
            return e => e.on("insert:tableRow", (e, i, n) => {
                const o = i.item;
                if (!n.consumable.consume(o, "insert")) {
                    return
                }
                const r = o.parent;
                const s = n.mapper.toViewElement(r);
                const a = TS(s);
                const c = r.getChildIndex(o);
                const l = new ZP(r, {startRow: c, endRow: c});
                const d = {
                    headingRows: r.getAttribute("headingRows") || 0,
                    headingColumns: r.getAttribute("headingColumns") || 0
                };
                const u = new Map;
                for (const e of l) {
                    const i = vS(_S(c, d), a, n);
                    const r = u.get(c) || wS(o, c, i, n);
                    u.set(c, r);
                    n.consumable.consume(e.cell, "insert");
                    const s = n.writer.createPositionAt(r, "end");
                    bS(e, d, s, n, t)
                }
            })
        }

        function uS(t = {}) {
            return e => e.on("insert:tableCell", (e, i, n) => {
                const o = i.item;
                if (!n.consumable.consume(o, "insert")) {
                    return
                }
                const r = o.parent;
                const s = r.parent;
                const a = s.getChildIndex(r);
                const c = new ZP(s, {startRow: a, endRow: a});
                const l = {
                    headingRows: s.getAttribute("headingRows") || 0,
                    headingColumns: s.getAttribute("headingColumns") || 0
                };
                for (const e of c) {
                    if (e.cell === o) {
                        const i = n.mapper.toViewElement(r);
                        const s = n.writer.createPositionAt(i, r.getChildIndex(o));
                        bS(e, l, s, n, t);
                        return
                    }
                }
            })
        }

        function hS(t = {}) {
            const e = !!t.asWidget;
            return t => t.on("attribute:headingRows:table", (t, i, n) => {
                const o = i.item;
                if (!n.consumable.consume(i.item, t.name)) {
                    return
                }
                const r = n.mapper.toViewElement(o);
                const s = TS(r);
                const a = i.attributeOldValue;
                const c = i.attributeNewValue;
                if (c > a) {
                    const t = Array.from(o.getChildren()).filter(({index: t}) => l(t, a - 1, c));
                    const i = vS("thead", s, n);
                    AS(t, i, n, "end");
                    for (const i of t) {
                        for (const t of i.getChildren()) {
                            mS(t, "th", n, e)
                        }
                    }
                    CS("tbody", s, n)
                } else {
                    const t = Array.from(o.getChildren()).filter(({index: t}) => l(t, c - 1, a)).reverse();
                    const i = vS("tbody", s, n);
                    AS(t, i, n, 0);
                    const r = new ZP(o, {startRow: c ? c - 1 : c, endRow: a - 1});
                    const d = {
                        headingRows: o.getAttribute("headingRows") || 0,
                        headingColumns: o.getAttribute("headingColumns") || 0
                    };
                    for (const t of r) {
                        pS(t, d, n, e)
                    }
                    CS("thead", s, n)
                }

                function l(t, e, i) {
                    return t > e && t < i
                }
            })
        }

        function fS(t = {}) {
            const e = !!t.asWidget;
            return t => t.on("attribute:headingColumns:table", (t, i, n) => {
                const o = i.item;
                if (!n.consumable.consume(i.item, t.name)) {
                    return
                }
                const r = {
                    headingRows: o.getAttribute("headingRows") || 0,
                    headingColumns: o.getAttribute("headingColumns") || 0
                };
                const s = i.attributeOldValue;
                const a = i.attributeNewValue;
                const c = (s > a ? s : a) - 1;
                for (const t of new ZP(o)) {
                    if (t.column > c) {
                        continue
                    }
                    pS(t, r, n, e)
                }
            })
        }

        function gS() {
            return t => t.on("remove:tableRow", (t, e, i) => {
                t.stop();
                const n = i.writer;
                const o = i.mapper;
                const r = o.toViewPosition(e.position).getLastMatchingPosition(t => !t.item.is("tr"));
                const s = r.nodeAfter;
                const a = s.parent;
                const c = n.createRangeOn(s);
                const l = n.remove(c);
                for (const t of n.createRangeIn(l).getItems()) {
                    o.unbindViewElement(t)
                }
                if (!a.childCount) {
                    n.remove(n.createRangeOn(a))
                }
            }, {priority: "higher"})
        }

        function mS(t, e, i, n) {
            const o = i.writer;
            const r = i.mapper.toViewElement(t);
            if (!r) {
                return
            }
            let s;
            if (n) {
                const t = o.createEditableElement(e, r.getAttributes());
                s = iv(t, o);
                o.insert(o.createPositionAfter(r), s);
                o.move(o.createRangeIn(r), o.createPositionAt(s, 0));
                o.remove(o.createRangeOn(r))
            } else {
                s = o.rename(e, r)
            }
            i.mapper.unbindViewElement(r);
            i.mapper.bindElements(t, s)
        }

        function pS(t, e, i, n) {
            const {cell: o} = t;
            const r = kS(t, e);
            const s = i.mapper.toViewElement(o);
            if (s && s.name !== r) {
                mS(o, r, i, n)
            }
        }

        function bS(t, e, i, n, o) {
            const r = o && o.asWidget;
            const s = kS(t, e);
            const a = r ? iv(n.writer.createEditableElement(s), n.writer) : n.writer.createContainerElement(s);
            const c = t.cell;
            const l = c.getChild(0);
            const d = c.childCount === 1 && l.name === "paragraph";
            n.writer.insert(i, a);
            if (d && !PS(l)) {
                const t = c.getChild(0);
                const e = n.writer.createPositionAt(a, "end");
                n.consumable.consume(t, "insert");
                if (o.asWidget) {
                    const i = n.writer.createContainerElement("span", {style: "display:inline-block"});
                    n.mapper.bindElements(t, i);
                    n.writer.insert(e, i);
                    n.mapper.bindElements(c, a)
                } else {
                    n.mapper.bindElements(c, a);
                    n.mapper.bindElements(t, a)
                }
            } else {
                n.mapper.bindElements(c, a)
            }
        }

        function wS(t, e, i, n) {
            n.consumable.consume(t, "insert");
            const o = n.writer.createContainerElement("tr");
            n.mapper.bindElements(t, o);
            const r = t.parent.getAttribute("headingRows") || 0;
            const s = r > 0 && e >= r ? e - r : e;
            const a = n.writer.createPositionAt(i, s);
            n.writer.insert(a, o);
            return o
        }

        function kS(t, e) {
            const {row: i, column: n} = t;
            const {headingColumns: o, headingRows: r} = e;
            const s = r && r > i;
            if (s) {
                return "th"
            }
            const a = o && o > n;
            return a ? "th" : "td"
        }

        function _S(t, e) {
            return t < e.headingRows ? "thead" : "tbody"
        }

        function vS(t, e, i) {
            const n = yS(t, e);
            return n ? n : xS(t, e, i)
        }

        function yS(t, e) {
            for (const i of e.getChildren()) {
                if (i.name == t) {
                    return i
                }
            }
        }

        function xS(t, e, i) {
            const n = i.writer.createContainerElement(t);
            const o = i.writer.createPositionAt(e, t == "tbody" ? "end" : 0);
            i.writer.insert(o, n);
            return n
        }

        function CS(t, e, i) {
            const n = yS(t, e);
            if (n && n.childCount === 0) {
                i.writer.remove(i.writer.createRangeOn(n))
            }
        }

        function AS(t, e, i, n) {
            for (const o of t) {
                const t = i.mapper.toViewElement(o);
                if (t) {
                    i.writer.move(i.writer.createRangeOn(t), i.writer.createPositionAt(e, n))
                }
            }
        }

        function TS(t) {
            for (const e of t.getChildren()) {
                if (e.name === "table") {
                    return e
                }
            }
        }

        function PS(t) {
            return !![...t.getAttributeKeys()].length
        }

        class SS extends jw {
            refresh() {
                const t = this.editor.model;
                const e = t.document.selection;
                const i = t.schema;
                const n = ES(e.getFirstPosition());
                this.isEnabled = i.checkChild(n, "table")
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document.selection;
                const n = this.editor.plugins.get("TableUtils");
                const o = parseInt(t.rows) || 2;
                const r = parseInt(t.columns) || 2;
                const s = nv(i, e);
                e.change(t => {
                    const i = n.createTable(t, o, r);
                    e.insertContent(i, s);
                    t.setSelection(t.createPositionAt(i.getNodeByPath([0, 0, 0]), 0))
                })
            }
        }

        function ES(t) {
            const e = t.parent;
            return e === e.root ? e : e.parent
        }

        class RS extends jw {
            constructor(t, e = {}) {
                super(t);
                this.order = e.order || "below"
            }

            refresh() {
                const t = this.editor.model.document.selection;
                const e = WP("table", t.getFirstPosition());
                this.isEnabled = !!e
            }

            execute() {
                const t = this.editor;
                const e = t.model.document.selection;
                const i = t.plugins.get("TableUtils");
                const n = this.order === "above";
                const o = n ? e.getFirstPosition() : e.getLastPosition();
                const r = n ? e.getFirstRange() : e.getLastRange();
                const s = r.getContainedElement() || WP("tableCell", o);
                const a = s.parent;
                const c = a.parent;
                const l = c.getChildIndex(a);
                i.insertRows(c, {rows: 1, at: this.order === "below" ? l + 1 : l})
            }
        }

        class OS extends jw {
            constructor(t, e = {}) {
                super(t);
                this.order = e.order || "right"
            }

            refresh() {
                const t = this.editor.model.document.selection;
                const e = WP("table", t.getFirstPosition());
                this.isEnabled = !!e
            }

            execute() {
                const t = this.editor;
                const e = t.model.document.selection;
                const i = t.plugins.get("TableUtils");
                const n = this.order === "left";
                const o = n ? e.getFirstPosition() : e.getLastPosition();
                const r = n ? e.getFirstRange() : e.getLastRange();
                const s = r.getContainedElement() || WP("tableCell", o);
                const a = s.parent.parent;
                const {column: c} = i.getCellLocation(s);
                i.insertColumns(a, {columns: 1, at: n ? c : c + 1})
            }
        }

        class IS extends jw {
            constructor(t, e = {}) {
                super(t);
                this.direction = e.direction || "horizontally"
            }

            refresh() {
                const t = sS(this.editor.model.document.selection);
                this.isEnabled = t.length === 1
            }

            execute() {
                const t = sS(this.editor.model.document.selection)[0];
                const e = this.direction === "horizontally";
                const i = this.editor.plugins.get("TableUtils");
                if (e) {
                    i.splitCellHorizontally(t, 2)
                } else {
                    i.splitCellVertically(t, 2)
                }
            }
        }

        class VS extends jw {
            constructor(t, e) {
                super(t);
                this.direction = e.direction;
                this.isHorizontal = this.direction == "right" || this.direction == "left"
            }

            refresh() {
                const t = this._getMergeableCell();
                this.value = t;
                this.isEnabled = !!t
            }

            execute() {
                const t = this.editor.model;
                const e = t.document;
                const i = rS(e.selection)[0];
                const n = this.value;
                const o = this.direction;
                t.change(t => {
                    const e = o == "right" || o == "down";
                    const r = e ? i : n;
                    const s = e ? n : i;
                    const a = s.parent;
                    zS(s, r, t);
                    const c = this.isHorizontal ? "colspan" : "rowspan";
                    const l = parseInt(i.getAttribute(c) || 1);
                    const d = parseInt(n.getAttribute(c) || 1);
                    t.setAttribute(c, l + d, r);
                    t.setSelection(t.createRangeIn(r));
                    if (!a.childCount) {
                        BS(a, t)
                    }
                })
            }

            _getMergeableCell() {
                const t = this.editor.model;
                const e = t.document;
                const i = rS(e.selection)[0];
                if (!i) {
                    return
                }
                const n = this.editor.plugins.get("TableUtils");
                const o = this.isHorizontal ? NS(i, this.direction, n) : MS(i, this.direction);
                if (!o) {
                    return
                }
                const r = this.isHorizontal ? "rowspan" : "colspan";
                const s = parseInt(i.getAttribute(r) || 1);
                const a = parseInt(o.getAttribute(r) || 1);
                if (a === s) {
                    return o
                }
            }
        }

        function NS(t, e, i) {
            const n = t.parent;
            const o = n.parent;
            const r = e == "right" ? t.nextSibling : t.previousSibling;
            const s = (o.getAttribute("headingColumns") || 0) > 0;
            if (!r) {
                return
            }
            const a = e == "right" ? t : r;
            const c = e == "right" ? r : t;
            const {column: l} = i.getCellLocation(a);
            const {column: d} = i.getCellLocation(c);
            const u = parseInt(a.getAttribute("colspan") || 1);
            const h = KP(i, a, o);
            const f = KP(i, c, o);
            if (s && h != f) {
                return
            }
            const g = l + u === d;
            return g ? r : undefined
        }

        function MS(t, e) {
            const i = t.parent;
            const n = i.parent;
            const o = n.getChildIndex(i);
            if (e == "down" && o === n.childCount - 1 || e == "up" && o === 0) {
                return
            }
            const r = parseInt(t.getAttribute("rowspan") || 1);
            const s = n.getAttribute("headingRows") || 0;
            const a = e == "down" && o + r === s;
            const c = e == "up" && o === s;
            if (s && (a || c)) {
                return
            }
            const l = parseInt(t.getAttribute("rowspan") || 1);
            const d = e == "down" ? o + l : o;
            const u = [...new ZP(n, {endRow: d})];
            const h = u.find(e => e.cell === t);
            const f = h.column;
            const g = u.find(({row: t, rowspan: i, column: n}) => {
                if (n !== f) {
                    return false
                }
                if (e == "down") {
                    return t === d
                } else {
                    return d === t + i
                }
            });
            return g && g.cell
        }

        function BS(t, e) {
            const i = t.parent;
            const n = i.getChildIndex(t);
            for (const {cell: t, row: o, rowspan: r} of new ZP(i, {endRow: n})) {
                const i = o + r - 1 >= n;
                if (i) {
                    qP("rowspan", r - 1, t, e)
                }
            }
            e.remove(t)
        }

        function zS(t, e, i) {
            if (!LS(t)) {
                if (LS(e)) {
                    i.remove(i.createRangeIn(e))
                }
                i.move(i.createRangeIn(t), i.createPositionAt(e, "end"))
            }
            i.remove(t)
        }

        function LS(t) {
            return t.childCount == 1 && t.getChild(0).is("paragraph") && t.getChild(0).isEmpty
        }

        class FS extends jw {
            refresh() {
                const t = sS(this.editor.model.document.selection);
                const e = t[0];
                if (e) {
                    const i = e.parent.parent;
                    const n = this.editor.plugins.get("TableUtils").getRows(i);
                    const o = [...new ZP(i)];
                    const r = o.filter(e => t.includes(e.cell)).map(t => t.row);
                    const s = r[0];
                    const a = r[r.length - 1];
                    this.isEnabled = a - s < n - 1
                } else {
                    this.isEnabled = false
                }
            }

            execute() {
                const t = sS(this.editor.model.document.selection);
                const e = DS(t);
                const i = t[0];
                const n = i.parent.parent;
                const o = [...new ZP(n, {endRow: e.last})];
                const r = this.editor.model.createBatch();
                const s = HS(o, i);
                this.editor.model.enqueueChange(r, t => {
                    t.setSelection(t.createSelection(n, "on"))
                });
                let a;
                for (let t = e.last; t >= e.first; t--) {
                    this.editor.model.enqueueChange(r, e => {
                        const i = t;
                        this._removeRow(i, n, e, o);
                        a = jS(n, i, s)
                    })
                }
                this.editor.model.enqueueChange(r, t => {
                    t.setSelection(t.createPositionAt(a, 0))
                })
            }

            _removeRow(t, e, i, n) {
                const o = new Map;
                const r = e.getChild(t);
                const s = e.getAttribute("headingRows") || 0;
                if (s && t < s) {
                    qP("headingRows", s - 1, e, i, 0)
                }
                n.filter(({row: e, rowspan: i}) => e === t && i > 1).forEach(({column: t, cell: e, rowspan: i}) => o.set(t, {
                    cell: e,
                    rowspanToSet: i - 1
                }));
                n.filter(({row: e, rowspan: i}) => e <= t - 1 && e + i > t).forEach(({cell: t, rowspan: e}) => qP("rowspan", e - 1, t, i));
                const a = t + 1;
                const c = new ZP(e, {includeSpanned: true, startRow: a, endRow: a});
                let l;
                for (const {row: t, column: n, cell: r} of [...c]) {
                    if (o.has(n)) {
                        const {cell: r, rowspanToSet: s} = o.get(n);
                        const a = l ? i.createPositionAfter(l) : i.createPositionAt(e.getChild(t), 0);
                        i.move(i.createRangeOn(r), a);
                        qP("rowspan", s, r, i);
                        l = r
                    } else {
                        l = r
                    }
                }
                i.remove(r)
            }
        }

        function DS(t) {
            const e = t.map(t => t.parent.index).sort();
            return {first: e[0], last: e[e.length - 1]}
        }

        function jS(t, e, i) {
            const n = t.getChild(e) || t.getChild(t.childCount - 1);
            let o = n.getChild(0);
            let r = 0;
            for (const t of n.getChildren()) {
                if (r > i) {
                    return o
                }
                o = t;
                r += parseInt(t.getAttribute("colspan") || 1)
            }
            return o
        }

        function HS(t, e) {
            const i = t.find(t => t.cell === e);
            return i.column
        }

        class WS extends jw {
            refresh() {
                const t = sS(this.editor.model.document.selection);
                const e = t[0];
                if (e) {
                    const i = e.parent.parent;
                    const n = this.editor.plugins.get("TableUtils").getColumns(i);
                    const o = [...new ZP(i)];
                    const r = o.filter(e => t.includes(e.cell)).map(t => t.column).sort();
                    const s = r[0];
                    const a = r[r.length - 1];
                    this.isEnabled = a - s < n - 1
                } else {
                    this.isEnabled = false
                }
            }

            execute() {
                const [t, e] = $S(this.editor.model.document.selection);
                const i = t.parent.parent;
                const n = [...new ZP(i)];
                const o = {first: n.find(e => e.cell === t).column, last: n.find(t => t.cell === e).column};
                const r = US(n, t, e, o);
                this.editor.model.change(t => {
                    t.setSelection(t.createRangeOn(i));
                    qS(i, o, t);
                    for (let e = o.last; e >= o.first; e--) {
                        for (const {cell: i, column: o, colspan: r} of n) {
                            if (o <= e && r > 1 && o + r > e) {
                                qP("colspan", r - 1, i, t)
                            } else if (o === e) {
                                const e = i.parent;
                                t.remove(i);
                                if (!e.childCount) {
                                    t.remove(e)
                                }
                            }
                        }
                    }
                    t.setSelection(t.createPositionAt(r, 0))
                })
            }
        }

        function qS(t, e, i) {
            const n = t.getAttribute("headingColumns") || 0;
            if (n && e.first <= n) {
                const o = Math.min(n - 1, e.last) - e.first + 1;
                i.setAttribute("headingColumns", n - o, t)
            }
        }

        function US(t, e, i, n) {
            const o = parseInt(i.getAttribute("colspan") || 1);
            if (o > 1) {
                return i
            } else if (e.previousSibling || i.nextSibling) {
                return i.nextSibling || e.previousSibling
            } else {
                if (n.first) {
                    return t.reverse().find(({column: t}) => t < n.first).cell
                } else {
                    return t.reverse().find(({column: t}) => t > n.last).cell
                }
            }
        }

        function $S(t) {
            const e = sS(t);
            const i = e[0];
            const n = e.pop();
            const o = [i, n];
            return i.isBefore(n) ? o : o.reverse()
        }

        class GS extends jw {
            refresh() {
                const t = this.editor.model;
                const e = sS(t.document.selection);
                const i = e.length > 0;
                this.isEnabled = i;
                this.value = i && e.every(t => this._isInHeading(t, t.parent.parent))
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = sS(e.document.selection);
                const n = i[0];
                const o = i[i.length - 1];
                const r = n.parent.parent;
                const s = r.getAttribute("headingRows") || 0;
                const [a, c] = [n.parent.index, o.parent.index].sort();
                if (t.forceValue === this.value) {
                    return
                }
                const l = this.value ? a : c + 1;
                e.change(t => {
                    if (l) {
                        const e = KS(r, l, s);
                        for (const i of e) {
                            JS(i, l, t)
                        }
                    }
                    qP("headingRows", l, r, t, 0)
                })
            }

            _isInHeading(t, e) {
                const i = parseInt(e.getAttribute("headingRows") || 0);
                return !!i && t.parent.index < i
            }
        }

        function KS(t, e, i) {
            const n = [];
            const o = e > i ? i : 0;
            const r = e - 1;
            const s = new ZP(t, {startRow: o, endRow: r});
            for (const {row: t, rowspan: i, cell: o} of s) {
                if (i > 1 && t + i > e) {
                    n.push(o)
                }
            }
            return n
        }

        function JS(t, e, i) {
            const n = t.parent;
            const o = n.parent;
            const r = n.index;
            const s = parseInt(t.getAttribute("rowspan"));
            const a = e - r;
            const c = {};
            const l = s - a;
            if (l > 1) {
                c.rowspan = l
            }
            const d = parseInt(t.getAttribute("colspan") || 1);
            if (d > 1) {
                c.colspan = d
            }
            const u = o.getChildIndex(n);
            const h = u + a;
            const f = [...new ZP(o, {startRow: u, endRow: h, includeSpanned: true})];
            let g;
            for (const {row: e, column: n, cell: r, cellIndex: s} of f) {
                if (r === t && g === undefined) {
                    g = n
                }
                if (g !== undefined && g === n && e === h) {
                    const t = o.getChild(e);
                    const n = i.createPositionAt(t, s);
                    UP(i, n, c)
                }
            }
            qP("rowspan", a, t, i)
        }

        class YS extends jw {
            refresh() {
                const t = this.editor.model;
                const e = sS(t.document.selection);
                const i = this.editor.plugins.get("TableUtils");
                const n = e.length > 0;
                this.isEnabled = n;
                this.value = n && e.every(t => KP(i, t))
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = this.editor.plugins.get("TableUtils");
                const n = sS(e.document.selection);
                const o = n[0];
                const r = n[n.length - 1];
                const s = o.parent;
                const a = s.parent;
                const [c, l] = [i.getCellLocation(o).column, i.getCellLocation(r).column].sort();
                if (t.forceValue === this.value) {
                    return
                }
                const d = this.value ? c : l + 1;
                e.change(t => {
                    qP("headingColumns", d, a, t, 0)
                })
            }
        }

        class QS extends mp {
            static get pluginName() {
                return "TableUtils"
            }

            getCellLocation(t) {
                const e = t.parent;
                const i = e.parent;
                const n = i.getChildIndex(e);
                const o = new ZP(i, {startRow: n, endRow: n});
                for (const {cell: e, row: i, column: n} of o) {
                    if (e === t) {
                        return {row: i, column: n}
                    }
                }
            }

            createTable(t, e, i) {
                const n = t.createElement("table");
                XS(t, n, 0, e, i);
                return n
            }

            insertRows(t, e = {}) {
                const i = this.editor.model;
                const n = e.at || 0;
                const o = e.rows || 1;
                i.change(e => {
                    const i = t.getAttribute("headingRows") || 0;
                    if (i > n) {
                        e.setAttribute("headingRows", i + o, t)
                    }
                    if (n === 0 || n === t.childCount) {
                        XS(e, t, n, o, this.getColumns(t));
                        return
                    }
                    const r = new ZP(t, {endRow: n});
                    let s = 0;
                    for (const {row: t, rowspan: i, colspan: a, cell: c} of r) {
                        const r = t < n;
                        const l = t + i > n;
                        if (r && l) {
                            e.setAttribute("rowspan", i + o, c)
                        }
                        if (t === n) {
                            s += a
                        }
                    }
                    XS(e, t, n, o, s)
                })
            }

            insertColumns(t, e = {}) {
                const i = this.editor.model;
                const n = e.at || 0;
                const o = e.columns || 1;
                i.change(e => {
                    const i = t.getAttribute("headingColumns");
                    if (n < i) {
                        e.setAttribute("headingColumns", i + o, t)
                    }
                    const r = this.getColumns(t);
                    if (n === 0 || r === n) {
                        for (const i of t.getChildren()) {
                            ZS(o, e, e.createPositionAt(i, n ? "end" : 0))
                        }
                        return
                    }
                    const s = new ZP(t, {column: n, includeSpanned: true});
                    for (const {row: i, cell: r, cellIndex: a} of s) {
                        const c = parseInt(r.getAttribute("rowspan") || 1);
                        const l = parseInt(r.getAttribute("colspan") || 1);
                        if (r.index !== n && l > 1) {
                            e.setAttribute("colspan", l + o, r);
                            s.skipRow(i);
                            if (c > 1) {
                                for (let t = i + 1; t < i + c; t++) {
                                    s.skipRow(t)
                                }
                            }
                        } else {
                            const n = e.createPositionAt(t.getChild(i), a);
                            ZS(o, e, n)
                        }
                    }
                })
            }

            splitCellVertically(t, e = 2) {
                const i = this.editor.model;
                const n = t.parent;
                const o = n.parent;
                const r = parseInt(t.getAttribute("rowspan") || 1);
                const s = parseInt(t.getAttribute("colspan") || 1);
                i.change(i => {
                    if (s > 1) {
                        const {newCellsSpan: n, updatedSpan: o} = tE(s, e);
                        qP("colspan", o, t, i);
                        const a = {};
                        if (n > 1) {
                            a.colspan = n
                        }
                        if (r > 1) {
                            a.rowspan = r
                        }
                        const c = s > e ? e - 1 : s - 1;
                        ZS(c, i, i.createPositionAfter(t), a)
                    }
                    if (s < e) {
                        const n = e - s;
                        const a = [...new ZP(o)];
                        const {column: c} = a.find(({cell: e}) => e === t);
                        const l = a.filter(({cell: e, colspan: i, column: n}) => {
                            const o = e !== t && n === c;
                            const r = n < c && n + i > c;
                            return o || r
                        });
                        for (const {cell: t, colspan: e} of l) {
                            i.setAttribute("colspan", e + n, t)
                        }
                        const d = {};
                        if (r > 1) {
                            d.rowspan = r
                        }
                        ZS(n, i, i.createPositionAfter(t), d);
                        const u = o.getAttribute("headingColumns") || 0;
                        if (u > c) {
                            qP("headingColumns", u + n, o, i)
                        }
                    }
                })
            }

            splitCellHorizontally(t, e = 2) {
                const i = this.editor.model;
                const n = t.parent;
                const o = n.parent;
                const r = o.getChildIndex(n);
                const s = parseInt(t.getAttribute("rowspan") || 1);
                const a = parseInt(t.getAttribute("colspan") || 1);
                i.change(i => {
                    if (s > 1) {
                        const n = [...new ZP(o, {startRow: r, endRow: r + s - 1, includeSpanned: true})];
                        const {newCellsSpan: c, updatedSpan: l} = tE(s, e);
                        qP("rowspan", l, t, i);
                        const {column: d} = n.find(({cell: e}) => e === t);
                        const u = {};
                        if (c > 1) {
                            u.rowspan = c
                        }
                        if (a > 1) {
                            u.colspan = a
                        }
                        for (const {column: t, row: e, cellIndex: s} of n) {
                            const n = e >= r + l;
                            const a = t === d;
                            const h = (e + r + l) % c === 0;
                            if (n && a && h) {
                                const t = i.createPositionAt(o.getChild(e), s);
                                ZS(1, i, t, u)
                            }
                        }
                    }
                    if (s < e) {
                        const n = e - s;
                        const c = [...new ZP(o, {startRow: 0, endRow: r})];
                        for (const {cell: e, rowspan: o, row: s} of c) {
                            if (e !== t && s + o > r) {
                                const t = o + n;
                                i.setAttribute("rowspan", t, e)
                            }
                        }
                        const l = {};
                        if (a > 1) {
                            l.colspan = a
                        }
                        XS(i, o, r + 1, n, 1, l);
                        const d = o.getAttribute("headingRows") || 0;
                        if (d > r) {
                            qP("headingRows", d + n, o, i)
                        }
                    }
                })
            }

            getColumns(t) {
                const e = t.getChild(0);
                return [...e.getChildren()].reduce((t, e) => {
                    const i = parseInt(e.getAttribute("colspan") || 1);
                    return t + i
                }, 0)
            }

            getRows(t) {
                return t.childCount
            }
        }

        function XS(t, e, i, n, o, r = {}) {
            for (let s = 0; s < n; s++) {
                const n = t.createElement("tableRow");
                t.insert(n, e, i);
                ZS(o, t, t.createPositionAt(n, "end"), r)
            }
        }

        function ZS(t, e, i, n = {}) {
            for (let o = 0; o < t; o++) {
                UP(e, i, n)
            }
        }

        function tE(t, e) {
            if (t < e) {
                return {newCellsSpan: 1, updatedSpan: 1}
            }
            const i = Math.floor(t / e);
            const n = t - i * e + i;
            return {newCellsSpan: i, updatedSpan: n}
        }

        function eE(t) {
            t.document.registerPostFixer(e => iE(e, t))
        }

        function iE(t, e) {
            const i = e.document.differ.getChanges();
            let n = false;
            const o = new Set;
            for (const e of i) {
                let i;
                if (e.name == "table" && e.type == "insert") {
                    i = e.position.nodeAfter
                }
                if (e.name == "tableRow" || e.name == "tableCell") {
                    i = WP("table", e.position)
                }
                if (aE(e)) {
                    i = WP("table", e.range.start)
                }
                if (i && !o.has(i)) {
                    n = nE(i, t) || n;
                    n = oE(i, t) || n;
                    o.add(i)
                }
            }
            return n
        }

        function nE(t, e) {
            let i = false;
            const n = rE(t);
            if (n.length) {
                i = true;
                for (const t of n) {
                    qP("rowspan", t.rowspan, t.cell, e, 1)
                }
            }
            return i
        }

        function oE(t, e) {
            let i = false;
            const n = sE(t);
            const o = n[0];
            const r = Object.values(n).every(t => t === o);
            if (!r) {
                const o = Object.values(n).reduce((t, e) => e > t ? e : t, 0);
                for (const [r, s] of Object.entries(n)) {
                    const n = o - s;
                    if (n) {
                        for (let i = 0; i < n; i++) {
                            UP(e, e.createPositionAt(t.getChild(r), "end"))
                        }
                        i = true
                    }
                }
            }
            return i
        }

        function rE(t) {
            const e = parseInt(t.getAttribute("headingRows") || 0);
            const i = t.childCount;
            const n = [];
            for (const {row: o, rowspan: r, cell: s} of new ZP(t)) {
                if (r < 2) {
                    continue
                }
                const t = o < e;
                const a = t ? e : i;
                if (o + r > a) {
                    const t = a - o;
                    n.push({cell: s, rowspan: t})
                }
            }
            return n
        }

        function sE(t) {
            const e = {};
            for (const {row: i} of new ZP(t, {includeSpanned: true})) {
                if (!e[i]) {
                    e[i] = 0
                }
                e[i] += 1
            }
            return e
        }

        function aE(t) {
            const e = t.type === "attribute";
            const i = t.attributeKey;
            return e && (i === "headingRows" || i === "colspan" || i === "rowspan")
        }

        function cE(t) {
            t.document.registerPostFixer(e => lE(e, t))
        }

        function lE(t, e) {
            const i = e.document.differ.getChanges();
            let n = false;
            for (const e of i) {
                if (e.type == "insert" && e.name == "table") {
                    n = dE(e.position.nodeAfter, t) || n
                }
                if (e.type == "insert" && e.name == "tableRow") {
                    n = uE(e.position.nodeAfter, t) || n
                }
                if (e.type == "insert" && e.name == "tableCell") {
                    n = hE(e.position.nodeAfter, t) || n
                }
                if (fE(e)) {
                    n = hE(e.position.parent, t) || n
                }
            }
            return n
        }

        function dE(t, e) {
            let i = false;
            for (const n of t.getChildren()) {
                i = uE(n, e) || i
            }
            return i
        }

        function uE(t, e) {
            let i = false;
            for (const n of t.getChildren()) {
                i = hE(n, e) || i
            }
            return i
        }

        function hE(t, e) {
            if (t.childCount == 0) {
                e.insertElement("paragraph", t);
                return true
            }
            const i = Array.from(t.getChildren()).filter(t => t.is("text"));
            for (const t of i) {
                e.wrap(e.createRangeOn(t), "paragraph")
            }
            return !!i.length
        }

        function fE(t) {
            if (!t.position || !t.position.parent.is("tableCell")) {
                return false
            }
            return t.type == "insert" && t.name == "$text" || t.type == "remove"
        }

        function gE(t) {
            t.document.registerPostFixer(() => mE(t))
        }

        function mE(t) {
            const e = t.document.differ;
            const i = new Set;
            for (const t of e.getChanges()) {
                const e = t.type == "insert" || t.type == "remove" ? t.position.parent : t.range.start.parent;
                if (e.is("tableCell") && pE(e, t.type)) {
                    i.add(e)
                }
            }
            if (i.size) {
                for (const t of i.values()) {
                    e.refreshItem(t)
                }
                return true
            }
            return false
        }

        function pE(t, e) {
            const i = Array.from(t.getChildren()).some(t => t.is("paragraph"));
            if (!i) {
                return false
            }
            if (e == "attribute") {
                const e = Array.from(t.getChild(0).getAttributeKeys()).length;
                return t.childCount === 1 && e < 2
            }
            return t.childCount <= (e == "insert" ? 2 : 1)
        }

        var bE = i(92);

        class wE extends mp {
            static get pluginName() {
                return "TableEditing"
            }

            init() {
                const t = this.editor;
                const e = t.model;
                const i = e.schema;
                const n = t.conversion;
                i.register("table", {
                    allowWhere: "$block",
                    allowAttributes: ["headingRows", "headingColumns"],
                    isLimit: true,
                    isObject: true,
                    isBlock: true
                });
                i.register("tableRow", {allowIn: "table", isLimit: true});
                i.register("tableCell", {allowIn: "tableRow", allowAttributes: ["colspan", "rowspan"], isObject: true});
                i.extend("$block", {allowIn: "tableCell"});
                i.addChildCheck((t, e) => {
                    if (e.name == "table" && Array.from(t.getNames()).includes("table")) {
                        return false
                    }
                });
                n.for("upcast").add(JP());
                n.for("editingDowncast").add(lS({asWidget: true}));
                n.for("dataDowncast").add(lS());
                n.for("upcast").elementToElement({model: "tableRow", view: "tr"});
                n.for("editingDowncast").add(dS({asWidget: true}));
                n.for("dataDowncast").add(dS());
                n.for("downcast").add(gS());
                n.for("upcast").add(YP("td"));
                n.for("upcast").add(YP("th"));
                n.for("editingDowncast").add(uS({asWidget: true}));
                n.for("dataDowncast").add(uS());
                n.attributeToAttribute({model: "colspan", view: "colspan"});
                n.attributeToAttribute({model: "rowspan", view: "rowspan"});
                n.for("editingDowncast").add(fS({asWidget: true}));
                n.for("dataDowncast").add(fS());
                n.for("editingDowncast").add(hS({asWidget: true}));
                n.for("dataDowncast").add(hS());
                t.commands.add("insertTable", new SS(t));
                t.commands.add("insertTableRowAbove", new RS(t, {order: "above"}));
                t.commands.add("insertTableRowBelow", new RS(t, {order: "below"}));
                t.commands.add("insertTableColumnLeft", new OS(t, {order: "left"}));
                t.commands.add("insertTableColumnRight", new OS(t, {order: "right"}));
                t.commands.add("removeTableRow", new FS(t));
                t.commands.add("removeTableColumn", new WS(t));
                t.commands.add("splitTableCellVertically", new IS(t, {direction: "vertically"}));
                t.commands.add("splitTableCellHorizontally", new IS(t, {direction: "horizontally"}));
                t.commands.add("mergeTableCellRight", new VS(t, {direction: "right"}));
                t.commands.add("mergeTableCellLeft", new VS(t, {direction: "left"}));
                t.commands.add("mergeTableCellDown", new VS(t, {direction: "down"}));
                t.commands.add("mergeTableCellUp", new VS(t, {direction: "up"}));
                t.commands.add("setTableColumnHeader", new YS(t));
                t.commands.add("setTableRowHeader", new GS(t));
                eE(e);
                gE(e);
                cE(e);
                this.editor.keystrokes.set("Tab", (...t) => this._handleTabOnSelectedTable(...t), {priority: "low"});
                this.editor.keystrokes.set("Tab", this._getTabHandler(true), {priority: "low"});
                this.editor.keystrokes.set("Shift+Tab", this._getTabHandler(false), {priority: "low"})
            }

            static get requires() {
                return [QS]
            }

            _handleTabOnSelectedTable(t, e) {
                const i = this.editor;
                const n = i.model.document.selection;
                if (!n.isCollapsed && n.rangeCount === 1 && n.getFirstRange().isFlat) {
                    const t = n.getSelectedElement();
                    if (!t || !t.is("table")) {
                        return
                    }
                    e();
                    i.model.change(e => {
                        e.setSelection(e.createRangeIn(t.getChild(0).getChild(0)))
                    })
                }
            }

            _getTabHandler(t) {
                const e = this.editor;
                return (i, n) => {
                    const o = e.model.document.selection;
                    const r = rS(o)[0];
                    if (!r) {
                        return
                    }
                    n();
                    const s = r.parent;
                    const a = s.parent;
                    const c = a.getChildIndex(s);
                    const l = s.getChildIndex(r);
                    const d = l === 0;
                    if (!t && d && c === 0) {
                        return
                    }
                    const u = l === s.childCount - 1;
                    const h = c === a.childCount - 1;
                    if (t && h && u) {
                        e.execute("insertTableRowBelow");
                        if (c === a.childCount - 1) {
                            return
                        }
                    }
                    let f;
                    if (t && u) {
                        const t = a.getChild(c + 1);
                        f = t.getChild(0)
                    } else if (!t && d) {
                        const t = a.getChild(c - 1);
                        f = t.getChild(t.childCount - 1)
                    } else {
                        f = s.getChild(l + (t ? 1 : -1))
                    }
                    e.model.change(t => {
                        t.setSelection(t.createRangeIn(f))
                    })
                }
            }
        }

        var kE = i(94);

        class _E extends Gp {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                this.items = this.createCollection();
                this.set("rows", 0);
                this.set("columns", 0);
                this.bind("label").to(this, "columns", this, "rows", (t, e) => `${e}  ${t}`);
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck"]},
                    children: [{
                        tag: "div",
                        attributes: {class: ["ck-insert-table-dropdown__grid"]},
                        children: this.items
                    }, {
                        tag: "div",
                        attributes: {class: ["ck-insert-table-dropdown__label"]},
                        children: [{text: e.to("label")}]
                    }],
                    on: {
                        mousedown: e.to(t => {
                            t.preventDefault()
                        }), click: e.to(() => {
                            this.fire("execute")
                        })
                    }
                });
                for (let t = 0; t < 100; t++) {
                    const e = new vE;
                    e.on("over", () => {
                        const e = Math.floor(t / 10);
                        const i = t % 10;
                        this.set("rows", e + 1);
                        this.set("columns", i + 1)
                    });
                    this.items.add(e)
                }
                this.on("change:columns", () => {
                    this._highlightGridBoxes()
                });
                this.on("change:rows", () => {
                    this._highlightGridBoxes()
                })
            }

            focus() {
            }

            focusLast() {
            }

            _highlightGridBoxes() {
                const t = this.rows;
                const e = this.columns;
                this.items.map((i, n) => {
                    const o = Math.floor(n / 10);
                    const r = n % 10;
                    const s = o < t && r < e;
                    i.set("isOn", s)
                })
            }
        }

        class vE extends Gp {
            constructor(t) {
                super(t);
                const e = this.bindTemplate;
                this.set("isOn", false);
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck-insert-table-dropdown-grid-box", e.if("isOn", "ck-on")]},
                    on: {mouseover: e.to("over")}
                })
            }
        }

        var yE = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>';
        var xE = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>';
        var CE = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>';
        var AE = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';

        class TE extends mp {
            init() {
                const t = this.editor;
                const e = this.editor.t;
                const i = t.locale.contentLanguageDirection;
                const n = i === "ltr";
                t.ui.componentFactory.add("insertTable", i => {
                    const n = t.commands.get("insertTable");
                    const o = Wb(i);
                    o.bind("isEnabled").to(n);
                    o.buttonView.set({icon: yE, label: e("ki"), tooltip: true});
                    let r;
                    o.on("change:isOpen", () => {
                        if (r) {
                            return
                        }
                        r = new _E(i);
                        o.panelView.children.add(r);
                        r.delegate("execute").to(o);
                        o.buttonView.on("open", () => {
                            r.rows = 0;
                            r.columns = 0
                        });
                        o.on("execute", () => {
                            t.execute("insertTable", {rows: r.rows, columns: r.columns});
                            t.editing.view.focus()
                        })
                    });
                    return o
                });
                t.ui.componentFactory.add("tableColumn", t => {
                    const i = [{
                        type: "switchbutton",
                        model: {commandName: "setTableColumnHeader", label: e("kj"), bindIsOn: true}
                    }, {type: "separator"}, {
                        type: "button",
                        model: {commandName: n ? "insertTableColumnLeft" : "insertTableColumnRight", label: e("kk")}
                    }, {
                        type: "button",
                        model: {commandName: n ? "insertTableColumnRight" : "insertTableColumnLeft", label: e("kl")}
                    }, {type: "button", model: {commandName: "removeTableColumn", label: e("km")}}];
                    return this._prepareDropdown(e("kn"), xE, i, t)
                });
                t.ui.componentFactory.add("tableRow", t => {
                    const i = [{
                        type: "switchbutton",
                        model: {commandName: "setTableRowHeader", label: e("ko"), bindIsOn: true}
                    }, {type: "separator"}, {
                        type: "button",
                        model: {commandName: "insertTableRowBelow", label: e("kp")}
                    }, {type: "button", model: {commandName: "insertTableRowAbove", label: e("kq")}}, {
                        type: "button",
                        model: {commandName: "removeTableRow", label: e("kr")}
                    }];
                    return this._prepareDropdown(e("ks"), CE, i, t)
                });
                t.ui.componentFactory.add("mergeTableCells", t => {
                    const i = [{
                        type: "button",
                        model: {commandName: "mergeTableCellUp", label: e("kt")}
                    }, {
                        type: "button",
                        model: {commandName: n ? "mergeTableCellRight" : "mergeTableCellLeft", label: e("ku")}
                    }, {type: "button", model: {commandName: "mergeTableCellDown", label: e("kv")}}, {
                        type: "button",
                        model: {commandName: n ? "mergeTableCellLeft" : "mergeTableCellRight", label: e("kw")}
                    }, {type: "separator"}, {
                        type: "button",
                        model: {commandName: "splitTableCellVertically", label: e("kx")}
                    }, {type: "button", model: {commandName: "splitTableCellHorizontally", label: e("ky")}}];
                    return this._prepareDropdown(e("kz"), AE, i, t)
                })
            }

            _prepareDropdown(t, e, i, n) {
                const o = this.editor;
                const r = Wb(n);
                const s = [];
                const a = new ys;
                for (const t of i) {
                    PE(t, o, s, a)
                }
                Ub(r, a, o.ui.componentFactory);
                r.buttonView.set({label: t, icon: e, tooltip: true});
                r.bind("isEnabled").toMany(s, "isEnabled", (...t) => t.some(t => t));
                this.listenTo(r, "execute", t => {
                    o.execute(t.source.commandName);
                    o.editing.view.focus()
                });
                return r
            }
        }

        function PE(t, e, i, n) {
            const o = t.model = new e_(t.model);
            const {commandName: r, bindIsOn: s} = t.model;
            if (t.type === "button" || t.type === "switchbutton") {
                const t = e.commands.get(r);
                i.push(t);
                o.set({commandName: r});
                o.bind("isEnabled").to(t);
                if (s) {
                    o.bind("isOn").to(t, "value")
                }
            }
            o.set({withText: true});
            n.add(t)
        }

        class SE extends Ju {
            constructor(t) {
                super(t);
                this.domEventType = ["mousemove", "mouseup", "mouseleave"]
            }

            onDomEvent(t) {
                this.fire(t.type, t)
            }
        }

        function EE(t, e, i) {
            const n = Array.from(t);
            const o = n[0];
            const r = n[n.length - 1];
            const {row: s, column: a} = e.getCellLocation(o);
            const c = RE(n, a, i, e);
            const {row: l, column: d} = e.getCellLocation(r);
            const u = d - a + 1;
            const h = l - s + 1;
            IE(c, u, h, i, e);
            const f = WP("table", o);
            VE(c, f, s, a, i);
            return c
        }

        function RE(t, e, i, n) {
            const o = i.createElement("table");
            const r = new Map;
            const s = new Map;
            for (const e of t) {
                const t = WP("tableRow", e);
                if (!r.has(t)) {
                    const e = t._clone();
                    i.append(e, o);
                    r.set(t, e)
                }
                const a = e._clone(true);
                const {column: c} = n.getCellLocation(e);
                s.set(a, c);
                i.append(a, r.get(t))
            }
            OE(o, e, s, i, n);
            return o
        }

        function OE(t, e, i, n, o) {
            for (const r of t.getChildren()) {
                for (const t of Array.from(r.getChildren())) {
                    const {column: r} = o.getCellLocation(t);
                    const s = i.get(t);
                    const a = s - e;
                    if (r !== a) {
                        for (let e = 0; e < a - r; e++) {
                            const e = n.createElement("tableCell");
                            n.insert(e, n.createPositionBefore(t));
                            const i = n.createElement("paragraph");
                            n.insert(i, e, 0);
                            n.insertText("", i, 0)
                        }
                    }
                }
            }
        }

        function IE(t, e, i, n, o) {
            for (const r of t.getChildren()) {
                for (const t of r.getChildren()) {
                    const r = parseInt(t.getAttribute("colspan") || 1);
                    const s = parseInt(t.getAttribute("rowspan") || 1);
                    const {row: a, column: c} = o.getCellLocation(t);
                    if (c + r > e) {
                        const i = e - c;
                        if (i > 1) {
                            n.setAttribute("colspan", i, t)
                        } else {
                            n.removeAttribute("colspan", t)
                        }
                    }
                    if (a + s > i) {
                        const e = i - a;
                        if (e > 1) {
                            n.setAttribute("rowspan", e, t)
                        } else {
                            n.removeAttribute("rowspan", t)
                        }
                    }
                }
            }
        }

        function VE(t, e, i, n, o) {
            const r = parseInt(e.getAttribute("headingRows") || 0);
            if (r > 0) {
                const e = r - i;
                o.setAttribute("headingRows", e, t)
            }
            const s = parseInt(e.getAttribute("headingColumns") || 0);
            if (s > 0) {
                const e = s - n;
                o.setAttribute("headingColumns", e, t)
            }
        }

        var NE = i(96);

        class ME extends mp {
            static get pluginName() {
                return "TableSelection"
            }

            static get requires() {
                return [QS]
            }

            init() {
                const t = this.editor;
                const e = t.model;
                this.listenTo(e, "deleteContent", (t, e) => this._handleDeleteContent(t, e), {priority: "high"});
                t.editing.view.addObserver(SE);
                this._defineSelectionConverter();
                this._enableShiftClickSelection();
                this._enableMouseDragSelection()
            }

            getSelectedTableCells() {
                const t = this.editor.model.document.selection;
                const e = oS(t);
                if (e.length == 0) {
                    return null
                }
                return e
            }

            getSelectionAsFragment() {
                const t = this.getSelectedTableCells();
                if (!t) {
                    return null
                }
                return this.editor.model.change(e => {
                    const i = e.createDocumentFragment();
                    const n = EE(t, this.editor.plugins.get("TableUtils"), e);
                    e.insert(n, i, 0);
                    return i
                })
            }

            _defineSelectionConverter() {
                const t = this.editor;
                const e = new Set;
                t.conversion.for("editingDowncast").add(t => t.on("selection", (t, n, o) => {
                    const r = o.writer;
                    i(r);
                    const s = this.getSelectedTableCells();
                    if (!s) {
                        return
                    }
                    for (const t of s) {
                        const i = o.mapper.toViewElement(t);
                        r.addClass("ck-editor__editable_selected", i);
                        e.add(i)
                    }
                    const a = o.mapper.toViewElement(s[s.length - 1]);
                    r.setSelection(a, 0)
                }, {priority: "lowest"}));

                function i(t) {
                    for (const i of e) {
                        t.removeClass("ck-editor__editable_selected", i)
                    }
                    e.clear()
                }
            }

            _enableShiftClickSelection() {
                const t = this.editor;
                let e = false;
                this.listenTo(t.editing.view.document, "mousedown", (i, n) => {
                    if (!this.isEnabled) {
                        return
                    }
                    if (!n.domEvent.shiftKey) {
                        return
                    }
                    const o = rS(t.model.document.selection)[0];
                    if (!o) {
                        return
                    }
                    const r = this._getModelTableCellFromDomEvent(n);
                    if (r && zE(o, r)) {
                        e = true;
                        this._setCellSelection(o, r);
                        n.preventDefault()
                    }
                });
                this.listenTo(t.editing.view.document, "mouseup", () => {
                    e = false
                });
                this.listenTo(t.editing.view.document, "selectionChange", t => {
                    if (e) {
                        t.stop()
                    }
                }, {priority: "highest"})
            }

            _enableMouseDragSelection() {
                const t = this.editor;
                let e, i;
                let n = false;
                let o = false;
                this.listenTo(t.editing.view.document, "mousedown", (t, i) => {
                    if (!this.isEnabled) {
                        return
                    }
                    if (i.domEvent.shiftKey || i.domEvent.ctrlKey || i.domEvent.altKey) {
                        return
                    }
                    e = this._getModelTableCellFromDomEvent(i)
                });
                this.listenTo(t.editing.view.document, "mousemove", (t, r) => {
                    if (!r.domEvent.buttons) {
                        return
                    }
                    if (!e) {
                        return
                    }
                    const s = this._getModelTableCellFromDomEvent(r);
                    if (s && zE(e, s)) {
                        i = s;
                        if (!n && i != e) {
                            n = true
                        }
                    }
                    if (!n) {
                        return
                    }
                    o = true;
                    this._setCellSelection(e, i);
                    r.preventDefault()
                });
                this.listenTo(t.editing.view.document, "mouseup", () => {
                    n = false;
                    o = false;
                    e = null;
                    i = null
                });
                this.listenTo(t.editing.view.document, "selectionChange", t => {
                    if (o) {
                        t.stop()
                    }
                }, {priority: "highest"})
            }

            _handleDeleteContent(t, e) {
                const [i, n] = e;
                const o = this.editor.model;
                const r = !n || n.direction == "backward";
                const s = oS(i);
                if (!s.length) {
                    return
                }
                t.stop();
                o.change(t => {
                    const e = s[r ? s.length - 1 : 0];
                    o.change(t => {
                        for (const e of s) {
                            o.deleteContent(t.createSelection(e, "in"))
                        }
                    });
                    const n = o.schema.getNearestSelectionRange(t.createPositionAt(e, 0));
                    if (n) {
                        if (i.is("documentSelection")) {
                            t.setSelection(n)
                        } else {
                            i.setTo(n)
                        }
                    }
                })
            }

            _setCellSelection(t, e) {
                const i = this._getCellsToSelect(t, e);
                this.editor.model.change(t => {
                    t.setSelection(i.cells.map(e => t.createRangeOn(e)), {backward: i.backward})
                })
            }

            _getModelTableCellFromDomEvent(t) {
                const e = t.target;
                const i = this.editor.editing.view.createPositionAt(e, 0);
                const n = this.editor.editing.mapper.toModelPosition(i);
                const o = n.parent;
                if (!o) {
                    return
                }
                if (o.is("tableCell")) {
                    return o
                }
                return WP("tableCell", o)
            }

            _getCellsToSelect(t, e) {
                const i = this.editor.plugins.get("TableUtils");
                const n = i.getCellLocation(t);
                const o = i.getCellLocation(e);
                const r = Math.min(n.row, o.row);
                const s = Math.max(n.row, o.row);
                const a = Math.min(n.column, o.column);
                const c = Math.max(n.column, o.column);
                const l = [];
                for (const e of new ZP(WP("table", t), {startRow: r, endRow: s})) {
                    if (e.column >= a && e.column <= c) {
                        l.push(e.cell)
                    }
                }
                if (BE(n, o)) {
                    return {cells: l.reverse(), backward: true}
                }
                return {cells: l, backward: false}
            }
        }

        function BE(t, e) {
            if (t.row > e.row) {
                return true
            }
            if (t.row == e.row && t.column > e.column) {
                return true
            }
            return false
        }

        function zE(t, e) {
            return t.parent.parent == e.parent.parent
        }

        class LE extends mp {
            static get pluginName() {
                return "TableClipboard"
            }

            static get requires() {
                return [ME]
            }

            init() {
                const t = this.editor;
                const e = t.editing.view.document;
                this.listenTo(e, "copy", (t, e) => this._onCopyCut(t, e));
                this.listenTo(e, "cut", (t, e) => this._onCopyCut(t, e))
            }

            _onCopyCut(t, e) {
                const i = this.editor.plugins.get("TableSelection");
                if (!i.getSelectedTableCells()) {
                    return
                }
                if (t.name == "cut" && this.editor.isReadOnly) {
                    return
                }
                e.preventDefault();
                t.stop();
                const n = this.editor.data;
                const o = this.editor.editing.view.document;
                const r = n.toView(i.getSelectionAsFragment());
                o.fire("clipboardOutput", {dataTransfer: e.dataTransfer, content: r, method: t.name})
            }
        }

        var FE = i(98);

        class DE extends mp {
            static get requires() {
                return [wE, TE, ME, LE, Fv]
            }

            static get pluginName() {
                return "Table"
            }
        }

        var jE = i(100);

        class HE extends Gp {
            constructor(t, e) {
                super(t);
                const i = `ck-labeled-view-${is()}`;
                const n = `ck-labeled-view-status-${is()}`;
                this.view = e(this, i, n);
                this.set("label");
                this.set("isEnabled", true);
                this.set("errorText", null);
                this.set("infoText", null);
                this.set("class");
                this.labelView = this._createLabelView(i);
                this.statusView = this._createStatusView(n);
                this.bind("_statusText").to(this, "errorText", this, "infoText", (t, e) => t || e);
                const o = this.bindTemplate;
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-labeled-view", o.to("class"), o.if("isEnabled", "ck-disabled", t => !t)]},
                    children: [this.labelView, this.view, this.statusView]
                })
            }

            _createLabelView(t) {
                const e = new Mk(this.locale);
                e.for = t;
                e.bind("text").to(this, "label");
                return e
            }

            _createStatusView(t) {
                const e = new Gp(this.locale);
                const i = this.bindTemplate;
                e.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-labeled-view__status", i.if("errorText", "ck-labeled-view__status_error"), i.if("_statusText", "ck-hidden", t => !t)],
                        id: t,
                        role: i.if("errorText", "alert")
                    },
                    children: [{text: i.to("_statusText")}]
                });
                return e
            }

            focus() {
                this.view.focus()
            }
        }

        function WE(t, e, i) {
            const n = new Yv(t.locale);
            n.set({id: e, ariaDescribedById: i});
            n.bind("isReadOnly").to(t, "isEnabled", t => !t);
            n.bind("hasError").to(t, "errorText", t => !!t);
            n.on("input", () => {
                t.errorText = null
            });
            return n
        }

        function qE(t, e, i) {
            const n = Wb(t.locale);
            n.set({id: e, ariaDescribedById: i});
            n.bind("isEnabled").to(t);
            return n
        }

        var UE = i(102);

        class $E extends Gp {
            constructor(t, e) {
                super(t);
                const i = this.bindTemplate;
                this.set("value", "");
                this.set("id");
                this.set("isReadOnly", false);
                this.set("hasError", false);
                this.set("ariaDescribedById");
                this.options = e;
                this._dropdownView = this._createDropdownView(t);
                this._inputView = this._createInputTextView(t);
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-input-color", i.if("hasError", "ck-error")],
                        id: i.to("id"),
                        "aria-invalid": i.if("hasError", true),
                        "aria-describedby": i.to("ariaDescribedById")
                    },
                    children: [this._inputView, this._dropdownView]
                })
            }

            focus() {
                this._inputView.focus()
            }

            _createDropdownView() {
                const t = this.locale;
                const e = this.bindTemplate;
                const i = this._createColorGrid(t);
                const n = Wb(t);
                const o = new Gp;
                const r = this._createRemoveColorButton(t);
                o.setTemplate({
                    tag: "span",
                    attributes: {
                        class: ["ck", "ck-input-color__button__preview"],
                        style: {backgroundColor: e.to("value")}
                    },
                    children: [{
                        tag: "span",
                        attributes: {class: ["ck", "ck-input-color__button__preview__no-color-indicator", e.if("value", "ck-hidden", t => t != "")]}
                    }]
                });
                n.buttonView.extendTemplate({attributes: {class: "ck-input-color__button"}});
                n.buttonView.children.add(o);
                n.panelPosition = t.uiLanguageDirection === "rtl" ? "se" : "sw";
                n.panelView.children.add(r);
                n.panelView.children.add(i);
                n.bind("isEnabled").to(this, "isReadOnly", t => !t);
                return n
            }

            _createInputTextView() {
                const t = this.locale;
                const e = new Yv(t);
                e.bind("value").to(this);
                e.bind("isReadOnly").to(this);
                e.bind("hasError").to(this);
                e.on("input", () => {
                    this.value = e.element.value
                });
                e.delegate("input").to(this);
                return e
            }

            _createRemoveColorButton() {
                const t = this.locale;
                const e = t.t;
                const i = new hb(t);
                i.class = "ck-input-color__remove-color";
                i.withText = true;
                i.icon = zk;
                i.label = e("li");
                i.on("execute", () => {
                    this.value = "";
                    this._dropdownView.isOpen = false;
                    this.fire("input")
                });
                return i
            }

            _createColorGrid(t) {
                const e = new Vk(t, {colorDefinitions: this.options.colorDefinitions, columns: this.options.columns});
                e.on("execute", (t, e) => {
                    this.value = e.value;
                    this._dropdownView.isOpen = false;
                    this.fire("input")
                });
                e.bind("selectedColor").to(this, "value");
                return e
            }
        }

        const GE = nb.defaultPositions;
        const KE = [GE.northArrowSouth, GE.northArrowSouthWest, GE.northArrowSouthEast, GE.southArrowNorth, GE.southArrowNorthWest, GE.southArrowNorthEast];
        const JE = t => t === "";

        function YE(t, e) {
            const i = t.plugins.get("ContextualBalloon");
            if (nS(t.editing.view.document.selection)) {
                let n;
                if (e === "cell") {
                    n = XE(t)
                } else {
                    n = QE(t)
                }
                i.updatePosition(n)
            }
        }

        function QE(t) {
            const e = t.model.document.selection.getFirstPosition();
            const i = WP("table", e);
            const n = t.editing.mapper.toViewElement(i);
            return {target: t.editing.view.domConverter.viewToDom(n), positions: KE}
        }

        function XE(t) {
            const e = uR(t.model.document.selection.getFirstPosition());
            const i = t.editing.mapper.toViewElement(e);
            return {target: t.editing.view.domConverter.viewToDom(i), positions: KE}
        }

        function ZE(t) {
            return {
                none: t("mq"),
                solid: t("mr"),
                dotted: t("ms"),
                dashed: t("mt"),
                double: t("mu"),
                groove: t("mv"),
                ridge: t("mw"),
                inset: t("mx"),
                outset: t("my")
            }
        }

        function tR(t) {
            return t("mz")
        }

        function eR(t) {
            return t("na")
        }

        function iR(t) {
            t = t.trim();
            return JE(t) || tC(t)
        }

        function nR(t) {
            t = t.trim();
            return JE(t) || lR(t) || oC(t) || sC(t)
        }

        function oR(t) {
            t = t.trim();
            return JE(t) || lR(t) || oC(t)
        }

        function rR(t) {
            const e = new ys;
            const i = ZE(t.t);
            for (const n in i) {
                const o = {
                    type: "button",
                    model: new e_({_borderStyleValue: n === "none" ? "" : n, label: i[n], withText: true})
                };
                if (n === "none") {
                    o.model.bind("isOn").to(t, "borderStyle", t => !t)
                } else {
                    o.model.bind("isOn").to(t, "borderStyle", t => t === n)
                }
                e.add(o)
            }
            return e
        }

        function sR({view: t, icons: e, toolbar: i, labels: n, propertyName: o, nameToValue: r}) {
            for (const s in n) {
                const a = new hb(t.locale);
                a.set({label: n[s], icon: e[s]});
                a.bind("isOn").to(t, o, t => t === r(s));
                a.on("execute", () => {
                    t[o] = r(s)
                });
                i.items.add(a)
            }
        }

        const aR = [{color: "hsl(0, 0%, 0%)", label: "Black"}, {
            color: "hsl(0, 0%, 30%)",
            label: "Dim grey"
        }, {color: "hsl(0, 0%, 60%)", label: "Grey"}, {
            color: "hsl(0, 0%, 90%)",
            label: "Light grey"
        }, {color: "hsl(0, 0%, 100%)", label: "White", hasBorder: true}, {
            color: "hsl(0, 75%, 60%)",
            label: "Red"
        }, {color: "hsl(30, 75%, 60%)", label: "Orange"}, {
            color: "hsl(60, 75%, 60%)",
            label: "Yellow"
        }, {color: "hsl(90, 75%, 60%)", label: "Light green"}, {
            color: "hsl(120, 75%, 60%)",
            label: "Green"
        }, {color: "hsl(150, 75%, 60%)", label: "Aquamarine"}, {
            color: "hsl(180, 75%, 60%)",
            label: "Turquoise"
        }, {color: "hsl(210, 75%, 60%)", label: "Light blue"}, {
            color: "hsl(240, 75%, 60%)",
            label: "Blue"
        }, {color: "hsl(270, 75%, 60%)", label: "Purple"}];

        function cR(t) {
            return (e, i, n) => {
                const o = new $E(e.locale, {colorDefinitions: dR(t.colorConfig), columns: t.columns});
                o.set({id: i, ariaDescribedById: n});
                o.bind("isReadOnly").to(e, "isEnabled", t => !t);
                o.bind("errorText").to(e);
                o.on("input", () => {
                    e.errorText = null
                });
                return o
            }
        }

        function lR(t) {
            const e = parseFloat(t);
            return !Number.isNaN(e) && t === String(e)
        }

        function dR(t) {
            return t.map(t => ({color: t.model, label: t.label, options: {hasBorder: t.hasBorder}}))
        }

        function uR(t) {
            const e = t.nodeAfter && t.nodeAfter.is("tableCell");
            return e ? t.nodeAfter : WP("tableCell", t)
        }

        var hR = i(104);

        class fR extends Gp {
            constructor(t, e = {}) {
                super(t);
                const i = this.bindTemplate;
                this.set("class", e.class || null);
                this.children = this.createCollection();
                if (e.children) {
                    e.children.forEach(t => this.children.add(t))
                }
                this.set("_role", null);
                this.set("_ariaLabelledBy", null);
                if (e.labelView) {
                    this.set({_role: "group", _ariaLabelledBy: e.labelView.id})
                }
                this.setTemplate({
                    tag: "div",
                    attributes: {
                        class: ["ck", "ck-form__row", i.to("class")],
                        role: i.to("_role"),
                        "aria-labelledby": i.to("_ariaLabelledBy")
                    },
                    children: this.children
                })
            }
        }

        var gR = i(106);

        class mR extends Gp {
            constructor(t, e = {}) {
                super(t);
                const i = this.bindTemplate;
                this.children = this.createCollection();
                this.set("class", e.class || null);
                this.set("label", e.label || "");
                const n = new Gp(t);
                n.setTemplate({
                    tag: "span",
                    attributes: {class: ["ck", "ck-form__header__label"]},
                    children: [{text: i.to("label")}]
                });
                this.children.add(n);
                this.setTemplate({
                    tag: "div",
                    attributes: {class: ["ck", "ck-form__header", i.to("class")]},
                    children: this.children
                })
            }
        }

        var pR = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.261 7.062l2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>';
        var bR = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>';
        var wR = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.239 13.938l-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>';
        var kR = i(12);
        var _R = i(13);
        var vR = i(110);
        const yR = {left: Zw, center: ek, right: tk, justify: ik, top: pR, middle: bR, bottom: wR};

        class xR extends Gp {
            constructor(t, e) {
                super(t);
                this.set({
                    borderStyle: "",
                    borderWidth: "",
                    borderColor: "",
                    padding: "",
                    backgroundColor: "",
                    width: "",
                    height: "",
                    horizontalAlignment: "",
                    verticalAlignment: ""
                });
                this.options = e;
                const {borderStyleDropdown: i, borderWidthInput: n, borderColorInput: o, borderRowLabel: r} = this._createBorderFields();
                const {widthInput: s, operatorLabel: a, heightInput: c, dimensionsLabel: l} = this._createDimensionFields();
                const {horizontalAlignmentToolbar: d, verticalAlignmentToolbar: u, alignmentLabel: h} = this._createAlignmentFields();
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.children = this.createCollection();
                this.borderStyleDropdown = i;
                this.borderWidthInput = n;
                this.borderColorInput = o;
                this.backgroundInput = this._createBackgroundField();
                this.paddingInput = this._createPaddingField();
                this.widthInput = s;
                this.heightInput = c;
                this.horizontalAlignmentToolbar = d;
                this.verticalAlignmentToolbar = u;
                const {saveButtonView: f, cancelButtonView: g} = this._createActionButtons();
                this.saveButtonView = f;
                this.cancelButtonView = g;
                this._focusables = new bp;
                this._focusCycler = new yb({
                    focusables: this._focusables,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "shift + tab", focusNext: "tab"}
                });
                this.children.add(new mR(t, {label: this.t(" ")}));
                this.children.add(new fR(t, {
                    labelView: r,
                    children: [r, i, o, n],
                    class: "ck-table-form__border-row"
                }));
                this.children.add(new fR(t, {children: [this.backgroundInput]}));
                this.children.add(new fR(t, {
                    children: [new fR(t, {
                        labelView: l,
                        children: [l, s, a, c],
                        class: "ck-table-form__dimensions-row"
                    }), new fR(t, {children: [this.paddingInput], class: "ck-table-cell-properties-form__padding-row"})]
                }));
                this.children.add(new fR(t, {
                    labelView: h,
                    children: [h, d, u],
                    class: "ck-table-cell-properties-form__alignment-row"
                }));
                this.children.add(new fR(t, {
                    children: [this.saveButtonView, this.cancelButtonView],
                    class: "ck-table-form__action-row"
                }));
                this.setTemplate({
                    tag: "form",
                    attributes: {
                        class: ["ck", "ck-form", "ck-table-form", "ck-table-cell-properties-form"],
                        tabindex: "-1"
                    },
                    children: this.children
                })
            }

            render() {
                super.render();
                Qv({view: this});
                [this.borderStyleDropdown, this.borderColorInput, this.borderWidthInput, this.backgroundInput, this.widthInput, this.heightInput, this.paddingInput, this.horizontalAlignmentToolbar, this.verticalAlignmentToolbar, this.saveButtonView, this.cancelButtonView].forEach(t => {
                    this._focusables.add(t);
                    this.focusTracker.add(t.element)
                });
                this.keystrokes.listenTo(this.element)
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            _createBorderFields() {
                const t = cR({colorConfig: this.options.borderColors, columns: 5});
                const e = this.locale;
                const i = this.t;
                const n = new Mk(e);
                n.text = i("nb");
                const o = ZE(i);
                const r = new HE(e, qE);
                r.set({label: i("nc"), class: "ck-table-form__border-style"});
                r.view.buttonView.set({isOn: false, withText: true, tooltip: i("nc")});
                r.view.buttonView.bind("label").to(this, "borderStyle", t => o[t ? t : "none"]);
                r.view.on("execute", t => {
                    this.borderStyle = t.source._borderStyleValue
                });
                Ub(r.view, rR(this));
                const s = new HE(e, WE);
                s.set({label: i("nd"), class: "ck-table-form__border-width"});
                s.view.bind("value").to(this, "borderWidth");
                s.bind("isEnabled").to(this, "borderStyle", CR);
                s.view.on("input", () => {
                    this.borderWidth = s.view.element.value
                });
                const a = new HE(e, t);
                a.set({label: i("ne"), class: "ck-table-form__border-color"});
                a.view.bind("value").to(this, "borderColor");
                a.bind("isEnabled").to(this, "borderStyle", CR);
                a.view.on("input", () => {
                    this.borderColor = a.view.value
                });
                this.on("change:borderStyle", (t, e, i) => {
                    if (!CR(i)) {
                        this.borderColor = "";
                        this.borderWidth = ""
                    }
                });
                return {borderRowLabel: n, borderStyleDropdown: r, borderColorInput: a, borderWidthInput: s}
            }

            _createBackgroundField() {
                const t = this.locale;
                const e = this.t;
                const i = cR({colorConfig: this.options.backgroundColors, columns: 5});
                const n = new HE(t, i);
                n.set({label: e("nf"), class: "ck-table-cell-properties-form__background"});
                n.view.bind("value").to(this, "backgroundColor");
                n.view.on("input", () => {
                    this.backgroundColor = n.view.value
                });
                return n
            }

            _createDimensionFields() {
                const t = this.locale;
                const e = this.t;
                const i = new Mk(t);
                i.text = e("ng");
                const n = new HE(t, WE);
                n.set({label: e("nd"), class: "ck-table-form__dimensions-row__width"});
                n.view.bind("value").to(this, "width");
                n.view.on("input", () => {
                    this.width = n.view.element.value
                });
                const o = new Gp(t);
                o.setTemplate({
                    tag: "span",
                    attributes: {class: ["ck-table-form__dimension-operator"]},
                    children: [{text: ""}]
                });
                const r = new HE(t, WE);
                r.set({label: e("nh"), class: "ck-table-form__dimensions-row__height"});
                r.view.bind("value").to(this, "height");
                r.view.on("input", () => {
                    this.height = r.view.element.value
                });
                return {dimensionsLabel: i, widthInput: n, operatorLabel: o, heightInput: r}
            }

            _createPaddingField() {
                const t = this.locale;
                const e = this.t;
                const i = new HE(t, WE);
                i.set({label: e("ni"), class: "ck-table-cell-properties-form__padding"});
                i.view.bind("value").to(this, "padding");
                i.view.on("input", () => {
                    this.padding = i.view.element.value
                });
                return i
            }

            _createAlignmentFields() {
                const t = this.locale;
                const e = this.t;
                const i = new Mk(t);
                i.text = e("nj");
                const n = new Xb(t);
                const o = this.locale.contentLanguageDirection === "rtl";
                n.set({isCompact: true, ariaLabel: e("nk")});
                sR({
                    view: this,
                    icons: yR,
                    toolbar: n,
                    labels: this._horizontalAlignmentLabels,
                    propertyName: "horizontalAlignment",
                    nameToValue: t => t === (o ? "right" : "left") ? "" : t
                });
                const r = new Xb(t);
                r.set({isCompact: true, ariaLabel: e("nl")});
                sR({
                    view: this,
                    icons: yR,
                    toolbar: r,
                    labels: this._verticalAlignmentLabels,
                    propertyName: "verticalAlignment",
                    nameToValue: t => t === "middle" ? "" : t
                });
                return {horizontalAlignmentToolbar: n, verticalAlignmentToolbar: r, alignmentLabel: i}
            }

            _createActionButtons() {
                const t = this.locale;
                const e = this.t;
                const i = new hb(t);
                const n = new hb(t);
                const o = [this.borderWidthInput, this.borderColorInput, this.backgroundInput, this.paddingInput];
                i.set({label: e("lo"), icon: Xv, class: "ck-button-save", type: "submit", withText: true});
                i.bind("isEnabled").toMany(o, "errorText", (...t) => t.every(t => !t));
                n.set({label: e("lp"), icon: Zv, class: "ck-button-cancel", type: "cancel", withText: true});
                n.delegate("execute").to(this, "cancel");
                return {saveButtonView: i, cancelButtonView: n}
            }

            get _horizontalAlignmentLabels() {
                const t = this.locale;
                const e = this.t;
                const i = e("nm");
                const n = e("nn");
                const o = e("no");
                const r = e("np");
                if (t.uiLanguageDirection === "rtl") {
                    return {right: o, center: n, left: i, justify: r}
                } else {
                    return {left: i, center: n, right: o, justify: r}
                }
            }

            get _verticalAlignmentLabels() {
                const t = this.t;
                return {top: t("nq"), middle: t("nr"), bottom: t("ns")}
            }
        }

        function CR(t) {
            return !!t
        }

        var AR = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.105 18l-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="M15.5 11.5l1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';
        const TR = 500;

        class PR extends mp {
            static get requires() {
                return [kb]
            }

            static get pluginName() {
                return "TableCellPropertiesUI"
            }

            constructor(t) {
                super(t);
                t.config.define("table.tableCellProperties", {borderColors: aR, backgroundColors: aR})
            }

            init() {
                const t = this.editor;
                const e = t.t;
                this._balloon = t.plugins.get(kb);
                this.view = this._createPropertiesView();
                this._undoStepBatch = null;
                t.ui.componentFactory.add("tableCellProperties", t => {
                    const i = new hb(t);
                    i.set({label: e("kh"), icon: AR, tooltip: true});
                    this.listenTo(i, "execute", () => this._showView());
                    return i
                })
            }

            destroy() {
                super.destroy();
                this.view.destroy()
            }

            _createPropertiesView() {
                const t = this.editor;
                const e = t.editing.view.document;
                const i = t.config.get("table.tableCellProperties");
                const n = __(i.borderColors);
                const o = k_(t.locale, n);
                const r = __(i.backgroundColors);
                const s = k_(t.locale, r);
                const a = new xR(t.locale, {borderColors: o, backgroundColors: s});
                const c = t.t;
                a.render();
                this.listenTo(a, "submit", () => {
                    this._hideView()
                });
                this.listenTo(a, "cancel", () => {
                    if (this._undoStepBatch.operations.length) {
                        t.execute("undo", this._undoStepBatch)
                    }
                    this._hideView()
                });
                a.keystrokes.set("Esc", (t, e) => {
                    this._hideView();
                    e()
                });
                this.listenTo(t.ui, "update", () => {
                    if (!nS(e.selection)) {
                        this._hideView()
                    } else if (this._isViewVisible) {
                        YE(t, "cell")
                    }
                });
                Db({
                    emitter: a,
                    activator: () => this._isViewInBalloon,
                    contextElements: [this._balloon.view.element],
                    callback: () => this._hideView()
                });
                const l = tR(c);
                const d = eR(c);
                a.on("change:borderStyle", this._getPropertyChangeCallback("tableCellBorderStyle"));
                a.on("change:borderColor", this._getValidatedPropertyChangeCallback({
                    viewField: a.borderColorInput,
                    commandName: "tableCellBorderColor",
                    errorText: l,
                    validator: iR
                }));
                a.on("change:borderWidth", this._getValidatedPropertyChangeCallback({
                    viewField: a.borderWidthInput,
                    commandName: "tableCellBorderWidth",
                    errorText: d,
                    validator: oR
                }));
                a.on("change:padding", this._getValidatedPropertyChangeCallback({
                    viewField: a.paddingInput,
                    commandName: "tableCellPadding",
                    errorText: d,
                    validator: nR
                }));
                a.on("change:width", this._getValidatedPropertyChangeCallback({
                    viewField: a.widthInput,
                    commandName: "tableCellWidth",
                    errorText: d,
                    validator: nR
                }));
                a.on("change:height", this._getValidatedPropertyChangeCallback({
                    viewField: a.heightInput,
                    commandName: "tableCellHeight",
                    errorText: d,
                    validator: nR
                }));
                a.on("change:backgroundColor", this._getValidatedPropertyChangeCallback({
                    viewField: a.backgroundInput,
                    commandName: "tableCellBackgroundColor",
                    errorText: l,
                    validator: iR
                }));
                a.on("change:horizontalAlignment", this._getPropertyChangeCallback("tableCellHorizontalAlignment"));
                a.on("change:verticalAlignment", this._getPropertyChangeCallback("tableCellVerticalAlignment"));
                return a
            }

            _fillViewFormFromCommandValues() {
                const t = this.editor.commands;
                this.view.set({
                    borderStyle: t.get("tableCellBorderStyle").value || "",
                    borderColor: t.get("tableCellBorderColor").value || "",
                    borderWidth: t.get("tableCellBorderWidth").value || "",
                    width: t.get("tableCellWidth").value || "",
                    height: t.get("tableCellHeight").value || "",
                    padding: t.get("tableCellPadding").value || "",
                    backgroundColor: t.get("tableCellBackgroundColor").value || "",
                    horizontalAlignment: t.get("tableCellHorizontalAlignment").value || "",
                    verticalAlignment: t.get("tableCellVerticalAlignment").value || ""
                })
            }

            _showView() {
                const t = this.editor;
                this._balloon.add({view: this.view, position: XE(t)});
                this._undoStepBatch = t.model.createBatch();
                this._fillViewFormFromCommandValues();
                this.view.focus()
            }

            _hideView() {
                if (!this._isViewInBalloon) {
                    return
                }
                const t = this.editor;
                this.stopListening(t.ui, "update");
                this.view.saveButtonView.focus();
                this._balloon.remove(this.view);
                this.editor.editing.view.focus()
            }

            get _isViewVisible() {
                return this._balloon.visibleView === this.view
            }

            get _isViewInBalloon() {
                return this._balloon.hasView(this.view)
            }

            _getPropertyChangeCallback(t) {
                return (e, i, n) => {
                    this.editor.execute(t, {value: n, batch: this._undoStepBatch})
                }
            }

            _getValidatedPropertyChangeCallback({commandName: t, viewField: e, validator: i, errorText: n}) {
                const o = uh(() => {
                    e.errorText = n
                }, TR);
                return (n, r, s) => {
                    o.cancel();
                    if (i(s)) {
                        this.editor.execute(t, {value: s, batch: this._undoStepBatch});
                        e.errorText = null
                    } else {
                        o()
                    }
                }
            }
        }

        function SR(t) {
            t.setNormalizer("border", ER);
            t.setNormalizer("border-top", RR("top"));
            t.setNormalizer("border-right", RR("right"));
            t.setNormalizer("border-bottom", RR("bottom"));
            t.setNormalizer("border-left", RR("left"));
            t.setNormalizer("border-color", OR("color"));
            t.setNormalizer("border-width", OR("width"));
            t.setNormalizer("border-style", OR("style"));
            t.setNormalizer("border-top-color", VR("color", "top"));
            t.setNormalizer("border-top-style", VR("style", "top"));
            t.setNormalizer("border-top-width", VR("width", "top"));
            t.setNormalizer("border-right-color", VR("color", "right"));
            t.setNormalizer("border-right-style", VR("style", "right"));
            t.setNormalizer("border-right-width", VR("width", "right"));
            t.setNormalizer("border-bottom-color", VR("color", "bottom"));
            t.setNormalizer("border-bottom-style", VR("style", "bottom"));
            t.setNormalizer("border-bottom-width", VR("width", "bottom"));
            t.setNormalizer("border-left-color", VR("color", "left"));
            t.setNormalizer("border-left-style", VR("style", "left"));
            t.setNormalizer("border-left-width", VR("width", "left"));
            t.setExtractor("border-top", NR("top"));
            t.setExtractor("border-right", NR("right"));
            t.setExtractor("border-bottom", NR("bottom"));
            t.setExtractor("border-left", NR("left"));
            t.setExtractor("border-top-color", "border.color.top");
            t.setExtractor("border-right-color", "border.color.right");
            t.setExtractor("border-bottom-color", "border.color.bottom");
            t.setExtractor("border-left-color", "border.color.left");
            t.setExtractor("border-top-width", "border.width.top");
            t.setExtractor("border-right-width", "border.width.right");
            t.setExtractor("border-bottom-width", "border.width.bottom");
            t.setExtractor("border-left-width", "border.width.left");
            t.setExtractor("border-top-style", "border.style.top");
            t.setExtractor("border-right-style", "border.style.right");
            t.setExtractor("border-bottom-style", "border.style.bottom");
            t.setExtractor("border-left-style", "border.style.left");
            t.setReducer("border-color", pC("border-color"));
            t.setReducer("border-style", pC("border-style"));
            t.setReducer("border-width", pC("border-width"));
            t.setReducer("border-top", LR("top"));
            t.setReducer("border-right", LR("right"));
            t.setReducer("border-bottom", LR("bottom"));
            t.setReducer("border-left", LR("left"));
            t.setReducer("border", zR);
            t.setStyleRelation("border", ["border-color", "border-style", "border-width", "border-top", "border-right", "border-bottom", "border-left", "border-top-color", "border-right-color", "border-bottom-color", "border-left-color", "border-top-style", "border-right-style", "border-bottom-style", "border-left-style", "border-top-width", "border-right-width", "border-bottom-width", "border-left-width"]);
            t.setStyleRelation("border-color", ["border-top-color", "border-right-color", "border-bottom-color", "border-left-color"]);
            t.setStyleRelation("border-style", ["border-top-style", "border-right-style", "border-bottom-style", "border-left-style"]);
            t.setStyleRelation("border-width", ["border-top-width", "border-right-width", "border-bottom-width", "border-left-width"]);
            t.setStyleRelation("border-top", ["border-top-color", "border-top-style", "border-top-width"]);
            t.setStyleRelation("border-right", ["border-right-color", "border-right-style", "border-right-width"]);
            t.setStyleRelation("border-bottom", ["border-bottom-color", "border-bottom-style", "border-bottom-width"]);
            t.setStyleRelation("border-left", ["border-left-color", "border-left-style", "border-left-width"])
        }

        function ER(t) {
            const {color: e, style: i, width: n} = BR(t);
            return {path: "border", value: {color: mC(e), style: mC(i), width: mC(n)}}
        }

        function RR(t) {
            return e => {
                const {color: i, style: n, width: o} = BR(e);
                const r = {};
                if (i !== undefined) {
                    r.color = {[t]: i}
                }
                if (n !== undefined) {
                    r.style = {[t]: n}
                }
                if (o !== undefined) {
                    r.width = {[t]: o}
                }
                return {path: "border", value: r}
            }
        }

        function OR(t) {
            return e => ({path: "border", value: IR(e, t)})
        }

        function IR(t, e) {
            return {[e]: mC(t)}
        }

        function VR(t, e) {
            return i => ({path: "border", value: {[t]: {[e]: i}}})
        }

        function NR(t) {
            return (e, i) => {
                if (i.border) {
                    return MR(i.border, t)
                }
            }
        }

        function MR(t, e) {
            const i = {};
            if (t.width && t.width[e]) {
                i.width = t.width[e]
            }
            if (t.style && t.style[e]) {
                i.style = t.style[e]
            }
            if (t.color && t.color[e]) {
                i.color = t.color[e]
            }
            return i
        }

        function BR(t) {
            const e = {};
            const i = kC(t);
            for (const t of i) {
                if (oC(t) || /thin|medium|thick/.test(t)) {
                    e.width = t
                } else if (iC(t)) {
                    e.style = t
                } else {
                    e.color = t
                }
            }
            return e
        }

        function zR(t) {
            const e = [];
            e.push(...FR(MR(t, "top"), "top"));
            e.push(...FR(MR(t, "right"), "right"));
            e.push(...FR(MR(t, "bottom"), "bottom"));
            e.push(...FR(MR(t, "left"), "left"));
            return e
        }

        function LR(t) {
            return e => FR(e, t)
        }

        function FR(t, e) {
            const i = [];
            if (t && t.width !== undefined) {
                i.push(t.width)
            }
            if (t && t.style !== undefined) {
                i.push(t.style)
            }
            if (t && t.color !== undefined) {
                i.push(t.color)
            }
            if (i.length) {
                return [[`border-${e}`, i.join(" ")]]
            }
            return []
        }

        function DR(t) {
            t.setNormalizer("padding", wC("padding"));
            t.setNormalizer("padding-top", t => ({path: "padding.top", value: t}));
            t.setNormalizer("padding-right", t => ({path: "padding.right", value: t}));
            t.setNormalizer("padding-bottom", t => ({path: "padding.bottom", value: t}));
            t.setNormalizer("padding-left", t => ({path: "padding.left", value: t}));
            t.setReducer("padding", pC("padding"));
            t.setStyleRelation("padding", ["padding-top", "padding-right", "padding-bottom", "padding-left"])
        }

        function jR(t) {
            t.setNormalizer("background", HR);
            t.setNormalizer("background-color", t => ({path: "background.color", value: t}));
            t.setReducer("background", t => {
                const e = [];
                e.push(["background-color", t.color]);
                return e
            })
        }

        function HR(t) {
            const e = {};
            const i = kC(t);
            for (const t of i) {
                if (cC(t)) {
                    e.repeat = e.repeat || [];
                    e.repeat.push(t)
                } else if (dC(t)) {
                    e.position = e.position || [];
                    e.position.push(t)
                } else if (hC(t)) {
                    e.attachment = t
                } else if (tC(t)) {
                    e.color = t
                } else if (gC(t)) {
                    e.image = t
                }
            }
            return {path: "background", value: e}
        }

        function WR(t, e, i, n) {
            t.for("upcast").attributeToAttribute({
                view: {styles: {[n]: /[\s\S]+/}},
                model: {name: e, key: i, value: t => t.getNormalizedStyle(n)}
            })
        }

        function qR(t, e) {
            t.for("upcast").add(t => t.on("element:" + e, (t, e, i) => {
                const n = ["border-top", "border-right", "border-bottom", "border-left"].filter(t => e.viewItem.hasStyle(t));
                if (!n.length) {
                    return
                }
                const o = {styles: n};
                if (!i.consumable.test(e.viewItem, o)) {
                    return
                }
                if (!e.modelRange) {
                    e = Object.assign(e, i.convertChildren(e.viewItem, e.modelCursor))
                }
                const r = [...e.modelRange.getItems({shallow: true})].pop();
                i.consumable.consume(e.viewItem, o);
                i.writer.setAttribute("borderStyle", e.viewItem.getNormalizedStyle("border-style"), r);
                i.writer.setAttribute("borderColor", e.viewItem.getNormalizedStyle("border-color"), r);
                i.writer.setAttribute("borderWidth", e.viewItem.getNormalizedStyle("border-width"), r)
            }))
        }

        function UR(t, e, i, n) {
            t.for("downcast").attributeToAttribute({
                model: {name: e, key: i},
                view: t => ({key: "style", value: {[n]: t}})
            })
        }

        function $R(t, e, i) {
            t.for("downcast").add(t => t.on(`attribute:${e}:table`, (t, e, n) => {
                const {item: o, attributeNewValue: r} = e;
                const {mapper: s, writer: a} = n;
                if (!n.consumable.consume(e.item, t.name)) {
                    return
                }
                const c = [...s.toViewElement(o).getChildren()].find(t => t.is("table"));
                if (r) {
                    a.setStyle(i, r, c)
                } else {
                    a.removeStyle(i, c)
                }
            }))
        }

        class GR extends jw {
            constructor(t, e) {
                super(t);
                this.attributeName = e
            }

            refresh() {
                const t = this.editor;
                const e = sS(t.model.document.selection);
                this.isEnabled = !!e.length;
                this.value = this._getSingleValue(e)
            }

            execute(t = {}) {
                const {value: e, batch: i} = t;
                const n = this.editor.model;
                const o = sS(n.document.selection);
                const r = this._getValueToSet(e);
                n.enqueueChange(i || "default", t => {
                    if (r) {
                        o.forEach(e => t.setAttribute(this.attributeName, r, e))
                    } else {
                        o.forEach(e => t.removeAttribute(this.attributeName, e))
                    }
                })
            }

            _getAttribute(t) {
                if (!t) {
                    return
                }
                return t.getAttribute(this.attributeName)
            }

            _getValueToSet(t) {
                return t
            }

            _getSingleValue(t) {
                const e = this._getAttribute(t[0]);
                const i = t.every(t => this._getAttribute(t) === e);
                return i ? e : undefined
            }
        }

        class KR extends GR {
            constructor(t) {
                super(t, "padding")
            }

            _getAttribute(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        class JR extends GR {
            constructor(t) {
                super(t, "width")
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        class YR extends GR {
            constructor(t) {
                super(t, "height")
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        class QR extends GR {
            constructor(t) {
                super(t, "backgroundColor")
            }
        }

        class XR extends GR {
            constructor(t) {
                super(t, "verticalAlignment")
            }
        }

        class ZR extends GR {
            constructor(t) {
                super(t, "horizontalAlignment")
            }
        }

        class tO extends GR {
            constructor(t) {
                super(t, "borderStyle")
            }

            _getAttribute(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }
        }

        class eO extends GR {
            constructor(t) {
                super(t, "borderColor")
            }

            _getAttribute(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }
        }

        class iO extends GR {
            constructor(t) {
                super(t, "borderWidth")
            }

            _getAttribute(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        const nO = /^(top|bottom)$/;

        class oO extends mp {
            static get pluginName() {
                return "TableCellPropertiesEditing"
            }

            static get requires() {
                return [wE]
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.conversion;
                t.data.addStyleProcessorRules(SR);
                rO(e, i);
                t.commands.add("tableCellBorderStyle", new tO(t));
                t.commands.add("tableCellBorderColor", new eO(t));
                t.commands.add("tableCellBorderWidth", new iO(t));
                sO(e, i);
                t.commands.add("tableCellHorizontalAlignment", new ZR(t));
                cO(e, i, "width", "width");
                t.commands.add("tableCellWidth", new JR(t));
                cO(e, i, "height", "height");
                t.commands.add("tableCellHeight", new YR(t));
                t.data.addStyleProcessorRules(DR);
                cO(e, i, "padding", "padding");
                t.commands.add("tableCellPadding", new KR(t));
                t.data.addStyleProcessorRules(jR);
                cO(e, i, "backgroundColor", "background-color");
                t.commands.add("tableCellBackgroundColor", new QR(t));
                aO(e, i);
                t.commands.add("tableCellVerticalAlignment", new XR(t))
            }
        }

        function rO(t, e) {
            t.extend("tableCell", {allowAttributes: ["borderWidth", "borderColor", "borderStyle"]});
            qR(e, "td");
            qR(e, "th");
            UR(e, "tableCell", "borderStyle", "border-style");
            UR(e, "tableCell", "borderColor", "border-color");
            UR(e, "tableCell", "borderWidth", "border-width")
        }

        function sO(t, e) {
            t.extend("tableCell", {allowAttributes: ["horizontalAlignment"]});
            e.attributeToAttribute({
                model: {
                    name: "tableCell",
                    key: "horizontalAlignment",
                    values: ["right", "center", "justify"]
                },
                view: {
                    right: {key: "style", value: {"text-align": "right"}},
                    center: {key: "style", value: {"text-align": "center"}},
                    justify: {key: "style", value: {"text-align": "justify"}}
                }
            })
        }

        function aO(t, e) {
            t.extend("tableCell", {allowAttributes: ["verticalAlignment"]});
            e.attributeToAttribute({
                model: {name: "tableCell", key: "verticalAlignment", values: ["top", "bottom"]},
                view: {
                    top: {key: "style", value: {"vertical-align": "top"}},
                    bottom: {key: "style", value: {"vertical-align": "bottom"}}
                }
            });
            e.for("upcast").attributeToAttribute({
                view: {attributes: {valign: nO}},
                model: {name: "tableCell", key: "verticalAlignment", value: t => t.getAttribute("valign")}
            })
        }

        function cO(t, e, i, n) {
            t.extend("tableCell", {allowAttributes: [i]});
            WR(e, "tableCell", i, n);
            UR(e, "tableCell", i, n)
        }

        class lO extends mp {
            static get pluginName() {
                return "TableCellProperties"
            }

            static get requires() {
                return [oO, PR]
            }
        }

        class dO extends mp {
            static get requires() {
                return [ly]
            }

            static get pluginName() {
                return "TableToolbar"
            }

            afterInit() {
                const t = this.editor;
                const e = t.t;
                const i = t.plugins.get(ly);
                const n = t.config.get("table.contentToolbar");
                const o = t.config.get("table.tableToolbar");
                if (n) {
                    i.register("tableContent", {ariaLabel: e("iv"), items: n, getRelatedElement: nS})
                }
                if (o) {
                    i.register("table", {ariaLabel: e("iv"), items: o, getRelatedElement: iS})
                }
            }
        }

        class uO extends jw {
            constructor(t, e) {
                super(t);
                this.attributeName = e
            }

            refresh() {
                const t = this.editor;
                const e = t.model.document.selection;
                const i = WP("table", e.getFirstPosition());
                this.isEnabled = !!i;
                this.value = this._getValue(i)
            }

            execute(t = {}) {
                const e = this.editor.model;
                const i = e.document.selection;
                const {value: n, batch: o} = t;
                const r = WP("table", i.getFirstPosition());
                const s = this._getValueToSet(n);
                e.enqueueChange(o || "default", t => {
                    if (s) {
                        t.setAttribute(this.attributeName, s, r)
                    } else {
                        t.removeAttribute(this.attributeName, r)
                    }
                })
            }

            _getValue(t) {
                if (!t) {
                    return
                }
                return t.getAttribute(this.attributeName)
            }

            _getValueToSet(t) {
                return t
            }
        }

        class hO extends uO {
            constructor(t) {
                super(t, "backgroundColor")
            }
        }

        class fO extends uO {
            constructor(t) {
                super(t, "borderColor")
            }

            _getValue(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }
        }

        class gO extends uO {
            constructor(t) {
                super(t, "borderStyle")
            }

            _getValue(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }
        }

        class mO extends uO {
            constructor(t) {
                super(t, "borderWidth")
            }

            _getValue(t) {
                if (!t) {
                    return
                }
                return $P(t.getAttribute(this.attributeName))
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        class pO extends uO {
            constructor(t) {
                super(t, "width")
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        class bO extends uO {
            constructor(t) {
                super(t, "height")
            }

            _getValueToSet(t) {
                return GP(t, "px")
            }
        }

        class wO extends uO {
            constructor(t) {
                super(t, "alignment")
            }
        }

        const kO = /^(left|right)$/;

        class _O extends mp {
            static get pluginName() {
                return "TablePropertiesEditing"
            }

            static get requires() {
                return [wE]
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.conversion;
                t.data.addStyleProcessorRules(SR);
                vO(e, i);
                t.commands.add("tableBorderColor", new fO(t));
                t.commands.add("tableBorderStyle", new gO(t));
                t.commands.add("tableBorderWidth", new mO(t));
                yO(e, i);
                t.commands.add("tableAlignment", new wO(t));
                CO(e, i, "width", "width");
                t.commands.add("tableWidth", new pO(t));
                CO(e, i, "height", "height");
                t.commands.add("tableHeight", new bO(t));
                t.data.addStyleProcessorRules(jR);
                xO(e, i, "backgroundColor", "background-color");
                t.commands.add("tableBackgroundColor", new hO(t))
            }
        }

        function vO(t, e) {
            t.extend("table", {allowAttributes: ["borderWidth", "borderColor", "borderStyle"]});
            qR(e, "table");
            $R(e, "borderColor", "border-color");
            $R(e, "borderStyle", "border-style");
            $R(e, "borderWidth", "border-width")
        }

        function yO(t, e) {
            t.extend("table", {allowAttributes: ["alignment"]});
            e.attributeToAttribute({
                model: {name: "table", key: "alignment", values: ["left", "right"]},
                view: {left: {key: "style", value: {float: "left"}}, right: {key: "style", value: {float: "right"}}},
                converterPriority: "high"
            });
            e.for("upcast").attributeToAttribute({
                view: {attributes: {align: kO}},
                model: {name: "table", key: "alignment", value: t => t.getAttribute("align")}
            })
        }

        function xO(t, e, i, n) {
            t.extend("table", {allowAttributes: [i]});
            WR(e, "table", i, n);
            $R(e, i, n)
        }

        function CO(t, e, i, n) {
            t.extend("table", {allowAttributes: [i]});
            WR(e, "table", i, n);
            UR(e, "table", i, n)
        }

        var AO = i(112);
        const TO = {left: ky, center: _y, right: vy};

        class PO extends Gp {
            constructor(t, e) {
                super(t);
                this.set({
                    borderStyle: "",
                    borderWidth: "",
                    borderColor: "",
                    backgroundColor: "",
                    width: "",
                    height: "",
                    alignment: ""
                });
                this.options = e;
                const {borderStyleDropdown: i, borderWidthInput: n, borderColorInput: o, borderRowLabel: r} = this._createBorderFields();
                const {widthInput: s, operatorLabel: a, heightInput: c, dimensionsLabel: l} = this._createDimensionFields();
                const {alignmentToolbar: d, alignmentLabel: u} = this._createAlignmentFields();
                this.focusTracker = new fb;
                this.keystrokes = new dp;
                this.children = this.createCollection();
                this.borderStyleDropdown = i;
                this.borderWidthInput = n;
                this.borderColorInput = o;
                this.backgroundInput = this._createBackgroundField();
                this.widthInput = s;
                this.heightInput = c;
                this.alignmentToolbar = d;
                const {saveButtonView: h, cancelButtonView: f} = this._createActionButtons();
                this.saveButtonView = h;
                this.cancelButtonView = f;
                this._focusables = new bp;
                this._focusCycler = new yb({
                    focusables: this._focusables,
                    focusTracker: this.focusTracker,
                    keystrokeHandler: this.keystrokes,
                    actions: {focusPrevious: "shift + tab", focusNext: "tab"}
                });
                this.children.add(new mR(t, {label: this.t(" ")}));
                this.children.add(new fR(t, {
                    labelView: r,
                    children: [r, i, o, n],
                    class: "ck-table-form__border-row"
                }));
                this.children.add(new fR(t, {children: [this.backgroundInput]}));
                this.children.add(new fR(t, {
                    children: [new fR(t, {
                        labelView: l,
                        children: [l, s, a, c],
                        class: "ck-table-form__dimensions-row"
                    }), new fR(t, {labelView: u, children: [u, d], class: "ck-table-properties-form__alignment-row"})]
                }));
                this.children.add(new fR(t, {
                    children: [this.saveButtonView, this.cancelButtonView],
                    class: "ck-table-form__action-row"
                }));
                this.setTemplate({
                    tag: "form",
                    attributes: {class: ["ck", "ck-form", "ck-table-form", "ck-table-properties-form"], tabindex: "-1"},
                    children: this.children
                })
            }

            render() {
                super.render();
                Qv({view: this});
                [this.borderStyleDropdown, this.borderColorInput, this.borderWidthInput, this.backgroundInput, this.widthInput, this.heightInput, this.alignmentToolbar, this.saveButtonView, this.cancelButtonView].forEach(t => {
                    this._focusables.add(t);
                    this.focusTracker.add(t.element)
                });
                this.keystrokes.listenTo(this.element)
            }

            focus() {
                this._focusCycler.focusFirst()
            }

            _createBorderFields() {
                const t = cR({colorConfig: this.options.borderColors, columns: 5});
                const e = this.locale;
                const i = this.t;
                const n = new Mk(e);
                n.text = i("nb");
                const o = ZE(this.t);
                const r = new HE(e, qE);
                r.set({label: i("nc"), class: "ck-table-form__border-style"});
                r.view.buttonView.set({isOn: false, withText: true, tooltip: i("nc")});
                r.view.buttonView.bind("label").to(this, "borderStyle", t => o[t ? t : "none"]);
                r.view.on("execute", t => {
                    this.borderStyle = t.source._borderStyleValue
                });
                Ub(r.view, rR(this));
                const s = new HE(e, WE);
                s.set({label: i("nd"), class: "ck-table-form__border-width"});
                s.view.bind("value").to(this, "borderWidth");
                s.bind("isEnabled").to(this, "borderStyle", SO);
                s.view.on("input", () => {
                    this.borderWidth = s.view.element.value
                });
                const a = new HE(e, t);
                a.set({label: i("ne"), class: "ck-table-form__border-color"});
                a.view.bind("value").to(this, "borderColor");
                a.bind("isEnabled").to(this, "borderStyle", SO);
                a.view.on("input", () => {
                    this.borderColor = a.view.value
                });
                this.on("change:borderStyle", (t, e, i) => {
                    if (!SO(i)) {
                        this.borderColor = "";
                        this.borderWidth = ""
                    }
                });
                return {borderRowLabel: n, borderStyleDropdown: r, borderColorInput: a, borderWidthInput: s}
            }

            _createBackgroundField() {
                const t = cR({colorConfig: this.options.backgroundColors, columns: 5});
                const e = this.locale;
                const i = this.t;
                const n = new HE(e, t);
                n.set({label: i("nf"), class: "ck-table-properties-form__background"});
                n.view.bind("value").to(this, "backgroundColor");
                n.view.on("input", () => {
                    this.backgroundColor = n.view.value
                });
                return n
            }

            _createDimensionFields() {
                const t = this.locale;
                const e = this.t;
                const i = new Mk(t);
                i.text = e("ng");
                const n = new HE(t, WE);
                n.set({label: e("nd"), class: "ck-table-form__dimensions-row__width"});
                n.view.bind("value").to(this, "width");
                n.view.on("input", () => {
                    this.width = n.view.element.value
                });
                const o = new Gp(t);
                o.setTemplate({
                    tag: "span",
                    attributes: {class: ["ck-table-form__dimension-operator"]},
                    children: [{text: ""}]
                });
                const r = new HE(t, WE);
                r.set({label: e("nh"), class: "ck-table-form__dimensions-row__height"});
                r.view.bind("value").to(this, "height");
                r.view.on("input", () => {
                    this.height = r.view.element.value
                });
                return {dimensionsLabel: i, widthInput: n, operatorLabel: o, heightInput: r}
            }

            _createAlignmentFields() {
                const t = this.locale;
                const e = this.t;
                const i = new Mk(t);
                i.text = e("nt");
                const n = new Xb(t);
                n.set({isCompact: true, ariaLabel: e("nu")});
                sR({
                    view: this,
                    icons: TO,
                    toolbar: n,
                    labels: this._alignmentLabels,
                    propertyName: "alignment",
                    nameToValue: t => t === "center" ? "" : t
                });
                return {alignmentLabel: i, alignmentToolbar: n}
            }

            _createActionButtons() {
                const t = this.locale;
                const e = this.t;
                const i = new hb(t);
                const n = new hb(t);
                const o = [this.borderWidthInput, this.borderColorInput, this.backgroundInput, this.widthInput, this.heightInput];
                i.set({label: e("lo"), icon: Xv, class: "ck-button-save", type: "submit", withText: true});
                i.bind("isEnabled").toMany(o, "errorText", (...t) => t.every(t => !t));
                n.set({label: e("lp"), icon: Zv, class: "ck-button-cancel", type: "cancel", withText: true});
                n.delegate("execute").to(this, "cancel");
                return {saveButtonView: i, cancelButtonView: n}
            }

            get _alignmentLabels() {
                const t = this.locale;
                const e = this.t;
                const i = e("nv");
                const n = e("nw");
                const o = e("nx");
                if (t.uiLanguageDirection === "rtl") {
                    return {right: o, center: n, left: i}
                } else {
                    return {left: i, center: n, right: o}
                }
            }
        }

        function SO(t) {
            return !!t
        }

        var EO = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="M15.5 11.5l1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';
        const RO = 500;

        class OO extends mp {
            static get requires() {
                return [kb]
            }

            static get pluginName() {
                return "TablePropertiesUI"
            }

            constructor(t) {
                super(t);
                t.config.define("table.tableProperties", {borderColors: aR, backgroundColors: aR})
            }

            init() {
                const t = this.editor;
                const e = t.t;
                this._balloon = t.plugins.get(kb);
                this.view = this._createPropertiesView();
                this._undoStepBatch = null;
                t.ui.componentFactory.add("tableProperties", t => {
                    const i = new hb(t);
                    i.set({label: e("kg"), icon: EO, tooltip: true});
                    this.listenTo(i, "execute", () => this._showView());
                    return i
                })
            }

            destroy() {
                super.destroy();
                this.view.destroy()
            }

            _createPropertiesView() {
                const t = this.editor;
                const e = t.editing.view.document;
                const i = t.config.get("table.tableProperties");
                const n = __(i.borderColors);
                const o = k_(t.locale, n);
                const r = __(i.backgroundColors);
                const s = k_(t.locale, r);
                const a = new PO(t.locale, {borderColors: o, backgroundColors: s});
                const c = t.t;
                a.render();
                this.listenTo(a, "submit", () => {
                    this._hideView()
                });
                this.listenTo(a, "cancel", () => {
                    if (this._undoStepBatch.operations.length) {
                        t.execute("undo", this._undoStepBatch)
                    }
                    this._hideView()
                });
                a.keystrokes.set("Esc", (t, e) => {
                    this._hideView();
                    e()
                });
                this.listenTo(t.ui, "update", () => {
                    if (!nS(e.selection)) {
                        this._hideView()
                    } else if (this._isViewVisible) {
                        YE(t, "table")
                    }
                });
                Db({
                    emitter: a,
                    activator: () => this._isViewInBalloon,
                    contextElements: [this._balloon.view.element],
                    callback: () => this._hideView()
                });
                const l = tR(c);
                const d = eR(c);
                a.on("change:borderStyle", this._getPropertyChangeCallback("tableBorderStyle"));
                a.on("change:borderColor", this._getValidatedPropertyChangeCallback({
                    viewField: a.borderColorInput,
                    commandName: "tableBorderColor",
                    errorText: l,
                    validator: iR
                }));
                a.on("change:borderWidth", this._getValidatedPropertyChangeCallback({
                    viewField: a.borderWidthInput,
                    commandName: "tableBorderWidth",
                    errorText: d,
                    validator: oR
                }));
                a.on("change:backgroundColor", this._getValidatedPropertyChangeCallback({
                    viewField: a.backgroundInput,
                    commandName: "tableBackgroundColor",
                    errorText: l,
                    validator: iR
                }));
                a.on("change:width", this._getValidatedPropertyChangeCallback({
                    viewField: a.widthInput,
                    commandName: "tableWidth",
                    errorText: d,
                    validator: nR
                }));
                a.on("change:height", this._getValidatedPropertyChangeCallback({
                    viewField: a.heightInput,
                    commandName: "tableHeight",
                    errorText: d,
                    validator: nR
                }));
                a.on("change:alignment", this._getPropertyChangeCallback("tableAlignment"));
                return a
            }

            _fillViewFormFromCommandValues() {
                const t = this.editor.commands;
                this.view.set({
                    borderStyle: t.get("tableBorderStyle").value || "",
                    borderColor: t.get("tableBorderColor").value || "",
                    borderWidth: t.get("tableBorderWidth").value || "",
                    backgroundColor: t.get("tableBackgroundColor").value || "",
                    width: t.get("tableWidth").value || "",
                    height: t.get("tableHeight").value || "",
                    alignment: t.get("tableAlignment").value || ""
                })
            }

            _showView() {
                const t = this.editor;
                this._balloon.add({view: this.view, position: QE(t)});
                this._undoStepBatch = t.model.createBatch();
                this._fillViewFormFromCommandValues();
                this.view.focus()
            }

            _hideView() {
                if (!this._isViewInBalloon) {
                    return
                }
                const t = this.editor;
                this.stopListening(t.ui, "update");
                this.view.saveButtonView.focus();
                this._balloon.remove(this.view);
                this.editor.editing.view.focus()
            }

            get _isViewVisible() {
                return this._balloon.visibleView === this.view
            }

            get _isViewInBalloon() {
                return this._balloon.hasView(this.view)
            }

            _getPropertyChangeCallback(t) {
                return (e, i, n) => {
                    this.editor.execute(t, {value: n, batch: this._undoStepBatch})
                }
            }

            _getValidatedPropertyChangeCallback({commandName: t, viewField: e, validator: i, errorText: n}) {
                const o = uh(() => {
                    e.errorText = n
                }, RO);
                return (n, r, s) => {
                    o.cancel();
                    if (i(s)) {
                        this.editor.execute(t, {value: s, batch: this._undoStepBatch});
                        e.errorText = null
                    } else {
                        o()
                    }
                }
            }
        }

        class IO extends mp {
            static get pluginName() {
                return "TableProperties"
            }

            static get requires() {
                return [_O, OO]
            }
        }

        const VO = "underline";

        class NO extends mp {
            static get pluginName() {
                return "UnderlineEditing"
            }

            init() {
                const t = this.editor;
                t.model.schema.extend("$text", {allowAttributes: VO});
                t.model.schema.setAttributeProperties(VO, {isFormatting: true, copyOnEnter: true});
                t.conversion.attributeToElement({
                    model: VO,
                    view: "u",
                    upcastAlso: {styles: {"text-decoration": "underline"}}
                });
                t.commands.add(VO, new yk(t, VO));
                t.keystrokes.set("CTRL+U", "underline")
            }
        }

        var MO = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';
        const BO = "underline";

        class zO extends mp {
            init() {
                const t = this.editor;
                const e = t.t;
                t.ui.componentFactory.add(BO, i => {
                    const n = t.commands.get(BO);
                    const o = new hb(i);
                    o.set({label: e("jn"), icon: MO, keystroke: "CTRL+U", tooltip: true, isToggleable: true});
                    o.bind("isOn", "isEnabled").to(n, "value", "isEnabled");
                    this.listenTo(o, "execute", () => {
                        t.execute(BO);
                        t.editing.view.focus()
                    });
                    return o
                })
            }
        }

        class LO extends mp {
            static get requires() {
                return [NO, zO]
            }

            static get pluginName() {
                return "Underline"
            }
        }

        function* FO(t, e) {
            for (const i of e) {
                if (i && t.getAttributeProperties(i[0]).copyOnEnter) {
                    yield i
                }
            }
        }

        class DO extends jw {
            execute() {
                const t = this.editor.model;
                const e = t.document;
                t.change(i => {
                    jO(this.editor.model, i, e.selection, t.schema);
                    this.fire("afterExecute", {writer: i})
                })
            }
        }

        function jO(t, e, i, n) {
            const o = i.isCollapsed;
            const r = i.getFirstRange();
            const s = r.start.parent;
            const a = r.end.parent;
            if (n.isLimit(s) || n.isLimit(a)) {
                if (!o && s == a) {
                    t.deleteContent(i)
                }
                return
            }
            if (o) {
                const t = FO(e.model.schema, i.getAttributes());
                HO(e, r.start);
                e.setSelectionAttribute(t)
            } else {
                const n = !(r.start.isAtStart && r.end.isAtEnd);
                const o = s == a;
                t.deleteContent(i, {leaveUnmerged: n});
                if (n) {
                    if (o) {
                        HO(e, i.focus)
                    } else {
                        e.setSelection(a, 0)
                    }
                }
            }
        }

        function HO(t, e) {
            t.split(e);
            t.setSelection(e.parent.nextSibling, 0)
        }

        class WO extends Gd {
            constructor(t) {
                super(t);
                const e = this.document;
                e.on("keydown", (t, i) => {
                    if (this.isEnabled && i.keyCode == Nl.enter) {
                        let n;
                        e.once("enter", t => n = t, {priority: "highest"});
                        e.fire("enter", new Ku(e, i.domEvent, {isSoft: i.shiftKey}));
                        if (n && n.stop.called) {
                            t.stop()
                        }
                    }
                })
            }

            observe() {
            }
        }

        class qO extends mp {
            static get pluginName() {
                return "Enter"
            }

            init() {
                const t = this.editor;
                const e = t.editing.view;
                const i = e.document;
                e.addObserver(WO);
                t.commands.add("enter", new DO(t));
                this.listenTo(i, "enter", (i, n) => {
                    n.preventDefault();
                    if (n.isSoft) {
                        return
                    }
                    t.execute("enter");
                    e.scrollToTheSelection()
                }, {priority: "low"})
            }
        }

        class UO extends jw {
            execute() {
                const t = this.editor.model;
                const e = t.document;
                t.change(i => {
                    GO(t, i, e.selection);
                    this.fire("afterExecute", {writer: i})
                })
            }

            refresh() {
                const t = this.editor.model;
                const e = t.document;
                this.isEnabled = $O(t.schema, e.selection)
            }
        }

        function $O(t, e) {
            if (e.rangeCount > 1) {
                return false
            }
            const i = e.anchor;
            if (!i || !t.checkChild(i, "softBreak")) {
                return false
            }
            const n = e.getFirstRange();
            const o = n.start.parent;
            const r = n.end.parent;
            if ((JO(o, t) || JO(r, t)) && o !== r) {
                return false
            }
            return true
        }

        function GO(t, e, i) {
            const n = i.isCollapsed;
            const o = i.getFirstRange();
            const r = o.start.parent;
            const s = o.end.parent;
            const a = r == s;
            if (n) {
                const n = FO(t.schema, i.getAttributes());
                KO(t, e, o.end);
                e.removeSelectionAttribute(i.getAttributeKeys());
                e.setSelectionAttribute(n)
            } else {
                const n = !(o.start.isAtStart && o.end.isAtEnd);
                t.deleteContent(i, {leaveUnmerged: n});
                if (a) {
                    KO(t, e, i.focus)
                } else {
                    if (n) {
                        e.setSelection(s, 0)
                    }
                }
            }
        }

        function KO(t, e, i) {
            const n = e.createElement("softBreak");
            t.insertContent(n, i);
            e.setSelection(n, "after")
        }

        function JO(t, e) {
            if (t.is("rootElement")) {
                return false
            }
            return e.isLimit(t) || JO(t.parent, e)
        }

        class YO extends mp {
            static get pluginName() {
                return "ShiftEnter"
            }

            init() {
                const t = this.editor;
                const e = t.model.schema;
                const i = t.conversion;
                const n = t.editing.view;
                const o = n.document;
                e.register("softBreak", {allowWhere: "$text", isInline: true});
                i.for("upcast").elementToElement({model: "softBreak", view: "br"});
                i.for("downcast").elementToElement({model: "softBreak", view: (t, e) => e.createEmptyElement("br")});
                n.addObserver(WO);
                t.commands.add("shiftEnter", new UO(t));
                this.listenTo(o, "enter", (e, i) => {
                    i.preventDefault();
                    if (!i.isSoft) {
                        return
                    }
                    t.execute("shiftEnter");
                    n.scrollToTheSelection()
                }, {priority: "low"})
            }
        }

        const QO = new Map;

        function XO(t, e, i) {
            let n = QO.get(t);
            if (!n) {
                n = new Map;
                QO.set(t, n)
            }
            n.set(e, i)
        }

        function ZO(t, e) {
            const i = QO.get(t);
            if (i && i.has(e)) {
                return i.get(e)
            }
            return tI
        }

        function tI(t) {
            return [t]
        }

        function eI(t, e, i = {}) {
            const n = ZO(t.constructor, e.constructor);
            try {
                t = t.clone();
                return n(t, e, i)
            } catch (t) {
                throw t
            }
        }

        function iI(t, e, i) {
            t = t.slice();
            e = e.slice();
            const n = new nI(i.document, i.useRelations, i.forceWeakRemove);
            n.setOriginalOperations(t);
            n.setOriginalOperations(e);
            const o = n.originalOperations;
            if (t.length == 0 || e.length == 0) {
                return {operationsA: t, operationsB: e, originalOperations: o}
            }
            const r = new WeakMap;
            for (const e of t) {
                r.set(e, 0)
            }
            const s = {
                nextBaseVersionA: t[t.length - 1].baseVersion + 1,
                nextBaseVersionB: e[e.length - 1].baseVersion + 1,
                originalOperationsACount: t.length,
                originalOperationsBCount: e.length
            };
            let a = 0;
            while (a < t.length) {
                const i = t[a];
                const o = r.get(i);
                if (o == e.length) {
                    a++;
                    continue
                }
                const s = e[o];
                const c = eI(i, s, n.getContext(i, s, true));
                const l = eI(s, i, n.getContext(s, i, false));
                n.updateRelation(i, s);
                n.setOriginalOperations(c, i);
                n.setOriginalOperations(l, s);
                for (const t of c) {
                    r.set(t, o + l.length)
                }
                t.splice(a, 1, ...c);
                e.splice(o, 1, ...l)
            }
            if (i.padWithNoOps) {
                const i = t.length - s.originalOperationsACount;
                const n = e.length - s.originalOperationsBCount;
                rI(t, n - i);
                rI(e, i - n)
            }
            oI(t, s.nextBaseVersionB);
            oI(e, s.nextBaseVersionA);
            return {operationsA: t, operationsB: e, originalOperations: o}
        }

        class nI {
            constructor(t, e, i = false) {
                this.originalOperations = new Map;
                this._history = t.history;
                this._useRelations = e;
                this._forceWeakRemove = !!i;
                this._relations = new Map
            }

            setOriginalOperations(t, e = null) {
                const i = e ? this.originalOperations.get(e) : null;
                for (const e of t) {
                    this.originalOperations.set(e, i || e)
                }
            }

            updateRelation(t, e) {
                switch (t.constructor) {
                    case Zg: {
                        switch (e.constructor) {
                            case om: {
                                if (t.targetPosition.isEqual(e.sourcePosition) || e.movedRange.containsPosition(t.targetPosition)) {
                                    this._setRelation(t, e, "insertAtSource")
                                } else if (t.targetPosition.isEqual(e.deletionPosition)) {
                                    this._setRelation(t, e, "insertBetween")
                                } else if (t.targetPosition.isAfter(e.sourcePosition)) {
                                    this._setRelation(t, e, "moveTargetAfter")
                                }
                                break
                            }
                            case Zg: {
                                if (t.targetPosition.isEqual(e.sourcePosition) || t.targetPosition.isBefore(e.sourcePosition)) {
                                    this._setRelation(t, e, "insertBefore")
                                } else {
                                    this._setRelation(t, e, "insertAfter")
                                }
                                break
                            }
                        }
                        break
                    }
                    case rm: {
                        switch (e.constructor) {
                            case om: {
                                if (t.splitPosition.isBefore(e.sourcePosition)) {
                                    this._setRelation(t, e, "splitBefore")
                                }
                                break
                            }
                            case Zg: {
                                if (t.splitPosition.isEqual(e.sourcePosition) || t.splitPosition.isBefore(e.sourcePosition)) {
                                    this._setRelation(t, e, "splitBefore")
                                }
                                break
                            }
                        }
                        break
                    }
                    case om: {
                        switch (e.constructor) {
                            case om: {
                                if (!t.targetPosition.isEqual(e.sourcePosition)) {
                                    this._setRelation(t, e, "mergeTargetNotMoved")
                                }
                                if (t.sourcePosition.isEqual(e.targetPosition)) {
                                    this._setRelation(t, e, "mergeSourceNotMoved")
                                }
                                if (t.sourcePosition.isEqual(e.sourcePosition)) {
                                    this._setRelation(t, e, "mergeSameElement")
                                }
                                break
                            }
                            case rm: {
                                if (t.sourcePosition.isEqual(e.splitPosition)) {
                                    this._setRelation(t, e, "splitAtSource")
                                }
                            }
                        }
                        break
                    }
                    case em: {
                        const i = t.newRange;
                        if (!i) {
                            return
                        }
                        switch (e.constructor) {
                            case Zg: {
                                const n = $h._createFromPositionAndShift(e.sourcePosition, e.howMany);
                                const o = n.containsPosition(i.start) || n.start.isEqual(i.start);
                                const r = n.containsPosition(i.end) || n.end.isEqual(i.end);
                                if ((o || r) && !n.containsRange(i)) {
                                    this._setRelation(t, e, {
                                        side: o ? "left" : "right",
                                        path: o ? i.start.path.slice() : i.end.path.slice()
                                    })
                                }
                                break
                            }
                            case om: {
                                const n = i.start.isEqual(e.targetPosition);
                                const o = i.start.isEqual(e.deletionPosition);
                                const r = i.end.isEqual(e.deletionPosition);
                                const s = i.end.isEqual(e.sourcePosition);
                                if (n || o || r || s) {
                                    this._setRelation(t, e, {
                                        wasInLeftElement: n,
                                        wasStartBeforeMergedElement: o,
                                        wasEndBeforeMergedElement: r,
                                        wasInRightElement: s
                                    })
                                }
                                break
                            }
                        }
                        break
                    }
                }
            }

            getContext(t, e, i) {
                return {
                    aIsStrong: i,
                    aWasUndone: this._wasUndone(t),
                    bWasUndone: this._wasUndone(e),
                    abRelation: this._useRelations ? this._getRelation(t, e) : null,
                    baRelation: this._useRelations ? this._getRelation(e, t) : null,
                    forceWeakRemove: this._forceWeakRemove
                }
            }

            _wasUndone(t) {
                const e = this.originalOperations.get(t);
                return e.wasUndone || this._history.isUndoneOperation(e)
            }

            _getRelation(t, e) {
                const i = this.originalOperations.get(e);
                const n = this._history.getUndoneOperation(i);
                if (!n) {
                    return null
                }
                const o = this.originalOperations.get(t);
                const r = this._relations.get(o);
                if (r) {
                    return r.get(n) || null
                }
                return null
            }

            _setRelation(t, e, i) {
                const n = this.originalOperations.get(t);
                const o = this.originalOperations.get(e);
                let r = this._relations.get(n);
                if (!r) {
                    r = new Map;
                    this._relations.set(n, r)
                }
                r.set(o, i)
            }
        }

        function oI(t, e) {
            for (const i of t) {
                i.baseVersion = e++
            }
        }

        function rI(t, e) {
            for (let i = 0; i < e; i++) {
                t.push(new Sm(0))
            }
        }

        XO(Qg, Qg, (t, e, i) => {
            if (t.key === e.key) {
                const n = t.range.getDifference(e.range).map(e => new Qg(e, t.key, t.oldValue, t.newValue, 0));
                const o = t.range.getIntersection(e.range);
                if (o) {
                    if (i.aIsStrong) {
                        n.push(new Qg(o, e.key, e.newValue, t.newValue, 0))
                    }
                }
                if (n.length == 0) {
                    return [new Sm(0)]
                }
                return n
            } else {
                return [t]
            }
        });
        XO(Qg, tm, (t, e) => {
            if (t.range.start.hasSameParentAs(e.position) && t.range.containsPosition(e.position)) {
                const i = t.range._getTransformedByInsertion(e.position, e.howMany, !e.shouldReceiveAttributes);
                const n = i.map(e => new Qg(e, t.key, t.oldValue, t.newValue, t.baseVersion));
                if (e.shouldReceiveAttributes) {
                    const i = sI(e, t.key, t.oldValue);
                    if (i) {
                        n.unshift(i)
                    }
                }
                return n
            }
            t.range = t.range._getTransformedByInsertion(e.position, e.howMany, false)[0];
            return [t]
        });

        function sI(t, e, i) {
            const n = t.nodes;
            const o = n.getNode(0).getAttribute(e);
            if (o == i) {
                return null
            }
            const r = new $h(t.position, t.position.getShiftedBy(t.howMany));
            return new Qg(r, e, o, i, 0)
        }

        XO(Qg, om, (t, e) => {
            const i = [];
            if (t.range.start.hasSameParentAs(e.deletionPosition)) {
                if (t.range.containsPosition(e.deletionPosition) || t.range.start.isEqual(e.deletionPosition)) {
                    i.push($h._createFromPositionAndShift(e.graveyardPosition, 1))
                }
            }
            const n = t.range._getTransformedByMergeOperation(e);
            if (!n.isCollapsed) {
                i.push(n)
            }
            return i.map(e => new Qg(e, t.key, t.oldValue, t.newValue, t.baseVersion))
        });
        XO(Qg, Zg, (t, e) => {
            const i = aI(t.range, e);
            return i.map(e => new Qg(e, t.key, t.oldValue, t.newValue, t.baseVersion))
        });

        function aI(t, e) {
            const i = $h._createFromPositionAndShift(e.sourcePosition, e.howMany);
            let n = null;
            let o = [];
            if (i.containsRange(t, true)) {
                n = t
            } else if (t.start.hasSameParentAs(i.start)) {
                o = t.getDifference(i);
                n = t.getIntersection(i)
            } else {
                o = [t]
            }
            const r = [];
            for (let t of o) {
                t = t._getTransformedByDeletion(e.sourcePosition, e.howMany);
                const i = e.getMovedRangeStart();
                const n = t.start.hasSameParentAs(i);
                t = t._getTransformedByInsertion(i, e.howMany, n);
                r.push(...t)
            }
            if (n) {
                r.push(n._getTransformedByMove(e.sourcePosition, e.targetPosition, e.howMany, false)[0])
            }
            return r
        }

        XO(Qg, rm, (t, e) => {
            if (t.range.end.isEqual(e.insertionPosition)) {
                if (!e.graveyardPosition) {
                    t.range.end.offset++
                }
                return [t]
            }
            if (t.range.start.hasSameParentAs(e.splitPosition) && t.range.containsPosition(e.splitPosition)) {
                const i = t.clone();
                i.range = new $h(e.moveTargetPosition.clone(), t.range.end._getCombined(e.splitPosition, e.moveTargetPosition));
                t.range.end = e.splitPosition.clone();
                t.range.end.stickiness = "toPrevious";
                return [t, i]
            }
            t.range = t.range._getTransformedBySplitOperation(e);
            return [t]
        });
        XO(tm, Qg, (t, e) => {
            const i = [t];
            if (t.shouldReceiveAttributes && t.position.hasSameParentAs(e.range.start) && e.range.containsPosition(t.position)) {
                const n = sI(t, e.key, e.newValue);
                if (n) {
                    i.push(n)
                }
            }
            return i
        });
        XO(tm, tm, (t, e, i) => {
            if (t.position.isEqual(e.position) && i.aIsStrong) {
                return [t]
            }
            t.position = t.position._getTransformedByInsertOperation(e);
            return [t]
        });
        XO(tm, Zg, (t, e) => {
            t.position = t.position._getTransformedByMoveOperation(e);
            return [t]
        });
        XO(tm, rm, (t, e) => {
            t.position = t.position._getTransformedBySplitOperation(e);
            return [t]
        });
        XO(tm, om, (t, e) => {
            t.position = t.position._getTransformedByMergeOperation(e);
            return [t]
        });
        XO(em, tm, (t, e) => {
            if (t.oldRange) {
                t.oldRange = t.oldRange._getTransformedByInsertOperation(e)[0]
            }
            if (t.newRange) {
                t.newRange = t.newRange._getTransformedByInsertOperation(e)[0]
            }
            return [t]
        });
        XO(em, em, (t, e, i) => {
            if (t.name == e.name) {
                if (i.aIsStrong) {
                    t.oldRange = e.newRange ? e.newRange.clone() : null
                } else {
                    return [new Sm(0)]
                }
            }
            return [t]
        });
        XO(em, om, (t, e) => {
            if (t.oldRange) {
                t.oldRange = t.oldRange._getTransformedByMergeOperation(e)
            }
            if (t.newRange) {
                t.newRange = t.newRange._getTransformedByMergeOperation(e)
            }
            return [t]
        });
        XO(em, Zg, (t, e, i) => {
            if (t.oldRange) {
                t.oldRange = $h._createFromRanges(t.oldRange._getTransformedByMoveOperation(e))
            }
            if (t.newRange) {
                if (i.abRelation) {
                    const n = $h._createFromRanges(t.newRange._getTransformedByMoveOperation(e));
                    if (i.abRelation.side == "left" && e.targetPosition.isEqual(t.newRange.start)) {
                        t.newRange.start.path = i.abRelation.path;
                        t.newRange.end = n.end;
                        return [t]
                    } else if (i.abRelation.side == "right" && e.targetPosition.isEqual(t.newRange.end)) {
                        t.newRange.start = n.start;
                        t.newRange.end.path = i.abRelation.path;
                        return [t]
                    }
                }
                t.newRange = $h._createFromRanges(t.newRange._getTransformedByMoveOperation(e))
            }
            return [t]
        });
        XO(em, rm, (t, e, i) => {
            if (t.oldRange) {
                t.oldRange = t.oldRange._getTransformedBySplitOperation(e)
            }
            if (t.newRange) {
                if (i.abRelation) {
                    const n = t.newRange._getTransformedBySplitOperation(e);
                    if (t.newRange.start.isEqual(e.splitPosition) && i.abRelation.wasStartBeforeMergedElement) {
                        t.newRange.start = Uh._createAt(e.insertionPosition)
                    } else if (t.newRange.start.isEqual(e.splitPosition) && !i.abRelation.wasInLeftElement) {
                        t.newRange.start = Uh._createAt(e.moveTargetPosition)
                    }
                    if (t.newRange.end.isEqual(e.splitPosition) && i.abRelation.wasInRightElement) {
                        t.newRange.end = Uh._createAt(e.moveTargetPosition)
                    } else if (t.newRange.end.isEqual(e.splitPosition) && i.abRelation.wasEndBeforeMergedElement) {
                        t.newRange.end = Uh._createAt(e.insertionPosition)
                    } else {
                        t.newRange.end = n.end
                    }
                    return [t]
                }
                t.newRange = t.newRange._getTransformedBySplitOperation(e)
            }
            return [t]
        });
        XO(om, tm, (t, e) => {
            if (t.sourcePosition.hasSameParentAs(e.position)) {
                t.howMany += e.howMany
            }
            t.sourcePosition = t.sourcePosition._getTransformedByInsertOperation(e);
            t.targetPosition = t.targetPosition._getTransformedByInsertOperation(e);
            return [t]
        });
        XO(om, om, (t, e, i) => {
            if (t.sourcePosition.isEqual(e.sourcePosition) && t.targetPosition.isEqual(e.targetPosition)) {
                if (!i.bWasUndone) {
                    return [new Sm(0)]
                } else {
                    const i = e.graveyardPosition.path.slice();
                    i.push(0);
                    t.sourcePosition = new Uh(e.graveyardPosition.root, i);
                    t.howMany = 0;
                    return [t]
                }
            }
            if (t.sourcePosition.isEqual(e.sourcePosition) && !t.targetPosition.isEqual(e.targetPosition) && !i.bWasUndone && i.abRelation != "splitAtSource") {
                const n = t.targetPosition.root.rootName == "$graveyard";
                const o = e.targetPosition.root.rootName == "$graveyard";
                const r = n && !o;
                const s = o && !n;
                const a = s || !r && i.aIsStrong;
                if (a) {
                    const i = e.targetPosition._getTransformedByMergeOperation(e);
                    const n = t.targetPosition._getTransformedByMergeOperation(e);
                    return [new Zg(i, t.howMany, n, 0)]
                } else {
                    return [new Sm(0)]
                }
            }
            if (t.sourcePosition.hasSameParentAs(e.targetPosition)) {
                t.howMany += e.howMany
            }
            t.sourcePosition = t.sourcePosition._getTransformedByMergeOperation(e);
            t.targetPosition = t.targetPosition._getTransformedByMergeOperation(e);
            if (!t.graveyardPosition.isEqual(e.graveyardPosition) || !i.aIsStrong) {
                t.graveyardPosition = t.graveyardPosition._getTransformedByMergeOperation(e)
            }
            return [t]
        });
        XO(om, Zg, (t, e, i) => {
            const n = $h._createFromPositionAndShift(e.sourcePosition, e.howMany);
            if (e.type == "remove" && !i.bWasUndone && !i.forceWeakRemove) {
                if (t.deletionPosition.hasSameParentAs(e.sourcePosition) && n.containsPosition(t.sourcePosition)) {
                    return [new Sm(0)]
                }
            }
            if (t.sourcePosition.hasSameParentAs(e.targetPosition)) {
                t.howMany += e.howMany
            }
            if (t.sourcePosition.hasSameParentAs(e.sourcePosition)) {
                t.howMany -= e.howMany
            }
            t.sourcePosition = t.sourcePosition._getTransformedByMoveOperation(e);
            t.targetPosition = t.targetPosition._getTransformedByMoveOperation(e);
            if (!t.graveyardPosition.isEqual(e.targetPosition)) {
                t.graveyardPosition = t.graveyardPosition._getTransformedByMoveOperation(e)
            }
            return [t]
        });
        XO(om, rm, (t, e, i) => {
            if (e.graveyardPosition) {
                t.graveyardPosition = t.graveyardPosition._getTransformedByDeletion(e.graveyardPosition, 1);
                if (t.deletionPosition.isEqual(e.graveyardPosition)) {
                    t.howMany = e.howMany
                }
            }
            if (t.targetPosition.isEqual(e.splitPosition)) {
                const n = e.howMany != 0;
                const o = e.graveyardPosition && t.deletionPosition.isEqual(e.graveyardPosition);
                if (n || o || i.abRelation == "mergeTargetNotMoved") {
                    t.sourcePosition = t.sourcePosition._getTransformedBySplitOperation(e);
                    return [t]
                }
            }
            if (t.sourcePosition.isEqual(e.splitPosition)) {
                if (i.abRelation == "mergeSourceNotMoved") {
                    t.howMany = 0;
                    t.targetPosition = t.targetPosition._getTransformedBySplitOperation(e);
                    return [t]
                }
                if (i.abRelation == "mergeSameElement" || t.sourcePosition.offset > 0) {
                    t.sourcePosition = e.moveTargetPosition.clone();
                    t.targetPosition = t.targetPosition._getTransformedBySplitOperation(e);
                    return [t]
                }
            }
            if (t.sourcePosition.hasSameParentAs(e.splitPosition)) {
                t.howMany = e.splitPosition.offset
            }
            t.sourcePosition = t.sourcePosition._getTransformedBySplitOperation(e);
            t.targetPosition = t.targetPosition._getTransformedBySplitOperation(e);
            return [t]
        });
        XO(Zg, tm, (t, e) => {
            const i = $h._createFromPositionAndShift(t.sourcePosition, t.howMany);
            const n = i._getTransformedByInsertOperation(e, false)[0];
            t.sourcePosition = n.start;
            t.howMany = n.end.offset - n.start.offset;
            if (!t.targetPosition.isEqual(e.position)) {
                t.targetPosition = t.targetPosition._getTransformedByInsertOperation(e)
            }
            return [t]
        });
        XO(Zg, Zg, (t, e, i) => {
            const n = $h._createFromPositionAndShift(t.sourcePosition, t.howMany);
            const o = $h._createFromPositionAndShift(e.sourcePosition, e.howMany);
            let r = i.aIsStrong;
            let s = !i.aIsStrong;
            if (i.abRelation == "insertBefore" || i.baRelation == "insertAfter") {
                s = true
            } else if (i.abRelation == "insertAfter" || i.baRelation == "insertBefore") {
                s = false
            }
            let a;
            if (t.targetPosition.isEqual(e.targetPosition) && s) {
                a = t.targetPosition._getTransformedByDeletion(e.sourcePosition, e.howMany)
            } else {
                a = t.targetPosition._getTransformedByMove(e.sourcePosition, e.targetPosition, e.howMany)
            }
            if (cI(t, e) && cI(e, t)) {
                return [e.getReversed()]
            }
            const c = n.containsPosition(e.targetPosition);
            if (c && n.containsRange(o, true)) {
                n.start = n.start._getTransformedByMove(e.sourcePosition, e.targetPosition, e.howMany);
                n.end = n.end._getTransformedByMove(e.sourcePosition, e.targetPosition, e.howMany);
                return lI([n], a)
            }
            const l = o.containsPosition(t.targetPosition);
            if (l && o.containsRange(n, true)) {
                n.start = n.start._getCombined(e.sourcePosition, e.getMovedRangeStart());
                n.end = n.end._getCombined(e.sourcePosition, e.getMovedRangeStart());
                return lI([n], a)
            }
            const d = Vs(t.sourcePosition.getParentPath(), e.sourcePosition.getParentPath());
            if (d == "prefix" || d == "extension") {
                n.start = n.start._getTransformedByMove(e.sourcePosition, e.targetPosition, e.howMany);
                n.end = n.end._getTransformedByMove(e.sourcePosition, e.targetPosition, e.howMany);
                return lI([n], a)
            }
            if (t.type == "remove" && e.type != "remove" && !i.aWasUndone && !i.forceWeakRemove) {
                r = true
            } else if (t.type != "remove" && e.type == "remove" && !i.bWasUndone && !i.forceWeakRemove) {
                r = false
            }
            const u = [];
            const h = n.getDifference(o);
            for (const t of h) {
                t.start = t.start._getTransformedByDeletion(e.sourcePosition, e.howMany);
                t.end = t.end._getTransformedByDeletion(e.sourcePosition, e.howMany);
                const i = Vs(t.start.getParentPath(), e.getMovedRangeStart().getParentPath()) == "same";
                const n = t._getTransformedByInsertion(e.getMovedRangeStart(), e.howMany, i);
                u.push(...n)
            }
            const f = n.getIntersection(o);
            if (f !== null && r) {
                f.start = f.start._getCombined(e.sourcePosition, e.getMovedRangeStart());
                f.end = f.end._getCombined(e.sourcePosition, e.getMovedRangeStart());
                if (u.length === 0) {
                    u.push(f)
                } else if (u.length == 1) {
                    if (o.start.isBefore(n.start) || o.start.isEqual(n.start)) {
                        u.unshift(f)
                    } else {
                        u.push(f)
                    }
                } else {
                    u.splice(1, 0, f)
                }
            }
            if (u.length === 0) {
                return [new Sm(t.baseVersion)]
            }
            return lI(u, a)
        });
        XO(Zg, rm, (t, e, i) => {
            let n = t.targetPosition.clone();
            if (!t.targetPosition.isEqual(e.insertionPosition) || !e.graveyardPosition || i.abRelation == "moveTargetAfter") {
                n = t.targetPosition._getTransformedBySplitOperation(e)
            }
            const o = $h._createFromPositionAndShift(t.sourcePosition, t.howMany);
            if (o.end.isEqual(e.insertionPosition)) {
                if (!e.graveyardPosition) {
                    t.howMany++
                }
                t.targetPosition = n;
                return [t]
            }
            if (o.start.hasSameParentAs(e.splitPosition) && o.containsPosition(e.splitPosition)) {
                let t = new $h(e.splitPosition, o.end);
                t = t._getTransformedBySplitOperation(e);
                const i = [new $h(o.start, e.splitPosition), t];
                return lI(i, n)
            }
            if (t.targetPosition.isEqual(e.splitPosition) && i.abRelation == "insertAtSource") {
                n = e.moveTargetPosition
            }
            if (t.targetPosition.isEqual(e.insertionPosition) && i.abRelation == "insertBetween") {
                n = t.targetPosition
            }
            const r = o._getTransformedBySplitOperation(e);
            const s = [r];
            if (e.graveyardPosition) {
                const n = o.start.isEqual(e.graveyardPosition) || o.containsPosition(e.graveyardPosition);
                if (t.howMany > 1 && n && !i.aWasUndone) {
                    s.push($h._createFromPositionAndShift(e.insertionPosition, 1))
                }
            }
            return lI(s, n)
        });
        XO(Zg, om, (t, e, i) => {
            const n = $h._createFromPositionAndShift(t.sourcePosition, t.howMany);
            if (e.deletionPosition.hasSameParentAs(t.sourcePosition) && n.containsPosition(e.sourcePosition)) {
                if (t.type == "remove" && !i.forceWeakRemove) {
                    if (!i.aWasUndone) {
                        const i = [];
                        let n = e.graveyardPosition.clone();
                        let o = e.targetPosition._getTransformedByMergeOperation(e);
                        if (t.howMany > 1) {
                            i.push(new Zg(t.sourcePosition, t.howMany - 1, t.targetPosition, 0));
                            n = n._getTransformedByMove(t.sourcePosition, t.targetPosition, t.howMany - 1);
                            o = o._getTransformedByMove(t.sourcePosition, t.targetPosition, t.howMany - 1)
                        }
                        const r = e.deletionPosition._getCombined(t.sourcePosition, t.targetPosition);
                        const s = new Zg(n, 1, r, 0);
                        const a = s.getMovedRangeStart().path.slice();
                        a.push(0);
                        const c = new Uh(s.targetPosition.root, a);
                        o = o._getTransformedByMove(n, r, 1);
                        const l = new Zg(o, e.howMany, c, 0);
                        i.push(s);
                        i.push(l);
                        return i
                    }
                } else {
                    if (t.howMany == 1) {
                        if (!i.bWasUndone) {
                            return [new Sm(0)]
                        } else {
                            t.sourcePosition = e.graveyardPosition.clone();
                            t.targetPosition = t.targetPosition._getTransformedByMergeOperation(e);
                            return [t]
                        }
                    }
                }
            }
            const o = $h._createFromPositionAndShift(t.sourcePosition, t.howMany);
            const r = o._getTransformedByMergeOperation(e);
            t.sourcePosition = r.start;
            t.howMany = r.end.offset - r.start.offset;
            t.targetPosition = t.targetPosition._getTransformedByMergeOperation(e);
            return [t]
        });
        XO(im, tm, (t, e) => {
            t.position = t.position._getTransformedByInsertOperation(e);
            return [t]
        });
        XO(im, om, (t, e) => {
            if (t.position.isEqual(e.deletionPosition)) {
                t.position = e.graveyardPosition.clone();
                t.position.stickiness = "toNext";
                return [t]
            }
            t.position = t.position._getTransformedByMergeOperation(e);
            return [t]
        });
        XO(im, Zg, (t, e) => {
            t.position = t.position._getTransformedByMoveOperation(e);
            return [t]
        });
        XO(im, im, (t, e, i) => {
            if (t.position.isEqual(e.position)) {
                if (i.aIsStrong) {
                    t.oldName = e.newName
                } else {
                    return [new Sm(0)]
                }
            }
            return [t]
        });
        XO(im, rm, (t, e) => {
            const i = t.position.path;
            const n = e.splitPosition.getParentPath();
            if (Vs(i, n) == "same" && !e.graveyardPosition) {
                const e = new im(t.position.getShiftedBy(1), t.oldName, t.newName, 0);
                return [t, e]
            }
            t.position = t.position._getTransformedBySplitOperation(e);
            return [t]
        });
        XO(nm, nm, (t, e, i) => {
            if (t.root === e.root && t.key === e.key) {
                if (!i.aIsStrong || t.newValue === e.newValue) {
                    return [new Sm(0)]
                } else {
                    t.oldValue = e.newValue
                }
            }
            return [t]
        });
        XO(rm, tm, (t, e) => {
            if (t.splitPosition.hasSameParentAs(e.position) && t.splitPosition.offset < e.position.offset) {
                t.howMany += e.howMany
            }
            t.splitPosition = t.splitPosition._getTransformedByInsertOperation(e);
            t.insertionPosition = rm.getInsertionPosition(t.splitPosition);
            return [t]
        });
        XO(rm, om, (t, e, i) => {
            if (!t.graveyardPosition && !i.bWasUndone && t.splitPosition.hasSameParentAs(e.sourcePosition)) {
                const i = e.graveyardPosition.path.slice();
                i.push(0);
                const n = new Uh(e.graveyardPosition.root, i);
                const o = rm.getInsertionPosition(new Uh(e.graveyardPosition.root, i));
                const r = new rm(n, 0, null, 0);
                r.insertionPosition = o;
                t.splitPosition = t.splitPosition._getTransformedByMergeOperation(e);
                t.insertionPosition = rm.getInsertionPosition(t.splitPosition);
                t.graveyardPosition = r.insertionPosition.clone();
                t.graveyardPosition.stickiness = "toNext";
                return [r, t]
            }
            if (t.splitPosition.hasSameParentAs(e.deletionPosition) && !t.splitPosition.isAfter(e.deletionPosition)) {
                t.howMany--
            }
            if (t.splitPosition.hasSameParentAs(e.targetPosition)) {
                t.howMany += e.howMany
            }
            t.splitPosition = t.splitPosition._getTransformedByMergeOperation(e);
            t.insertionPosition = rm.getInsertionPosition(t.splitPosition);
            if (t.graveyardPosition) {
                t.graveyardPosition = t.graveyardPosition._getTransformedByMergeOperation(e)
            }
            return [t]
        });
        XO(rm, Zg, (t, e, i) => {
            const n = $h._createFromPositionAndShift(e.sourcePosition, e.howMany);
            if (t.graveyardPosition) {
                const o = n.start.isEqual(t.graveyardPosition) || n.containsPosition(t.graveyardPosition);
                if (!i.bWasUndone && o) {
                    const i = t.splitPosition._getTransformedByMoveOperation(e);
                    const n = t.graveyardPosition._getTransformedByMoveOperation(e);
                    const o = n.path.slice();
                    o.push(0);
                    const r = new Uh(n.root, o);
                    const s = new Zg(i, t.howMany, r, 0);
                    return [s]
                }
                t.graveyardPosition = t.graveyardPosition._getTransformedByMoveOperation(e)
            }
            if (t.splitPosition.hasSameParentAs(e.sourcePosition) && n.containsPosition(t.splitPosition)) {
                const i = e.howMany - (t.splitPosition.offset - e.sourcePosition.offset);
                t.howMany -= i;
                if (t.splitPosition.hasSameParentAs(e.targetPosition) && t.splitPosition.offset < e.targetPosition.offset) {
                    t.howMany += e.howMany
                }
                t.splitPosition = e.sourcePosition.clone();
                t.insertionPosition = rm.getInsertionPosition(t.splitPosition);
                return [t]
            }
            const o = t.splitPosition.isEqual(e.targetPosition);
            if (o && (i.baRelation == "insertAtSource" || i.abRelation == "splitBefore")) {
                t.howMany += e.howMany;
                t.splitPosition = t.splitPosition._getTransformedByDeletion(e.sourcePosition, e.howMany);
                t.insertionPosition = rm.getInsertionPosition(t.splitPosition);
                return [t]
            }
            if (!e.sourcePosition.isEqual(e.targetPosition)) {
                if (t.splitPosition.hasSameParentAs(e.sourcePosition) && t.splitPosition.offset <= e.sourcePosition.offset) {
                    t.howMany -= e.howMany
                }
                if (t.splitPosition.hasSameParentAs(e.targetPosition) && t.splitPosition.offset < e.targetPosition.offset) {
                    t.howMany += e.howMany
                }
            }
            t.splitPosition.stickiness = "toNone";
            t.splitPosition = t.splitPosition._getTransformedByMoveOperation(e);
            t.splitPosition.stickiness = "toNext";
            if (t.graveyardPosition) {
                t.insertionPosition = t.insertionPosition._getTransformedByMoveOperation(e)
            } else {
                t.insertionPosition = rm.getInsertionPosition(t.splitPosition)
            }
            return [t]
        });
        XO(rm, rm, (t, e, i) => {
            if (t.splitPosition.isEqual(e.splitPosition)) {
                if (!t.graveyardPosition && !e.graveyardPosition) {
                    return [new Sm(0)]
                }
                if (t.graveyardPosition && e.graveyardPosition && t.graveyardPosition.isEqual(e.graveyardPosition)) {
                    return [new Sm(0)]
                }
                if (i.abRelation == "splitBefore") {
                    t.howMany = 0;
                    t.graveyardPosition = t.graveyardPosition._getTransformedBySplitOperation(e);
                    return [t]
                }
            }
            if (t.graveyardPosition && e.graveyardPosition && t.graveyardPosition.isEqual(e.graveyardPosition)) {
                const n = t.splitPosition.root.rootName == "$graveyard";
                const o = e.splitPosition.root.rootName == "$graveyard";
                const r = n && !o;
                const s = o && !n;
                const a = s || !r && i.aIsStrong;
                if (a) {
                    const i = [];
                    if (e.howMany) {
                        i.push(new Zg(e.moveTargetPosition, e.howMany, e.splitPosition, 0))
                    }
                    if (t.howMany) {
                        i.push(new Zg(t.splitPosition, t.howMany, t.moveTargetPosition, 0))
                    }
                    return i
                } else {
                    return [new Sm(0)]
                }
            }
            if (t.graveyardPosition) {
                t.graveyardPosition = t.graveyardPosition._getTransformedBySplitOperation(e)
            }
            if (t.splitPosition.isEqual(e.insertionPosition) && i.abRelation == "splitBefore") {
                t.howMany++;
                return [t]
            }
            if (e.splitPosition.isEqual(t.insertionPosition) && i.baRelation == "splitBefore") {
                const i = e.insertionPosition.path.slice();
                i.push(0);
                const n = new Uh(e.insertionPosition.root, i);
                const o = new Zg(t.insertionPosition, 1, n, 0);
                return [t, o]
            }
            if (t.splitPosition.hasSameParentAs(e.splitPosition) && t.splitPosition.offset < e.splitPosition.offset) {
                t.howMany -= e.howMany
            }
            t.splitPosition = t.splitPosition._getTransformedBySplitOperation(e);
            t.insertionPosition = rm.getInsertionPosition(t.splitPosition);
            return [t]
        });

        function cI(t, e) {
            return t.targetPosition._getTransformedByDeletion(e.sourcePosition, e.howMany) === null
        }

        function lI(t, e) {
            const i = [];
            for (let n = 0; n < t.length; n++) {
                const o = t[n];
                const r = new Zg(o.start, o.end.offset - o.start.offset, e, 0);
                i.push(r);
                for (let e = n + 1; e < t.length; e++) {
                    t[e] = t[e]._getTransformedByMove(r.sourcePosition, r.targetPosition, r.howMany)[0]
                }
                e = e._getTransformedByMove(r.sourcePosition, r.targetPosition, r.howMany)
            }
            return i
        }

        class dI extends jw {
            constructor(t) {
                super(t);
                this._stack = [];
                this._createdBatches = new WeakSet;
                this.refresh()
            }

            refresh() {
                this.isEnabled = this._stack.length > 0
            }

            addBatch(t) {
                const e = this.editor.model.document.selection;
                const i = {ranges: e.hasOwnRange ? Array.from(e.getRanges()) : [], isBackward: e.isBackward};
                this._stack.push({batch: t, selection: i});
                this.refresh()
            }

            clearStack() {
                this._stack = [];
                this.refresh()
            }

            _restoreSelection(t, e, i) {
                const n = this.editor.model;
                const o = n.document;
                const r = [];
                for (const e of t) {
                    const t = uI(e, i);
                    const n = t.find(t => t.start.root != o.graveyard);
                    if (n) {
                        r.push(n)
                    }
                }
                if (r.length) {
                    n.change(t => {
                        t.setSelection(r, {backward: e})
                    })
                }
            }

            _undo(t, e) {
                const i = this.editor.model;
                const n = i.document;
                this._createdBatches.add(e);
                const o = t.operations.slice().filter(t => t.isDocumentOperation);
                o.reverse();
                for (const t of o) {
                    const o = t.baseVersion + 1;
                    const r = Array.from(n.history.getOperations(o));
                    const s = iI([t.getReversed()], r, {
                        useRelations: true,
                        document: this.editor.model.document,
                        padWithNoOps: false,
                        forceWeakRemove: true
                    });
                    const a = s.operationsA;
                    for (const o of a) {
                        e.addOperation(o);
                        i.applyOperation(o);
                        n.history.setOperationAsUndone(t, o)
                    }
                }
            }
        }

        function uI(t, e) {
            const i = t.getTransformedByOperations(e);
            i.sort((t, e) => t.start.isBefore(e.start) ? -1 : 1);
            for (let t = 1; t < i.length; t++) {
                const e = i[t - 1];
                const n = i[t];
                if (e.end.isTouching(n.start)) {
                    e.end = n.end;
                    i.splice(t, 1);
                    t--
                }
            }
            return i
        }

        class hI extends dI {
            execute(t = null) {
                const e = t ? this._stack.findIndex(e => e.batch == t) : this._stack.length - 1;
                const i = this._stack.splice(e, 1)[0];
                const n = this.editor.model.createBatch("transparent");
                this.editor.model.enqueueChange(n, () => {
                    this._undo(i.batch, n);
                    const t = this.editor.model.document.history.getOperations(i.batch.baseVersion);
                    this._restoreSelection(i.selection.ranges, i.selection.isBackward, t);
                    this.fire("revert", i.batch, n)
                });
                this.refresh()
            }
        }

        class fI extends dI {
            execute() {
                const t = this._stack.pop();
                const e = this.editor.model.createBatch("transparent");
                this.editor.model.enqueueChange(e, () => {
                    const i = t.batch.operations[t.batch.operations.length - 1];
                    const n = i.baseVersion + 1;
                    const o = this.editor.model.document.history.getOperations(n);
                    this._restoreSelection(t.selection.ranges, t.selection.isBackward, o);
                    this._undo(t.batch, e)
                });
                this.refresh()
            }
        }

        class gI extends mp {
            static get pluginName() {
                return "UndoEditing"
            }

            constructor(t) {
                super(t);
                this._batchRegistry = new WeakSet
            }

            init() {
                const t = this.editor;
                this._undoCommand = new hI(t);
                this._redoCommand = new fI(t);
                t.commands.add("undo", this._undoCommand);
                t.commands.add("redo", this._redoCommand);
                this.listenTo(t.model, "applyOperation", (t, e) => {
                    const i = e[0];
                    if (!i.isDocumentOperation) {
                        return
                    }
                    const n = i.batch;
                    const o = this._redoCommand._createdBatches.has(n);
                    const r = this._undoCommand._createdBatches.has(n);
                    const s = this._batchRegistry.has(n);
                    if (s || n.type == "transparent" && !o && !r) {
                        return
                    } else {
                        if (o) {
                            this._undoCommand.addBatch(n)
                        } else if (!r) {
                            this._undoCommand.addBatch(n);
                            this._redoCommand.clearStack()
                        }
                    }
                    this._batchRegistry.add(n)
                }, {priority: "highest"});
                this.listenTo(this._undoCommand, "revert", (t, e, i) => {
                    this._redoCommand.addBatch(i)
                });
                t.keystrokes.set("CTRL+Z", "undo");
                t.keystrokes.set("CTRL+Y", "redo");
                t.keystrokes.set("CTRL+SHIFT+Z", "redo")
            }
        }

        var mI = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.042 9.367l2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>';
        var pI = '<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.958 9.367l-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';

        class bI extends mp {
            init() {
                const t = this.editor;
                const e = t.locale;
                const i = t.t;
                const n = e.uiLanguageDirection == "ltr" ? mI : pI;
                const o = e.uiLanguageDirection == "ltr" ? pI : mI;
                this._addButton("undo", i("mo"), "CTRL+Z", n);
                this._addButton("redo", i("mp"), "CTRL+Y", o)
            }

            _addButton(t, e, i, n) {
                const o = this.editor;
                o.ui.componentFactory.add(t, r => {
                    const s = o.commands.get(t);
                    const a = new hb(r);
                    a.set({label: e, icon: n, keystroke: i, tooltip: true});
                    a.bind("isEnabled").to(s, "isEnabled");
                    this.listenTo(a, "execute", () => {
                        o.execute(t);
                        o.editing.view.focus()
                    });
                    return a
                })
            }
        }

        class wI extends mp {
            static get requires() {
                return [gI, bI]
            }

            static get pluginName() {
                return "Undo"
            }
        }

        class kI extends mp {
            static get requires() {
                return [Rx, qO, YO, cP, wI]
            }

            static get pluginName() {
                return "Essentials"
            }
        }

        class _I extends Fw {
        }

        _I.builtinPlugins = [rk, uk, vk, Sk, r_, p_, A_, R_, W_, bv, cy, fy, Ry, Ky, zx, Wx, vC, PC, tT, zT, WT, wP, CP, vP, kP, yP, _P, xP, RP, BP, HP, DE, lO, dO, IO, LO, kI, V_]
    }])["default"]
}));

},{"../../ru":2}],2:[function(require,module,exports){
module.exports =  {
    a: "Image toolbar",
    b: "",
    c: "leftwards double arrow",
    d: "rightwards double arrow",
    e: "upwards double arrow",
    f: "downwards double arrow",
    g: "leftwards dashed arrow",
    h: "rightwards dashed arrow",
    i: "upwards dashed arrow",
    j: "downwards dashed arrow",
    k: "leftwards arrow to bar",
    l: "rightwards arrow to bar",
    m: "upwards arrow to bar",
    n: "downwards arrow to bar",
    o: "up down arrow with base",
    p: "back with leftwards arrow above",
    q: "end with leftwards arrow above",
    r: "on with exclamation mark with left right arrow above",
    s: "soon with rightwards arrow above",
    t: "top with upwards arrow above",
    u: "Dollar sign",
    v: "Euro sign",
    w: "Yen sign",
    x: "Pound sign",
    y: "Cent sign",
    z: "Euro-currency sign",
    aa: "Colon sign",
    ab: "Cruzeiro sign",
    ac: "French franc sign",
    ad: "Lira sign",
    ae: "Currency sign",
    af: "Bitcoin sign",
    ag: "Mill sign",
    ah: "Naira sign",
    ai: "Peseta sign",
    aj: "Rupee sign",
    ak: "Won sign",
    al: "New sheqel sign",
    am: "Dong sign",
    an: "Kip sign",
    ao: "Tugrik sign",
    ap: "Drachma sign",
    aq: "German penny sign",
    ar: "Peso sign",
    as: "Guarani sign",
    at: "Austral sign",
    au: "Hryvnia sign",
    av: "Cedi sign",
    aw: "Livre tournois sign",
    ax: "Spesmilo sign",
    ay: "Tenge sign",
    az: "Indian rupee sign",
    ba: "Turkish lira sign",
    bb: "Nordic mark sign",
    bc: "Manat sign",
    bd: "Ruble sign",
    be: "Latin capital letter a with macron",
    bf: "Latin small letter a with macron",
    bg: "Latin capital letter a with breve",
    bh: "Latin small letter a with breve",
    bi: "Latin capital letter a with ogonek",
    bj: "Latin small letter a with ogonek",
    bk: "Latin capital letter c with acute",
    bl: "Latin small letter c with acute",
    bm: "Latin capital letter c with circumflex",
    bn: "Latin small letter c with circumflex",
    bo: "Latin capital letter c with dot above",
    bp: "Latin small letter c with dot above",
    bq: "Latin capital letter c with caron",
    br: "Latin small letter c with caron",
    bs: "Latin capital letter d with caron",
    bt: "Latin small letter d with caron",
    bu: "Latin capital letter d with stroke",
    bv: "Latin small letter d with stroke",
    bw: "Latin capital letter e with macron",
    bx: "Latin small letter e with macron",
    by: "Latin capital letter e with breve",
    bz: "Latin small letter e with breve",
    ca: "Latin capital letter e with dot above",
    cb: "Latin small letter e with dot above",
    cc: "Latin capital letter e with ogonek",
    cd: "Latin small letter e with ogonek",
    ce: "Latin capital letter e with caron",
    cf: "Latin small letter e with caron",
    cg: "Latin capital letter g with circumflex",
    ch: "Latin small letter g with circumflex",
    ci: "Latin capital letter g with breve",
    cj: "Latin small letter g with breve",
    ck: "Latin capital letter g with dot above",
    cl: "Latin small letter g with dot above",
    cm: "Latin capital letter g with cedilla",
    cn: "Latin small letter g with cedilla",
    co: "Latin capital letter h with circumflex",
    cp: "Latin small letter h with circumflex",
    cq: "Latin capital letter h with stroke",
    cr: "Latin small letter h with stroke",
    cs: "Latin capital letter i with tilde",
    ct: "Latin small letter i with tilde",
    cu: "Latin capital letter i with macron",
    cv: "Latin small letter i with macron",
    cw: "Latin capital letter i with breve",
    cx: "Latin small letter i with breve",
    cy: "Latin capital letter i with ogonek",
    cz: "Latin small letter i with ogonek",
    da: "Latin capital letter i with dot above",
    db: "Latin small letter dotless i",
    dc: "Latin capital ligature ij",
    dd: "Latin small ligature ij",
    de: "Latin capital letter j with circumflex",
    df: "Latin small letter j with circumflex",
    dg: "Latin capital letter k with cedilla",
    dh: "Latin small letter k with cedilla",
    di: "Latin small letter kra",
    dj: "Latin capital letter l with acute",
    dk: "Latin small letter l with acute",
    dl: "Latin capital letter l with cedilla",
    dm: "Latin small letter l with cedilla",
    dn: "Latin capital letter l with caron",
    do: "Latin small letter l with caron",
    dp: "Latin capital letter l with middle dot",
    dq: "Latin small letter l with middle dot",
    dr: "Latin capital letter l with stroke",
    ds: "Latin small letter l with stroke",
    dt: "Latin capital letter n with acute",
    du: "Latin small letter n with acute",
    dv: "Latin capital letter n with cedilla",
    dw: "Latin small letter n with cedilla",
    dx: "Latin capital letter n with caron",
    dy: "Latin small letter n with caron",
    dz: "Latin small letter n preceded by apostrophe",
    ea: "Latin capital letter eng",
    eb: "Latin small letter eng",
    ec: "Latin capital letter o with macron",
    ed: "Latin small letter o with macron",
    ee: "Latin capital letter o with breve",
    ef: "Latin small letter o with breve",
    eg: "Latin capital letter o with double acute",
    eh: "Latin small letter o with double acute",
    ei: "Latin capital ligature oe",
    ej: "Latin small ligature oe",
    ek: "Latin capital letter r with acute",
    el: "Latin small letter r with acute",
    em: "Latin capital letter r with cedilla",
    en: "Latin small letter r with cedilla",
    eo: "Latin capital letter r with caron",
    ep: "Latin small letter r with caron",
    eq: "Latin capital letter s with acute",
    er: "Latin small letter s with acute",
    es: "Latin capital letter s with circumflex",
    et: "Latin small letter s with circumflex",
    eu: "Latin capital letter s with cedilla",
    ev: "Latin small letter s with cedilla",
    ew: "Latin capital letter s with caron",
    ex: "Latin small letter s with caron",
    ey: "Latin capital letter t with cedilla",
    ez: "Latin small letter t with cedilla",
    fa: "Latin capital letter t with caron",
    fb: "Latin small letter t with caron",
    fc: "Latin capital letter t with stroke",
    fd: "Latin small letter t with stroke",
    fe: "Latin capital letter u with tilde",
    ff: "Latin small letter u with tilde",
    fg: "Latin capital letter u with macron",
    fh: "Latin small letter u with macron",
    fi: "Latin capital letter u with breve",
    fj: "Latin small letter u with breve",
    fk: "Latin capital letter u with ring above",
    fl: "Latin small letter u with ring above",
    fm: "Latin capital letter u with double acute",
    fn: "Latin small letter u with double acute",
    fo: "Latin capital letter u with ogonek",
    fp: "Latin small letter u with ogonek",
    fq: "Latin capital letter w with circumflex",
    fr: "Latin small letter w with circumflex",
    fs: "Latin capital letter y with circumflex",
    ft: "Latin small letter y with circumflex",
    fu: "Latin capital letter y with diaeresis",
    fv: "Latin capital letter z with acute",
    fw: "Latin small letter z with acute",
    fx: "Latin capital letter z with dot above",
    fy: "Latin small letter z with dot above",
    fz: "Latin capital letter z with caron",
    ga: "Latin small letter z with caron",
    gb: "Latin small letter long s",
    gc: "Less-than sign",
    gd: "Greater-than sign",
    ge: "Less-than or equal to",
    gf: "Greater-than or equal to",
    gg: "En dash",
    gh: "Em dash",
    gi: "Macron",
    gj: "Overline",
    gk: "Degree sign",
    gl: "Minus sign",
    gm: "Plus-minus sign",
    gn: "Division sign",
    go: "Fraction slash",
    gp: "Multiplication sign",
    gq: "Latin small letter f with hook",
    gr: "Integral",
    gs: "N-ary summation",
    gt: "Infinity",
    gu: "Square root",
    gv: "Tilde operator",
    gw: "Approximately equal to",
    gx: "Almost equal to",
    gy: "Not equal to",
    gz: "Identical to",
    ha: "Element of",
    hb: "Not an element of",
    hc: "Contains as member",
    hd: "N-ary product",
    he: "Logical and",
    hf: "Logical or",
    hg: "Not sign",
    hh: "Intersection",
    hi: "Union",
    hj: "Partial differential",
    hk: "For all",
    hl: "There exists",
    hm: "Empty set",
    hn: "Nabla",
    ho: "Asterisk operator",
    hp: "Proportional to",
    hq: "Angle",
    hr: "Vulgar fraction one quarter",
    hs: "Vulgar fraction one half",
    ht: "Vulgar fraction three quarters",
    hu: "Single left-pointing angle quotation mark",
    hv: "Single right-pointing angle quotation mark",
    hw: "Left-pointing double angle quotation mark",
    hx: "Right-pointing double angle quotation mark",
    hy: "Left single quotation mark",
    hz: "Right single quotation mark",
    ia: "Left double quotation mark",
    ib: "Right double quotation mark",
    ic: "Single low-9 quotation mark",
    id: "Double low-9 quotation mark",
    ie: "Inverted exclamation mark",
    if: "Inverted question mark",
    ig: "Two dot leader",
    ih: "Horizontal ellipsis",
    ii: "Double dagger",
    ij: "Per mille sign",
    ik: "Per ten thousand sign",
    il: "Double exclamation mark",
    im: "Question exclamation mark",
    in: "Exclamation question mark",
    io: "Double question mark",
    ip: "Copyright sign",
    iq: "Registered sign",
    ir: "Trade mark sign",
    is: "Section sign",
    it: "Paragraph sign",
    iu: "Reversed paragraph sign",
    iv: "Table toolbar",
    iw: "   ",
    ix: "   ",
    iy: "  ",
    iz: "  ",
    ja: " ",
    jb: "",
    jc: "",
    jd: " ",
    je: "",
    jf: " ",
    jg: " ",
    jh: " ",
    ji: "",
    jj: "",
    jk: "",
    jl: "",
    jm: "",
    jn: "",
    jo: " ",
    jp: " ",
    jq: " ",
    jr: " ",
    js: "",
    jt: "",
    ju: " ",
    jv: " ",
    jw: " ",
    jx: " ",
    jy: "  ",
    jz: " ",
    ka: "   ",
    kb: "  ",
    kc: "   ",
    kd: " ",
    ke: "  ",
    kf: "Widget toolbar",
    kg: " ",
    kh: " ",
    ki: " ",
    kj: " ",
    kk: "  ",
    kl: "  ",
    km: " ",
    kn: "",
    ko: " ",
    kp: "  ",
    kq: "  ",
    kr: " ",
    ks: "",
    kt: "   ",
    ku: "   ",
    kv: "   ",
    kw: "   ",
    kx: "  ",
    ky: "  ",
    kz: " ",
    la: " ",
    lb: " ",
    lc: " ",
    ld: " ",
    le: "Character categories",
    lf: "",
    lg: "Dropdown toolbar",
    lh: "  ",
    li: " ",
    lj: " ",
    lk: " ",
    ll: " ",
    lm: "    ",
    ln: "      URL",
    lo: "",
    lp: "",
    lq: " URL",
    lr: "Editor toolbar",
    ls: " ",
    lt: " ",
    lu: "%0 of %1",
    lv: "Previous",
    lw: "Next",
    lx: "",
    ly: "-",
    lz: "",
    ma: "-",
    mb: "",
    mc: "",
    md: "",
    me: "",
    mf: "",
    mg: "",
    mh: "",
    mi: "",
    mj: "",
    mk: "",
    ml: "",
    mm: "Open in a new tab",
    mn: "Downloadable",
    mo: "",
    mp: "",
    mq: "",
    mr: "",
    ms: "",
    mt: "",
    mu: "",
    mv: "Groove",
    mw: "Ridge",
    mx: "Inset",
    my: "Outset",
    mz: 'The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".',
    na: 'The value is invalid. Try "10px" or "2em" or simply "2".',
    nb: "",
    nc: "",
    nd: "",
    ne: "",
    nf: " ",
    ng: "",
    nh: "",
    ni: "",
    nj: "  ",
    nk: "Horizontal text alignment toolbar",
    nl: "Vertical text alignment toolbar",
    nm: "Align cell text to the left",
    nn: "Align cell text to the center",
    no: "Align cell text to the right",
    np: "Justify cell text",
    nq: "Align cell text to the top",
    nr: "Align cell text to the middle",
    ns: "Align cell text to the bottom",
    nt: "",
    nu: "",
    nv: "  ",
    nw: " ",
    nx: "  ",
    ny: "",
    nz: " 1",
    oa: " 2",
    ob: " 3",
    oc: " 4",
    od: " 5",
    oe: " 6",
    of: ", %0"
};
},{}],3:[function(require,module,exports){
var css = ".container,\n.container-fluid {\n  margin-right: auto;\n  margin-left: auto;\n}\n.container-fluid {\n  padding-right: 2rem;\n  padding-left: 2rem;\n}\n.row {\n  box-sizing: border-box;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-flex: 0;\n  -ms-flex: 0 1 auto;\n  flex: 0 1 auto;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: row;\n  flex-direction: row;\n  -ms-flex-wrap: wrap;\n  flex-wrap: wrap;\n  margin-right: -.5rem;\n  margin-left: -.5rem;\n}\n.row.reverse {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n  -ms-flex-direction: row-reverse;\n  flex-direction: row-reverse;\n}\n.col.reverse {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n  -ms-flex-direction: column-reverse;\n  flex-direction: column-reverse;\n}\n.col-xs,\n.col-xs-1,\n.col-xs-10,\n.col-xs-11,\n.col-xs-12,\n.col-xs-2,\n.col-xs-3,\n.col-xs-4,\n.col-xs-5,\n.col-xs-6,\n.col-xs-7,\n.col-xs-8,\n.col-xs-9,\n.col-xs-offset-0,\n.col-xs-offset-1,\n.col-xs-offset-10,\n.col-xs-offset-11,\n.col-xs-offset-12,\n.col-xs-offset-2,\n.col-xs-offset-3,\n.col-xs-offset-4,\n.col-xs-offset-5,\n.col-xs-offset-6,\n.col-xs-offset-7,\n.col-xs-offset-8,\n.col-xs-offset-9 {\n  box-sizing: border-box;\n  -webkit-box-flex: 0;\n  -ms-flex: 0 0 auto;\n  flex: 0 0 auto;\n  padding-right: .5rem;\n  padding-left: .5rem;\n}\n.col-xs {\n  -webkit-box-flex: 1;\n  -ms-flex-positive: 1;\n  flex-grow: 1;\n  -ms-flex-preferred-size: 0;\n  flex-basis: 0;\n  max-width: 100%;\n}\n.col-xs-1 {\n  -ms-flex-preferred-size: 8.33333333%;\n  flex-basis: 8.33333333%;\n  max-width: 8.33333333%;\n}\n.col-xs-2 {\n  -ms-flex-preferred-size: 16.66666667%;\n  flex-basis: 16.66666667%;\n  max-width: 16.66666667%;\n}\n.col-xs-3 {\n  -ms-flex-preferred-size: 25%;\n  flex-basis: 25%;\n  max-width: 25%;\n}\n.col-xs-4 {\n  -ms-flex-preferred-size: 33.33333333%;\n  flex-basis: 33.33333333%;\n  max-width: 33.33333333%;\n}\n.col-xs-5 {\n  -ms-flex-preferred-size: 41.66666667%;\n  flex-basis: 41.66666667%;\n  max-width: 41.66666667%;\n}\n.col-xs-6 {\n  -ms-flex-preferred-size: 50%;\n  flex-basis: 50%;\n  max-width: 50%;\n}\n.col-xs-7 {\n  -ms-flex-preferred-size: 58.33333333%;\n  flex-basis: 58.33333333%;\n  max-width: 58.33333333%;\n}\n.col-xs-8 {\n  -ms-flex-preferred-size: 66.66666667%;\n  flex-basis: 66.66666667%;\n  max-width: 66.66666667%;\n}\n.col-xs-9 {\n  -ms-flex-preferred-size: 75%;\n  flex-basis: 75%;\n  max-width: 75%;\n}\n.col-xs-10 {\n  -ms-flex-preferred-size: 83.33333333%;\n  flex-basis: 83.33333333%;\n  max-width: 83.33333333%;\n}\n.col-xs-11 {\n  -ms-flex-preferred-size: 91.66666667%;\n  flex-basis: 91.66666667%;\n  max-width: 91.66666667%;\n}\n.col-xs-12 {\n  -ms-flex-preferred-size: 100%;\n  flex-basis: 100%;\n  max-width: 100%;\n}\n.col-xs-offset-0 {\n  margin-left: 0;\n}\n.col-xs-offset-1 {\n  margin-left: 8.33333333%;\n}\n.col-xs-offset-2 {\n  margin-left: 16.66666667%;\n}\n.col-xs-offset-3 {\n  margin-left: 25%;\n}\n.col-xs-offset-4 {\n  margin-left: 33.33333333%;\n}\n.col-xs-offset-5 {\n  margin-left: 41.66666667%;\n}\n.col-xs-offset-6 {\n  margin-left: 50%;\n}\n.col-xs-offset-7 {\n  margin-left: 58.33333333%;\n}\n.col-xs-offset-8 {\n  margin-left: 66.66666667%;\n}\n.col-xs-offset-9 {\n  margin-left: 75%;\n}\n.col-xs-offset-10 {\n  margin-left: 83.33333333%;\n}\n.col-xs-offset-11 {\n  margin-left: 91.66666667%;\n}\n.start-xs {\n  -webkit-box-pack: start;\n  -ms-flex-pack: start;\n  justify-content: flex-start;\n  text-align: start;\n}\n.center-xs {\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  text-align: center;\n}\n.end-xs {\n  -webkit-box-pack: end;\n  -ms-flex-pack: end;\n  justify-content: flex-end;\n  text-align: end;\n}\n.top-xs {\n  -webkit-box-align: start;\n  -ms-flex-align: start;\n  align-items: flex-start;\n}\n.middle-xs {\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n}\n.bottom-xs {\n  -webkit-box-align: end;\n  -ms-flex-align: end;\n  align-items: flex-end;\n}\n.around-xs {\n  -ms-flex-pack: distribute;\n  justify-content: space-around;\n}\n.between-xs {\n  -webkit-box-pack: justify;\n  -ms-flex-pack: justify;\n  justify-content: space-between;\n}\n.first-xs {\n  -webkit-box-ordinal-group: 0;\n  -ms-flex-order: -1;\n  order: -1;\n}\n.last-xs {\n  -webkit-box-ordinal-group: 2;\n  -ms-flex-order: 1;\n  order: 1;\n}\n@media only screen and (min-width:48em) {\n  .container {\n    width: 49rem;\n  }\n\n  .col-sm,\n  .col-sm-1,\n  .col-sm-10,\n  .col-sm-11,\n  .col-sm-12,\n  .col-sm-2,\n  .col-sm-3,\n  .col-sm-4,\n  .col-sm-5,\n  .col-sm-6,\n  .col-sm-7,\n  .col-sm-8,\n  .col-sm-9,\n  .col-sm-offset-0,\n  .col-sm-offset-1,\n  .col-sm-offset-10,\n  .col-sm-offset-11,\n  .col-sm-offset-12,\n  .col-sm-offset-2,\n  .col-sm-offset-3,\n  .col-sm-offset-4,\n  .col-sm-offset-5,\n  .col-sm-offset-6,\n  .col-sm-offset-7,\n  .col-sm-offset-8,\n  .col-sm-offset-9 {\n    box-sizing: border-box;\n    -webkit-box-flex: 0;\n    -ms-flex: 0 0 auto;\n    flex: 0 0 auto;\n    padding-right: .5rem;\n    padding-left: .5rem;\n  }\n\n  .col-sm {\n    -webkit-box-flex: 1;\n    -ms-flex-positive: 1;\n    flex-grow: 1;\n    -ms-flex-preferred-size: 0;\n    flex-basis: 0;\n    max-width: 100%;\n  }\n\n  .col-sm-1 {\n    -ms-flex-preferred-size: 8.33333333%;\n    flex-basis: 8.33333333%;\n    max-width: 8.33333333%;\n  }\n\n  .col-sm-2 {\n    -ms-flex-preferred-size: 16.66666667%;\n    flex-basis: 16.66666667%;\n    max-width: 16.66666667%;\n  }\n\n  .col-sm-3 {\n    -ms-flex-preferred-size: 25%;\n    flex-basis: 25%;\n    max-width: 25%;\n  }\n\n  .col-sm-4 {\n    -ms-flex-preferred-size: 33.33333333%;\n    flex-basis: 33.33333333%;\n    max-width: 33.33333333%;\n  }\n\n  .col-sm-5 {\n    -ms-flex-preferred-size: 41.66666667%;\n    flex-basis: 41.66666667%;\n    max-width: 41.66666667%;\n  }\n\n  .col-sm-6 {\n    -ms-flex-preferred-size: 50%;\n    flex-basis: 50%;\n    max-width: 50%;\n  }\n\n  .col-sm-7 {\n    -ms-flex-preferred-size: 58.33333333%;\n    flex-basis: 58.33333333%;\n    max-width: 58.33333333%;\n  }\n\n  .col-sm-8 {\n    -ms-flex-preferred-size: 66.66666667%;\n    flex-basis: 66.66666667%;\n    max-width: 66.66666667%;\n  }\n\n  .col-sm-9 {\n    -ms-flex-preferred-size: 75%;\n    flex-basis: 75%;\n    max-width: 75%;\n  }\n\n  .col-sm-10 {\n    -ms-flex-preferred-size: 83.33333333%;\n    flex-basis: 83.33333333%;\n    max-width: 83.33333333%;\n  }\n\n  .col-sm-11 {\n    -ms-flex-preferred-size: 91.66666667%;\n    flex-basis: 91.66666667%;\n    max-width: 91.66666667%;\n  }\n\n  .col-sm-12 {\n    -ms-flex-preferred-size: 100%;\n    flex-basis: 100%;\n    max-width: 100%;\n  }\n\n  .col-sm-offset-0 {\n    margin-left: 0;\n  }\n\n  .col-sm-offset-1 {\n    margin-left: 8.33333333%;\n  }\n\n  .col-sm-offset-2 {\n    margin-left: 16.66666667%;\n  }\n\n  .col-sm-offset-3 {\n    margin-left: 25%;\n  }\n\n  .col-sm-offset-4 {\n    margin-left: 33.33333333%;\n  }\n\n  .col-sm-offset-5 {\n    margin-left: 41.66666667%;\n  }\n\n  .col-sm-offset-6 {\n    margin-left: 50%;\n  }\n\n  .col-sm-offset-7 {\n    margin-left: 58.33333333%;\n  }\n\n  .col-sm-offset-8 {\n    margin-left: 66.66666667%;\n  }\n\n  .col-sm-offset-9 {\n    margin-left: 75%;\n  }\n\n  .col-sm-offset-10 {\n    margin-left: 83.33333333%;\n  }\n\n  .col-sm-offset-11 {\n    margin-left: 91.66666667%;\n  }\n\n  .start-sm {\n    -webkit-box-pack: start;\n    -ms-flex-pack: start;\n    justify-content: flex-start;\n    text-align: start;\n  }\n\n  .center-sm {\n    -webkit-box-pack: center;\n    -ms-flex-pack: center;\n    justify-content: center;\n    text-align: center;\n  }\n\n  .end-sm {\n    -webkit-box-pack: end;\n    -ms-flex-pack: end;\n    justify-content: flex-end;\n    text-align: end;\n  }\n\n  .top-sm {\n    -webkit-box-align: start;\n    -ms-flex-align: start;\n    align-items: flex-start;\n  }\n\n  .middle-sm {\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n  }\n\n  .bottom-sm {\n    -webkit-box-align: end;\n    -ms-flex-align: end;\n    align-items: flex-end;\n  }\n\n  .around-sm {\n    -ms-flex-pack: distribute;\n    justify-content: space-around;\n  }\n\n  .between-sm {\n    -webkit-box-pack: justify;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n  }\n\n  .first-sm {\n    -webkit-box-ordinal-group: 0;\n    -ms-flex-order: -1;\n    order: -1;\n  }\n\n  .last-sm {\n    -webkit-box-ordinal-group: 2;\n    -ms-flex-order: 1;\n    order: 1;\n  }\n}\n@media only screen and (min-width:64em) {\n  .container {\n    width: 65rem;\n  }\n\n  .col-md,\n  .col-md-1,\n  .col-md-10,\n  .col-md-11,\n  .col-md-12,\n  .col-md-2,\n  .col-md-3,\n  .col-md-4,\n  .col-md-5,\n  .col-md-6,\n  .col-md-7,\n  .col-md-8,\n  .col-md-9,\n  .col-md-offset-0,\n  .col-md-offset-1,\n  .col-md-offset-10,\n  .col-md-offset-11,\n  .col-md-offset-12,\n  .col-md-offset-2,\n  .col-md-offset-3,\n  .col-md-offset-4,\n  .col-md-offset-5,\n  .col-md-offset-6,\n  .col-md-offset-7,\n  .col-md-offset-8,\n  .col-md-offset-9 {\n    box-sizing: border-box;\n    -webkit-box-flex: 0;\n    -ms-flex: 0 0 auto;\n    flex: 0 0 auto;\n    padding-right: .5rem;\n    padding-left: .5rem;\n  }\n\n  .col-md {\n    -webkit-box-flex: 1;\n    -ms-flex-positive: 1;\n    flex-grow: 1;\n    -ms-flex-preferred-size: 0;\n    flex-basis: 0;\n    max-width: 100%;\n  }\n\n  .col-md-1 {\n    -ms-flex-preferred-size: 8.33333333%;\n    flex-basis: 8.33333333%;\n    max-width: 8.33333333%;\n  }\n\n  .col-md-2 {\n    -ms-flex-preferred-size: 16.66666667%;\n    flex-basis: 16.66666667%;\n    max-width: 16.66666667%;\n  }\n\n  .col-md-3 {\n    -ms-flex-preferred-size: 25%;\n    flex-basis: 25%;\n    max-width: 25%;\n  }\n\n  .col-md-4 {\n    -ms-flex-preferred-size: 33.33333333%;\n    flex-basis: 33.33333333%;\n    max-width: 33.33333333%;\n  }\n\n  .col-md-5 {\n    -ms-flex-preferred-size: 41.66666667%;\n    flex-basis: 41.66666667%;\n    max-width: 41.66666667%;\n  }\n\n  .col-md-6 {\n    -ms-flex-preferred-size: 50%;\n    flex-basis: 50%;\n    max-width: 50%;\n  }\n\n  .col-md-7 {\n    -ms-flex-preferred-size: 58.33333333%;\n    flex-basis: 58.33333333%;\n    max-width: 58.33333333%;\n  }\n\n  .col-md-8 {\n    -ms-flex-preferred-size: 66.66666667%;\n    flex-basis: 66.66666667%;\n    max-width: 66.66666667%;\n  }\n\n  .col-md-9 {\n    -ms-flex-preferred-size: 75%;\n    flex-basis: 75%;\n    max-width: 75%;\n  }\n\n  .col-md-10 {\n    -ms-flex-preferred-size: 83.33333333%;\n    flex-basis: 83.33333333%;\n    max-width: 83.33333333%;\n  }\n\n  .col-md-11 {\n    -ms-flex-preferred-size: 91.66666667%;\n    flex-basis: 91.66666667%;\n    max-width: 91.66666667%;\n  }\n\n  .col-md-12 {\n    -ms-flex-preferred-size: 100%;\n    flex-basis: 100%;\n    max-width: 100%;\n  }\n\n  .col-md-offset-0 {\n    margin-left: 0;\n  }\n\n  .col-md-offset-1 {\n    margin-left: 8.33333333%;\n  }\n\n  .col-md-offset-2 {\n    margin-left: 16.66666667%;\n  }\n\n  .col-md-offset-3 {\n    margin-left: 25%;\n  }\n\n  .col-md-offset-4 {\n    margin-left: 33.33333333%;\n  }\n\n  .col-md-offset-5 {\n    margin-left: 41.66666667%;\n  }\n\n  .col-md-offset-6 {\n    margin-left: 50%;\n  }\n\n  .col-md-offset-7 {\n    margin-left: 58.33333333%;\n  }\n\n  .col-md-offset-8 {\n    margin-left: 66.66666667%;\n  }\n\n  .col-md-offset-9 {\n    margin-left: 75%;\n  }\n\n  .col-md-offset-10 {\n    margin-left: 83.33333333%;\n  }\n\n  .col-md-offset-11 {\n    margin-left: 91.66666667%;\n  }\n\n  .start-md {\n    -webkit-box-pack: start;\n    -ms-flex-pack: start;\n    justify-content: flex-start;\n    text-align: start;\n  }\n\n  .center-md {\n    -webkit-box-pack: center;\n    -ms-flex-pack: center;\n    justify-content: center;\n    text-align: center;\n  }\n\n  .end-md {\n    -webkit-box-pack: end;\n    -ms-flex-pack: end;\n    justify-content: flex-end;\n    text-align: end;\n  }\n\n  .top-md {\n    -webkit-box-align: start;\n    -ms-flex-align: start;\n    align-items: flex-start;\n  }\n\n  .middle-md {\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n  }\n\n  .bottom-md {\n    -webkit-box-align: end;\n    -ms-flex-align: end;\n    align-items: flex-end;\n  }\n\n  .around-md {\n    -ms-flex-pack: distribute;\n    justify-content: space-around;\n  }\n\n  .between-md {\n    -webkit-box-pack: justify;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n  }\n\n  .first-md {\n    -webkit-box-ordinal-group: 0;\n    -ms-flex-order: -1;\n    order: -1;\n  }\n\n  .last-md {\n    -webkit-box-ordinal-group: 2;\n    -ms-flex-order: 1;\n    order: 1;\n  }\n}\n@media only screen and (min-width:75em) {\n  .container {\n    width: 76rem;\n  }\n\n  .col-lg,\n  .col-lg-1,\n  .col-lg-10,\n  .col-lg-11,\n  .col-lg-12,\n  .col-lg-2,\n  .col-lg-3,\n  .col-lg-4,\n  .col-lg-5,\n  .col-lg-6,\n  .col-lg-7,\n  .col-lg-8,\n  .col-lg-9,\n  .col-lg-offset-0,\n  .col-lg-offset-1,\n  .col-lg-offset-10,\n  .col-lg-offset-11,\n  .col-lg-offset-12,\n  .col-lg-offset-2,\n  .col-lg-offset-3,\n  .col-lg-offset-4,\n  .col-lg-offset-5,\n  .col-lg-offset-6,\n  .col-lg-offset-7,\n  .col-lg-offset-8,\n  .col-lg-offset-9 {\n    box-sizing: border-box;\n    -webkit-box-flex: 0;\n    -ms-flex: 0 0 auto;\n    flex: 0 0 auto;\n    padding-right: .5rem;\n    padding-left: .5rem;\n  }\n\n  .col-lg {\n    -webkit-box-flex: 1;\n    -ms-flex-positive: 1;\n    flex-grow: 1;\n    -ms-flex-preferred-size: 0;\n    flex-basis: 0;\n    max-width: 100%;\n  }\n\n  .col-lg-1 {\n    -ms-flex-preferred-size: 8.33333333%;\n    flex-basis: 8.33333333%;\n    max-width: 8.33333333%;\n  }\n\n  .col-lg-2 {\n    -ms-flex-preferred-size: 16.66666667%;\n    flex-basis: 16.66666667%;\n    max-width: 16.66666667%;\n  }\n\n  .col-lg-3 {\n    -ms-flex-preferred-size: 25%;\n    flex-basis: 25%;\n    max-width: 25%;\n  }\n\n  .col-lg-4 {\n    -ms-flex-preferred-size: 33.33333333%;\n    flex-basis: 33.33333333%;\n    max-width: 33.33333333%;\n  }\n\n  .col-lg-5 {\n    -ms-flex-preferred-size: 41.66666667%;\n    flex-basis: 41.66666667%;\n    max-width: 41.66666667%;\n  }\n\n  .col-lg-6 {\n    -ms-flex-preferred-size: 50%;\n    flex-basis: 50%;\n    max-width: 50%;\n  }\n\n  .col-lg-7 {\n    -ms-flex-preferred-size: 58.33333333%;\n    flex-basis: 58.33333333%;\n    max-width: 58.33333333%;\n  }\n\n  .col-lg-8 {\n    -ms-flex-preferred-size: 66.66666667%;\n    flex-basis: 66.66666667%;\n    max-width: 66.66666667%;\n  }\n\n  .col-lg-9 {\n    -ms-flex-preferred-size: 75%;\n    flex-basis: 75%;\n    max-width: 75%;\n  }\n\n  .col-lg-10 {\n    -ms-flex-preferred-size: 83.33333333%;\n    flex-basis: 83.33333333%;\n    max-width: 83.33333333%;\n  }\n\n  .col-lg-11 {\n    -ms-flex-preferred-size: 91.66666667%;\n    flex-basis: 91.66666667%;\n    max-width: 91.66666667%;\n  }\n\n  .col-lg-12 {\n    -ms-flex-preferred-size: 100%;\n    flex-basis: 100%;\n    max-width: 100%;\n  }\n\n  .col-lg-offset-0 {\n    margin-left: 0;\n  }\n\n  .col-lg-offset-1 {\n    margin-left: 8.33333333%;\n  }\n\n  .col-lg-offset-2 {\n    margin-left: 16.66666667%;\n  }\n\n  .col-lg-offset-3 {\n    margin-left: 25%;\n  }\n\n  .col-lg-offset-4 {\n    margin-left: 33.33333333%;\n  }\n\n  .col-lg-offset-5 {\n    margin-left: 41.66666667%;\n  }\n\n  .col-lg-offset-6 {\n    margin-left: 50%;\n  }\n\n  .col-lg-offset-7 {\n    margin-left: 58.33333333%;\n  }\n\n  .col-lg-offset-8 {\n    margin-left: 66.66666667%;\n  }\n\n  .col-lg-offset-9 {\n    margin-left: 75%;\n  }\n\n  .col-lg-offset-10 {\n    margin-left: 83.33333333%;\n  }\n\n  .col-lg-offset-11 {\n    margin-left: 91.66666667%;\n  }\n\n  .start-lg {\n    -webkit-box-pack: start;\n    -ms-flex-pack: start;\n    justify-content: flex-start;\n    text-align: start;\n  }\n\n  .center-lg {\n    -webkit-box-pack: center;\n    -ms-flex-pack: center;\n    justify-content: center;\n    text-align: center;\n  }\n\n  .end-lg {\n    -webkit-box-pack: end;\n    -ms-flex-pack: end;\n    justify-content: flex-end;\n    text-align: end;\n  }\n\n  .top-lg {\n    -webkit-box-align: start;\n    -ms-flex-align: start;\n    align-items: flex-start;\n  }\n\n  .middle-lg {\n    -webkit-box-align: center;\n    -ms-flex-align: center;\n    align-items: center;\n  }\n\n  .bottom-lg {\n    -webkit-box-align: end;\n    -ms-flex-align: end;\n    align-items: flex-end;\n  }\n\n  .around-lg {\n    -ms-flex-pack: distribute;\n    justify-content: space-around;\n  }\n\n  .between-lg {\n    -webkit-box-pack: justify;\n    -ms-flex-pack: justify;\n    justify-content: space-between;\n  }\n\n  .first-lg {\n    -webkit-box-ordinal-group: 0;\n    -ms-flex-order: -1;\n    order: -1;\n  }\n\n  .last-lg {\n    -webkit-box-ordinal-group: 2;\n    -ms-flex-order: 1;\n    order: 1;\n  }\n}\n"; (require("browserify-css").createStyle(css, { "href": "dependencies\\flexboxgrid\\flexboxgrid.min.css" }, { "insertAt": "bottom" })); module.exports = css;
},{"browserify-css":5}],4:[function(require,module,exports){
module.exports = function atoa (a, n) { return Array.prototype.slice.call(a, n); }

},{}],5:[function(require,module,exports){
'use strict';
// For more information about browser field, check out the browser field at https://github.com/substack/browserify-handbook#browser-field.

var styleElementsInsertedAtTop = [];

var insertStyleElement = function(styleElement, options) {
    var head = document.head || document.getElementsByTagName('head')[0];
    var lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];

    options = options || {};
    options.insertAt = options.insertAt || 'bottom';

    if (options.insertAt === 'top') {
        if (!lastStyleElementInsertedAtTop) {
            head.insertBefore(styleElement, head.firstChild);
        } else if (lastStyleElementInsertedAtTop.nextSibling) {
            head.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);
        } else {
            head.appendChild(styleElement);
        }
        styleElementsInsertedAtTop.push(styleElement);
    } else if (options.insertAt === 'bottom') {
        head.appendChild(styleElement);
    } else {
        throw new Error('Invalid value for parameter \'insertAt\'. Must be \'top\' or \'bottom\'.');
    }
};

module.exports = {
    // Create a <link> tag with optional data attributes
    createLink: function(href, attributes) {
        var head = document.head || document.getElementsByTagName('head')[0];
        var link = document.createElement('link');

        link.href = href;
        link.rel = 'stylesheet';

        for (var key in attributes) {
            if ( ! attributes.hasOwnProperty(key)) {
                continue;
            }
            var value = attributes[key];
            link.setAttribute('data-' + key, value);
        }

        head.appendChild(link);
    },
    // Create a <style> tag with optional data attributes
    createStyle: function(cssText, attributes, extraOptions) {
        extraOptions = extraOptions || {};

        var style = document.createElement('style');
        style.type = 'text/css';

        for (var key in attributes) {
            if ( ! attributes.hasOwnProperty(key)) {
                continue;
            }
            var value = attributes[key];
            style.setAttribute('data-' + key, value);
        }

        if (style.sheet) { // for jsdom and IE9+
            style.innerHTML = cssText;
            style.sheet.cssText = cssText;
            insertStyleElement(style, { insertAt: extraOptions.insertAt });
        } else if (style.styleSheet) { // for IE8 and below
            insertStyleElement(style, { insertAt: extraOptions.insertAt });
            style.styleSheet.cssText = cssText;
        } else { // for Chrome, Firefox, and Safari
            style.appendChild(document.createTextNode(cssText));
            insertStyleElement(style, { insertAt: extraOptions.insertAt });
        }
    }
};

},{}],6:[function(require,module,exports){
'use strict';

var ticky = require('ticky');

module.exports = function debounce (fn, args, ctx) {
  if (!fn) { return; }
  ticky(function run () {
    fn.apply(ctx || null, args || []);
  });
};

},{"ticky":15}],7:[function(require,module,exports){
'use strict';

var atoa = require('atoa');
var debounce = require('./debounce');

module.exports = function emitter (thing, options) {
  var opts = options || {};
  var evt = {};
  if (thing === undefined) { thing = {}; }
  thing.on = function (type, fn) {
    if (!evt[type]) {
      evt[type] = [fn];
    } else {
      evt[type].push(fn);
    }
    return thing;
  };
  thing.once = function (type, fn) {
    fn._once = true; // thing.off(fn) still works!
    thing.on(type, fn);
    return thing;
  };
  thing.off = function (type, fn) {
    var c = arguments.length;
    if (c === 1) {
      delete evt[type];
    } else if (c === 0) {
      evt = {};
    } else {
      var et = evt[type];
      if (!et) { return thing; }
      et.splice(et.indexOf(fn), 1);
    }
    return thing;
  };
  thing.emit = function () {
    var args = atoa(arguments);
    return thing.emitterSnapshot(args.shift()).apply(this, args);
  };
  thing.emitterSnapshot = function (type) {
    var et = (evt[type] || []).slice(0);
    return function () {
      var args = atoa(arguments);
      var ctx = this || thing;
      if (type === 'error' && opts.throws !== false && !et.length) { throw args.length === 1 ? args[0] : args; }
      et.forEach(function emitter (listen) {
        if (opts.async) { debounce(listen, args, ctx); } else { listen.apply(ctx, args); }
        if (listen._once) { thing.off(type, listen); }
      });
      return thing;
    };
  };
  return thing;
};

},{"./debounce":6,"atoa":4}],8:[function(require,module,exports){
(function (global){
'use strict';

var customEvent = require('custom-event');
var eventmap = require('./eventmap');
var doc = global.document;
var addEvent = addEventEasy;
var removeEvent = removeEventEasy;
var hardCache = [];

if (!global.addEventListener) {
  addEvent = addEventHard;
  removeEvent = removeEventHard;
}

module.exports = {
  add: addEvent,
  remove: removeEvent,
  fabricate: fabricateEvent
};

function addEventEasy (el, type, fn, capturing) {
  return el.addEventListener(type, fn, capturing);
}

function addEventHard (el, type, fn) {
  return el.attachEvent('on' + type, wrap(el, type, fn));
}

function removeEventEasy (el, type, fn, capturing) {
  return el.removeEventListener(type, fn, capturing);
}

function removeEventHard (el, type, fn) {
  var listener = unwrap(el, type, fn);
  if (listener) {
    return el.detachEvent('on' + type, listener);
  }
}

function fabricateEvent (el, type, model) {
  var e = eventmap.indexOf(type) === -1 ? makeCustomEvent() : makeClassicEvent();
  if (el.dispatchEvent) {
    el.dispatchEvent(e);
  } else {
    el.fireEvent('on' + type, e);
  }
  function makeClassicEvent () {
    var e;
    if (doc.createEvent) {
      e = doc.createEvent('Event');
      e.initEvent(type, true, true);
    } else if (doc.createEventObject) {
      e = doc.createEventObject();
    }
    return e;
  }
  function makeCustomEvent () {
    return new customEvent(type, { detail: model });
  }
}

function wrapperFactory (el, type, fn) {
  return function wrapper (originalEvent) {
    var e = originalEvent || global.event;
    e.target = e.target || e.srcElement;
    e.preventDefault = e.preventDefault || function preventDefault () { e.returnValue = false; };
    e.stopPropagation = e.stopPropagation || function stopPropagation () { e.cancelBubble = true; };
    e.which = e.which || e.keyCode;
    fn.call(el, e);
  };
}

function wrap (el, type, fn) {
  var wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn);
  hardCache.push({
    wrapper: wrapper,
    element: el,
    type: type,
    fn: fn
  });
  return wrapper;
}

function unwrap (el, type, fn) {
  var i = find(el, type, fn);
  if (i) {
    var wrapper = hardCache[i].wrapper;
    hardCache.splice(i, 1); // free up a tad of memory
    return wrapper;
  }
}

function find (el, type, fn) {
  var i, item;
  for (i = 0; i < hardCache.length; i++) {
    item = hardCache[i];
    if (item.element === el && item.type === type && item.fn === fn) {
      return i;
    }
  }
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./eventmap":9,"custom-event":10}],9:[function(require,module,exports){
(function (global){
'use strict';

var eventmap = [];
var eventname = '';
var ron = /^on/;

for (eventname in global) {
  if (ron.test(eventname)) {
    eventmap.push(eventname.slice(2));
  }
}

module.exports = eventmap;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],10:[function(require,module,exports){
(function (global){

var NativeCustomEvent = global.CustomEvent;

function useNative () {
  try {
    var p = new NativeCustomEvent('cat', { detail: { foo: 'bar' } });
    return  'cat' === p.type && 'bar' === p.detail.foo;
  } catch (e) {
  }
  return false;
}

/**
 * Cross-browser `CustomEvent` constructor.
 *
 * https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent.CustomEvent
 *
 * @public
 */

module.exports = useNative() ? NativeCustomEvent :

// IE >= 9
'function' === typeof document.createEvent ? function CustomEvent (type, params) {
  var e = document.createEvent('CustomEvent');
  if (params) {
    e.initCustomEvent(type, params.bubbles, params.cancelable, params.detail);
  } else {
    e.initCustomEvent(type, false, false, void 0);
  }
  return e;
} :

// IE <= 8
function CustomEvent (type, params) {
  var e = document.createEventObject();
  e.type = type;
  if (params) {
    e.bubbles = Boolean(params.bubbles);
    e.cancelable = Boolean(params.cancelable);
    e.detail = params.detail;
  } else {
    e.bubbles = false;
    e.cancelable = false;
    e.detail = void 0;
  }
  return e;
}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],11:[function(require,module,exports){
'use strict';

var cache = {};
var start = '(?:^|\\s)';
var end = '(?:\\s|$)';

function lookupClass (className) {
  var cached = cache[className];
  if (cached) {
    cached.lastIndex = 0;
  } else {
    cache[className] = cached = new RegExp(start + className + end, 'g');
  }
  return cached;
}

function addClass (el, className) {
  var current = el.className;
  if (!current.length) {
    el.className = className;
  } else if (!lookupClass(className).test(current)) {
    el.className += ' ' + className;
  }
}

function rmClass (el, className) {
  el.className = el.className.replace(lookupClass(className), ' ').trim();
}

module.exports = {
  add: addClass,
  rm: rmClass
};

},{}],12:[function(require,module,exports){
var css = ".gu-mirror {\n  position: fixed!important;\n  margin: 0!important;\n  z-index: 9999!important;\n  opacity: .8;\n  -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=80)\";\n  filter: alpha(opacity=80);\n}\n.gu-hide {\n  display: none!important;\n}\n.gu-unselectable {\n  -webkit-user-select: none!important;\n  -moz-user-select: none!important;\n  -ms-user-select: none!important;\n  user-select: none!important;\n}\n.gu-transit {\n  opacity: .2;\n  -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=20)\";\n  filter: alpha(opacity=20);\n}\n"; (require("browserify-css").createStyle(css, { "href": "node_modules\\dragula\\dist\\dragula.min.css" }, { "insertAt": "bottom" })); module.exports = css;
},{"browserify-css":5}],13:[function(require,module,exports){
(function (global){
'use strict';

var emitter = require('contra/emitter');
var crossvent = require('crossvent');
var classes = require('./classes');
var doc = document;
var documentElement = doc.documentElement;

function dragula (initialContainers, options) {
  var len = arguments.length;
  if (len === 1 && Array.isArray(initialContainers) === false) {
    options = initialContainers;
    initialContainers = [];
  }
  var _mirror; // mirror image
  var _source; // source container
  var _item; // item being dragged
  var _offsetX; // reference x
  var _offsetY; // reference y
  var _moveX; // reference move x
  var _moveY; // reference move y
  var _initialSibling; // reference sibling when grabbed
  var _currentSibling; // reference sibling now
  var _copy; // item used for copying
  var _renderTimer; // timer for setTimeout renderMirrorImage
  var _lastDropTarget = null; // last container item was over
  var _grabbed; // holds mousedown context until first mousemove

  var o = options || {};
  if (o.moves === void 0) { o.moves = always; }
  if (o.accepts === void 0) { o.accepts = always; }
  if (o.invalid === void 0) { o.invalid = invalidTarget; }
  if (o.containers === void 0) { o.containers = initialContainers || []; }
  if (o.isContainer === void 0) { o.isContainer = never; }
  if (o.copy === void 0) { o.copy = false; }
  if (o.copySortSource === void 0) { o.copySortSource = false; }
  if (o.revertOnSpill === void 0) { o.revertOnSpill = false; }
  if (o.removeOnSpill === void 0) { o.removeOnSpill = false; }
  if (o.direction === void 0) { o.direction = 'vertical'; }
  if (o.ignoreInputTextSelection === void 0) { o.ignoreInputTextSelection = true; }
  if (o.mirrorContainer === void 0) { o.mirrorContainer = doc.body; }

  var drake = emitter({
    containers: o.containers,
    start: manualStart,
    end: end,
    cancel: cancel,
    remove: remove,
    destroy: destroy,
    canMove: canMove,
    dragging: false
  });

  if (o.removeOnSpill === true) {
    drake.on('over', spillOver).on('out', spillOut);
  }

  events();

  return drake;

  function isContainer (el) {
    return drake.containers.indexOf(el) !== -1 || o.isContainer(el);
  }

  function events (remove) {
    var op = remove ? 'remove' : 'add';
    touchy(documentElement, op, 'mousedown', grab);
    touchy(documentElement, op, 'mouseup', release);
  }

  function eventualMovements (remove) {
    var op = remove ? 'remove' : 'add';
    touchy(documentElement, op, 'mousemove', startBecauseMouseMoved);
  }

  function movements (remove) {
    var op = remove ? 'remove' : 'add';
    crossvent[op](documentElement, 'selectstart', preventGrabbed); // IE8
    crossvent[op](documentElement, 'click', preventGrabbed);
  }

  function destroy () {
    events(true);
    release({});
  }

  function preventGrabbed (e) {
    if (_grabbed) {
      e.preventDefault();
    }
  }

  function grab (e) {
    _moveX = e.clientX;
    _moveY = e.clientY;

    var ignore = whichMouseButton(e) !== 1 || e.metaKey || e.ctrlKey;
    if (ignore) {
      return; // we only care about honest-to-god left clicks and touch events
    }
    var item = e.target;
    var context = canStart(item);
    if (!context) {
      return;
    }
    _grabbed = context;
    eventualMovements();
    if (e.type === 'mousedown') {
      if (isInput(item)) { // see also: https://github.com/bevacqua/dragula/issues/208
        item.focus(); // fixes https://github.com/bevacqua/dragula/issues/176
      } else {
        e.preventDefault(); // fixes https://github.com/bevacqua/dragula/issues/155
      }
    }
  }

  function startBecauseMouseMoved (e) {
    if (!_grabbed) {
      return;
    }
    if (whichMouseButton(e) === 0) {
      release({});
      return; // when text is selected on an input and then dragged, mouseup doesn't fire. this is our only hope
    }
    // truthy check fixes #239, equality fixes #207
    if (e.clientX !== void 0 && e.clientX === _moveX && e.clientY !== void 0 && e.clientY === _moveY) {
      return;
    }
    if (o.ignoreInputTextSelection) {
      var clientX = getCoord('clientX', e);
      var clientY = getCoord('clientY', e);
      var elementBehindCursor = doc.elementFromPoint(clientX, clientY);
      if (isInput(elementBehindCursor)) {
        return;
      }
    }

    var grabbed = _grabbed; // call to end() unsets _grabbed
    eventualMovements(true);
    movements();
    end();
    start(grabbed);

    var offset = getOffset(_item);
    _offsetX = getCoord('pageX', e) - offset.left;
    _offsetY = getCoord('pageY', e) - offset.top;

    classes.add(_copy || _item, 'gu-transit');
    renderMirrorImage();
    drag(e);
  }

  function canStart (item) {
    if (drake.dragging && _mirror) {
      return;
    }
    if (isContainer(item)) {
      return; // don't drag container itself
    }
    var handle = item;
    while (getParent(item) && isContainer(getParent(item)) === false) {
      if (o.invalid(item, handle)) {
        return;
      }
      item = getParent(item); // drag target should be a top element
      if (!item) {
        return;
      }
    }
    var source = getParent(item);
    if (!source) {
      return;
    }
    if (o.invalid(item, handle)) {
      return;
    }

    var movable = o.moves(item, source, handle, nextEl(item));
    if (!movable) {
      return;
    }

    return {
      item: item,
      source: source
    };
  }

  function canMove (item) {
    return !!canStart(item);
  }

  function manualStart (item) {
    var context = canStart(item);
    if (context) {
      start(context);
    }
  }

  function start (context) {
    if (isCopy(context.item, context.source)) {
      _copy = context.item.cloneNode(true);
      drake.emit('cloned', _copy, context.item, 'copy');
    }

    _source = context.source;
    _item = context.item;
    _initialSibling = _currentSibling = nextEl(context.item);

    drake.dragging = true;
    drake.emit('drag', _item, _source);
  }

  function invalidTarget () {
    return false;
  }

  function end () {
    if (!drake.dragging) {
      return;
    }
    var item = _copy || _item;
    drop(item, getParent(item));
  }

  function ungrab () {
    _grabbed = false;
    eventualMovements(true);
    movements(true);
  }

  function release (e) {
    ungrab();

    if (!drake.dragging) {
      return;
    }
    var item = _copy || _item;
    var clientX = getCoord('clientX', e);
    var clientY = getCoord('clientY', e);
    var elementBehindCursor = getElementBehindPoint(_mirror, clientX, clientY);
    var dropTarget = findDropTarget(elementBehindCursor, clientX, clientY);
    if (dropTarget && ((_copy && o.copySortSource) || (!_copy || dropTarget !== _source))) {
      drop(item, dropTarget);
    } else if (o.removeOnSpill) {
      remove();
    } else {
      cancel();
    }
  }

  function drop (item, target) {
    var parent = getParent(item);
    if (_copy && o.copySortSource && target === _source) {
      parent.removeChild(_item);
    }
    if (isInitialPlacement(target)) {
      drake.emit('cancel', item, _source, _source);
    } else {
      drake.emit('drop', item, target, _source, _currentSibling);
    }
    cleanup();
  }

  function remove () {
    if (!drake.dragging) {
      return;
    }
    var item = _copy || _item;
    var parent = getParent(item);
    if (parent) {
      parent.removeChild(item);
    }
    drake.emit(_copy ? 'cancel' : 'remove', item, parent, _source);
    cleanup();
  }

  function cancel (revert) {
    if (!drake.dragging) {
      return;
    }
    var reverts = arguments.length > 0 ? revert : o.revertOnSpill;
    var item = _copy || _item;
    var parent = getParent(item);
    var initial = isInitialPlacement(parent);
    if (initial === false && reverts) {
      if (_copy) {
        if (parent) {
          parent.removeChild(_copy);
        }
      } else {
        _source.insertBefore(item, _initialSibling);
      }
    }
    if (initial || reverts) {
      drake.emit('cancel', item, _source, _source);
    } else {
      drake.emit('drop', item, parent, _source, _currentSibling);
    }
    cleanup();
  }

  function cleanup () {
    var item = _copy || _item;
    ungrab();
    removeMirrorImage();
    if (item) {
      classes.rm(item, 'gu-transit');
    }
    if (_renderTimer) {
      clearTimeout(_renderTimer);
    }
    drake.dragging = false;
    if (_lastDropTarget) {
      drake.emit('out', item, _lastDropTarget, _source);
    }
    drake.emit('dragend', item);
    _source = _item = _copy = _initialSibling = _currentSibling = _renderTimer = _lastDropTarget = null;
  }

  function isInitialPlacement (target, s) {
    var sibling;
    if (s !== void 0) {
      sibling = s;
    } else if (_mirror) {
      sibling = _currentSibling;
    } else {
      sibling = nextEl(_copy || _item);
    }
    return target === _source && sibling === _initialSibling;
  }

  function findDropTarget (elementBehindCursor, clientX, clientY) {
    var target = elementBehindCursor;
    while (target && !accepted()) {
      target = getParent(target);
    }
    return target;

    function accepted () {
      var droppable = isContainer(target);
      if (droppable === false) {
        return false;
      }

      var immediate = getImmediateChild(target, elementBehindCursor);
      var reference = getReference(target, immediate, clientX, clientY);
      var initial = isInitialPlacement(target, reference);
      if (initial) {
        return true; // should always be able to drop it right back where it was
      }
      return o.accepts(_item, target, _source, reference);
    }
  }

  function drag (e) {
    if (!_mirror) {
      return;
    }
    e.preventDefault();

    var clientX = getCoord('clientX', e);
    var clientY = getCoord('clientY', e);
    var x = clientX - _offsetX;
    var y = clientY - _offsetY;

    _mirror.style.left = x + 'px';
    _mirror.style.top = y + 'px';

    var item = _copy || _item;
    var elementBehindCursor = getElementBehindPoint(_mirror, clientX, clientY);
    var dropTarget = findDropTarget(elementBehindCursor, clientX, clientY);
    var changed = dropTarget !== null && dropTarget !== _lastDropTarget;
    if (changed || dropTarget === null) {
      out();
      _lastDropTarget = dropTarget;
      over();
    }
    var parent = getParent(item);
    if (dropTarget === _source && _copy && !o.copySortSource) {
      if (parent) {
        parent.removeChild(item);
      }
      return;
    }
    var reference;
    var immediate = getImmediateChild(dropTarget, elementBehindCursor);
    if (immediate !== null) {
      reference = getReference(dropTarget, immediate, clientX, clientY);
    } else if (o.revertOnSpill === true && !_copy) {
      reference = _initialSibling;
      dropTarget = _source;
    } else {
      if (_copy && parent) {
        parent.removeChild(item);
      }
      return;
    }
    if (
      (reference === null && changed) ||
      reference !== item &&
      reference !== nextEl(item)
    ) {
      _currentSibling = reference;
      dropTarget.insertBefore(item, reference);
      drake.emit('shadow', item, dropTarget, _source);
    }
    function moved (type) { drake.emit(type, item, _lastDropTarget, _source); }
    function over () { if (changed) { moved('over'); } }
    function out () { if (_lastDropTarget) { moved('out'); } }
  }

  function spillOver (el) {
    classes.rm(el, 'gu-hide');
  }

  function spillOut (el) {
    if (drake.dragging) { classes.add(el, 'gu-hide'); }
  }

  function renderMirrorImage () {
    if (_mirror) {
      return;
    }
    var rect = _item.getBoundingClientRect();
    _mirror = _item.cloneNode(true);
    _mirror.style.width = getRectWidth(rect) + 'px';
    _mirror.style.height = getRectHeight(rect) + 'px';
    classes.rm(_mirror, 'gu-transit');
    classes.add(_mirror, 'gu-mirror');
    o.mirrorContainer.appendChild(_mirror);
    touchy(documentElement, 'add', 'mousemove', drag);
    classes.add(o.mirrorContainer, 'gu-unselectable');
    drake.emit('cloned', _mirror, _item, 'mirror');
  }

  function removeMirrorImage () {
    if (_mirror) {
      classes.rm(o.mirrorContainer, 'gu-unselectable');
      touchy(documentElement, 'remove', 'mousemove', drag);
      getParent(_mirror).removeChild(_mirror);
      _mirror = null;
    }
  }

  function getImmediateChild (dropTarget, target) {
    var immediate = target;
    while (immediate !== dropTarget && getParent(immediate) !== dropTarget) {
      immediate = getParent(immediate);
    }
    if (immediate === documentElement) {
      return null;
    }
    return immediate;
  }

  function getReference (dropTarget, target, x, y) {
    var horizontal = o.direction === 'horizontal';
    var reference = target !== dropTarget ? inside() : outside();
    return reference;

    function outside () { // slower, but able to figure out any position
      var len = dropTarget.children.length;
      var i;
      var el;
      var rect;
      for (i = 0; i < len; i++) {
        el = dropTarget.children[i];
        rect = el.getBoundingClientRect();
        if (horizontal && (rect.left + rect.width / 2) > x) { return el; }
        if (!horizontal && (rect.top + rect.height / 2) > y) { return el; }
      }
      return null;
    }

    function inside () { // faster, but only available if dropped inside a child element
      var rect = target.getBoundingClientRect();
      if (horizontal) {
        return resolve(x > rect.left + getRectWidth(rect) / 2);
      }
      return resolve(y > rect.top + getRectHeight(rect) / 2);
    }

    function resolve (after) {
      return after ? nextEl(target) : target;
    }
  }

  function isCopy (item, container) {
    return typeof o.copy === 'boolean' ? o.copy : o.copy(item, container);
  }
}

function touchy (el, op, type, fn) {
  var touch = {
    mouseup: 'touchend',
    mousedown: 'touchstart',
    mousemove: 'touchmove'
  };
  var pointers = {
    mouseup: 'pointerup',
    mousedown: 'pointerdown',
    mousemove: 'pointermove'
  };
  var microsoft = {
    mouseup: 'MSPointerUp',
    mousedown: 'MSPointerDown',
    mousemove: 'MSPointerMove'
  };
  if (global.navigator.pointerEnabled) {
    crossvent[op](el, pointers[type], fn);
  } else if (global.navigator.msPointerEnabled) {
    crossvent[op](el, microsoft[type], fn);
  } else {
    crossvent[op](el, touch[type], fn);
    crossvent[op](el, type, fn);
  }
}

function whichMouseButton (e) {
  if (e.touches !== void 0) { return e.touches.length; }
  if (e.which !== void 0 && e.which !== 0) { return e.which; } // see https://github.com/bevacqua/dragula/issues/261
  if (e.buttons !== void 0) { return e.buttons; }
  var button = e.button;
  if (button !== void 0) { // see https://github.com/jquery/jquery/blob/99e8ff1baa7ae341e94bb89c3e84570c7c3ad9ea/src/event.js#L573-L575
    return button & 1 ? 1 : button & 2 ? 3 : (button & 4 ? 2 : 0);
  }
}

function getOffset (el) {
  var rect = el.getBoundingClientRect();
  return {
    left: rect.left + getScroll('scrollLeft', 'pageXOffset'),
    top: rect.top + getScroll('scrollTop', 'pageYOffset')
  };
}

function getScroll (scrollProp, offsetProp) {
  if (typeof global[offsetProp] !== 'undefined') {
    return global[offsetProp];
  }
  if (documentElement.clientHeight) {
    return documentElement[scrollProp];
  }
  return doc.body[scrollProp];
}

function getElementBehindPoint (point, x, y) {
  var p = point || {};
  var state = p.className;
  var el;
  p.className += ' gu-hide';
  el = doc.elementFromPoint(x, y);
  p.className = state;
  return el;
}

function never () { return false; }
function always () { return true; }
function getRectWidth (rect) { return rect.width || (rect.right - rect.left); }
function getRectHeight (rect) { return rect.height || (rect.bottom - rect.top); }
function getParent (el) { return el.parentNode === doc ? null : el.parentNode; }
function isInput (el) { return el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.tagName === 'SELECT' || isEditable(el); }
function isEditable (el) {
  if (!el) { return false; } // no parents were editable
  if (el.contentEditable === 'false') { return false; } // stop the lookup
  if (el.contentEditable === 'true') { return true; } // found a contentEditable element in the chain
  return isEditable(getParent(el)); // contentEditable is set to 'inherit'
}

function nextEl (el) {
  return el.nextElementSibling || manually();
  function manually () {
    var sibling = el;
    do {
      sibling = sibling.nextSibling;
    } while (sibling && sibling.nodeType !== 1);
    return sibling;
  }
}

function getEventHost (e) {
  // on touchend event, we have to use `e.changedTouches`
  // see http://stackoverflow.com/questions/7192563/touchend-event-properties
  // see https://github.com/bevacqua/dragula/issues/34
  if (e.targetTouches && e.targetTouches.length) {
    return e.targetTouches[0];
  }
  if (e.changedTouches && e.changedTouches.length) {
    return e.changedTouches[0];
  }
  return e;
}

function getCoord (coord, e) {
  var host = getEventHost(e);
  var missMap = {
    pageX: 'clientX', // IE8
    pageY: 'clientY' // IE8
  };
  if (coord in missMap && !(coord in host) && missMap[coord] in host) {
    coord = missMap[coord];
  }
  return host[coord];
}

module.exports = dragula;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./classes":11,"contra/emitter":7,"crossvent":8}],14:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],15:[function(require,module,exports){
(function (setImmediate){
var si = typeof setImmediate === 'function', tick;
if (si) {
  tick = function (fn) { setImmediate(fn); };
} else {
  tick = function (fn) { setTimeout(fn, 0); };
}

module.exports = tick;
}).call(this,require("timers").setImmediate)

},{"timers":16}],16:[function(require,module,exports){
(function (setImmediate,clearImmediate){
var nextTick = require('process/browser.js').nextTick;
var apply = Function.prototype.apply;
var slice = Array.prototype.slice;
var immediateIds = {};
var nextImmediateId = 0;

// DOM APIs, for completeness

exports.setTimeout = function() {
  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);
};
exports.setInterval = function() {
  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);
};
exports.clearTimeout =
exports.clearInterval = function(timeout) { timeout.close(); };

function Timeout(id, clearFn) {
  this._id = id;
  this._clearFn = clearFn;
}
Timeout.prototype.unref = Timeout.prototype.ref = function() {};
Timeout.prototype.close = function() {
  this._clearFn.call(window, this._id);
};

// Does not start the time, just sets up the members needed.
exports.enroll = function(item, msecs) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = msecs;
};

exports.unenroll = function(item) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = -1;
};

exports._unrefActive = exports.active = function(item) {
  clearTimeout(item._idleTimeoutId);

  var msecs = item._idleTimeout;
  if (msecs >= 0) {
    item._idleTimeoutId = setTimeout(function onTimeout() {
      if (item._onTimeout)
        item._onTimeout();
    }, msecs);
  }
};

// That's not how node.js implements it but the exposed api is the same.
exports.setImmediate = typeof setImmediate === "function" ? setImmediate : function(fn) {
  var id = nextImmediateId++;
  var args = arguments.length < 2 ? false : slice.call(arguments, 1);

  immediateIds[id] = true;

  nextTick(function onNextTick() {
    if (immediateIds[id]) {
      // fn.call() is faster so we optimize for the common use-case
      // @see http://jsperf.com/call-apply-segu
      if (args) {
        fn.apply(null, args);
      } else {
        fn.call(null);
      }
      // Prevent ids from leaking
      exports.clearImmediate(id);
    }
  });

  return id;
};

exports.clearImmediate = typeof clearImmediate === "function" ? clearImmediate : function(id) {
  delete immediateIds[id];
};
}).call(this,require("timers").setImmediate,require("timers").clearImmediate)

},{"process/browser.js":14,"timers":16}],17:[function(require,module,exports){
module.exports={
  "name": "pdf-builder-2020",
  "version": "0.0.15-snapshot",
  "description": "",
  "main": "index.js",
  "scripts": {
    "build-all": "npm run build-pdf-editor && npm run build-manager & npm run deploy",
    "build-pdf-editor": "browserify -d src/pdf-editor/PdfEditor.js > public/pdf-editor/pdf-editor.js",
    "build-manager": "browserify -d src/manage-application/ManageApplication.js > public/manage-application/manager.js",
    "deploy": "xcopy /S /Y  \"./public\" \"C:/Users/Stranger_in_the_Q/IdeaProjects/itext-server/static\""
  },
  "devDependencies": {
    "babel-preset-es2015": "^6.24.1",
    "browserify": "^16.2.3",
    "browserify-css": "^0.14.0",
    "exports-loader": "^0.7.0",
    "graceful-fs": "^4.1.13",
    "imports-loader": "^0.8.0",
    "stripify": "^6.0.0"
  },
  "browserify": {
    "transform": [
      "browserify-css"
    ]
  },
  "author": "",
  "license": "ISC",
  "dependencies": {
    "d3-selection": "^1.4.0",
    "dragula": "^3.7.2"
  }
}

},{}],18:[function(require,module,exports){
// var InlineEditor = require('../../dependencies/ckeditor/ckeditor5-inline-full/build/ckeditor')
var BalloonEditor = require('../../dependencies/ckeditor/ckeditor-baloon/build/ckeditor')
// require('../../dependencies/ckeditor/ckeditor5-inline-full/build/translations/ru')
module.exports = {

    removeTextEditor: function remove(el) {

    },

    initTextEditor: function (el) {
        ckEditor(el)
    }
};


function ckEditor(el) {

    if(!el || el.classList.contains('initialized'))
        return
    el.classList.add('initialized');
    // InlineEditor
    BalloonEditor
        .create(el, {

            toolbar: {
                items: [
                    'undo',
                    'redo',
                    '|',
                    'bold',
                    'italic',
                    'underline',
                    'strikethrough',
                    'subscript',
                    'superscript',
                    // 'blockQuote',
                    // 'bulletedList',
                    // 'numberedList',
                    '|',
                    'alignment',
                    'indent',
                    'outdent',
                    'fontFamily',
                    'fontSize',
                    'fontBackgroundColor',
                    'fontColor',
                    '|',
                    // 'imageUpload',
                    // 'insertTable',
                    'specialCharacters',
                    'horizontalLine',
                    'link'
                ]
            },
            language: 'ru',
            image: {
                // You need to configure the image toolbar, too, so it uses the new style buttons.
                toolbar: [
                    'imageUpload',
                    // 'imageTextAlternative',
                    // '|',
                    'imageStyle:alignLeft',
                    'imageStyle:full',
                    'imageStyle:alignRight'
                ],
                styles: [
                    'full',
                    'alignLeft',
                    'alignRight'
                ]
            },
            table: {
                contentToolbar: [
                    'tableColumn',
                    'tableRow',
                    'mergeTableCells',
                    'tableCellProperties',
                    'tableProperties'
                ]
            },
            licenseKey: '',

        }).then(editor => {
            el.editor = editor;
        })
}

},{"../../dependencies/ckeditor/ckeditor-baloon/build/ckeditor":1}],19:[function(require,module,exports){
let pageStyles = require('./page-styles');

function fixPageBreaks_by_AStanislavsky(tmp) {
    let s = tmp.querySelector('.page.container').style;
    s.height = '200px';
    s.display = 'table-cell'
}

module.exports = function (html) {
    let tmp = tmpElement(html);
    fixPageBreaks_by_AStanislavsky(tmp);
    fixFlex(tmp);
    fixImagesAlign(tmp);
    fixTablesAlign(tmp);
    pageBreaks(tmp);
    return page(tmp);
}

function page(el) {
    return `
        <html>
            <head>${style()}</head>
            <body>${el.innerHTML}</body>
        </html>
    `;
}

function style() {
    return `
        ${pageStyles}
        <style>
           
            figure > img {
                display: block;
                margin: 0 auto;
                max-width: 100%;
                min-width: 50px;
            }
            figure.image.image_resized img {
                width: 100%;
            }
           .image-style-align-left {
                float: left;
            }
           .image-style-align-right {
                float: right;
            }
            
        </style>
    `;
}

function pageBreaks(tmp) {
    tmp.querySelectorAll('.page-break').forEach(el => {
        el.innerHTML = '';
        el.classList.remove('page-break')
    })
}

function fixFlex(el) {
    el.querySelectorAll('.row').forEach(row => {
        let columns = row.querySelectorAll('.col-xs')
        columns.forEach(col => {
            let s = col.style;
            s.display = 'inline-block';
            s.float = "left";
            s.minWidth = s.width = 100 / columns.length + '%';
            s.verticalAlign = 'top';
            // s.padding = "0 3px";
            // s.backgroundColor = `hsl(${Math.random()*360},55%,85%)`
        })
    })
}

function fixImagesAlign(el) {
    el.querySelectorAll('figure.image').forEach(imgBlock => {
        let centerAlign = !imgBlock.classList.contains('image-style-align-left')
                        && !imgBlock.classList.contains('image-style-align-right');
        if (centerAlign)
            imgBlock.parentNode.style.textAlign = "center"
    })
}

function fixTablesAlign(el) {
    el.querySelectorAll('figure.table').forEach(tableBlock => {
        let centerAlign = !tableBlock.style.float;
        if (!centerAlign) return
        tableBlock.parentNode.style.textAlign = "center"
        tableBlock.style.display = "inline-block"
    })
}

function tmpElement(html) {
    let tmp = document.createElement('div');
    tmp.innerHTML = html;
    return tmp;
}
},{"./page-styles":29}],20:[function(require,module,exports){
let fill = '#432c12'

let move = `
    <path d="M352.201 425.775l-79.196 79.196c-9.373 9.373-24.568 9.373-33.941 
        0l-79.196-79.196c-15.119-15.119-4.411-40.971 16.971-40.97h51.162L228 284H127.196v51.162c0 
        21.382-25.851 32.09-40.971 16.971L7.029 272.937c-9.373-9.373-9.373-24.569 0-33.941L86.225 
        159.8c15.119-15.119 40.971-4.411 40.971 16.971V228H228V127.196h-51.23c-21.382 
        0-32.09-25.851-16.971-40.971l79.196-79.196c9.373-9.373 24.568-9.373 33.941 0l79.196 79.196c15.119 
        15.119 4.411 40.971-16.971 40.971h-51.162V228h100.804v-51.162c0-21.382 25.851-32.09 
        40.97-16.971l79.196 79.196c9.373 9.373 9.373 24.569 0 33.941L425.773 352.2c-15.119 15.119-40.971 
        4.411-40.97-16.971V284H284v100.804h51.23c21.382 0 32.09 25.851 16.971 40.971z"/>
`;

let copy = `
    <path fill="${fill}" d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 
        0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 
        30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 
        13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 
        0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 
        0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/>
`;

let del = `
    <path fill="${fill}" d="M81  81 l350  350 l-40 40 l-350 -350z"/>
    <path fill="${fill}" d="M411 81 l-350 350 l40  40 l350  -350z"/>
`;

let down = `
    <path fill="${fill}" d="M50 150 l200 200 l200 -200z"/>
`;

let up = `
    <path fill="${fill}" d="M50 350 l200 -200 l200 200z"/>
`;

module.exports = {
    move: (w, h) => svg(w, h, move, [-50, -50, 612, 612]),
    copy: (w, h) => svg(w, h, copy),
    del: (w, h) => svg(w, h, del),
    up: (w, h) => svg(w, h, up),
    down: (w, h) => svg(w, h,down)
};

function svg(w, h, html, vb) {
    vb = vb || [-50, -50, 548, 612];
    return `<svg xmlns="http://www.w3.org/2000/svg" 
                viewBox="${vb}" 
                width="${w}px"  
                height="${h}px">
            ${html}
        </svg>`
}
},{}],21:[function(require,module,exports){
require('./pdf-editor.css');
require('../../dependencies/flexboxgrid/flexboxgrid.min.css');
let ver = require('../../package.json').version

let dnd = require('./dnd')
let htmlTemplate = require('./html-template');
let TextEditor = require('./CkEditor5');
let blocks = require('./blocks');
let svgOverlay = require('./svgOverlay/svgOverlay');
let documentCleaner = require('./documentCleaner');
let forItextFormatter = require('./ForItextFormatter');
let mouseoverButtons = require('./mouseoverButtons');
let pageStyles = require('./page-styles');
let TemplatesFactory = require('./TemplatesFactory');
let templatesFactory = new TemplatesFactory();

class PdfEditor {

    constructor(properties) {
        this.properties = properties || {};
        this.properties.blockProperties = this.properties.blockProperties || {}
        this.properties.buttonsSize = this.properties.buttonsSize || 25;
        this.initPdfEditor();
        this.writeVersion();
        dnd.initDnD(this)

        this.initCollapsePanels()
        this.initClearBlockSelectionOnClickInMilkListener();

        blocks.initBlocks(this);
        svgOverlay.initSvgOverlay(this);

        addEventListener('mouseup', () => {
            this.manageHoverState()
            this.removeEmptyRows()
        })
        console.log('pdf-editor: ' + ver)
    }

    removeEmptyRows() {
        setTimeout(() => {
            let allBlocks = this.targetElement.querySelectorAll('.pdf-editor .page > .template');
            allBlocks.forEach(b => {
                if (!b.firstChild)
                    return
                this.clearNotNeededRows(b.firstChild);
                if (b.childElementCount === 1)
                    b.firstChild.classList.remove('empty-drop-zone')

                this.manageExtraRows(b.firstChild);
                this.markEmptyRows(b.firstChild);
            })
        })
    }

    initPdfEditor() {
        let targetElement = this.properties.target;
        if (typeof targetElement === "string")
            targetElement = document.querySelector(targetElement);
        targetElement.innerHTML = htmlTemplate(this.properties);
        targetElement.querySelector('.sidePanel #blocks')
            .innerHTML = templatesFactory.createBlocks();
        targetElement.querySelector('.sidePanel #elements')
            .innerHTML = templatesFactory.createElements();
        targetElement.addEventListener('mousemove',
            e => mouseoverButtons.manage(e, this));

        this.targetElement = targetElement;
    }

    writeVersion(){
        let page = this.targetElement.querySelector('.page');
        if (!page.getAttribute('created-ver'))
            page.setAttribute('created-ver', ver);
        page.setAttribute('last-edited-ver', ver);
    }

    initClearBlockSelectionOnClickInMilkListener() {
        this.targetElement.querySelector('.content').addEventListener('click', e => {
            let clear = ['content', 'page'].find(c => e.target.classList.contains(c))
            clear |= e.target.querySelector('.page-break');
            if (clear)
                this.clickOnBlock(null)
        });
    }

    initCollapsePanels() {
        this.targetElement.querySelectorAll('.groupName').forEach(groupName => {
            groupName.addEventListener('click', () => {
                groupName.classList.toggle('collapsed')
            });
        });
    }

    manageHoverState(target) {
        if (target === this.lastHover)
            return;
        this.lastHover = target;
        this.targetElement.querySelectorAll('.page.container > .template')
            .forEach(tpl => tpl.classList.remove('hover-state'))
        if (!target)
            return
        target.classList.add('hover-state')

    }

    markEmptyRows(target) {
        target.parentNode.querySelectorAll('.dropzone').forEach(dz => {
            let empty = dz.innerHTML.trim() === '';
            dz.classList.toggle('empty-drop-zone', empty)
        });
    }

    manageExtraRows(target) {
        // console.log('manageExtraRows')
        let first = [...target.parentNode.querySelectorAll('.dropzone')].shift()
        if (first && first.innerHTML.trim() !== '') {
            target.parentNode.insertBefore(this.newDropZone(), first);
        }
        let last = [...target.parentNode.querySelectorAll('.dropzone')].pop()
        if (last && last.innerHTML.trim() !== '') {
            target.parentNode.append(this.newDropZone());
        }
    }

    clearNotNeededRows(target) {
        try { // console.log('clearNotNeededRows')
            let dropZones = target.parentNode.querySelectorAll('.dropzone');
            for (let i = 0; i < dropZones.length; i++) {
                if (dropZones.length > 1 && dropZones[i].innerHTML.trim() === '') {
                    dropZones[i].remove();
                    dnd.removeElement(dropZones[i])
                }
            }
        } catch (e) {
            console.error(e)
        }
    }

    newDropZone() {
        let dz = document.createElement('div');
        dz.className = 'dropzone row';
        this.initDz(dz);
        return dz
    }

    initEditor(el) {
        this.removeBySel('.dz-buttons, .template-buttons');
        TextEditor.initTextEditor(el)
    }

    initDz(dropZone) {
        dnd.pushElement(dropZone);
        dropZone.classList.remove('origin');
    }

    removeBySel(sel) {
        this.targetElement.querySelectorAll(sel)
            .forEach(e => e.remove());
    }

    clickOnBlock(el) {
        this.selectedBlock = el;
        blocks.handleClick(el);
    }

    // public api

    getDocument() {
        let pageContent = this.targetElement.querySelector('.page').outerHTML;
        return documentCleaner(pageContent).innerHTML;
    }

    forItext(html){
        return forItextFormatter(html || this.getDocument())
    }

    loadDocument(data) {
        if (!data)
            return;
        let content = this.targetElement.querySelector('.content');
        content.innerHTML = pageStyles + data;
        content.querySelectorAll('.headerBlock, .textBlock, .imgBlock, .tableBlock').forEach(el => {
            el.classList.add('add_editor_here')
            el.classList.add('ck-editor__editable_inline')
        })
        let templates = content.querySelectorAll('.template');
        templates.forEach(tpl => blocks.initTemplate(tpl, '.dropzone'));

        content.querySelectorAll('.page > .template').forEach(block => {
            if(!block.firstChild)return
            this.manageExtraRows(block.firstChild);
            this.markEmptyRows(block.firstChild);
        })

        dnd.pushElement(content.querySelector('.page'));
    }

    getPageStyles(){
        return pageStyles;
    }
}

window.PdfEditor = PdfEditor;
},{"../../dependencies/flexboxgrid/flexboxgrid.min.css":3,"../../package.json":17,"./CkEditor5":18,"./ForItextFormatter":19,"./TemplatesFactory":22,"./blocks":24,"./dnd":25,"./documentCleaner":26,"./html-template":27,"./mouseoverButtons":28,"./page-styles":29,"./pdf-editor.css":30,"./svgOverlay/svgOverlay":33}],22:[function(require,module,exports){
class TemplatesFactory {

    createBlocks() {
        let row = `<div class='dropzone origin row'></div>`;
        return this.createTemplate(row) + this.createTemplate(this.pageBreakBlock());
    }
    
     createTemplate(content, col) {
        return `<div class='template ${col?'col-xs':''}'>${content}</div>`;
    }

     imgBlock() {
        let svg = `<svg preserveAspectRatio='xMidYMid meet' xmlns='http://www.w3.org/2000/svg' 
                            width='100px' height='100px' viewbox='0 0 100 100'>
                          <path stroke='black' fill='none' 
                                d='M10,90v-20l30,-30l15,15l35,-35v70z M5,5h90v90h-90z M30,10a10,10,0,1,0,0.001,0z'></path>
                        </svg>`;
        return `<img draggable="false" class="img" width="100px" height="100px"  src="data:image/svg+xml;base64,${btoa(svg)}" >`;
    }

     textBlock() {
        return `<span>
                         ,      , 
                          2  ,    , 
                            , !
                </span>`
    }

     tableBlock() {
        let t = this.td();
        t += t + t + t;
        t = `<tr>${t}</tr>`;
        t += t + t;
        return `<table style="border: 1.5px solid"><tbody>${t}</tbody></table>`
    }

    td() {
        return `<td style="border: 1.5px solid"></td>`
    }

     headerBlock() {
        return `<p style="text-align:center;"><span class="text-huge"><strong></strong></span></p>`;
    }

     pageBreakBlock() {
        return `<div class="page-break" style="page-break-after: always"> </div>`;
    }

     createElements() {
        return  [
            this.headerBlock,
            this.textBlock,
            this.imgBlock,
            this.tableBlock
        ].map(fn => {
            let content = `<div class="${fn.name} add_editor_here">${fn.call(this)}</div>`;
            return this.createTemplate(content, true)
        }).join('')
    }
}

module.exports = TemplatesFactory;
},{}],23:[function(require,module,exports){
let templates = {

    block_name : `
        <div class="sub-label"> </div>
        <input type="text" id="block_name">
    `,

    block_descr : `
        <div class="sub-label"> </div>
        <textarea id="block_descr"></textarea>
    `,

    block_no_edit: `
        <br>
        <input id="block_no_edit" type="checkbox">
        <label for="block_no_edit" class="sub-label"> </label>
    `,
    block_no_move: `
        <br>
        <input id="block_no_move" type="checkbox">
        <label for="block_no_move" class="sub-label"> </label>     
    `,

    block_no_copy: `
        <br>
        <input id="block_no_copy" type="checkbox">
        <label for="block_no_copy"  class="sub-label"> </label>
    `,
    block_attach_button:`
        <br>
        <br>
        <button>  </button>
    `
}

module.exports = {

    htmlTemplate: properties => `
         <div style="padding:  0 10px; color:white; width:100%">
            ${Object.entries(properties.blockProperties).map(propertyBlock).join('')}
        </div>
    `,

};

function propertyBlock(entry) {
    return entry[1] !== false ? templates[entry[0]] : '';
}
},{}],24:[function(require,module,exports){
module.exports = {

    pdfEditor: null,

    newBlockNameText: '  ',

    propertyKeys: {
        block_name: 'block_name',
        block_descr: 'block_descr',
        block_no_edit: 'block_no_edit',
        block_no_move: 'block_no_move',
        block_no_copy: 'block_no_copy',
    },

    initBlocks(pdfEditor){
        this.pdfEditor = pdfEditor;
        this.initBlockEditors()
    },

    handleClick(el) {
        let pdfEditor = this.pdfEditor;

        if (!pdfEditor.properties.propertiesPage)
            return

        if (!el) return;

        let keys = this.propertyKeys;

        [keys. block_name, keys. block_descr].forEach(key => {
            if (pdfEditor.properties.blockProperties[key])
                pdfEditor.targetElement.querySelector('#'+key).value = el.getAttribute(key)
        });

        [keys. block_no_edit, keys. block_no_move, keys.block_no_copy].forEach(key => {
            if (pdfEditor.properties.blockProperties[key])
                pdfEditor.targetElement.querySelector('#'+key).checked = "true" !== el.getAttribute(key);
        });
    },

    copyBlock(e) {
        e.stopPropagation();
        let tpl = e.target.closest('.template');
        let cloned = tpl.cloneNode(true);

        tpl.parentElement.insertBefore(cloned, tpl);
        tpl.parentElement.insertBefore(tpl, cloned); // stupid hack
        cloned.id = "";
        let name = this.propertyKeys.block_name;
        cloned.setAttribute(name, cloned.getAttribute(name) + ' ')
        this.initTemplate(cloned, '.dropzone');

        cloned.querySelectorAll('div.add_editor_here').forEach(el =>{
            el.classList.remove('initialized');
            this.pdfEditor.initEditor(el);
        })
    },

    initTemplate(el, dropZoneSelector) {
        if (el.querySelector('.dropzone')) {

            if (!el.id)
                el.id = 'block_' + this.rnd() + this.rnd();

            let name = this.propertyKeys.block_name;
            if (!el.getAttribute(name))
                el.setAttribute(name, this.findNextNumber());

            el.addEventListener('click', () => this.pdfEditor.clickOnBlock(el));
            el.querySelectorAll(dropZoneSelector).forEach(dz => this.pdfEditor.initDz(dz));
        } else {
            this.pdfEditor.initEditor(el.querySelector('div.add_editor_here'));
        }
    },

    rnd() {
        return Math.random().toString(36).substring(2);
    },

    findNextNumber() {
        let numbers = [...this.pdfEditor.targetElement .querySelectorAll('.page > .template')].map(el => {
            let name = el.getAttribute(this.propertyKeys.block_name);
            return name && parseInt(name.split(this.newBlockNameText).pop());
        }).filter(n => n);
        let i = 1;
        for (; i < 1e5; i++)
            if (numbers.indexOf(i) === -1)
                break;
        return this.newBlockNameText + i;
    },

    initBlockEditors() {
        let  pdfEditor = this.pdfEditor;
        if (!pdfEditor.properties.propertiesPage)
            return

        Object.values(this.propertyKeys).forEach(function (id) {
            if (pdfEditor.properties.blockProperties[id])
                pdfEditor.targetElement.querySelector('#'+id).oninput = onInput;
        });

        function onInput() {
            if (!pdfEditor.selectedBlock || !pdfEditor.properties.blockProperties[this.id])
                return
            // console.log(self.selectedDropzone)
            pdfEditor.selectedBlock.setAttribute(this.id,
                this.type === 'checkbox' ? !this.checked : this.value
            );
            if (this.id !== 'block_no_edit')
                return;
            pdfEditor.selectedBlock
                .querySelectorAll('.add_editor_here')
                .forEach(el => {
                    if (this.checked)
                        el.setAttribute('contenteditable', true)
                    else
                        el.removeAttribute('contenteditable')
                })
        }
    }
};

},{}],25:[function(require,module,exports){
require('../../node_modules/dragula/dist/dragula.min.css');
let dragula = require('dragula');
let blocks = require('./blocks');

let drake;
let pdfEditor;
module.exports = {
    initDnD(pdfEditorInstance) {
        pdfEditor = pdfEditorInstance;
        drake = dragula([
            pdfEditor.targetElement.querySelector('#blocks'),
            pdfEditor.targetElement.querySelector('#elements'),
            pdfEditor.targetElement.querySelector('.page')
        ], {
            removeOnSpill: true,
            copy: function (el, source) {
                return source.classList.contains('templates');
            },
            accepts: (el, target) => dropAccepts(el, target),
            moves: function (el, container, handle) {
                return handle.classList.contains('handle') ||
                    container.classList.contains('templates');
            }
        });

        drake.on('drag', e => dragStart(e));
        drake.on('drop', (el, target) => handleDrop(el, target));
    },
    pushElement(element) {
        drake.containers.push(element)
    },
    removeElement(element) {
        drake.containers.splice( drake.containers.indexOf(element), 1 );
    }
};

function dragStart(e){

}

function dropAccepts(el, target) {
    let t = target.classList;
    if (t.contains('templates'))
        return false;
    if (el.querySelector('.dropzone') || el.querySelector('.page-break')) {
        return t.contains('page');
    } else {
        let canEdit = t.contains('dropzone') &&
            target.parentNode.getAttribute('block_no_edit') !== 'true';
        canEdit && pdfEditor.manageHoverState(target.parentNode, true);
        return canEdit;
    }
}


function handleDrop(el, target) {
    if (!target.classList.contains('page')){
        setTimeout(() => {
            pdfEditor.clearNotNeededRows(target);
            pdfEditor.manageExtraRows(target);
            pdfEditor.markEmptyRows(target);
        }, 10);
    }
    pdfEditor.clickOnBlock(pdfEditor.selectedBlock)
    blocks.initTemplate(el, '.origin');
}


},{"../../node_modules/dragula/dist/dragula.min.css":12,"./blocks":24,"dragula":13}],26:[function(require,module,exports){
module.exports = function (pageContent) {
    let tmp = document.createElement('div');
    tmp.innerHTML = pageContent;
    removeElements(tmp);
    cleanClasses(tmp);
    cleanAttributes(tmp);
    removeEmptyClassAttr(tmp);
    removeImageWidgetText(tmp);
    // pullUpFigureTagChildren(tmp)
    // console.log(tmp.innerHTML)
    return tmp;
}

function removeEmptyClassAttr(tmp) {
    tmp.querySelectorAll(`[class=""]`)
        .forEach(el => el.removeAttribute('class'));
}

function removeElements(tmp) {
    tmp.querySelectorAll([
        'style',
        '.ck-widget__selection-handle',
        '.ck-widget__resizer',
        '.dz-buttons',
        '.template-buttons',
        '.empty-drop-zone:first-child',
        '.empty-drop-zone:last-child'
    ].join(', ')).forEach(el => el.remove());
}

function cleanClasses(tmp) {
    [
        'initialized',
        'ck-blurred',
        'ck',
        'ck-content',
        'ck-editor__editable',
        'ck-rounded-corners',
        'ck-editor__editable_inline',
        'ck-editor__nested-editable',
        'ck-widget',
        'ck-widget_with-resizer',
        'ck-widget_selected',
        'ck-widget_with-selection-handle',
        'add_editor_here'
    ].forEach(c => tmp.querySelectorAll('.' + c)
        .forEach(el => el.classList.remove(c)));
}

function cleanAttributes(tmp) {
    [
        'aria-label',
        'contenteditable',
        'role',
        'lang',
        'dir',
        'data-cke-filler'
    ].forEach(attr => tmp.querySelectorAll(`[${attr}]`)
        .forEach(el => el.removeAttribute(attr)))
}

function removeImageWidgetText(tmp) {
    tmp.querySelectorAll('p, div')
        .forEach(el => el.innerHTML === ' ' && el.remove());
}

function pullUpFigureTagChildren(tmp) {
    tmp.querySelectorAll('figure')
        .forEach(f => {
            f.parentNode.insertBefore(f.firstChild, f);
            f.remove()
        })

}
},{}],27:[function(require,module,exports){


module.exports = properties => `
    ${require('./mouseoverButtons').styles(properties)}
    <div class="pdf-editor wrapper">
    
        <div class="sidePanel bg1">
            <div class="groupName"></div>
            <div id="blocks" class="templates"></div>
            <div class="groupName"></div>
            <div id="elements" class="templates"></div>
            ${properties.propertiesPage ? `
                <div class="groupName"></div>
                ${require('./blockProperties').htmlTemplate(properties)}
            ` : ''}
        </div>
        
        <div class="content">
            <div class="page container">${require('./page-styles')}</div>
        </div>

        ${require('./svgOverlay/svgOverlay').htmlTemplate(properties)}

    </div>
`;

},{"./blockProperties":23,"./mouseoverButtons":28,"./page-styles":29,"./svgOverlay/svgOverlay":33}],28:[function(require,module,exports){
let Icons = require('./Icons');
let blocks = require('./blocks');

module.exports = {
    manage: function(e, pdfEditor) {
        if (e.target.classList.contains('handle'))
            return;
        elementButtons(e, pdfEditor, blockButtons(e, pdfEditor));
    },
    styles: props => `
        <style>
            .pdf-editor .page .template:hover  .dz-buttons,
            .pdf-editor .page .template:hover  .template-buttons {
                opacity: 1;
            }
           .dz-buttons, .template-buttons {
                z-index: 111;
            } 
            .dz-buttons > div {
                transform: translate(${60+props.buttonsSize}px,0);
                width: 50px;
                user-select: none;
                text-align: right;
                height: 100px;
            }
            .dz-buttons svg, .template-buttons svg{
                pointer-events: none;
            }
            div.dz-buttons {
                margin-left: 700px;
            }
            .dz-buttons, .template-buttons {
                opacity: 0;
                position: relative;
                overflow: visible;
                width: 0px;
                height: 0px;
                line-height:0;
            }
            .template-buttons {
                transform: translate(${-10-props.buttonsSize}px, 0);
            }
            .template-buttons > div {
                width: 40px;
                height: 60px;
            }
        </style>
    `
}

function blockButtons(e, pdfEditor) {
    let size = pdfEditor.properties.buttonsSize
    let closestDz = e.target.closest('.page .template:not(.col-xs)');
    closestDz = closestDz || e.target.cl
    if (closestDz !== pdfEditor.mouseOverDz) {
        pdfEditor.removeBySel('.dz-buttons');
        pdfEditor.mouseOverDz = closestDz;
        if (closestDz) {
            let tb = document.createElement('div');
            tb.classList.add('dz-buttons');

            let canMove = closestDz.getAttribute('block_no_move') !== 'true';
            let canCopy = closestDz.getAttribute('block_no_copy') !== 'true';
            if (e.target.querySelector('.page-break'))
                canCopy = 0;
            tb.innerHTML = `
                    <div>
                        ${canMove ? `<span class='handle'>${Icons.move(size, size)}</span>` : ''}
                        ${canCopy ? `<span class='copy'>${Icons.copy(size, size)}</span>` : ''}
                        ${canMove ? `<span class='del'>${Icons.del(size, size)}</span>` : ''}
                        ${canMove ? `<span class='up'>${Icons.up(size, size)}</span>` : ''}
                        ${canMove ? `<span class='down'>${Icons.down(size, size)}</span>` : ''}
                    </div>
                `;
            closestDz.insertBefore(tb, closestDz.firstChild);

            let copy = tb.querySelector('.copy')
            copy && (copy.onclick = e => blocks.copyBlock(e))

            let del = tb.querySelector('.del')
            del && (del.onclick = e => {
                e.stopPropagation();
                let tpl = e.target.closest('.template');
                tpl.remove();
            });

            let up = tb.querySelector('.up')
            up && (up.onclick = e => {
                e.stopPropagation();
                let tpl = e.target.closest('.template');
                if (tpl.previousSibling && tpl.previousSibling.nodeName.toLowerCase() === "div")
                   tpl.parentNode.insertBefore(tpl, tpl.previousSibling)
            });

            let down = tb.querySelector('.down')
            down && (down.onclick = e => {
                e.stopPropagation();
                let tpl = e.target.closest('.template');
                tpl.parentNode.insertBefore(tpl, tpl.nextSibling.nextSibling)
            });
        }
    }
    return closestDz;
}

function elementButtons(e, pdfEditor, closestDz) {
    let size = pdfEditor.properties.buttonsSize
    let closestTpl = e.target.closest('.page .template.col-xs');
    if (closestTpl !== pdfEditor.mouseOverTpl) {
        pdfEditor.removeBySel('.template-buttons');
        pdfEditor.mouseOverTpl = closestTpl;
        let canEdit = closestDz && closestDz.getAttribute('block_no_edit') !== 'true';
        if (closestTpl && canEdit) {
            let closestTpl1 = e.target.closest('.page .template.col-xs:not(.mce-edit-focus)');
            let tb = document.createElement('div');
            tb.classList.add('template-buttons');
            tb.innerHTML = `
                    <div>
                        <div class='handle'>${Icons.move(size, size)}</div>
                    </div>
                `;
            closestTpl1.insertBefore(tb, closestTpl1.firstChild)
        }
    }
}



},{"./Icons":20,"./blocks":24}],29:[function(require,module,exports){
module.exports = `
<style>
p {
    margin-block-start: 0!important;
    margin-block-end: 0 !important;
}
.page {
    display: inline-block;
    min-height: 1110px;
    width: 100%;
    background: white;
    text-align: left;
    padding: 5px;
}
.template {
    color: black;
    width: 100%;
    padding: 0px;
}
.page > .template:not(:last-child) {
    margin-bottom: 5px;
}
div.dropzone.row {
    min-height: 35px;
    margin: 0;
    transition: 300ms;
}
div.dropzone.row.empty-drop-zone {
     min-height: 0px;
     opacity: 0;
}
div.template.hover-state div.dropzone.row.empty-drop-zone {
     min-height: 25px;
     opacity: 1;
     background-color: #0002;
}
.page .page-break {
    margin-left: -20px;
    margin-right: -20px;
    background: var(--bg-col);
    color: orange;
}
.page-break {
    background: #eee;
    height: 35px;
    pointer-events:none;
    text-align: center;
    line-height: 35px;
}
 .ck-widget__selection-handle {
    display: none;
 }
 .ck-widget_with-selection-handle{
    margin-top: 15px !important;
 }
 .ck-widget__selection-handle .ck.ck-icon {
    opacity: 0;
    pointer-events: none;
 }
 /*.template.col-xs {*/
 /*   padding: 2px!important;*/
 /*}*/
 /*.dropzone > .template {*/
 /*   height: 100%;*/
 /*}*/
 .page table {
    border-collapse: collapse;
 }
 .page table td {
    min-width: 40px;
 }
 
@page {
    margin: 0px;
}

.content .page.container div.add_editor_here{
    overflow: hidden;
    height: 100%;
}
</style>
`.split('\n').join('').split('    ').join('');
},{}],30:[function(require,module,exports){
var css = ".pdf-editor.wrapper {\n  display: flex;\n  flex-direction: row;\n  --bg-col: #444;\n}\n.pdf-editor .content {\n  flex-grow: 1;\n  background: var(--bg-col);\n  overflow-y: scroll;\n  padding: 50px 20px;\n  text-align: center;\n}\n.pdf-editor .page {\n  box-shadow: 1px 1px 4px 1px #2226;\n}\n.pdf-editor .sidePanel,\n.pdf-editor .propsPanel {\n  display: flex;\n  width: 360px;\n  /*background: #444;*/\n  flex-direction: column;\n  border-left: 1px solid gray;\n  border-right: 1px solid gray;\n  box-sizing: border-box;\n}\n.pdf-editor .templates {\n  /*flex-grow: 1;*/\n  /*overflow-y: auto;*/\n  /*overflow-x: hidden;*/\n  padding: 10px 25px;\n}\n.pdf-editor .templates .template {\n  margin-bottom: 5px;\n  /*padding:  5px 0;*/\n}\n.pdf-editor .buttons {\n  padding: 5px 5px 0 5px;\n}\n.pdf-editor .buttons button {\n  line-height: 30px;\n  border-radius: 11px;\n}\n.pdf-editor .template {\n  transition: 0.2s;\n}\n.pdf-editor #elements .template {\n  transition: 0.2s;\n  background: #eee;\n}\n.pdf-editor .sidePanel .dropzone {\n  background-color: #eee;\n  min-height: 35px;\n}\n.pdf-editor .sidePanel .template:hover {\n  transform: scale(1.1);\n  cursor: move;\n}\n.dropzone {\n  background-color: #0001;\n  /*border: 1px solid #0003;*/\n}\n/*div.dropzone.row:first-child,*/\n/*div.dropzone.row:last-child {*/\n/*    min-height: 0;*/\n/*}*/\n.handle {\n  cursor: move;\n}\n.copy {\n  cursor: pointer;\n}\n.handle,\n.copy,\n.del,\n.up,\n.down {\n  background-color: rgba(254, 177, 62, 0.4);\n  display: inline-block;\n  border-radius: 15%;\n  transition: 0.2s;\n  margin: 2px;\n}\n.handle:hover,\n.copy:hover,\n.del:hover,\n.up:hover,\n.down:hover {\n  background-color: rgba(254, 177, 62, 0.8);\n  /*background-color: rgb(187, 135, 64);*/\n}\n.dz-buttons,\n.template-buttons {\n  opacity: 0;\n  position: relative;\n  overflow: visible;\n  width: 0px;\n  height: 0px;\n  line-height: 0;\n}\n.template-buttons {\n  transform: translate(-40px, 0);\n}\n.template-buttons > div {\n  width: 40px;\n  height: 60px;\n  /*background: rebeccapurple;*/\n}\ndiv.dz-buttons {\n  margin-left: 700px;\n}\n.svg-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  pointer-events: none;\n}\ntable td {\n  min-width: 50px;\n  height: 20px;\n  border: 1px solid black;\n}\n.tableBlock {\n  padding-top: 3px;\n  padding-bottom: 3px;\n}\n.sub-label {\n  font-size: 16px;\n  color: #999;\n  font-family: Arial, sans-serif;\n}\n.sub-label:first-child {\n  padding-top: 5px;\n}\n.sidePanel #elements > div.template {\n  box-shadow: 0 0 0 1px gray;\n  text-align: center;\n}\n.sidePanel #elements  > div.template {\n  text-align: center;\n}\n.sidePanel #elements  table {\n  margin-top: 5px;\n  margin-bottom: 5px;\n}\n.sidePanel #elements  img {\n  margin-bottom: -4px;\n}\ndiv.template  table {\n  border-collapse: collapse;\n}\n.sidePanel textarea {\n  width: 333px;\n  height: 84px;\n}\n.sidePanel button,\n.sidePanel input[type=\"text\"] {\n  height: 28px;\n  width: 337px;\n}\n/*.sidePanel button {*/\n/*    outline: none;*/\n/*    padding-top: 5px;*/\n/*    border-radius: 5px;*/\n/*    border: 1px solid orange;*/\n/*    background: #444;*/\n/*    color: white;*/\n/*}*/\n.sidePanel textarea,\n.sidePanel input[type=\"text\"] {\n  border-radius: 4px;\n  background: #444;\n  color: white;\n  border: 1px solid #999;\n  margin-bottom: 5px;\n}\n.groupName {\n  width: 360px;\n  padding-left: 15px;\n  border-top: 1px solid gray;\n  border-bottom: 1px solid gray;\n  /*text-align: center;*/\n  font-size: 20px;\n  line-height: 30px;\n  font-family: Arial, sans-serif;\n  color: #999;\n  box-sizing: border-box;\n  cursor: pointer;\n}\n.groupName + div {\n  transition: 300ms;\n  max-height: 100vh;\n  overflow: hidden;\n}\n.groupName.collapsed + div {\n  max-height: 0;\n  min-height: 0 !important;\n  padding-top: 0;\n  padding-bottom: 0;\n  overflow: hidden;\n}\n.groupName:after {\n  content: url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='30' height='30'><circle fill='%23777' cx='15' cy='15' r='10' /><polyline stroke-width='3' points='10 13 15 18 20 13' fill='none' stroke='%23444'/></svg>\");\n  transition: 300ms;\n  float: right;\n  margin-right: 10px;\n  display: inline-block;\n  line-height: 0px;\n}\n.groupName.collapsed:after {\n  transform: rotate(90deg) scale(-1,-1);\n}\n.sidePanel table {\n  /*padding: 5px;*/\n  margin-left: 40px;\n}\n.sidePanel tr:nth-child(2) td:nth-child(3) {\n  background: lightgray;\n}\n.pdf-editor .page {\n  width: 800px;\n}\n"; (require("browserify-css").createStyle(css, { "href": "src\\pdf-editor\\pdf-editor.css" }, { "insertAt": "bottom" })); module.exports = css;
},{"browserify-css":5}],31:[function(require,module,exports){
module.exports = {

    htmlTemplate: properties => `
         <path fill="none" stroke="#ff6e1b"></path>
    `,

    initComponent(parentComponent) {
        this.blockSelectionFrame = parentComponent.querySelector('path');
    },

    updateComponent(pdfEditor) {
        if (!pdfEditor.selectedBlock)
            return this.blockSelectionFrame.removeAttribute('d');
        let r = pdfEditor.selectedBlock.getBoundingClientRect();
        this.blockSelectionFrame.setAttribute('d',`M${r.x},${r.y}h${r.width}v${r.height+2}h-${r.width}z`)
    }
}
},{}],32:[function(require,module,exports){
let blocks = require('../blocks');

module.exports = {

    htmlTemplate(properties) {
        return (this.enabled = properties.floatingBlockName) ? `
            <g>
                <rect y="-30" rx="5" height="25" fill="rgb(187, 135, 64)"></rect>
                <text y="-10" x="10"></text>
            </g>
        ` : '';
    },

    initComponent(parentComponent) {
        if (!this.enabled)
            return
        this.blockNameGroup = parentComponent.querySelector('.svg-overlay g g');
        this.blockNameBg = parentComponent.querySelector('.svg-overlay g g rect');
        this.blockNameText = parentComponent.querySelector('.svg-overlay g g text');
    },

    updateComponent(pdfEditor) {
        if (!this.enabled)
            return
        let selectedBlock = pdfEditor.selectedBlock;
        if (!selectedBlock)
            return this.blockNameGroup.setAttribute(`transform`, `translate(0,-1000)`);
        let r = selectedBlock.getBoundingClientRect();
        this.blockNameGroup.setAttribute(`transform`, `translate(${r.x},${r.y})`);
        this.blockNameText.textContent = selectedBlock.getAttribute(blocks.propertyKeys.block_name);
        r = this.blockNameText.getBoundingClientRect();
        this.blockNameBg.setAttribute('width', r.width + 20);
    }
}
},{"../blocks":24}],33:[function(require,module,exports){
let floatingBlockName = require('./floatingBlockName');
let blockSelection = require('./blockSelection');

module.exports = {

    htmlTemplate: properties => `
        <svg class="svg-overlay">
            <defs>
                <clipPath id="editor_clip_rect">
                    <polygon></polygon>
                </clipPath>
            </defs>
            <g clip-path="url(#editor_clip_rect)">
                ${blockSelection.htmlTemplate(properties)}
                ${floatingBlockName.htmlTemplate(properties)}
            </g>
        </svg>
    `,

    initSvgOverlay: function (pdfEditor) {
        this.pdfEditor = pdfEditor;
        this.overlay = pdfEditor.targetElement.querySelector('.svg-overlay');
        this.overlayClipPolygon = this.overlay.querySelector('#editor_clip_rect polygon');
        blockSelection.initComponent(this.overlay);
        floatingBlockName.initComponent(this.overlay);
        this.updateComponent(this.pdfEditor);
    },

    updateComponent(pdfEditor) {

        requestAnimationFrame(() => this.updateComponent(pdfEditor));

        if (!this.pdfEditor .targetElement.querySelector('.pdf-editor .content'))
            return;

        this.overlay.setAttribute('viewBox',`0 0 ${innerWidth} ${innerHeight}`);
        this.overlay.setAttribute('width', innerWidth);
        this.overlay.setAttribute('height', innerHeight);

        let r = this.pdfEditor.targetElement .querySelector('.pdf-editor .content').getBoundingClientRect();
        let scrollWidth = 17;
        let pts = [
            r.x, r.y,
            r.x + r.width - scrollWidth, r.y,
            r.x + r.width - scrollWidth, r.y + r.height,
            r.x, r.y + r.height
        ];
        this.overlayClipPolygon.setAttribute('points', pts.join(' '));

        blockSelection.updateComponent(this.pdfEditor)
        floatingBlockName.updateComponent(this.pdfEditor)
    }

}
},{"./blockSelection":31,"./floatingBlockName":32}]},{},[21])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkZXBlbmRlbmNpZXMvY2tlZGl0b3IvY2tlZGl0b3ItYmFsb29uL2J1aWxkL2NrZWRpdG9yLmpzIiwiZGVwZW5kZW5jaWVzL2NrZWRpdG9yL3J1LmpzIiwiZGVwZW5kZW5jaWVzL2ZsZXhib3hncmlkL2ZsZXhib3hncmlkLm1pbi5jc3MiLCJub2RlX21vZHVsZXMvYXRvYS9hdG9hLmpzIiwibm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnktY3NzL2Jyb3dzZXIuanMiLCJub2RlX21vZHVsZXMvY29udHJhL2RlYm91bmNlLmpzIiwibm9kZV9tb2R1bGVzL2NvbnRyYS9lbWl0dGVyLmpzIiwibm9kZV9tb2R1bGVzL2Nyb3NzdmVudC9zcmMvY3Jvc3N2ZW50LmpzIiwibm9kZV9tb2R1bGVzL2Nyb3NzdmVudC9zcmMvZXZlbnRtYXAuanMiLCJub2RlX21vZHVsZXMvY3VzdG9tLWV2ZW50L2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2RyYWd1bGEvY2xhc3Nlcy5qcyIsIm5vZGVfbW9kdWxlcy9kcmFndWxhL2Rpc3QvZHJhZ3VsYS5taW4uY3NzIiwibm9kZV9tb2R1bGVzL2RyYWd1bGEvZHJhZ3VsYS5qcyIsIm5vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCJub2RlX21vZHVsZXMvdGlja3kvdGlja3ktYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzIiwicGFja2FnZS5qc29uIiwic3JjL3BkZi1lZGl0b3IvQ2tFZGl0b3I1LmpzIiwic3JjL3BkZi1lZGl0b3IvRm9ySXRleHRGb3JtYXR0ZXIuanMiLCJzcmMvcGRmLWVkaXRvci9JY29ucy5qcyIsInNyYy9wZGYtZWRpdG9yL1BkZkVkaXRvci5qcyIsInNyYy9wZGYtZWRpdG9yL1RlbXBsYXRlc0ZhY3RvcnkuanMiLCJzcmMvcGRmLWVkaXRvci9ibG9ja1Byb3BlcnRpZXMuanMiLCJzcmMvcGRmLWVkaXRvci9ibG9ja3MuanMiLCJzcmMvcGRmLWVkaXRvci9kbmQuanMiLCJzcmMvcGRmLWVkaXRvci9kb2N1bWVudENsZWFuZXIuanMiLCJzcmMvcGRmLWVkaXRvci9odG1sLXRlbXBsYXRlLmpzIiwic3JjL3BkZi1lZGl0b3IvbW91c2VvdmVyQnV0dG9ucy5qcyIsInNyYy9wZGYtZWRpdG9yL3BhZ2Utc3R5bGVzLmpzIiwic3JjL3BkZi1lZGl0b3IvcGRmLWVkaXRvci5jc3MiLCJzcmMvcGRmLWVkaXRvci9zdmdPdmVybGF5L2Jsb2NrU2VsZWN0aW9uLmpzIiwic3JjL3BkZi1lZGl0b3Ivc3ZnT3ZlcmxheS9mbG9hdGluZ0Jsb2NrTmFtZS5qcyIsInNyYy9wZGYtZWRpdG9yL3N2Z092ZXJsYXkvc3ZnT3ZlcmxheS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3p4a0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1lBOztBQ0FBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDckdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBOzs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNobUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qIVxyXG4gKiBAbGljZW5zZSBDb3B5cmlnaHQgKGMpIDIwMDMtMjAyMCwgQ0tTb3VyY2UgLSBGcmVkZXJpY28gS25hYmJlbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogRm9yIGxpY2Vuc2luZywgc2VlIExJQ0VOU0UubWQuXHJcbiAqL1xyXG5cclxuXHJcbihmdW5jdGlvbiAodCkge1xyXG4gICAgdFtcInJ1XCJdID0gT2JqZWN0LmFzc2lnbih0W1wicnVcIl0gfHwge30sIHJlcXVpcmUoJy4uLy4uL3J1JykpXHJcbn0pKHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlMgfHwgKHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlMgPSB7fSkpO1xyXG4oZnVuY3Rpb24gdChlLCBpKSB7XHJcbiAgICBpZiAodHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIikgbW9kdWxlLmV4cG9ydHMgPSBpKCk7IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoW10sIGkpOyBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gXCJvYmplY3RcIikgZXhwb3J0c1tcIkJhbGxvb25FZGl0b3JcIl0gPSBpKCk7IGVsc2UgZVtcIkJhbGxvb25FZGl0b3JcIl0gPSBpKClcclxufSkod2luZG93LCAoZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB7fTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaShuKSB7XHJcbiAgICAgICAgICAgIGlmIChlW25dKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVtuXS5leHBvcnRzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG8gPSBlW25dID0ge2k6IG4sIGw6IGZhbHNlLCBleHBvcnRzOiB7fX07XHJcbiAgICAgICAgICAgIHRbbl0uY2FsbChvLmV4cG9ydHMsIG8sIG8uZXhwb3J0cywgaSk7XHJcbiAgICAgICAgICAgIG8ubCA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiBvLmV4cG9ydHNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGkubSA9IHQ7XHJcbiAgICAgICAgaS5jID0gZTtcclxuICAgICAgICBpLmQgPSBmdW5jdGlvbiAodCwgZSwgbikge1xyXG4gICAgICAgICAgICBpZiAoIWkubyh0LCBlKSkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIGUsIHtlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IG59KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBpLnIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBTeW1ib2wudG9TdHJpbmdUYWcsIHt2YWx1ZTogXCJNb2R1bGVcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIFwiX19lc01vZHVsZVwiLCB7dmFsdWU6IHRydWV9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaS50ID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKGUgJiAxKSB0ID0gaSh0KTtcclxuICAgICAgICAgICAgaWYgKGUgJiA4KSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKGUgJiA0ICYmIHR5cGVvZiB0ID09PSBcIm9iamVjdFwiICYmIHQgJiYgdC5fX2VzTW9kdWxlKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgdmFyIG4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgICAgICBpLnIobik7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLCBcImRlZmF1bHRcIiwge2VudW1lcmFibGU6IHRydWUsIHZhbHVlOiB0fSk7XHJcbiAgICAgICAgICAgIGlmIChlICYgMiAmJiB0eXBlb2YgdCAhPSBcInN0cmluZ1wiKSBmb3IgKHZhciBvIGluIHQpIGkuZChuLCBvLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRbZV1cclxuICAgICAgICAgICAgfS5iaW5kKG51bGwsIG8pKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIGkubiA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdCAmJiB0Ll9fZXNNb2R1bGUgPyBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRbXCJkZWZhdWx0XCJdXHJcbiAgICAgICAgICAgIH0gOiBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgaS5kKGUsIFwiYVwiLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9O1xyXG4gICAgICAgIGkubyA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgZSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIGkucCA9IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuIGkoaS5zID0gMTE0KVxyXG4gICAgfShbZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBpLmQoZSwgXCJiXCIsIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIGkuZChlLCBcImFcIiwgKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgY29uc3QgbiA9IFwiaHR0cHM6Ly9ja2VkaXRvci5jb20vZG9jcy9ja2VkaXRvcjUvbGF0ZXN0L2ZyYW1ld29yay9ndWlkZXMvc3VwcG9ydC9lcnJvci1jb2Rlcy5odG1sXCI7XHJcblxyXG4gICAgICAgIGNsYXNzIG8gZXh0ZW5kcyBFcnJvciB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHQgPSByKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ICs9IFwiIFwiICsgSlNPTi5zdHJpbmdpZnkoaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gXCJDS0VkaXRvckVycm9yXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PT0gXCJDS0VkaXRvckVycm9yXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIHJldGhyb3dVbmV4cGVjdGVkRXJyb3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXMgJiYgdC5pcyhcIkNLRWRpdG9yRXJyb3JcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IG8odC5tZXNzYWdlLCBlKTtcclxuICAgICAgICAgICAgICAgIGkuc3RhY2sgPSB0LnN0YWNrO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQubWF0Y2goL14oW146XSspOi8pO1xyXG4gICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHQgKyBgIFJlYWQgbW9yZTogJHtufSNlcnJvci0ke2VbMV19XFxuYFxyXG4gICAgICAgIH1cclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgdmFyIG4gPSBmdW5jdGlvbiB0KCkge1xyXG4gICAgICAgICAgICB2YXIgZTtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGUgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gQm9vbGVhbih3aW5kb3cgJiYgZG9jdW1lbnQgJiYgZG9jdW1lbnQuYWxsICYmICF3aW5kb3cuYXRvYilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KCk7XHJcbiAgICAgICAgdmFyIG8gPSBmdW5jdGlvbiB0KCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHt9O1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdChpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVbaV0gPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5IVE1MSUZyYW1lRWxlbWVudCAmJiBuIGluc3RhbmNlb2Ygd2luZG93LkhUTUxJRnJhbWVFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gbi5jb250ZW50RG9jdW1lbnQuaGVhZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVbaV0gPSBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVtpXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSgpO1xyXG4gICAgICAgIHZhciByID0gW107XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHModCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IC0xO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChyW2ldLmlkZW50aWZpZXIgPT09IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gaTtcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhKHQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSB7fTtcclxuICAgICAgICAgICAgdmFyIG4gPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgbyA9IDA7IG8gPCB0Lmxlbmd0aDsgbysrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IHRbb107XHJcbiAgICAgICAgICAgICAgICB2YXIgYyA9IGUuYmFzZSA/IGFbMF0gKyBlLmJhc2UgOiBhWzBdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGwgPSBpW2NdIHx8IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IFwiXCIuY29uY2F0KGMsIFwiIFwiKS5jb25jYXQobCk7XHJcbiAgICAgICAgICAgICAgICBpW2NdID0gbCArIDE7XHJcbiAgICAgICAgICAgICAgICB2YXIgdSA9IHMoZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IHtjc3M6IGFbMV0sIG1lZGlhOiBhWzJdLCBzb3VyY2VNYXA6IGFbM119O1xyXG4gICAgICAgICAgICAgICAgaWYgKHUgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgclt1XS5yZWZlcmVuY2VzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgclt1XS51cGRhdGVyKGgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHIucHVzaCh7aWRlbnRpZmllcjogZCwgdXBkYXRlcjogbShoLCBlKSwgcmVmZXJlbmNlczogMX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuLnB1c2goZClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYyh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG4gICAgICAgICAgICB2YXIgbiA9IHQuYXR0cmlidXRlcyB8fCB7fTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBuLm5vbmNlID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IHRydWUgPyBpLm5jIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLm5vbmNlID0gclxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKG4pLmZvckVhY2goKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICBlLnNldEF0dHJpYnV0ZSh0LCBuW3RdKVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdC5pbnNlcnQgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgdC5pbnNlcnQoZSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gbyh0Lmluc2VydCB8fCBcImhlYWRcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBmaW5kIGEgc3R5bGUgdGFyZ2V0LiBUaGlzIHByb2JhYmx5IG1lYW5zIHRoYXQgdGhlIHZhbHVlIGZvciB0aGUgJ2luc2VydCcgcGFyYW1ldGVyIGlzIGludmFsaWQuXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzLmFwcGVuZENoaWxkKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGwodCkge1xyXG4gICAgICAgICAgICBpZiAodC5wYXJlbnROb2RlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBkID0gZnVuY3Rpb24gdCgpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSBbXTtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHQoaSwgbikge1xyXG4gICAgICAgICAgICAgICAgZVtpXSA9IG47XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5maWx0ZXIoQm9vbGVhbikuam9pbihcIlxcblwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiB1KHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgdmFyIG8gPSBpID8gXCJcIiA6IG4ubWVkaWEgPyBcIkBtZWRpYSBcIi5jb25jYXQobi5tZWRpYSwgXCIge1wiKS5jb25jYXQobi5jc3MsIFwifVwiKSA6IG4uY3NzO1xyXG4gICAgICAgICAgICBpZiAodC5zdHlsZVNoZWV0KSB7XHJcbiAgICAgICAgICAgICAgICB0LnN0eWxlU2hlZXQuY3NzVGV4dCA9IGQoZSwgbylcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciByID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHQuY2hpbGROb2RlcztcclxuICAgICAgICAgICAgICAgIGlmIChzW2VdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5yZW1vdmVDaGlsZChzW2VdKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5pbnNlcnRCZWZvcmUociwgc1tlXSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hcHBlbmRDaGlsZChyKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSBpLmNzcztcclxuICAgICAgICAgICAgdmFyIG8gPSBpLm1lZGlhO1xyXG4gICAgICAgICAgICB2YXIgciA9IGkuc291cmNlTWFwO1xyXG4gICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBvKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdC5yZW1vdmVBdHRyaWJ1dGUoXCJtZWRpYVwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyICYmIGJ0b2EpIHtcclxuICAgICAgICAgICAgICAgIG4gKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiLmNvbmNhdChidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShyKSkpKSwgXCIgKi9cIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zdHlsZVNoZWV0KSB7XHJcbiAgICAgICAgICAgICAgICB0LnN0eWxlU2hlZXQuY3NzVGV4dCA9IG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0LmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUNoaWxkKHQuZmlyc3RDaGlsZClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmID0gbnVsbDtcclxuICAgICAgICB2YXIgZyA9IDA7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG0odCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaTtcclxuICAgICAgICAgICAgdmFyIG47XHJcbiAgICAgICAgICAgIHZhciBvO1xyXG4gICAgICAgICAgICBpZiAoZS5zaW5nbGV0b24pIHtcclxuICAgICAgICAgICAgICAgIHZhciByID0gZysrO1xyXG4gICAgICAgICAgICAgICAgaSA9IGYgfHwgKGYgPSBjKGUpKTtcclxuICAgICAgICAgICAgICAgIG4gPSB1LmJpbmQobnVsbCwgaSwgciwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgbyA9IHUuYmluZChudWxsLCBpLCByLCB0cnVlKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaSA9IGMoZSk7XHJcbiAgICAgICAgICAgICAgICBuID0gaC5iaW5kKG51bGwsIGksIGUpO1xyXG4gICAgICAgICAgICAgICAgbyA9IGZ1bmN0aW9uIHQoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbChpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG4odCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBlKGkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuY3NzID09PSB0LmNzcyAmJiBpLm1lZGlhID09PSB0Lm1lZGlhICYmIGkuc291cmNlTWFwID09PSB0LnNvdXJjZU1hcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbih0ID0gaSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIGUgPSBlIHx8IHt9O1xyXG4gICAgICAgICAgICBpZiAoIWUuc2luZ2xldG9uICYmIHR5cGVvZiBlLnNpbmdsZXRvbiAhPT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgICAgIGUuc2luZ2xldG9uID0gbigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdCA9IHQgfHwgW107XHJcbiAgICAgICAgICAgIHZhciBpID0gYSh0LCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHQobikge1xyXG4gICAgICAgICAgICAgICAgbiA9IG4gfHwgW107XHJcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG4pICE9PSBcIltvYmplY3QgQXJyYXldXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG8gPSAwOyBvIDwgaS5sZW5ndGg7IG8rKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gaVtvXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IHMoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcltsXS5yZWZlcmVuY2VzLS1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBkID0gYShuLCBlKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIHUgPSAwOyB1IDwgaS5sZW5ndGg7IHUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBoID0gaVt1XTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHMoaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJbZl0ucmVmZXJlbmNlcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByW2ZdLnVwZGF0ZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgci5zcGxpY2UoZiwgMSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpID0gZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSwgLCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgIHZhciBuID0gaSg3KTtcclxuICAgICAgICB2YXIgbyA9IHR5cGVvZiBzZWxmID09IFwib2JqZWN0XCIgJiYgc2VsZiAmJiBzZWxmLk9iamVjdCA9PT0gT2JqZWN0ICYmIHNlbGY7XHJcbiAgICAgICAgdmFyIHIgPSBuW1wiYVwiXSB8fCBvIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcclxuICAgICAgICBlW1wiYVwiXSA9IHJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gaSgzKTtcclxuICAgICAgICAgICAgdmFyIG8gPSBpKDE0KTtcclxuICAgICAgICAgICAgdmFyIHIgPSB0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcclxuICAgICAgICAgICAgdmFyIHMgPSByICYmIHR5cGVvZiB0ID09IFwib2JqZWN0XCIgJiYgdCAmJiAhdC5ub2RlVHlwZSAmJiB0O1xyXG4gICAgICAgICAgICB2YXIgYSA9IHMgJiYgcy5leHBvcnRzID09PSByO1xyXG4gICAgICAgICAgICB2YXIgYyA9IGEgPyBuW1wiYVwiXS5CdWZmZXIgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHZhciBsID0gYyA/IGMuaXNCdWZmZXIgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHZhciBkID0gbCB8fCBvW1wiYVwiXTtcclxuICAgICAgICAgICAgZVtcImFcIl0gPSBkXHJcbiAgICAgICAgfSkuY2FsbCh0aGlzLCBpKDkpKHQpKVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSBpKDcpO1xyXG4gICAgICAgICAgICB2YXIgbyA9IHR5cGVvZiBleHBvcnRzID09IFwib2JqZWN0XCIgJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzO1xyXG4gICAgICAgICAgICB2YXIgciA9IG8gJiYgdHlwZW9mIHQgPT0gXCJvYmplY3RcIiAmJiB0ICYmICF0Lm5vZGVUeXBlICYmIHQ7XHJcbiAgICAgICAgICAgIHZhciBzID0gciAmJiByLmV4cG9ydHMgPT09IG87XHJcbiAgICAgICAgICAgIHZhciBhID0gcyAmJiBuW1wiYVwiXS5wcm9jZXNzO1xyXG4gICAgICAgICAgICB2YXIgYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSByICYmIHIucmVxdWlyZSAmJiByLnJlcXVpcmUoXCJ1dGlsXCIpLnR5cGVzO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhICYmIGEuYmluZGluZyAmJiBhLmJpbmRpbmcoXCJ1dGlsXCIpXHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0oKTtcclxuICAgICAgICAgICAgZVtcImFcIl0gPSBjXHJcbiAgICAgICAgfSkuY2FsbCh0aGlzLCBpKDkpKHQpKVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSBpKDApO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gXCIxOC4wLjBcIjtcclxuICAgICAgICAgICAgY29uc3QgbyA9IHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIgPyB3aW5kb3cgOiB0O1xyXG4gICAgICAgICAgICBpZiAoby5DS0VESVRPUl9WRVJTSU9OKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgZVtcImJcIl0oXCJja2VkaXRvci1kdXBsaWNhdGVkLW1vZHVsZXM6IFNvbWUgQ0tFZGl0b3IgNSBtb2R1bGVzIGFyZSBkdXBsaWNhdGVkLlwiLCBudWxsKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgby5DS0VESVRPUl9WRVJTSU9OID0gblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkuY2FsbCh0aGlzLCBpKDEwKSlcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gdHlwZW9mIHQgPT0gXCJvYmplY3RcIiAmJiB0ICYmIHQuT2JqZWN0ID09PSBPYmplY3QgJiYgdDtcclxuICAgICAgICAgICAgZVtcImFcIl0gPSBpXHJcbiAgICAgICAgfSkuY2FsbCh0aGlzLCBpKDEwKSlcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gaSgzKTtcclxuICAgICAgICAgICAgdmFyIG8gPSB0eXBlb2YgZXhwb3J0cyA9PSBcIm9iamVjdFwiICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUgJiYgZXhwb3J0cztcclxuICAgICAgICAgICAgdmFyIHIgPSBvICYmIHR5cGVvZiB0ID09IFwib2JqZWN0XCIgJiYgdCAmJiAhdC5ub2RlVHlwZSAmJiB0O1xyXG4gICAgICAgICAgICB2YXIgcyA9IHIgJiYgci5leHBvcnRzID09PSBvO1xyXG4gICAgICAgICAgICB2YXIgYSA9IHMgPyBuW1wiYVwiXS5CdWZmZXIgOiB1bmRlZmluZWQsIGMgPSBhID8gYS5hbGxvY1Vuc2FmZSA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGwodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5zbGljZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IHQubGVuZ3RoLCBuID0gYyA/IGMoaSkgOiBuZXcgdC5jb25zdHJ1Y3RvcihpKTtcclxuICAgICAgICAgICAgICAgIHQuY29weShuKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGVbXCJhXCJdID0gbFxyXG4gICAgICAgIH0pLmNhbGwodGhpcywgaSg5KSh0KSlcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgaWYgKCF0LndlYnBhY2tQb2x5ZmlsbCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSBPYmplY3QuY3JlYXRlKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlLmNoaWxkcmVuKSBlLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgXCJsb2FkZWRcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZS5sXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgXCJpZFwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCBcImV4cG9ydHNcIiwge2VudW1lcmFibGU6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIGUud2VicGFja1BvbHlmaWxsID0gMVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBpID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgIH0oKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpID0gaSB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpXHJcbiAgICAgICAgfSBjYXRjaCAodCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIikgaSA9IHdpbmRvd1xyXG4gICAgICAgIH1cclxuICAgICAgICB0LmV4cG9ydHMgPSBpXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNTUpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMTA4KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDEwOSk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG4oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZVtcImFcIl0gPSBuXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMTYpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLWhpZGRlbntkaXNwbGF5Om5vbmUhaW1wb3J0YW50fS5jay5jay1yZXNldCwuY2suY2stcmVzZXRfYWxsLC5jay5jay1yZXNldF9hbGwgKntib3gtc2l6aW5nOmJvcmRlci1ib3g7d2lkdGg6YXV0bztoZWlnaHQ6YXV0bztwb3NpdGlvbjpzdGF0aWN9OnJvb3R7LS1jay16LWRlZmF1bHQ6MTstLWNrLXotbW9kYWw6Y2FsYyh2YXIoLS1jay16LWRlZmF1bHQpICsgOTk5KTstLWNrLWNvbG9yLWJhc2UtZm9yZWdyb3VuZDojZmFmYWZhOy0tY2stY29sb3ItYmFzZS1iYWNrZ3JvdW5kOiNmZmY7LS1jay1jb2xvci1iYXNlLWJvcmRlcjojYzRjNGM0Oy0tY2stY29sb3ItYmFzZS1hY3Rpb246IzYxYjA0NTstLWNrLWNvbG9yLWJhc2UtZm9jdXM6IzZjYjVmOTstLWNrLWNvbG9yLWJhc2UtdGV4dDojMzMzOy0tY2stY29sb3ItYmFzZS1hY3RpdmU6IzE5OGNmMDstLWNrLWNvbG9yLWJhc2UtYWN0aXZlLWZvY3VzOiMwZTdmZTE7LS1jay1jb2xvci1iYXNlLWVycm9yOiNkYjM3MDA7LS1jay1jb2xvci1mb2N1cy1ib3JkZXI6IzFmODllNTstLWNrLWNvbG9yLWZvY3VzLW91dGVyLXNoYWRvdzojYmNkZWZiOy0tY2stY29sb3ItZm9jdXMtZGlzYWJsZWQtc2hhZG93OnJnYmEoMTE5LDE4NiwyNDgsMC4zKTstLWNrLWNvbG9yLWZvY3VzLWVycm9yLXNoYWRvdzpyZ2JhKDI1NSw2NCwzMSwwLjMpOy0tY2stY29sb3ItdGV4dDp2YXIoLS1jay1jb2xvci1iYXNlLXRleHQpOy0tY2stY29sb3Itc2hhZG93LWRyb3A6cmdiYSgwLDAsMCwwLjE1KTstLWNrLWNvbG9yLXNoYWRvdy1kcm9wLWFjdGl2ZTpyZ2JhKDAsMCwwLDAuMik7LS1jay1jb2xvci1zaGFkb3ctaW5uZXI6cmdiYSgwLDAsMCwwLjEpOy0tY2stY29sb3ItYnV0dG9uLWRlZmF1bHQtYmFja2dyb3VuZDp0cmFuc3BhcmVudDstLWNrLWNvbG9yLWJ1dHRvbi1kZWZhdWx0LWhvdmVyLWJhY2tncm91bmQ6I2U2ZTZlNjstLWNrLWNvbG9yLWJ1dHRvbi1kZWZhdWx0LWFjdGl2ZS1iYWNrZ3JvdW5kOiNkOWQ5ZDk7LS1jay1jb2xvci1idXR0b24tZGVmYXVsdC1hY3RpdmUtc2hhZG93OiNiZmJmYmY7LS1jay1jb2xvci1idXR0b24tZGVmYXVsdC1kaXNhYmxlZC1iYWNrZ3JvdW5kOnRyYW5zcGFyZW50Oy0tY2stY29sb3ItYnV0dG9uLW9uLWJhY2tncm91bmQ6I2RlZGVkZTstLWNrLWNvbG9yLWJ1dHRvbi1vbi1ob3Zlci1iYWNrZ3JvdW5kOiNjNGM0YzQ7LS1jay1jb2xvci1idXR0b24tb24tYWN0aXZlLWJhY2tncm91bmQ6I2JhYmFiYTstLWNrLWNvbG9yLWJ1dHRvbi1vbi1hY3RpdmUtc2hhZG93OiNhMWExYTE7LS1jay1jb2xvci1idXR0b24tb24tZGlzYWJsZWQtYmFja2dyb3VuZDojZGVkZWRlOy0tY2stY29sb3ItYnV0dG9uLWFjdGlvbi1iYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJhc2UtYWN0aW9uKTstLWNrLWNvbG9yLWJ1dHRvbi1hY3Rpb24taG92ZXItYmFja2dyb3VuZDojNTc5ZTNkOy0tY2stY29sb3ItYnV0dG9uLWFjdGlvbi1hY3RpdmUtYmFja2dyb3VuZDojNTM5NzNiOy0tY2stY29sb3ItYnV0dG9uLWFjdGlvbi1hY3RpdmUtc2hhZG93OiM0OTg0MzM7LS1jay1jb2xvci1idXR0b24tYWN0aW9uLWRpc2FibGVkLWJhY2tncm91bmQ6IzdlYzM2NTstLWNrLWNvbG9yLWJ1dHRvbi1hY3Rpb24tdGV4dDp2YXIoLS1jay1jb2xvci1iYXNlLWJhY2tncm91bmQpOy0tY2stY29sb3ItYnV0dG9uLXNhdmU6IzAwOGEwMDstLWNrLWNvbG9yLWJ1dHRvbi1jYW5jZWw6I2RiMzcwMDstLWNrLWNvbG9yLXN3aXRjaC1idXR0b24tb2ZmLWJhY2tncm91bmQ6I2IwYjBiMDstLWNrLWNvbG9yLXN3aXRjaC1idXR0b24tb2ZmLWhvdmVyLWJhY2tncm91bmQ6I2EzYTNhMzstLWNrLWNvbG9yLXN3aXRjaC1idXR0b24tb24tYmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1idXR0b24tYWN0aW9uLWJhY2tncm91bmQpOy0tY2stY29sb3Itc3dpdGNoLWJ1dHRvbi1vbi1ob3Zlci1iYWNrZ3JvdW5kOiM1NzllM2Q7LS1jay1jb2xvci1zd2l0Y2gtYnV0dG9uLWlubmVyLWJhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYmFzZS1iYWNrZ3JvdW5kKTstLWNrLWNvbG9yLXN3aXRjaC1idXR0b24taW5uZXItc2hhZG93OnJnYmEoMCwwLDAsMC4xKTstLWNrLWNvbG9yLWRyb3Bkb3duLXBhbmVsLWJhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYmFzZS1iYWNrZ3JvdW5kKTstLWNrLWNvbG9yLWRyb3Bkb3duLXBhbmVsLWJvcmRlcjp2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcik7LS1jay1jb2xvci1pbnB1dC1iYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJhc2UtYmFja2dyb3VuZCk7LS1jay1jb2xvci1pbnB1dC1ib3JkZXI6I2M3YzdjNzstLWNrLWNvbG9yLWlucHV0LWVycm9yLWJvcmRlcjp2YXIoLS1jay1jb2xvci1iYXNlLWVycm9yKTstLWNrLWNvbG9yLWlucHV0LXRleHQ6dmFyKC0tY2stY29sb3ItYmFzZS10ZXh0KTstLWNrLWNvbG9yLWlucHV0LWRpc2FibGVkLWJhY2tncm91bmQ6I2YyZjJmMjstLWNrLWNvbG9yLWlucHV0LWRpc2FibGVkLWJvcmRlcjojYzdjN2M3Oy0tY2stY29sb3ItaW5wdXQtZGlzYWJsZWQtdGV4dDojNWM1YzVjOy0tY2stY29sb3ItbGlzdC1iYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJhc2UtYmFja2dyb3VuZCk7LS1jay1jb2xvci1saXN0LWJ1dHRvbi1ob3Zlci1iYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJ1dHRvbi1kZWZhdWx0LWhvdmVyLWJhY2tncm91bmQpOy0tY2stY29sb3ItbGlzdC1idXR0b24tb24tYmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1iYXNlLWFjdGl2ZSk7LS1jay1jb2xvci1saXN0LWJ1dHRvbi1vbi1iYWNrZ3JvdW5kLWZvY3VzOnZhcigtLWNrLWNvbG9yLWJhc2UtYWN0aXZlLWZvY3VzKTstLWNrLWNvbG9yLWxpc3QtYnV0dG9uLW9uLXRleHQ6dmFyKC0tY2stY29sb3ItYmFzZS1iYWNrZ3JvdW5kKTstLWNrLWNvbG9yLXBhbmVsLWJhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYmFzZS1iYWNrZ3JvdW5kKTstLWNrLWNvbG9yLXBhbmVsLWJvcmRlcjp2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcik7LS1jay1jb2xvci10b29sYmFyLWJhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYmFzZS1mb3JlZ3JvdW5kKTstLWNrLWNvbG9yLXRvb2xiYXItYm9yZGVyOnZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKTstLWNrLWNvbG9yLXRvb2x0aXAtYmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1iYXNlLXRleHQpOy0tY2stY29sb3ItdG9vbHRpcC10ZXh0OnZhcigtLWNrLWNvbG9yLWJhc2UtYmFja2dyb3VuZCk7LS1jay1jb2xvci1lbmdpbmUtcGxhY2Vob2xkZXItdGV4dDojNzA3MDcwOy0tY2stY29sb3ItdXBsb2FkLWJhci1iYWNrZ3JvdW5kOiM2Y2I1Zjk7LS1jay1jb2xvci1saW5rLWRlZmF1bHQ6IzAwMDBmMDstLWNrLWNvbG9yLWxpbmstc2VsZWN0ZWQtYmFja2dyb3VuZDpyZ2JhKDMxLDE3NywyNTUsMC4xKTstLWNrLWRpc2FibGVkLW9wYWNpdHk6LjU7LS1jay1mb2N1cy1vdXRlci1zaGFkb3ctZ2VvbWV0cnk6MCAwIDAgM3B4Oy0tY2stZm9jdXMtb3V0ZXItc2hhZG93OnZhcigtLWNrLWZvY3VzLW91dGVyLXNoYWRvdy1nZW9tZXRyeSkgdmFyKC0tY2stY29sb3ItZm9jdXMtb3V0ZXItc2hhZG93KTstLWNrLWZvY3VzLWRpc2FibGVkLW91dGVyLXNoYWRvdzp2YXIoLS1jay1mb2N1cy1vdXRlci1zaGFkb3ctZ2VvbWV0cnkpIHZhcigtLWNrLWNvbG9yLWZvY3VzLWRpc2FibGVkLXNoYWRvdyk7LS1jay1mb2N1cy1lcnJvci1vdXRlci1zaGFkb3c6dmFyKC0tY2stZm9jdXMtb3V0ZXItc2hhZG93LWdlb21ldHJ5KSB2YXIoLS1jay1jb2xvci1mb2N1cy1lcnJvci1zaGFkb3cpOy0tY2stZm9jdXMtcmluZzoxcHggc29saWQgdmFyKC0tY2stY29sb3ItZm9jdXMtYm9yZGVyKTstLWNrLWZvbnQtc2l6ZS1iYXNlOjEzcHg7LS1jay1saW5lLWhlaWdodC1iYXNlOjEuODQ2MTU7LS1jay1mb250LWZhY2U6SGVsdmV0aWNhLEFyaWFsLFRhaG9tYSxWZXJkYW5hLFNhbnMtU2VyaWY7LS1jay1mb250LXNpemUtdGlueTowLjdlbTstLWNrLWZvbnQtc2l6ZS1zbWFsbDowLjc1ZW07LS1jay1mb250LXNpemUtbm9ybWFsOjFlbTstLWNrLWZvbnQtc2l6ZS1iaWc6MS40ZW07LS1jay1mb250LXNpemUtbGFyZ2U6MS44ZW07LS1jay11aS1jb21wb25lbnQtbWluLWhlaWdodDoyLjNlbX0uY2suY2stcmVzZXQsLmNrLmNrLXJlc2V0X2FsbCwuY2suY2stcmVzZXRfYWxsICp7bWFyZ2luOjA7cGFkZGluZzowO2JvcmRlcjowO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7dmVydGljYWwtYWxpZ246bWlkZGxlO3RyYW5zaXRpb246bm9uZTt3b3JkLXdyYXA6YnJlYWstd29yZH0uY2suY2stcmVzZXRfYWxsLC5jay5jay1yZXNldF9hbGwgKntib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7Zm9udDpub3JtYWwgbm9ybWFsIG5vcm1hbCB2YXIoLS1jay1mb250LXNpemUtYmFzZSkvdmFyKC0tY2stbGluZS1oZWlnaHQtYmFzZSkgdmFyKC0tY2stZm9udC1mYWNlKTtjb2xvcjp2YXIoLS1jay1jb2xvci10ZXh0KTt0ZXh0LWFsaWduOmxlZnQ7d2hpdGUtc3BhY2U6bm93cmFwO2N1cnNvcjphdXRvO2Zsb2F0Om5vbmV9LmNrLmNrLXJlc2V0X2FsbCAuY2stcnRsICp7dGV4dC1hbGlnbjpyaWdodH0uY2suY2stcmVzZXRfYWxsIGlmcmFtZXt2ZXJ0aWNhbC1hbGlnbjppbmhlcml0fS5jay5jay1yZXNldF9hbGwgdGV4dGFyZWF7d2hpdGUtc3BhY2U6cHJlLXdyYXB9LmNrLmNrLXJlc2V0X2FsbCBpbnB1dFt0eXBlPXBhc3N3b3JkXSwuY2suY2stcmVzZXRfYWxsIGlucHV0W3R5cGU9dGV4dF0sLmNrLmNrLXJlc2V0X2FsbCB0ZXh0YXJlYXtjdXJzb3I6dGV4dH0uY2suY2stcmVzZXRfYWxsIGlucHV0W3R5cGU9cGFzc3dvcmRdW2Rpc2FibGVkXSwuY2suY2stcmVzZXRfYWxsIGlucHV0W3R5cGU9dGV4dF1bZGlzYWJsZWRdLC5jay5jay1yZXNldF9hbGwgdGV4dGFyZWFbZGlzYWJsZWRde2N1cnNvcjpkZWZhdWx0fS5jay5jay1yZXNldF9hbGwgZmllbGRzZXR7cGFkZGluZzoxMHB4O2JvcmRlcjoycHggZ3Jvb3ZlICNkZmRlZTN9LmNrLmNrLXJlc2V0X2FsbCBidXR0b246Oi1tb3otZm9jdXMtaW5uZXJ7cGFkZGluZzowO2JvcmRlcjowfS5ja1tkaXI9cnRsXSwuY2tbZGlyPXJ0bF0gLmNre3RleHQtYWxpZ246cmlnaHR9OnJvb3R7LS1jay1ib3JkZXItcmFkaXVzOjJweDstLWNrLWlubmVyLXNoYWRvdzoycHggMnB4IDNweCB2YXIoLS1jay1jb2xvci1zaGFkb3ctaW5uZXIpIGluc2V0Oy0tY2stZHJvcC1zaGFkb3c6MCAxcHggMnB4IDFweCB2YXIoLS1jay1jb2xvci1zaGFkb3ctZHJvcCk7LS1jay1kcm9wLXNoYWRvdy1hY3RpdmU6MCAzcHggNnB4IDFweCB2YXIoLS1jay1jb2xvci1zaGFkb3ctZHJvcC1hY3RpdmUpOy0tY2stc3BhY2luZy11bml0OjAuNmVtOy0tY2stc3BhY2luZy1sYXJnZTpjYWxjKHZhcigtLWNrLXNwYWNpbmctdW5pdCkqMS41KTstLWNrLXNwYWNpbmctc3RhbmRhcmQ6dmFyKC0tY2stc3BhY2luZy11bml0KTstLWNrLXNwYWNpbmctbWVkaXVtOmNhbGModmFyKC0tY2stc3BhY2luZy11bml0KSowLjgpOy0tY2stc3BhY2luZy1zbWFsbDpjYWxjKHZhcigtLWNrLXNwYWNpbmctdW5pdCkqMC41KTstLWNrLXNwYWNpbmctdGlueTpjYWxjKHZhcigtLWNrLXNwYWNpbmctdW5pdCkqMC4zKTstLWNrLXNwYWNpbmctZXh0cmEtdGlueTpjYWxjKHZhcigtLWNrLXNwYWNpbmctdW5pdCkqMC4xNil9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSgxOCk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gJzpyb290ey0tY2stYmFsbG9vbi1wYW5lbC1hcnJvdy16LWluZGV4OmNhbGModmFyKC0tY2stei1kZWZhdWx0KSAtIDMpfS5jay5jay1iYWxsb29uLXBhbmVse2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OnZhcigtLWNrLXotbW9kYWwpfS5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfd2l0aC1hcnJvdzphZnRlciwuY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX3dpdGgtYXJyb3c6YmVmb3Jle2NvbnRlbnQ6XCJcIjtwb3NpdGlvbjphYnNvbHV0ZX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX3dpdGgtYXJyb3c6YmVmb3Jle3otaW5kZXg6dmFyKC0tY2stYmFsbG9vbi1wYW5lbC1hcnJvdy16LWluZGV4KX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX3dpdGgtYXJyb3c6YWZ0ZXJ7ei1pbmRleDpjYWxjKHZhcigtLWNrLWJhbGxvb24tcGFuZWwtYXJyb3ctei1pbmRleCkgKyAxKX0uY2suY2stYmFsbG9vbi1wYW5lbFtjbGFzcyo9YXJyb3dfbl06YmVmb3Jle3otaW5kZXg6dmFyKC0tY2stYmFsbG9vbi1wYW5lbC1hcnJvdy16LWluZGV4KX0uY2suY2stYmFsbG9vbi1wYW5lbFtjbGFzcyo9YXJyb3dfbl06YWZ0ZXJ7ei1pbmRleDpjYWxjKHZhcigtLWNrLWJhbGxvb24tcGFuZWwtYXJyb3ctei1pbmRleCkgKyAxKX0uY2suY2stYmFsbG9vbi1wYW5lbFtjbGFzcyo9YXJyb3dfc106YmVmb3Jle3otaW5kZXg6dmFyKC0tY2stYmFsbG9vbi1wYW5lbC1hcnJvdy16LWluZGV4KX0uY2suY2stYmFsbG9vbi1wYW5lbFtjbGFzcyo9YXJyb3dfc106YWZ0ZXJ7ei1pbmRleDpjYWxjKHZhcigtLWNrLWJhbGxvb24tcGFuZWwtYXJyb3ctei1pbmRleCkgKyAxKX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX3Zpc2libGV7ZGlzcGxheTpibG9ja306cm9vdHstLWNrLWJhbGxvb24tYXJyb3ctb2Zmc2V0OjJweDstLWNrLWJhbGxvb24tYXJyb3ctaGVpZ2h0OjEwcHg7LS1jay1iYWxsb29uLWFycm93LWhhbGYtd2lkdGg6OHB4fS5jay5jay1iYWxsb29uLXBhbmVse2JvcmRlci1yYWRpdXM6MH0uY2stcm91bmRlZC1jb3JuZXJzIC5jay5jay1iYWxsb29uLXBhbmVsLC5jay5jay1iYWxsb29uLXBhbmVsLmNrLXJvdW5kZWQtY29ybmVyc3tib3JkZXItcmFkaXVzOnZhcigtLWNrLWJvcmRlci1yYWRpdXMpfS5jay5jay1iYWxsb29uLXBhbmVse2JveC1zaGFkb3c6dmFyKC0tY2stZHJvcC1zaGFkb3cpLDAgMDttaW4taGVpZ2h0OjE1cHg7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1wYW5lbC1iYWNrZ3JvdW5kKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLXBhbmVsLWJvcmRlcil9LmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF93aXRoLWFycm93OmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfd2l0aC1hcnJvdzpiZWZvcmV7d2lkdGg6MDtoZWlnaHQ6MDtib3JkZXItc3R5bGU6c29saWR9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X25dOmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsW2NsYXNzKj1hcnJvd19uXTpiZWZvcmV7Ym9yZGVyLWxlZnQtd2lkdGg6dmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKTtib3JkZXItYm90dG9tLXdpZHRoOnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGVpZ2h0KTtib3JkZXItcmlnaHQtd2lkdGg6dmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKTtib3JkZXItdG9wLXdpZHRoOjB9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X25dOmJlZm9yZXtib3JkZXItYm90dG9tLWNvbG9yOnZhcigtLWNrLWNvbG9yLXBhbmVsLWJvcmRlcil9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X25dOmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsW2NsYXNzKj1hcnJvd19uXTpiZWZvcmV7Ym9yZGVyLWxlZnQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLXJpZ2h0LWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci10b3AtY29sb3I6dHJhbnNwYXJlbnR9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X25dOmFmdGVye2JvcmRlci1ib3R0b20tY29sb3I6dmFyKC0tY2stY29sb3ItcGFuZWwtYmFja2dyb3VuZCk7bWFyZ2luLXRvcDp2YXIoLS1jay1iYWxsb29uLWFycm93LW9mZnNldCl9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X3NdOmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsW2NsYXNzKj1hcnJvd19zXTpiZWZvcmV7Ym9yZGVyLWxlZnQtd2lkdGg6dmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKTtib3JkZXItYm90dG9tLXdpZHRoOjA7Ym9yZGVyLXJpZ2h0LXdpZHRoOnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGFsZi13aWR0aCk7Ym9yZGVyLXRvcC13aWR0aDp2YXIoLS1jay1iYWxsb29uLWFycm93LWhlaWdodCl9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X3NdOmJlZm9yZXtib3JkZXItdG9wLWNvbG9yOnZhcigtLWNrLWNvbG9yLXBhbmVsLWJvcmRlcil9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X3NdOmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsW2NsYXNzKj1hcnJvd19zXTpiZWZvcmV7Ym9yZGVyLWxlZnQtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLWJvdHRvbS1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItcmlnaHQtY29sb3I6dHJhbnNwYXJlbnR9LmNrLmNrLWJhbGxvb24tcGFuZWxbY2xhc3MqPWFycm93X3NdOmFmdGVye2JvcmRlci10b3AtY29sb3I6dmFyKC0tY2stY29sb3ItcGFuZWwtYmFja2dyb3VuZCk7bWFyZ2luLWJvdHRvbTp2YXIoLS1jay1iYWxsb29uLWFycm93LW9mZnNldCl9LmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19uOmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfbjpiZWZvcmV7bGVmdDo1MCU7bWFyZ2luLWxlZnQ6Y2FsYygtMSp2YXIoLS1jay1iYWxsb29uLWFycm93LWhhbGYtd2lkdGgpKTt0b3A6Y2FsYygtMSp2YXIoLS1jay1iYWxsb29uLWFycm93LWhlaWdodCkpfS5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfbnc6YWZ0ZXIsLmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19udzpiZWZvcmV7bGVmdDpjYWxjKDIqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKSk7dG9wOmNhbGMoLTEqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oZWlnaHQpKX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X25lOmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfbmU6YmVmb3Jle3JpZ2h0OmNhbGMoMip2YXIoLS1jay1iYWxsb29uLWFycm93LWhhbGYtd2lkdGgpKTt0b3A6Y2FsYygtMSp2YXIoLS1jay1iYWxsb29uLWFycm93LWhlaWdodCkpfS5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfczphZnRlciwuY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3M6YmVmb3Jle2xlZnQ6NTAlO21hcmdpbi1sZWZ0OmNhbGMoLTEqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKSk7Ym90dG9tOmNhbGMoLTEqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oZWlnaHQpKX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3N3OmFmdGVyLC5jay5jay1iYWxsb29uLXBhbmVsLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfc3c6YmVmb3Jle2xlZnQ6Y2FsYygyKnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGFsZi13aWR0aCkpO2JvdHRvbTpjYWxjKC0xKnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGVpZ2h0KSl9LmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19zZTphZnRlciwuY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3NlOmJlZm9yZXtyaWdodDpjYWxjKDIqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKSk7Ym90dG9tOmNhbGMoLTEqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oZWlnaHQpKX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3NtZTphZnRlciwuY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3NtZTpiZWZvcmV7cmlnaHQ6MjUlO21hcmdpbi1yaWdodDpjYWxjKDIqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oYWxmLXdpZHRoKSk7Ym90dG9tOmNhbGMoLTEqdmFyKC0tY2stYmFsbG9vbi1hcnJvdy1oZWlnaHQpKX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3NtdzphZnRlciwuY2suY2stYmFsbG9vbi1wYW5lbC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3NtdzpiZWZvcmV7bGVmdDoyNSU7bWFyZ2luLWxlZnQ6Y2FsYygyKnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGFsZi13aWR0aCkpO2JvdHRvbTpjYWxjKC0xKnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGVpZ2h0KSl9LmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19ubWU6YWZ0ZXIsLmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19ubWU6YmVmb3Jle3JpZ2h0OjI1JTttYXJnaW4tcmlnaHQ6Y2FsYygyKnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGFsZi13aWR0aCkpO3RvcDpjYWxjKC0xKnZhcigtLWNrLWJhbGxvb24tYXJyb3ctaGVpZ2h0KSl9LmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19ubXc6YWZ0ZXIsLmNrLmNrLWJhbGxvb24tcGFuZWwuY2stYmFsbG9vbi1wYW5lbF9hcnJvd19ubXc6YmVmb3Jle2xlZnQ6MjUlO21hcmdpbi1sZWZ0OmNhbGMoMip2YXIoLS1jay1iYWxsb29uLWFycm93LWhhbGYtd2lkdGgpKTt0b3A6Y2FsYygtMSp2YXIoLS1jay1iYWxsb29uLWFycm93LWhlaWdodCkpfSdcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSgyMCk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2staWNvbnt2ZXJ0aWNhbC1hbGlnbjptaWRkbGV9OnJvb3R7LS1jay1pY29uLXNpemU6Y2FsYyh2YXIoLS1jay1saW5lLWhlaWdodC1iYXNlKSp2YXIoLS1jay1mb250LXNpemUtbm9ybWFsKSl9LmNrLmNrLWljb257d2lkdGg6dmFyKC0tY2staWNvbi1zaXplKTtoZWlnaHQ6dmFyKC0tY2staWNvbi1zaXplKTtmb250LXNpemU6LjgzMzMzNTA2OTRlbTt3aWxsLWNoYW5nZTp0cmFuc2Zvcm19LmNrLmNrLWljb24sLmNrLmNrLWljb24gKntjb2xvcjppbmhlcml0O2N1cnNvcjppbmhlcml0fS5jay5jay1pY29uIDpub3QoW2ZpbGxdKXtmaWxsOmN1cnJlbnRDb2xvcn1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDIyKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSAnLmNrLmNrLXRvb2x0aXAsLmNrLmNrLXRvb2x0aXAgLmNrLXRvb2x0aXBfX3RleHQ6YWZ0ZXJ7cG9zaXRpb246YWJzb2x1dGU7cG9pbnRlci1ldmVudHM6bm9uZTstd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVufS5jay5jay10b29sdGlwe3Zpc2liaWxpdHk6aGlkZGVuO29wYWNpdHk6MDtkaXNwbGF5Om5vbmU7ei1pbmRleDp2YXIoLS1jay16LW1vZGFsKX0uY2suY2stdG9vbHRpcCAuY2stdG9vbHRpcF9fdGV4dHtkaXNwbGF5OmlubGluZS1ibG9ja30uY2suY2stdG9vbHRpcCAuY2stdG9vbHRpcF9fdGV4dDphZnRlcntjb250ZW50OlwiXCI7d2lkdGg6MDtoZWlnaHQ6MH06cm9vdHstLWNrLXRvb2x0aXAtYXJyb3ctc2l6ZTo1cHh9LmNrLmNrLXRvb2x0aXB7bGVmdDo1MCU7dG9wOjA7dHJhbnNpdGlvbjpvcGFjaXR5IC4ycyBlYXNlLWluLW91dCAuMnN9LmNrLmNrLXRvb2x0aXAgLmNrLXRvb2x0aXBfX3RleHR7Ym9yZGVyLXJhZGl1czowfS5jay1yb3VuZGVkLWNvcm5lcnMgLmNrLmNrLXRvb2x0aXAgLmNrLXRvb2x0aXBfX3RleHQsLmNrLmNrLXRvb2x0aXAgLmNrLXRvb2x0aXBfX3RleHQuY2stcm91bmRlZC1jb3JuZXJze2JvcmRlci1yYWRpdXM6dmFyKC0tY2stYm9yZGVyLXJhZGl1cyl9LmNrLmNrLXRvb2x0aXAgLmNrLXRvb2x0aXBfX3RleHR7Zm9udC1zaXplOi45ZW07bGluZS1oZWlnaHQ6MS41O2NvbG9yOnZhcigtLWNrLWNvbG9yLXRvb2x0aXAtdGV4dCk7cGFkZGluZzp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKSB2YXIoLS1jay1zcGFjaW5nLW1lZGl1bSk7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci10b29sdGlwLWJhY2tncm91bmQpO3Bvc2l0aW9uOnJlbGF0aXZlO2xlZnQ6LTUwJX0uY2suY2stdG9vbHRpcCAuY2stdG9vbHRpcF9fdGV4dDphZnRlcnt0cmFuc2l0aW9uOm9wYWNpdHkgLjJzIGVhc2UtaW4tb3V0IC4ycztib3JkZXItc3R5bGU6c29saWQ7bGVmdDo1MCV9LmNrLmNrLXRvb2x0aXAuY2stdG9vbHRpcF9ze2JvdHRvbTpjYWxjKC0xKnZhcigtLWNrLXRvb2x0aXAtYXJyb3ctc2l6ZSkpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDEwMCUpfS5jay5jay10b29sdGlwLmNrLXRvb2x0aXBfcyAuY2stdG9vbHRpcF9fdGV4dDphZnRlcnt0b3A6Y2FsYygtMSp2YXIoLS1jay10b29sdGlwLWFycm93LXNpemUpKTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtib3JkZXItbGVmdC1jb2xvcjp0cmFuc3BhcmVudDtib3JkZXItYm90dG9tLWNvbG9yOnZhcigtLWNrLWNvbG9yLXRvb2x0aXAtYmFja2dyb3VuZCk7Ym9yZGVyLXJpZ2h0LWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci10b3AtY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLWxlZnQtd2lkdGg6dmFyKC0tY2stdG9vbHRpcC1hcnJvdy1zaXplKTtib3JkZXItYm90dG9tLXdpZHRoOnZhcigtLWNrLXRvb2x0aXAtYXJyb3ctc2l6ZSk7Ym9yZGVyLXJpZ2h0LXdpZHRoOnZhcigtLWNrLXRvb2x0aXAtYXJyb3ctc2l6ZSk7Ym9yZGVyLXRvcC13aWR0aDowfS5jay5jay10b29sdGlwLmNrLXRvb2x0aXBfbnt0b3A6Y2FsYygtMSp2YXIoLS1jay10b29sdGlwLWFycm93LXNpemUpKTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMTAwJSl9LmNrLmNrLXRvb2x0aXAuY2stdG9vbHRpcF9uIC5jay10b29sdGlwX190ZXh0OmFmdGVye2JvdHRvbTpjYWxjKC0xKnZhcigtLWNrLXRvb2x0aXAtYXJyb3ctc2l6ZSkpO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO2JvcmRlci1sZWZ0LWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci1ib3R0b20tY29sb3I6dHJhbnNwYXJlbnQ7Ym9yZGVyLXJpZ2h0LWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci10b3AtY29sb3I6dmFyKC0tY2stY29sb3ItdG9vbHRpcC1iYWNrZ3JvdW5kKTtib3JkZXItbGVmdC13aWR0aDp2YXIoLS1jay10b29sdGlwLWFycm93LXNpemUpO2JvcmRlci1ib3R0b20td2lkdGg6MDtib3JkZXItcmlnaHQtd2lkdGg6dmFyKC0tY2stdG9vbHRpcC1hcnJvdy1zaXplKTtib3JkZXItdG9wLXdpZHRoOnZhcigtLWNrLXRvb2x0aXAtYXJyb3ctc2l6ZSl9J1xyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDI0KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay1idXR0b24sYS5jay5jay1idXR0b257LW1vei11c2VyLXNlbGVjdDpub25lOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTstbXMtdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lfS5jay5jay1idXR0b24gLmNrLXRvb2x0aXAsYS5jay5jay1idXR0b24gLmNrLXRvb2x0aXB7ZGlzcGxheTpibG9ja31AbWVkaWEgKGhvdmVyOm5vbmUpey5jay5jay1idXR0b24gLmNrLXRvb2x0aXAsYS5jay5jay1idXR0b24gLmNrLXRvb2x0aXB7ZGlzcGxheTpub25lfX0uY2suY2stYnV0dG9uLGEuY2suY2stYnV0dG9ue3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpsZWZ0fS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWwsYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWx7ZGlzcGxheTpub25lfS5jay5jay1idXR0b24uY2stYnV0dG9uX3dpdGgtdGV4dCAuY2stYnV0dG9uX19sYWJlbCxhLmNrLmNrLWJ1dHRvbi5jay1idXR0b25fd2l0aC10ZXh0IC5jay1idXR0b25fX2xhYmVse2Rpc3BsYXk6aW5saW5lLWJsb2NrfS5jay5jay1idXR0b246bm90KC5jay1idXR0b25fd2l0aC10ZXh0KSxhLmNrLmNrLWJ1dHRvbjpub3QoLmNrLWJ1dHRvbl93aXRoLXRleHQpe2p1c3RpZnktY29udGVudDpjZW50ZXJ9LmNrLmNrLWJ1dHRvbjpob3ZlciAuY2stdG9vbHRpcCxhLmNrLmNrLWJ1dHRvbjpob3ZlciAuY2stdG9vbHRpcHt2aXNpYmlsaXR5OnZpc2libGU7b3BhY2l0eToxfS5jay5jay1idXR0b246Zm9jdXM6bm90KDpob3ZlcikgLmNrLXRvb2x0aXAsYS5jay5jay1idXR0b246Zm9jdXM6bm90KDpob3ZlcikgLmNrLXRvb2x0aXB7ZGlzcGxheTpub25lfS5jay5jay1idXR0b24sYS5jay5jay1idXR0b257YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1idXR0b24tZGVmYXVsdC1iYWNrZ3JvdW5kKX0uY2suY2stYnV0dG9uOm5vdCguY2stZGlzYWJsZWQpOmhvdmVyLGEuY2suY2stYnV0dG9uOm5vdCguY2stZGlzYWJsZWQpOmhvdmVye2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYnV0dG9uLWRlZmF1bHQtaG92ZXItYmFja2dyb3VuZCl9LmNrLmNrLWJ1dHRvbjpub3QoLmNrLWRpc2FibGVkKTphY3RpdmUsYS5jay5jay1idXR0b246bm90KC5jay1kaXNhYmxlZCk6YWN0aXZle2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYnV0dG9uLWRlZmF1bHQtYWN0aXZlLWJhY2tncm91bmQpO2JveC1zaGFkb3c6aW5zZXQgMCAycHggMnB4IHZhcigtLWNrLWNvbG9yLWJ1dHRvbi1kZWZhdWx0LWFjdGl2ZS1zaGFkb3cpfS5jay5jay1idXR0b24uY2stZGlzYWJsZWQsYS5jay5jay1idXR0b24uY2stZGlzYWJsZWR7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1idXR0b24tZGVmYXVsdC1kaXNhYmxlZC1iYWNrZ3JvdW5kKX0uY2suY2stYnV0dG9uLGEuY2suY2stYnV0dG9ue2JvcmRlci1yYWRpdXM6MH0uY2stcm91bmRlZC1jb3JuZXJzIC5jay5jay1idXR0b24sLmNrLXJvdW5kZWQtY29ybmVycyBhLmNrLmNrLWJ1dHRvbiwuY2suY2stYnV0dG9uLmNrLXJvdW5kZWQtY29ybmVycyxhLmNrLmNrLWJ1dHRvbi5jay1yb3VuZGVkLWNvcm5lcnN7Ym9yZGVyLXJhZGl1czp2YXIoLS1jay1ib3JkZXItcmFkaXVzKX0uY2suY2stYnV0dG9uLGEuY2suY2stYnV0dG9ue3doaXRlLXNwYWNlOm5vd3JhcDtjdXJzb3I6ZGVmYXVsdDt2ZXJ0aWNhbC1hbGlnbjptaWRkbGU7cGFkZGluZzp2YXIoLS1jay1zcGFjaW5nLXRpbnkpO3RleHQtYWxpZ246Y2VudGVyO21pbi13aWR0aDp2YXIoLS1jay11aS1jb21wb25lbnQtbWluLWhlaWdodCk7bWluLWhlaWdodDp2YXIoLS1jay11aS1jb21wb25lbnQtbWluLWhlaWdodCk7bGluZS1oZWlnaHQ6MTtmb250LXNpemU6aW5oZXJpdDtib3JkZXI6MXB4IHNvbGlkIHRyYW5zcGFyZW50O3RyYW5zaXRpb246Ym94LXNoYWRvdyAuMnMgZWFzZS1pbi1vdXQsYm9yZGVyIC4ycyBlYXNlLWluLW91dDstd2Via2l0LWFwcGVhcmFuY2U6bm9uZX0uY2suY2stYnV0dG9uOmFjdGl2ZSwuY2suY2stYnV0dG9uOmZvY3VzLGEuY2suY2stYnV0dG9uOmFjdGl2ZSxhLmNrLmNrLWJ1dHRvbjpmb2N1c3tvdXRsaW5lOm5vbmU7Ym9yZGVyOnZhcigtLWNrLWZvY3VzLXJpbmcpO2JveC1zaGFkb3c6dmFyKC0tY2stZm9jdXMtb3V0ZXItc2hhZG93KSwwIDB9LmNrLmNrLWJ1dHRvbiAuY2stYnV0dG9uX19pY29uIHVzZSwuY2suY2stYnV0dG9uIC5jay1idXR0b25fX2ljb24gdXNlICosYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9faWNvbiB1c2UsYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9faWNvbiB1c2UgKntjb2xvcjppbmhlcml0fS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWwsYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWx7Zm9udC1zaXplOmluaGVyaXQ7Zm9udC13ZWlnaHQ6aW5oZXJpdDtjb2xvcjppbmhlcml0O2N1cnNvcjppbmhlcml0O3ZlcnRpY2FsLWFsaWduOm1pZGRsZX1bZGlyPWx0cl0gLmNrLmNrLWJ1dHRvbiAuY2stYnV0dG9uX19sYWJlbCxbZGlyPWx0cl0gYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWx7dGV4dC1hbGlnbjpsZWZ0fVtkaXI9cnRsXSAuY2suY2stYnV0dG9uIC5jay1idXR0b25fX2xhYmVsLFtkaXI9cnRsXSBhLmNrLmNrLWJ1dHRvbiAuY2stYnV0dG9uX19sYWJlbHt0ZXh0LWFsaWduOnJpZ2h0fS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fa2V5c3Ryb2tlLGEuY2suY2stYnV0dG9uIC5jay1idXR0b25fX2tleXN0cm9rZXtjb2xvcjppbmhlcml0fVtkaXI9bHRyXSAuY2suY2stYnV0dG9uIC5jay1idXR0b25fX2tleXN0cm9rZSxbZGlyPWx0cl0gYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fa2V5c3Ryb2tle21hcmdpbi1sZWZ0OnZhcigtLWNrLXNwYWNpbmctbGFyZ2UpfVtkaXI9cnRsXSAuY2suY2stYnV0dG9uIC5jay1idXR0b25fX2tleXN0cm9rZSxbZGlyPXJ0bF0gYS5jay5jay1idXR0b24gLmNrLWJ1dHRvbl9fa2V5c3Ryb2tle21hcmdpbi1yaWdodDp2YXIoLS1jay1zcGFjaW5nLWxhcmdlKX0uY2suY2stYnV0dG9uIC5jay1idXR0b25fX2tleXN0cm9rZSxhLmNrLmNrLWJ1dHRvbiAuY2stYnV0dG9uX19rZXlzdHJva2V7Zm9udC13ZWlnaHQ6NzAwO29wYWNpdHk6Ljd9LmNrLmNrLWJ1dHRvbi5jay1kaXNhYmxlZDphY3RpdmUsLmNrLmNrLWJ1dHRvbi5jay1kaXNhYmxlZDpmb2N1cyxhLmNrLmNrLWJ1dHRvbi5jay1kaXNhYmxlZDphY3RpdmUsYS5jay5jay1idXR0b24uY2stZGlzYWJsZWQ6Zm9jdXN7Ym94LXNoYWRvdzp2YXIoLS1jay1mb2N1cy1kaXNhYmxlZC1vdXRlci1zaGFkb3cpLDAgMH0uY2suY2stYnV0dG9uLmNrLWRpc2FibGVkIC5jay1idXR0b25fX2ljb24sYS5jay5jay1idXR0b24uY2stZGlzYWJsZWQgLmNrLWJ1dHRvbl9faWNvbntvcGFjaXR5OnZhcigtLWNrLWRpc2FibGVkLW9wYWNpdHkpfS5jay5jay1idXR0b24uY2stZGlzYWJsZWQgLmNrLWJ1dHRvbl9fbGFiZWwsYS5jay5jay1idXR0b24uY2stZGlzYWJsZWQgLmNrLWJ1dHRvbl9fbGFiZWx7b3BhY2l0eTp2YXIoLS1jay1kaXNhYmxlZC1vcGFjaXR5KX0uY2suY2stYnV0dG9uLmNrLWRpc2FibGVkIC5jay1idXR0b25fX2tleXN0cm9rZSxhLmNrLmNrLWJ1dHRvbi5jay1kaXNhYmxlZCAuY2stYnV0dG9uX19rZXlzdHJva2V7b3BhY2l0eTouM30uY2suY2stYnV0dG9uLmNrLWJ1dHRvbl93aXRoLXRleHQsYS5jay5jay1idXR0b24uY2stYnV0dG9uX3dpdGgtdGV4dHtwYWRkaW5nOnZhcigtLWNrLXNwYWNpbmctdGlueSkgdmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9W2Rpcj1sdHJdIC5jay5jay1idXR0b24uY2stYnV0dG9uX3dpdGgtdGV4dCAuY2stYnV0dG9uX19pY29uLFtkaXI9bHRyXSBhLmNrLmNrLWJ1dHRvbi5jay1idXR0b25fd2l0aC10ZXh0IC5jay1idXR0b25fX2ljb257bWFyZ2luLWxlZnQ6Y2FsYygtMSp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKSk7bWFyZ2luLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfVtkaXI9cnRsXSAuY2suY2stYnV0dG9uLmNrLWJ1dHRvbl93aXRoLXRleHQgLmNrLWJ1dHRvbl9faWNvbixbZGlyPXJ0bF0gYS5jay5jay1idXR0b24uY2stYnV0dG9uX3dpdGgtdGV4dCAuY2stYnV0dG9uX19pY29ue21hcmdpbi1yaWdodDpjYWxjKC0xKnZhcigtLWNrLXNwYWNpbmctc21hbGwpKTttYXJnaW4tbGVmdDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2suY2stYnV0dG9uLmNrLWJ1dHRvbl93aXRoLWtleXN0cm9rZSAuY2stYnV0dG9uX19sYWJlbCxhLmNrLmNrLWJ1dHRvbi5jay1idXR0b25fd2l0aC1rZXlzdHJva2UgLmNrLWJ1dHRvbl9fbGFiZWx7ZmxleC1ncm93OjF9LmNrLmNrLWJ1dHRvbi5jay1vbixhLmNrLmNrLWJ1dHRvbi5jay1vbntiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJ1dHRvbi1vbi1iYWNrZ3JvdW5kKX0uY2suY2stYnV0dG9uLmNrLW9uOm5vdCguY2stZGlzYWJsZWQpOmhvdmVyLGEuY2suY2stYnV0dG9uLmNrLW9uOm5vdCguY2stZGlzYWJsZWQpOmhvdmVye2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYnV0dG9uLW9uLWhvdmVyLWJhY2tncm91bmQpfS5jay5jay1idXR0b24uY2stb246bm90KC5jay1kaXNhYmxlZCk6YWN0aXZlLGEuY2suY2stYnV0dG9uLmNrLW9uOm5vdCguY2stZGlzYWJsZWQpOmFjdGl2ZXtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJ1dHRvbi1vbi1hY3RpdmUtYmFja2dyb3VuZCk7Ym94LXNoYWRvdzppbnNldCAwIDJweCAycHggdmFyKC0tY2stY29sb3ItYnV0dG9uLW9uLWFjdGl2ZS1zaGFkb3cpfS5jay5jay1idXR0b24uY2stb24uY2stZGlzYWJsZWQsYS5jay5jay1idXR0b24uY2stb24uY2stZGlzYWJsZWR7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1idXR0b24tb24tZGlzYWJsZWQtYmFja2dyb3VuZCl9LmNrLmNrLWJ1dHRvbi5jay1idXR0b24tc2F2ZSxhLmNrLmNrLWJ1dHRvbi5jay1idXR0b24tc2F2ZXtjb2xvcjp2YXIoLS1jay1jb2xvci1idXR0b24tc2F2ZSl9LmNrLmNrLWJ1dHRvbi5jay1idXR0b24tY2FuY2VsLGEuY2suY2stYnV0dG9uLmNrLWJ1dHRvbi1jYW5jZWx7Y29sb3I6dmFyKC0tY2stY29sb3ItYnV0dG9uLWNhbmNlbCl9LmNrLmNrLWJ1dHRvbi1hY3Rpb24sYS5jay5jay1idXR0b24tYWN0aW9ue2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYnV0dG9uLWFjdGlvbi1iYWNrZ3JvdW5kKX0uY2suY2stYnV0dG9uLWFjdGlvbjpub3QoLmNrLWRpc2FibGVkKTpob3ZlcixhLmNrLmNrLWJ1dHRvbi1hY3Rpb246bm90KC5jay1kaXNhYmxlZCk6aG92ZXJ7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1idXR0b24tYWN0aW9uLWhvdmVyLWJhY2tncm91bmQpfS5jay5jay1idXR0b24tYWN0aW9uOm5vdCguY2stZGlzYWJsZWQpOmFjdGl2ZSxhLmNrLmNrLWJ1dHRvbi1hY3Rpb246bm90KC5jay1kaXNhYmxlZCk6YWN0aXZle2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYnV0dG9uLWFjdGlvbi1hY3RpdmUtYmFja2dyb3VuZCk7Ym94LXNoYWRvdzppbnNldCAwIDJweCAycHggdmFyKC0tY2stY29sb3ItYnV0dG9uLWFjdGlvbi1hY3RpdmUtc2hhZG93KX0uY2suY2stYnV0dG9uLWFjdGlvbi5jay1kaXNhYmxlZCxhLmNrLmNrLWJ1dHRvbi1hY3Rpb24uY2stZGlzYWJsZWR7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1idXR0b24tYWN0aW9uLWRpc2FibGVkLWJhY2tncm91bmQpfS5jay5jay1idXR0b24tYWN0aW9uLGEuY2suY2stYnV0dG9uLWFjdGlvbntjb2xvcjp2YXIoLS1jay1jb2xvci1idXR0b24tYWN0aW9uLXRleHQpfS5jay5jay1idXR0b24tYm9sZCxhLmNrLmNrLWJ1dHRvbi1ib2xke2ZvbnQtd2VpZ2h0OjcwMH1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDI2KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jayAuY2stYmFsbG9vbi1yb3RhdG9yX19uYXZpZ2F0aW9ue2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uY2sgLmNrLWJhbGxvb24tcm90YXRvcl9fY29udGVudCAuY2stdG9vbGJhcntqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5jayAuY2stYmFsbG9vbi1yb3RhdG9yX19uYXZpZ2F0aW9ue2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItdG9vbGJhci1iYWNrZ3JvdW5kKTtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci10b29sYmFyLWJvcmRlcik7cGFkZGluZzowIHZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jayAuY2stYmFsbG9vbi1yb3RhdG9yX19uYXZpZ2F0aW9uPip7bWFyZ2luLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpO21hcmdpbi10b3A6dmFyKC0tY2stc3BhY2luZy1zbWFsbCk7bWFyZ2luLWJvdHRvbTp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2sgLmNrLWJhbGxvb24tcm90YXRvcl9fbmF2aWdhdGlvbiAuY2stYmFsbG9vbi1yb3RhdG9yX19jb3VudGVye21hcmdpbi1yaWdodDp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTttYXJnaW4tbGVmdDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2sgLmNrLWJhbGxvb24tcm90YXRvcl9fY29udGVudCAuY2suY2stYW5ub3RhdGlvbi13cmFwcGVye2JveC1zaGFkb3c6bm9uZX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDI4KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jayAuY2stZmFrZS1wYW5lbHtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OmNhbGModmFyKC0tY2stei1tb2RhbCkgLSAxKX0uY2sgLmNrLWZha2UtcGFuZWwgZGl2e3Bvc2l0aW9uOmFic29sdXRlfS5jayAuY2stZmFrZS1wYW5lbCBkaXY6Zmlyc3QtY2hpbGR7ei1pbmRleDoyfS5jayAuY2stZmFrZS1wYW5lbCBkaXY6bnRoLWNoaWxkKDIpe3otaW5kZXg6MX06cm9vdHstLWNrLWJhbGxvb24tZmFrZS1wYW5lbC1vZmZzZXQtaG9yaXpvbnRhbDo2cHg7LS1jay1iYWxsb29uLWZha2UtcGFuZWwtb2Zmc2V0LXZlcnRpY2FsOjZweH0uY2sgLmNrLWZha2UtcGFuZWwgZGl2e2JveC1zaGFkb3c6dmFyKC0tY2stZHJvcC1zaGFkb3cpLDAgMDttaW4taGVpZ2h0OjE1cHg7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1wYW5lbC1iYWNrZ3JvdW5kKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLXBhbmVsLWJvcmRlcik7Ym9yZGVyLXJhZGl1czp2YXIoLS1jay1ib3JkZXItcmFkaXVzKTt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfS5jayAuY2stZmFrZS1wYW5lbCBkaXY6Zmlyc3QtY2hpbGR7bWFyZ2luLWxlZnQ6dmFyKC0tY2stYmFsbG9vbi1mYWtlLXBhbmVsLW9mZnNldC1ob3Jpem9udGFsKTttYXJnaW4tdG9wOnZhcigtLWNrLWJhbGxvb24tZmFrZS1wYW5lbC1vZmZzZXQtdmVydGljYWwpfS5jayAuY2stZmFrZS1wYW5lbCBkaXY6bnRoLWNoaWxkKDIpe21hcmdpbi1sZWZ0OmNhbGModmFyKC0tY2stYmFsbG9vbi1mYWtlLXBhbmVsLW9mZnNldC1ob3Jpem9udGFsKSoyKTttYXJnaW4tdG9wOmNhbGModmFyKC0tY2stYmFsbG9vbi1mYWtlLXBhbmVsLW9mZnNldC12ZXJ0aWNhbCkqMil9LmNrIC5jay1mYWtlLXBhbmVsIGRpdjpudGgtY2hpbGQoMyl7bWFyZ2luLWxlZnQ6Y2FsYyh2YXIoLS1jay1iYWxsb29uLWZha2UtcGFuZWwtb2Zmc2V0LWhvcml6b250YWwpKjMpO21hcmdpbi10b3A6Y2FsYyh2YXIoLS1jay1iYWxsb29uLWZha2UtcGFuZWwtb2Zmc2V0LXZlcnRpY2FsKSozKX0uY2sgLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfcysuY2stZmFrZS1wYW5lbCwuY2sgLmNrLWJhbGxvb24tcGFuZWxfYXJyb3dfc2UrLmNrLWZha2UtcGFuZWwsLmNrIC5jay1iYWxsb29uLXBhbmVsX2Fycm93X3N3Ky5jay1mYWtlLXBhbmVsey0tY2stYmFsbG9vbi1mYWtlLXBhbmVsLW9mZnNldC12ZXJ0aWNhbDotNnB4fVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMzApO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWRyb3Bkb3due2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOnJlbGF0aXZlfS5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX2Fycm93e3BvaW50ZXItZXZlbnRzOm5vbmU7ei1pbmRleDp2YXIoLS1jay16LWRlZmF1bHQpfS5jay5jay1kcm9wZG93biAuY2stYnV0dG9uLmNrLWRyb3Bkb3duX19idXR0b257d2lkdGg6MTAwJX0uY2suY2stZHJvcGRvd24gLmNrLWJ1dHRvbi5jay1kcm9wZG93bl9fYnV0dG9uLmNrLW9uIC5jay10b29sdGlwe2Rpc3BsYXk6bm9uZX0uY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbHstd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuO2Rpc3BsYXk6bm9uZTt6LWluZGV4OnZhcigtLWNrLXotbW9kYWwpO3Bvc2l0aW9uOmFic29sdXRlfS5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsLmNrLWRyb3Bkb3duX19wYW5lbC12aXNpYmxle2Rpc3BsYXk6aW5saW5lLWJsb2NrfS5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsLmNrLWRyb3Bkb3duX19wYW5lbF9uZSwuY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbC5jay1kcm9wZG93bl9fcGFuZWxfbnd7Ym90dG9tOjEwMCV9LmNrLmNrLWRyb3Bkb3duIC5jay1kcm9wZG93bl9fcGFuZWwuY2stZHJvcGRvd25fX3BhbmVsX3NlLC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsLmNrLWRyb3Bkb3duX19wYW5lbF9zd3t0b3A6MTAwJTtib3R0b206YXV0b30uY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbC5jay1kcm9wZG93bl9fcGFuZWxfbmUsLmNrLmNrLWRyb3Bkb3duIC5jay1kcm9wZG93bl9fcGFuZWwuY2stZHJvcGRvd25fX3BhbmVsX3Nle2xlZnQ6MH0uY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbC5jay1kcm9wZG93bl9fcGFuZWxfbncsLmNrLmNrLWRyb3Bkb3duIC5jay1kcm9wZG93bl9fcGFuZWwuY2stZHJvcGRvd25fX3BhbmVsX3N3e3JpZ2h0OjB9OnJvb3R7LS1jay1kcm9wZG93bi1hcnJvdy1zaXplOmNhbGMoMC41KnZhcigtLWNrLWljb24tc2l6ZSkpfS5jay5jay1kcm9wZG93bntmb250LXNpemU6aW5oZXJpdH0uY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19hcnJvd3t3aWR0aDp2YXIoLS1jay1kcm9wZG93bi1hcnJvdy1zaXplKX1bZGlyPWx0cl0gLmNrLmNrLWRyb3Bkb3duIC5jay1kcm9wZG93bl9fYXJyb3d7cmlnaHQ6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCk7bWFyZ2luLWxlZnQ6dmFyKC0tY2stc3BhY2luZy1zbWFsbCl9W2Rpcj1ydGxdIC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX2Fycm93e2xlZnQ6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCk7bWFyZ2luLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jay5jay1kcm9wZG93bi5jay1kaXNhYmxlZCAuY2stZHJvcGRvd25fX2Fycm93e29wYWNpdHk6dmFyKC0tY2stZGlzYWJsZWQtb3BhY2l0eSl9W2Rpcj1sdHJdIC5jay5jay1kcm9wZG93biAuY2stYnV0dG9uLmNrLWRyb3Bkb3duX19idXR0b246bm90KC5jay1idXR0b25fd2l0aC10ZXh0KXtwYWRkaW5nLWxlZnQ6dmFyKC0tY2stc3BhY2luZy1zbWFsbCl9W2Rpcj1ydGxdIC5jay5jay1kcm9wZG93biAuY2stYnV0dG9uLmNrLWRyb3Bkb3duX19idXR0b246bm90KC5jay1idXR0b25fd2l0aC10ZXh0KXtwYWRkaW5nLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jay5jay1kcm9wZG93biAuY2stYnV0dG9uLmNrLWRyb3Bkb3duX19idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWx7d2lkdGg6N2VtO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfS5jay5jay1kcm9wZG93biAuY2stYnV0dG9uLmNrLWRyb3Bkb3duX19idXR0b24uY2stZGlzYWJsZWQgLmNrLWJ1dHRvbl9fbGFiZWx7b3BhY2l0eTp2YXIoLS1jay1kaXNhYmxlZC1vcGFjaXR5KX0uY2suY2stZHJvcGRvd24gLmNrLWJ1dHRvbi5jay1kcm9wZG93bl9fYnV0dG9uLmNrLW9ue2JvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MDtib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czowfS5jay5jay1kcm9wZG93bl9fcGFuZWx7Ym9yZGVyLXJhZGl1czowfS5jay1yb3VuZGVkLWNvcm5lcnMgLmNrLmNrLWRyb3Bkb3duX19wYW5lbCwuY2suY2stZHJvcGRvd25fX3BhbmVsLmNrLXJvdW5kZWQtY29ybmVyc3tib3JkZXItcmFkaXVzOnZhcigtLWNrLWJvcmRlci1yYWRpdXMpfS5jay5jay1kcm9wZG93bl9fcGFuZWx7Ym94LXNoYWRvdzp2YXIoLS1jay1kcm9wLXNoYWRvdyksMCAwO2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItZHJvcGRvd24tcGFuZWwtYmFja2dyb3VuZCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1kcm9wZG93bi1wYW5lbC1ib3JkZXIpO2JvdHRvbTowO21pbi13aWR0aDoxMDAlfS5jay5jay1kcm9wZG93bl9fcGFuZWwuY2stZHJvcGRvd25fX3BhbmVsX3Nle2JvcmRlci10b3AtbGVmdC1yYWRpdXM6MH0uY2suY2stZHJvcGRvd25fX3BhbmVsLmNrLWRyb3Bkb3duX19wYW5lbF9zd3tib3JkZXItdG9wLXJpZ2h0LXJhZGl1czowfS5jay5jay1kcm9wZG93bl9fcGFuZWwuY2stZHJvcGRvd25fX3BhbmVsX25le2JvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MH0uY2suY2stZHJvcGRvd25fX3BhbmVsLmNrLWRyb3Bkb3duX19wYW5lbF9ud3tib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czowfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMzIpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWxpc3R7LW1vei11c2VyLXNlbGVjdDpub25lOy13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTstbXMtdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW59LmNrLmNrLWxpc3QgLmNrLWxpc3RfX2l0ZW0sLmNrLmNrLWxpc3QgLmNrLWxpc3RfX3NlcGFyYXRvcntkaXNwbGF5OmJsb2NrfS5jay5jay1saXN0IC5jay1saXN0X19pdGVtPjpmb2N1c3twb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OnZhcigtLWNrLXotZGVmYXVsdCl9LmNrLmNrLWxpc3R7Ym9yZGVyLXJhZGl1czowfS5jay1yb3VuZGVkLWNvcm5lcnMgLmNrLmNrLWxpc3QsLmNrLmNrLWxpc3QuY2stcm91bmRlZC1jb3JuZXJze2JvcmRlci1yYWRpdXM6dmFyKC0tY2stYm9yZGVyLXJhZGl1cyl9LmNrLmNrLWxpc3R7bGlzdC1zdHlsZS10eXBlOm5vbmU7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1saXN0LWJhY2tncm91bmQpfS5jay5jay1saXN0X19pdGVte2N1cnNvcjpkZWZhdWx0O21pbi13aWR0aDoxMmVtfS5jay5jay1saXN0X19pdGVtIC5jay1idXR0b257bWluLWhlaWdodDp1bnNldDt3aWR0aDoxMDAlO3RleHQtYWxpZ246bGVmdDtib3JkZXItcmFkaXVzOjA7cGFkZGluZzpjYWxjKDAuMip2YXIoLS1jay1saW5lLWhlaWdodC1iYXNlKSp2YXIoLS1jay1mb250LXNpemUtYmFzZSkpIGNhbGMoMC40KnZhcigtLWNrLWxpbmUtaGVpZ2h0LWJhc2UpKnZhcigtLWNrLWZvbnQtc2l6ZS1iYXNlKSl9LmNrLmNrLWxpc3RfX2l0ZW0gLmNrLWJ1dHRvbiAuY2stYnV0dG9uX19sYWJlbHtsaW5lLWhlaWdodDpjYWxjKDEuMip2YXIoLS1jay1saW5lLWhlaWdodC1iYXNlKSp2YXIoLS1jay1mb250LXNpemUtYmFzZSkpfS5jay5jay1saXN0X19pdGVtIC5jay1idXR0b246YWN0aXZle2JveC1zaGFkb3c6bm9uZX0uY2suY2stbGlzdF9faXRlbSAuY2stYnV0dG9uLmNrLW9ue2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItbGlzdC1idXR0b24tb24tYmFja2dyb3VuZCk7Y29sb3I6dmFyKC0tY2stY29sb3ItbGlzdC1idXR0b24tb24tdGV4dCl9LmNrLmNrLWxpc3RfX2l0ZW0gLmNrLWJ1dHRvbi5jay1vbjphY3RpdmV7Ym94LXNoYWRvdzpub25lfS5jay5jay1saXN0X19pdGVtIC5jay1idXR0b24uY2stb246aG92ZXI6bm90KC5jay1kaXNhYmxlZCl7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1saXN0LWJ1dHRvbi1vbi1iYWNrZ3JvdW5kLWZvY3VzKX0uY2suY2stbGlzdF9faXRlbSAuY2stYnV0dG9uLmNrLW9uOmZvY3VzOm5vdCguY2stZGlzYWJsZWQpe2JvcmRlci1jb2xvcjp2YXIoLS1jay1jb2xvci1iYXNlLWJhY2tncm91bmQpfS5jay5jay1saXN0X19pdGVtIC5jay1idXR0b246aG92ZXI6bm90KC5jay1kaXNhYmxlZCl7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1saXN0LWJ1dHRvbi1ob3Zlci1iYWNrZ3JvdW5kKX0uY2suY2stbGlzdF9faXRlbSAuY2stc3dpdGNoYnV0dG9uLmNrLW9ue2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItbGlzdC1iYWNrZ3JvdW5kKTtjb2xvcjppbmhlcml0fS5jay5jay1saXN0X19pdGVtIC5jay1zd2l0Y2hidXR0b24uY2stb246aG92ZXI6bm90KC5jay1kaXNhYmxlZCl7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1saXN0LWJ1dHRvbi1ob3Zlci1iYWNrZ3JvdW5kKTtjb2xvcjppbmhlcml0fS5jay5jay1saXN0X19zZXBhcmF0b3J7aGVpZ2h0OjFweDt3aWR0aDoxMDAlO2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMzQpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlLC5jay5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uIC5jay1idXR0b25fX3RvZ2dsZSAuY2stYnV0dG9uX190b2dnbGVfX2lubmVye2Rpc3BsYXk6YmxvY2t9OnJvb3R7LS1jay1zd2l0Y2gtYnV0dG9uLXRvZ2dsZS13aWR0aDoyLjYxNTM4NDYxNTRlbTstLWNrLXN3aXRjaC1idXR0b24tdG9nZ2xlLWlubmVyLXNpemU6MS4wNzY5MjMwNzY5ZW07LS1jay1zd2l0Y2gtYnV0dG9uLXRvZ2dsZS1zcGFjaW5nOjFweDstLWNrLXN3aXRjaC1idXR0b24tdHJhbnNsYXRpb246MS4zODQ2MTUzODQ3ZW19W2Rpcj1sdHJdIC5jay5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uIC5jay1idXR0b25fX2xhYmVse21hcmdpbi1yaWdodDpjYWxjKDIqdmFyKC0tY2stc3BhY2luZy1sYXJnZSkpfVtkaXI9cnRsXSAuY2suY2stYnV0dG9uLmNrLXN3aXRjaGJ1dHRvbiAuY2stYnV0dG9uX19sYWJlbHttYXJnaW4tbGVmdDpjYWxjKDIqdmFyKC0tY2stc3BhY2luZy1sYXJnZSkpfS5jay5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uIC5jay1idXR0b25fX3RvZ2dsZXtib3JkZXItcmFkaXVzOjB9LmNrLXJvdW5kZWQtY29ybmVycyAuY2suY2stYnV0dG9uLmNrLXN3aXRjaGJ1dHRvbiAuY2stYnV0dG9uX190b2dnbGUsLmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlLmNrLXJvdW5kZWQtY29ybmVyc3tib3JkZXItcmFkaXVzOnZhcigtLWNrLWJvcmRlci1yYWRpdXMpfVtkaXI9bHRyXSAuY2suY2stYnV0dG9uLmNrLXN3aXRjaGJ1dHRvbiAuY2stYnV0dG9uX190b2dnbGV7bWFyZ2luLWxlZnQ6YXV0b31bZGlyPXJ0bF0gLmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xle21hcmdpbi1yaWdodDphdXRvfS5jay5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uIC5jay1idXR0b25fX3RvZ2dsZXt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzIGVhc2U7d2lkdGg6dmFyKC0tY2stc3dpdGNoLWJ1dHRvbi10b2dnbGUtd2lkdGgpO2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3Itc3dpdGNoLWJ1dHRvbi1vZmYtYmFja2dyb3VuZCl9LmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlIC5jay1idXR0b25fX3RvZ2dsZV9faW5uZXJ7Ym9yZGVyLXJhZGl1czowfS5jay1yb3VuZGVkLWNvcm5lcnMgLmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlIC5jay1idXR0b25fX3RvZ2dsZV9faW5uZXIsLmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlIC5jay1idXR0b25fX3RvZ2dsZV9faW5uZXIuY2stcm91bmRlZC1jb3JuZXJze2JvcmRlci1yYWRpdXM6dmFyKC0tY2stYm9yZGVyLXJhZGl1cyk7Ym9yZGVyLXJhZGl1czpjYWxjKDAuNSp2YXIoLS1jay1ib3JkZXItcmFkaXVzKSl9LmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlIC5jay1idXR0b25fX3RvZ2dsZV9faW5uZXJ7bWFyZ2luOnZhcigtLWNrLXN3aXRjaC1idXR0b24tdG9nZ2xlLXNwYWNpbmcpO3dpZHRoOnZhcigtLWNrLXN3aXRjaC1idXR0b24tdG9nZ2xlLWlubmVyLXNpemUpO2hlaWdodDp2YXIoLS1jay1zd2l0Y2gtYnV0dG9uLXRvZ2dsZS1pbm5lci1zaXplKTtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLXN3aXRjaC1idXR0b24taW5uZXItYmFja2dyb3VuZCk7dHJhbnNpdGlvbjphbGwgLjNzIGVhc2V9LmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlOmhvdmVye2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3Itc3dpdGNoLWJ1dHRvbi1vZmYtaG92ZXItYmFja2dyb3VuZCl9LmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24gLmNrLWJ1dHRvbl9fdG9nZ2xlOmhvdmVyIC5jay1idXR0b25fX3RvZ2dsZV9faW5uZXJ7Ym94LXNoYWRvdzowIDAgMCA1cHggdmFyKC0tY2stY29sb3Itc3dpdGNoLWJ1dHRvbi1pbm5lci1zaGFkb3cpfS5jay5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uLmNrLWRpc2FibGVkIC5jay1idXR0b25fX3RvZ2dsZXtvcGFjaXR5OnZhcigtLWNrLWRpc2FibGVkLW9wYWNpdHkpfS5jay5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uLmNrLW9uIC5jay1idXR0b25fX3RvZ2dsZXtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLXN3aXRjaC1idXR0b24tb24tYmFja2dyb3VuZCl9LmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24uY2stb24gLmNrLWJ1dHRvbl9fdG9nZ2xlOmhvdmVye2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3Itc3dpdGNoLWJ1dHRvbi1vbi1ob3Zlci1iYWNrZ3JvdW5kKX1bZGlyPWx0cl0gLmNrLmNrLWJ1dHRvbi5jay1zd2l0Y2hidXR0b24uY2stb24gLmNrLWJ1dHRvbl9fdG9nZ2xlIC5jay1idXR0b25fX3RvZ2dsZV9faW5uZXJ7dHJhbnNmb3JtOnRyYW5zbGF0ZVgodmFyKC0tY2stc3dpdGNoLWJ1dHRvbi10cmFuc2xhdGlvbikpfVtkaXI9cnRsXSAuY2suY2stYnV0dG9uLmNrLXN3aXRjaGJ1dHRvbi5jay1vbiAuY2stYnV0dG9uX190b2dnbGUgLmNrLWJ1dHRvbl9fdG9nZ2xlX19pbm5lcnt0cmFuc2Zvcm06dHJhbnNsYXRlWChjYWxjKC0xKnZhcigtLWNrLXN3aXRjaC1idXR0b24tdHJhbnNsYXRpb24pKSl9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSgzNik7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stdG9vbGJhci1kcm9wZG93biAuY2suY2stdG9vbGJhciAuY2suY2stdG9vbGJhcl9faXRlbXN7ZmxleC13cmFwOm5vd3JhcH0uY2suY2stdG9vbGJhci1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsIC5jay1idXR0b246Zm9jdXN7ei1pbmRleDpjYWxjKHZhcigtLWNrLXotZGVmYXVsdCkgKyAxKX0uY2suY2stdG9vbGJhci1kcm9wZG93biAuY2stdG9vbGJhcntib3JkZXI6MH1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDM4KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsIC5jay1saXN0e2JvcmRlci1yYWRpdXM6MH0uY2stcm91bmRlZC1jb3JuZXJzIC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsIC5jay1saXN0LC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsIC5jay1saXN0LmNrLXJvdW5kZWQtY29ybmVyc3tib3JkZXItcmFkaXVzOnZhcigtLWNrLWJvcmRlci1yYWRpdXMpO2JvcmRlci10b3AtbGVmdC1yYWRpdXM6MH0uY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbCAuY2stbGlzdCAuY2stbGlzdF9faXRlbTpmaXJzdC1jaGlsZCAuY2stYnV0dG9ue2JvcmRlci1yYWRpdXM6MH0uY2stcm91bmRlZC1jb3JuZXJzIC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsIC5jay1saXN0IC5jay1saXN0X19pdGVtOmZpcnN0LWNoaWxkIC5jay1idXR0b24sLmNrLmNrLWRyb3Bkb3duIC5jay1kcm9wZG93bl9fcGFuZWwgLmNrLWxpc3QgLmNrLWxpc3RfX2l0ZW06Zmlyc3QtY2hpbGQgLmNrLWJ1dHRvbi5jay1yb3VuZGVkLWNvcm5lcnN7Ym9yZGVyLXJhZGl1czp2YXIoLS1jay1ib3JkZXItcmFkaXVzKTtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjA7Ym9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjB9LmNrLmNrLWRyb3Bkb3duIC5jay1kcm9wZG93bl9fcGFuZWwgLmNrLWxpc3QgLmNrLWxpc3RfX2l0ZW06bGFzdC1jaGlsZCAuY2stYnV0dG9ue2JvcmRlci1yYWRpdXM6MH0uY2stcm91bmRlZC1jb3JuZXJzIC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX3BhbmVsIC5jay1saXN0IC5jay1saXN0X19pdGVtOmxhc3QtY2hpbGQgLmNrLWJ1dHRvbiwuY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbCAuY2stbGlzdCAuY2stbGlzdF9faXRlbTpsYXN0LWNoaWxkIC5jay1idXR0b24uY2stcm91bmRlZC1jb3JuZXJze2JvcmRlci1yYWRpdXM6dmFyKC0tY2stYm9yZGVyLXJhZGl1cyk7Ym9yZGVyLXRvcC1sZWZ0LXJhZGl1czowO2JvcmRlci10b3AtcmlnaHQtcmFkaXVzOjB9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg0MCk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stdG9vbGJhcnstbW96LXVzZXItc2VsZWN0Om5vbmU7LXdlYmtpdC11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7ZGlzcGxheTpmbGV4O2ZsZXgtZmxvdzpyb3cgbm93cmFwO2FsaWduLWl0ZW1zOmNlbnRlcn0uY2suY2stdG9vbGJhcj4uY2stdG9vbGJhcl9faXRlbXN7ZGlzcGxheTpmbGV4O2ZsZXgtZmxvdzpyb3cgd3JhcDthbGlnbi1pdGVtczpjZW50ZXI7ZmxleC1ncm93OjF9LmNrLmNrLXRvb2xiYXIgLmNrLmNrLXRvb2xiYXJfX3NlcGFyYXRvcntkaXNwbGF5OmlubGluZS1ibG9ja30uY2suY2stdG9vbGJhciAuY2suY2stdG9vbGJhcl9fc2VwYXJhdG9yOmZpcnN0LWNoaWxkLC5jay5jay10b29sYmFyIC5jay5jay10b29sYmFyX19zZXBhcmF0b3I6bGFzdC1jaGlsZHtkaXNwbGF5Om5vbmV9LmNrLmNrLXRvb2xiYXIuY2stdG9vbGJhcl9ncm91cGluZz4uY2stdG9vbGJhcl9faXRlbXN7ZmxleC13cmFwOm5vd3JhcH0uY2suY2stdG9vbGJhci5jay10b29sYmFyX3ZlcnRpY2FsPi5jay10b29sYmFyX19pdGVtc3tmbGV4LWRpcmVjdGlvbjpjb2x1bW59LmNrLmNrLXRvb2xiYXIuY2stdG9vbGJhcl9mbG9hdGluZz4uY2stdG9vbGJhcl9faXRlbXN7ZmxleC13cmFwOm5vd3JhcH0uY2suY2stdG9vbGJhcj4uY2suY2stdG9vbGJhcl9fZ3JvdXBlZC1kcm9wZG93bj4uY2stZHJvcGRvd25fX2J1dHRvbiAuY2stZHJvcGRvd25fX2Fycm93e2Rpc3BsYXk6bm9uZX0uY2suY2stdG9vbGJhcntib3JkZXItcmFkaXVzOjB9LmNrLXJvdW5kZWQtY29ybmVycyAuY2suY2stdG9vbGJhciwuY2suY2stdG9vbGJhci5jay1yb3VuZGVkLWNvcm5lcnN7Ym9yZGVyLXJhZGl1czp2YXIoLS1jay1ib3JkZXItcmFkaXVzKX0uY2suY2stdG9vbGJhcntiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLXRvb2xiYXItYmFja2dyb3VuZCk7cGFkZGluZzowIHZhcigtLWNrLXNwYWNpbmctc21hbGwpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tY2stY29sb3ItdG9vbGJhci1ib3JkZXIpfS5jay5jay10b29sYmFyIC5jay5jay10b29sYmFyX19zZXBhcmF0b3J7YWxpZ24tc2VsZjpzdHJldGNoO3dpZHRoOjFweDttaW4td2lkdGg6MXB4O21hcmdpbi10b3A6MDttYXJnaW4tYm90dG9tOjA7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci10b29sYmFyLWJvcmRlcil9LmNrLmNrLXRvb2xiYXI+LmNrLXRvb2xiYXJfX2l0ZW1zPip7bWFyZ2luLXRvcDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKTttYXJnaW4tYm90dG9tOnZhcigtLWNrLXNwYWNpbmctc21hbGwpO21hcmdpbi1yaWdodDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2suY2stdG9vbGJhcj4uY2stdG9vbGJhcl9faXRlbXM6ZW1wdHkrLmNrLmNrLXRvb2xiYXJfX3NlcGFyYXRvcntkaXNwbGF5Om5vbmV9LmNrLmNrLXRvb2xiYXI+LmNrLXRvb2xiYXJfX2l0ZW1zPiosLmNrLmNrLXRvb2xiYXI+LmNrLmNrLXRvb2xiYXJfX2dyb3VwZWQtZHJvcGRvd257bWFyZ2luLXRvcDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKTttYXJnaW4tYm90dG9tOnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jay5jay10b29sYmFyLmNrLXRvb2xiYXJfdmVydGljYWx7cGFkZGluZzowfS5jay5jay10b29sYmFyLmNrLXRvb2xiYXJfdmVydGljYWw+LmNrLXRvb2xiYXJfX2l0ZW1zPi5ja3t3aWR0aDoxMDAlO21hcmdpbjowO2JvcmRlci1yYWRpdXM6MDtib3JkZXI6MH0uY2suY2stdG9vbGJhci5jay10b29sYmFyX2NvbXBhY3R7cGFkZGluZzowfS5jay5jay10b29sYmFyLmNrLXRvb2xiYXJfY29tcGFjdD4uY2stdG9vbGJhcl9faXRlbXM+KnttYXJnaW46MH0uY2suY2stdG9vbGJhci5jay10b29sYmFyX2NvbXBhY3Q+LmNrLXRvb2xiYXJfX2l0ZW1zPjpub3QoOmZpcnN0LWNoaWxkKTpub3QoOmxhc3QtY2hpbGQpe2JvcmRlci1yYWRpdXM6MH0uY2suY2stdG9vbGJhcj4uY2suY2stdG9vbGJhcl9fZ3JvdXBlZC1kcm9wZG93bj4uY2suY2stYnV0dG9uLmNrLWRyb3Bkb3duX19idXR0b257cGFkZGluZy1sZWZ0OnZhcigtLWNrLXNwYWNpbmctdGlueSl9LmNrLXRvb2xiYXItY29udGFpbmVyIC5jay5jay10b29sYmFye2JvcmRlcjowfS5jay5jay10b29sYmFyW2Rpcj1ydGxdPi5jay10b29sYmFyX19pdGVtcz4uY2ssW2Rpcj1ydGxdIC5jay5jay10b29sYmFyPi5jay10b29sYmFyX19pdGVtcz4uY2t7bWFyZ2luLXJpZ2h0OjB9LmNrLmNrLXRvb2xiYXJbZGlyPXJ0bF06bm90KC5jay10b29sYmFyX2NvbXBhY3QpPi5jay10b29sYmFyX19pdGVtcz4uY2ssW2Rpcj1ydGxdIC5jay5jay10b29sYmFyOm5vdCguY2stdG9vbGJhcl9jb21wYWN0KT4uY2stdG9vbGJhcl9faXRlbXM+LmNre21hcmdpbi1sZWZ0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jay5jay10b29sYmFyW2Rpcj1ydGxdPi5jay10b29sYmFyX19pdGVtcz4uY2s6bGFzdC1jaGlsZCxbZGlyPXJ0bF0gLmNrLmNrLXRvb2xiYXI+LmNrLXRvb2xiYXJfX2l0ZW1zPi5jazpsYXN0LWNoaWxke21hcmdpbi1sZWZ0OjB9LmNrLmNrLXRvb2xiYXJbZGlyPXJ0bF0uY2stdG9vbGJhcl9jb21wYWN0Pi5jay10b29sYmFyX19pdGVtcz4uY2s6Zmlyc3QtY2hpbGQsW2Rpcj1ydGxdIC5jay5jay10b29sYmFyLmNrLXRvb2xiYXJfY29tcGFjdD4uY2stdG9vbGJhcl9faXRlbXM+LmNrOmZpcnN0LWNoaWxke2JvcmRlci10b3AtbGVmdC1yYWRpdXM6MDtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjB9LmNrLmNrLXRvb2xiYXJbZGlyPXJ0bF0uY2stdG9vbGJhcl9jb21wYWN0Pi5jay10b29sYmFyX19pdGVtcz4uY2s6bGFzdC1jaGlsZCxbZGlyPXJ0bF0gLmNrLmNrLXRvb2xiYXIuY2stdG9vbGJhcl9jb21wYWN0Pi5jay10b29sYmFyX19pdGVtcz4uY2s6bGFzdC1jaGlsZHtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjB9LmNrLmNrLXRvb2xiYXJbZGlyPXJ0bF0+LmNrLmNrLXRvb2xiYXJfX3NlcGFyYXRvcixbZGlyPXJ0bF0gLmNrLmNrLXRvb2xiYXI+LmNrLmNrLXRvb2xiYXJfX3NlcGFyYXRvcnttYXJnaW4tbGVmdDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2suY2stdG9vbGJhcltkaXI9cnRsXS5jay10b29sYmFyX2dyb3VwaW5nPi5jay10b29sYmFyX19pdGVtczpub3QoOmVtcHR5KTpub3QoOm9ubHktY2hpbGQpLFtkaXI9cnRsXSAuY2suY2stdG9vbGJhci5jay10b29sYmFyX2dyb3VwaW5nPi5jay10b29sYmFyX19pdGVtczpub3QoOmVtcHR5KTpub3QoOm9ubHktY2hpbGQpe21hcmdpbi1sZWZ0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jay5jay10b29sYmFyW2Rpcj1sdHJdPi5jay10b29sYmFyX19pdGVtcz4uY2s6bGFzdC1jaGlsZCxbZGlyPWx0cl0gLmNrLmNrLXRvb2xiYXI+LmNrLXRvb2xiYXJfX2l0ZW1zPi5jazpsYXN0LWNoaWxke21hcmdpbi1yaWdodDowfS5jay5jay10b29sYmFyW2Rpcj1sdHJdLmNrLXRvb2xiYXJfY29tcGFjdD4uY2stdG9vbGJhcl9faXRlbXM+LmNrOmZpcnN0LWNoaWxkLFtkaXI9bHRyXSAuY2suY2stdG9vbGJhci5jay10b29sYmFyX2NvbXBhY3Q+LmNrLXRvb2xiYXJfX2l0ZW1zPi5jazpmaXJzdC1jaGlsZHtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjB9LmNrLmNrLXRvb2xiYXJbZGlyPWx0cl0uY2stdG9vbGJhcl9jb21wYWN0Pi5jay10b29sYmFyX19pdGVtcz4uY2s6bGFzdC1jaGlsZCxbZGlyPWx0cl0gLmNrLmNrLXRvb2xiYXIuY2stdG9vbGJhcl9jb21wYWN0Pi5jay10b29sYmFyX19pdGVtcz4uY2s6bGFzdC1jaGlsZHtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjA7Ym9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czowfS5jay5jay10b29sYmFyW2Rpcj1sdHJdPi5jay5jay10b29sYmFyX19zZXBhcmF0b3IsW2Rpcj1sdHJdIC5jay5jay10b29sYmFyPi5jay5jay10b29sYmFyX19zZXBhcmF0b3J7bWFyZ2luLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jay5jay10b29sYmFyW2Rpcj1sdHJdLmNrLXRvb2xiYXJfZ3JvdXBpbmc+LmNrLXRvb2xiYXJfX2l0ZW1zOm5vdCg6ZW1wdHkpOm5vdCg6b25seS1jaGlsZCksW2Rpcj1sdHJdIC5jay5jay10b29sYmFyLmNrLXRvb2xiYXJfZ3JvdXBpbmc+LmNrLXRvb2xiYXJfX2l0ZW1zOm5vdCg6ZW1wdHkpOm5vdCg6b25seS1jaGlsZCl7bWFyZ2luLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc21hbGwpfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNDIpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLXBsYWNlaG9sZGVyOmJlZm9yZSwuY2sgLmNrLXBsYWNlaG9sZGVyOmJlZm9yZXtjb250ZW50OmF0dHIoZGF0YS1wbGFjZWhvbGRlcik7cG9pbnRlci1ldmVudHM6bm9uZX0uY2suY2stcmVhZC1vbmx5IC5jay1wbGFjZWhvbGRlcjpiZWZvcmV7ZGlzcGxheTpub25lfS5jay5jay1wbGFjZWhvbGRlcjpiZWZvcmUsLmNrIC5jay1wbGFjZWhvbGRlcjpiZWZvcmV7Y3Vyc29yOnRleHQ7Y29sb3I6dmFyKC0tY2stY29sb3ItZW5naW5lLXBsYWNlaG9sZGVyLXRleHQpfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNDQpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWVkaXRvcl9fZWRpdGFibGU6bm90KC5jay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZSl7Ym9yZGVyLXJhZGl1czowfS5jay1yb3VuZGVkLWNvcm5lcnMgLmNrLmNrLWVkaXRvcl9fZWRpdGFibGU6bm90KC5jay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZSksLmNrLmNrLWVkaXRvcl9fZWRpdGFibGU6bm90KC5jay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZSkuY2stcm91bmRlZC1jb3JuZXJze2JvcmRlci1yYWRpdXM6dmFyKC0tY2stYm9yZGVyLXJhZGl1cyl9LmNrLmNrLWVkaXRvcl9fZWRpdGFibGU6bm90KC5jay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZSkuY2stZm9jdXNlZHtvdXRsaW5lOm5vbmU7Ym9yZGVyOnZhcigtLWNrLWZvY3VzLXJpbmcpO2JveC1zaGFkb3c6dmFyKC0tY2staW5uZXItc2hhZG93KSwwIDB9LmNrLmNrLWVkaXRvcl9fZWRpdGFibGVfaW5saW5le292ZXJmbG93OmF1dG87cGFkZGluZzowIHZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpO2JvcmRlcjoxcHggc29saWQgdHJhbnNwYXJlbnR9LmNrLmNrLWVkaXRvcl9fZWRpdGFibGVfaW5saW5lW2Rpcj1sdHJde3RleHQtYWxpZ246bGVmdH0uY2suY2stZWRpdG9yX19lZGl0YWJsZV9pbmxpbmVbZGlyPXJ0bF17dGV4dC1hbGlnbjpyaWdodH0uY2suY2stZWRpdG9yX19lZGl0YWJsZV9pbmxpbmU+OmZpcnN0LWNoaWxke21hcmdpbi10b3A6dmFyKC0tY2stc3BhY2luZy1sYXJnZSl9LmNrLmNrLWVkaXRvcl9fZWRpdGFibGVfaW5saW5lPjpsYXN0LWNoaWxke21hcmdpbi1ib3R0b206dmFyKC0tY2stc3BhY2luZy1sYXJnZSl9LmNrLmNrLWJhbGxvb24tcGFuZWwuY2stdG9vbGJhci1jb250YWluZXJbY2xhc3MqPWFycm93X25dOmFmdGVye2JvcmRlci1ib3R0b20tY29sb3I6dmFyKC0tY2stY29sb3ItYmFzZS1mb3JlZ3JvdW5kKX0uY2suY2stYmFsbG9vbi1wYW5lbC5jay10b29sYmFyLWNvbnRhaW5lcltjbGFzcyo9YXJyb3dfc106YWZ0ZXJ7Ym9yZGVyLXRvcC1jb2xvcjp2YXIoLS1jay1jb2xvci1iYXNlLWZvcmVncm91bmQpfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNDYpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLWNvbnRlbnQgYmxvY2txdW90ZXtvdmVyZmxvdzpoaWRkZW47cGFkZGluZy1yaWdodDoxLjVlbTtwYWRkaW5nLWxlZnQ6MS41ZW07bWFyZ2luLWxlZnQ6MDttYXJnaW4tcmlnaHQ6MDtmb250LXN0eWxlOml0YWxpYztib3JkZXItbGVmdDo1cHggc29saWQgI2NjY30uY2stY29udGVudFtkaXI9cnRsXSBibG9ja3F1b3Rle2JvcmRlci1sZWZ0OjA7Ym9yZGVyLXJpZ2h0OjVweCBzb2xpZCAjY2NjfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNDgpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWNvbG9yLWdyaWR7ZGlzcGxheTpncmlkfTpyb290ey0tY2stY29sb3ItZ3JpZC10aWxlLXNpemU6MjRweDstLWNrLWNvbG9yLWNvbG9yLWdyaWQtY2hlY2staWNvbjojMDAwfS5jay5jay1jb2xvci1ncmlke2dyaWQtZ2FwOjVweDtwYWRkaW5nOjhweH0uY2suY2stY29sb3ItZ3JpZF9fdGlsZXt3aWR0aDp2YXIoLS1jay1jb2xvci1ncmlkLXRpbGUtc2l6ZSk7aGVpZ2h0OnZhcigtLWNrLWNvbG9yLWdyaWQtdGlsZS1zaXplKTttaW4td2lkdGg6dmFyKC0tY2stY29sb3ItZ3JpZC10aWxlLXNpemUpO21pbi1oZWlnaHQ6dmFyKC0tY2stY29sb3ItZ3JpZC10aWxlLXNpemUpO3BhZGRpbmc6MDt0cmFuc2l0aW9uOmJveC1zaGFkb3cgLjJzIGVhc2U7Ym9yZGVyOjB9LmNrLmNrLWNvbG9yLWdyaWRfX3RpbGUuY2stZGlzYWJsZWR7Y3Vyc29yOnVuc2V0O3RyYW5zaXRpb246dW5zZXR9LmNrLmNrLWNvbG9yLWdyaWRfX3RpbGUuY2stY29sb3ItdGFibGVfX2NvbG9yLXRpbGVfYm9yZGVyZWR7Ym94LXNoYWRvdzowIDAgMCAxcHggdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpfS5jay5jay1jb2xvci1ncmlkX190aWxlIC5jay5jay1pY29ue2Rpc3BsYXk6bm9uZTtjb2xvcjp2YXIoLS1jay1jb2xvci1jb2xvci1ncmlkLWNoZWNrLWljb24pfS5jay5jay1jb2xvci1ncmlkX190aWxlLmNrLW9ue2JveC1zaGFkb3c6aW5zZXQgMCAwIDAgMXB4IHZhcigtLWNrLWNvbG9yLWJhc2UtYmFja2dyb3VuZCksMCAwIDAgMnB4IHZhcigtLWNrLWNvbG9yLWJhc2UtdGV4dCl9LmNrLmNrLWNvbG9yLWdyaWRfX3RpbGUuY2stb24gLmNrLmNrLWljb257ZGlzcGxheTpibG9ja30uY2suY2stY29sb3ItZ3JpZF9fdGlsZS5jay1vbiwuY2suY2stY29sb3ItZ3JpZF9fdGlsZTpmb2N1czpub3QoLmNrLWRpc2FibGVkKSwuY2suY2stY29sb3ItZ3JpZF9fdGlsZTpob3Zlcjpub3QoLmNrLWRpc2FibGVkKXtib3JkZXI6MH0uY2suY2stY29sb3ItZ3JpZF9fdGlsZTpmb2N1czpub3QoLmNrLWRpc2FibGVkKSwuY2suY2stY29sb3ItZ3JpZF9fdGlsZTpob3Zlcjpub3QoLmNrLWRpc2FibGVkKXtib3gtc2hhZG93Omluc2V0IDAgMCAwIDFweCB2YXIoLS1jay1jb2xvci1iYXNlLWJhY2tncm91bmQpLDAgMCAwIDJweCB2YXIoLS1jay1jb2xvci1mb2N1cy1ib3JkZXIpfS5jay5jay1jb2xvci1ncmlkX19sYWJlbHtwYWRkaW5nOjAgdmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg1MCk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stbGFiZWx7ZGlzcGxheTpibG9ja30uY2suY2stdm9pY2UtbGFiZWx7ZGlzcGxheTpub25lfS5jay5jay1sYWJlbHtmb250LXdlaWdodDo3MDB9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg1Mik7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2sgLmNrLWJ1dHRvbi5jay1jb2xvci10YWJsZV9fcmVtb3ZlLWNvbG9ye2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7d2lkdGg6MTAwJX1sYWJlbC5jay5jay1jb2xvci1ncmlkX19sYWJlbHtmb250LXdlaWdodDp1bnNldH0uY2sgLmNrLWJ1dHRvbi5jay1jb2xvci10YWJsZV9fcmVtb3ZlLWNvbG9ye3BhZGRpbmc6Y2FsYyh2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKS8yKSB2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjA7Ym9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6MH0uY2sgLmNrLWJ1dHRvbi5jay1jb2xvci10YWJsZV9fcmVtb3ZlLWNvbG9yOm5vdCg6Zm9jdXMpe2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKX1bZGlyPWx0cl0gLmNrIC5jay1idXR0b24uY2stY29sb3ItdGFibGVfX3JlbW92ZS1jb2xvciAuY2suY2staWNvbnttYXJnaW4tcmlnaHQ6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9W2Rpcj1ydGxdIC5jayAuY2stYnV0dG9uLmNrLWNvbG9yLXRhYmxlX19yZW1vdmUtY29sb3IgLmNrLmNrLWljb257bWFyZ2luLWxlZnQ6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg1NCk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIudGV4dC10aW55e2ZvbnQtc2l6ZTouN2VtfS50ZXh0LXNtYWxse2ZvbnQtc2l6ZTouODVlbX0udGV4dC1iaWd7Zm9udC1zaXplOjEuNGVtfS50ZXh0LWh1Z2V7Zm9udC1zaXplOjEuOGVtfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWhlYWRpbmdfaGVhZGluZzF7Zm9udC1zaXplOjIwcHh9LmNrLmNrLWhlYWRpbmdfaGVhZGluZzJ7Zm9udC1zaXplOjE3cHh9LmNrLmNrLWhlYWRpbmdfaGVhZGluZzN7Zm9udC1zaXplOjE0cHh9LmNrW2NsYXNzKj1jay1oZWFkaW5nX2hlYWRpbmdde2ZvbnQtd2VpZ2h0OjcwMH0uY2suY2stZHJvcGRvd24uY2staGVhZGluZy1kcm9wZG93biAuY2stZHJvcGRvd25fX2J1dHRvbiAuY2stYnV0dG9uX19sYWJlbHt3aWR0aDo4ZW19LmNrLmNrLWRyb3Bkb3duLmNrLWhlYWRpbmctZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbCAuY2stbGlzdF9faXRlbXttaW4td2lkdGg6MThlbX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDU3KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay1lZGl0b3JfX2VkaXRhYmxlIC5jay1ob3Jpem9udGFsLWxpbmV7b3ZlcmZsb3c6aGlkZGVufS5jay1jb250ZW50IGhye2JvcmRlcjpzb2xpZCAjNWU1ZTVlO2JvcmRlci13aWR0aDoxcHggMCAwO21hcmdpbjowfS5jay1lZGl0b3JfX2VkaXRhYmxlIC5jay1ob3Jpem9udGFsLWxpbmV7cGFkZGluZzo1cHggMH1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDU5KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIjpyb290ey0tY2stY29sb3ItcmVzaXplcjp2YXIoLS1jay1jb2xvci1mb2N1cy1ib3JkZXIpOy0tY2stcmVzaXplci1zaXplOjEwcHg7LS1jay1yZXNpemVyLWJvcmRlci13aWR0aDoxcHg7LS1jay1yZXNpemVyLWJvcmRlci1yYWRpdXM6MnB4Oy0tY2stcmVzaXplci1vZmZzZXQ6Y2FsYyh2YXIoLS1jay1yZXNpemVyLXNpemUpLy0yIC0gMnB4KTstLWNrLXJlc2l6ZXItdG9vbHRpcC1vZmZzZXQ6MTBweDstLWNrLWNvbG9yLXJlc2l6ZXItdG9vbHRpcC1iYWNrZ3JvdW5kOiMyNjI2MjY7LS1jay1jb2xvci1yZXNpemVyLXRvb2x0aXAtdGV4dDojZjJmMmYyfS5jayAuY2std2lkZ2V0LmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGV7cG9zaXRpb246cmVsYXRpdmV9LmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZSAuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxle3Bvc2l0aW9uOmFic29sdXRlfS5jayAuY2std2lkZ2V0LmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZSAuY2staWNvbntkaXNwbGF5OmJsb2NrfS5jayAuY2std2lkZ2V0LmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUuY2std2lkZ2V0X3NlbGVjdGVkIC5jay13aWRnZXRfX3NlbGVjdGlvbi1oYW5kbGUsLmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZTpob3ZlciAuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxle3Zpc2liaWxpdHk6dmlzaWJsZX0uY2sgLmNrLXNpemUtdmlld3tiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLXJlc2l6ZXItdG9vbHRpcC1iYWNrZ3JvdW5kKTtjb2xvcjp2YXIoLS1jay1jb2xvci1yZXNpemVyLXRvb2x0aXAtdGV4dCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1yZXNpemVyLXRvb2x0aXAtdGV4dCk7Ym9yZGVyLXJhZGl1czp2YXIoLS1jay1yZXNpemVyLWJvcmRlci1yYWRpdXMpO2ZvbnQtc2l6ZTp2YXIoLS1jay1mb250LXNpemUtdGlueSk7ZGlzcGxheTpibG9jaztwYWRkaW5nOnZhcigtLWNrLXNwYWNpbmctc21hbGwpfS5jayAuY2stc2l6ZS12aWV3LmNrLW9yaWVudGF0aW9uLWJvdHRvbS1sZWZ0LC5jayAuY2stc2l6ZS12aWV3LmNrLW9yaWVudGF0aW9uLWJvdHRvbS1yaWdodCwuY2sgLmNrLXNpemUtdmlldy5jay1vcmllbnRhdGlvbi10b3AtbGVmdCwuY2sgLmNrLXNpemUtdmlldy5jay1vcmllbnRhdGlvbi10b3AtcmlnaHR7cG9zaXRpb246YWJzb2x1dGV9LmNrIC5jay1zaXplLXZpZXcuY2stb3JpZW50YXRpb24tdG9wLWxlZnR7dG9wOnZhcigtLWNrLXJlc2l6ZXItdG9vbHRpcC1vZmZzZXQpO2xlZnQ6dmFyKC0tY2stcmVzaXplci10b29sdGlwLW9mZnNldCl9LmNrIC5jay1zaXplLXZpZXcuY2stb3JpZW50YXRpb24tdG9wLXJpZ2h0e3RvcDp2YXIoLS1jay1yZXNpemVyLXRvb2x0aXAtb2Zmc2V0KTtyaWdodDp2YXIoLS1jay1yZXNpemVyLXRvb2x0aXAtb2Zmc2V0KX0uY2sgLmNrLXNpemUtdmlldy5jay1vcmllbnRhdGlvbi1ib3R0b20tcmlnaHR7Ym90dG9tOnZhcigtLWNrLXJlc2l6ZXItdG9vbHRpcC1vZmZzZXQpO3JpZ2h0OnZhcigtLWNrLXJlc2l6ZXItdG9vbHRpcC1vZmZzZXQpfS5jayAuY2stc2l6ZS12aWV3LmNrLW9yaWVudGF0aW9uLWJvdHRvbS1sZWZ0e2JvdHRvbTp2YXIoLS1jay1yZXNpemVyLXRvb2x0aXAtb2Zmc2V0KTtsZWZ0OnZhcigtLWNrLXJlc2l6ZXItdG9vbHRpcC1vZmZzZXQpfTpyb290ey0tY2std2lkZ2V0LW91dGxpbmUtdGhpY2tuZXNzOjNweDstLWNrLXdpZGdldC1oYW5kbGVyLWljb24tc2l6ZToxNnB4Oy0tY2std2lkZ2V0LWhhbmRsZXItYW5pbWF0aW9uLWR1cmF0aW9uOjIwMG1zOy0tY2std2lkZ2V0LWhhbmRsZXItYW5pbWF0aW9uLWN1cnZlOmVhc2U7LS1jay1jb2xvci13aWRnZXQtYmx1cnJlZC1ib3JkZXI6I2RlZGVkZTstLWNrLWNvbG9yLXdpZGdldC1ob3Zlci1ib3JkZXI6I2ZmYzgzZDstLWNrLWNvbG9yLXdpZGdldC1lZGl0YWJsZS1mb2N1cy1iYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJhc2UtYmFja2dyb3VuZCk7LS1jay1jb2xvci13aWRnZXQtZHJhZy1oYW5kbGVyLWljb24tY29sb3I6dmFyKC0tY2stY29sb3ItYmFzZS1iYWNrZ3JvdW5kKX0uY2sgLmNrLXdpZGdldHtvdXRsaW5lLXdpZHRoOnZhcigtLWNrLXdpZGdldC1vdXRsaW5lLXRoaWNrbmVzcyk7b3V0bGluZS1zdHlsZTpzb2xpZDtvdXRsaW5lLWNvbG9yOnRyYW5zcGFyZW50O3RyYW5zaXRpb246b3V0bGluZS1jb2xvciB2YXIoLS1jay13aWRnZXQtaGFuZGxlci1hbmltYXRpb24tZHVyYXRpb24pIHZhcigtLWNrLXdpZGdldC1oYW5kbGVyLWFuaW1hdGlvbi1jdXJ2ZSl9LmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3NlbGVjdGVkLC5jayAuY2std2lkZ2V0LmNrLXdpZGdldF9zZWxlY3RlZDpob3ZlcntvdXRsaW5lOnZhcigtLWNrLXdpZGdldC1vdXRsaW5lLXRoaWNrbmVzcykgc29saWQgdmFyKC0tY2stY29sb3ItZm9jdXMtYm9yZGVyKX0uY2sgLmNrLXdpZGdldDpob3ZlcntvdXRsaW5lLWNvbG9yOnZhcigtLWNrLWNvbG9yLXdpZGdldC1ob3Zlci1ib3JkZXIpfS5jayAuY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGV7Ym9yZGVyOjFweCBzb2xpZCB0cmFuc3BhcmVudH0uY2sgLmNrLWVkaXRvcl9fbmVzdGVkLWVkaXRhYmxlLmNrLWVkaXRvcl9fbmVzdGVkLWVkaXRhYmxlX2ZvY3VzZWQsLmNrIC5jay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZTpmb2N1c3tvdXRsaW5lOm5vbmU7Ym9yZGVyOnZhcigtLWNrLWZvY3VzLXJpbmcpO2JveC1zaGFkb3c6dmFyKC0tY2staW5uZXItc2hhZG93KSwwIDA7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jay1jb2xvci13aWRnZXQtZWRpdGFibGUtZm9jdXMtYmFja2dyb3VuZCl9LmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZSAuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxle3BhZGRpbmc6NHB4O2JveC1zaXppbmc6Ym9yZGVyLWJveDtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O29wYWNpdHk6MDt0cmFuc2l0aW9uOmJhY2tncm91bmQtY29sb3IgdmFyKC0tY2std2lkZ2V0LWhhbmRsZXItYW5pbWF0aW9uLWR1cmF0aW9uKSB2YXIoLS1jay13aWRnZXQtaGFuZGxlci1hbmltYXRpb24tY3VydmUpLHZpc2liaWxpdHkgdmFyKC0tY2std2lkZ2V0LWhhbmRsZXItYW5pbWF0aW9uLWR1cmF0aW9uKSB2YXIoLS1jay13aWRnZXQtaGFuZGxlci1hbmltYXRpb24tY3VydmUpLG9wYWNpdHkgdmFyKC0tY2std2lkZ2V0LWhhbmRsZXItYW5pbWF0aW9uLWR1cmF0aW9uKSB2YXIoLS1jay13aWRnZXQtaGFuZGxlci1hbmltYXRpb24tY3VydmUpO2JvcmRlci1yYWRpdXM6dmFyKC0tY2stYm9yZGVyLXJhZGl1cykgdmFyKC0tY2stYm9yZGVyLXJhZGl1cykgMCAwO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xMDAlKTtsZWZ0OmNhbGMoMHB4IC0gdmFyKC0tY2std2lkZ2V0LW91dGxpbmUtdGhpY2tuZXNzKSl9LmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZSAuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxlIC5jay1pY29ue3dpZHRoOnZhcigtLWNrLXdpZGdldC1oYW5kbGVyLWljb24tc2l6ZSk7aGVpZ2h0OnZhcigtLWNrLXdpZGdldC1oYW5kbGVyLWljb24tc2l6ZSk7Y29sb3I6dmFyKC0tY2stY29sb3Itd2lkZ2V0LWRyYWctaGFuZGxlci1pY29uLWNvbG9yKX0uY2sgLmNrLXdpZGdldC5jay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlIC5jay13aWRnZXRfX3NlbGVjdGlvbi1oYW5kbGUgLmNrLWljb24gLmNrLWljb25fX3NlbGVjdGVkLWluZGljYXRvcntvcGFjaXR5OjA7dHJhbnNpdGlvbjpvcGFjaXR5IC4zcyB2YXIoLS1jay13aWRnZXQtaGFuZGxlci1hbmltYXRpb24tY3VydmUpfS5jayAuY2std2lkZ2V0LmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZTpob3ZlciAuY2staWNvbiAuY2staWNvbl9fc2VsZWN0ZWQtaW5kaWNhdG9ye29wYWNpdHk6MX0uY2sgLmNrLXdpZGdldC5jay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlOmhvdmVyIC5jay13aWRnZXRfX3NlbGVjdGlvbi1oYW5kbGV7b3BhY2l0eToxO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2stY29sb3Itd2lkZ2V0LWhvdmVyLWJvcmRlcil9LmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZS5jay13aWRnZXRfc2VsZWN0ZWQgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZSwuY2sgLmNrLXdpZGdldC5jay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlLmNrLXdpZGdldF9zZWxlY3RlZDpob3ZlciAuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxle29wYWNpdHk6MTtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNrLWNvbG9yLWZvY3VzLWJvcmRlcil9LmNrIC5jay13aWRnZXQuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZS5jay13aWRnZXRfc2VsZWN0ZWQgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZSAuY2staWNvbiAuY2staWNvbl9fc2VsZWN0ZWQtaW5kaWNhdG9yLC5jayAuY2std2lkZ2V0LmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUuY2std2lkZ2V0X3NlbGVjdGVkOmhvdmVyIC5jay13aWRnZXRfX3NlbGVjdGlvbi1oYW5kbGUgLmNrLWljb24gLmNrLWljb25fX3NlbGVjdGVkLWluZGljYXRvcntvcGFjaXR5OjF9LmNrLWVkaXRvcl9fZWRpdGFibGU+LmNrLXdpZGdldC5jay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlOmZpcnN0LWNoaWxkLC5jay1lZGl0b3JfX2VkaXRhYmxlIGJsb2NrcXVvdGU+LmNrLXdpZGdldC5jay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlOmZpcnN0LWNoaWxke21hcmdpbi10b3A6Y2FsYygxZW0gKyB2YXIoLS1jay13aWRnZXQtaGFuZGxlci1pY29uLXNpemUpKX0uY2tbZGlyPXJ0bF0gLmNrLXdpZGdldC5jay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlIC5jay13aWRnZXRfX3NlbGVjdGlvbi1oYW5kbGV7bGVmdDphdXRvO3JpZ2h0OmNhbGMoMHB4IC0gdmFyKC0tY2std2lkZ2V0LW91dGxpbmUtdGhpY2tuZXNzKSl9LmNrLWVkaXRvcl9fZWRpdGFibGUuY2stYmx1cnJlZCAuY2std2lkZ2V0LmNrLXdpZGdldF9zZWxlY3RlZCwuY2stZWRpdG9yX19lZGl0YWJsZS5jay1ibHVycmVkIC5jay13aWRnZXQuY2std2lkZ2V0X3NlbGVjdGVkOmhvdmVye291dGxpbmUtY29sb3I6dmFyKC0tY2stY29sb3Itd2lkZ2V0LWJsdXJyZWQtYm9yZGVyKX0uY2stZWRpdG9yX19lZGl0YWJsZS5jay1ibHVycmVkIC5jay13aWRnZXQuY2std2lkZ2V0X3NlbGVjdGVkLmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZSwuY2stZWRpdG9yX19lZGl0YWJsZS5jay1ibHVycmVkIC5jay13aWRnZXQuY2std2lkZ2V0X3NlbGVjdGVkLmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZTpob3ZlciwuY2stZWRpdG9yX19lZGl0YWJsZS5jay1ibHVycmVkIC5jay13aWRnZXQuY2std2lkZ2V0X3NlbGVjdGVkOmhvdmVyLmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZSwuY2stZWRpdG9yX19lZGl0YWJsZS5jay1ibHVycmVkIC5jay13aWRnZXQuY2std2lkZ2V0X3NlbGVjdGVkOmhvdmVyLmNrLXdpZGdldF93aXRoLXNlbGVjdGlvbi1oYW5kbGUgLmNrLXdpZGdldF9fc2VsZWN0aW9uLWhhbmRsZTpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLXdpZGdldC1ibHVycmVkLWJvcmRlcil9LmNrLWVkaXRvcl9fZWRpdGFibGUuY2stcmVhZC1vbmx5IC5jay13aWRnZXR7LS1jay13aWRnZXQtb3V0bGluZS10aGlja25lc3M6MH1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDYxKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay1sYWJlbGVkLWlucHV0IC5jay1sYWJlbGVkLWlucHV0X19zdGF0dXN7Zm9udC1zaXplOnZhcigtLWNrLWZvbnQtc2l6ZS1zbWFsbCk7bWFyZ2luLXRvcDp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKTt3aGl0ZS1zcGFjZTpub3JtYWx9LmNrLmNrLWxhYmVsZWQtaW5wdXQgLmNrLWxhYmVsZWQtaW5wdXRfX3N0YXR1c19lcnJvcntjb2xvcjp2YXIoLS1jay1jb2xvci1iYXNlLWVycm9yKX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDYzKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIjpyb290ey0tY2staW5wdXQtdGV4dC13aWR0aDoxOGVtfS5jay5jay1pbnB1dC10ZXh0e2JvcmRlci1yYWRpdXM6MH0uY2stcm91bmRlZC1jb3JuZXJzIC5jay5jay1pbnB1dC10ZXh0LC5jay5jay1pbnB1dC10ZXh0LmNrLXJvdW5kZWQtY29ybmVyc3tib3JkZXItcmFkaXVzOnZhcigtLWNrLWJvcmRlci1yYWRpdXMpfS5jay5jay1pbnB1dC10ZXh0e2JveC1zaGFkb3c6dmFyKC0tY2staW5uZXItc2hhZG93KSwwIDA7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1pbnB1dC1iYWNrZ3JvdW5kKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWlucHV0LWJvcmRlcik7cGFkZGluZzp2YXIoLS1jay1zcGFjaW5nLWV4dHJhLXRpbnkpIHZhcigtLWNrLXNwYWNpbmctbWVkaXVtKTttaW4td2lkdGg6dmFyKC0tY2staW5wdXQtdGV4dC13aWR0aCk7bWluLWhlaWdodDp2YXIoLS1jay11aS1jb21wb25lbnQtbWluLWhlaWdodCk7dHJhbnNpdGlvbjpib3gtc2hhZG93IC4ycyBlYXNlLWluLW91dCxib3JkZXIgLjJzIGVhc2UtaW4tb3V0fS5jay5jay1pbnB1dC10ZXh0OmZvY3Vze291dGxpbmU6bm9uZTtib3JkZXI6dmFyKC0tY2stZm9jdXMtcmluZyk7Ym94LXNoYWRvdzp2YXIoLS1jay1mb2N1cy1vdXRlci1zaGFkb3cpLHZhcigtLWNrLWlubmVyLXNoYWRvdyl9LmNrLmNrLWlucHV0LXRleHRbcmVhZG9ubHlde2JvcmRlcjoxcHggc29saWQgdmFyKC0tY2stY29sb3ItaW5wdXQtZGlzYWJsZWQtYm9yZGVyKTtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWlucHV0LWRpc2FibGVkLWJhY2tncm91bmQpO2NvbG9yOnZhcigtLWNrLWNvbG9yLWlucHV0LWRpc2FibGVkLXRleHQpfS5jay5jay1pbnB1dC10ZXh0W3JlYWRvbmx5XTpmb2N1c3tib3gtc2hhZG93OnZhcigtLWNrLWZvY3VzLWRpc2FibGVkLW91dGVyLXNoYWRvdyksdmFyKC0tY2staW5uZXItc2hhZG93KX0uY2suY2staW5wdXQtdGV4dC5jay1lcnJvcntib3JkZXItY29sb3I6dmFyKC0tY2stY29sb3ItaW5wdXQtZXJyb3ItYm9yZGVyKTthbmltYXRpb246Y2stdGV4dC1pbnB1dC1zaGFrZSAuM3MgZWFzZSBib3RofS5jay5jay1pbnB1dC10ZXh0LmNrLWVycm9yOmZvY3Vze2JveC1zaGFkb3c6dmFyKC0tY2stZm9jdXMtZXJyb3Itb3V0ZXItc2hhZG93KSx2YXIoLS1jay1pbm5lci1zaGFkb3cpfUBrZXlmcmFtZXMgY2stdGV4dC1pbnB1dC1zaGFrZXsyMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTJweCl9NDAle3RyYW5zZm9ybTp0cmFuc2xhdGVYKDJweCl9NjAle3RyYW5zZm9ybTp0cmFuc2xhdGVYKC0xcHgpfTgwJXt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxcHgpfX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDY1KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm17ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LXdyYXA6bm93cmFwfS5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm0gLmNrLWxhYmVsZWQtaW5wdXR7ZGlzcGxheTppbmxpbmUtYmxvY2t9LmNrLmNrLXRleHQtYWx0ZXJuYXRpdmUtZm9ybSAuY2stbGFiZWx7ZGlzcGxheTpub25lfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6NjAwcHgpey5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm17ZmxleC13cmFwOndyYXB9LmNrLmNrLXRleHQtYWx0ZXJuYXRpdmUtZm9ybSAuY2stbGFiZWxlZC1pbnB1dHtmbGV4LWJhc2lzOjEwMCV9LmNrLmNrLXRleHQtYWx0ZXJuYXRpdmUtZm9ybSAuY2stYnV0dG9ue2ZsZXgtYmFzaXM6NTAlfX0uY2suY2stdGV4dC1hbHRlcm5hdGl2ZS1mb3Jte3BhZGRpbmc6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9LmNrLmNrLXRleHQtYWx0ZXJuYXRpdmUtZm9ybTpmb2N1c3tvdXRsaW5lOm5vbmV9W2Rpcj1sdHJdIC5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm0+Om5vdCg6Zmlyc3QtY2hpbGQpLFtkaXI9cnRsXSAuY2suY2stdGV4dC1hbHRlcm5hdGl2ZS1mb3JtPjpub3QoOmxhc3QtY2hpbGQpe21hcmdpbi1sZWZ0OnZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpfUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6NjAwcHgpey5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm17cGFkZGluZzowO3dpZHRoOmNhbGMoMC44KnZhcigtLWNrLWlucHV0LXRleHQtd2lkdGgpKX0uY2suY2stdGV4dC1hbHRlcm5hdGl2ZS1mb3JtIC5jay1sYWJlbGVkLWlucHV0e21hcmdpbjp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKSB2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKSAwfS5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm0gLmNrLWxhYmVsZWQtaW5wdXQgLmNrLWlucHV0LXRleHR7bWluLXdpZHRoOjA7d2lkdGg6MTAwJX0uY2suY2stdGV4dC1hbHRlcm5hdGl2ZS1mb3JtIC5jay1idXR0b257cGFkZGluZzp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTttYXJnaW4tdG9wOnZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpO2JvcmRlci1yYWRpdXM6MDtib3JkZXI6MDtib3JkZXItdG9wOjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcil9W2Rpcj1sdHJdIC5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm0gLmNrLWJ1dHRvbnttYXJnaW4tbGVmdDowfVtkaXI9bHRyXSAuY2suY2stdGV4dC1hbHRlcm5hdGl2ZS1mb3JtIC5jay1idXR0b246Zmlyc3Qtb2YtdHlwZXtib3JkZXItcmlnaHQ6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKX1bZGlyPXJ0bF0gLmNrLmNrLXRleHQtYWx0ZXJuYXRpdmUtZm9ybSAuY2stYnV0dG9ue21hcmdpbi1sZWZ0OjB9W2Rpcj1ydGxdIC5jay5jay10ZXh0LWFsdGVybmF0aXZlLWZvcm0gLmNrLWJ1dHRvbjpsYXN0LW9mLXR5cGV7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcil9fVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNjcpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLWNvbnRlbnQgLmltYWdle2Rpc3BsYXk6dGFibGU7Y2xlYXI6Ym90aDt0ZXh0LWFsaWduOmNlbnRlcjttYXJnaW46MWVtIGF1dG99LmNrLWNvbnRlbnQgLmltYWdlPmltZ3tkaXNwbGF5OmJsb2NrO21hcmdpbjowIGF1dG87bWF4LXdpZHRoOjEwMCU7bWluLXdpZHRoOjUwcHh9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg2OSk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCI6cm9vdHstLWNrLWltYWdlLXN0eWxlLXNwYWNpbmc6MS41ZW19LmNrLWNvbnRlbnQgLmltYWdlLXN0eWxlLWFsaWduLWNlbnRlciwuY2stY29udGVudCAuaW1hZ2Utc3R5bGUtYWxpZ24tbGVmdCwuY2stY29udGVudCAuaW1hZ2Utc3R5bGUtYWxpZ24tcmlnaHQsLmNrLWNvbnRlbnQgLmltYWdlLXN0eWxlLXNpZGV7bWF4LXdpZHRoOjUwJX0uY2stY29udGVudCAuaW1hZ2Utc3R5bGUtc2lkZXtmbG9hdDpyaWdodDttYXJnaW4tbGVmdDp2YXIoLS1jay1pbWFnZS1zdHlsZS1zcGFjaW5nKX0uY2stY29udGVudCAuaW1hZ2Utc3R5bGUtYWxpZ24tbGVmdHtmbG9hdDpsZWZ0O21hcmdpbi1yaWdodDp2YXIoLS1jay1pbWFnZS1zdHlsZS1zcGFjaW5nKX0uY2stY29udGVudCAuaW1hZ2Utc3R5bGUtYWxpZ24tY2VudGVye21hcmdpbi1sZWZ0OmF1dG87bWFyZ2luLXJpZ2h0OmF1dG99LmNrLWNvbnRlbnQgLmltYWdlLXN0eWxlLWFsaWduLXJpZ2h0e2Zsb2F0OnJpZ2h0O21hcmdpbi1sZWZ0OnZhcigtLWNrLWltYWdlLXN0eWxlLXNwYWNpbmcpfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNzEpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrIC5jay13aWRnZXRfd2l0aC1yZXNpemVye3Bvc2l0aW9uOnJlbGF0aXZlfS5jayAuY2std2lkZ2V0X19yZXNpemVye2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjphYnNvbHV0ZTtwb2ludGVyLWV2ZW50czpub25lO2xlZnQ6MDt0b3A6MDtvdXRsaW5lOjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1yZXNpemVyKX0uY2stZm9jdXNlZCAuY2std2lkZ2V0X3dpdGgtcmVzaXplci5jay13aWRnZXRfc2VsZWN0ZWQ+LmNrLXdpZGdldF9fcmVzaXplcntkaXNwbGF5OmJsb2NrfS5jayAuY2std2lkZ2V0X19yZXNpemVyX19oYW5kbGV7cG9zaXRpb246YWJzb2x1dGU7cG9pbnRlci1ldmVudHM6YWxsO3dpZHRoOnZhcigtLWNrLXJlc2l6ZXItc2l6ZSk7aGVpZ2h0OnZhcigtLWNrLXJlc2l6ZXItc2l6ZSk7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1mb2N1cy1ib3JkZXIpO2JvcmRlcjp2YXIoLS1jay1yZXNpemVyLWJvcmRlci13aWR0aCkgc29saWQgI2ZmZjtib3JkZXItcmFkaXVzOnZhcigtLWNrLXJlc2l6ZXItYm9yZGVyLXJhZGl1cyl9LmNrIC5jay13aWRnZXRfX3Jlc2l6ZXJfX2hhbmRsZS5jay13aWRnZXRfX3Jlc2l6ZXJfX2hhbmRsZS10b3AtbGVmdHt0b3A6dmFyKC0tY2stcmVzaXplci1vZmZzZXQpO2xlZnQ6dmFyKC0tY2stcmVzaXplci1vZmZzZXQpO2N1cnNvcjpud3NlLXJlc2l6ZX0uY2sgLmNrLXdpZGdldF9fcmVzaXplcl9faGFuZGxlLmNrLXdpZGdldF9fcmVzaXplcl9faGFuZGxlLXRvcC1yaWdodHt0b3A6dmFyKC0tY2stcmVzaXplci1vZmZzZXQpO3JpZ2h0OnZhcigtLWNrLXJlc2l6ZXItb2Zmc2V0KTtjdXJzb3I6bmVzdy1yZXNpemV9LmNrIC5jay13aWRnZXRfX3Jlc2l6ZXJfX2hhbmRsZS5jay13aWRnZXRfX3Jlc2l6ZXJfX2hhbmRsZS1ib3R0b20tcmlnaHR7Ym90dG9tOnZhcigtLWNrLXJlc2l6ZXItb2Zmc2V0KTtyaWdodDp2YXIoLS1jay1yZXNpemVyLW9mZnNldCk7Y3Vyc29yOm53c2UtcmVzaXplfS5jayAuY2std2lkZ2V0X19yZXNpemVyX19oYW5kbGUuY2std2lkZ2V0X19yZXNpemVyX19oYW5kbGUtYm90dG9tLWxlZnR7Ym90dG9tOnZhcigtLWNrLXJlc2l6ZXItb2Zmc2V0KTtsZWZ0OnZhcigtLWNrLXJlc2l6ZXItb2Zmc2V0KTtjdXJzb3I6bmVzdy1yZXNpemV9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg3Myk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2stY29udGVudCAuaW1hZ2UuaW1hZ2VfcmVzaXplZHttYXgtd2lkdGg6MTAwJTtkaXNwbGF5OmJsb2NrO2JveC1zaXppbmc6Ym9yZGVyLWJveH0uY2stY29udGVudCAuaW1hZ2UuaW1hZ2VfcmVzaXplZCBpbWd7d2lkdGg6MTAwJX0uY2stY29udGVudCAuaW1hZ2UuaW1hZ2VfcmVzaXplZD5maWdjYXB0aW9ue2Rpc3BsYXk6YmxvY2t9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg3NSk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stZWRpdG9yX19lZGl0YWJsZSAuaW1hZ2V7cG9zaXRpb246cmVsYXRpdmV9LmNrLmNrLWVkaXRvcl9fZWRpdGFibGUgLmltYWdlIC5jay1wcm9ncmVzcy1iYXJ7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowfS5jay5jay1lZGl0b3JfX2VkaXRhYmxlIC5pbWFnZS5jay1hcHBlYXJ7YW5pbWF0aW9uOmZhZGVJbiAuN3N9LmNrLmNrLWVkaXRvcl9fZWRpdGFibGUgLmltYWdlIC5jay1wcm9ncmVzcy1iYXJ7aGVpZ2h0OjJweDt3aWR0aDowO2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItdXBsb2FkLWJhci1iYWNrZ3JvdW5kKTt0cmFuc2l0aW9uOndpZHRoIC4xc31Aa2V5ZnJhbWVzIGZhZGVJbnswJXtvcGFjaXR5OjB9dG97b3BhY2l0eToxfX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDc3KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSAnLmNrLWltYWdlLXVwbG9hZC1jb21wbGV0ZS1pY29ue2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7dG9wOjEwcHg7cmlnaHQ6MTBweDtib3JkZXItcmFkaXVzOjUwJX0uY2staW1hZ2UtdXBsb2FkLWNvbXBsZXRlLWljb246YWZ0ZXJ7Y29udGVudDpcIlwiO3Bvc2l0aW9uOmFic29sdXRlfTpyb290ey0tY2stY29sb3ItaW1hZ2UtdXBsb2FkLWljb246I2ZmZjstLWNrLWNvbG9yLWltYWdlLXVwbG9hZC1pY29uLWJhY2tncm91bmQ6IzAwOGEwMDstLWNrLWltYWdlLXVwbG9hZC1pY29uLXNpemU6MjBweDstLWNrLWltYWdlLXVwbG9hZC1pY29uLXdpZHRoOjJweH0uY2staW1hZ2UtdXBsb2FkLWNvbXBsZXRlLWljb257d2lkdGg6dmFyKC0tY2staW1hZ2UtdXBsb2FkLWljb24tc2l6ZSk7aGVpZ2h0OnZhcigtLWNrLWltYWdlLXVwbG9hZC1pY29uLXNpemUpO29wYWNpdHk6MDtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWltYWdlLXVwbG9hZC1pY29uLWJhY2tncm91bmQpO2FuaW1hdGlvbi1uYW1lOmNrLXVwbG9hZC1jb21wbGV0ZS1pY29uLXNob3csY2stdXBsb2FkLWNvbXBsZXRlLWljb24taGlkZTthbmltYXRpb24tZmlsbC1tb2RlOmZvcndhcmRzLGZvcndhcmRzO2FuaW1hdGlvbi1kdXJhdGlvbjouNXMsLjVzO2ZvbnQtc2l6ZTp2YXIoLS1jay1pbWFnZS11cGxvYWQtaWNvbi1zaXplKTthbmltYXRpb24tZGVsYXk6MG1zLDNzfS5jay1pbWFnZS11cGxvYWQtY29tcGxldGUtaWNvbjphZnRlcntsZWZ0OjI1JTt0b3A6NTAlO29wYWNpdHk6MDtoZWlnaHQ6MDt3aWR0aDowO3RyYW5zZm9ybTpzY2FsZVgoLTEpIHJvdGF0ZSgxMzVkZWcpO3RyYW5zZm9ybS1vcmlnaW46bGVmdCB0b3A7Ym9yZGVyLXRvcDp2YXIoLS1jay1pbWFnZS11cGxvYWQtaWNvbi13aWR0aCkgc29saWQgdmFyKC0tY2stY29sb3ItaW1hZ2UtdXBsb2FkLWljb24pO2JvcmRlci1yaWdodDp2YXIoLS1jay1pbWFnZS11cGxvYWQtaWNvbi13aWR0aCkgc29saWQgdmFyKC0tY2stY29sb3ItaW1hZ2UtdXBsb2FkLWljb24pO2FuaW1hdGlvbi1uYW1lOmNrLXVwbG9hZC1jb21wbGV0ZS1pY29uLWNoZWNrO2FuaW1hdGlvbi1kdXJhdGlvbjouNXM7YW5pbWF0aW9uLWRlbGF5Oi41czthbmltYXRpb24tZmlsbC1tb2RlOmZvcndhcmRzO2JveC1zaXppbmc6Ym9yZGVyLWJveH1Aa2V5ZnJhbWVzIGNrLXVwbG9hZC1jb21wbGV0ZS1pY29uLXNob3d7MCV7b3BhY2l0eTowfXRve29wYWNpdHk6MX19QGtleWZyYW1lcyBjay11cGxvYWQtY29tcGxldGUtaWNvbi1oaWRlezAle29wYWNpdHk6MX10b3tvcGFjaXR5OjB9fUBrZXlmcmFtZXMgY2stdXBsb2FkLWNvbXBsZXRlLWljb24tY2hlY2t7MCV7b3BhY2l0eToxO3dpZHRoOjA7aGVpZ2h0OjB9MzMle3dpZHRoOi4zZW07aGVpZ2h0OjB9dG97b3BhY2l0eToxO3dpZHRoOi4zZW07aGVpZ2h0Oi40NWVtfX0nXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoNzkpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9ICcuY2sgLmNrLXVwbG9hZC1wbGFjZWhvbGRlci1sb2FkZXJ7cG9zaXRpb246YWJzb2x1dGU7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3RvcDowO2xlZnQ6MH0uY2sgLmNrLXVwbG9hZC1wbGFjZWhvbGRlci1sb2FkZXI6YmVmb3Jle2NvbnRlbnQ6XCJcIjtwb3NpdGlvbjpyZWxhdGl2ZX06cm9vdHstLWNrLWNvbG9yLXVwbG9hZC1wbGFjZWhvbGRlci1sb2FkZXI6I2IzYjNiMzstLWNrLXVwbG9hZC1wbGFjZWhvbGRlci1sb2FkZXItc2l6ZTozMnB4fS5jayAuY2staW1hZ2UtdXBsb2FkLXBsYWNlaG9sZGVye3dpZHRoOjEwMCU7bWFyZ2luOjB9LmNrIC5jay11cGxvYWQtcGxhY2Vob2xkZXItbG9hZGVye3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCV9LmNrIC5jay11cGxvYWQtcGxhY2Vob2xkZXItbG9hZGVyOmJlZm9yZXt3aWR0aDp2YXIoLS1jay11cGxvYWQtcGxhY2Vob2xkZXItbG9hZGVyLXNpemUpO2hlaWdodDp2YXIoLS1jay11cGxvYWQtcGxhY2Vob2xkZXItbG9hZGVyLXNpemUpO2JvcmRlci1yYWRpdXM6NTAlO2JvcmRlci10b3A6M3B4IHNvbGlkIHZhcigtLWNrLWNvbG9yLXVwbG9hZC1wbGFjZWhvbGRlci1sb2FkZXIpO2JvcmRlci1yaWdodDoycHggc29saWQgdHJhbnNwYXJlbnQ7YW5pbWF0aW9uOmNrLXVwbG9hZC1wbGFjZWhvbGRlci1sb2FkZXIgMXMgbGluZWFyIGluZmluaXRlfUBrZXlmcmFtZXMgY2stdXBsb2FkLXBsYWNlaG9sZGVyLWxvYWRlcnt0b3t0cmFuc2Zvcm06cm90YXRlKDF0dXJuKX19J1xyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDgxKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jayAuY2stbGlua19zZWxlY3RlZHtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWxpbmstc2VsZWN0ZWQtYmFja2dyb3VuZCl9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg4Myk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stbGluay1mb3Jte2Rpc3BsYXk6ZmxleH0uY2suY2stbGluay1mb3JtIC5jay1sYWJlbHtkaXNwbGF5Om5vbmV9QG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDo2MDBweCl7LmNrLmNrLWxpbmstZm9ybXtmbGV4LXdyYXA6d3JhcH0uY2suY2stbGluay1mb3JtIC5jay1sYWJlbGVkLWlucHV0e2ZsZXgtYmFzaXM6MTAwJX0uY2suY2stbGluay1mb3JtIC5jay1idXR0b257ZmxleC1iYXNpczo1MCV9fS5jay5jay1saW5rLWZvcm1fbGF5b3V0LXZlcnRpY2Fse2Rpc3BsYXk6YmxvY2t9LmNrLmNrLWxpbmstZm9ybXtwYWRkaW5nOnZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpfS5jay5jay1saW5rLWZvcm06Zm9jdXN7b3V0bGluZTpub25lfVtkaXI9bHRyXSAuY2suY2stbGluay1mb3JtPjpub3QoOmZpcnN0LWNoaWxkKSxbZGlyPXJ0bF0gLmNrLmNrLWxpbmstZm9ybT46bm90KDpsYXN0LWNoaWxkKXttYXJnaW4tbGVmdDp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKX1AbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOjYwMHB4KXsuY2suY2stbGluay1mb3Jte3BhZGRpbmc6MDt3aWR0aDpjYWxjKDAuOCp2YXIoLS1jay1pbnB1dC10ZXh0LXdpZHRoKSl9LmNrLmNrLWxpbmstZm9ybSAuY2stbGFiZWxlZC1pbnB1dHttYXJnaW46dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCkgdmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCkgMH0uY2suY2stbGluay1mb3JtIC5jay1sYWJlbGVkLWlucHV0IC5jay1pbnB1dC10ZXh0e21pbi13aWR0aDowO3dpZHRoOjEwMCV9LmNrLmNrLWxpbmstZm9ybSAuY2stYnV0dG9ue3BhZGRpbmc6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCk7bWFyZ2luLXRvcDp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTtib3JkZXItcmFkaXVzOjA7Ym9yZGVyOjA7Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpfVtkaXI9bHRyXSAuY2suY2stbGluay1mb3JtIC5jay1idXR0b257bWFyZ2luLWxlZnQ6MH1bZGlyPWx0cl0gLmNrLmNrLWxpbmstZm9ybSAuY2stYnV0dG9uOmZpcnN0LW9mLXR5cGV7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcil9W2Rpcj1ydGxdIC5jay5jay1saW5rLWZvcm0gLmNrLWJ1dHRvbnttYXJnaW4tbGVmdDowfVtkaXI9cnRsXSAuY2suY2stbGluay1mb3JtIC5jay1idXR0b246bGFzdC1vZi10eXBle2JvcmRlci1yaWdodDoxcHggc29saWQgdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpfX0uY2suY2stbGluay1mb3JtX2xheW91dC12ZXJ0aWNhbHtwYWRkaW5nOjA7bWluLXdpZHRoOnZhcigtLWNrLWlucHV0LXRleHQtd2lkdGgpfS5jay5jay1saW5rLWZvcm1fbGF5b3V0LXZlcnRpY2FsIC5jay1sYWJlbGVkLWlucHV0e21hcmdpbjp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKSB2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKSB2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2suY2stbGluay1mb3JtX2xheW91dC12ZXJ0aWNhbCAuY2stbGFiZWxlZC1pbnB1dCAuY2staW5wdXQtdGV4dHttaW4td2lkdGg6MDt3aWR0aDoxMDAlfS5jay5jay1saW5rLWZvcm1fbGF5b3V0LXZlcnRpY2FsIC5jay1idXR0b257cGFkZGluZzp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTttYXJnaW46MDtib3JkZXItcmFkaXVzOjA7Ym9yZGVyOjA7Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpO3dpZHRoOjUwJX1bZGlyPWx0cl0gLmNrLmNrLWxpbmstZm9ybV9sYXlvdXQtdmVydGljYWwgLmNrLWJ1dHRvbnttYXJnaW4tbGVmdDowfVtkaXI9bHRyXSAuY2suY2stbGluay1mb3JtX2xheW91dC12ZXJ0aWNhbCAuY2stYnV0dG9uOmZpcnN0LW9mLXR5cGV7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcil9W2Rpcj1ydGxdIC5jay5jay1saW5rLWZvcm1fbGF5b3V0LXZlcnRpY2FsIC5jay1idXR0b257bWFyZ2luLWxlZnQ6MH1bZGlyPXJ0bF0gLmNrLmNrLWxpbmstZm9ybV9sYXlvdXQtdmVydGljYWwgLmNrLWJ1dHRvbjpsYXN0LW9mLXR5cGV7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcil9LmNrLmNrLWxpbmstZm9ybV9sYXlvdXQtdmVydGljYWwgLmNrLmNrLWxpc3R7bWFyZ2luLWxlZnQ6MH0uY2suY2stbGluay1mb3JtX2xheW91dC12ZXJ0aWNhbCAuY2suY2stbGlzdCAuY2stYnV0dG9uLmNrLXN3aXRjaGJ1dHRvbntib3JkZXI6MDt3aWR0aDoxMDAlfS5jay5jay1saW5rLWZvcm1fbGF5b3V0LXZlcnRpY2FsIC5jay5jay1saXN0IC5jay1idXR0b24uY2stc3dpdGNoYnV0dG9uOmhvdmVye2JhY2tncm91bmQ6bm9uZX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDg1KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay1saW5rLWFjdGlvbnN7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LXdyYXA6bm93cmFwfS5jay5jay1saW5rLWFjdGlvbnMgLmNrLWxpbmstYWN0aW9uc19fcHJldmlld3tkaXNwbGF5OmlubGluZS1ibG9ja30uY2suY2stbGluay1hY3Rpb25zIC5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXcgLmNrLWJ1dHRvbl9fbGFiZWx7b3ZlcmZsb3c6aGlkZGVufUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6NjAwcHgpey5jay5jay1saW5rLWFjdGlvbnN7ZmxleC13cmFwOndyYXB9LmNrLmNrLWxpbmstYWN0aW9ucyAuY2stbGluay1hY3Rpb25zX19wcmV2aWV3e2ZsZXgtYmFzaXM6MTAwJX0uY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b246bm90KC5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXcpe2ZsZXgtYmFzaXM6NTAlfX0uY2suY2stbGluay1hY3Rpb25ze3BhZGRpbmc6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9LmNrLmNrLWxpbmstYWN0aW9ucyAuY2stYnV0dG9uLmNrLWxpbmstYWN0aW9uc19fcHJldmlld3twYWRkaW5nLWxlZnQ6MDtwYWRkaW5nLXJpZ2h0OjB9LmNrLmNrLWxpbmstYWN0aW9ucyAuY2stYnV0dG9uLmNrLWxpbmstYWN0aW9uc19fcHJldmlldyAuY2stYnV0dG9uX19sYWJlbHtwYWRkaW5nOjAgdmFyKC0tY2stc3BhY2luZy1tZWRpdW0pO2NvbG9yOnZhcigtLWNrLWNvbG9yLWxpbmstZGVmYXVsdCk7dGV4dC1vdmVyZmxvdzplbGxpcHNpcztjdXJzb3I6cG9pbnRlcjttYXgtd2lkdGg6dmFyKC0tY2staW5wdXQtdGV4dC13aWR0aCk7bWluLXdpZHRoOjNlbTt0ZXh0LWFsaWduOmNlbnRlcn0uY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b24uY2stbGluay1hY3Rpb25zX19wcmV2aWV3IC5jay1idXR0b25fX2xhYmVsOmhvdmVye3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmV9LmNrLmNrLWxpbmstYWN0aW9ucyAuY2stYnV0dG9uLmNrLWxpbmstYWN0aW9uc19fcHJldmlldywuY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b24uY2stbGluay1hY3Rpb25zX19wcmV2aWV3OmFjdGl2ZSwuY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b24uY2stbGluay1hY3Rpb25zX19wcmV2aWV3OmZvY3VzLC5jay5jay1saW5rLWFjdGlvbnMgLmNrLWJ1dHRvbi5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXc6aG92ZXJ7YmFja2dyb3VuZDpub25lfS5jay5jay1saW5rLWFjdGlvbnMgLmNrLWJ1dHRvbi5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXc6YWN0aXZle2JveC1zaGFkb3c6bm9uZX0uY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b24uY2stbGluay1hY3Rpb25zX19wcmV2aWV3OmZvY3VzIC5jay1idXR0b25fX2xhYmVse3RleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmV9LmNrLmNrLWxpbmstYWN0aW9uczpmb2N1c3tvdXRsaW5lOm5vbmV9W2Rpcj1sdHJdIC5jay5jay1saW5rLWFjdGlvbnMgLmNrLWJ1dHRvbjpub3QoOmZpcnN0LWNoaWxkKSxbZGlyPXJ0bF0gLmNrLmNrLWxpbmstYWN0aW9ucyAuY2stYnV0dG9uOm5vdCg6bGFzdC1jaGlsZCl7bWFyZ2luLWxlZnQ6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9QG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDo2MDBweCl7LmNrLmNrLWxpbmstYWN0aW9uc3twYWRkaW5nOjA7d2lkdGg6Y2FsYygwLjgqdmFyKC0tY2staW5wdXQtdGV4dC13aWR0aCkpfS5jay5jay1saW5rLWFjdGlvbnMgLmNrLWJ1dHRvbi5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXd7bWFyZ2luOnZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpIHZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpIDB9LmNrLmNrLWxpbmstYWN0aW9ucyAuY2stYnV0dG9uLmNrLWxpbmstYWN0aW9uc19fcHJldmlldyAuY2stYnV0dG9uX19sYWJlbHttaW4td2lkdGg6MDttYXgtd2lkdGg6MTAwJX0uY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b246bm90KC5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXcpe3BhZGRpbmc6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCk7bWFyZ2luLXRvcDp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTtib3JkZXItcmFkaXVzOjA7Ym9yZGVyOjA7Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpfVtkaXI9bHRyXSAuY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b246bm90KC5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXcpe21hcmdpbi1sZWZ0OjB9W2Rpcj1sdHJdIC5jay5jay1saW5rLWFjdGlvbnMgLmNrLWJ1dHRvbjpub3QoLmNrLWxpbmstYWN0aW9uc19fcHJldmlldyk6Zmlyc3Qtb2YtdHlwZXtib3JkZXItcmlnaHQ6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKX1bZGlyPXJ0bF0gLmNrLmNrLWxpbmstYWN0aW9ucyAuY2stYnV0dG9uOm5vdCguY2stbGluay1hY3Rpb25zX19wcmV2aWV3KXttYXJnaW4tbGVmdDowfVtkaXI9cnRsXSAuY2suY2stbGluay1hY3Rpb25zIC5jay1idXR0b246bm90KC5jay1saW5rLWFjdGlvbnNfX3ByZXZpZXcpOmxhc3Qtb2YtdHlwZXtib3JkZXItcmlnaHQ6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKX19XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSg4Nyk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stY2hhcmFjdGVyLWdyaWQgLmNrLWNoYXJhY3Rlci1ncmlkX190aWxlc3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgxMCwxZnIpfTpyb290ey0tY2stY2hhcmFjdGVyLWdyaWQtdGlsZS1zaXplOjI0cHh9LmNrLmNrLWNoYXJhY3Rlci1ncmlke292ZXJmbG93LXk6YXV0bztvdmVyZmxvdy14OmhpZGRlbjt3aWR0aDozNTBweDttYXgtaGVpZ2h0OjIwMHB4fS5jay5jay1jaGFyYWN0ZXItZ3JpZCAuY2stY2hhcmFjdGVyLWdyaWRfX3RpbGVze21hcmdpbjp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKTtncmlkLWdhcDp2YXIoLS1jay1zcGFjaW5nLXN0YW5kYXJkKX0uY2suY2stY2hhcmFjdGVyLWdyaWQgLmNrLWNoYXJhY3Rlci1ncmlkX190aWxle3dpZHRoOnZhcigtLWNrLWNoYXJhY3Rlci1ncmlkLXRpbGUtc2l6ZSk7aGVpZ2h0OnZhcigtLWNrLWNoYXJhY3Rlci1ncmlkLXRpbGUtc2l6ZSk7bWluLXdpZHRoOnZhcigtLWNrLWNoYXJhY3Rlci1ncmlkLXRpbGUtc2l6ZSk7bWluLWhlaWdodDp2YXIoLS1jay1jaGFyYWN0ZXItZ3JpZC10aWxlLXNpemUpO2ZvbnQtc2l6ZToxLjJlbTtwYWRkaW5nOjA7dHJhbnNpdGlvbjpib3gtc2hhZG93IC4ycyBlYXNlO2JvcmRlcjowfS5jay5jay1jaGFyYWN0ZXItZ3JpZCAuY2stY2hhcmFjdGVyLWdyaWRfX3RpbGU6Zm9jdXM6bm90KC5jay1kaXNhYmxlZCksLmNrLmNrLWNoYXJhY3Rlci1ncmlkIC5jay1jaGFyYWN0ZXItZ3JpZF9fdGlsZTpob3Zlcjpub3QoLmNrLWRpc2FibGVkKXtib3JkZXI6MDtib3gtc2hhZG93Omluc2V0IDAgMCAwIDFweCB2YXIoLS1jay1jb2xvci1iYXNlLWJhY2tncm91bmQpLDAgMCAwIDJweCB2YXIoLS1jay1jb2xvci1mb2N1cy1ib3JkZXIpfS5jay5jay1jaGFyYWN0ZXItZ3JpZCAuY2stY2hhcmFjdGVyLWdyaWRfX3RpbGUgLmNrLWJ1dHRvbl9fbGFiZWx7bGluZS1oZWlnaHQ6dmFyKC0tY2stY2hhcmFjdGVyLWdyaWQtdGlsZS1zaXplKTt3aWR0aDoxMDAlO3RleHQtYWxpZ246Y2VudGVyfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoODkpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWNoYXJhY3Rlci1pbmZve2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjtwYWRkaW5nOnZhcigtLWNrLXNwYWNpbmctc21hbGwpIHZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpO2JvcmRlci10b3A6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKX0uY2suY2stY2hhcmFjdGVyLWluZm8+Knt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7Zm9udC1zaXplOnZhcigtLWNrLWZvbnQtc2l6ZS1zbWFsbCl9LmNrLmNrLWNoYXJhY3Rlci1pbmZvIC5jay1jaGFyYWN0ZXItaW5mb19fbmFtZXttYXgtd2lkdGg6MjgwcHg7dGV4dC1vdmVyZmxvdzplbGxpcHNpcztvdmVyZmxvdzpoaWRkZW59LmNrLmNrLWNoYXJhY3Rlci1pbmZvIC5jay1jaGFyYWN0ZXItaW5mb19fY29kZXtvcGFjaXR5Oi42fVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoOTEpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLXNwZWNpYWwtY2hhcmFjdGVycy1uYXZpZ2F0aW9ue2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC13cmFwOm5vd3JhcDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpO3BhZGRpbmc6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9W2Rpcj1sdHJdIC5jay5jay1zcGVjaWFsLWNoYXJhY3RlcnMtbmF2aWdhdGlvbntwYWRkaW5nLWxlZnQ6dmFyKC0tY2stc3BhY2luZy1sYXJnZSl9W2Rpcj1ydGxdIC5jay5jay1zcGVjaWFsLWNoYXJhY3RlcnMtbmF2aWdhdGlvbntwYWRkaW5nLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctbGFyZ2UpfS5jay5jay1zcGVjaWFsLWNoYXJhY3RlcnMtbmF2aWdhdGlvbj4uY2stbGFiZWx7bWF4LXdpZHRoOjE2MHB4O3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7b3ZlcmZsb3c6aGlkZGVufS5jay5jay1zcGVjaWFsLWNoYXJhY3RlcnMtbmF2aWdhdGlvbj4uY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19wYW5lbHttYXgtaGVpZ2h0OjI1MHB4O292ZXJmbG93LXk6YXV0bztvdmVyZmxvdy14OmhpZGRlbn1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDkzKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIjpyb290ey0tY2stY29sb3ItdGFibGUtZm9jdXNlZC1jZWxsLWJhY2tncm91bmQ6cmdiYSgxNTgsMjA3LDI1MCwwLjMpfS5jay13aWRnZXQudGFibGUgdGQuY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGUuY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGVfZm9jdXNlZCwuY2std2lkZ2V0LnRhYmxlIHRkLmNrLWVkaXRvcl9fbmVzdGVkLWVkaXRhYmxlOmZvY3VzLC5jay13aWRnZXQudGFibGUgdGguY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGUuY2stZWRpdG9yX19uZXN0ZWQtZWRpdGFibGVfZm9jdXNlZCwuY2std2lkZ2V0LnRhYmxlIHRoLmNrLWVkaXRvcl9fbmVzdGVkLWVkaXRhYmxlOmZvY3Vze2JhY2tncm91bmQ6dmFyKC0tY2stY29sb3ItdGFibGUtZm9jdXNlZC1jZWxsLWJhY2tncm91bmQpO2JvcmRlci1zdHlsZTpub25lO291dGxpbmU6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWZvY3VzLWJvcmRlcik7b3V0bGluZS1vZmZzZXQ6LTFweH1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDk1KTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jayAuY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duX19ncmlke2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC13cmFwOndyYXB9OnJvb3R7LS1jay1pbnNlcnQtdGFibGUtZHJvcGRvd24tcGFkZGluZzoxMHB4Oy0tY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duLWJveC1oZWlnaHQ6MTFweDstLWNrLWluc2VydC10YWJsZS1kcm9wZG93bi1ib3gtd2lkdGg6MTJweDstLWNrLWluc2VydC10YWJsZS1kcm9wZG93bi1ib3gtbWFyZ2luOjFweH0uY2sgLmNrLWluc2VydC10YWJsZS1kcm9wZG93bl9fZ3JpZHt3aWR0aDpjYWxjKHZhcigtLWNrLWluc2VydC10YWJsZS1kcm9wZG93bi1ib3gtd2lkdGgpKjEwICsgdmFyKC0tY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duLWJveC1tYXJnaW4pKjIwICsgdmFyKC0tY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duLXBhZGRpbmcpKjIpO3BhZGRpbmc6dmFyKC0tY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duLXBhZGRpbmcpIHZhcigtLWNrLWluc2VydC10YWJsZS1kcm9wZG93bi1wYWRkaW5nKSAwfS5jayAuY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duX19sYWJlbHt0ZXh0LWFsaWduOmNlbnRlcn0uY2sgLmNrLWluc2VydC10YWJsZS1kcm9wZG93bi1ncmlkLWJveHt3aWR0aDp2YXIoLS1jay1pbnNlcnQtdGFibGUtZHJvcGRvd24tYm94LXdpZHRoKTtoZWlnaHQ6dmFyKC0tY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duLWJveC1oZWlnaHQpO21hcmdpbjp2YXIoLS1jay1pbnNlcnQtdGFibGUtZHJvcGRvd24tYm94LW1hcmdpbik7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWJvcmRlcik7Ym9yZGVyLXJhZGl1czoxcHh9LmNrIC5jay1pbnNlcnQtdGFibGUtZHJvcGRvd24tZ3JpZC1ib3guY2stb257Ym9yZGVyLWNvbG9yOnZhcigtLWNrLWNvbG9yLWZvY3VzLWJvcmRlcik7YmFja2dyb3VuZDp2YXIoLS1jay1jb2xvci1mb2N1cy1vdXRlci1zaGFkb3cpfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoOTcpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiOnJvb3R7LS1jay10YWJsZS1zZWxlY3RlZC1jZWxsLWJhY2tncm91bmQ6I2NlZTVmZH0uY2suY2stZWRpdG9yX19lZGl0YWJsZSAudGFibGUgdGFibGUgdGQuY2stZWRpdG9yX19lZGl0YWJsZV9zZWxlY3RlZCwuY2suY2stZWRpdG9yX19lZGl0YWJsZSAudGFibGUgdGFibGUgdGguY2stZWRpdG9yX19lZGl0YWJsZV9zZWxlY3RlZHtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNrLXRhYmxlLXNlbGVjdGVkLWNlbGwtYmFja2dyb3VuZCkhaW1wb3J0YW50O2NhcmV0LWNvbG9yOnRyYW5zcGFyZW50O291dGxpbmU6dW5zZXQ7Ym94LXNoYWRvdzp1bnNldH0uY2suY2stZWRpdG9yX19lZGl0YWJsZSAudGFibGUgdGFibGUgdGQuY2stZWRpdG9yX19lZGl0YWJsZV9zZWxlY3RlZCA6OnNlbGVjdGlvbiwuY2suY2stZWRpdG9yX19lZGl0YWJsZSAudGFibGUgdGFibGUgdGguY2stZWRpdG9yX19lZGl0YWJsZV9zZWxlY3RlZCA6OnNlbGVjdGlvbntiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50fS5jay5jay1lZGl0b3JfX2VkaXRhYmxlIC50YWJsZSB0YWJsZSB0ZC5jay1lZGl0b3JfX2VkaXRhYmxlX3NlbGVjdGVkIC5jay13aWRnZXRfc2VsZWN0ZWQsLmNrLmNrLWVkaXRvcl9fZWRpdGFibGUgLnRhYmxlIHRhYmxlIHRoLmNrLWVkaXRvcl9fZWRpdGFibGVfc2VsZWN0ZWQgLmNrLXdpZGdldF9zZWxlY3RlZHtvdXRsaW5lOnVuc2V0fVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoOTkpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLWNvbnRlbnQgLnRhYmxle21hcmdpbjoxZW0gYXV0bztkaXNwbGF5OnRhYmxlfS5jay1jb250ZW50IC50YWJsZSB0YWJsZXtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7Ym9yZGVyLXNwYWNpbmc6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2JvcmRlcjoxcHggZG91YmxlICNiM2IzYjN9LmNrLWNvbnRlbnQgLnRhYmxlIHRhYmxlIHRkLC5jay1jb250ZW50IC50YWJsZSB0YWJsZSB0aHttaW4td2lkdGg6MmVtO3BhZGRpbmc6LjRlbTtib3JkZXItY29sb3I6I2JmYmZiZn0uY2stY29udGVudCAudGFibGUgdGFibGUgdGh7Zm9udC13ZWlnaHQ6NzAwO2JhY2tncm91bmQ6aHNsYSgwLDAlLDAlLDUlKX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDEwMSk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stbGFiZWxlZC12aWV3IC5jay1sYWJlbGVkLXZpZXdfX3N0YXR1c3tmb250LXNpemU6dmFyKC0tY2stZm9udC1zaXplLXNtYWxsKTttYXJnaW4tdG9wOnZhcigtLWNrLXNwYWNpbmctc21hbGwpO3doaXRlLXNwYWNlOm5vcm1hbH0uY2suY2stbGFiZWxlZC12aWV3IC5jay1sYWJlbGVkLXZpZXdfX3N0YXR1c19lcnJvcntjb2xvcjp2YXIoLS1jay1jb2xvci1iYXNlLWVycm9yKX0uY2suY2stbGFiZWxlZC12aWV3Pi5jay5jay1sYWJlbHt3aWR0aDoxMDAlO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7b3ZlcmZsb3c6aGlkZGVufVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMTAzKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay1pbnB1dC1jb2xvcnt3aWR0aDoxMDAlO2Rpc3BsYXk6ZmxleH0uY2suY2staW5wdXQtY29sb3I+aW5wdXQuY2suY2staW5wdXQtdGV4dHttaW4td2lkdGg6YXV0bztmbGV4LWdyb3c6MX0uY2suY2staW5wdXQtY29sb3I+aW5wdXQuY2suY2staW5wdXQtdGV4dDphY3RpdmUsLmNrLmNrLWlucHV0LWNvbG9yPmlucHV0LmNrLmNrLWlucHV0LXRleHQ6Zm9jdXN7ei1pbmRleDp2YXIoLS1jay16LWRlZmF1bHQpfS5jay5jay1pbnB1dC1jb2xvcj5kaXYuY2suY2stZHJvcGRvd257bWluLXdpZHRoOmF1dG99LmNrLmNrLWlucHV0LWNvbG9yPmRpdi5jay5jay1kcm9wZG93bj4uY2staW5wdXQtY29sb3JfX2J1dHRvbiAuY2stZHJvcGRvd25fX2Fycm93e2Rpc3BsYXk6bm9uZX0uY2suY2staW5wdXQtY29sb3IgLmNrLmNrLWlucHV0LWNvbG9yX19idXR0b24gLmNrLmNrLWlucHV0LWNvbG9yX19idXR0b25fX3ByZXZpZXd7cG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVufS5jay5jay1pbnB1dC1jb2xvciAuY2suY2staW5wdXQtY29sb3JfX2J1dHRvbiAuY2suY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlldz4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlld19fbm8tY29sb3ItaW5kaWNhdG9ye3Bvc2l0aW9uOmFic29sdXRlO2Rpc3BsYXk6YmxvY2t9W2Rpcj1sdHJdIC5jay5jay1pbnB1dC1jb2xvcj4uY2suY2staW5wdXQtdGV4dHtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjB9W2Rpcj1ydGxdIC5jay5jay1pbnB1dC1jb2xvcj4uY2suY2staW5wdXQtdGV4dHtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjA7Ym9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1czowfS5jay5jay1pbnB1dC1jb2xvcj4uY2suY2stZHJvcGRvd24+LmNrLmNrLWlucHV0LWNvbG9yX19idXR0b257cGFkZGluZzowfVtkaXI9bHRyXSAuY2suY2staW5wdXQtY29sb3I+LmNrLmNrLWRyb3Bkb3duPi5jay5jay1pbnB1dC1jb2xvcl9fYnV0dG9ue2JvcmRlci10b3AtbGVmdC1yYWRpdXM6MDtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjA7bWFyZ2luLWxlZnQ6LTFweH1bZGlyPXJ0bF0gLmNrLmNrLWlucHV0LWNvbG9yPi5jay5jay1kcm9wZG93bj4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbntib3JkZXItdG9wLXJpZ2h0LXJhZGl1czowO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjA7bWFyZ2luLXJpZ2h0Oi0xcHh9LmNrLmNrLWlucHV0LWNvbG9yPi5jay5jay1kcm9wZG93bj4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbi5jay1kaXNhYmxlZHtiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWlucHV0LWRpc2FibGVkLWJhY2tncm91bmQpfS5jay5jay1pbnB1dC1jb2xvcj4uY2suY2stZHJvcGRvd24+LmNrLmNrLWlucHV0LWNvbG9yX19idXR0b24+LmNrLmNrLWlucHV0LWNvbG9yX19idXR0b25fX3ByZXZpZXd7Ym9yZGVyLXJhZGl1czowfS5jay1yb3VuZGVkLWNvcm5lcnMgLmNrLmNrLWlucHV0LWNvbG9yPi5jay5jay1kcm9wZG93bj4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbj4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlldywuY2suY2staW5wdXQtY29sb3I+LmNrLmNrLWRyb3Bkb3duPi5jay5jay1pbnB1dC1jb2xvcl9fYnV0dG9uPi5jay5jay1pbnB1dC1jb2xvcl9fYnV0dG9uX19wcmV2aWV3LmNrLXJvdW5kZWQtY29ybmVyc3tib3JkZXItcmFkaXVzOnZhcigtLWNrLWJvcmRlci1yYWRpdXMpfS5jay5jay1pbnB1dC1jb2xvcj4uY2suY2stZHJvcGRvd24+LmNrLmNrLWlucHV0LWNvbG9yX19idXR0b24+LmNrLmNrLWlucHV0LWNvbG9yX19idXR0b25fX3ByZXZpZXd7d2lkdGg6MjBweDtoZWlnaHQ6MjBweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWlucHV0LWJvcmRlcil9LmNrLmNrLWlucHV0LWNvbG9yPi5jay5jay1kcm9wZG93bj4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbj4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlldz4uY2suY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlld19fbm8tY29sb3ItaW5kaWNhdG9ye3RvcDotMzAlO2xlZnQ6NTAlO2hlaWdodDoxNTAlO3dpZHRoOjglO2JhY2tncm91bmQ6cmVkO2JvcmRlci1yYWRpdXM6MnB4O3RyYW5zZm9ybTpyb3RhdGUoNDVkZWcpO3RyYW5zZm9ybS1vcmlnaW46NTAlfS5jay5jay1pbnB1dC1jb2xvciAuY2suY2staW5wdXQtY29sb3JfX3JlbW92ZS1jb2xvcnt3aWR0aDoxMDAlO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWlucHV0LWJvcmRlcik7cGFkZGluZzpjYWxjKHZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpLzIpIHZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpO2JvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MDtib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czowfVtkaXI9bHRyXSAuY2suY2staW5wdXQtY29sb3IgLmNrLmNrLWlucHV0LWNvbG9yX19yZW1vdmUtY29sb3J7Ym9yZGVyLXRvcC1yaWdodC1yYWRpdXM6MH1bZGlyPXJ0bF0gLmNrLmNrLWlucHV0LWNvbG9yIC5jay5jay1pbnB1dC1jb2xvcl9fcmVtb3ZlLWNvbG9ye2JvcmRlci10b3AtbGVmdC1yYWRpdXM6MH0uY2suY2staW5wdXQtY29sb3IgLmNrLmNrLWlucHV0LWNvbG9yX19yZW1vdmUtY29sb3IgLmNrLmNrLWljb257bWFyZ2luLXJpZ2h0OnZhcigtLWNrLXNwYWNpbmctc3RhbmRhcmQpfVtkaXI9cnRsXSAuY2suY2staW5wdXQtY29sb3IgLmNrLmNrLWlucHV0LWNvbG9yX19yZW1vdmUtY29sb3IgLmNrLmNrLWljb257bWFyZ2luLXJpZ2h0OjA7bWFyZ2luLWxlZnQ6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCl9XCJcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG4gPSBpKDEpO1xyXG4gICAgICAgIHZhciBvID0gaSgxMDUpO1xyXG4gICAgICAgIG8gPSBvLl9fZXNNb2R1bGUgPyBvLmRlZmF1bHQgOiBvO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvID0gW1t0LmksIG8sIFwiXCJdXVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgciA9IHtpbmplY3RUeXBlOiBcInNpbmdsZXRvblN0eWxlVGFnXCJ9O1xyXG4gICAgICAgIHIuaW5zZXJ0ID0gXCJoZWFkXCI7XHJcbiAgICAgICAgci5zaW5nbGV0b24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBzID0gbihvLCByKTtcclxuICAgICAgICB2YXIgYSA9IG8ubG9jYWxzID8gby5sb2NhbHMgOiB7fTtcclxuICAgICAgICB0LmV4cG9ydHMgPSBhXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWZvcm1fX3Jvd3tkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O2ZsZXgtd3JhcDpub3dyYXA7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW59LmNrLmNrLWZvcm1fX3Jvdz46bm90KC5jay1sYWJlbCl7ZmxleC1ncm93OjF9LmNrLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19hY3Rpb24tcm93IC5jay1idXR0b24tY2FuY2VsLC5jay5jay1mb3JtX19yb3cuY2stdGFibGUtZm9ybV9fYWN0aW9uLXJvdyAuY2stYnV0dG9uLXNhdmV7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uY2suY2stZm9ybV9fcm93e3BhZGRpbmc6dmFyKC0tY2stc3BhY2luZy1zdGFuZGFyZCkgdmFyKC0tY2stc3BhY2luZy1sYXJnZSkgMH1bZGlyPWx0cl0gLmNrLmNrLWZvcm1fX3Jvdz46bm90KC5jay1sYWJlbCkrKnttYXJnaW4tbGVmdDp2YXIoLS1jay1zcGFjaW5nLWxhcmdlKX1bZGlyPXJ0bF0gLmNrLmNrLWZvcm1fX3Jvdz46bm90KC5jay1sYWJlbCkrKnttYXJnaW4tcmlnaHQ6dmFyKC0tY2stc3BhY2luZy1sYXJnZSl9LmNrLmNrLWZvcm1fX3Jvdz4uY2stbGFiZWx7d2lkdGg6MTAwJTttaW4td2lkdGg6MTAwJX0uY2suY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2FjdGlvbi1yb3d7bWFyZ2luLXRvcDp2YXIoLS1jay1zcGFjaW5nLWxhcmdlKX0uY2suY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2FjdGlvbi1yb3cgLmNrLWJ1dHRvbiAuY2stYnV0dG9uX19sYWJlbHtjb2xvcjp2YXIoLS1jay1jb2xvci10ZXh0KX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDEwNyk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCI6cm9vdHstLWNrLXRhYmxlLWZvcm0taGVhZGVyLWhlaWdodDozOHB4fS5jay5jay1mb3JtX19oZWFkZXJ7cGFkZGluZzowIHZhcigtLWNrLXNwYWNpbmctbGFyZ2UpO2hlaWdodDp2YXIoLS1jay10YWJsZS1mb3JtLWhlYWRlci1oZWlnaHQpO2xpbmUtaGVpZ2h0OnZhcigtLWNrLXRhYmxlLWZvcm0taGVhZGVyLWhlaWdodCk7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tY2stY29sb3ItYmFzZS1ib3JkZXIpfS5jay5jay1mb3JtX19oZWFkZXIgLmNrLWZvcm1fX2hlYWRlcl9fbGFiZWx7Zm9udC13ZWlnaHQ6NzAwfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IFwiLmNrLmNrLWZvcm17cGFkZGluZzowIDAgdmFyKC0tY2stc3BhY2luZy1sYXJnZSl9LmNrLmNrLWZvcm06Zm9jdXN7b3V0bGluZTpub25lfS5jay5jay1mb3JtIC5jay5jay1pbnB1dC10ZXh0e21pbi13aWR0aDoxMDAlO3dpZHRoOjB9LmNrLmNrLWZvcm0gLmNrLmNrLWRyb3Bkb3due21pbi13aWR0aDoxMDAlfS5jay5jay1mb3JtIC5jay5jay1kcm9wZG93biAuY2stZHJvcGRvd25fX2J1dHRvbjpub3QoOmZvY3VzKXtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWNrLWNvbG9yLWJhc2UtYm9yZGVyKX0uY2suY2stZm9ybSAuY2suY2stZHJvcGRvd24gLmNrLWRyb3Bkb3duX19idXR0b24gLmNrLWJ1dHRvbl9fbGFiZWx7d2lkdGg6MTAwJX1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSAnLmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19ib3JkZXItcm93e2ZsZXgtd3JhcDp3cmFwfS5jay5jay10YWJsZS1mb3JtIC5jay1mb3JtX19yb3cuY2stdGFibGUtZm9ybV9fYm9yZGVyLXJvdyAuY2stbGFiZWxlZC12aWV3e2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW4tcmV2ZXJzZX0uY2suY2stdGFibGUtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2JvcmRlci1yb3cgLmNrLWxhYmVsZWQtdmlldyAuY2suY2stZHJvcGRvd24sLmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19ib3JkZXItcm93IC5jay10YWJsZS1mb3JtX19ib3JkZXItc3R5bGUsLmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19ib3JkZXItcm93IC5jay10YWJsZS1mb3JtX19ib3JkZXItd2lkdGh7ZmxleC1ncm93OjB9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvd3tmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXJ9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvdyAuY2stbGFiZWxlZC12aWV3e2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW4tcmV2ZXJzZTthbGlnbi1pdGVtczpjZW50ZXJ9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvdyAuY2stbGFiZWxlZC12aWV3IC5jay5jay1kcm9wZG93biwuY2suY2stdGFibGUtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93IC5jay10YWJsZS1mb3JtX19kaW1lbnNpb24tb3BlcmF0b3J7ZmxleC1ncm93OjB9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLmNrLWxhYmVsZWQtdmlld3twb3NpdGlvbjpyZWxhdGl2ZX0uY2suY2stdGFibGUtZm9ybSAuY2suY2stbGFiZWxlZC12aWV3IC5jay5jay1sYWJlbGVkLXZpZXdfX3N0YXR1c3twb3NpdGlvbjphYnNvbHV0ZTtsZWZ0OjUwJTtib3R0b206Y2FsYygtMSp2YXIoLS1jay10YWJsZS1wcm9wZXJ0aWVzLWVycm9yLWFycm93LXNpemUpKTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsMTAwJSk7ei1pbmRleDoxfS5jay5jay10YWJsZS1mb3JtIC5jay5jay1sYWJlbGVkLXZpZXcgLmNrLmNrLWxhYmVsZWQtdmlld19fc3RhdHVzOmFmdGVye2NvbnRlbnQ6XCJcIjtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6Y2FsYygtMSp2YXIoLS1jay10YWJsZS1wcm9wZXJ0aWVzLWVycm9yLWFycm93LXNpemUpKTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKX06cm9vdHstLWNrLXRhYmxlLXByb3BlcnRpZXMtZXJyb3ItYXJyb3ctc2l6ZTo2cHg7LS1jay10YWJsZS1wcm9wZXJ0aWVzLW1pbi1lcnJvci13aWR0aDoxNTBweH0uY2suY2stdGFibGUtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2JvcmRlci1yb3cgLmNrLWxhYmVsZWQtdmlldz4uY2stbGFiZWx7Zm9udC1zaXplOnZhcigtLWNrLWZvbnQtc2l6ZS10aW55KTt0ZXh0LWFsaWduOmNlbnRlcn0uY2suY2stdGFibGUtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2JvcmRlci1yb3cgLmNrLXRhYmxlLWZvcm1fX2JvcmRlci1zdHlsZXt3aWR0aDo4MHB4O21pbi13aWR0aDo4MHB4fS5jay5jay10YWJsZS1mb3JtIC5jay1mb3JtX19yb3cuY2stdGFibGUtZm9ybV9fYm9yZGVyLXJvdyAuY2stdGFibGUtZm9ybV9fYm9yZGVyLXdpZHRoe3dpZHRoOjUwcHg7bWluLXdpZHRoOjUwcHh9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvd3twYWRkaW5nOjB9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvdyAuY2stbGFiZWxlZC12aWV3Pi5jay1sYWJlbHtmb250LXNpemU6MTBweDt0ZXh0LWFsaWduOmNlbnRlcn0uY2suY2stdGFibGUtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93IC5jay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvd19faGVpZ2h0LC5jay5jay10YWJsZS1mb3JtIC5jay1mb3JtX19yb3cuY2stdGFibGUtZm9ybV9fZGltZW5zaW9ucy1yb3cgLmNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93X193aWR0aHttYXJnaW46MH0uY2suY2stdGFibGUtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93IC5jay10YWJsZS1mb3JtX19kaW1lbnNpb24tb3BlcmF0b3J7YWxpZ24tc2VsZjpzdGFydDtkaXNwbGF5OmlubGluZS1ibG9jaztoZWlnaHQ6dmFyKC0tY2stdWktY29tcG9uZW50LW1pbi1oZWlnaHQpO2xpbmUtaGVpZ2h0OnZhcigtLWNrLXVpLWNvbXBvbmVudC1taW4taGVpZ2h0KTttYXJnaW46MCB2YXIoLS1jay1zcGFjaW5nLXNtYWxsKX0uY2suY2stdGFibGUtZm9ybSAuY2suY2stbGFiZWxlZC12aWV3IC5jay5jay1sYWJlbGVkLXZpZXdfX3N0YXR1c3tib3JkZXItcmFkaXVzOjB9LmNrLXJvdW5kZWQtY29ybmVycyAuY2suY2stdGFibGUtZm9ybSAuY2suY2stbGFiZWxlZC12aWV3IC5jay5jay1sYWJlbGVkLXZpZXdfX3N0YXR1cywuY2suY2stdGFibGUtZm9ybSAuY2suY2stbGFiZWxlZC12aWV3IC5jay5jay1sYWJlbGVkLXZpZXdfX3N0YXR1cy5jay1yb3VuZGVkLWNvcm5lcnN7Ym9yZGVyLXJhZGl1czp2YXIoLS1jay1ib3JkZXItcmFkaXVzKX0uY2suY2stdGFibGUtZm9ybSAuY2suY2stbGFiZWxlZC12aWV3IC5jay5jay1sYWJlbGVkLXZpZXdfX3N0YXR1c3tiYWNrZ3JvdW5kOnZhcigtLWNrLWNvbG9yLWJhc2UtZXJyb3IpO2NvbG9yOnZhcigtLWNrLWNvbG9yLWJhc2UtYmFja2dyb3VuZCk7cGFkZGluZzp2YXIoLS1jay1zcGFjaW5nLXNtYWxsKSB2YXIoLS1jay1zcGFjaW5nLW1lZGl1bSk7bWluLXdpZHRoOnZhcigtLWNrLXRhYmxlLXByb3BlcnRpZXMtbWluLWVycm9yLXdpZHRoKTt0ZXh0LWFsaWduOmNlbnRlcn0uY2suY2stdGFibGUtZm9ybSAuY2suY2stbGFiZWxlZC12aWV3IC5jay5jay1sYWJlbGVkLXZpZXdfX3N0YXR1czphZnRlcntib3JkZXItbGVmdDp2YXIoLS1jay10YWJsZS1wcm9wZXJ0aWVzLWVycm9yLWFycm93LXNpemUpIHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b206dmFyKC0tY2stdGFibGUtcHJvcGVydGllcy1lcnJvci1hcnJvdy1zaXplKSBzb2xpZCB2YXIoLS1jay1jb2xvci1iYXNlLWVycm9yKTtib3JkZXItcmlnaHQ6dmFyKC0tY2stdGFibGUtcHJvcGVydGllcy1lcnJvci1hcnJvdy1zaXplKSBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItdG9wOjAgc29saWQgdHJhbnNwYXJlbnR9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLmNrLWxhYmVsZWQtdmlldyAuY2suY2stbGFiZWxlZC12aWV3X19zdGF0dXN7YW5pbWF0aW9uOmNrLXRhYmxlLWZvcm0tbGFiZWxlZC12aWV3LXN0YXR1cy1hcHBlYXIgLjE1cyBlYXNlIGJvdGh9LmNrLmNrLXRhYmxlLWZvcm0gLmNrLmNrLWxhYmVsZWQtdmlldyAuY2staW5wdXQuY2stZXJyb3I6bm90KDpmb2N1cykrLmNrLmNrLWxhYmVsZWQtdmlld19fc3RhdHVze2Rpc3BsYXk6bm9uZX1Aa2V5ZnJhbWVzIGNrLXRhYmxlLWZvcm0tbGFiZWxlZC12aWV3LXN0YXR1cy1hcHBlYXJ7MCV7b3BhY2l0eTowfXRve29wYWNpdHk6MX19J1xyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbiA9IGkoMSk7XHJcbiAgICAgICAgdmFyIG8gPSBpKDExMSk7XHJcbiAgICAgICAgbyA9IG8uX19lc01vZHVsZSA/IG8uZGVmYXVsdCA6IG87XHJcbiAgICAgICAgaWYgKHR5cGVvZiBvID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIG8gPSBbW3QuaSwgbywgXCJcIl1dXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciByID0ge2luamVjdFR5cGU6IFwic2luZ2xldG9uU3R5bGVUYWdcIn07XHJcbiAgICAgICAgci5pbnNlcnQgPSBcImhlYWRcIjtcclxuICAgICAgICByLnNpbmdsZXRvbiA9IHRydWU7XHJcbiAgICAgICAgdmFyIHMgPSBuKG8sIHIpO1xyXG4gICAgICAgIHZhciBhID0gby5sb2NhbHMgPyBvLmxvY2FscyA6IHt9O1xyXG4gICAgICAgIHQuZXhwb3J0cyA9IGFcclxuICAgIH0sIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5leHBvcnRzID0gXCIuY2suY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1jZWxsLXByb3BlcnRpZXMtZm9ybV9fYWxpZ25tZW50LXJvd3tmbGV4LXdyYXA6d3JhcH0uY2suY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1jZWxsLXByb3BlcnRpZXMtZm9ybV9fYWxpZ25tZW50LXJvdyAuY2suY2stdG9vbGJhcntmbGV4LWdyb3c6MH0uY2suY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm17d2lkdGg6MzIwcHh9LmNrLmNrLXRhYmxlLWNlbGwtcHJvcGVydGllcy1mb3JtIC5jay1mb3JtX19yb3cuY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm1fX3BhZGRpbmctcm93e3BhZGRpbmc6MDt3aWR0aDozNSV9LmNrLmNrLXRhYmxlLWNlbGwtcHJvcGVydGllcy1mb3JtIC5jay1mb3JtX19yb3cuY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3cgLmNrLmNrLXRvb2xiYXJ7YmFja2dyb3VuZDpub25lfVwiXHJcbiAgICB9LCBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBuID0gaSgxKTtcclxuICAgICAgICB2YXIgbyA9IGkoMTEzKTtcclxuICAgICAgICBvID0gby5fX2VzTW9kdWxlID8gby5kZWZhdWx0IDogbztcclxuICAgICAgICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgbyA9IFtbdC5pLCBvLCBcIlwiXV1cclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHIgPSB7aW5qZWN0VHlwZTogXCJzaW5nbGV0b25TdHlsZVRhZ1wifTtcclxuICAgICAgICByLmluc2VydCA9IFwiaGVhZFwiO1xyXG4gICAgICAgIHIuc2luZ2xldG9uID0gdHJ1ZTtcclxuICAgICAgICB2YXIgcyA9IG4obywgcik7XHJcbiAgICAgICAgdmFyIGEgPSBvLmxvY2FscyA/IG8ubG9jYWxzIDoge307XHJcbiAgICAgICAgdC5leHBvcnRzID0gYVxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmV4cG9ydHMgPSBcIi5jay5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3d7ZmxleC13cmFwOndyYXA7ZmxleC1iYXNpczowO2FsaWduLWNvbnRlbnQ6YmFzZWxpbmV9LmNrLmNrLXRhYmxlLXByb3BlcnRpZXMtZm9ybSAuY2stZm9ybV9fcm93LmNrLXRhYmxlLXByb3BlcnRpZXMtZm9ybV9fYWxpZ25tZW50LXJvdyAuY2suY2stdG9vbGJhciAuY2stdG9vbGJhcl9faXRlbXN7ZmxleC13cmFwOm5vd3JhcH0uY2suY2stdGFibGUtcHJvcGVydGllcy1mb3Jte3dpZHRoOjMyMHB4fS5jay5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3d7cGFkZGluZzowfS5jay5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3cgLmNrLmNrLXRvb2xiYXJ7YmFja2dyb3VuZDpub25lfS5jay5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm0gLmNrLWZvcm1fX3Jvdy5jay10YWJsZS1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3cgLmNrLmNrLXRvb2xiYXIgLmNrLXRvb2xiYXJfX2l0ZW1zPip7d2lkdGg6NDBweH1cIlxyXG4gICAgfSwgZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICBpLnIoZSk7XHJcbiAgICAgICAgaS5kKGUsIFwiZGVmYXVsdFwiLCAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX0lcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgdmFyIG4gPSBpKDMpO1xyXG4gICAgICAgIHZhciBvID0gbltcImFcIl0uU3ltYm9sO1xyXG4gICAgICAgIHZhciByID0gbztcclxuICAgICAgICB2YXIgcyA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIGEgPSBzLmhhc093blByb3BlcnR5O1xyXG4gICAgICAgIHZhciBjID0gcy50b1N0cmluZztcclxuICAgICAgICB2YXIgbCA9IHIgPyByLnRvU3RyaW5nVGFnIDogdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBkKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSBhLmNhbGwodCwgbCksIGkgPSB0W2xdO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdFtsXSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdHJ1ZVxyXG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG8gPSBjLmNhbGwodCk7XHJcbiAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbbF0gPSBpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0W2xdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB1ID0gZDtcclxuICAgICAgICB2YXIgaCA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIGYgPSBoLnRvU3RyaW5nO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGYuY2FsbCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG0gPSBnO1xyXG4gICAgICAgIHZhciBwID0gXCJbb2JqZWN0IE51bGxdXCIsIGIgPSBcIltvYmplY3QgVW5kZWZpbmVkXVwiO1xyXG4gICAgICAgIHZhciB3ID0gciA/IHIudG9TdHJpbmdUYWcgOiB1bmRlZmluZWQ7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGsodCkge1xyXG4gICAgICAgICAgICBpZiAodCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PT0gdW5kZWZpbmVkID8gYiA6IHBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdyAmJiB3IGluIE9iamVjdCh0KSA/IHUodCkgOiBtKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgXyA9IGs7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHYodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0KGUoaSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB5ID0gdjtcclxuICAgICAgICB2YXIgeCA9IHkoT2JqZWN0LmdldFByb3RvdHlwZU9mLCBPYmplY3QpO1xyXG4gICAgICAgIHZhciBDID0geDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ICE9IG51bGwgJiYgdHlwZW9mIHQgPT0gXCJvYmplY3RcIlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFQgPSBBO1xyXG4gICAgICAgIHZhciBQID0gXCJbb2JqZWN0IE9iamVjdF1cIjtcclxuICAgICAgICB2YXIgUyA9IEZ1bmN0aW9uLnByb3RvdHlwZSwgRSA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIFIgPSBTLnRvU3RyaW5nO1xyXG4gICAgICAgIHZhciBPID0gRS5oYXNPd25Qcm9wZXJ0eTtcclxuICAgICAgICB2YXIgSSA9IFIuY2FsbChPYmplY3QpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBWKHQpIHtcclxuICAgICAgICAgICAgaWYgKCFUKHQpIHx8IF8odCkgIT0gUCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGUgPSBDKHQpO1xyXG4gICAgICAgICAgICBpZiAoZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaSA9IE8uY2FsbChlLCBcImNvbnN0cnVjdG9yXCIpICYmIGUuY29uc3RydWN0b3I7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgaSA9PSBcImZ1bmN0aW9uXCIgJiYgaSBpbnN0YW5jZW9mIGkgJiYgUi5jYWxsKGkpID09IElcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBOID0gVjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTSgpIHtcclxuICAgICAgICAgICAgdGhpcy5fX2RhdGFfXyA9IFtdO1xyXG4gICAgICAgICAgICB0aGlzLnNpemUgPSAwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgQiA9IE07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHoodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCA9PT0gZSB8fCB0ICE9PSB0ICYmIGUgIT09IGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBMID0gejtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRih0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAgICAgICAgIGlmIChMKHRbaV1bMF0sIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gLTFcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBEID0gRjtcclxuICAgICAgICB2YXIgaiA9IEFycmF5LnByb3RvdHlwZTtcclxuICAgICAgICB2YXIgSCA9IGouc3BsaWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBXKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSB0aGlzLl9fZGF0YV9fLCBpID0gRChlLCB0KTtcclxuICAgICAgICAgICAgaWYgKGkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbiA9IGUubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgaWYgKGkgPT0gbikge1xyXG4gICAgICAgICAgICAgICAgZS5wb3AoKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgSC5jYWxsKGUsIGksIDEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLS10aGlzLnNpemU7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgcSA9IFc7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFUodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMuX19kYXRhX18sIGkgPSBEKGUsIHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gaSA8IDAgPyB1bmRlZmluZWQgOiBlW2ldWzFdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgJCA9IFU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEcodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gRCh0aGlzLl9fZGF0YV9fLCB0KSA+IC0xXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgSyA9IEc7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEoodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMuX19kYXRhX18sIG4gPSBEKGksIHQpO1xyXG4gICAgICAgICAgICBpZiAobiA8IDApIHtcclxuICAgICAgICAgICAgICAgICsrdGhpcy5zaXplO1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKFt0LCBlXSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlbbl1bMV0gPSBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBZID0gSjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUSh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gLTEsIGkgPSB0ID09IG51bGwgPyAwIDogdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgd2hpbGUgKCsrZSA8IGkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdFtlXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KG5bMF0sIG5bMV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFEucHJvdG90eXBlLmNsZWFyID0gQjtcclxuICAgICAgICBRLnByb3RvdHlwZVtcImRlbGV0ZVwiXSA9IHE7XHJcbiAgICAgICAgUS5wcm90b3R5cGUuZ2V0ID0gJDtcclxuICAgICAgICBRLnByb3RvdHlwZS5oYXMgPSBLO1xyXG4gICAgICAgIFEucHJvdG90eXBlLnNldCA9IFk7XHJcbiAgICAgICAgdmFyIFggPSBRO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBaKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9fZGF0YV9fID0gbmV3IFg7XHJcbiAgICAgICAgICAgIHRoaXMuc2l6ZSA9IDBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0dCA9IFo7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV0KHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSB0aGlzLl9fZGF0YV9fLCBpID0gZVtcImRlbGV0ZVwiXSh0KTtcclxuICAgICAgICAgICAgdGhpcy5zaXplID0gZS5zaXplO1xyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGl0ID0gZXQ7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG50KHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19kYXRhX18uZ2V0KHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgb3QgPSBudDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcnQodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX2RhdGFfXy5oYXModClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBzdCA9IHJ0O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhdCh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdHlwZW9mIHQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0ICE9IG51bGwgJiYgKGUgPT0gXCJvYmplY3RcIiB8fCBlID09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBjdCA9IGF0O1xyXG4gICAgICAgIHZhciBsdCA9IFwiW29iamVjdCBBc3luY0Z1bmN0aW9uXVwiLCBkdCA9IFwiW29iamVjdCBGdW5jdGlvbl1cIiwgdXQgPSBcIltvYmplY3QgR2VuZXJhdG9yRnVuY3Rpb25dXCIsXHJcbiAgICAgICAgICAgIGh0ID0gXCJbb2JqZWN0IFByb3h5XVwiO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBmdCh0KSB7XHJcbiAgICAgICAgICAgIGlmICghY3QodCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBlID0gXyh0KTtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPT0gZHQgfHwgZSA9PSB1dCB8fCBlID09IGx0IHx8IGUgPT0gaHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBndCA9IGZ0O1xyXG4gICAgICAgIHZhciBtdCA9IG5bXCJhXCJdW1wiX19jb3JlLWpzX3NoYXJlZF9fXCJdO1xyXG4gICAgICAgIHZhciBwdCA9IG10O1xyXG4gICAgICAgIHZhciBidCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSAvW14uXSskLy5leGVjKHB0ICYmIHB0LmtleXMgJiYgcHQua2V5cy5JRV9QUk9UTyB8fCBcIlwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHQgPyBcIlN5bWJvbChzcmMpXzEuXCIgKyB0IDogXCJcIlxyXG4gICAgICAgIH0oKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gd3QodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISFidCAmJiBidCBpbiB0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIga3QgPSB3dDtcclxuICAgICAgICB2YXIgX3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIHZ0ID0gX3QudG9TdHJpbmc7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHl0KHQpIHtcclxuICAgICAgICAgICAgaWYgKHQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdnQuY2FsbCh0KVxyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCArIFwiXCJcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHh0ID0geXQ7XHJcbiAgICAgICAgdmFyIEN0ID0gL1tcXFxcXiQuKis/KClbXFxde318XS9nO1xyXG4gICAgICAgIHZhciBBdCA9IC9eXFxbb2JqZWN0IC4rP0NvbnN0cnVjdG9yXFxdJC87XHJcbiAgICAgICAgdmFyIFR0ID0gRnVuY3Rpb24ucHJvdG90eXBlLCBQdCA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIFN0ID0gVHQudG9TdHJpbmc7XHJcbiAgICAgICAgdmFyIEV0ID0gUHQuaGFzT3duUHJvcGVydHk7XHJcbiAgICAgICAgdmFyIFJ0ID0gUmVnRXhwKFwiXlwiICsgU3QuY2FsbChFdCkucmVwbGFjZShDdCwgXCJcXFxcJCZcIikucmVwbGFjZSgvaGFzT3duUHJvcGVydHl8KGZ1bmN0aW9uKS4qPyg/PVxcXFxcXCgpfCBmb3IgLis/KD89XFxcXFxcXSkvZywgXCIkMS4qP1wiKSArIFwiJFwiKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gT3QodCkge1xyXG4gICAgICAgICAgICBpZiAoIWN0KHQpIHx8IGt0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZSA9IGd0KHQpID8gUnQgOiBBdDtcclxuICAgICAgICAgICAgcmV0dXJuIGUudGVzdCh4dCh0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBJdCA9IE90O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBWdCh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ID09IG51bGwgPyB1bmRlZmluZWQgOiB0W2VdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgTnQgPSBWdDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTXQodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IE50KHQsIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gSXQoaSkgPyBpIDogdW5kZWZpbmVkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgQnQgPSBNdDtcclxuICAgICAgICB2YXIgenQgPSBCdChuW1wiYVwiXSwgXCJNYXBcIik7XHJcbiAgICAgICAgdmFyIEx0ID0genQ7XHJcbiAgICAgICAgdmFyIEZ0ID0gQnQoT2JqZWN0LCBcImNyZWF0ZVwiKTtcclxuICAgICAgICB2YXIgRHQgPSBGdDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24ganQoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19kYXRhX18gPSBEdCA/IER0KG51bGwpIDoge307XHJcbiAgICAgICAgICAgIHRoaXMuc2l6ZSA9IDBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBIdCA9IGp0O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBXdCh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdGhpcy5oYXModCkgJiYgZGVsZXRlIHRoaXMuX19kYXRhX19bdF07XHJcbiAgICAgICAgICAgIHRoaXMuc2l6ZSAtPSBlID8gMSA6IDA7XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgcXQgPSBXdDtcclxuICAgICAgICB2YXIgVXQgPSBcIl9fbG9kYXNoX2hhc2hfdW5kZWZpbmVkX19cIjtcclxuICAgICAgICB2YXIgJHQgPSBPYmplY3QucHJvdG90eXBlO1xyXG4gICAgICAgIHZhciBHdCA9ICR0Lmhhc093blByb3BlcnR5O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBLdCh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdGhpcy5fX2RhdGFfXztcclxuICAgICAgICAgICAgaWYgKER0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IGVbdF07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaSA9PT0gVXQgPyB1bmRlZmluZWQgOiBpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIEd0LmNhbGwoZSwgdCkgPyBlW3RdIDogdW5kZWZpbmVkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgSnQgPSBLdDtcclxuICAgICAgICB2YXIgWXQgPSBPYmplY3QucHJvdG90eXBlO1xyXG4gICAgICAgIHZhciBRdCA9IFl0Lmhhc093blByb3BlcnR5O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBYdCh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdGhpcy5fX2RhdGFfXztcclxuICAgICAgICAgICAgcmV0dXJuIER0ID8gZVt0XSAhPT0gdW5kZWZpbmVkIDogUXQuY2FsbChlLCB0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFp0ID0gWHQ7XHJcbiAgICAgICAgdmFyIHRlID0gXCJfX2xvZGFzaF9oYXNoX3VuZGVmaW5lZF9fXCI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVlKHQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSB0aGlzLl9fZGF0YV9fO1xyXG4gICAgICAgICAgICB0aGlzLnNpemUgKz0gdGhpcy5oYXModCkgPyAwIDogMTtcclxuICAgICAgICAgICAgaVt0XSA9IER0ICYmIGUgPT09IHVuZGVmaW5lZCA/IHRlIDogZTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBpZSA9IGVlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZSh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gLTEsIGkgPSB0ID09IG51bGwgPyAwIDogdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgd2hpbGUgKCsrZSA8IGkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdFtlXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KG5bMF0sIG5bMV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5lLnByb3RvdHlwZS5jbGVhciA9IEh0O1xyXG4gICAgICAgIG5lLnByb3RvdHlwZVtcImRlbGV0ZVwiXSA9IHF0O1xyXG4gICAgICAgIG5lLnByb3RvdHlwZS5nZXQgPSBKdDtcclxuICAgICAgICBuZS5wcm90b3R5cGUuaGFzID0gWnQ7XHJcbiAgICAgICAgbmUucHJvdG90eXBlLnNldCA9IGllO1xyXG4gICAgICAgIHZhciBvZSA9IG5lO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiByZSgpIHtcclxuICAgICAgICAgICAgdGhpcy5zaXplID0gMDtcclxuICAgICAgICAgICAgdGhpcy5fX2RhdGFfXyA9IHtoYXNoOiBuZXcgb2UsIG1hcDogbmV3IChMdCB8fCBYKSwgc3RyaW5nOiBuZXcgb2V9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc2UgPSByZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWUodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHR5cGVvZiB0O1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PSBcInN0cmluZ1wiIHx8IGUgPT0gXCJudW1iZXJcIiB8fCBlID09IFwic3ltYm9sXCIgfHwgZSA9PSBcImJvb2xlYW5cIiA/IHQgIT09IFwiX19wcm90b19fXCIgOiB0ID09PSBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgY2UgPSBhZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGUodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHQuX19kYXRhX187XHJcbiAgICAgICAgICAgIHJldHVybiBjZShlKSA/IGlbdHlwZW9mIGUgPT0gXCJzdHJpbmdcIiA/IFwic3RyaW5nXCIgOiBcImhhc2hcIl0gOiBpLm1hcFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGRlID0gbGU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVlKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSBkZSh0aGlzLCB0KVtcImRlbGV0ZVwiXSh0KTtcclxuICAgICAgICAgICAgdGhpcy5zaXplIC09IGUgPyAxIDogMDtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBoZSA9IHVlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBmZSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZSh0aGlzLCB0KS5nZXQodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBnZSA9IGZlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBtZSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkZSh0aGlzLCB0KS5oYXModClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBwZSA9IG1lO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBiZSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gZGUodGhpcywgdCksIG4gPSBpLnNpemU7XHJcbiAgICAgICAgICAgIGkuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICB0aGlzLnNpemUgKz0gaS5zaXplID09IG4gPyAwIDogMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB3ZSA9IGJlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBrZSh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gLTEsIGkgPSB0ID09IG51bGwgPyAwIDogdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgd2hpbGUgKCsrZSA8IGkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdFtlXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KG5bMF0sIG5bMV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGtlLnByb3RvdHlwZS5jbGVhciA9IHNlO1xyXG4gICAgICAgIGtlLnByb3RvdHlwZVtcImRlbGV0ZVwiXSA9IGhlO1xyXG4gICAgICAgIGtlLnByb3RvdHlwZS5nZXQgPSBnZTtcclxuICAgICAgICBrZS5wcm90b3R5cGUuaGFzID0gcGU7XHJcbiAgICAgICAga2UucHJvdG90eXBlLnNldCA9IHdlO1xyXG4gICAgICAgIHZhciBfZSA9IGtlO1xyXG4gICAgICAgIHZhciB2ZSA9IDIwMDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24geWUodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHRoaXMuX19kYXRhX187XHJcbiAgICAgICAgICAgIGlmIChpIGluc3RhbmNlb2YgWCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBpLl9fZGF0YV9fO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFMdCB8fCBuLmxlbmd0aCA8IHZlIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4ucHVzaChbdCwgZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2l6ZSA9ICsraS5zaXplO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpID0gdGhpcy5fX2RhdGFfXyA9IG5ldyBfZShuKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICB0aGlzLnNpemUgPSBpLnNpemU7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgeGUgPSB5ZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ2UodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMuX19kYXRhX18gPSBuZXcgWCh0KTtcclxuICAgICAgICAgICAgdGhpcy5zaXplID0gZS5zaXplXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBDZS5wcm90b3R5cGUuY2xlYXIgPSB0dDtcclxuICAgICAgICBDZS5wcm90b3R5cGVbXCJkZWxldGVcIl0gPSBpdDtcclxuICAgICAgICBDZS5wcm90b3R5cGUuZ2V0ID0gb3Q7XHJcbiAgICAgICAgQ2UucHJvdG90eXBlLmhhcyA9IHN0O1xyXG4gICAgICAgIENlLnByb3RvdHlwZS5zZXQgPSB4ZTtcclxuICAgICAgICB2YXIgQWUgPSBDZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVGUodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IC0xLCBuID0gdCA9PSBudWxsID8gMCA6IHQubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUodFtpXSwgaSwgdCkgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFBlID0gVGU7XHJcbiAgICAgICAgdmFyIFNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSBCdChPYmplY3QsIFwiZGVmaW5lUHJvcGVydHlcIik7XHJcbiAgICAgICAgICAgICAgICB0KHt9LCBcIlwiLCB7fSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KCk7XHJcbiAgICAgICAgdmFyIEVlID0gU2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFJlKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaWYgKGUgPT0gXCJfX3Byb3RvX19cIiAmJiBFZSkge1xyXG4gICAgICAgICAgICAgICAgRWUodCwgZSwge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IGksIHdyaXRhYmxlOiB0cnVlfSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRbZV0gPSBpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBPZSA9IFJlO1xyXG4gICAgICAgIHZhciBJZSA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIFZlID0gSWUuaGFzT3duUHJvcGVydHk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5lKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSB0W2VdO1xyXG4gICAgICAgICAgICBpZiAoIShWZS5jYWxsKHQsIGUpICYmIEwobiwgaSkpIHx8IGkgPT09IHVuZGVmaW5lZCAmJiAhKGUgaW4gdCkpIHtcclxuICAgICAgICAgICAgICAgIE9lKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBNZSA9IE5lO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBCZSh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIHZhciBvID0gIWk7XHJcbiAgICAgICAgICAgIGkgfHwgKGkgPSB7fSk7XHJcbiAgICAgICAgICAgIHZhciByID0gLTEsIHMgPSBlLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUgKCsrciA8IHMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhID0gZVtyXTtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gbiA/IG4oaVthXSwgdFthXSwgYSwgaSwgdCkgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoYyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IHRbYV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgT2UoaSwgYSwgYylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTWUoaSwgYSwgYylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHplID0gQmU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIExlKHQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSAtMSwgbiA9IEFycmF5KHQpO1xyXG4gICAgICAgICAgICB3aGlsZSAoKytpIDwgdCkge1xyXG4gICAgICAgICAgICAgICAgbltpXSA9IGUoaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEZlID0gTGU7XHJcbiAgICAgICAgdmFyIERlID0gXCJbb2JqZWN0IEFyZ3VtZW50c11cIjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gamUodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVCh0KSAmJiBfKHQpID09IERlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgSGUgPSBqZTtcclxuICAgICAgICB2YXIgV2UgPSBPYmplY3QucHJvdG90eXBlO1xyXG4gICAgICAgIHZhciBxZSA9IFdlLmhhc093blByb3BlcnR5O1xyXG4gICAgICAgIHZhciBVZSA9IFdlLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xyXG4gICAgICAgIHZhciAkZSA9IEhlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFyZ3VtZW50c1xyXG4gICAgICAgIH0oKSkgPyBIZSA6IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUKHQpICYmIHFlLmNhbGwodCwgXCJjYWxsZWVcIikgJiYgIVVlLmNhbGwodCwgXCJjYWxsZWVcIilcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBHZSA9ICRlO1xyXG4gICAgICAgIHZhciBLZSA9IEFycmF5LmlzQXJyYXk7XHJcbiAgICAgICAgdmFyIEplID0gS2U7XHJcbiAgICAgICAgdmFyIFllID0gaSg0KTtcclxuICAgICAgICB2YXIgUWUgPSA5MDA3MTk5MjU0NzQwOTkxO1xyXG4gICAgICAgIHZhciBYZSA9IC9eKD86MHxbMS05XVxcZCopJC87XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFplKHQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSB0eXBlb2YgdDtcclxuICAgICAgICAgICAgZSA9IGUgPT0gbnVsbCA/IFFlIDogZTtcclxuICAgICAgICAgICAgcmV0dXJuICEhZSAmJiAoaSA9PSBcIm51bWJlclwiIHx8IGkgIT0gXCJzeW1ib2xcIiAmJiBYZS50ZXN0KHQpKSAmJiAodCA+IC0xICYmIHQgJSAxID09IDAgJiYgdCA8IGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGkgPSBaZTtcclxuICAgICAgICB2YXIgZWkgPSA5MDA3MTk5MjU0NzQwOTkxO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBpaSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdCA9PSBcIm51bWJlclwiICYmIHQgPiAtMSAmJiB0ICUgMSA9PSAwICYmIHQgPD0gZWlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBuaSA9IGlpO1xyXG4gICAgICAgIHZhciBvaSA9IFwiW29iamVjdCBBcmd1bWVudHNdXCIsIHJpID0gXCJbb2JqZWN0IEFycmF5XVwiLCBzaSA9IFwiW29iamVjdCBCb29sZWFuXVwiLCBhaSA9IFwiW29iamVjdCBEYXRlXVwiLFxyXG4gICAgICAgICAgICBjaSA9IFwiW29iamVjdCBFcnJvcl1cIiwgbGkgPSBcIltvYmplY3QgRnVuY3Rpb25dXCIsIGRpID0gXCJbb2JqZWN0IE1hcF1cIiwgdWkgPSBcIltvYmplY3QgTnVtYmVyXVwiLFxyXG4gICAgICAgICAgICBoaSA9IFwiW29iamVjdCBPYmplY3RdXCIsIGZpID0gXCJbb2JqZWN0IFJlZ0V4cF1cIiwgZ2kgPSBcIltvYmplY3QgU2V0XVwiLCBtaSA9IFwiW29iamVjdCBTdHJpbmddXCIsXHJcbiAgICAgICAgICAgIHBpID0gXCJbb2JqZWN0IFdlYWtNYXBdXCI7XHJcbiAgICAgICAgdmFyIGJpID0gXCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiLCB3aSA9IFwiW29iamVjdCBEYXRhVmlld11cIiwga2kgPSBcIltvYmplY3QgRmxvYXQzMkFycmF5XVwiLFxyXG4gICAgICAgICAgICBfaSA9IFwiW29iamVjdCBGbG9hdDY0QXJyYXldXCIsIHZpID0gXCJbb2JqZWN0IEludDhBcnJheV1cIiwgeWkgPSBcIltvYmplY3QgSW50MTZBcnJheV1cIixcclxuICAgICAgICAgICAgeGkgPSBcIltvYmplY3QgSW50MzJBcnJheV1cIiwgQ2kgPSBcIltvYmplY3QgVWludDhBcnJheV1cIiwgQWkgPSBcIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldXCIsXHJcbiAgICAgICAgICAgIFRpID0gXCJbb2JqZWN0IFVpbnQxNkFycmF5XVwiLCBQaSA9IFwiW29iamVjdCBVaW50MzJBcnJheV1cIjtcclxuICAgICAgICB2YXIgU2kgPSB7fTtcclxuICAgICAgICBTaVtraV0gPSBTaVtfaV0gPSBTaVt2aV0gPSBTaVt5aV0gPSBTaVt4aV0gPSBTaVtDaV0gPSBTaVtBaV0gPSBTaVtUaV0gPSBTaVtQaV0gPSB0cnVlO1xyXG4gICAgICAgIFNpW29pXSA9IFNpW3JpXSA9IFNpW2JpXSA9IFNpW3NpXSA9IFNpW3dpXSA9IFNpW2FpXSA9IFNpW2NpXSA9IFNpW2xpXSA9IFNpW2RpXSA9IFNpW3VpXSA9IFNpW2hpXSA9IFNpW2ZpXSA9IFNpW2dpXSA9IFNpW21pXSA9IFNpW3BpXSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBFaSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUKHQpICYmIG5pKHQubGVuZ3RoKSAmJiAhIVNpW18odCldXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgUmkgPSBFaTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gT2kodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0KGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBJaSA9IE9pO1xyXG4gICAgICAgIHZhciBWaSA9IGkoNSk7XHJcbiAgICAgICAgdmFyIE5pID0gVmlbXCJhXCJdICYmIFZpW1wiYVwiXS5pc1R5cGVkQXJyYXk7XHJcbiAgICAgICAgdmFyIE1pID0gTmkgPyBJaShOaSkgOiBSaTtcclxuICAgICAgICB2YXIgQmkgPSBNaTtcclxuICAgICAgICB2YXIgemkgPSBPYmplY3QucHJvdG90eXBlO1xyXG4gICAgICAgIHZhciBMaSA9IHppLmhhc093blByb3BlcnR5O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBGaSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gSmUodCksIG4gPSAhaSAmJiBHZSh0KSwgbyA9ICFpICYmICFuICYmIE9iamVjdChZZVtcImFcIl0pKHQpLCByID0gIWkgJiYgIW4gJiYgIW8gJiYgQmkodCksXHJcbiAgICAgICAgICAgICAgICBzID0gaSB8fCBuIHx8IG8gfHwgciwgYSA9IHMgPyBGZSh0Lmxlbmd0aCwgU3RyaW5nKSA6IFtdLCBjID0gYS5sZW5ndGg7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGwgaW4gdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKChlIHx8IExpLmNhbGwodCwgbCkpICYmICEocyAmJiAobCA9PSBcImxlbmd0aFwiIHx8IG8gJiYgKGwgPT0gXCJvZmZzZXRcIiB8fCBsID09IFwicGFyZW50XCIpIHx8IHIgJiYgKGwgPT0gXCJidWZmZXJcIiB8fCBsID09IFwiYnl0ZUxlbmd0aFwiIHx8IGwgPT0gXCJieXRlT2Zmc2V0XCIpIHx8IHRpKGwsIGMpKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBhLnB1c2gobClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIERpID0gRmk7XHJcbiAgICAgICAgdmFyIGppID0gT2JqZWN0LnByb3RvdHlwZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSGkodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHQgJiYgdC5jb25zdHJ1Y3RvciwgaSA9IHR5cGVvZiBlID09IFwiZnVuY3Rpb25cIiAmJiBlLnByb3RvdHlwZSB8fCBqaTtcclxuICAgICAgICAgICAgcmV0dXJuIHQgPT09IGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBXaSA9IEhpO1xyXG4gICAgICAgIHZhciBxaSA9IHkoT2JqZWN0LmtleXMsIE9iamVjdCk7XHJcbiAgICAgICAgdmFyIFVpID0gcWk7XHJcbiAgICAgICAgdmFyICRpID0gT2JqZWN0LnByb3RvdHlwZTtcclxuICAgICAgICB2YXIgR2kgPSAkaS5oYXNPd25Qcm9wZXJ0eTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gS2kodCkge1xyXG4gICAgICAgICAgICBpZiAoIVdpKHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVWkodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIE9iamVjdCh0KSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKEdpLmNhbGwodCwgaSkgJiYgaSAhPSBcImNvbnN0cnVjdG9yXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnB1c2goaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEppID0gS2k7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFlpKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgIT0gbnVsbCAmJiBuaSh0Lmxlbmd0aCkgJiYgIWd0KHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgUWkgPSBZaTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWGkodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUWkodCkgPyBEaSh0KSA6IEppKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgWmkgPSBYaTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdG4odCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCAmJiB6ZShlLCBaaShlKSwgdClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlbiA9IHRuO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBubih0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gW107XHJcbiAgICAgICAgICAgIGlmICh0ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gT2JqZWN0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBvbiA9IG5uO1xyXG4gICAgICAgIHZhciBybiA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIHNuID0gcm4uaGFzT3duUHJvcGVydHk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFuKHQpIHtcclxuICAgICAgICAgICAgaWYgKCFjdCh0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9uKHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGUgPSBXaSh0KSwgaSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBuIGluIHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKG4gPT0gXCJjb25zdHJ1Y3RvclwiICYmIChlIHx8ICFzbi5jYWxsKHQsIG4pKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnB1c2gobilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNuID0gYW47XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxuKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFFpKHQpID8gRGkodCwgdHJ1ZSkgOiBjbih0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGRuID0gbG47XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVuKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgJiYgemUoZSwgZG4oZSksIHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaG4gPSB1bjtcclxuICAgICAgICB2YXIgZm4gPSBpKDgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnbih0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gLTEsIG4gPSB0Lmxlbmd0aDtcclxuICAgICAgICAgICAgZSB8fCAoZSA9IEFycmF5KG4pKTtcclxuICAgICAgICAgICAgd2hpbGUgKCsraSA8IG4pIHtcclxuICAgICAgICAgICAgICAgIGVbaV0gPSB0W2ldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtbiA9IGduO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBwbih0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gLTEsIG4gPSB0ID09IG51bGwgPyAwIDogdC5sZW5ndGgsIG8gPSAwLCByID0gW107XHJcbiAgICAgICAgICAgIHdoaWxlICgrK2kgPCBuKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHRbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZShzLCBpLCB0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJbbysrXSA9IHNcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gclxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGJuID0gcG47XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHduKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW11cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBrbiA9IHduO1xyXG4gICAgICAgIHZhciBfbiA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIHZuID0gX24ucHJvcGVydHlJc0VudW1lcmFibGU7XHJcbiAgICAgICAgdmFyIHluID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scztcclxuICAgICAgICB2YXIgeG4gPSAheW4gPyBrbiA6IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQgPSBPYmplY3QodCk7XHJcbiAgICAgICAgICAgIHJldHVybiBibih5bih0KSwgKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm4uY2FsbCh0LCBlKVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBDbiA9IHhuO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBBbih0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB6ZSh0LCBDbih0KSwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBUbiA9IEFuO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBQbih0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gLTEsIG4gPSBlLmxlbmd0aCwgbyA9IHQubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xyXG4gICAgICAgICAgICAgICAgdFtvICsgaV0gPSBlW2ldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBTbiA9IFBuO1xyXG4gICAgICAgIHZhciBFbiA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHM7XHJcbiAgICAgICAgdmFyIFJuID0gIUVuID8ga24gOiBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IFtdO1xyXG4gICAgICAgICAgICB3aGlsZSAodCkge1xyXG4gICAgICAgICAgICAgICAgU24oZSwgQ24odCkpO1xyXG4gICAgICAgICAgICAgICAgdCA9IEModClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIE9uID0gUm47XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEluKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHplKHQsIE9uKHQpLCBlKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFZuID0gSW47XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5uKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSBlKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gSmUodCkgPyBuIDogU24obiwgaSh0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBNbiA9IE5uO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBCbih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNbih0LCBaaSwgQ24pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgem4gPSBCbjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTG4odCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTW4odCwgZG4sIE9uKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEZuID0gTG47XHJcbiAgICAgICAgdmFyIERuID0gQnQobltcImFcIl0sIFwiRGF0YVZpZXdcIik7XHJcbiAgICAgICAgdmFyIGpuID0gRG47XHJcbiAgICAgICAgdmFyIEhuID0gQnQobltcImFcIl0sIFwiUHJvbWlzZVwiKTtcclxuICAgICAgICB2YXIgV24gPSBIbjtcclxuICAgICAgICB2YXIgcW4gPSBCdChuW1wiYVwiXSwgXCJTZXRcIik7XHJcbiAgICAgICAgdmFyIFVuID0gcW47XHJcbiAgICAgICAgdmFyICRuID0gQnQobltcImFcIl0sIFwiV2Vha01hcFwiKTtcclxuICAgICAgICB2YXIgR24gPSAkbjtcclxuICAgICAgICB2YXIgS24gPSBcIltvYmplY3QgTWFwXVwiLCBKbiA9IFwiW29iamVjdCBPYmplY3RdXCIsIFluID0gXCJbb2JqZWN0IFByb21pc2VdXCIsIFFuID0gXCJbb2JqZWN0IFNldF1cIixcclxuICAgICAgICAgICAgWG4gPSBcIltvYmplY3QgV2Vha01hcF1cIjtcclxuICAgICAgICB2YXIgWm4gPSBcIltvYmplY3QgRGF0YVZpZXddXCI7XHJcbiAgICAgICAgdmFyIHRvID0geHQoam4pLCBlbyA9IHh0KEx0KSwgaW8gPSB4dChXbiksIG5vID0geHQoVW4pLCBvbyA9IHh0KEduKTtcclxuICAgICAgICB2YXIgcm8gPSBfO1xyXG4gICAgICAgIGlmIChqbiAmJiBybyhuZXcgam4obmV3IEFycmF5QnVmZmVyKDEpKSkgIT0gWm4gfHwgTHQgJiYgcm8obmV3IEx0KSAhPSBLbiB8fCBXbiAmJiBybyhXbi5yZXNvbHZlKCkpICE9IFluIHx8IFVuICYmIHJvKG5ldyBVbikgIT0gUW4gfHwgR24gJiYgcm8obmV3IEduKSAhPSBYbikge1xyXG4gICAgICAgICAgICBybyA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IF8odCksIGkgPSBlID09IEpuID8gdC5jb25zdHJ1Y3RvciA6IHVuZGVmaW5lZCwgbiA9IGkgPyB4dChpKSA6IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIHRvOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFpuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGVvOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEtuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGlvOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFluO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIG5vOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFFuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIG9vOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFhuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc28gPSBybztcclxuICAgICAgICB2YXIgYW8gPSBPYmplY3QucHJvdG90eXBlO1xyXG4gICAgICAgIHZhciBjbyA9IGFvLmhhc093blByb3BlcnR5O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsbyh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdC5sZW5ndGgsIGkgPSBuZXcgdC5jb25zdHJ1Y3RvcihlKTtcclxuICAgICAgICAgICAgaWYgKGUgJiYgdHlwZW9mIHRbMF0gPT0gXCJzdHJpbmdcIiAmJiBjby5jYWxsKHQsIFwiaW5kZXhcIikpIHtcclxuICAgICAgICAgICAgICAgIGkuaW5kZXggPSB0LmluZGV4O1xyXG4gICAgICAgICAgICAgICAgaS5pbnB1dCA9IHQuaW5wdXRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHVvID0gbG87XHJcbiAgICAgICAgdmFyIGhvID0gbltcImFcIl0uVWludDhBcnJheTtcclxuICAgICAgICB2YXIgZm8gPSBobztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ28odCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IG5ldyB0LmNvbnN0cnVjdG9yKHQuYnl0ZUxlbmd0aCk7XHJcbiAgICAgICAgICAgIG5ldyBmbyhlKS5zZXQobmV3IGZvKHQpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtbyA9IGdvO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBwbyh0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gZSA/IG1vKHQuYnVmZmVyKSA6IHQuYnVmZmVyO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IHQuY29uc3RydWN0b3IoaSwgdC5ieXRlT2Zmc2V0LCB0LmJ5dGVMZW5ndGgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgYm8gPSBwbztcclxuICAgICAgICB2YXIgd28gPSAvXFx3KiQvO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBrbyh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gbmV3IHQuY29uc3RydWN0b3IodC5zb3VyY2UsIHdvLmV4ZWModCkpO1xyXG4gICAgICAgICAgICBlLmxhc3RJbmRleCA9IHQubGFzdEluZGV4O1xyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIF9vID0ga287XHJcbiAgICAgICAgdmFyIHZvID0gciA/IHIucHJvdG90eXBlIDogdW5kZWZpbmVkLCB5byA9IHZvID8gdm8udmFsdWVPZiA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24geG8odCkge1xyXG4gICAgICAgICAgICByZXR1cm4geW8gPyBPYmplY3QoeW8uY2FsbCh0KSkgOiB7fVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIENvID0geG87XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEFvKHQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSBlID8gbW8odC5idWZmZXIpIDogdC5idWZmZXI7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgdC5jb25zdHJ1Y3RvcihpLCB0LmJ5dGVPZmZzZXQsIHQubGVuZ3RoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFRvID0gQW87XHJcbiAgICAgICAgdmFyIFBvID0gXCJbb2JqZWN0IEJvb2xlYW5dXCIsIFNvID0gXCJbb2JqZWN0IERhdGVdXCIsIEVvID0gXCJbb2JqZWN0IE1hcF1cIiwgUm8gPSBcIltvYmplY3QgTnVtYmVyXVwiLFxyXG4gICAgICAgICAgICBPbyA9IFwiW29iamVjdCBSZWdFeHBdXCIsIElvID0gXCJbb2JqZWN0IFNldF1cIiwgVm8gPSBcIltvYmplY3QgU3RyaW5nXVwiLCBObyA9IFwiW29iamVjdCBTeW1ib2xdXCI7XHJcbiAgICAgICAgdmFyIE1vID0gXCJbb2JqZWN0IEFycmF5QnVmZmVyXVwiLCBCbyA9IFwiW29iamVjdCBEYXRhVmlld11cIiwgem8gPSBcIltvYmplY3QgRmxvYXQzMkFycmF5XVwiLFxyXG4gICAgICAgICAgICBMbyA9IFwiW29iamVjdCBGbG9hdDY0QXJyYXldXCIsIEZvID0gXCJbb2JqZWN0IEludDhBcnJheV1cIiwgRG8gPSBcIltvYmplY3QgSW50MTZBcnJheV1cIixcclxuICAgICAgICAgICAgam8gPSBcIltvYmplY3QgSW50MzJBcnJheV1cIiwgSG8gPSBcIltvYmplY3QgVWludDhBcnJheV1cIiwgV28gPSBcIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldXCIsXHJcbiAgICAgICAgICAgIHFvID0gXCJbb2JqZWN0IFVpbnQxNkFycmF5XVwiLCBVbyA9IFwiW29iamVjdCBVaW50MzJBcnJheV1cIjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gJG8odCwgZSwgaSkge1xyXG4gICAgICAgICAgICB2YXIgbiA9IHQuY29uc3RydWN0b3I7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBNbzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbW8odCk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFBvOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBTbzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG4oK3QpO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBCbzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYm8odCwgaSk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHpvOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBMbzpcclxuICAgICAgICAgICAgICAgIGNhc2UgRm86XHJcbiAgICAgICAgICAgICAgICBjYXNlIERvOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBqbzpcclxuICAgICAgICAgICAgICAgIGNhc2UgSG86XHJcbiAgICAgICAgICAgICAgICBjYXNlIFdvOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBxbzpcclxuICAgICAgICAgICAgICAgIGNhc2UgVW86XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRvKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBFbzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG47XHJcbiAgICAgICAgICAgICAgICBjYXNlIFJvOlxyXG4gICAgICAgICAgICAgICAgY2FzZSBWbzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IG4odCk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIE9vOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfbyh0KTtcclxuICAgICAgICAgICAgICAgIGNhc2UgSW86XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBuO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBObzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ28odClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEdvID0gJG87XHJcbiAgICAgICAgdmFyIEtvID0gT2JqZWN0LmNyZWF0ZTtcclxuICAgICAgICB2YXIgSm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHQoKSB7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjdChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7fVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKEtvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEtvKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0LnByb3RvdHlwZSA9IGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IG5ldyB0O1xyXG4gICAgICAgICAgICAgICAgdC5wcm90b3R5cGUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSgpO1xyXG4gICAgICAgIHZhciBZbyA9IEpvO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBRbyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdC5jb25zdHJ1Y3RvciA9PSBcImZ1bmN0aW9uXCIgJiYgIVdpKHQpID8gWW8oQyh0KSkgOiB7fVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFhvID0gUW87XHJcbiAgICAgICAgdmFyIFpvID0gXCJbb2JqZWN0IE1hcF1cIjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdHIodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVCh0KSAmJiBzbyh0KSA9PSBab1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGVyID0gdHI7XHJcbiAgICAgICAgdmFyIGlyID0gVmlbXCJhXCJdICYmIFZpW1wiYVwiXS5pc01hcDtcclxuICAgICAgICB2YXIgbnIgPSBpciA/IElpKGlyKSA6IGVyO1xyXG4gICAgICAgIHZhciBvciA9IG5yO1xyXG4gICAgICAgIHZhciByciA9IFwiW29iamVjdCBTZXRdXCI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNyKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFQodCkgJiYgc28odCkgPT0gcnJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhciA9IHNyO1xyXG4gICAgICAgIHZhciBjciA9IFZpW1wiYVwiXSAmJiBWaVtcImFcIl0uaXNTZXQ7XHJcbiAgICAgICAgdmFyIGxyID0gY3IgPyBJaShjcikgOiBhcjtcclxuICAgICAgICB2YXIgZHIgPSBscjtcclxuICAgICAgICB2YXIgdXIgPSAxLCBociA9IDIsIGZyID0gNDtcclxuICAgICAgICB2YXIgZ3IgPSBcIltvYmplY3QgQXJndW1lbnRzXVwiLCBtciA9IFwiW29iamVjdCBBcnJheV1cIiwgcHIgPSBcIltvYmplY3QgQm9vbGVhbl1cIiwgYnIgPSBcIltvYmplY3QgRGF0ZV1cIixcclxuICAgICAgICAgICAgd3IgPSBcIltvYmplY3QgRXJyb3JdXCIsIGtyID0gXCJbb2JqZWN0IEZ1bmN0aW9uXVwiLCBfciA9IFwiW29iamVjdCBHZW5lcmF0b3JGdW5jdGlvbl1cIiwgdnIgPSBcIltvYmplY3QgTWFwXVwiLFxyXG4gICAgICAgICAgICB5ciA9IFwiW29iamVjdCBOdW1iZXJdXCIsIHhyID0gXCJbb2JqZWN0IE9iamVjdF1cIiwgQ3IgPSBcIltvYmplY3QgUmVnRXhwXVwiLCBBciA9IFwiW29iamVjdCBTZXRdXCIsXHJcbiAgICAgICAgICAgIFRyID0gXCJbb2JqZWN0IFN0cmluZ11cIiwgUHIgPSBcIltvYmplY3QgU3ltYm9sXVwiLCBTciA9IFwiW29iamVjdCBXZWFrTWFwXVwiO1xyXG4gICAgICAgIHZhciBFciA9IFwiW29iamVjdCBBcnJheUJ1ZmZlcl1cIiwgUnIgPSBcIltvYmplY3QgRGF0YVZpZXddXCIsIE9yID0gXCJbb2JqZWN0IEZsb2F0MzJBcnJheV1cIixcclxuICAgICAgICAgICAgSXIgPSBcIltvYmplY3QgRmxvYXQ2NEFycmF5XVwiLCBWciA9IFwiW29iamVjdCBJbnQ4QXJyYXldXCIsIE5yID0gXCJbb2JqZWN0IEludDE2QXJyYXldXCIsXHJcbiAgICAgICAgICAgIE1yID0gXCJbb2JqZWN0IEludDMyQXJyYXldXCIsIEJyID0gXCJbb2JqZWN0IFVpbnQ4QXJyYXldXCIsIHpyID0gXCJbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XVwiLFxyXG4gICAgICAgICAgICBMciA9IFwiW29iamVjdCBVaW50MTZBcnJheV1cIiwgRnIgPSBcIltvYmplY3QgVWludDMyQXJyYXldXCI7XHJcbiAgICAgICAgdmFyIERyID0ge307XHJcbiAgICAgICAgRHJbZ3JdID0gRHJbbXJdID0gRHJbRXJdID0gRHJbUnJdID0gRHJbcHJdID0gRHJbYnJdID0gRHJbT3JdID0gRHJbSXJdID0gRHJbVnJdID0gRHJbTnJdID0gRHJbTXJdID0gRHJbdnJdID0gRHJbeXJdID0gRHJbeHJdID0gRHJbQ3JdID0gRHJbQXJdID0gRHJbVHJdID0gRHJbUHJdID0gRHJbQnJdID0gRHJbenJdID0gRHJbTHJdID0gRHJbRnJdID0gdHJ1ZTtcclxuICAgICAgICBEclt3cl0gPSBEcltrcl0gPSBEcltTcl0gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24ganIodCwgZSwgaSwgbiwgbywgcikge1xyXG4gICAgICAgICAgICB2YXIgcywgYSA9IGUgJiB1ciwgYyA9IGUgJiBociwgbCA9IGUgJiBmcjtcclxuICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgIHMgPSBvID8gaSh0LCBuLCBvLCByKSA6IGkodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghY3QodCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGQgPSBKZSh0KTtcclxuICAgICAgICAgICAgaWYgKGQpIHtcclxuICAgICAgICAgICAgICAgIHMgPSB1byh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBtbih0LCBzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIHUgPSBzbyh0KSwgaCA9IHUgPT0ga3IgfHwgdSA9PSBfcjtcclxuICAgICAgICAgICAgICAgIGlmIChPYmplY3QoWWVbXCJhXCJdKSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QoZm5bXCJhXCJdKSh0LCBhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHUgPT0geHIgfHwgdSA9PSBnciB8fCBoICYmICFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcyA9IGMgfHwgaCA/IHt9IDogWG8odCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjID8gVm4odCwgaG4ocywgdCkpIDogVG4odCwgZW4ocywgdCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIURyW3VdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvID8gdCA6IHt9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHMgPSBHbyh0LCB1LCBhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHIgfHwgKHIgPSBuZXcgQWUpO1xyXG4gICAgICAgICAgICB2YXIgZiA9IHIuZ2V0KHQpO1xyXG4gICAgICAgICAgICBpZiAoZikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByLnNldCh0LCBzKTtcclxuICAgICAgICAgICAgaWYgKGRyKHQpKSB7XHJcbiAgICAgICAgICAgICAgICB0LmZvckVhY2goKGZ1bmN0aW9uIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5hZGQoanIobiwgZSwgaSwgbiwgdCwgcikpXHJcbiAgICAgICAgICAgICAgICB9KSlcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChvcih0KSkge1xyXG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKChmdW5jdGlvbiAobiwgbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHMuc2V0KG8sIGpyKG4sIGUsIGksIG8sIHQsIHIpKVxyXG4gICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGcgPSBsID8gYyA/IEZuIDogem4gOiBjID8ga2V5c0luIDogWmk7XHJcbiAgICAgICAgICAgIHZhciBtID0gZCA/IHVuZGVmaW5lZCA6IGcodCk7XHJcbiAgICAgICAgICAgIFBlKG0gfHwgdCwgKGZ1bmN0aW9uIChuLCBvKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSBuO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0W29dXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBNZShzLCBvLCBqcihuLCBlLCBpLCBvLCB0LCByKSlcclxuICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICByZXR1cm4gc1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEhyID0ganI7XHJcbiAgICAgICAgdmFyIFdyID0gMSwgcXIgPSA0O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBVcih0LCBlKSB7XHJcbiAgICAgICAgICAgIGUgPSB0eXBlb2YgZSA9PSBcImZ1bmN0aW9uXCIgPyBlIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICByZXR1cm4gSHIodCwgV3IgfCBxciwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciAkciA9IFVyO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBHcih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUKHQpICYmIHQubm9kZVR5cGUgPT09IDEgJiYgIU4odClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBLciA9IEdyO1xyXG5cclxuICAgICAgICBjbGFzcyBKciB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbmZpZyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmluZShZcihlKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0T2JqZWN0VG9UYXJnZXQodGhpcy5fY29uZmlnLCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0VG9UYXJnZXQodGhpcy5fY29uZmlnLCB0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZWZpbmUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRUb1RhcmdldCh0aGlzLl9jb25maWcsIHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0RnJvbVNvdXJjZSh0aGlzLl9jb25maWcsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogbmFtZXMoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgT2JqZWN0LmtleXModGhpcy5fY29uZmlnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldFRvVGFyZ2V0KHQsIGUsIGksIG4gPSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKE4oZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRPYmplY3RUb1RhcmdldCh0LCBlLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLnNwbGl0KFwiLlwiKTtcclxuICAgICAgICAgICAgICAgIGUgPSBvLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIU4odFtlXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdFtlXSA9IHt9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0W2VdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoTihpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghTih0W2VdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0W2VdID0ge31cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHRbZV07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0T2JqZWN0VG9UYXJnZXQodCwgaSwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobiAmJiB0eXBlb2YgdFtlXSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0W2VdID0gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0RnJvbVNvdXJjZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5zcGxpdChcIi5cIik7XHJcbiAgICAgICAgICAgICAgICBlID0gaS5wb3AoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFOKHRbZV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ID0gdFtlXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPyBZcih0W2VdKSA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0T2JqZWN0VG9UYXJnZXQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZSkuZm9yRWFjaChuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRUb1RhcmdldCh0LCBuLCBlW25dLCBpKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWXIodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHIodCwgUXIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBRcih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLcih0KSA/IHQgOiB1bmRlZmluZWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFhyKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gdCgpIHtcclxuICAgICAgICAgICAgICAgIHQuY2FsbGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgWnIgPSBYcjtcclxuXHJcbiAgICAgICAgY2xhc3MgdHMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXRoID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3AgPSBacigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vZmYgPSBacigpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGVzID0gbmV3IEFycmF5KDI1NikuZmlsbCgpLm1hcCgodCwgZSkgPT4gKFwiMFwiICsgZS50b1N0cmluZygxNikpLnNsaWNlKC0yKSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlzKCkge1xyXG4gICAgICAgICAgICBjb25zdCB0ID0gTWF0aC5yYW5kb20oKSAqIDQyOTQ5NjcyOTYgPj4+IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBNYXRoLnJhbmRvbSgpICogNDI5NDk2NzI5NiA+Pj4gMDtcclxuICAgICAgICAgICAgY29uc3QgaSA9IE1hdGgucmFuZG9tKCkgKiA0Mjk0OTY3Mjk2ID4+PiAwO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gTWF0aC5yYW5kb20oKSAqIDQyOTQ5NjcyOTYgPj4+IDA7XHJcbiAgICAgICAgICAgIHJldHVybiBcImVcIiArIGVzW3QgPj4gMCAmIDI1NV0gKyBlc1t0ID4+IDggJiAyNTVdICsgZXNbdCA+PiAxNiAmIDI1NV0gKyBlc1t0ID4+IDI0ICYgMjU1XSArIGVzW2UgPj4gMCAmIDI1NV0gKyBlc1tlID4+IDggJiAyNTVdICsgZXNbZSA+PiAxNiAmIDI1NV0gKyBlc1tlID4+IDI0ICYgMjU1XSArIGVzW2kgPj4gMCAmIDI1NV0gKyBlc1tpID4+IDggJiAyNTVdICsgZXNbaSA+PiAxNiAmIDI1NV0gKyBlc1tpID4+IDI0ICYgMjU1XSArIGVzW24gPj4gMCAmIDI1NV0gKyBlc1tuID4+IDggJiAyNTVdICsgZXNbbiA+PiAxNiAmIDI1NV0gKyBlc1tuID4+IDI0ICYgMjU1XVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbnMgPSB7XHJcbiAgICAgICAgICAgIGdldCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgIT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3RdIHx8IHRoaXMubm9ybWFsXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGhpZ2hlc3Q6IDFlNSwgaGlnaDogMWUzLCBub3JtYWw6IDAsIGxvdzogLTFlMywgbG93ZXN0OiAtMWU1XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgb3MgPSBucztcclxuICAgICAgICB2YXIgcnMgPSBpKDYpO1xyXG4gICAgICAgIHZhciBzcyA9IGkoMCk7XHJcbiAgICAgICAgY29uc3QgYXMgPSBTeW1ib2woXCJsaXN0ZW5pbmdUb1wiKTtcclxuICAgICAgICBjb25zdCBjcyA9IFN5bWJvbChcImVtaXR0ZXJJZFwiKTtcclxuICAgICAgICBjb25zdCBscyA9IHtcclxuICAgICAgICAgICAgb24odCwgZSwgaSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMsIHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH0sIG9uY2UodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBmdW5jdGlvbiAodCwgLi4uaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5vZmYoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5jYWxsKHRoaXMsIHQsIC4uLmkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcywgdCwgbywgaSlcclxuICAgICAgICAgICAgfSwgb2ZmKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCB0LCBlKVxyXG4gICAgICAgICAgICB9LCBsaXN0ZW5Ubyh0LCBlLCBpLCBuID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGxldCBvLCByO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzW2FzXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNbYXNdID0ge31cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzW2FzXTtcclxuICAgICAgICAgICAgICAgIGlmICghZnModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBocyh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IGZzKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEobyA9IHNbYV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbyA9IHNbYV0gPSB7ZW1pdHRlcjogdCwgY2FsbGJhY2tzOiB7fX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghKHIgPSBvLmNhbGxiYWNrc1tlXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gby5jYWxsYmFja3NbZV0gPSBbXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgci5wdXNoKGkpO1xyXG4gICAgICAgICAgICAgICAgcHModCwgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gYnModCwgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gb3MuZ2V0KG4ucHJpb3JpdHkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZCA9IHtjYWxsYmFjazogaSwgcHJpb3JpdHk6IGx9O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodFtpXS5wcmlvcml0eSA8IGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3BsaWNlKGksIDAsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnB1c2goZClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHN0b3BMaXN0ZW5pbmcodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXNbYXNdO1xyXG4gICAgICAgICAgICAgICAgbGV0IG8gPSB0ICYmIGZzKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4gJiYgbyAmJiBuW29dO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHIgJiYgZSAmJiByLmNhbGxiYWNrc1tlXTtcclxuICAgICAgICAgICAgICAgIGlmICghbiB8fCB0ICYmICFyIHx8IGUgJiYgIXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3ModCwgZSwgaSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChpID0gcy5wb3AoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfcyh0LCBlLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgci5jYWxsYmFja3NbZV1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoZSBpbiByLmNhbGxiYWNrcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodCwgZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIG5bb11cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChvIGluIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKG5bb10uZW1pdHRlcilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbYXNdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGZpcmUodCwgLi4uZSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdCBpbnN0YW5jZW9mIHRzID8gdCA6IG5ldyB0cyh0aGlzLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvID0gd3ModGhpcywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5wYXRoLnB1c2godGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IFtpLCAuLi5lXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IEFycmF5LmZyb20obyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgby5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb1tlXS5jYWxsYmFjay5hcHBseSh0aGlzLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLm9mZi5jYWxsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgaS5vZmYuY2FsbGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zKHRoaXMsIG4sIG9bZV0uY2FsbGJhY2spXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaS5zdG9wLmNhbGxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2RlbGVnYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9kZWxlZ2F0aW9ucy5nZXQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLl9kZWxlZ2F0aW9ucy5nZXQoXCIqXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga3ModCwgaSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga3MobywgaSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaS5yZXR1cm5cclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzc1tcImJcIl0ucmV0aHJvd1VuZXhwZWN0ZWRFcnJvcih0LCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBkZWxlZ2F0ZSguLi50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvOiAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2RlbGVnYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWxlZ2F0aW9ucyA9IG5ldyBNYXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmZvckVhY2godCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fZGVsZWdhdGlvbnMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVsZWdhdGlvbnMuc2V0KHQsIG5ldyBNYXAoW1tlLCBpXV0pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldChlLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgc3RvcERlbGVnYXRpbmcodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kZWxlZ2F0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVsZWdhdGlvbnMuY2xlYXIoKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbGVnYXRpb25zLmRlbGV0ZSh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fZGVsZWdhdGlvbnMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuZGVsZXRlKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZHMgPSBscztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXModCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodFthc10gJiYgdFthc11bZV0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0W2FzXVtlXS5lbWl0dGVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhzKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKCF0W2NzXSkge1xyXG4gICAgICAgICAgICAgICAgdFtjc10gPSBlIHx8IGlzKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZnModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdFtjc11cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdzKHQpIHtcclxuICAgICAgICAgICAgaWYgKCF0Ll9ldmVudHMpIHtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LCBcIl9ldmVudHNcIiwge3ZhbHVlOiB7fX0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHQuX2V2ZW50c1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7Y2FsbGJhY2tzOiBbXSwgY2hpbGRFdmVudHM6IFtdfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcHModCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZ3ModCk7XHJcbiAgICAgICAgICAgIGlmIChpW2VdKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgbiA9IGU7XHJcbiAgICAgICAgICAgIGxldCBvID0gbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgciA9IFtdO1xyXG4gICAgICAgICAgICB3aGlsZSAobiAhPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlbbl0pIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaVtuXSA9IG1zKCk7XHJcbiAgICAgICAgICAgICAgICByLnB1c2goaVtuXSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlbbl0uY2hpbGRFdmVudHMucHVzaChvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbyA9IG47XHJcbiAgICAgICAgICAgICAgICBuID0gbi5zdWJzdHIoMCwgbi5sYXN0SW5kZXhPZihcIjpcIikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG4gIT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5jYWxsYmFja3MgPSBpW25dLmNhbGxiYWNrcy5zbGljZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpW25dLmNoaWxkRXZlbnRzLnB1c2gobylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYnModCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZ3ModClbZV07XHJcbiAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IG4gPSBbaS5jYWxsYmFja3NdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IGkuY2hpbGRFdmVudHMubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBicyh0LCBpLmNoaWxkRXZlbnRzW2VdKTtcclxuICAgICAgICAgICAgICAgIG4gPSBuLmNvbmNhdChvKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB3cyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGxldCBpO1xyXG4gICAgICAgICAgICBpZiAoIXQuX2V2ZW50cyB8fCAhKGkgPSB0Ll9ldmVudHNbZV0pIHx8ICFpLmNhbGxiYWNrcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlLmluZGV4T2YoXCI6XCIpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gd3ModCwgZS5zdWJzdHIoMCwgZS5sYXN0SW5kZXhPZihcIjpcIikpKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpLmNhbGxiYWNrc1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24ga3ModCwgZSwgaSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBbbiwgb10gb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbyA9IGUubmFtZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbyA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvID0gbyhlLm5hbWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IHRzKGUuc291cmNlLCBvKTtcclxuICAgICAgICAgICAgICAgIHQucGF0aCA9IFsuLi5lLnBhdGhdO1xyXG4gICAgICAgICAgICAgICAgbi5maXJlKHQsIC4uLmkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9zKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGJzKHQsIGUpO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0Lmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbZV0uY2FsbGJhY2sgPT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNwbGljZShlLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS0tXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB2cyh0LCAuLi5lKSB7XHJcbiAgICAgICAgICAgIGUuZm9yRWFjaChlID0+IHtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGUpLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpKS5mb3JFYWNoKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpIGluIHQucHJvdG90eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICBuLmVudW1lcmFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodC5wcm90b3R5cGUsIGksIG4pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgeXMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2l0ZW1zID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtTWFwID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2lkUHJvcGVydHkgPSB0LmlkUHJvcGVydHkgfHwgXCJpZFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmluZFRvRXh0ZXJuYWxUb0ludGVybmFsTWFwID0gbmV3IFdlYWtNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iaW5kVG9JbnRlcm5hbFRvRXh0ZXJuYWxNYXAgPSBuZXcgV2Vha01hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NraXBwZWRJbmRleGVzRnJvbUV4dGVybmFsID0gW11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGxlbmd0aCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtcy5sZW5ndGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGZpcnN0KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1zWzBdIHx8IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGxhc3QoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbXNbdGhpcy5sZW5ndGggLSAxXSB8fCBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9pZFByb3BlcnR5O1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gaW4gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0W25dO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaSAhPSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb2xsZWN0aW9uLWFkZC1pbnZhbGlkLWlkXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiY29sbGVjdGlvbi1hZGQtaXRlbS1hbHJlYWR5LWV4aXN0c1wiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdFtuXSA9IGkgPSBpcygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2l0ZW1zLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlID4gdGhpcy5faXRlbXMubGVuZ3RoIHx8IGUgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbGxlY3Rpb24tYWRkLWl0ZW0taW52YWxpZC1pbmRleFwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbXMuc3BsaWNlKGUsIDAsIHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXRlbU1hcC5zZXQoaSwgdCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJhZGRcIiwgdCwgZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQodCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGU7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLl9pdGVtTWFwLmdldCh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdCA9PSBcIm51bWJlclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2l0ZW1zW3RdXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb2xsZWN0aW9uLWdldC1pbnZhbGlkLWFyZzogSW5kZXggb3IgaWQgbXVzdCBiZSBnaXZlbi5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlIHx8IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFzKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1NYXAuaGFzKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9pZFByb3BlcnR5O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0W2VdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtTWFwLmhhcyhpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRJbmRleCh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2l0ZW1NYXAuZ2V0KHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbXMuaW5kZXhPZihlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW1vdmUodCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUsIGksIG47XHJcbiAgICAgICAgICAgICAgICBsZXQgbyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuX2lkUHJvcGVydHk7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLl9pdGVtTWFwLmdldChpKTtcclxuICAgICAgICAgICAgICAgICAgICBvID0gIW47XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2l0ZW1zLmluZGV4T2YobilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0ID09IFwibnVtYmVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gdDtcclxuICAgICAgICAgICAgICAgICAgICBuID0gdGhpcy5faXRlbXNbZV07XHJcbiAgICAgICAgICAgICAgICAgICAgbyA9ICFuO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBuW3JdXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuID0gdDtcclxuICAgICAgICAgICAgICAgICAgICBpID0gbltyXTtcclxuICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5faXRlbXMuaW5kZXhPZihuKTtcclxuICAgICAgICAgICAgICAgICAgICBvID0gZSA9PSAtMSB8fCAhdGhpcy5faXRlbU1hcC5nZXQoaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbGxlY3Rpb24tcmVtb3ZlLTQwNDogSXRlbSBub3QgZm91bmQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtcy5zcGxpY2UoZSwgMSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtTWFwLmRlbGV0ZShpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLl9iaW5kVG9JbnRlcm5hbFRvRXh0ZXJuYWxNYXAuZ2V0KG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmluZFRvSW50ZXJuYWxUb0V4dGVybmFsTWFwLmRlbGV0ZShuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb0V4dGVybmFsVG9JbnRlcm5hbE1hcC5kZWxldGUocyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJyZW1vdmVcIiwgbiwgZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtYXAodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1zLm1hcCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmaW5kKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtcy5maW5kKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZpbHRlcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbXMuZmlsdGVyKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsZWFyKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JpbmRUb0NvbGxlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5fYmluZFRvQ29sbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmluZFRvQ29sbGVjdGlvbiA9IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKDApXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJpbmRUbyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYmluZFRvQ29sbGVjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb2xsZWN0aW9uLWJpbmQtdG8tcmViaW5kOiBUaGUgY29sbGVjdGlvbiBjYW5ub3QgYmUgYm91bmQgbW9yZSB0aGFuIG9uY2UuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iaW5kVG9Db2xsZWN0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXM6IHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRVcEJpbmRUb0JpbmRpbmcoZSA9PiBuZXcgdChlKSlcclxuICAgICAgICAgICAgICAgICAgICB9LCB1c2luZzogdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFVwQmluZFRvQmluZGluZyhlID0+IHQoZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRVcEJpbmRUb0JpbmRpbmcoZSA9PiBlW3RdKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0VXBCaW5kVG9CaW5kaW5nKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9iaW5kVG9Db2xsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IChpLCBuLCBvKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IGUuX2JpbmRUb0NvbGxlY3Rpb24gPT0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gZS5fYmluZFRvSW50ZXJuYWxUb0V4dGVybmFsTWFwLmdldChuKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAociAmJiBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb0V4dGVybmFsVG9JbnRlcm5hbE1hcC5zZXQobiwgcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb0ludGVybmFsVG9FeHRlcm5hbE1hcC5zZXQocywgbilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdChuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9za2lwcGVkSW5kZXhlc0Zyb21FeHRlcm5hbC5wdXNoKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHIgPSBvO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fc2tpcHBlZEluZGV4ZXNGcm9tRXh0ZXJuYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID4gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHItLVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlLl9za2lwcGVkSW5kZXhlc0Zyb21FeHRlcm5hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgPj0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIrK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb0V4dGVybmFsVG9JbnRlcm5hbE1hcC5zZXQobiwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb0ludGVybmFsVG9FeHRlcm5hbE1hcC5zZXQoaSwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkKGksIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUuX3NraXBwZWRJbmRleGVzRnJvbUV4dGVybmFsLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociA8PSBlLl9za2lwcGVkSW5kZXhlc0Zyb21FeHRlcm5hbFt0XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuX3NraXBwZWRJbmRleGVzRnJvbUV4dGVybmFsW3RdKytcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkobnVsbCwgdCwgZS5nZXRJbmRleCh0KSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oZSwgXCJhZGRcIiwgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwicmVtb3ZlXCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2JpbmRUb0V4dGVybmFsVG9JbnRlcm5hbE1hcC5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUobilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2tpcHBlZEluZGV4ZXNGcm9tRXh0ZXJuYWwgPSB0aGlzLl9za2lwcGVkSW5kZXhlc0Zyb21FeHRlcm5hbC5yZWR1Y2UoKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnB1c2goZSAtIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnB1c2goZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIFtdKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbXNbU3ltYm9sLml0ZXJhdG9yXSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKHlzLCBkcyk7XHJcblxyXG4gICAgICAgIGNsYXNzIHhzIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSA9IFtdLCBpID0gW10pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRleHQgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGx1Z2lucyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdmFpbGFibGVQbHVnaW5zID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQucGx1Z2luTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdmFpbGFibGVQbHVnaW5zLnNldCh0LnBsdWdpbk5hbWUsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29udGV4dFBsdWdpbnMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbdCwgZV0gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRleHRQbHVnaW5zLnNldCh0LCBlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0UGx1Z2lucy5zZXQoZSwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQucGx1Z2luTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdmFpbGFibGVQbHVnaW5zLnNldCh0LnBsdWdpbk5hbWUsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX3BsdWdpbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRbMF0gPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIHRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fcGx1Z2lucy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gXCJwbHVnaW5jb2xsZWN0aW9uLXBsdWdpbi1ub3QtbG9hZGVkOiBUaGUgcmVxdWVzdGVkIHBsdWdpbiBpcyBub3QgbG9hZGVkLlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpID0gdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0LnBsdWdpbk5hbWUgfHwgdC5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oZSwgdGhpcy5fY29udGV4dCwge3BsdWdpbjogaX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BsdWdpbnMuaGFzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQodCwgZSA9IFtdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9jb250ZXh0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZyh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBnKGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGYodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBcInBsdWdpbmNvbGxlY3Rpb24tcGx1Z2luLW5vdC1mb3VuZDogU29tZSBwbHVnaW5zIGFyZSBub3QgYXZhaWxhYmxlIGFuZCBjb3VsZCBub3QgYmUgbG9hZGVkLlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoT2JqZWN0KHNzW1wiYVwiXSkodCksIHtwbHVnaW5zOiBjfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBzc1tcImJcIl0odCwgbiwge3BsdWdpbnM6IGN9KSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChzLm1hcChsKSkudGhlbigoKSA9PiBkKHIsIFwiaW5pdFwiKSkudGhlbigoKSA9PiBkKHIsIFwiYWZ0ZXJJbml0XCIpKS50aGVuKCgpID0+IHIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGwodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmluY2x1ZGVzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaS5fcGx1Z2lucy5oYXModCkgfHwgby5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1KHQpLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKE9iamVjdChzc1tcImFcIl0pKFwicGx1Z2luY29sbGVjdGlvbi1sb2FkOiBJdCB3YXMgbm90IHBvc3NpYmxlIHRvIGxvYWQgdGhlIHBsdWdpbi5cIiksIHtwbHVnaW46IHR9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQucmVkdWNlKCh0LCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbltlXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaS5fY29udGV4dFBsdWdpbnMuaGFzKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnRoZW4obltlXS5iaW5kKG4pKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIFByb21pc2UucmVzb2x2ZSgpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHUodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJlcXVpcmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlcXVpcmVzLmZvckVhY2goaSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGgoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXNDb250ZXh0UGx1Z2luICYmICFvLmlzQ29udGV4dFBsdWdpbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwicGx1Z2luY29sbGVjdGlvbi1jb250ZXh0LXJlcXVpcmVkOiBDb250ZXh0IHBsdWdpbiBjYW4gbm90IHJlcXVpcmUgcGx1Z2luIHdoaWNoIGlzIG5vdCBhIGNvbnRleHQgcGx1Z2luXCIsIG51bGwsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbjogby5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWRCeTogdC5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmluY2x1ZGVzKG8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJwbHVnaW5jb2xsZWN0aW9uLXJlcXVpcmVkOiBDYW5ub3QgbG9hZCBhIHBsdWdpbiBiZWNhdXNlIG9uZSBvZiBpdHMgZGVwZW5kZW5jaWVzIGlzIGxpc3RlZCBpblwiICsgXCJ0aGUgYHJlbW92ZVBsdWdpbnNgIG9wdGlvbi5cIiwgbiwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luOiBvLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZEJ5OiB0Lm5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbChvKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gaS5fY29udGV4dFBsdWdpbnMuZ2V0KHQpIHx8IG5ldyB0KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLl9hZGQodCwgYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIucHVzaChhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBoKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpLl9hdmFpbGFibGVQbHVnaW5zLmdldCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGYodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWgoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaChpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmxlbmd0aCA/IGUgOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZyh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQubWFwKHQgPT4gaCh0KSkuZmlsdGVyKHQgPT4gISF0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbLCBlXSBvZiB0aGlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlLmRlc3Ryb3kgPT0gXCJmdW5jdGlvblwiICYmICF0aGlzLl9jb250ZXh0UGx1Z2lucy5oYXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5wdXNoKGUuZGVzdHJveSgpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYWRkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BsdWdpbnMuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGx1Z2luTmFtZTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3BsdWdpbnMuaGFzKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInBsdWdpbmNvbGxlY3Rpb24tcGx1Z2luLW5hbWUtY29uZmxpY3Q6IFR3byBwbHVnaW5zIHdpdGggdGhlIHNhbWUgbmFtZSB3ZXJlIGxvYWRlZC5cIiwgbnVsbCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5OYW1lOiBpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4xOiB0aGlzLl9wbHVnaW5zLmdldChpKS5jb25zdHJ1Y3RvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luMjogdFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wbHVnaW5zLnNldChpLCBlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyh4cywgZHMpO1xyXG4gICAgICAgIGlmICghd2luZG93LkNLRURJVE9SX1RSQU5TTEFUSU9OUykge1xyXG4gICAgICAgICAgICB3aW5kb3cuQ0tFRElUT1JfVFJBTlNMQVRJT05TID0ge31cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIENzKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlNbdF0gfHwgKHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlNbdF0gPSB7fSk7XHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oaSwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEFzKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFNzKCk7XHJcbiAgICAgICAgICAgIGlmIChpID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gT2JqZWN0LmtleXMod2luZG93LkNLRURJVE9SX1RSQU5TTEFUSU9OUylbMF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaSA9PT0gMCB8fCAhUHModCwgZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLnJlcGxhY2UoLyBcXFtjb250ZXh0OiBbXlxcXV0rXFxdJC8sIFwiXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9IHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlNbdF07XHJcbiAgICAgICAgICAgIHJldHVybiBuW2VdLnJlcGxhY2UoLyBcXFtjb250ZXh0OiBbXlxcXV0rXFxdJC8sIFwiXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBUcygpIHtcclxuICAgICAgICAgICAgd2luZG93LkNLRURJVE9SX1RSQU5TTEFUSU9OUyA9IHt9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBQcyh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0IGluIHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlMgJiYgZSBpbiB3aW5kb3cuQ0tFRElUT1JfVFJBTlNMQVRJT05TW3RdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBTcygpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHdpbmRvdy5DS0VESVRPUl9UUkFOU0xBVElPTlMpLmxlbmd0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgRXMgPSBbXCJhclwiLCBcImZhXCIsIFwiaGVcIiwgXCJrdVwiLCBcInVnXCJdO1xyXG5cclxuICAgICAgICBjbGFzcyBScyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51aUxhbmd1YWdlID0gdC51aUxhbmd1YWdlIHx8IFwiZW5cIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudExhbmd1YWdlID0gdC5jb250ZW50TGFuZ3VhZ2UgfHwgdGhpcy51aUxhbmd1YWdlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51aUxhbmd1YWdlRGlyZWN0aW9uID0gT3ModGhpcy51aUxhbmd1YWdlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudExhbmd1YWdlRGlyZWN0aW9uID0gT3ModGhpcy5jb250ZW50TGFuZ3VhZ2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ID0gKC4uLnQpID0+IHRoaXMuX3QoLi4udClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGxhbmd1YWdlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwibG9jYWxlLWRlcHJlY2F0ZWQtbGFuZ3VhZ2UtcHJvcGVydHk6IFwiICsgXCJUaGUgTG9jYWxlI2xhbmd1YWdlIHByb3BlcnR5IGhhcyBiZWVuIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgbmVhciBmdXR1cmUuIFwiICsgXCJQbGVhc2UgdXNlICN1aUxhbmd1YWdlIGFuZCAjY29udGVudExhbmd1YWdlIHByb3BlcnRpZXMgaW5zdGVhZC5cIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy51aUxhbmd1YWdlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF90KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGxldCBpID0gQXModGhpcy51aUxhbmd1YWdlLCB0KTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IGkucmVwbGFjZSgvJShcXGQrKS9nLCAodCwgaSkgPT4gaSA8IGUubGVuZ3RoID8gZVtpXSA6IHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBPcyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBFcy5pbmNsdWRlcyh0KSA/IFwicnRsXCIgOiBcImx0clwiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBJcyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnID0gbmV3IEpyKHQsIHRoaXMuY29uc3RydWN0b3IuZGVmYXVsdENvbmZpZyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5jb25zdHJ1Y3Rvci5idWlsdGluUGx1Z2lucztcclxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmRlZmluZShcInBsdWdpbnNcIiwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbnMgPSBuZXcgeHModGhpcywgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5jb25maWcuZ2V0KFwibGFuZ3VhZ2VcIikgfHwge307XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2FsZSA9IG5ldyBScyh7XHJcbiAgICAgICAgICAgICAgICAgICAgdWlMYW5ndWFnZTogdHlwZW9mIGkgPT09IFwic3RyaW5nXCIgPyBpIDogaS51aSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50TGFuZ3VhZ2U6IHRoaXMuY29uZmlnLmdldChcImxhbmd1YWdlLmNvbnRlbnRcIilcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ID0gdGhpcy5sb2NhbGUudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9ycyA9IG5ldyB5cztcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRleHRPd25lciA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdFBsdWdpbnMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5jb25maWcuZ2V0KFwicGx1Z2luc1wiKSB8fCBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlICE9IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiY29udGV4dC1pbml0cGx1Z2lucy1jb25zdHJ1Y3Rvci1vbmx5OiBPbmx5IGEgY29uc3RydWN0b3IgZnVuY3Rpb24gaXMgYWxsb3dlZCBhcyBhIGNvbnRleHQgcGx1Z2luLlwiLCBudWxsLCB7UGx1Z2luOiBlfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaXNDb250ZXh0UGx1Z2luICE9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb250ZXh0LWluaXRwbHVnaW5zLWludmFsaWQtcGx1Z2luOiBPbmx5IGEgcGx1Z2luIG1hcmtlZCBhcyBhIGNvbnRleHQgcGx1Z2luIGlzIGFsbG93ZWQgdG8gYmUgdXNlZCB3aXRoIGEgY29udGV4dC5cIiwgbnVsbCwge1BsdWdpbjogZX0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGx1Z2lucy5pbml0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoQXJyYXkuZnJvbSh0aGlzLmVkaXRvcnMsIHQgPT4gdC5kZXN0cm95KCkpKS50aGVuKCgpID0+IHRoaXMucGx1Z2lucy5kZXN0cm95KCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hZGRFZGl0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRleHRPd25lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb250ZXh0LWFkZEVkaXRvci1wcml2YXRlLWNvbnRleHQ6IENhbm5vdCBhZGQgbXVsdGlwbGUgZWRpdG9ycyB0byB0aGUgY29udGV4dCB3aGljaCBpcyBjcmVhdGVkIGJ5IHRoZSBlZGl0b3IuXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvcnMuYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0T3duZXIgPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVFZGl0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdG9ycy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvcnMucmVtb3ZlKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY29udGV4dE93bmVyID09PSB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGVzdHJveSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldEVkaXRvckNvbmZpZygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB7fTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLmNvbmZpZy5uYW1lcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFbXCJwbHVnaW5zXCIsIFwicmVtb3ZlUGx1Z2luc1wiLCBcImV4dHJhUGx1Z2luc1wiXS5pbmNsdWRlcyhlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0W2VdID0gdGhpcy5jb25maWcuZ2V0KGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGNyZWF0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyB0aGlzKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUoaS5pbml0UGx1Z2lucygpLnRoZW4oKCkgPT4gaSkpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBWcyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBNYXRoLm1pbih0Lmxlbmd0aCwgZS5sZW5ndGgpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IGk7IG4rKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRbbl0gIT0gZVtuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQubGVuZ3RoID09IGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJzYW1lXCJcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0Lmxlbmd0aCA8IGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJwcmVmaXhcIlxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZXh0ZW5zaW9uXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIE5zID0gNDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTXModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gSHIodCwgTnMpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgQnMgPSBNcztcclxuXHJcbiAgICAgICAgY2xhc3MgenMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50ID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50ID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaW5kZXgoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdDtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCh0ID0gdGhpcy5wYXJlbnQuZ2V0Q2hpbGRJbmRleCh0aGlzKSkgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy1ub2RlLW5vdC1mb3VuZC1pbi1wYXJlbnQ6IFRoZSBub2RlJ3MgcGFyZW50IGRvZXMgbm90IGNvbnRhaW4gdGhpcyBub2RlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IG5leHRTaWJsaW5nKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCAhPT0gbnVsbCAmJiB0aGlzLnBhcmVudC5nZXRDaGlsZCh0ICsgMSkgfHwgbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcHJldmlvdXNTaWJsaW5nKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCAhPT0gbnVsbCAmJiB0aGlzLnBhcmVudC5nZXRDaGlsZCh0IC0gMSkgfHwgbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcm9vdCgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0LnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0LnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNBdHRhY2hlZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvb3QuaXMoXCJyb290RWxlbWVudFwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRQYXRoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC51bnNoaWZ0KGUuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBlLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0QW5jZXN0b3JzKHQgPSB7aW5jbHVkZVNlbGY6IGZhbHNlLCBwYXJlbnRGaXJzdDogZmFsc2V9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHQuaW5jbHVkZVNlbGYgPyB0aGlzIDogdGhpcy5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVbdC5wYXJlbnRGaXJzdCA/IFwicHVzaFwiIDogXCJ1bnNoaWZ0XCJdKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBpLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q29tbW9uQW5jZXN0b3IodCwgZSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRBbmNlc3RvcnMoZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5nZXRBbmNlc3RvcnMoZSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgbyA9IDA7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaVtvXSA9PSBuW29dICYmIGlbb10pIHtcclxuICAgICAgICAgICAgICAgICAgICBvKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBvID09PSAwID8gbnVsbCA6IGlbbyAtIDFdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzQmVmb3JlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzID09IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvb3QgIT09IHQucm9vdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0UGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0UGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFZzKGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicHJlZml4XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcImV4dGVuc2lvblwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVbbl0gPCBpW25dXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzQWZ0ZXIodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMgPT0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdCAhPT0gdC5yb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIXRoaXMuaXNCZWZvcmUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Ll9yZW1vdmVDaGlsZHJlbih0aGlzLmluZGV4KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZmlyZUNoYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6XCIgKyB0LCBlKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Ll9maXJlQ2hhbmdlKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBCcyh0aGlzKTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwibm9kZVwiIHx8IHQgPT0gXCJ2aWV3Om5vZGVcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyh6cywgZHMpO1xyXG5cclxuICAgICAgICBjbGFzcyBMcyBleHRlbmRzIHpzIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXh0RGF0YSA9IGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJ0ZXh0XCIgfHwgdCA9PSBcInZpZXc6dGV4dFwiIHx8IHN1cGVyLmlzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBkYXRhKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RleHREYXRhXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfZGF0YSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0IF9kYXRhKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoXCJ0ZXh0XCIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGV4dERhdGEgPSB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzU2ltaWxhcih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgTHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcyA9PT0gdCB8fCB0aGlzLmRhdGEgPT09IHQuZGF0YVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExzKHRoaXMuZG9jdW1lbnQsIHRoaXMuZGF0YSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgRnMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRleHROb2RlID0gdDtcclxuICAgICAgICAgICAgICAgIGlmIChlIDwgMCB8fCBlID4gdC5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXRleHRwcm94eS13cm9uZy1vZmZzZXRpbnRleHQ6IEdpdmVuIG9mZnNldEluVGV4dCB2YWx1ZSBpcyBpbmNvcnJlY3QuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDAgfHwgZSArIGkgPiB0LmRhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInZpZXctdGV4dHByb3h5LXdyb25nLWxlbmd0aDogR2l2ZW4gbGVuZ3RoIHZhbHVlIGlzIGluY29ycmVjdC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IHQuZGF0YS5zdWJzdHJpbmcoZSwgZSArIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vZmZzZXRJblRleHQgPSBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBvZmZzZXRTaXplKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5sZW5ndGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzUGFydGlhbCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEubGVuZ3RoICE9PSB0aGlzLnRleHROb2RlLmRhdGEubGVuZ3RoXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBwYXJlbnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Tm9kZS5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHJvb3QoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Tm9kZS5yb290XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBkb2N1bWVudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHROb2RlLmRvY3VtZW50XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwidGV4dFByb3h5XCIgfHwgdCA9PSBcInZpZXc6dGV4dFByb3h5XCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0QW5jZXN0b3JzKHQgPSB7aW5jbHVkZVNlbGY6IGZhbHNlLCBwYXJlbnRGaXJzdDogZmFsc2V9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHQuaW5jbHVkZVNlbGYgPyB0aGlzLnRleHROb2RlIDogdGhpcy5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVbdC5wYXJlbnRGaXJzdCA/IFwicHVzaFwiIDogXCJ1bnNoaWZ0XCJdKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBpLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRHModCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIGluIHQpIHtcclxuICAgICAgICAgICAgICAgIGUuc2V0KGksIHRbaV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGpzKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhKHQgJiYgdFtTeW1ib2wuaXRlcmF0b3JdKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSHModCkge1xyXG4gICAgICAgICAgICBpZiAoanModCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTWFwKHQpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRHModClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgV3Mge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvciguLi50KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXR0ZXJucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGQoLi4udClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWRkKC4uLnQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGUgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZSA9PSBcInN0cmluZ1wiIHx8IGUgaW5zdGFuY2VvZiBSZWdFeHApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHtuYW1lOiBlfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5jbGFzc2VzICYmICh0eXBlb2YgZS5jbGFzc2VzID09IFwic3RyaW5nXCIgfHwgZS5jbGFzc2VzIGluc3RhbmNlb2YgUmVnRXhwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmNsYXNzZXMgPSBbZS5jbGFzc2VzXVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXR0ZXJucy5wdXNoKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1hdGNoKC4uLnQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX3BhdHRlcm5zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBxcyhlLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7ZWxlbWVudDogZSwgcGF0dGVybjogdCwgbWF0Y2g6IGl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtYXRjaEFsbCguLi50KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLl9wYXR0ZXJucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gcXMoaSwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnB1c2goe2VsZW1lbnQ6IGksIHBhdHRlcm46IHQsIG1hdGNoOiBufSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlLmxlbmd0aCA+IDAgPyBlIDogbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRFbGVtZW50TmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wYXR0ZXJucy5sZW5ndGggIT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX3BhdHRlcm5zWzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubmFtZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2YgdCAhPSBcImZ1bmN0aW9uXCIgJiYgZSAmJiAhKGUgaW5zdGFuY2VvZiBSZWdFeHApID8gZSA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcXModCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGUgPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZSh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB7fTtcclxuICAgICAgICAgICAgaWYgKGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaS5uYW1lID0gVXMoZS5uYW1lLCB0Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGkuYXR0cmlidXRlcyA9ICRzKGUuYXR0cmlidXRlcywgdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUuY2xhc3Nlcykge1xyXG4gICAgICAgICAgICAgICAgaS5jbGFzc2VzID0gR3MoZS5jbGFzc2VzLCB0KTtcclxuICAgICAgICAgICAgICAgIGlmICghaS5jbGFzc2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUuc3R5bGVzKSB7XHJcbiAgICAgICAgICAgICAgICBpLnN0eWxlcyA9IEtzKGUuc3R5bGVzLCB0KTtcclxuICAgICAgICAgICAgICAgIGlmICghaS5zdHlsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVXModCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQudGVzdChlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0ID09PSBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiAkcyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBuIGluIHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0W25dO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuaGFzQXR0cmlidXRlKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0QXR0cmlidXRlKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChuKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobyBpbnN0YW5jZW9mIFJlZ0V4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoby50ZXN0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gobilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQgPT09IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5wdXNoKG4pXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEdzKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBSZWdFeHApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5nZXRDbGFzc05hbWVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4udGVzdChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5wdXNoKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmhhc0NsYXNzKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5wdXNoKG4pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtzKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gaW4gdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRbbl07XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5oYXNTdHlsZShuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLmdldFN0eWxlKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvIGluc3RhbmNlb2YgUmVnRXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvLnRlc3QodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChuKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodCA9PT0gbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gobilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEpzID0gXCJbb2JqZWN0IFN5bWJvbF1cIjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWXModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHQgPT0gXCJzeW1ib2xcIiB8fCBUKHQpICYmIF8odCkgPT0gSnNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBRcyA9IFlzO1xyXG4gICAgICAgIHZhciBYcyA9IC9cXC58XFxbKD86W15bXFxdXSp8KFtcIiddKSg/Oig/IVxcMSlbXlxcXFxdfFxcXFwuKSo/XFwxKVxcXS8sIFpzID0gL15cXHcqJC87XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRhKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKEplKHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaSA9IHR5cGVvZiB0O1xyXG4gICAgICAgICAgICBpZiAoaSA9PSBcIm51bWJlclwiIHx8IGkgPT0gXCJzeW1ib2xcIiB8fCBpID09IFwiYm9vbGVhblwiIHx8IHQgPT0gbnVsbCB8fCBRcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gWnMudGVzdCh0KSB8fCAhWHMudGVzdCh0KSB8fCBlICE9IG51bGwgJiYgdCBpbiBPYmplY3QoZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBlYSA9IHRhO1xyXG4gICAgICAgIHZhciBpYSA9IFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuYSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCAhPSBcImZ1bmN0aW9uXCIgfHwgZSAhPSBudWxsICYmIHR5cGVvZiBlICE9IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihpYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgaSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gYXJndW1lbnRzLCBvID0gZSA/IGUuYXBwbHkodGhpcywgbikgOiBuWzBdLCByID0gaS5jYWNoZTtcclxuICAgICAgICAgICAgICAgIGlmIChyLmhhcyhvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByLmdldChvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHMgPSB0LmFwcGx5KHRoaXMsIG4pO1xyXG4gICAgICAgICAgICAgICAgaS5jYWNoZSA9IHIuc2V0KG8sIHMpIHx8IHI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpLmNhY2hlID0gbmV3IChuYS5DYWNoZSB8fCBfZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBuYS5DYWNoZSA9IF9lO1xyXG4gICAgICAgIHZhciBvYSA9IG5hO1xyXG4gICAgICAgIHZhciByYSA9IDUwMDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2EodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IG9hKHQsIChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuc2l6ZSA9PT0gcmEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLmNsZWFyKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgdmFyIGkgPSBlLmNhY2hlO1xyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGFhID0gc2E7XHJcbiAgICAgICAgdmFyIGNhID0gL1teLltcXF1dK3xcXFsoPzooLT9cXGQrKD86XFwuXFxkKyk/KXwoW1wiJ10pKCg/Oig/IVxcMilbXlxcXFxdfFxcXFwuKSo/KVxcMilcXF18KD89KD86XFwufFxcW1xcXSkoPzpcXC58XFxbXFxdfCQpKS9nO1xyXG4gICAgICAgIHZhciBsYSA9IC9cXFxcKFxcXFwpPy9nO1xyXG4gICAgICAgIHZhciBkYSA9IGFhKChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IFtdO1xyXG4gICAgICAgICAgICBpZiAodC5jaGFyQ29kZUF0KDApID09PSA0Nikge1xyXG4gICAgICAgICAgICAgICAgZS5wdXNoKFwiXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5yZXBsYWNlKGNhLCAoZnVuY3Rpb24gKHQsIGksIG4sIG8pIHtcclxuICAgICAgICAgICAgICAgIGUucHVzaChuID8gby5yZXBsYWNlKGxhLCBcIiQxXCIpIDogaSB8fCB0KVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfSkpO1xyXG4gICAgICAgIHZhciB1YSA9IGRhO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBoYSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gLTEsIG4gPSB0ID09IG51bGwgPyAwIDogdC5sZW5ndGgsIG8gPSBBcnJheShuKTtcclxuICAgICAgICAgICAgd2hpbGUgKCsraSA8IG4pIHtcclxuICAgICAgICAgICAgICAgIG9baV0gPSBlKHRbaV0sIGksIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBmYSA9IGhhO1xyXG4gICAgICAgIHZhciBnYSA9IDEgLyAwO1xyXG4gICAgICAgIHZhciBtYSA9IHIgPyByLnByb3RvdHlwZSA6IHVuZGVmaW5lZCwgcGEgPSBtYSA/IG1hLnRvU3RyaW5nIDogdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBiYSh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChKZSh0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhKHQsIGJhKSArIFwiXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoUXModCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYSA/IHBhLmNhbGwodCkgOiBcIlwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGUgPSB0ICsgXCJcIjtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPT0gXCIwXCIgJiYgMSAvIHQgPT0gLWdhID8gXCItMFwiIDogZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHdhID0gYmE7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGthKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgPT0gbnVsbCA/IFwiXCIgOiB3YSh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIF9hID0ga2E7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHZhKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKEplKHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlYSh0LCBlKSA/IFt0XSA6IHVhKF9hKHQpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHlhID0gdmE7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHhhKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSB0ID09IG51bGwgPyAwIDogdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIHJldHVybiBlID8gdFtlIC0gMV0gOiB1bmRlZmluZWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBDYSA9IHhhO1xyXG4gICAgICAgIHZhciBBYSA9IDEgLyAwO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBUYSh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiIHx8IFFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBlID0gdCArIFwiXCI7XHJcbiAgICAgICAgICAgIHJldHVybiBlID09IFwiMFwiICYmIDEgLyB0ID09IC1BYSA/IFwiLTBcIiA6IGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBQYSA9IFRhO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBTYSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGUgPSB5YShlLCB0KTtcclxuICAgICAgICAgICAgdmFyIGkgPSAwLCBuID0gZS5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlICh0ICE9IG51bGwgJiYgaSA8IG4pIHtcclxuICAgICAgICAgICAgICAgIHQgPSB0W1BhKGVbaSsrXSldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGkgJiYgaSA9PSBuID8gdCA6IHVuZGVmaW5lZFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEVhID0gU2E7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFJhKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSAtMSwgbyA9IHQubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAoZSA8IDApIHtcclxuICAgICAgICAgICAgICAgIGUgPSAtZSA+IG8gPyAwIDogbyArIGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpID0gaSA+IG8gPyBvIDogaTtcclxuICAgICAgICAgICAgaWYgKGkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBpICs9IG9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvID0gZSA+IGkgPyAwIDogaSAtIGUgPj4+IDA7XHJcbiAgICAgICAgICAgIGUgPj4+PSAwO1xyXG4gICAgICAgICAgICB2YXIgciA9IEFycmF5KG8pO1xyXG4gICAgICAgICAgICB3aGlsZSAoKytuIDwgbykge1xyXG4gICAgICAgICAgICAgICAgcltuXSA9IHRbbiArIGVdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBPYSA9IFJhO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBJYSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlLmxlbmd0aCA8IDIgPyB0IDogRWEodCwgT2EoZSwgMCwgLTEpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFZhID0gSWE7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5hKHQsIGUpIHtcclxuICAgICAgICAgICAgZSA9IHlhKGUsIHQpO1xyXG4gICAgICAgICAgICB0ID0gVmEodCwgZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0ID09IG51bGwgfHwgZGVsZXRlIHRbUGEoQ2EoZSkpXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIE1hID0gTmE7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEJhKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgPT0gbnVsbCA/IHRydWUgOiBNYSh0LCBlKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHphID0gQmE7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIExhKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgdmFyIG4gPSB0ID09IG51bGwgPyB1bmRlZmluZWQgOiBFYSh0LCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIG4gPT09IHVuZGVmaW5lZCA/IGkgOiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgRmEgPSBMYTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRGEodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBpZiAoaSAhPT0gdW5kZWZpbmVkICYmICFMKHRbZV0sIGkpIHx8IGkgPT09IHVuZGVmaW5lZCAmJiAhKGUgaW4gdCkpIHtcclxuICAgICAgICAgICAgICAgIE9lKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBqYSA9IERhO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBIYSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSwgaSwgbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIG8gPSAtMSwgciA9IE9iamVjdChlKSwgcyA9IG4oZSksIGEgPSBzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChhLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHNbdCA/IGEgOiArK29dO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpKHJbY10sIGMsIHIpID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBXYSA9IEhhO1xyXG4gICAgICAgIHZhciBxYSA9IFdhKCk7XHJcbiAgICAgICAgdmFyIFVhID0gcWE7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uICRhKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFQodCkgJiYgUWkodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBHYSA9ICRhO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBLYSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmIChlID09PSBcImNvbnN0cnVjdG9yXCIgJiYgdHlwZW9mIHRbZV0gPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUgPT0gXCJfX3Byb3RvX19cIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRbZV1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBKYSA9IEthO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBZYSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB6ZSh0LCBkbih0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBRYSA9IFlhO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBYYSh0LCBlLCBpLCBuLCBvLCByLCBzKSB7XHJcbiAgICAgICAgICAgIHZhciBhID0gSmEodCwgaSksIGMgPSBKYShlLCBpKSwgbCA9IHMuZ2V0KGMpO1xyXG4gICAgICAgICAgICBpZiAobCkge1xyXG4gICAgICAgICAgICAgICAgamEodCwgaSwgbCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZCA9IHIgPyByKGEsIGMsIGkgKyBcIlwiLCB0LCBlLCBzKSA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgdmFyIHUgPSBkID09PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGlmICh1KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IEplKGMpLCBmID0gIWggJiYgT2JqZWN0KFllW1wiYVwiXSkoYyksIGcgPSAhaCAmJiAhZiAmJiBCaShjKTtcclxuICAgICAgICAgICAgICAgIGQgPSBjO1xyXG4gICAgICAgICAgICAgICAgaWYgKGggfHwgZiB8fCBnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKEplKGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBhXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChHYShhKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0gbW4oYSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0gT2JqZWN0KGZuW1wiYVwiXSkoYywgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0gVG8oYywgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkID0gW11cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKE4oYykgfHwgR2UoYykpIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gYTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoR2UoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IFFhKGEpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghY3QoYSkgfHwgZ3QoYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCA9IFhvKGMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB1ID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodSkge1xyXG4gICAgICAgICAgICAgICAgcy5zZXQoYywgZCk7XHJcbiAgICAgICAgICAgICAgICBvKGQsIGMsIG4sIHIsIHMpO1xyXG4gICAgICAgICAgICAgICAgc1tcImRlbGV0ZVwiXShjKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGphKHQsIGksIGQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgWmEgPSBYYTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdGModCwgZSwgaSwgbiwgbykge1xyXG4gICAgICAgICAgICBpZiAodCA9PT0gZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgVWEoZSwgKGZ1bmN0aW9uIChyLCBzKSB7XHJcbiAgICAgICAgICAgICAgICBvIHx8IChvID0gbmV3IEFlKTtcclxuICAgICAgICAgICAgICAgIGlmIChjdChyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIFphKHQsIGUsIHMsIGksIHRjLCBuLCBvKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IG4gPyBuKEphKHQsIHMpLCByLCBzICsgXCJcIiwgdCwgZSwgbykgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhID0gclxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBqYSh0LCBzLCBhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSwgZG4pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZWMgPSB0YztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaWModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG5jID0gaWM7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9jKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNhbGwoZSk7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuY2FsbChlLCBpWzBdKTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jYWxsKGUsIGlbMF0sIGlbMV0pO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNhbGwoZSwgaVswXSwgaVsxXSwgaVsyXSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdC5hcHBseShlLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHJjID0gb2M7XHJcbiAgICAgICAgdmFyIHNjID0gTWF0aC5tYXg7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgZSA9IHNjKGUgPT09IHVuZGVmaW5lZCA/IHQubGVuZ3RoIC0gMSA6IGUsIDApO1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBhcmd1bWVudHMsIG8gPSAtMSwgciA9IHNjKG4ubGVuZ3RoIC0gZSwgMCksIHMgPSBBcnJheShyKTtcclxuICAgICAgICAgICAgICAgIHdoaWxlICgrK28gPCByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc1tvXSA9IG5bZSArIG9dXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvID0gLTE7XHJcbiAgICAgICAgICAgICAgICB2YXIgYSA9IEFycmF5KGUgKyAxKTtcclxuICAgICAgICAgICAgICAgIHdoaWxlICgrK28gPCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYVtvXSA9IG5bb11cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFbZV0gPSBpKHMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJjKHQsIHRoaXMsIGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBjYyA9IGFjO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsYyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZGMgPSBsYztcclxuICAgICAgICB2YXIgdWMgPSAhRWUgPyBuYyA6IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBFZSh0LCBcInRvU3RyaW5nXCIsIHtjb25maWd1cmFibGU6IHRydWUsIGVudW1lcmFibGU6IGZhbHNlLCB2YWx1ZTogZGMoZSksIHdyaXRhYmxlOiB0cnVlfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBoYyA9IHVjO1xyXG4gICAgICAgIHZhciBmYyA9IDgwMCwgZ2MgPSAxNjtcclxuICAgICAgICB2YXIgbWMgPSBEYXRlLm5vdztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcGModCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IDAsIGkgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBtYygpLCBvID0gZ2MgLSAobiAtIGkpO1xyXG4gICAgICAgICAgICAgICAgaSA9IG47XHJcbiAgICAgICAgICAgICAgICBpZiAobyA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoKytlID49IGZjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHNbMF1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5hcHBseSh1bmRlZmluZWQsIGFyZ3VtZW50cylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGJjID0gcGM7XHJcbiAgICAgICAgdmFyIHdjID0gYmMoaGMpO1xyXG4gICAgICAgIHZhciBrYyA9IHdjO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBfYyh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBrYyhjYyh0LCBlLCBuYyksIHQgKyBcIlwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHZjID0gX2M7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHljKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaWYgKCFjdChpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG4gPSB0eXBlb2YgZTtcclxuICAgICAgICAgICAgaWYgKG4gPT0gXCJudW1iZXJcIiA/IFFpKGkpICYmIHRpKGUsIGkubGVuZ3RoKSA6IG4gPT0gXCJzdHJpbmdcIiAmJiBlIGluIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBMKGlbZV0sIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgeGMgPSB5YztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ2ModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmMoKGZ1bmN0aW9uIChlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IC0xLCBvID0gaS5sZW5ndGgsIHIgPSBvID4gMSA/IGlbbyAtIDFdIDogdW5kZWZpbmVkLCBzID0gbyA+IDIgPyBpWzJdIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgciA9IHQubGVuZ3RoID4gMyAmJiB0eXBlb2YgciA9PSBcImZ1bmN0aW9uXCIgPyAoby0tLCByKSA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIGlmIChzICYmIHhjKGlbMF0sIGlbMV0sIHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IG8gPCAzID8gdW5kZWZpbmVkIDogcjtcclxuICAgICAgICAgICAgICAgICAgICBvID0gMVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZSA9IE9iamVjdChlKTtcclxuICAgICAgICAgICAgICAgIHdoaWxlICgrK24gPCBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBpW25dO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQoZSwgYSwgbiwgcilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBBYyA9IENjO1xyXG4gICAgICAgIHZhciBUYyA9IEFjKChmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBlYyh0LCBlLCBpKVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB2YXIgUGMgPSBUYztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gU2ModCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICBpZiAoIWN0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUgPSB5YShlLCB0KTtcclxuICAgICAgICAgICAgdmFyIG8gPSAtMSwgciA9IGUubGVuZ3RoLCBzID0gciAtIDEsIGEgPSB0O1xyXG4gICAgICAgICAgICB3aGlsZSAoYSAhPSBudWxsICYmICsrbyA8IHIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gUGEoZVtvXSksIGwgPSBpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8gIT0gcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gYVtjXTtcclxuICAgICAgICAgICAgICAgICAgICBsID0gbiA/IG4oZCwgYywgYSkgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGwgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsID0gY3QoZCkgPyBkIDogdGkoZVtvICsgMV0pID8gW10gOiB7fVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE1lKGEsIGMsIGwpO1xyXG4gICAgICAgICAgICAgICAgYSA9IGFbY11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEVjID0gU2M7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFJjKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgPT0gbnVsbCA/IHQgOiBFYyh0LCBlLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIE9jID0gUmM7XHJcblxyXG4gICAgICAgIGNsYXNzIEljIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzID0ge307XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdHlsZVByb2Nlc3NvciA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzRW1wdHkoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gT2JqZWN0LmVudHJpZXModGhpcy5fc3R5bGVzKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBBcnJheS5mcm9tKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFlLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgc2l6ZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3R5bGVOYW1lcygpLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRUbyh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gQXJyYXkuZnJvbShOYyh0KS5lbnRyaWVzKCkpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbdCwgaV0gb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0eWxlUHJvY2Vzc29yLnRvTm9ybWFsaXplZEZvcm0odCwgaSwgdGhpcy5fc3R5bGVzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYXModCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3N0eWxlUHJvY2Vzc29yLmdldFJlZHVjZWRGb3JtKHQsIHRoaXMuX3N0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5maW5kKChbZV0pID0+IGUgPT09IHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjdCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2UsIGldIG9mIE9iamVjdC5lbnRyaWVzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0eWxlUHJvY2Vzc29yLnRvTm9ybWFsaXplZEZvcm0oZSwgaSwgdGhpcy5fc3R5bGVzKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVQcm9jZXNzb3IudG9Ob3JtYWxpemVkRm9ybSh0LCBlLCB0aGlzLl9zdHlsZXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gTWModCk7XHJcbiAgICAgICAgICAgICAgICB6YSh0aGlzLl9zdHlsZXMsIGUpO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3N0eWxlc1t0XTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFuRW1wdHlPYmplY3RzT25QYXRoKGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldE5vcm1hbGl6ZWQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlUHJvY2Vzc29yLmdldE5vcm1hbGl6ZWQodCwgdGhpcy5fc3R5bGVzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b1N0cmluZygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFN0eWxlc0VudHJpZXMoKS5tYXAodCA9PiB0LmpvaW4oXCI6XCIpKS5zb3J0KCkuam9pbihcIjtcIikgKyBcIjtcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRBc1N0cmluZyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3R5bGVzW3RdICYmICFjdCh0aGlzLl9zdHlsZXNbdF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlc1t0XVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3N0eWxlUHJvY2Vzc29yLmdldFJlZHVjZWRGb3JtKHQsIHRoaXMuX3N0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5maW5kKChbZV0pID0+IGUgPT09IHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVsxXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRTdHlsZU5hbWVzKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX2dldFN0eWxlc0VudHJpZXMoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0Lm1hcCgoW3RdKSA9PiB0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbGVhcigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0eWxlcyA9IHt9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRTdHlsZXNFbnRyaWVzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IE9iamVjdC5rZXlzKHRoaXMuX3N0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucHVzaCguLi50aGlzLl9zdHlsZVByb2Nlc3Nvci5nZXRSZWR1Y2VkRm9ybShpLCB0aGlzLl9zdHlsZXMpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NsZWFuRW1wdHlPYmplY3RzT25QYXRoKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnNwbGl0KFwiLlwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmxlbmd0aCA+IDE7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLnNwbGljZSgwLCBlLmxlbmd0aCAtIDEpLmpvaW4oXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IEZhKHRoaXMuX3N0eWxlcywgbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW8pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSAhQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvKSkubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZShuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBWYyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbm9ybWFsaXplcnMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXh0cmFjdG9ycyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWR1Y2VycyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcyA9IG5ldyBNYXBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9Ob3JtYWxpemVkRm9ybSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3QoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBCYyhpLCBNYyh0KSwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbm9ybWFsaXplcnMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX25vcm1hbGl6ZXJzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB7cGF0aDogbywgdmFsdWU6IHJ9ID0gbihlKTtcclxuICAgICAgICAgICAgICAgICAgICBCYyhpLCBvLCByKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBCYyhpLCB0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXROb3JtYWxpemVkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQYyh7fSwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlW3RdICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVt0XVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2V4dHJhY3RvcnMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2V4dHJhY3RvcnMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmEoZSwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkodCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRmEoZSwgTWModCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFJlZHVjZWRGb3JtKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmdldE5vcm1hbGl6ZWQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVkdWNlcnMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3JlZHVjZXJzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZShpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtbdCwgaV1dXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFJlbGF0ZWRTdHlsZXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnN1bWFibGVzLmdldCh0KSB8fCBbXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXROb3JtYWxpemVyKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25vcm1hbGl6ZXJzLnNldCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRFeHRyYWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZXh0cmFjdG9ycy5zZXQodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0UmVkdWNlcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWR1Y2Vycy5zZXQodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0U3R5bGVSZWxhdGlvbih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXBTdHlsZU5hbWVzKHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXBTdHlsZU5hbWVzKGksIFt0XSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21hcFN0eWxlTmFtZXModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25zdW1hYmxlcy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcy5zZXQodCwgW10pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcy5nZXQodCkucHVzaCguLi5lKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBOYyh0KSB7XHJcbiAgICAgICAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgICAgIGxldCBvID0gbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgciA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgIGlmICh0ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LmNoYXJBdCh0Lmxlbmd0aCAtIDEpICE9IFwiO1wiKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gdCArIFwiO1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCB0Lmxlbmd0aDsgcysrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gdC5jaGFyQXQocyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlXCI6XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gdC5zdWJzdHIoaSwgcyAtIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBzICsgMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UnXCInOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlXCInXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlXCI7XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnN1YnN0cihuLCBzIC0gbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuc2V0KG8udHJpbSgpLCBlLnRyaW0oKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHMgKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYSA9PT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE1jKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQucmVwbGFjZShcIi1cIiwgXCIuXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCYyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGxldCBuID0gaTtcclxuICAgICAgICAgICAgaWYgKGN0KGkpKSB7XHJcbiAgICAgICAgICAgICAgICBuID0gUGMoe30sIEZhKHQsIGUpLCBpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIE9jKHQsIGUsIG4pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB6YyBleHRlbmRzIHpzIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0cnMgPSBMYyhpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkcmVuID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydENoaWxkKDAsIG4pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGFzc2VzID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdHRycy5oYXMoXCJjbGFzc1wiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9hdHRycy5nZXQoXCJjbGFzc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBGYyh0aGlzLl9jbGFzc2VzLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdHRycy5kZWxldGUoXCJjbGFzc1wiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzID0gbmV3IEljKHRoaXMuZG9jdW1lbnQuc3R5bGVzUHJvY2Vzc29yKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdHRycy5oYXMoXCJzdHlsZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0eWxlcy5zZXRUbyh0aGlzLl9hdHRycy5nZXQoXCJzdHlsZVwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXR0cnMuZGVsZXRlKFwic3R5bGVcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1c3RvbVByb3BlcnRpZXMgPSBuZXcgTWFwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBjaGlsZENvdW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNFbXB0eSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5sZW5ndGggPT09IDBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCwgZSA9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJlcGxhY2UoL152aWV3Oi8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJlbGVtZW50XCIgfHwgaSA9PSB0aGlzLm5hbWUgfHwgc3VwZXIuaXModClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJlbGVtZW50XCIgJiYgZSA9PSB0aGlzLm5hbWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuW3RdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENoaWxkSW5kZXgodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmluZGV4T2YodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGRyZW4oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW5bU3ltYm9sLml0ZXJhdG9yXSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0QXR0cmlidXRlS2V5cygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jbGFzc2VzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGRcImNsYXNzXCJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc3R5bGVzLmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZFwic3R5bGVcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgeWllbGQqIHRoaXMuX2F0dHJzLmtleXMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIGdldEF0dHJpYnV0ZXMoKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCogdGhpcy5fYXR0cnMuZW50cmllcygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NsYXNzZXMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZFtcImNsYXNzXCIsIHRoaXMuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIildXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3N0eWxlcy5pc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGRbXCJzdHlsZVwiLCB0aGlzLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRBdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgPT0gXCJjbGFzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NsYXNzZXMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsuLi50aGlzLl9jbGFzc2VzXS5qb2luKFwiIFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodCA9PSBcInN0eWxlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fc3R5bGVzLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJcIiA/IHVuZGVmaW5lZCA6IHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hdHRycy5nZXQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFzQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09IFwiY2xhc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jbGFzc2VzLnNpemUgPiAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodCA9PSBcInN0eWxlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXRoaXMuX3N0eWxlcy5pc0VtcHR5XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuaGFzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzU2ltaWxhcih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgemMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcyA9PT0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uYW1lICE9IHQubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2F0dHJzLnNpemUgIT09IHQuX2F0dHJzLnNpemUgfHwgdGhpcy5fY2xhc3Nlcy5zaXplICE9PSB0Ll9jbGFzc2VzLnNpemUgfHwgdGhpcy5fc3R5bGVzLnNpemUgIT09IHQuX3N0eWxlcy5zaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtlLCBpXSBvZiB0aGlzLl9hdHRycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdC5fYXR0cnMuaGFzKGUpIHx8IHQuX2F0dHJzLmdldChlKSAhPT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fY2xhc3Nlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdC5fY2xhc3Nlcy5oYXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX3N0eWxlcy5nZXRTdHlsZU5hbWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXQuX3N0eWxlcy5oYXMoZSkgfHwgdC5fc3R5bGVzLmdldEFzU3RyaW5nKGUpICE9PSB0aGlzLl9zdHlsZXMuZ2V0QXNTdHJpbmcoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFzQ2xhc3MoLi4udCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NsYXNzZXMuaGFzKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENsYXNzTmFtZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2xhc3Nlcy5rZXlzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U3R5bGUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlcy5nZXRBc1N0cmluZyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXROb3JtYWxpemVkU3R5bGUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlcy5nZXROb3JtYWxpemVkKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFN0eWxlTmFtZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc3R5bGVzLmdldFN0eWxlTmFtZXMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYXNTdHlsZSguLi50KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc3R5bGVzLmhhcyhlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmaW5kQW5jZXN0b3IoLi4udCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBXcyguLi50KTtcclxuICAgICAgICAgICAgICAgIGxldCBpID0gdGhpcy5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLm1hdGNoKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBpLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q3VzdG9tUHJvcGVydHkodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbVByb3BlcnRpZXMuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0Q3VzdG9tUHJvcGVydGllcygpIHtcclxuICAgICAgICAgICAgICAgIHlpZWxkKiB0aGlzLl9jdXN0b21Qcm9wZXJ0aWVzLmVudHJpZXMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRJZGVudGl0eSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBBcnJheS5mcm9tKHRoaXMuX2NsYXNzZXMpLnNvcnQoKS5qb2luKFwiLFwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9zdHlsZXMudG9TdHJpbmcoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBBcnJheS5mcm9tKHRoaXMuX2F0dHJzKS5tYXAodCA9PiBgJHt0WzBdfT1cIiR7dFsxXX1cImApLnNvcnQoKS5qb2luKFwiIFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAodCA9PSBcIlwiID8gXCJcIiA6IGAgY2xhc3M9XCIke3R9XCJgKSArICghZSA/IFwiXCIgOiBgIHN0eWxlPVwiJHtlfVwiYCkgKyAoaSA9PSBcIlwiID8gXCJcIiA6IGAgJHtpfWApXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbG9uZSh0ID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHRoaXMuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnB1c2goaS5fY2xvbmUodCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuZG9jdW1lbnQsIHRoaXMubmFtZSwgdGhpcy5fYXR0cnMsIGUpO1xyXG4gICAgICAgICAgICAgICAgaS5fY2xhc3NlcyA9IG5ldyBTZXQodGhpcy5fY2xhc3Nlcyk7XHJcbiAgICAgICAgICAgICAgICBpLl9zdHlsZXMuc2V0KHRoaXMuX3N0eWxlcy5nZXROb3JtYWxpemVkKCkpO1xyXG4gICAgICAgICAgICAgICAgaS5fY3VzdG9tUHJvcGVydGllcyA9IG5ldyBNYXAodGhpcy5fY3VzdG9tUHJvcGVydGllcyk7XHJcbiAgICAgICAgICAgICAgICBpLmdldEZpbGxlck9mZnNldCA9IHRoaXMuZ2V0RmlsbGVyT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FwcGVuZENoaWxkKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbnNlcnRDaGlsZCh0aGlzLmNoaWxkQ291bnQsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9pbnNlcnRDaGlsZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlKFwiY2hpbGRyZW5cIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gRGModGhpcy5kb2N1bWVudCwgZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnBhcmVudCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLl9yZW1vdmUoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5kb2N1bWVudCA9IHRoaXMuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4uc3BsaWNlKHQsIDAsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQrKztcclxuICAgICAgICAgICAgICAgICAgICBpKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVDaGlsZHJlbih0LCBlID0gMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZUNoYW5nZShcImNoaWxkcmVuXCIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHQ7IGkgPCB0ICsgZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW5baV0ucGFyZW50ID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLnNwbGljZSh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0QXR0cmlidXRlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGUgPSBTdHJpbmcoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlKFwiYXR0cmlidXRlc1wiLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09IFwiY2xhc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIEZjKHRoaXMuX2NsYXNzZXMsIGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQgPT0gXCJzdHlsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzLnNldFRvKGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2F0dHJzLnNldCh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoXCJhdHRyaWJ1dGVzXCIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgPT0gXCJjbGFzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NsYXNzZXMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xhc3Nlcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0ID09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc3R5bGVzLmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3R5bGVzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F0dHJzLmRlbGV0ZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYWRkQ2xhc3ModCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZUNoYW5nZShcImF0dHJpYnV0ZXNcIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0ID0gQXJyYXkuaXNBcnJheSh0KSA/IHQgOiBbdF07XHJcbiAgICAgICAgICAgICAgICB0LmZvckVhY2godCA9PiB0aGlzLl9jbGFzc2VzLmFkZCh0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZUNsYXNzKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoXCJhdHRyaWJ1dGVzXCIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdCA9IEFycmF5LmlzQXJyYXkodCkgPyB0IDogW3RdO1xyXG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKHQgPT4gdGhpcy5fY2xhc3Nlcy5kZWxldGUodCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRTdHlsZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlKFwiYXR0cmlidXRlc1wiLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0eWxlcy5zZXQodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZVN0eWxlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVDaGFuZ2UoXCJhdHRyaWJ1dGVzXCIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdCA9IEFycmF5LmlzQXJyYXkodCkgPyB0IDogW3RdO1xyXG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKHQgPT4gdGhpcy5fc3R5bGVzLnJlbW92ZSh0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldEN1c3RvbVByb3BlcnR5KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1c3RvbVByb3BlcnRpZXMuc2V0KHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVDdXN0b21Qcm9wZXJ0eSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VzdG9tUHJvcGVydGllcy5kZWxldGUodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTGModCkge1xyXG4gICAgICAgICAgICB0ID0gSHModCk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2UsIGldIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5kZWxldGUoZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGkgIT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0KGUsIFN0cmluZyhpKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRmModCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZS5zcGxpdCgvXFxzKy8pO1xyXG4gICAgICAgICAgICB0LmNsZWFyKCk7XHJcbiAgICAgICAgICAgIGkuZm9yRWFjaChlID0+IHQuYWRkKGUpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRGModCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGUgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgTHModCwgZSldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFqcyhlKSkge1xyXG4gICAgICAgICAgICAgICAgZSA9IFtlXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKGUpLm1hcChlID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMcyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTHModCwgZS5kYXRhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGpjIGV4dGVuZHMgemMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBlLCBpLCBuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RmlsbGVyT2Zmc2V0ID0gSGNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCwgZSA9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0ICYmIHQucmVwbGFjZSgvXnZpZXc6LywgXCJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA9PSBcImNvbnRhaW5lckVsZW1lbnRcIiB8fCBzdXBlci5pcyh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA9PSBcImNvbnRhaW5lckVsZW1lbnRcIiAmJiBlID09IHRoaXMubmFtZSB8fCBzdXBlci5pcyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIYygpIHtcclxuICAgICAgICAgICAgY29uc3QgdCA9IFsuLi50aGlzLmdldENoaWxkcmVuKCldO1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdFt0aGlzLmNoaWxkQ291bnQgLSAxXTtcclxuICAgICAgICAgICAgaWYgKGUgJiYgZS5pcyhcImVsZW1lbnRcIiwgXCJiclwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRDb3VudFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkQ291bnRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBXYyA9IEFjKChmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgICAgICB6ZShlLCBkbihlKSwgdClcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgdmFyIHFjID0gV2M7XHJcbiAgICAgICAgY29uc3QgVWMgPSBTeW1ib2woXCJvYnNlcnZhYmxlUHJvcGVydGllc1wiKTtcclxuICAgICAgICBjb25zdCAkYyA9IFN5bWJvbChcImJvdW5kT2JzZXJ2YWJsZXNcIik7XHJcbiAgICAgICAgY29uc3QgR2MgPSBTeW1ib2woXCJib3VuZFByb3BlcnRpZXNcIik7XHJcbiAgICAgICAgY29uc3QgS2MgPSB7XHJcbiAgICAgICAgICAgIHNldCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY3QodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldChlLCB0W2VdKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgWWModGhpcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpc1tVY107XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbiB0aGlzICYmICFpLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLXNldC1jYW5ub3Qtb3ZlcnJpZGU6IENhbm5vdCBvdmVycmlkZSBhbiBleGlzdGluZyBwcm9wZXJ0eS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCB0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpLmdldCh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHNldChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmdldCh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG8gPSB0aGlzLmZpcmUoXCJzZXQ6XCIgKyB0LCB0LCBlLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobiAhPT0gbyB8fCAhaS5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0KHQsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiY2hhbmdlOlwiICsgdCwgdCwgbywgbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpc1t0XSA9IGVcclxuICAgICAgICAgICAgfSwgYmluZCguLi50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQubGVuZ3RoIHx8ICF0bCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLWJpbmQtd3JvbmctcHJvcGVydGllczogQWxsIHByb3BlcnRpZXMgbXVzdCBiZSBzdHJpbmdzLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG5ldyBTZXQodCkuc2l6ZSAhPT0gdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwib2JzZXJ2YWJsZS1iaW5kLWR1cGxpY2F0ZS1wcm9wZXJ0aWVzOiBQcm9wZXJ0aWVzIG11c3QgYmUgdW5pcXVlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgWWModGhpcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpc1tHY107XHJcbiAgICAgICAgICAgICAgICB0LmZvckVhY2godCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLWJpbmQtcmViaW5kOiBDYW5ub3QgYmluZCB0aGUgc2FtZSBwcm9wZXJ0eSBtb3JlIHRoYW4gb25jZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB7cHJvcGVydHk6IHQsIHRvOiBbXX07XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zZXQodCwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zZXQodCwgbilcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt0bzogUWMsIHRvTWFueTogWGMsIF9vYnNlcnZhYmxlOiB0aGlzLCBfYmluZFByb3BlcnRpZXM6IHQsIF90bzogW10sIF9iaW5kaW5nczogaX1cclxuICAgICAgICAgICAgfSwgdW5iaW5kKC4uLnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKFVjIGluIHRoaXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpc1tHY107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpc1skY107XHJcbiAgICAgICAgICAgICAgICBpZiAodC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRsKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLXVuYmluZC13cm9uZy1wcm9wZXJ0aWVzOiBQcm9wZXJ0aWVzIG11c3QgYmUgc3RyaW5ncy5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdC5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG8sIHIsIHMsIGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4udG8uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB0WzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IHRbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gaS5nZXQobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gc1tyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuZGVsZXRlKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhLnNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgc1tyXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhzKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmRlbGV0ZShvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcobywgXCJjaGFuZ2VcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZGVsZXRlKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5mb3JFYWNoKCh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZyhlLCBcImNoYW5nZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBlLmNsZWFyKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZGVjb3JhdGUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXNbdF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwib2JzZXJ2YWJsZW1peGluLWNhbm5vdC1kZWNvcmF0ZS11bmRlZmluZWQ6IENhbm5vdCBkZWNvcmF0ZSBhbiB1bmRlZmluZWQgbWV0aG9kLlwiLCB0aGlzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdDogdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kTmFtZTogdFxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKHQsICh0LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5yZXR1cm4gPSBlLmFwcGx5KHRoaXMsIGkpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXNbdF0gPSBmdW5jdGlvbiAoLi4uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpcmUodCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcWMoS2MsIGRzKTtcclxuICAgICAgICB2YXIgSmMgPSBLYztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWWModCkge1xyXG4gICAgICAgICAgICBpZiAoVWMgaW4gdCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIFVjLCB7dmFsdWU6IG5ldyBNYXB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsICRjLCB7dmFsdWU6IG5ldyBNYXB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsIEdjLCB7dmFsdWU6IG5ldyBNYXB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUWMoLi4udCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gZWwoLi4udCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBBcnJheS5mcm9tKHRoaXMuX2JpbmRpbmdzLmtleXMoKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKCFlLmNhbGxiYWNrICYmIGUudG8ubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm9ic2VydmFibGUtYmluZC10by1uby1jYWxsYmFjazogQmluZGluZyBtdWx0aXBsZSBvYnNlcnZhYmxlcyBvbmx5IHBvc3NpYmxlIHdpdGggY2FsbGJhY2suXCIsIHRoaXMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG4gPiAxICYmIGUuY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLWJpbmQtdG8tZXh0cmEtY2FsbGJhY2s6IENhbm5vdCBiaW5kIG11bHRpcGxlIHByb3BlcnRpZXMgYW5kIHVzZSBhIGNhbGxiYWNrIGluIG9uZSBiaW5kaW5nLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUudG8uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0LnByb3BlcnRpZXMubGVuZ3RoICYmIHQucHJvcGVydGllcy5sZW5ndGggIT09IG4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwib2JzZXJ2YWJsZS1iaW5kLXRvLXByb3BlcnRpZXMtbGVuZ3RoOiBUaGUgbnVtYmVyIG9mIHByb3BlcnRpZXMgbXVzdCBtYXRjaC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdC5wcm9wZXJ0aWVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucHJvcGVydGllcyA9IHRoaXMuX2JpbmRQcm9wZXJ0aWVzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLl90byA9IGUudG87XHJcbiAgICAgICAgICAgIGlmIChlLmNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iaW5kaW5ncy5nZXQoaVswXSkuY2FsbGJhY2sgPSBlLmNhbGxiYWNrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmwodGhpcy5fb2JzZXJ2YWJsZSwgdGhpcy5fdG8pO1xyXG4gICAgICAgICAgICBubCh0aGlzKTtcclxuICAgICAgICAgICAgdGhpcy5fYmluZFByb3BlcnRpZXMuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgIG9sKHRoaXMuX29ic2VydmFibGUsIHQpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBYYyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9iaW5kaW5ncy5zaXplID4gMSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm9ic2VydmFibGUtYmluZC10by1tYW55LW5vdC1vbmUtYmluZGluZzogQ2Fubm90IGJpbmQgbXVsdGlwbGUgcHJvcGVydGllcyB3aXRoIHRvTWFueSgpLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudG8oLi4uWmModCwgZSksIGkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBaYyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0Lm1hcCh0ID0+IFt0LCBlXSk7XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdGwodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5ldmVyeSh0ID0+IHR5cGVvZiB0ID09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlbCguLi50KSB7XHJcbiAgICAgICAgICAgIGlmICghdC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLWJpbmQtdG8tcGFyc2UtZXJyb3I6IEludmFsaWQgYXJndW1lbnQgc3ludGF4IGluIGB0bygpYC5cIiwgbnVsbClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBlID0ge3RvOiBbXX07XHJcbiAgICAgICAgICAgIGxldCBpO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRbdC5sZW5ndGggLSAxXSA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgIGUuY2FsbGJhY2sgPSB0LnBvcCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnByb3BlcnRpZXMucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdCA9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IHtvYnNlcnZhYmxlOiB0LCBwcm9wZXJ0aWVzOiBbXX07XHJcbiAgICAgICAgICAgICAgICAgICAgZS50by5wdXNoKGkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvYnNlcnZhYmxlLWJpbmQtdG8tcGFyc2UtZXJyb3I6IEludmFsaWQgYXJndW1lbnQgc3ludGF4IGluIGB0bygpYC5cIiwgbnVsbClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpbCh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0WyRjXTtcclxuICAgICAgICAgICAgY29uc3QgciA9IG8uZ2V0KGkpO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gciB8fCB7fTtcclxuICAgICAgICAgICAgaWYgKCFzW25dKSB7XHJcbiAgICAgICAgICAgICAgICBzW25dID0gbmV3IFNldFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHNbbl0uYWRkKGUpO1xyXG4gICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgIG8uc2V0KGksIHMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG5sKHQpIHtcclxuICAgICAgICAgICAgbGV0IGU7XHJcbiAgICAgICAgICAgIHQuX2JpbmRpbmdzLmZvckVhY2goKGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgIHQuX3RvLmZvckVhY2gobyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IG8ucHJvcGVydGllc1tpLmNhbGxiYWNrID8gMCA6IHQuX2JpbmRQcm9wZXJ0aWVzLmluZGV4T2YobildO1xyXG4gICAgICAgICAgICAgICAgICAgIGkudG8ucHVzaChbby5vYnNlcnZhYmxlLCBlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWwodC5fb2JzZXJ2YWJsZSwgaSwgby5vYnNlcnZhYmxlLCBlKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9sKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHRbR2NdO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaS5nZXQoZSk7XHJcbiAgICAgICAgICAgIGxldCBvO1xyXG4gICAgICAgICAgICBpZiAobi5jYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgbyA9IG4uY2FsbGJhY2suYXBwbHkodCwgbi50by5tYXAodCA9PiB0WzBdW3RbMV1dKSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG8gPSBuLnRvWzBdO1xyXG4gICAgICAgICAgICAgICAgbyA9IG9bMF1bb1sxXV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5oYXNPd25Qcm9wZXJ0eShlKSkge1xyXG4gICAgICAgICAgICAgICAgdFtlXSA9IG9cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHQuc2V0KGUsIG8pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJsKHQsIGUpIHtcclxuICAgICAgICAgICAgZS5mb3JFYWNoKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRbJGNdO1xyXG4gICAgICAgICAgICAgICAgbGV0IG47XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuZ2V0KGUub2JzZXJ2YWJsZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lmxpc3RlblRvKGUub2JzZXJ2YWJsZSwgXCJjaGFuZ2VcIiwgKG8sIHIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGkuZ2V0KGUub2JzZXJ2YWJsZSlbcl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmZvckVhY2goZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2wodCwgZS5wcm9wZXJ0eSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3Mgc2wgZXh0ZW5kcyBqYyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIGUsIGksIG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc1JlYWRPbmx5XCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNGb2N1c2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZChcImlzUmVhZE9ubHlcIikudG8odCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmQoXCJpc0ZvY3VzZWRcIikudG8odCwgXCJpc0ZvY3VzZWRcIiwgZSA9PiBlICYmIHQuc2VsZWN0aW9uLmVkaXRhYmxlRWxlbWVudCA9PSB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odC5zZWxlY3Rpb24sIFwiY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRm9jdXNlZCA9IHQuaXNGb2N1c2VkICYmIHQuc2VsZWN0aW9uLmVkaXRhYmxlRWxlbWVudCA9PSB0aGlzXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0LCBlID0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQgJiYgdC5yZXBsYWNlKC9edmlldzovLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpID09IFwiZWRpdGFibGVFbGVtZW50XCIgfHwgc3VwZXIuaXModClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJlZGl0YWJsZUVsZW1lbnRcIiAmJiBlID09IHRoaXMubmFtZSB8fCBzdXBlci5pcyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoc2wsIEpjKTtcclxuICAgICAgICBjb25zdCBhbCA9IFN5bWJvbChcInJvb3ROYW1lXCIpO1xyXG5cclxuICAgICAgICBjbGFzcyBjbCBleHRlbmRzIHNsIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvb3ROYW1lID0gXCJtYWluXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCwgZSA9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJlcGxhY2UoL152aWV3Oi8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJyb290RWxlbWVudFwiIHx8IHN1cGVyLmlzKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpID09IFwicm9vdEVsZW1lbnRcIiAmJiBlID09IHRoaXMubmFtZSB8fCBzdXBlci5pcyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcm9vdE5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDdXN0b21Qcm9wZXJ0eShhbClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0IHJvb3ROYW1lKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldEN1c3RvbVByb3BlcnR5KGFsLCB0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXQgX25hbWUodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBsbCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0LmJvdW5kYXJpZXMgJiYgIXQuc3RhcnRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXRyZWUtd2Fsa2VyLW5vLXN0YXJ0LXBvc2l0aW9uOiBOZWl0aGVyIGJvdW5kYXJpZXMgbm9yIHN0YXJ0aW5nIHBvc2l0aW9uIGhhdmUgYmVlbiBkZWZpbmVkLlwiLCBudWxsKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQuZGlyZWN0aW9uICYmIHQuZGlyZWN0aW9uICE9IFwiZm9yd2FyZFwiICYmIHQuZGlyZWN0aW9uICE9IFwiYmFja3dhcmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXRyZWUtd2Fsa2VyLXVua25vd24tZGlyZWN0aW9uOiBPbmx5IGBiYWNrd2FyZGAgYW5kIGBmb3J3YXJkYCBkaXJlY3Rpb24gYWxsb3dlZC5cIiwgdC5zdGFydFBvc2l0aW9uLCB7ZGlyZWN0aW9uOiB0LmRpcmVjdGlvbn0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvdW5kYXJpZXMgPSB0LmJvdW5kYXJpZXMgfHwgbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0LnN0YXJ0UG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZGwuX2NyZWF0ZUF0KHQuc3RhcnRQb3NpdGlvbilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IGRsLl9jcmVhdGVBdCh0LmJvdW5kYXJpZXNbdC5kaXJlY3Rpb24gPT0gXCJiYWNrd2FyZFwiID8gXCJlbmRcIiA6IFwic3RhcnRcIl0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHQuZGlyZWN0aW9uIHx8IFwiZm9yd2FyZFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaW5nbGVDaGFyYWN0ZXJzID0gISF0LnNpbmdsZUNoYXJhY3RlcnM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWxsb3cgPSAhIXQuc2hhbGxvdztcclxuICAgICAgICAgICAgICAgIHRoaXMuaWdub3JlRWxlbWVudEVuZCA9ICEhdC5pZ25vcmVFbGVtZW50RW5kO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRhcnlTdGFydFBhcmVudCA9IHRoaXMuYm91bmRhcmllcyA/IHRoaXMuYm91bmRhcmllcy5zdGFydC5wYXJlbnQgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRhcnlFbmRQYXJlbnQgPSB0aGlzLmJvdW5kYXJpZXMgPyB0aGlzLmJvdW5kYXJpZXMuZW5kLnBhcmVudCA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBza2lwKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlLCBpLCBuO1xyXG4gICAgICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLnBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICh7ZG9uZTogZSwgdmFsdWU6IGl9ID0gdGhpcy5uZXh0KCkpXHJcbiAgICAgICAgICAgICAgICB9IHdoaWxlICghZSAmJiB0KGkpKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5leHQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT0gXCJmb3J3YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbmV4dCgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmV2aW91cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9uZXh0KCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSB0aGlzLnBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5wb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChpLnBhcmVudCA9PT0gbnVsbCAmJiB0Lm9mZnNldCA9PT0gaS5jaGlsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkb25lOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IHRoaXMuX2JvdW5kYXJ5RW5kUGFyZW50ICYmIHQub2Zmc2V0ID09IHRoaXMuYm91bmRhcmllcy5lbmQub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkb25lOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IG47XHJcbiAgICAgICAgICAgICAgICBpZiAoaSBpbnN0YW5jZW9mIExzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXNBdEVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZGwuX2NyZWF0ZUFmdGVyKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbmV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBpLmRhdGFbdC5vZmZzZXRdXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBpLmdldENoaWxkKHQub2Zmc2V0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiB6Yykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zaGFsbG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBuZXcgZGwobiwgMClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9mZnNldCsrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mb3JtYXRSZXR1cm5WYWx1ZShcImVsZW1lbnRTdGFydFwiLCBuLCBlLCB0LCAxKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuIGluc3RhbmNlb2YgTHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaW5nbGVDaGFyYWN0ZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBuZXcgZGwobiwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbmV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSBuLmRhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPT0gdGhpcy5fYm91bmRhcnlFbmRQYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLmJvdW5kYXJpZXMuZW5kLm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBuZXcgRnMobiwgMCwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ID0gZGwuX2NyZWF0ZUFmdGVyKG8pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gbmV3IEZzKG4sIDAsIG4uZGF0YS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vZmZzZXQrK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0UmV0dXJuVmFsdWUoXCJ0ZXh0XCIsIG8sIGUsIHQsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbiA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG47XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2luZ2xlQ2hhcmFjdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gMVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBpID09PSB0aGlzLl9ib3VuZGFyeUVuZFBhcmVudCA/IHRoaXMuYm91bmRhcmllcy5lbmQub2Zmc2V0IDogaS5kYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGUgLSB0Lm9mZnNldFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IEZzKGksIHQub2Zmc2V0LCBuKTtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9mZnNldCArPSBuO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mb3JtYXRSZXR1cm5WYWx1ZShcInRleHRcIiwgbywgZSwgdCwgbilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IGRsLl9jcmVhdGVBZnRlcihpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pZ25vcmVFbGVtZW50RW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9uZXh0KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0UmV0dXJuVmFsdWUoXCJlbGVtZW50RW5kXCIsIGksIGUsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcHJldmlvdXMoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IHRoaXMucG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGkucGFyZW50ID09PSBudWxsICYmIHQub2Zmc2V0ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkb25lOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT0gdGhpcy5fYm91bmRhcnlTdGFydFBhcmVudCAmJiB0Lm9mZnNldCA9PSB0aGlzLmJvdW5kYXJpZXMuc3RhcnQub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkb25lOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IG47XHJcbiAgICAgICAgICAgICAgICBpZiAoaSBpbnN0YW5jZW9mIExzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXNBdFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSBkbC5fY3JlYXRlQmVmb3JlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJldmlvdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuID0gaS5kYXRhW3Qub2Zmc2V0IC0gMV1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IGkuZ2V0Q2hpbGQodC5vZmZzZXQgLSAxKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiB6Yykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zaGFsbG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBuZXcgZGwobiwgbi5jaGlsZENvdW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlnbm9yZUVsZW1lbnRFbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmV2aW91cygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0UmV0dXJuVmFsdWUoXCJlbGVtZW50RW5kXCIsIG4sIGUsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm9mZnNldC0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdFJldHVyblZhbHVlKFwiZWxlbWVudFN0YXJ0XCIsIG4sIGUsIHQsIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuIGluc3RhbmNlb2YgTHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaW5nbGVDaGFyYWN0ZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBuZXcgZGwobiwgbi5kYXRhLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJldmlvdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpID0gbi5kYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuID09IHRoaXMuX2JvdW5kYXJ5U3RhcnRQYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmJvdW5kYXJpZXMuc3RhcnQub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG5ldyBGcyhuLCBlLCBuLmRhdGEubGVuZ3RoIC0gZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gby5kYXRhLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBkbC5fY3JlYXRlQmVmb3JlKG8pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gbmV3IEZzKG4sIDAsIG4uZGF0YS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5vZmZzZXQtLVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0UmV0dXJuVmFsdWUoXCJ0ZXh0XCIsIG8sIGUsIHQsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgbiA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG47XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNpbmdsZUNoYXJhY3RlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGkgPT09IHRoaXMuX2JvdW5kYXJ5U3RhcnRQYXJlbnQgPyB0aGlzLmJvdW5kYXJpZXMuc3RhcnQub2Zmc2V0IDogMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHQub2Zmc2V0IC0gZVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSAxXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHQub2Zmc2V0IC09IG47XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBGcyhpLCB0Lm9mZnNldCwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdFJldHVyblZhbHVlKFwidGV4dFwiLCBvLCBlLCB0LCBuKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gZGwuX2NyZWF0ZUJlZm9yZShpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0UmV0dXJuVmFsdWUoXCJlbGVtZW50U3RhcnRcIiwgaSwgZSwgdCwgMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2Zvcm1hdFJldHVyblZhbHVlKHQsIGUsIGksIG4sIG8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgRnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5vZmZzZXRJblRleHQgKyBlLmRhdGEubGVuZ3RoID09IGUudGV4dE5vZGUuZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uID09IFwiZm9yd2FyZFwiICYmICEodGhpcy5ib3VuZGFyaWVzICYmIHRoaXMuYm91bmRhcmllcy5lbmQuaXNFcXVhbCh0aGlzLnBvc2l0aW9uKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBkbC5fY3JlYXRlQWZ0ZXIoZS50ZXh0Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGRsLl9jcmVhdGVBZnRlcihlLnRleHROb2RlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLm9mZnNldEluVGV4dCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT0gXCJiYWNrd2FyZFwiICYmICEodGhpcy5ib3VuZGFyaWVzICYmIHRoaXMuYm91bmRhcmllcy5zdGFydC5pc0VxdWFsKHRoaXMucG9zaXRpb24pKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGRsLl9jcmVhdGVCZWZvcmUoZS50ZXh0Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGRsLl9jcmVhdGVCZWZvcmUoZS50ZXh0Tm9kZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB7ZG9uZTogZmFsc2UsIHZhbHVlOiB7dHlwZTogdCwgaXRlbTogZSwgcHJldmlvdXNQb3NpdGlvbjogaSwgbmV4dFBvc2l0aW9uOiBuLCBsZW5ndGg6IG99fVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBkbCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50ID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMub2Zmc2V0ID0gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbm9kZUFmdGVyKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0Q2hpbGQodGhpcy5vZmZzZXQpIHx8IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IG5vZGVCZWZvcmUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXRDaGlsZCh0aGlzLm9mZnNldCAtIDEpIHx8IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQXRTdGFydCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZnNldCA9PT0gMFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNBdEVuZCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnBhcmVudC5pcyhcInRleHRcIikgPyB0aGlzLnBhcmVudC5kYXRhLmxlbmd0aCA6IHRoaXMucGFyZW50LmNoaWxkQ291bnQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgPT09IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHJvb3QoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQucm9vdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZWRpdGFibGVFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSB0aGlzLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIHdoaWxlICghKHQgaW5zdGFuY2VvZiBzbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHQucGFyZW50XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRTaGlmdGVkQnkodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGRsLl9jcmVhdGVBdCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLm9mZnNldCArIHQ7XHJcbiAgICAgICAgICAgICAgICBlLm9mZnNldCA9IGkgPCAwID8gMCA6IGk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbih0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGUuc3RhcnRQb3NpdGlvbiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IGxsKGUpO1xyXG4gICAgICAgICAgICAgICAgaS5za2lwKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkucG9zaXRpb25cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0QW5jZXN0b3JzKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzKFwiZG9jdW1lbnRGcmFnbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdGhpcy5wYXJlbnRdXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5nZXRBbmNlc3RvcnMoe2luY2x1ZGVTZWxmOiB0cnVlfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q29tbW9uQW5jZXN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0QW5jZXN0b3JzKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRBbmNlc3RvcnMoKTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChlW25dID09IGlbbl0gJiYgZVtuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4rK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPT09IDAgPyBudWxsIDogZVtuIC0gMV1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJwb3NpdGlvblwiIHx8IHQgPT0gXCJ2aWV3OnBvc2l0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNFcXVhbCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQgPT0gdC5wYXJlbnQgJiYgdGhpcy5vZmZzZXQgPT0gdC5vZmZzZXRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNCZWZvcmUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZVdpdGgodCkgPT0gXCJiZWZvcmVcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0FmdGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmVXaXRoKHQpID09IFwiYWZ0ZXJcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb21wYXJlV2l0aCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb290ICE9PSB0LnJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJkaWZmZXJlbnRcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFcXVhbCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInNhbWVcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMucGFyZW50LmlzKFwibm9kZVwiKSA/IHRoaXMucGFyZW50LmdldFBhdGgoKSA6IFtdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGFyZW50LmlzKFwibm9kZVwiKSA/IHQucGFyZW50LmdldFBhdGgoKSA6IFtdO1xyXG4gICAgICAgICAgICAgICAgZS5wdXNoKHRoaXMub2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgIGkucHVzaCh0Lm9mZnNldCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gVnMoZSwgaSk7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJwcmVmaXhcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYmVmb3JlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwiZXh0ZW5zaW9uXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImFmdGVyXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVbbl0gPCBpW25dID8gXCJiZWZvcmVcIiA6IFwiYWZ0ZXJcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRXYWxrZXIodCA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICB0LnN0YXJ0UG9zaXRpb24gPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBsbCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9uZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZGwodGhpcy5wYXJlbnQsIHRoaXMub2Zmc2V0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgX2NyZWF0ZUF0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgZGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHRoaXModC5wYXJlbnQsIHQub2Zmc2V0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PSBcImVuZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBpLmlzKFwidGV4dFwiKSA/IGkuZGF0YS5sZW5ndGggOiBpLmNoaWxkQ291bnRcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUgPT0gXCJiZWZvcmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlQmVmb3JlKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlID09IFwiYWZ0ZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlQWZ0ZXIoaSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUgIT09IDAgJiYgIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInZpZXctY3JlYXRlUG9zaXRpb25BdC1vZmZzZXQtcmVxdWlyZWQ6IFwiICsgXCJWaWV3I2NyZWF0ZVBvc2l0aW9uQXQoKSByZXF1aXJlcyB0aGUgb2Zmc2V0IHdoZW4gdGhlIGZpcnN0IHBhcmFtZXRlciBpcyBhIHZpZXcgaXRlbS5cIiwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBkbChpLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgX2NyZWF0ZUFmdGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzKFwidGV4dFByb3h5XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBkbCh0LnRleHROb2RlLCB0Lm9mZnNldEluVGV4dCArIHQuZGF0YS5sZW5ndGgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInZpZXctcG9zaXRpb24tYWZ0ZXItcm9vdDogWW91IGNhbiBub3QgbWFrZSBwb3NpdGlvbiBhZnRlciByb290LlwiLCB0LCB7cm9vdDogdH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGRsKHQucGFyZW50LCB0LmluZGV4ICsgMSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9jcmVhdGVCZWZvcmUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJ0ZXh0UHJveHlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGRsKHQudGV4dE5vZGUsIHQub2Zmc2V0SW5UZXh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0LnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXBvc2l0aW9uLWJlZm9yZS1yb290OiBZb3UgY2FuIG5vdCBtYWtlIHBvc2l0aW9uIGJlZm9yZSByb290LlwiLCB0LCB7cm9vdDogdH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGRsKHQucGFyZW50LCB0LmluZGV4KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB1bCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ID0gdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmQgPSBlID8gZS5jbG9uZSgpIDogdC5jbG9uZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCogbmV3IGxsKHtib3VuZGFyaWVzOiB0aGlzLCBpZ25vcmVFbGVtZW50RW5kOiB0cnVlfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQ29sbGFwc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQuaXNFcXVhbCh0aGlzLmVuZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzRmxhdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LnBhcmVudCA9PT0gdGhpcy5lbmQucGFyZW50XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCByb290KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQucm9vdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRFbmxhcmdlZCgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gdGhpcy5zdGFydC5nZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbihobCwge2RpcmVjdGlvbjogXCJiYWNrd2FyZFwifSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHRoaXMuZW5kLmdldExhc3RNYXRjaGluZ1Bvc2l0aW9uKGhsKTtcclxuICAgICAgICAgICAgICAgIGlmICh0LnBhcmVudC5pcyhcInRleHRcIikgJiYgdC5pc0F0U3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gZGwuX2NyZWF0ZUJlZm9yZSh0LnBhcmVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlLnBhcmVudC5pcyhcInRleHRcIikgJiYgZS5pc0F0RW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGRsLl9jcmVhdGVBZnRlcihlLnBhcmVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0VHJpbW1lZCgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gdGhpcy5zdGFydC5nZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbihobCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pc0FmdGVyKHRoaXMuZW5kKSB8fCB0LmlzRXF1YWwodGhpcy5lbmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB1bCh0LCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0aGlzLmVuZC5nZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbihobCwge2RpcmVjdGlvbjogXCJiYWNrd2FyZFwifSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgJiYgaS5pcyhcInRleHRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gbmV3IGRsKGksIDApXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobiAmJiBuLmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBuZXcgZGwobiwgbi5kYXRhLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNFcXVhbCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcyA9PSB0IHx8IHRoaXMuc3RhcnQuaXNFcXVhbCh0LnN0YXJ0KSAmJiB0aGlzLmVuZC5pc0VxdWFsKHQuZW5kKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb250YWluc1Bvc2l0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LmlzQWZ0ZXIodGhpcy5zdGFydCkgJiYgdC5pc0JlZm9yZSh0aGlzLmVuZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29udGFpbnNSYW5nZSh0LCBlID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5jb250YWluc1Bvc2l0aW9uKHQuc3RhcnQpIHx8IGUgJiYgdGhpcy5zdGFydC5pc0VxdWFsKHQuc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuY29udGFpbnNQb3NpdGlvbih0LmVuZCkgfHwgZSAmJiB0aGlzLmVuZC5pc0VxdWFsKHQuZW5kKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpICYmIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0RGlmZmVyZW5jZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0ludGVyc2VjdGluZyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5zUG9zaXRpb24odC5zdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyB1bCh0aGlzLnN0YXJ0LCB0LnN0YXJ0KSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbnNQb3NpdGlvbih0LmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyB1bCh0LmVuZCwgdGhpcy5lbmQpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKHRoaXMuY2xvbmUoKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEludGVyc2VjdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0ludGVyc2VjdGluZyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBlID0gdGhpcy5zdGFydDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IHRoaXMuZW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5zUG9zaXRpb24odC5zdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHQuc3RhcnRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbnNQb3NpdGlvbih0LmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHQuZW5kXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwoZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFdhbGtlcih0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHQuYm91bmRhcmllcyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGxsKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENvbW1vbkFuY2VzdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQuZ2V0Q29tbW9uQW5jZXN0b3IodGhpcy5lbmQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENvbnRhaW5lZEVsZW1lbnQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IHRoaXMuc3RhcnQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0aGlzLmVuZC5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnQucGFyZW50LmlzKFwidGV4dFwiKSAmJiB0aGlzLnN0YXJ0LmlzQXRFbmQgJiYgdGhpcy5zdGFydC5wYXJlbnQubmV4dFNpYmxpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gdGhpcy5zdGFydC5wYXJlbnQubmV4dFNpYmxpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVuZC5wYXJlbnQuaXMoXCJ0ZXh0XCIpICYmIHRoaXMuZW5kLmlzQXRTdGFydCAmJiB0aGlzLmVuZC5wYXJlbnQucHJldmlvdXNTaWJsaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuZW5kLnBhcmVudC5wcmV2aW91c1NpYmxpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0ICYmIHQuaXMoXCJlbGVtZW50XCIpICYmIHQgPT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHVsKHRoaXMuc3RhcnQsIHRoaXMuZW5kKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIGdldEl0ZW1zKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdC5ib3VuZGFyaWVzID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHQuaWdub3JlRWxlbWVudEVuZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IGxsKHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0Lml0ZW1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBnZXRQb3NpdGlvbnModCA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICB0LmJvdW5kYXJpZXMgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBsbCh0KTtcclxuICAgICAgICAgICAgICAgIHlpZWxkIGUucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHQubmV4dFBvc2l0aW9uXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwicmFuZ2VcIiB8fCB0ID09IFwidmlldzpyYW5nZVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzSW50ZXJzZWN0aW5nKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LmlzQmVmb3JlKHQuZW5kKSAmJiB0aGlzLmVuZC5pc0FmdGVyKHQuc3RhcnQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBfY3JlYXRlRnJvbVBhcmVudHNBbmRPZmZzZXRzKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcyhuZXcgZGwodCwgZSksIG5ldyBkbChpLCBuKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldFNoaWZ0ZWRCeShlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlID4gMCA/IG5ldyB0aGlzKGksIG4pIDogbmV3IHRoaXMobiwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9jcmVhdGVJbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlRnJvbVBhcmVudHNBbmRPZmZzZXRzKHQsIDAsIHQsIHQuY2hpbGRDb3VudClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9jcmVhdGVPbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5pcyhcInRleHRQcm94eVwiKSA/IHQub2Zmc2V0U2l6ZSA6IDE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQoZGwuX2NyZWF0ZUJlZm9yZSh0KSwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaGwodCkge1xyXG4gICAgICAgICAgICBpZiAodC5pdGVtLmlzKFwiYXR0cmlidXRlRWxlbWVudFwiKSB8fCB0Lml0ZW0uaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmbCh0KSB7XHJcbiAgICAgICAgICAgIGxldCBlID0gMDtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGUrK1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBnbCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQgPSBudWxsLCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0Zha2UgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Zha2VTZWxlY3Rpb25MYWJlbCA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRvKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpc0Zha2UoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXNGYWtlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBmYWtlU2VsZWN0aW9uTGFiZWwoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmFrZVNlbGVjdGlvbkxhYmVsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBhbmNob3IoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3Jhbmdlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX3Jhbmdlc1t0aGlzLl9yYW5nZXMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fbGFzdFJhbmdlQmFja3dhcmQgPyB0LmVuZCA6IHQuc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5jbG9uZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcmFuZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fcmFuZ2VzW3RoaXMuX3Jhbmdlcy5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA/IHQuc3RhcnQgOiB0LmVuZDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLmNsb25lKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQ29sbGFwc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmFuZ2VDb3VudCA9PT0gMSAmJiB0aGlzLl9yYW5nZXNbMF0uaXNDb2xsYXBzZWRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHJhbmdlQ291bnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmFuZ2VzLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNCYWNrd2FyZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc0NvbGxhcHNlZCAmJiB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZWRpdGFibGVFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5jaG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5jaG9yLmVkaXRhYmxlRWxlbWVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBnZXRSYW5nZXMoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fcmFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdC5jbG9uZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEZpcnN0UmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fcmFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0IHx8IGUuc3RhcnQuaXNCZWZvcmUodC5zdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA/IHQuY2xvbmUoKSA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0TGFzdFJhbmdlKCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX3Jhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdCB8fCBlLmVuZC5pc0FmdGVyKHQuZW5kKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID8gdC5jbG9uZSgpIDogbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRGaXJzdFBvc2l0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0Rmlyc3RSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPyB0LnN0YXJ0LmNsb25lKCkgOiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldExhc3RQb3NpdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmdldExhc3RSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPyB0LmVuZC5jbG9uZSgpIDogbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0VxdWFsKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRmFrZSAhPSB0LmlzRmFrZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNGYWtlICYmIHRoaXMuZmFrZVNlbGVjdGlvbkxhYmVsICE9IHQuZmFrZVNlbGVjdGlvbkxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yYW5nZUNvdW50ICE9IHQucmFuZ2VDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJhbmdlQ291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmFuY2hvci5pc0VxdWFsKHQuYW5jaG9yKSB8fCAhdGhpcy5mb2N1cy5pc0VxdWFsKHQuZm9jdXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fcmFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5fcmFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmlzRXF1YWwobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNTaW1pbGFyKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQmFja3dhcmQgIT0gdC5pc0JhY2t3YXJkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gZmwodGhpcy5nZXRSYW5nZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZmwodC5nZXRSYW5nZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSAhPSBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGUgb2YgdGhpcy5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBlLmdldFRyaW1tZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gb2YgdC5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gbi5nZXRUcmltbWVkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnN0YXJ0LmlzRXF1YWwobi5zdGFydCkgJiYgZS5lbmQuaXNFcXVhbChuLmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U2VsZWN0ZWRFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmFuZ2VDb3VudCAhPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaXJzdFJhbmdlKCkuZ2V0Q29udGFpbmVkRWxlbWVudCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldFRvKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmFuZ2VzKFtdKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRGYWtlT3B0aW9ucyhlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0IGluc3RhbmNlb2YgZ2wgfHwgdCBpbnN0YW5jZW9mIG1sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmFuZ2VzKHQuZ2V0UmFuZ2VzKCksIHQuaXNCYWNrd2FyZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0RmFrZU9wdGlvbnMoe2Zha2U6IHQuaXNGYWtlLCBsYWJlbDogdC5mYWtlU2VsZWN0aW9uTGFiZWx9KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0IGluc3RhbmNlb2YgdWwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXMoW3RdLCBlICYmIGUuYmFja3dhcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldEZha2VPcHRpb25zKGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQgaW5zdGFuY2VvZiBkbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJhbmdlcyhbbmV3IHVsKHQpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0RmFrZU9wdGlvbnMoZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodCBpbnN0YW5jZW9mIHpzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9ICEhaSAmJiAhIWkuYmFja3dhcmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy1zZWxlY3Rpb24tc2V0VG8tcmVxdWlyZWQtc2Vjb25kLXBhcmFtZXRlcjogXCIgKyBcInNlbGVjdGlvbi5zZXRUbyByZXF1aXJlcyB0aGUgc2Vjb25kIHBhcmFtZXRlciB3aGVuIHRoZSBmaXJzdCBwYXJhbWV0ZXIgaXMgYSBub2RlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZSA9PSBcImluXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IHVsLl9jcmVhdGVJbih0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZSA9PSBcIm9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IHVsLl9jcmVhdGVPbih0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBuZXcgdWwoZGwuX2NyZWF0ZUF0KHQsIGUpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXMoW29dLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRGYWtlT3B0aW9ucyhpKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJhbmdlcyh0LCBlICYmIGUuYmFja3dhcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldEZha2VPcHRpb25zKGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXNlbGVjdGlvbi1zZXRUby1ub3Qtc2VsZWN0YWJsZTogQ2Fubm90IHNldCBzZWxlY3Rpb24gdG8gZ2l2ZW4gcGxhY2UuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2VcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0Rm9jdXModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5jaG9yID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInZpZXctc2VsZWN0aW9uLXNldEZvY3VzLW5vLXJhbmdlczogQ2Fubm90IHNldCBzZWxlY3Rpb24gZm9jdXMgaWYgdGhlcmUgYXJlIG5vIHJhbmdlcyBpbiBzZWxlY3Rpb24uXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZGwuX2NyZWF0ZUF0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuY29tcGFyZVdpdGgodGhpcy5mb2N1cykgPT0gXCJzYW1lXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmFuY2hvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jhbmdlcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgIGlmIChpLmNvbXBhcmVXaXRoKG4pID09IFwiYmVmb3JlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRSYW5nZShuZXcgdWwoaSwgbiksIHRydWUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFJhbmdlKG5ldyB1bChuLCBpKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZVwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PSBcInNlbGVjdGlvblwiIHx8IHQgPT0gXCJ2aWV3OnNlbGVjdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRSYW5nZXModCwgZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gQXJyYXkuZnJvbSh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JhbmdlcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRSYW5nZShlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFJhbmdlQmFja3dhcmQgPSAhIWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldEZha2VPcHRpb25zKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXNGYWtlID0gISF0LmZha2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mYWtlU2VsZWN0aW9uTGFiZWwgPSB0LmZha2UgPyB0LmxhYmVsIHx8IFwiXCIgOiBcIlwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hZGRSYW5nZSh0LCBlID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiB1bCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy1zZWxlY3Rpb24tYWRkLXJhbmdlLW5vdC1yYW5nZTogXCIgKyBcIlNlbGVjdGlvbiByYW5nZSBzZXQgdG8gYW4gb2JqZWN0IHRoYXQgaXMgbm90IGFuIGluc3RhbmNlIG9mIHZpZXcuUmFuZ2VcIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3B1c2hSYW5nZSh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID0gISFlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9wdXNoUmFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX3Jhbmdlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmlzSW50ZXJzZWN0aW5nKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXNlbGVjdGlvbi1yYW5nZS1pbnRlcnNlY3RzOiBUcnlpbmcgdG8gYWRkIGEgcmFuZ2UgdGhhdCBpbnRlcnNlY3RzIHdpdGggYW5vdGhlciByYW5nZSBmcm9tIHNlbGVjdGlvbi5cIiwgdGhpcywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWRSYW5nZTogdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVyc2VjdGluZ1JhbmdlOiBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFuZ2VzLnB1c2gobmV3IHVsKHQuc3RhcnQsIHQuZW5kKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoZ2wsIGRzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgbWwge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0ID0gbnVsbCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uID0gbmV3IGdsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLmRlbGVnYXRlKFwiY2hhbmdlXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLnNldFRvKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpc0Zha2UoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmlzRmFrZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZmFrZVNlbGVjdGlvbkxhYmVsKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5mYWtlU2VsZWN0aW9uTGFiZWxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGFuY2hvcigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uYW5jaG9yXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZm9jdXNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQ29sbGFwc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5pc0NvbGxhcHNlZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcmFuZ2VDb3VudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24ucmFuZ2VDb3VudFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNCYWNrd2FyZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uaXNCYWNrd2FyZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZWRpdGFibGVFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5lZGl0YWJsZUVsZW1lbnRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9yYW5nZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLl9yYW5nZXNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBnZXRSYW5nZXMoKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCogdGhpcy5fc2VsZWN0aW9uLmdldFJhbmdlcygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEZpcnN0UmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmdldEZpcnN0UmFuZ2UoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRMYXN0UmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmdldExhc3RSYW5nZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEZpcnN0UG9zaXRpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmdldEZpcnN0UG9zaXRpb24oKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRMYXN0UG9zaXRpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmdldExhc3RQb3NpdGlvbigpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFNlbGVjdGVkRWxlbWVudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRFbGVtZW50KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNFcXVhbCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmlzRXF1YWwodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNTaW1pbGFyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uaXNTaW1pbGFyKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwic2VsZWN0aW9uXCIgfHwgdCA9PSBcImRvY3VtZW50U2VsZWN0aW9uXCIgfHwgdCA9PSBcInZpZXc6c2VsZWN0aW9uXCIgfHwgdCA9PSBcInZpZXc6ZG9jdW1lbnRTZWxlY3Rpb25cIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0VG8odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLnNldFRvKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRGb2N1cyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3Rpb24uc2V0Rm9jdXModCwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMobWwsIGRzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgcGwge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IG5ldyBtbDtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdHMgPSBuZXcgeXMoe2lkUHJvcGVydHk6IFwicm9vdE5hbWVcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZXNQcm9jZXNzb3IgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc1JlYWRPbmx5XCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNGb2N1c2VkXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNDb21wb3NpbmdcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zdEZpeGVycyA9IG5ldyBTZXRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Um9vdCh0ID0gXCJtYWluXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvb3RzLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWdpc3RlclBvc3RGaXhlcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3N0Rml4ZXJzLmFkZCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb290cy5tYXAodCA9PiB0LmRlc3Ryb3koKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2FsbFBvc3RGaXhlcnModCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdGhpcy5fcG9zdEZpeGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gaSh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IHdoaWxlIChlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhwbCwgSmMpO1xyXG4gICAgICAgIGNvbnN0IGJsID0gMTA7XHJcblxyXG4gICAgICAgIGNsYXNzIHdsIGV4dGVuZHMgemMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBlLCBpLCBuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RmlsbGVyT2Zmc2V0ID0ga2w7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcmlvcml0eSA9IGJsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faWQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2xvbmVzR3JvdXAgPSBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBwcmlvcml0eSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmlvcml0eVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaWQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faWRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0RWxlbWVudHNXaXRoU2FtZUlkKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaWQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiYXR0cmlidXRlLWVsZW1lbnQtZ2V0LWVsZW1lbnRzLXdpdGgtc2FtZS1pZC1uby1pZDogXCIgKyBcIkNhbm5vdCBnZXQgZWxlbWVudHMgd2l0aCB0aGUgc2FtZSBpZCBmb3IgYW4gYXR0cmlidXRlIGVsZW1lbnQgd2l0aG91dCBpZC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2V0KHRoaXMuX2Nsb25lc0dyb3VwKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0LCBlID0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQgJiYgdC5yZXBsYWNlKC9edmlldzovLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpID09IFwiYXR0cmlidXRlRWxlbWVudFwiIHx8IHN1cGVyLmlzKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpID09IFwiYXR0cmlidXRlRWxlbWVudFwiICYmIGUgPT0gdGhpcy5uYW1lIHx8IHN1cGVyLmlzKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzU2ltaWxhcih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pZCAhPT0gbnVsbCB8fCB0LmlkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaWQgPT09IHQuaWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5pc1NpbWlsYXIodCkgJiYgdGhpcy5wcmlvcml0eSA9PSB0LnByaW9yaXR5XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbG9uZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gc3VwZXIuX2Nsb25lKHQpO1xyXG4gICAgICAgICAgICAgICAgZS5fcHJpb3JpdHkgPSB0aGlzLl9wcmlvcml0eTtcclxuICAgICAgICAgICAgICAgIGUuX2lkID0gdGhpcy5faWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB3bC5ERUZBVUxUX1BSSU9SSVRZID0gYmw7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGtsKCkge1xyXG4gICAgICAgICAgICBpZiAoX2wodGhpcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IHQgPSB0aGlzLnBhcmVudDtcclxuICAgICAgICAgICAgd2hpbGUgKHQgJiYgdC5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfbCh0KSA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdCA9IHQucGFyZW50XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0IHx8IF9sKHQpID4gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZENvdW50XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfbCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHQuZ2V0Q2hpbGRyZW4oKSkuZmlsdGVyKHQgPT4gIXQuaXMoXCJ1aUVsZW1lbnRcIikpLmxlbmd0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdmwgZXh0ZW5kcyB6YyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIGUsIGksIG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRGaWxsZXJPZmZzZXQgPSB5bFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0LCBlID0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucmVwbGFjZSgvXnZpZXc6LywgXCJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA9PSBcImVtcHR5RWxlbWVudFwiIHx8IHN1cGVyLmlzKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpID09IFwiZW1wdHlFbGVtZW50XCIgJiYgZSA9PSB0aGlzLm5hbWUgfHwgc3VwZXIuaXModCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2luc2VydENoaWxkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlICYmIChlIGluc3RhbmNlb2YgenMgfHwgQXJyYXkuZnJvbShlKS5sZW5ndGggPiAwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LWVtcHR5ZWxlbWVudC1jYW5ub3QtYWRkOiBDYW5ub3QgYWRkIGNoaWxkIG5vZGVzIHRvIEVtcHR5RWxlbWVudCBpbnN0YW5jZS5cIiwgW3RoaXMsIGVdKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB5bCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHhsID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgIGNvbnN0IENsID0ge1xyXG4gICAgICAgICAgICBpc01hYzogVGwoeGwpLFxyXG4gICAgICAgICAgICBpc0VkZ2U6IFBsKHhsKSxcclxuICAgICAgICAgICAgaXNHZWNrbzogU2woeGwpLFxyXG4gICAgICAgICAgICBpc1NhZmFyaTogRWwoeGwpLFxyXG4gICAgICAgICAgICBpc0FuZHJvaWQ6IFJsKHhsKSxcclxuICAgICAgICAgICAgZmVhdHVyZXM6IHtpc1JlZ0V4cFVuaWNvZGVQcm9wZXJ0eVN1cHBvcnRlZDogT2woKX1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBBbCA9IENsO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBUbCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LmluZGV4T2YoXCJtYWNpbnRvc2hcIikgPiAtMVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUGwodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISF0Lm1hdGNoKC9lZGdlXFwvKFxcZCsuP1xcZCopLylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFNsKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhdC5tYXRjaCgvZ2Vja29cXC9cXGQrLylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEVsKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuaW5kZXhPZihcIiBhcHBsZXdlYmtpdC9cIikgPiAtMSAmJiB0LmluZGV4T2YoXCJjaHJvbWVcIikgPT09IC0xXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBSbCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LmluZGV4T2YoXCJhbmRyb2lkXCIpID4gLTFcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE9sKCkge1xyXG4gICAgICAgICAgICBsZXQgdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdCA9IFwixIdcIi5zZWFyY2gobmV3IFJlZ0V4cChcIltcXFxccHtMfV1cIiwgXCJ1XCIpKSA9PT0gMFxyXG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IElsID0ge1wi4oyYXCI6IFwiY3RybFwiLCBcIuKHp1wiOiBcInNoaWZ0XCIsIFwi4oylXCI6IFwiYWx0XCJ9O1xyXG4gICAgICAgIGNvbnN0IFZsID0ge2N0cmw6IFwi4oyYXCIsIHNoaWZ0OiBcIuKHp1wiLCBhbHQ6IFwi4oylXCJ9O1xyXG4gICAgICAgIGNvbnN0IE5sID0gTGwoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTWwodCkge1xyXG4gICAgICAgICAgICBsZXQgZTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGUgPSBObFt0LnRvTG93ZXJDYXNlKCldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImtleWJvYXJkLXVua25vd24ta2V5OiBVbmtub3duIGtleSBuYW1lLlwiLCBudWxsLCB7a2V5OiB0fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGUgPSB0LmtleUNvZGUgKyAodC5hbHRLZXkgPyBObC5hbHQgOiAwKSArICh0LmN0cmxLZXkgPyBObC5jdHJsIDogMCkgKyAodC5zaGlmdEtleSA/IE5sLnNoaWZ0IDogMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQmwodCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdCA9IEZsKHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHQubWFwKHQgPT4gdHlwZW9mIHQgPT0gXCJzdHJpbmdcIiA/IE1sKHQpIDogdCkucmVkdWNlKCh0LCBlKSA9PiBlICsgdCwgMClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHpsKHQpIHtcclxuICAgICAgICAgICAgaWYgKCFBbC5pc01hYykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gRmwodCkubWFwKHQgPT4gVmxbdC50b0xvd2VyQ2FzZSgpXSB8fCB0KS5yZWR1Y2UoKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0LnNsaWNlKC0xKSBpbiBJbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ICsgZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCArIFwiK1wiICsgZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTGwoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHQgPSB7XHJcbiAgICAgICAgICAgICAgICBhcnJvd2xlZnQ6IDM3LFxyXG4gICAgICAgICAgICAgICAgYXJyb3d1cDogMzgsXHJcbiAgICAgICAgICAgICAgICBhcnJvd3JpZ2h0OiAzOSxcclxuICAgICAgICAgICAgICAgIGFycm93ZG93bjogNDAsXHJcbiAgICAgICAgICAgICAgICBiYWNrc3BhY2U6IDgsXHJcbiAgICAgICAgICAgICAgICBkZWxldGU6IDQ2LFxyXG4gICAgICAgICAgICAgICAgZW50ZXI6IDEzLFxyXG4gICAgICAgICAgICAgICAgc3BhY2U6IDMyLFxyXG4gICAgICAgICAgICAgICAgZXNjOiAyNyxcclxuICAgICAgICAgICAgICAgIHRhYjogOSxcclxuICAgICAgICAgICAgICAgIGN0cmw6IDExMTQxMTIsXHJcbiAgICAgICAgICAgICAgICBjbWQ6IDExMTQxMTIsXHJcbiAgICAgICAgICAgICAgICBzaGlmdDogMjIyODIyNCxcclxuICAgICAgICAgICAgICAgIGFsdDogNDQ1NjQ0OFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBmb3IgKGxldCBlID0gNjU7IGUgPD0gOTA7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZSk7XHJcbiAgICAgICAgICAgICAgICB0W2kudG9Mb3dlckNhc2UoKV0gPSBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgZSA9IDQ4OyBlIDw9IDU3OyBlKyspIHtcclxuICAgICAgICAgICAgICAgIHRbZSAtIDQ4XSA9IGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBlID0gMTEyOyBlIDw9IDEyMzsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0W1wiZlwiICsgKGUgLSAxMTEpXSA9IGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRmwodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5zcGxpdCgvXFxzKlxcK1xccyovKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgRGwgZXh0ZW5kcyB6YyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIGUsIGksIG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRGaWxsZXJPZmZzZXQgPSBIbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0LCBlID0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucmVwbGFjZSgvXnZpZXc6LywgXCJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA9PSBcInVpRWxlbWVudFwiIHx8IHN1cGVyLmlzKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpID09IFwidWlFbGVtZW50XCIgJiYgZSA9PSB0aGlzLm5hbWUgfHwgc3VwZXIuaXModCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2luc2VydENoaWxkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlICYmIChlIGluc3RhbmNlb2YgenMgfHwgQXJyYXkuZnJvbShlKS5sZW5ndGggPiAwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXVpZWxlbWVudC1jYW5ub3QtYWRkOiBDYW5ub3QgYWRkIGNoaWxkIG5vZGVzIHRvIFVJRWxlbWVudCBpbnN0YW5jZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVuZGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRvRG9tRWxlbWVudCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0RvbUVsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuY3JlYXRlRWxlbWVudCh0aGlzLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUodCwgdGhpcy5nZXRBdHRyaWJ1dGUodCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBqbCh0KSB7XHJcbiAgICAgICAgICAgIHQuZG9jdW1lbnQub24oXCJrZXlkb3duXCIsIChlLCBpKSA9PiBXbChlLCBpLCB0LmRvbUNvbnZlcnRlcikpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIbCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFdsKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSBObC5hcnJvd3JpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5kb21UYXJnZXQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnJhbmdlQ291bnQgPT0gMSAmJiB0LmdldFJhbmdlQXQoMCkuY29sbGFwc2VkO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gfHwgZS5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmZvY3VzTm9kZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5mb2N1c09mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gaS5kb21Qb3NpdGlvblRvVmlldyhlLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAociA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gci5nZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbih0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXRlbS5pcyhcInVpRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5pdGVtLmlzKFwidWlFbGVtZW50XCIpIHx8IHQuaXRlbS5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGkudmlld1Bvc2l0aW9uVG9Eb20oYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmNvbGxhcHNlKGUucGFyZW50LCBlLm9mZnNldClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuZXh0ZW5kKGUucGFyZW50LCBlLm9mZnNldClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgcWwge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50ID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkcmVuID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydENoaWxkKDAsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuW1N5bWJvbC5pdGVyYXRvcl0oKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgY2hpbGRDb3VudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5sZW5ndGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzRW1wdHkoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jaGlsZENvdW50ID09PSAwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCByb290KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHBhcmVudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwiZG9jdW1lbnRGcmFnbWVudFwiIHx8IHQgPT0gXCJ2aWV3OmRvY3VtZW50RnJhZ21lbnRcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYXBwZW5kQ2hpbGQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luc2VydENoaWxkKHRoaXMuY2hpbGRDb3VudCwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuW3RdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENoaWxkSW5kZXgodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmluZGV4T2YodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGRyZW4oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW5bU3ltYm9sLml0ZXJhdG9yXSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9pbnNlcnRDaGlsZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlQ2hhbmdlKFwiY2hpbGRyZW5cIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gVWwodGhpcy5kb2N1bWVudCwgZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnBhcmVudCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLl9yZW1vdmUoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4uc3BsaWNlKHQsIDAsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQrKztcclxuICAgICAgICAgICAgICAgICAgICBpKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVDaGlsZHJlbih0LCBlID0gMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyZUNoYW5nZShcImNoaWxkcmVuXCIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHQ7IGkgPCB0ICsgZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW5baV0ucGFyZW50ID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLnNwbGljZSh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZmlyZUNoYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6XCIgKyB0LCBlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhxbCwgZHMpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBVbCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBMcyh0LCBlKV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWpzKGUpKSB7XHJcbiAgICAgICAgICAgICAgICBlID0gW2VdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oZSkubWFwKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExzKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMcyh0LCBlLmRhdGEpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgJGwge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50ID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Nsb25lR3JvdXBzID0gbmV3IE1hcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRTZWxlY3Rpb24odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudC5zZWxlY3Rpb24uX3NldFRvKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldFNlbGVjdGlvbkZvY3VzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuc2VsZWN0aW9uLl9zZXRGb2N1cyh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVUZXh0KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTHModGhpcy5kb2N1bWVudCwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlQXR0cmlidXRlRWxlbWVudCh0LCBlLCBpID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgd2wodGhpcy5kb2N1bWVudCwgdCwgZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5wcmlvcml0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4uX3ByaW9yaXR5ID0gaS5wcmlvcml0eVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLl9pZCA9IGkuaWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZUNvbnRhaW5lckVsZW1lbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBqYyh0aGlzLmRvY3VtZW50LCB0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVFZGl0YWJsZUVsZW1lbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBzbCh0aGlzLmRvY3VtZW50LCB0LCBlKTtcclxuICAgICAgICAgICAgICAgIGkuX2RvY3VtZW50ID0gdGhpcy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZUVtcHR5RWxlbWVudCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHZsKHRoaXMuZG9jdW1lbnQsIHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVVJRWxlbWVudCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IERsKHRoaXMuZG9jdW1lbnQsIHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnJlbmRlciA9IGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldEF0dHJpYnV0ZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpLl9zZXRBdHRyaWJ1dGUodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlQXR0cmlidXRlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGUuX3JlbW92ZUF0dHJpYnV0ZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGRDbGFzcyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBlLl9hZGRDbGFzcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW1vdmVDbGFzcyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBlLl9yZW1vdmVDbGFzcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRTdHlsZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoTih0KSAmJiBpID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5fc2V0U3R5bGUodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlU3R5bGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZS5fcmVtb3ZlU3R5bGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0Q3VzdG9tUHJvcGVydHkodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaS5fc2V0Q3VzdG9tUHJvcGVydHkodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlQ3VzdG9tUHJvcGVydHkodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuX3JlbW92ZUN1c3RvbVByb3BlcnR5KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJyZWFrQXR0cmlidXRlcyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIGRsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JyZWFrQXR0cmlidXRlcyh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYnJlYWtBdHRyaWJ1dGVzUmFuZ2UodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYnJlYWtDb250YWluZXIodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlLmlzKFwiY29udGFpbmVyRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXdyaXRlci1icmVhay1ub24tY29udGFpbmVyLWVsZW1lbnQ6IFRyeWluZyB0byBicmVhayBhbiBlbGVtZW50IHdoaWNoIGlzIG5vdCBhIGNvbnRhaW5lciBlbGVtZW50LlwiLCB0aGlzLmRvY3VtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFlLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXdyaXRlci1icmVhay1yb290OiBUcnlpbmcgdG8gYnJlYWsgcm9vdCBlbGVtZW50LlwiLCB0aGlzLmRvY3VtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXNBdFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRsLl9jcmVhdGVCZWZvcmUoZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXQuaXNBdEVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLl9jbG9uZShmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQoZGwuX2NyZWF0ZUFmdGVyKGUpLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IHVsKHQsIGRsLl9jcmVhdGVBdChlLCBcImVuZFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBkbChpLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vdmUobiwgbylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkbC5fY3JlYXRlQWZ0ZXIoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWVyZ2VBdHRyaWJ1dGVzKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm9mZnNldDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChpLmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikgJiYgaS5jaGlsZENvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBpLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgICAgIGkuX3JlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUZyb21DbG9uZWRFbGVtZW50c0dyb3VwKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1lcmdlQXR0cmlidXRlcyhuZXcgZGwodCwgZSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5nZXRDaGlsZChlIC0gMSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5nZXRDaGlsZChlKTtcclxuICAgICAgICAgICAgICAgIGlmICghbiB8fCAhbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobi5pcyhcInRleHRcIikgJiYgby5pcyhcInRleHRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWGwobiwgbylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobi5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikgJiYgby5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikgJiYgbi5pc1NpbWlsYXIobykpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5jaGlsZENvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgIG4uX2FwcGVuZENoaWxkKG8uZ2V0Q2hpbGRyZW4oKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5fcmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUNsb25lZEVsZW1lbnRzR3JvdXAobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWVyZ2VBdHRyaWJ1dGVzKG5ldyBkbChuLCB0KSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1lcmdlQ29udGFpbmVycyh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlIHx8ICFpIHx8ICFlLmlzKFwiY29udGFpbmVyRWxlbWVudFwiKSB8fCAhaS5pcyhcImNvbnRhaW5lckVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy13cml0ZXItbWVyZ2UtY29udGFpbmVycy1pbnZhbGlkLXBvc2l0aW9uOiBcIiArIFwiRWxlbWVudCBiZWZvcmUgYW5kIGFmdGVyIGdpdmVuIHBvc2l0aW9uIGNhbm5vdCBiZSBtZXJnZWQuXCIsIHRoaXMuZG9jdW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5nZXRDaGlsZChlLmNoaWxkQ291bnQgLSAxKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuIGluc3RhbmNlb2YgTHMgPyBkbC5fY3JlYXRlQXQobiwgXCJlbmRcIikgOiBkbC5fY3JlYXRlQXQoZSwgXCJlbmRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmUodWwuX2NyZWF0ZUluKGkpLCBkbC5fY3JlYXRlQXQoZSwgXCJlbmRcIikpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUodWwuX2NyZWF0ZU9uKGkpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluc2VydCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBlID0ganMoZSkgPyBbLi4uZV0gOiBbZV07XHJcbiAgICAgICAgICAgICAgICBabChlLCB0aGlzLmRvY3VtZW50KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBLbCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXdyaXRlci1pbnZhbGlkLXBvc2l0aW9uLWNvbnRhaW5lclwiLCB0aGlzLmRvY3VtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2JyZWFrQXR0cmlidXRlcyh0LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLl9pbnNlcnRDaGlsZChuLm9mZnNldCwgZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFRvQ2xvbmVkRWxlbWVudHNHcm91cCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4uZ2V0U2hpZnRlZEJ5KG8pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMubWVyZ2VBdHRyaWJ1dGVzKG4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8gPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHVsKHMsIHMpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcy5pc0VxdWFsKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIub2Zmc2V0LS1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubWVyZ2VBdHRyaWJ1dGVzKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwocywgdClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0IGluc3RhbmNlb2YgdWwgPyB0IDogdWwuX2NyZWF0ZU9uKHQpO1xyXG4gICAgICAgICAgICAgICAgaWQoZSwgdGhpcy5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcWwodGhpcy5kb2N1bWVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHtzdGFydDogaSwgZW5kOiBufSA9IHRoaXMuX2JyZWFrQXR0cmlidXRlc1JhbmdlKGUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4ub2Zmc2V0IC0gaS5vZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gby5fcmVtb3ZlQ2hpbGRyZW4oaS5vZmZzZXQsIHIpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVGcm9tQ2xvbmVkRWxlbWVudHNHcm91cCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IHRoaXMubWVyZ2VBdHRyaWJ1dGVzKGkpO1xyXG4gICAgICAgICAgICAgICAgZS5zdGFydCA9IGE7XHJcbiAgICAgICAgICAgICAgICBlLmVuZCA9IGEuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgcWwodGhpcy5kb2N1bWVudCwgcylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xlYXIodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWQodCwgdGhpcy5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRXYWxrZXIoe2RpcmVjdGlvbjogXCJiYWNrd2FyZFwiLCBpZ25vcmVFbGVtZW50RW5kOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuLml0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuaXMoXCJlbGVtZW50XCIpICYmIGUuaXNTaW1pbGFyKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB1bC5fY3JlYXRlT24oaSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFuLm5leHRQb3NpdGlvbi5pc0FmdGVyKHQuc3RhcnQpICYmIGkuaXMoXCJ0ZXh0UHJveHlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkuZ2V0QW5jZXN0b3JzKCkuZmluZCh0ID0+IHQuaXMoXCJlbGVtZW50XCIpICYmIGUuaXNTaW1pbGFyKHQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB1bC5fY3JlYXRlSW4odClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5lbmQuaXNBZnRlcih0LmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uZW5kID0gdC5lbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5zdGFydC5pc0JlZm9yZSh0LnN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zdGFydCA9IHQuc3RhcnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZShvKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbW92ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaTtcclxuICAgICAgICAgICAgICAgIGlmIChlLmlzQWZ0ZXIodC5lbmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2JyZWFrQXR0cmlidXRlcyhlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG4uY2hpbGRDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gdGhpcy5fYnJlYWtBdHRyaWJ1dGVzUmFuZ2UodCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IHRoaXMucmVtb3ZlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub2Zmc2V0ICs9IG4uY2hpbGRDb3VudCAtIG9cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IHRoaXMucmVtb3ZlKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbnNlcnQoZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgd3JhcCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIShlIGluc3RhbmNlb2Ygd2wpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInZpZXctd3JpdGVyLXdyYXAtaW52YWxpZC1hdHRyaWJ1dGVcIiwgdGhpcy5kb2N1bWVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlkKHQsIHRoaXMuZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dyYXBSYW5nZSh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IHQuc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkucGFyZW50LmlzKFwiZWxlbWVudFwiKSAmJiAhR2woaS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBpLmdldExhc3RNYXRjaGluZ1Bvc2l0aW9uKHQgPT4gdC5pdGVtLmlzKFwidWlFbGVtZW50XCIpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpID0gdGhpcy5fd3JhcFBvc2l0aW9uKGksIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5pc0NvbGxhcHNlZCAmJiBuLmdldEZpcnN0UG9zaXRpb24oKS5pc0VxdWFsKHQuc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwoaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdW53cmFwKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiB3bCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy13cml0ZXItdW53cmFwLWludmFsaWQtYXR0cmlidXRlXCIsIHRoaXMuZG9jdW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZCh0LCB0aGlzLmRvY3VtZW50KTtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHtzdGFydDogaSwgZW5kOiBufSA9IHRoaXMuX2JyZWFrQXR0cmlidXRlc1JhbmdlKHQsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuX3Vud3JhcENoaWxkcmVuKG8sIGkub2Zmc2V0LCBuLm9mZnNldCwgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gdGhpcy5tZXJnZUF0dHJpYnV0ZXMoci5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXMuaXNFcXVhbChyLnN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHIuZW5kLm9mZnNldC0tXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gdGhpcy5tZXJnZUF0dHJpYnV0ZXMoci5lbmQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB1bChzLCBhKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5hbWUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBqYyh0aGlzLmRvY3VtZW50LCB0LCBlLmdldEF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluc2VydChkbC5fY3JlYXRlQWZ0ZXIoZSksIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlKHVsLl9jcmVhdGVJbihlKSwgZGwuX2NyZWF0ZUF0KGksIDApKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKHVsLl9jcmVhdGVPbihlKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbGVhckNsb25lZEVsZW1lbnRzR3JvdXAodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2xvbmVHcm91cHMuZGVsZXRlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVBvc2l0aW9uQXQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRsLl9jcmVhdGVBdCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkFmdGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkbC5fY3JlYXRlQWZ0ZXIodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUG9zaXRpb25CZWZvcmUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRsLl9jcmVhdGVCZWZvcmUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUmFuZ2UodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB1bCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSYW5nZU9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1bC5fY3JlYXRlT24odClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUmFuZ2VJbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdWwuX2NyZWF0ZUluKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVNlbGVjdGlvbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGdsKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF93cmFwQ2hpbGRyZW4odCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICAgICAgbGV0IG8gPSBlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG8gPCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0Q2hpbGQobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuaXMoXCJ0ZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBlLmlzKFwiYXR0cmlidXRlRWxlbWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gZS5pcyhcImVtcHR5RWxlbWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gZS5pcyhcInVpRWxlbWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocyAmJiB0aGlzLl93cmFwQXR0cmlidXRlRWxlbWVudChuLCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLnB1c2gobmV3IGRsKHQsIG8pKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSB8fCBhIHx8IGMgfHwgcyAmJiBKbChuLCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbi5fY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5fcmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuX2FwcGVuZENoaWxkKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Ll9pbnNlcnRDaGlsZChvLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRkVG9DbG9uZWRFbGVtZW50c0dyb3VwKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLnB1c2gobmV3IGRsKHQsIG8pKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl93cmFwQ2hpbGRyZW4oZSwgMCwgZS5jaGlsZENvdW50LCBuKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBvKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBzID0gMDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vZmZzZXQgLT0gcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5vZmZzZXQgPT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5tZXJnZUF0dHJpYnV0ZXModCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuLmlzRXF1YWwodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLS1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdWwuX2NyZWF0ZUZyb21QYXJlbnRzQW5kT2Zmc2V0cyh0LCBlLCB0LCBpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdW53cmFwQ2hpbGRyZW4odCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICAgICAgbGV0IG8gPSBlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG8gPCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0Q2hpbGQobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmlzKFwiYXR0cmlidXRlRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmlzU2ltaWxhcihuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5nZXRDaGlsZHJlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gZS5jaGlsZENvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLl9yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5faW5zZXJ0Q2hpbGQobywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUZyb21DbG9uZWRFbGVtZW50c0dyb3VwKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLnB1c2gobmV3IGRsKHQsIG8pLCBuZXcgZGwodCwgbyArIHMpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyArPSBzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpICs9IHMgLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fdW53cmFwQXR0cmlidXRlRWxlbWVudChuLCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLnB1c2gobmV3IGRsKHQsIG8pLCBuZXcgZGwodCwgbyArIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91bndyYXBDaGlsZHJlbihlLCAwLCBlLmNoaWxkQ291bnQsIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8rK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9mZnNldCAtPSBzO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lm9mZnNldCA9PSBlIHx8IHQub2Zmc2V0ID09IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMubWVyZ2VBdHRyaWJ1dGVzKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbi5pc0VxdWFsKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS0tXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVsLl9jcmVhdGVGcm9tUGFyZW50c0FuZE9mZnNldHModCwgZSwgdCwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3dyYXBSYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7c3RhcnQ6IGksIGVuZDogbn0gPSB0aGlzLl9icmVha0F0dHJpYnV0ZXNSYW5nZSh0LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLl93cmFwQ2hpbGRyZW4obywgaS5vZmZzZXQsIG4ub2Zmc2V0LCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLm1lcmdlQXR0cmlidXRlcyhyLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgIGlmICghcy5pc0VxdWFsKHIuc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgci5lbmQub2Zmc2V0LS1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSB0aGlzLm1lcmdlQXR0cmlidXRlcyhyLmVuZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHVsKHMsIGEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF93cmFwUG9zaXRpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuaXNTaW1pbGFyKHQucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBZbCh0LmNsb25lKCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5wYXJlbnQuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IFFsKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5jcmVhdGVBdHRyaWJ1dGVFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICBpLl9wcmlvcml0eSA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcclxuICAgICAgICAgICAgICAgIGkuaXNTaW1pbGFyID0gKCkgPT4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0LnBhcmVudC5faW5zZXJ0Q2hpbGQodC5vZmZzZXQsIGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyB1bCh0LCB0LmdldFNoaWZ0ZWRCeSgxKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndyYXAobiwgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IGRsKGkucGFyZW50LCBpLmluZGV4KTtcclxuICAgICAgICAgICAgICAgIGkuX3JlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG8ubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvLm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgIGlmIChyIGluc3RhbmNlb2YgTHMgJiYgcyBpbnN0YW5jZW9mIExzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFhsKHIsIHMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWWwobylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3dyYXBBdHRyaWJ1dGVFbGVtZW50KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghbmQodCwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0Lm5hbWUgIT09IGUubmFtZSB8fCB0LnByaW9yaXR5ICE9PSBlLnByaW9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdC5nZXRBdHRyaWJ1dGVLZXlzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gXCJjbGFzc1wiIHx8IGkgPT09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5oYXNBdHRyaWJ1dGUoaSkgJiYgZS5nZXRBdHRyaWJ1dGUoaSkgIT09IHQuZ2V0QXR0cmlidXRlKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldFN0eWxlTmFtZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmhhc1N0eWxlKGkpICYmIGUuZ2V0U3R5bGUoaSkgIT09IHQuZ2V0U3R5bGUoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IFwiY2xhc3NcIiB8fCBpID09PSBcInN0eWxlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmhhc0F0dHJpYnV0ZShpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShpLCB0LmdldEF0dHJpYnV0ZShpKSwgZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdC5nZXRTdHlsZU5hbWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWUuaGFzU3R5bGUoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdHlsZShpLCB0LmdldFN0eWxlKGkpLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldENsYXNzTmFtZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5oYXNDbGFzcyhpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZENsYXNzKGksIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3Vud3JhcEF0dHJpYnV0ZUVsZW1lbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuZCh0LCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQubmFtZSAhPT0gZS5uYW1lIHx8IHQucHJpb3JpdHkgIT09IGUucHJpb3JpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldEF0dHJpYnV0ZUtleXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSBcImNsYXNzXCIgfHwgaSA9PT0gXCJzdHlsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5oYXNBdHRyaWJ1dGUoaSkgfHwgZS5nZXRBdHRyaWJ1dGUoaSkgIT09IHQuZ2V0QXR0cmlidXRlKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZS5oYXNDbGFzcyguLi50LmdldENsYXNzTmFtZXMoKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldFN0eWxlTmFtZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5oYXNTdHlsZShpKSB8fCBlLmdldFN0eWxlKGkpICE9PSB0LmdldFN0eWxlKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldEF0dHJpYnV0ZUtleXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSBcImNsYXNzXCIgfHwgaSA9PT0gXCJzdHlsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKGksIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNsYXNzKEFycmF5LmZyb20odC5nZXRDbGFzc05hbWVzKCkpLCBlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU3R5bGUoQXJyYXkuZnJvbSh0LmdldFN0eWxlTmFtZXMoKSksIGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2JyZWFrQXR0cmlidXRlc1JhbmdlKHQsIGUgPSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5lbmQ7XHJcbiAgICAgICAgICAgICAgICBpZCh0LCB0aGlzLmRvY3VtZW50KTtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2JyZWFrQXR0cmlidXRlcyh0LnN0YXJ0LCBlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHVsKGksIGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5fYnJlYWtBdHRyaWJ1dGVzKG4sIGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG8ucGFyZW50LmNoaWxkQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gdGhpcy5fYnJlYWtBdHRyaWJ1dGVzKGksIGUpO1xyXG4gICAgICAgICAgICAgICAgby5vZmZzZXQgKz0gby5wYXJlbnQuY2hpbGRDb3VudCAtIHI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHVsKHMsIG8pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9icmVha0F0dHJpYnV0ZXModCwgZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5vZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5wYXJlbnQuaXMoXCJlbXB0eUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy13cml0ZXItY2Fubm90LWJyZWFrLWVtcHR5LWVsZW1lbnRcIiwgdGhpcy5kb2N1bWVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0LnBhcmVudC5pcyhcInVpRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXdyaXRlci1jYW5ub3QtYnJlYWstdWktZWxlbWVudFwiLCB0aGlzLmRvY3VtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFlICYmIG4uaXMoXCJ0ZXh0XCIpICYmIGVkKG4ucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNsb25lKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlZChuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNsb25lKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuLmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9icmVha0F0dHJpYnV0ZXMoUWwodCksIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5jaGlsZENvdW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT0gbykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgZGwobi5wYXJlbnQsIG4uaW5kZXggKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYnJlYWtBdHRyaWJ1dGVzKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgZGwobi5wYXJlbnQsIG4uaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYnJlYWtBdHRyaWJ1dGVzKHQsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG4uaW5kZXggKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5fY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5wYXJlbnQuX2luc2VydENoaWxkKHQsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRUb0Nsb25lZEVsZW1lbnRzR3JvdXAobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmNoaWxkQ291bnQgLSBpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5fcmVtb3ZlQ2hpbGRyZW4oaSwgcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8uX2FwcGVuZENoaWxkKHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gbmV3IGRsKG4ucGFyZW50LCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JyZWFrQXR0cmlidXRlcyhhLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FkZFRvQ2xvbmVkRWxlbWVudHNHcm91cCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQucm9vdC5pcyhcInJvb3RFbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pcyhcImVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5nZXRDaGlsZHJlbigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFRvQ2xvbmVkRWxlbWVudHNHcm91cChlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmlkO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHRoaXMuX2Nsb25lR3JvdXBzLmdldChlKTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb25lR3JvdXBzLnNldChlLCBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICB0Ll9jbG9uZXNHcm91cCA9IGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZUZyb21DbG9uZWRFbGVtZW50c0dyb3VwKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzKFwiZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUNsb25lZEVsZW1lbnRzR3JvdXAoZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5pZDtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2Nsb25lR3JvdXBzLmdldChlKTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5kZWxldGUodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gR2wodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0LmdldENoaWxkcmVuKCkpLnNvbWUodCA9PiAhdC5pcyhcInVpRWxlbWVudFwiKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtsKHQpIHtcclxuICAgICAgICAgICAgbGV0IGUgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgd2hpbGUgKCFlZChlKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZSA9IGUucGFyZW50XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEpsKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKHQucHJpb3JpdHkgPCBlLnByaW9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQucHJpb3JpdHkgPiBlLnByaW9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdC5nZXRJZGVudGl0eSgpIDwgZS5nZXRJZGVudGl0eSgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBZbCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm5vZGVCZWZvcmU7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGUuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGRsKGUsIGUuZGF0YS5sZW5ndGgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgaSA9IHQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICBpZiAoaSAmJiBpLmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBkbChpLCAwKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBRbCh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0Lm9mZnNldCA9PSB0LnBhcmVudC5kYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBkbCh0LnBhcmVudC5wYXJlbnQsIHQucGFyZW50LmluZGV4ICsgMSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5vZmZzZXQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZGwodC5wYXJlbnQucGFyZW50LCB0LnBhcmVudC5pbmRleClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5wYXJlbnQuZGF0YS5zbGljZSh0Lm9mZnNldCk7XHJcbiAgICAgICAgICAgIHQucGFyZW50Ll9kYXRhID0gdC5wYXJlbnQuZGF0YS5zbGljZSgwLCB0Lm9mZnNldCk7XHJcbiAgICAgICAgICAgIHQucGFyZW50LnBhcmVudC5faW5zZXJ0Q2hpbGQodC5wYXJlbnQuaW5kZXggKyAxLCBuZXcgTHModC5yb290LmRvY3VtZW50LCBlKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgZGwodC5wYXJlbnQucGFyZW50LCB0LnBhcmVudC5pbmRleCArIDEpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBYbCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmRhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICB0Ll9kYXRhICs9IGUuZGF0YTtcclxuICAgICAgICAgICAgZS5fcmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgZGwodCwgaSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFpsKHQsIGUpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGQuc29tZSh0ID0+IGkgaW5zdGFuY2VvZiB0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LXdyaXRlci1pbnNlcnQtaW52YWxpZC1ub2RlXCIsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgWmwoaS5nZXRDaGlsZHJlbigpLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB0ZCA9IFtMcywgd2wsIGpjLCB2bCwgRGxdO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBlZCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ICYmICh0LmlzKFwiY29udGFpbmVyRWxlbWVudFwiKSB8fCB0LmlzKFwiZG9jdW1lbnRGcmFnbWVudFwiKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlkKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IEtsKHQuc3RhcnQpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gS2wodC5lbmQpO1xyXG4gICAgICAgICAgICBpZiAoIWkgfHwgIW4gfHwgaSAhPT0gbikge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInZpZXctd3JpdGVyLWludmFsaWQtcmFuZ2UtY29udGFpbmVyXCIsIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG5kKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuaWQgPT09IG51bGwgJiYgZS5pZCA9PT0gbnVsbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb2QodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpID09IFwiW29iamVjdCBUZXh0XVwiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCByZCA9IHQgPT4gdC5jcmVhdGVUZXh0Tm9kZShcIsKgXCIpO1xyXG4gICAgICAgIGNvbnN0IHNkID0gdCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNyZWF0ZUVsZW1lbnQoXCJiclwiKTtcclxuICAgICAgICAgICAgZS5kYXRhc2V0LmNrZUZpbGxlciA9IHRydWU7XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBhZCA9IDc7XHJcbiAgICAgICAgY29uc3QgY2QgPSAoKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdCA9IFwiXCI7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgYWQ7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgdCArPSBcIuKAi1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICB9KSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsZCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvZCh0KSAmJiB0LmRhdGEuc3Vic3RyKDAsIGFkKSA9PT0gY2RcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRkKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuZGF0YS5sZW5ndGggPT0gYWQgJiYgbGQodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVkKHQpIHtcclxuICAgICAgICAgICAgaWYgKGxkKHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5kYXRhLnNsaWNlKGFkKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuZGF0YVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoZCh0KSB7XHJcbiAgICAgICAgICAgIHQuZG9jdW1lbnQub24oXCJrZXlkb3duXCIsIGZkKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmQodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IE5sLmFycm93bGVmdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZG9tVGFyZ2V0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5yYW5nZUNvdW50ID09IDEgJiYgdC5nZXRSYW5nZUF0KDApLmNvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldFJhbmdlQXQoMCkuc3RhcnRDb250YWluZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0UmFuZ2VBdCgwKS5zdGFydE9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGQoZSkgJiYgaSA8PSBhZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmNvbGxhcHNlKGUsIDApXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZCh0LCBlLCBpLCBuID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgaSA9IGkgfHwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09PSBlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0KSkge1xyXG4gICAgICAgICAgICAgICAgdCA9IEFycmF5LmZyb20odClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZSkpIHtcclxuICAgICAgICAgICAgICAgIGUgPSBBcnJheS5mcm9tKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbyA9IG1kKHQsIGUsIGkpO1xyXG4gICAgICAgICAgICByZXR1cm4gbiA/IGtkKG8sIGUubGVuZ3RoKSA6IHdkKGUsIG8pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtZCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBwZCh0LCBlLCBpKTtcclxuICAgICAgICAgICAgaWYgKG4gPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge2ZpcnN0SW5kZXg6IC0xLCBsYXN0SW5kZXhPbGQ6IC0xLCBsYXN0SW5kZXhOZXc6IC0xfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBiZCh0LCBuKTtcclxuICAgICAgICAgICAgY29uc3QgciA9IGJkKGUsIG4pO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gcGQobywgciwgaSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGEgPSB0Lmxlbmd0aCAtIHM7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSBlLmxlbmd0aCAtIHM7XHJcbiAgICAgICAgICAgIHJldHVybiB7Zmlyc3RJbmRleDogbiwgbGFzdEluZGV4T2xkOiBhLCBsYXN0SW5kZXhOZXc6IGN9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBwZCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgTWF0aC5tYXgodC5sZW5ndGgsIGUubGVuZ3RoKTsgbisrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodFtuXSA9PT0gdW5kZWZpbmVkIHx8IGVbbl0gPT09IHVuZGVmaW5lZCB8fCAhaSh0W25dLCBlW25dKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIC0xXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBiZCh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LnNsaWNlKGUpLnJldmVyc2UoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gd2QodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IHtmaXJzdEluZGV4OiBuLCBsYXN0SW5kZXhPbGQ6IG8sIGxhc3RJbmRleE5ldzogcn0gPSBlO1xyXG4gICAgICAgICAgICBpZiAociAtIG4gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBpLnB1c2goe2luZGV4OiBuLCB0eXBlOiBcImluc2VydFwiLCB2YWx1ZXM6IHQuc2xpY2Uobiwgcil9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvIC0gbiA+IDApIHtcclxuICAgICAgICAgICAgICAgIGkucHVzaCh7aW5kZXg6IG4gKyAociAtIG4pLCB0eXBlOiBcImRlbGV0ZVwiLCBob3dNYW55OiBvIC0gbn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGtkKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3Qge2ZpcnN0SW5kZXg6IGksIGxhc3RJbmRleE9sZDogbiwgbGFzdEluZGV4TmV3OiBvfSA9IHQ7XHJcbiAgICAgICAgICAgIGlmIChpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5KGUpLmZpbGwoXCJlcXVhbFwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCByID0gW107XHJcbiAgICAgICAgICAgIGlmIChpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgciA9IHIuY29uY2F0KEFycmF5KGkpLmZpbGwoXCJlcXVhbFwiKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobyAtIGkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByID0gci5jb25jYXQoQXJyYXkobyAtIGkpLmZpbGwoXCJpbnNlcnRcIikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG4gLSBpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgciA9IHIuY29uY2F0KEFycmF5KG4gLSBpKS5maWxsKFwiZGVsZXRlXCIpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvIDwgZSkge1xyXG4gICAgICAgICAgICAgICAgciA9IHIuY29uY2F0KEFycmF5KGUgLSBvKS5maWxsKFwiZXF1YWxcIikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9kKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaSA9IGkgfHwgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09PSBlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGUubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAobiA+IDIwMCB8fCBvID4gMjAwIHx8IG4gKyBvID4gMzAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX2QuZmFzdERpZmYodCwgZSwgaSwgdHJ1ZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgciwgcztcclxuICAgICAgICAgICAgaWYgKG8gPCBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdDtcclxuICAgICAgICAgICAgICAgIHQgPSBlO1xyXG4gICAgICAgICAgICAgICAgZSA9IGk7XHJcbiAgICAgICAgICAgICAgICByID0gXCJkZWxldGVcIjtcclxuICAgICAgICAgICAgICAgIHMgPSBcImluc2VydFwiXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByID0gXCJpbnNlcnRcIjtcclxuICAgICAgICAgICAgICAgIHMgPSBcImRlbGV0ZVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgYSA9IHQubGVuZ3RoO1xyXG4gICAgICAgICAgICBjb25zdCBjID0gZS5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGwgPSBjIC0gYTtcclxuICAgICAgICAgICAgY29uc3QgZCA9IHt9O1xyXG4gICAgICAgICAgICBjb25zdCB1ID0ge307XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBoKG4pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSAodVtuIC0gMV0gIT09IHVuZGVmaW5lZCA/IHVbbiAtIDFdIDogLTEpICsgMTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSB1W24gKyAxXSAhPT0gdW5kZWZpbmVkID8gdVtuICsgMV0gOiAtMTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGggPSBvID4gbCA/IC0xIDogMTtcclxuICAgICAgICAgICAgICAgIGlmIChkW24gKyBoXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRbbl0gPSBkW24gKyBoXS5zbGljZSgwKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFkW25dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZFtuXSA9IFtdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBkW25dLnB1c2gobyA+IGwgPyByIDogcyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZiA9IE1hdGgubWF4KG8sIGwpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGcgPSBmIC0gbjtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChnIDwgYSAmJiBmIDwgYyAmJiBpKHRbZ10sIGVbZl0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZysrO1xyXG4gICAgICAgICAgICAgICAgICAgIGYrKztcclxuICAgICAgICAgICAgICAgICAgICBkW25dLnB1c2goXCJlcXVhbFwiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IGYgPSAwO1xyXG4gICAgICAgICAgICBsZXQgZztcclxuICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgZm9yIChnID0gLWY7IGcgPCBsOyBnKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB1W2ddID0gaChnKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChnID0gbCArIGY7IGcgPiBsOyBnLS0pIHtcclxuICAgICAgICAgICAgICAgICAgICB1W2ddID0gaChnKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdVtsXSA9IGgobCk7XHJcbiAgICAgICAgICAgICAgICBmKytcclxuICAgICAgICAgICAgfSB3aGlsZSAodVtsXSAhPT0gYyk7XHJcbiAgICAgICAgICAgIHJldHVybiBkW2xdLnNsaWNlKDEpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfZC5mYXN0RGlmZiA9IGdkO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiB2ZCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHQuaW5zZXJ0QmVmb3JlKGksIHQuY2hpbGROb2Rlc1tlXSB8fCBudWxsKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24geWQodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5yZW1vdmVDaGlsZCh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB4ZCh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5kZWZhdWx0Vmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgdC5kZWZhdWx0Vmlldy5Eb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm93bmVyRG9jdW1lbnQgJiYgdC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiB0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuTm9kZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgQ2Qge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbURvY3VtZW50cyA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbUNvbnZlcnRlciA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtlZEF0dHJpYnV0ZXMgPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXJrZWRDaGlsZHJlbiA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtlZFRleHRzID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNGb2N1c2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmxpbmVGaWxsZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmFrZVNlbGVjdGlvbkNvbnRhaW5lciA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWFya1RvU3luYyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCA9PT0gXCJ0ZXh0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKGUucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtlZFRleHRzLmFkZChlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20oZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID09PSBcImF0dHJpYnV0ZXNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtlZEF0dHJpYnV0ZXMuYWRkKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ID09PSBcImNoaWxkcmVuXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrZWRDaGlsZHJlbi5hZGQoZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy1yZW5kZXJlci11bmtub3duLXR5cGU6IFVua25vd24gdHlwZSBwYXNzZWQgdG8gUmVuZGVyZXIubWFya1RvU3luYy5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMubWFya2VkQ2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVDaGlsZHJlbk1hcHBpbmdzKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faW5saW5lRmlsbGVyICYmICF0aGlzLl9pc1NlbGVjdGlvbkluSW5saW5lRmlsbGVyKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVJbmxpbmVGaWxsZXIoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lubGluZUZpbGxlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0aGlzLl9nZXRJbmxpbmVGaWxsZXJQb3NpdGlvbigpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX25lZWRzSW5saW5lRmlsbGVyQXRTZWxlY3Rpb24oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0aGlzLnNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrZWRDaGlsZHJlbi5hZGQodC5wYXJlbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5tYXJrZWRBdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQXR0cnModClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLm1hcmtlZENoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQ2hpbGRyZW4oZSwge2lubGluZUZpbGxlclBvc2l0aW9uOiB0fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLm1hcmtlZFRleHRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1hcmtlZENoaWxkcmVuLmhhcyhlLnBhcmVudCkgJiYgdGhpcy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKGUucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVUZXh0KGUsIHtpbmxpbmVGaWxsZXJQb3NpdGlvbjogdH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb21Db252ZXJ0ZXIudmlld1Bvc2l0aW9uVG9Eb20odCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUucGFyZW50Lm93bmVyRG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFsZChlLnBhcmVudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5saW5lRmlsbGVyID0gVGQoaSwgZS5wYXJlbnQsIGUub2Zmc2V0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lubGluZUZpbGxlciA9IGUucGFyZW50XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmxpbmVGaWxsZXIgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtlZFRleHRzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtlZEF0dHJpYnV0ZXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFya2VkQ2hpbGRyZW4uY2xlYXIoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdXBkYXRlQ2hpbGRyZW5NYXBwaW5ncyh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKHQpLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gQXJyYXkuZnJvbSh0aGlzLmRvbUNvbnZlcnRlci52aWV3Q2hpbGRyZW5Ub0RvbSh0LCBlLm93bmVyRG9jdW1lbnQsIHt3aXRoQ2hpbGRyZW46IGZhbHNlfSkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuX2RpZmZOb2RlTGlzdHMoaSwgbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5fZmluZFJlcGxhY2VBY3Rpb25zKG8sIGksIG4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIuaW5kZXhPZihcInJlcGxhY2VcIikgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHtlcXVhbDogMCwgaW5zZXJ0OiAwLCBkZWxldGU6IDB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbyBvZiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID09PSBcInJlcGxhY2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuZXF1YWwgKyBlLmluc2VydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBlLmVxdWFsICsgZS5kZWxldGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gdC5nZXRDaGlsZChvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzICYmICFzLmlzKFwidWlFbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlRWxlbWVudE1hcHBpbmdzKHMsIGlbcl0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZChuW29dKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuZXF1YWwrK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZVtvXSsrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVFbGVtZW50TWFwcGluZ3ModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21Db252ZXJ0ZXIudW5iaW5kRG9tRWxlbWVudChlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tQ29udmVydGVyLmJpbmRFbGVtZW50cyhlLCB0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFya2VkQ2hpbGRyZW4uYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXJrZWRBdHRyaWJ1dGVzLmFkZCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0SW5saW5lRmlsbGVyUG9zaXRpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zZWxlY3Rpb24uZ2V0Rmlyc3RQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQucGFyZW50LmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkbC5fY3JlYXRlQmVmb3JlKHRoaXMuc2VsZWN0aW9uLmdldEZpcnN0UG9zaXRpb24oKS5wYXJlbnQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9pc1NlbGVjdGlvbkluSW5saW5lRmlsbGVyKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uLnJhbmdlQ291bnQgIT0gMSB8fCAhdGhpcy5zZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb21Db252ZXJ0ZXIudmlld1Bvc2l0aW9uVG9Eb20odCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSAmJiBvZChlLnBhcmVudCkgJiYgbGQoZS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlSW5saW5lRmlsbGVyKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX2lubGluZUZpbGxlcjtcclxuICAgICAgICAgICAgICAgIGlmICghbGQodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidmlldy1yZW5kZXJlci1maWxsZXItd2FzLWxvc3Q6IFRoZSBpbmxpbmUgZmlsbGVyIG5vZGUgd2FzIGxvc3QuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGQodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5kYXRhID0gdC5kYXRhLnN1YnN0cihhZClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2lubGluZUZpbGxlciA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX25lZWRzSW5saW5lRmlsbGVyQXRTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb24ucmFuZ2VDb3VudCAhPSAxIHx8ICF0aGlzLnNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc2VsZWN0aW9uLmdldEZpcnN0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0Lm9mZnNldDtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKGUucm9vdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZS5pcyhcImVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghQWQoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpID09PSBlLmdldEZpbGxlck9mZnNldCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBMcyB8fCBvIGluc3RhbmNlb2YgTHMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVUZXh0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmRvbUNvbnZlcnRlci5maW5kQ29ycmVzcG9uZGluZ0RvbVRleHQodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5kb21Db252ZXJ0ZXIudmlld1RvRG9tKHQsIGkub3duZXJEb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgbGV0IHIgPSBuLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS5pbmxpbmVGaWxsZXJQb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmIChzICYmIHMucGFyZW50ID09IHQucGFyZW50ICYmIHMub2Zmc2V0ID09IHQuaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gY2QgKyByXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobyAhPSByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGdkKG8sIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT09IFwiaW5zZXJ0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuaW5zZXJ0RGF0YShlLmluZGV4LCBlLnZhbHVlcy5qb2luKFwiXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5kZWxldGVEYXRhKGUuaW5kZXgsIGUuaG93TWFueSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZUF0dHJzKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20odCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBBcnJheS5mcm9tKGUuYXR0cmlidXRlcykubWFwKHQgPT4gdC5uYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldEF0dHJpYnV0ZUtleXMoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoaSwgdC5nZXRBdHRyaWJ1dGUoaSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdC5oYXNBdHRyaWJ1dGUobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5yZW1vdmVBdHRyaWJ1dGUobilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVDaGlsZHJlbih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5pbmxpbmVGaWxsZXJQb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20odCkuY2hpbGROb2RlcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBBcnJheS5mcm9tKHRoaXMuZG9tQ29udmVydGVyLnZpZXdDaGlsZHJlblRvRG9tKHQsIGkub3duZXJEb2N1bWVudCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbmQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaW5saW5lRmlsbGVyUG9zaXRpb246IG5cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGlmIChuICYmIG4ucGFyZW50ID09PSB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGQoaS5vd25lckRvY3VtZW50LCByLCBuLm9mZnNldClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLl9kaWZmTm9kZUxpc3RzKG8sIHIpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGEgPSAwO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID09PSBcImRlbGV0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMuYWRkKG9bYV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5ZChvW2FdKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodCA9PT0gXCJlcXVhbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGErK1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGEgPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZChpLCBhLCByW2FdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYSsrXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ID09PSBcImVxdWFsXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya0Rlc2NlbmRhbnRUZXh0VG9TeW5jKHRoaXMuZG9tQ29udmVydGVyLmRvbVRvVmlldyhyW2FdKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGErK1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Db252ZXJ0ZXIudW5iaW5kRG9tRWxlbWVudCh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2RpZmZOb2RlTGlzdHModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdCA9IFJkKHQsIHRoaXMuX2Zha2VTZWxlY3Rpb25Db250YWluZXIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIF9kKHQsIGUsIFNkLmJpbmQobnVsbCwgdGhpcy5kb21Db252ZXJ0ZXIpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZmluZFJlcGxhY2VBY3Rpb25zKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmluZGV4T2YoXCJpbnNlcnRcIikgPT09IC0xIHx8IHQuaW5kZXhPZihcImRlbGV0ZVwiKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBbXTtcclxuICAgICAgICAgICAgICAgIGxldCBvID0gW107XHJcbiAgICAgICAgICAgICAgICBsZXQgciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHtlcXVhbDogMCwgaW5zZXJ0OiAwLCBkZWxldGU6IDB9O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBhIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYSA9PT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLnB1c2goaVtzLmVxdWFsICsgcy5pbnNlcnRdKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYSA9PT0gXCJkZWxldGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLnB1c2goZVtzLmVxdWFsICsgcy5kZWxldGVdKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBuLmNvbmNhdChfZChvLCByLCBQZCkubWFwKHQgPT4gdCA9PT0gXCJlcXVhbFwiID8gXCJyZXBsYWNlXCIgOiB0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ucHVzaChcImVxdWFsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBbXVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzW2FdKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuLmNvbmNhdChfZChvLCByLCBQZCkubWFwKHQgPT4gdCA9PT0gXCJlcXVhbFwiID8gXCJyZXBsYWNlXCIgOiB0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21hcmtEZXNjZW5kYW50VGV4dFRvU3luYyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0LmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFya2VkVGV4dHMuYWRkKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuaXMoXCJlbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrRGVzY2VuZGFudFRleHRUb1N5bmMoZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb24ucmFuZ2VDb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZURvbVNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUZha2VTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20odGhpcy5zZWxlY3Rpb24uZWRpdGFibGVFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0ZvY3VzZWQgfHwgIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbi5pc0Zha2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVGYWtlU2VsZWN0aW9uKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUZha2VTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVEb21TZWxlY3Rpb24odClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZUZha2VTZWxlY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQub3duZXJEb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fZmFrZVNlbGVjdGlvbkNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Zha2VTZWxlY3Rpb25Db250YWluZXIgPSBPZChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2Zha2VTZWxlY3Rpb25Db250YWluZXI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbUNvbnZlcnRlci5iaW5kRmFrZVNlbGVjdGlvbihpLCB0aGlzLnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2Zha2VTZWxlY3Rpb25OZWVkc1VwZGF0ZSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFpLnBhcmVudEVsZW1lbnQgfHwgaS5wYXJlbnRFbGVtZW50ICE9IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmFwcGVuZENoaWxkKGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpLnRleHRDb250ZW50ID0gdGhpcy5zZWxlY3Rpb24uZmFrZVNlbGVjdGlvbkxhYmVsIHx8IFwiwqBcIjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuY3JlYXRlUmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIG4ucmVtb3ZlQWxsUmFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICBvLnNlbGVjdE5vZGVDb250ZW50cyhpKTtcclxuICAgICAgICAgICAgICAgIG4uYWRkUmFuZ2UobylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZURvbVNlbGVjdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kb21TZWxlY3Rpb25OZWVkc1VwZGF0ZShlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZG9tQ29udmVydGVyLnZpZXdQb3NpdGlvblRvRG9tKHRoaXMuc2VsZWN0aW9uLmFuY2hvcik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5kb21Db252ZXJ0ZXIudmlld1Bvc2l0aW9uVG9Eb20odGhpcy5zZWxlY3Rpb24uZm9jdXMpO1xyXG4gICAgICAgICAgICAgICAgdC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgZS5jb2xsYXBzZShpLnBhcmVudCwgaS5vZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgZS5leHRlbmQobi5wYXJlbnQsIG4ub2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgIGlmIChBbC5pc0dlY2tvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRWQobiwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2RvbVNlbGVjdGlvbk5lZWRzVXBkYXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5kb21Db252ZXJ0ZXIuaXNEb21TZWxlY3Rpb25Db3JyZWN0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0ICYmIHRoaXMuZG9tQ29udmVydGVyLmRvbVNlbGVjdGlvblRvVmlldyh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChlICYmIHRoaXMuc2VsZWN0aW9uLmlzRXF1YWwoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZWxlY3Rpb24uaXNDb2xsYXBzZWQgJiYgdGhpcy5zZWxlY3Rpb24uaXNTaW1pbGFyKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZmFrZVNlbGVjdGlvbk5lZWRzVXBkYXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9mYWtlU2VsZWN0aW9uQ29udGFpbmVyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQub3duZXJEb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSB8fCBlLnBhcmVudEVsZW1lbnQgIT09IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkuYW5jaG9yTm9kZSAhPT0gZSAmJiAhZS5jb250YWlucyhpLmFuY2hvck5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlLnRleHRDb250ZW50ICE9PSB0aGlzLnNlbGVjdGlvbi5mYWtlU2VsZWN0aW9uTGFiZWxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZURvbVNlbGVjdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLmRvbURvY3VtZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnJhbmdlQ291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuYWN0aXZlRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZG9tQ29udmVydGVyLm1hcERvbVRvVmlldyhlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgJiYgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlRmFrZVNlbGVjdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9mYWtlU2VsZWN0aW9uQ29udGFpbmVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVGb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRm9jdXNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnNlbGVjdGlvbi5lZGl0YWJsZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Db252ZXJ0ZXIuZm9jdXModClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKENkLCBKYyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEFkKHQpIHtcclxuICAgICAgICAgICAgaWYgKHQuZ2V0QXR0cmlidXRlKFwiY29udGVudGVkaXRhYmxlXCIpID09IFwiZmFsc2VcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZmluZEFuY2VzdG9yKHQgPT4gdC5oYXNBdHRyaWJ1dGUoXCJjb250ZW50ZWRpdGFibGVcIikpO1xyXG4gICAgICAgICAgICByZXR1cm4gIWUgfHwgZS5nZXRBdHRyaWJ1dGUoXCJjb250ZW50ZWRpdGFibGVcIikgPT0gXCJ0cnVlXCJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFRkKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUgaW5zdGFuY2VvZiBBcnJheSA/IGUgOiBlLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuW2ldO1xyXG4gICAgICAgICAgICBpZiAob2QobykpIHtcclxuICAgICAgICAgICAgICAgIG8uZGF0YSA9IGNkICsgby5kYXRhO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0LmNyZWF0ZVRleHROb2RlKGNkKTtcclxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5zcGxpY2UoaSwgMCwgbylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmQoZSwgaSwgbylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFBkKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHhkKHQpICYmIHhkKGUpICYmICFvZCh0KSAmJiAhb2QoZSkgJiYgdC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09IGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBTZCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmIChlID09PSBpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG9kKGUpICYmIG9kKGkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5kYXRhID09PSBpLmRhdGFcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0LmlzQmxvY2tGaWxsZXIoZSkgJiYgdC5pc0Jsb2NrRmlsbGVyKGkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRWQodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGlmIChpLm5vZGVUeXBlICE9IE5vZGUuRUxFTUVOVF9OT0RFIHx8IHQub2Zmc2V0ICE9IGkuY2hpbGROb2Rlcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBuID0gaS5jaGlsZE5vZGVzW3Qub2Zmc2V0XTtcclxuICAgICAgICAgICAgaWYgKG4gJiYgbi50YWdOYW1lID09IFwiQlJcIikge1xyXG4gICAgICAgICAgICAgICAgZS5hZGRSYW5nZShlLmdldFJhbmdlQXQoMCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFJkKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IEFycmF5LmZyb20odCk7XHJcbiAgICAgICAgICAgIGlmIChpLmxlbmd0aCA9PSAwIHx8ICFlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpW2kubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmIChuID09IGUpIHtcclxuICAgICAgICAgICAgICAgIGkucG9wKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gT2QodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGUuc3R5bGUsIHtwb3NpdGlvbjogXCJmaXhlZFwiLCB0b3A6IDAsIGxlZnQ6IFwiLTk5OTlweFwiLCB3aWR0aDogXCI0MnB4XCJ9KTtcclxuICAgICAgICAgICAgZS50ZXh0Q29udGVudCA9IFwiwqBcIjtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBJZCA9IHt3aW5kb3c6IHdpbmRvdywgZG9jdW1lbnQ6IGRvY3VtZW50fTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVmQodCkge1xyXG4gICAgICAgICAgICBsZXQgZSA9IDA7XHJcbiAgICAgICAgICAgIHdoaWxlICh0LnByZXZpb3VzU2libGluZykge1xyXG4gICAgICAgICAgICAgICAgdCA9IHQucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgZSsrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5kKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xyXG4gICAgICAgICAgICB3aGlsZSAodCAmJiB0Lm5vZGVUeXBlICE9IE5vZGUuRE9DVU1FTlRfTk9ERSkge1xyXG4gICAgICAgICAgICAgICAgZS51bnNoaWZ0KHQpO1xyXG4gICAgICAgICAgICAgICAgdCA9IHQucGFyZW50Tm9kZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBNZCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBOZCh0KTtcclxuICAgICAgICAgICAgY29uc3QgbiA9IE5kKGUpO1xyXG4gICAgICAgICAgICBsZXQgbyA9IDA7XHJcbiAgICAgICAgICAgIHdoaWxlIChpW29dID09IG5bb10gJiYgaVtvXSkge1xyXG4gICAgICAgICAgICAgICAgbysrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG8gPT09IDAgPyBudWxsIDogaVtvIC0gMV1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IEJkID0gc2QoZG9jdW1lbnQpO1xyXG5cclxuICAgICAgICBjbGFzcyB6ZCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudCA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrRmlsbGVyTW9kZSA9IGUuYmxvY2tGaWxsZXJNb2RlIHx8IFwiYnJcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJlRWxlbWVudHMgPSBbXCJwcmVcIl07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsb2NrRWxlbWVudHMgPSBbXCJwXCIsIFwiZGl2XCIsIFwiaDFcIiwgXCJoMlwiLCBcImgzXCIsIFwiaDRcIiwgXCJoNVwiLCBcImg2XCIsIFwibGlcIiwgXCJkZFwiLCBcImR0XCIsIFwiZmlnY2FwdGlvblwiXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Jsb2NrRmlsbGVyID0gdGhpcy5ibG9ja0ZpbGxlck1vZGUgPT0gXCJiclwiID8gc2QgOiByZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RvbVRvVmlld01hcHBpbmcgPSBuZXcgV2Vha01hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdUb0RvbU1hcHBpbmcgPSBuZXcgV2Vha01hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Zha2VTZWxlY3Rpb25NYXBwaW5nID0gbmV3IFdlYWtNYXBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYmluZEZha2VTZWxlY3Rpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmFrZVNlbGVjdGlvbk1hcHBpbmcuc2V0KHQsIG5ldyBnbChlKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZmFrZVNlbGVjdGlvblRvVmlldyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmFrZVNlbGVjdGlvbk1hcHBpbmcuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJpbmRFbGVtZW50cyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kb21Ub1ZpZXdNYXBwaW5nLnNldCh0LCBlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdUb0RvbU1hcHBpbmcuc2V0KGUsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVuYmluZERvbUVsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX2RvbVRvVmlld01hcHBpbmcuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb21Ub1ZpZXdNYXBwaW5nLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92aWV3VG9Eb21NYXBwaW5nLmRlbGV0ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgQXJyYXkuZnJvbSh0LmNoaWxkTm9kZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudW5iaW5kRG9tRWxlbWVudChlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYmluZERvY3VtZW50RnJhZ21lbnRzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RvbVRvVmlld01hcHBpbmcuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvRG9tTWFwcGluZy5zZXQoZSwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmlld1RvRG9tKHQsIGUsIGkgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3Byb2Nlc3NEYXRhRnJvbVZpZXdUZXh0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmNyZWF0ZVRleHROb2RlKGkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hcFZpZXdUb0RvbSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYXBWaWV3VG9Eb20odClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG47XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJkb2N1bWVudEZyYWdtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBlLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkuYmluZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iaW5kRG9jdW1lbnRGcmFnbWVudHMobiwgdClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5pcyhcInVpRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gdC5yZW5kZXIoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLmJpbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZEVsZW1lbnRzKG4sIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5oYXNBdHRyaWJ1dGUoXCJ4bWxuc1wiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGUuY3JlYXRlRWxlbWVudE5TKHQuZ2V0QXR0cmlidXRlKFwieG1sbnNcIiksIHQubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBlLmNyZWF0ZUVsZW1lbnQodC5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLmJpbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZEVsZW1lbnRzKG4sIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldEF0dHJpYnV0ZShlLCB0LmdldEF0dHJpYnV0ZShlKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaS53aXRoQ2hpbGRyZW4gfHwgaS53aXRoQ2hpbGRyZW4gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG8gb2YgdGhpcy52aWV3Q2hpbGRyZW5Ub0RvbSh0LCBlLCBpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5hcHBlbmRDaGlsZChvKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogdmlld0NoaWxkcmVuVG9Eb20odCwgZSwgaSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5nZXRGaWxsZXJPZmZzZXQgJiYgdC5nZXRGaWxsZXJPZmZzZXQoKTtcclxuICAgICAgICAgICAgICAgIGxldCBvID0gMDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiB0LmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobiA9PT0gbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLl9ibG9ja0ZpbGxlcihlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLnZpZXdUb0RvbShyLCBlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICBvKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuID09PSBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy5fYmxvY2tGaWxsZXIoZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdmlld1JhbmdlVG9Eb20odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudmlld1Bvc2l0aW9uVG9Eb20odC5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy52aWV3UG9zaXRpb25Ub0RvbSh0LmVuZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIG4uc2V0U3RhcnQoZS5wYXJlbnQsIGUub2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgIG4uc2V0RW5kKGkucGFyZW50LCBpLm9mZnNldCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2aWV3UG9zaXRpb25Ub0RvbSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5pcyhcInRleHRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5maW5kQ29ycmVzcG9uZGluZ0RvbVRleHQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuID0gdC5vZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxkKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gKz0gYWRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtwYXJlbnQ6IGksIG9mZnNldDogbn1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGksIG4sIG87XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLm1hcFZpZXdUb0RvbShlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBpLmNoaWxkTm9kZXNbMF1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gZS5pcyhcInRleHRcIikgPyB0aGlzLmZpbmRDb3JyZXNwb25kaW5nRG9tVGV4dChlKSA6IHRoaXMubWFwVmlld1RvRG9tKHQubm9kZUJlZm9yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gbi5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gbi5uZXh0U2libGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob2QobykgJiYgbGQobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtwYXJlbnQ6IG8sIG9mZnNldDogYWR9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuID8gVmQobikgKyAxIDogMDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3BhcmVudDogaSwgb2Zmc2V0OiByfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkb21Ub1ZpZXcodCwgZSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0Jsb2NrRmlsbGVyKHQsIHRoaXMuYmxvY2tGaWxsZXJNb2RlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRQYXJlbnRVSUVsZW1lbnQodCwgdGhpcy5fZG9tVG9WaWV3TWFwcGluZyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAob2QodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGQodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fcHJvY2Vzc0RhdGFGcm9tRG9tVGV4dCh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPT09IFwiXCIgPyBudWxsIDogbmV3IExzKHRoaXMuZG9jdW1lbnQsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzQ29tbWVudCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1hcERvbVRvVmlldyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYXBEb21Ub1ZpZXcodClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNEb2N1bWVudEZyYWdtZW50KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBuZXcgcWwodGhpcy5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmJpbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZERvY3VtZW50RnJhZ21lbnRzKHQsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5rZWVwT3JpZ2luYWxDYXNlID8gdC50YWdOYW1lIDogdC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBuZXcgemModGhpcy5kb2N1bWVudCwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmJpbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZEVsZW1lbnRzKHQsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHQuYXR0cmlidXRlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCA9IG8ubGVuZ3RoIC0gMTsgdCA+PSAwOyB0LS0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuX3NldEF0dHJpYnV0ZShvW3RdLm5hbWUsIG9bdF0udmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUud2l0aENoaWxkcmVuIHx8IGUud2l0aENoaWxkcmVuID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuZG9tQ2hpbGRyZW5Ub1ZpZXcodCwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuX2FwcGVuZENoaWxkKG4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBkb21DaGlsZHJlblRvVmlldyh0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdC5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuY2hpbGROb2Rlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5kb21Ub1ZpZXcobiwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgb1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZG9tU2VsZWN0aW9uVG9WaWV3KHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LnJhbmdlQ291bnQgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IHQuZ2V0UmFuZ2VBdCgwKS5zdGFydENvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2QoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGUucGFyZW50Tm9kZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5mYWtlU2VsZWN0aW9uVG9WaWV3KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuaXNEb21TZWxlY3Rpb25CYWNrd2FyZCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdC5yYW5nZUNvdW50OyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5nZXRSYW5nZUF0KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmRvbVJhbmdlVG9WaWV3KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChvKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZ2woaSwge2JhY2t3YXJkOiBlfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZG9tUmFuZ2VUb1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9tUG9zaXRpb25Ub1ZpZXcodC5zdGFydENvbnRhaW5lciwgdC5zdGFydE9mZnNldCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5kb21Qb3NpdGlvblRvVmlldyh0LmVuZENvbnRhaW5lciwgdC5lbmRPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgJiYgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwoZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRvbVBvc2l0aW9uVG9WaWV3KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQmxvY2tGaWxsZXIodCwgdGhpcy5ibG9ja0ZpbGxlck1vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9tUG9zaXRpb25Ub1ZpZXcodC5wYXJlbnROb2RlLCBWZCh0KSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLm1hcERvbVRvVmlldyh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChpICYmIGkuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGwuX2NyZWF0ZUJlZm9yZShpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG9kKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRkKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRvbVBvc2l0aW9uVG9WaWV3KHQucGFyZW50Tm9kZSwgVmQodCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmZpbmRDb3JyZXNwb25kaW5nVmlld1RleHQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG4gPSBlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobGQodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiAtPSBhZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IG4gPCAwID8gMCA6IG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBkbChpLCBuKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5tYXBEb21Ub1ZpZXcodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGRsKGUsIDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jaGlsZE5vZGVzW2UgLSAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IG9kKGkpID8gdGhpcy5maW5kQ29ycmVzcG9uZGluZ1ZpZXdUZXh0KGkpIDogdGhpcy5tYXBEb21Ub1ZpZXcoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuICYmIG4ucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGRsKG4ucGFyZW50LCBuLmluZGV4ICsgMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtYXBEb21Ub1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UGFyZW50VUlFbGVtZW50KHQpIHx8IHRoaXMuX2RvbVRvVmlld01hcHBpbmcuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZpbmRDb3JyZXNwb25kaW5nVmlld1RleHQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRkKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmdldFBhcmVudFVJRWxlbWVudCh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnByZXZpb3VzU2libGluZztcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzRWxlbWVudChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5tYXBEb21Ub1ZpZXcoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubmV4dFNpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgTHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0Lm5leHRTaWJsaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5tYXBEb21Ub1ZpZXcodC5wYXJlbnROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5nZXRDaGlsZCgwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBMcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtYXBWaWV3VG9Eb20odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdUb0RvbU1hcHBpbmcuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZpbmRDb3JyZXNwb25kaW5nRG9tVGV4dCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5wcmV2aW91c1NpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSAmJiB0aGlzLm1hcFZpZXdUb0RvbShlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hcFZpZXdUb0RvbShlKS5uZXh0U2libGluZ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFlICYmIHQucGFyZW50ICYmIHRoaXMubWFwVmlld1RvRG9tKHQucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hcFZpZXdUb0RvbSh0LnBhcmVudCkuY2hpbGROb2Rlc1swXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMubWFwVmlld1RvRG9tKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgJiYgZS5vd25lckRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB7c2Nyb2xsWDogdCwgc2Nyb2xsWTogaX0gPSBJZC53aW5kb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIEZkKGUsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7c2Nyb2xsTGVmdDogZSwgc2Nyb2xsVG9wOiBpfSA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ucHVzaChbZSwgaV0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIEZkKGUsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbZSwgaV0gPSBuLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2Nyb2xsTGVmdCA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2Nyb2xsVG9wID0gaVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIElkLndpbmRvdy5zY3JvbGxUbyh0LCBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0VsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5ub2RlVHlwZSA9PSBOb2RlLkVMRU1FTlRfTk9ERVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0RvY3VtZW50RnJhZ21lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5ub2RlVHlwZSA9PSBOb2RlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNDb21tZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ICYmIHQubm9kZVR5cGUgPT0gTm9kZS5DT01NRU5UX05PREVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNCbG9ja0ZpbGxlcih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ibG9ja0ZpbGxlck1vZGUgPT0gXCJiclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuaXNFcXVhbE5vZGUoQmQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC50YWdOYW1lID09PSBcIkJSXCIgJiYgamQodCwgdGhpcy5ibG9ja0VsZW1lbnRzKSAmJiB0LnBhcmVudE5vZGUuY2hpbGROb2Rlcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERkKHQsIHRoaXMuYmxvY2tFbGVtZW50cylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNEb21TZWxlY3Rpb25CYWNrd2FyZCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICBlLnNldFN0YXJ0KHQuYW5jaG9yTm9kZSwgdC5hbmNob3JPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgZS5zZXRFbmQodC5mb2N1c05vZGUsIHQuZm9jdXNPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuY29sbGFwc2VkO1xyXG4gICAgICAgICAgICAgICAgZS5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFBhcmVudFVJRWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gTmQodCk7XHJcbiAgICAgICAgICAgICAgICBlLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2RvbVRvVmlld01hcHBpbmcuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpICYmIGkuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0RvbVNlbGVjdGlvbkNvcnJlY3QodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzRG9tU2VsZWN0aW9uUG9zaXRpb25Db3JyZWN0KHQuYW5jaG9yTm9kZSwgdC5hbmNob3JPZmZzZXQpICYmIHRoaXMuX2lzRG9tU2VsZWN0aW9uUG9zaXRpb25Db3JyZWN0KHQuZm9jdXNOb2RlLCB0LmZvY3VzT2Zmc2V0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaXNEb21TZWxlY3Rpb25Qb3NpdGlvbkNvcnJlY3QodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG9kKHQpICYmIGxkKHQpICYmIGUgPCBhZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFbGVtZW50KHQpICYmIGxkKHQuY2hpbGROb2Rlc1tlXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLm1hcERvbVRvVmlldyh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChpICYmIGkuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9wcm9jZXNzRGF0YUZyb21WaWV3VGV4dCh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHQuZGF0YTtcclxuICAgICAgICAgICAgICAgIGlmICh0LmdldEFuY2VzdG9ycygpLnNvbWUodCA9PiB0aGlzLnByZUVsZW1lbnRzLmluY2x1ZGVzKHQubmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlLmNoYXJBdCgwKSA9PSBcIiBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9nZXRUb3VjaGluZ1ZpZXdUZXh0Tm9kZSh0LCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkgJiYgdGhpcy5fbm9kZUVuZHNXaXRoU3BhY2UoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gfHwgIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IFwiwqBcIiArIGUuc3Vic3RyKDEpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUuY2hhckF0KGUubGVuZ3RoIC0gMSkgPT0gXCIgXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fZ2V0VG91Y2hpbmdWaWV3VGV4dE5vZGUodCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY2hhckF0KGUubGVuZ3RoIC0gMikgPT0gXCIgXCIgfHwgIWkgfHwgaS5kYXRhLmNoYXJBdCgwKSA9PSBcIiBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gZS5zdWJzdHIoMCwgZS5sZW5ndGggLSAxKSArIFwiwqBcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlLnJlcGxhY2UoLyB7Mn0vZywgXCIgwqBcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX25vZGVFbmRzV2l0aFNwYWNlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmdldEFuY2VzdG9ycygpLnNvbWUodCA9PiB0aGlzLnByZUVsZW1lbnRzLmluY2x1ZGVzKHQubmFtZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fcHJvY2Vzc0RhdGFGcm9tVmlld1RleHQodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5jaGFyQXQoZS5sZW5ndGggLSAxKSA9PSBcIiBcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcHJvY2Vzc0RhdGFGcm9tRG9tVGV4dCh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHQuZGF0YTtcclxuICAgICAgICAgICAgICAgIGlmIChMZCh0LCB0aGlzLnByZUVsZW1lbnRzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1ZCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZSA9IGUucmVwbGFjZSgvWyBcXG5cXHRcXHJdezEsfS9nLCBcIiBcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fZ2V0VG91Y2hpbmdJbmxpbmVEb21Ob2RlKHQsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9nZXRUb3VjaGluZ0lubGluZURvbU5vZGUodCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5fY2hlY2tTaG91bGRMZWZ0VHJpbURvbVRleHQoaSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5fY2hlY2tTaG91bGRSaWdodFRyaW1Eb21UZXh0KHQsIG4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gZS5yZXBsYWNlKC9eIC8sIFwiXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBlLnJlcGxhY2UoLyAkLywgXCJcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUgPSB1ZChuZXcgVGV4dChlKSk7XHJcbiAgICAgICAgICAgICAgICBlID0gZS5yZXBsYWNlKC8gXFx1MDBBMC9nLCBcIiAgXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKC8oIHxcXHUwMEEwKVxcdTAwQTAkLy50ZXN0KGUpIHx8ICFuIHx8IG4uZGF0YSAmJiBuLmRhdGEuY2hhckF0KDApID09IFwiIFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGUucmVwbGFjZSgvXFx1MDBBMCQvLCBcIiBcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGUucmVwbGFjZSgvXlxcdTAwQTAvLCBcIiBcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jaGVja1Nob3VsZExlZnRUcmltRG9tVGV4dCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKEtyKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAvW15cXFNcXHUwMEEwXS8udGVzdCh0LmRhdGEuY2hhckF0KHQuZGF0YS5sZW5ndGggLSAxKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NoZWNrU2hvdWxkUmlnaHRUcmltRG9tVGV4dCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFsZCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VG91Y2hpbmdWaWV3VGV4dE5vZGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBsbCh7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRQb3NpdGlvbjogZSA/IGRsLl9jcmVhdGVBZnRlcih0KSA6IGRsLl9jcmVhdGVCZWZvcmUodCksXHJcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBlID8gXCJmb3J3YXJkXCIgOiBcImJhY2t3YXJkXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5pdGVtLmlzKFwiY29udGFpbmVyRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5pdGVtLmlzKFwiYnJcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuaXRlbS5pcyhcInRleHRQcm94eVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5pdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRvdWNoaW5nSW5saW5lRG9tTm9kZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZSA/IFwibmV4dE5vZGVcIiA6IFwicHJldmlvdXNOb2RlXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5vd25lckRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IE5kKHQpWzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4uY3JlYXRlVHJlZVdhbGtlcihvLCBOb2RlRmlsdGVyLlNIT1dfVEVYVCB8IE5vZGVGaWx0ZXIuU0hPV19FTEVNRU5ULCB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjZXB0Tm9kZSh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvZCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vZGVGaWx0ZXIuRklMVEVSX0FDQ0VQVFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnRhZ05hbWUgPT0gXCJCUlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZUZpbHRlci5GSUxURVJfQUNDRVBUXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vZGVGaWx0ZXIuRklMVEVSX1NLSVBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHIuY3VycmVudE5vZGUgPSB0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHJbaV0oKTtcclxuICAgICAgICAgICAgICAgIGlmIChzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IE1kKHQsIHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlICYmICFMZCh0LCB0aGlzLmJsb2NrRWxlbWVudHMsIGUpICYmICFMZChzLCB0aGlzLmJsb2NrRWxlbWVudHMsIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTGQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBsZXQgbiA9IE5kKHQpO1xyXG4gICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgbiA9IG4uc2xpY2Uobi5pbmRleE9mKGkpICsgMSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbi5zb21lKHQgPT4gdC50YWdOYW1lICYmIGUuaW5jbHVkZXModC50YWdOYW1lLnRvTG93ZXJDYXNlKCkpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRmQodCwgZSkge1xyXG4gICAgICAgICAgICB3aGlsZSAodCAmJiB0ICE9IElkLmRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBlKHQpO1xyXG4gICAgICAgICAgICAgICAgdCA9IHQucGFyZW50Tm9kZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBEZCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBvZCh0KSAmJiB0LmRhdGEgPT0gXCLCoFwiO1xyXG4gICAgICAgICAgICByZXR1cm4gaSAmJiBqZCh0LCBlKSAmJiB0LnBhcmVudE5vZGUuY2hpbGROb2Rlcy5sZW5ndGggPT09IDFcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGpkKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQucGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgcmV0dXJuIGkgJiYgaS50YWdOYW1lICYmIGUuaW5jbHVkZXMoaS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIZCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KHQpO1xyXG4gICAgICAgICAgICBpZiAoZSA9PSBcIltvYmplY3QgV2luZG93XVwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlID09IFwiW29iamVjdCBnbG9iYWxdXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBXZCA9IHFjKHt9LCBkcywge1xyXG4gICAgICAgICAgICBsaXN0ZW5Ubyh0LCAuLi5lKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoeGQodCkgfHwgSGQodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fZ2V0UHJveHlFbWl0dGVyKHQpIHx8IG5ldyBVZCh0KTtcclxuICAgICAgICAgICAgICAgICAgICBpLmF0dGFjaCguLi5lKTtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gaVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZHMubGlzdGVuVG8uY2FsbCh0aGlzLCB0LCAuLi5lKVxyXG4gICAgICAgICAgICB9LCBzdG9wTGlzdGVuaW5nKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh4ZCh0KSB8fCBIZCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9nZXRQcm94eUVtaXR0ZXIodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ID0gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZHMuc3RvcExpc3RlbmluZy5jYWxsKHRoaXMsIHQsIGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBVZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZGV0YWNoKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIF9nZXRQcm94eUVtaXR0ZXIodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzKHRoaXMsICRkKHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIHFkID0gV2Q7XHJcblxyXG4gICAgICAgIGNsYXNzIFVkIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgaHModGhpcywgJGQodCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9tTm9kZSA9IHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcWMoVWQucHJvdG90eXBlLCBkcywge1xyXG4gICAgICAgICAgICBhdHRhY2godCwgZSwgaSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZG9tTGlzdGVuZXJzICYmIHRoaXMuX2RvbUxpc3RlbmVyc1t0XSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2NyZWF0ZURvbUxpc3RlbmVyKHQsICEhaS51c2VDYXB0dXJlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RvbU5vZGUuYWRkRXZlbnRMaXN0ZW5lcih0LCBuLCAhIWkudXNlQ2FwdHVyZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2RvbUxpc3RlbmVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvbUxpc3RlbmVycyA9IHt9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kb21MaXN0ZW5lcnNbdF0gPSBuXHJcbiAgICAgICAgICAgIH0sIGRldGFjaCh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kb21MaXN0ZW5lcnNbdF0gJiYgKCEoZSA9IHRoaXMuX2V2ZW50c1t0XSkgfHwgIWUuY2FsbGJhY2tzLmxlbmd0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb21MaXN0ZW5lcnNbdF0ucmVtb3ZlTGlzdGVuZXIoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBfY3JlYXRlRG9tTGlzdGVuZXIodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZSh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGkucmVtb3ZlTGlzdGVuZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9tTm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsIGksIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9kb21MaXN0ZW5lcnNbdF1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uICRkKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRbXCJkYXRhLWNrLWV4cGFuZG9cIl0gfHwgKHRbXCJkYXRhLWNrLWV4cGFuZG9cIl0gPSBpcygpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgR2Qge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudCA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGVuYWJsZSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkaXNhYmxlKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhHZCwgcWQpO1xyXG4gICAgICAgIHZhciBLZCA9IFwiX19sb2Rhc2hfaGFzaF91bmRlZmluZWRfX1wiO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBKZCh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19kYXRhX18uc2V0KHQsIEtkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBZZCA9IEpkO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBRZCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9fZGF0YV9fLmhhcyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFhkID0gUWQ7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFpkKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAtMSwgaSA9IHQgPT0gbnVsbCA/IDAgOiB0Lmxlbmd0aDtcclxuICAgICAgICAgICAgdGhpcy5fX2RhdGFfXyA9IG5ldyBfZTtcclxuICAgICAgICAgICAgd2hpbGUgKCsrZSA8IGkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkKHRbZV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFpkLnByb3RvdHlwZS5hZGQgPSBaZC5wcm90b3R5cGUucHVzaCA9IFlkO1xyXG4gICAgICAgIFpkLnByb3RvdHlwZS5oYXMgPSBYZDtcclxuICAgICAgICB2YXIgdHUgPSBaZDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXUodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IC0xLCBuID0gdCA9PSBudWxsID8gMCA6IHQubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoKytpIDwgbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUodFtpXSwgaSwgdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGl1ID0gZXU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG51KHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuaGFzKGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgb3UgPSBudTtcclxuICAgICAgICB2YXIgcnUgPSAxLCBzdSA9IDI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGF1KHQsIGUsIGksIG4sIG8sIHIpIHtcclxuICAgICAgICAgICAgdmFyIHMgPSBpICYgcnUsIGEgPSB0Lmxlbmd0aCwgYyA9IGUubGVuZ3RoO1xyXG4gICAgICAgICAgICBpZiAoYSAhPSBjICYmICEocyAmJiBjID4gYSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBsID0gci5nZXQodCk7XHJcbiAgICAgICAgICAgIGlmIChsICYmIHIuZ2V0KGUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbCA9PSBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGQgPSAtMSwgdSA9IHRydWUsIGggPSBpICYgc3UgPyBuZXcgdHUgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHIuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICByLnNldChlLCB0KTtcclxuICAgICAgICAgICAgd2hpbGUgKCsrZCA8IGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmID0gdFtkXSwgZyA9IGVbZF07XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtID0gcyA/IG4oZywgZiwgZCwgZSwgdCwgcikgOiBuKGYsIGcsIGQsIHQsIGUsIHIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXUoZSwgKGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb3UoaCwgZSkgJiYgKGYgPT09IHQgfHwgbyhmLCB0LCBpLCBuLCByKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoLnB1c2goZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghKGYgPT09IGcgfHwgbyhmLCBnLCBpLCBuLCByKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB1ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByW1wiZGVsZXRlXCJdKHQpO1xyXG4gICAgICAgICAgICByW1wiZGVsZXRlXCJdKGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gdVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGN1ID0gYXU7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGx1KHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAtMSwgaSA9IEFycmF5KHQuc2l6ZSk7XHJcbiAgICAgICAgICAgIHQuZm9yRWFjaCgoZnVuY3Rpb24gKHQsIG4pIHtcclxuICAgICAgICAgICAgICAgIGlbKytlXSA9IFtuLCB0XVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZHUgPSBsdTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXUodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IC0xLCBpID0gQXJyYXkodC5zaXplKTtcclxuICAgICAgICAgICAgdC5mb3JFYWNoKChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgaVsrK2VdID0gdFxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaHUgPSB1dTtcclxuICAgICAgICB2YXIgZnUgPSAxLCBndSA9IDI7XHJcbiAgICAgICAgdmFyIG11ID0gXCJbb2JqZWN0IEJvb2xlYW5dXCIsIHB1ID0gXCJbb2JqZWN0IERhdGVdXCIsIGJ1ID0gXCJbb2JqZWN0IEVycm9yXVwiLCB3dSA9IFwiW29iamVjdCBNYXBdXCIsXHJcbiAgICAgICAgICAgIGt1ID0gXCJbb2JqZWN0IE51bWJlcl1cIiwgX3UgPSBcIltvYmplY3QgUmVnRXhwXVwiLCB2dSA9IFwiW29iamVjdCBTZXRdXCIsIHl1ID0gXCJbb2JqZWN0IFN0cmluZ11cIixcclxuICAgICAgICAgICAgeHUgPSBcIltvYmplY3QgU3ltYm9sXVwiO1xyXG4gICAgICAgIHZhciBDdSA9IFwiW29iamVjdCBBcnJheUJ1ZmZlcl1cIiwgQXUgPSBcIltvYmplY3QgRGF0YVZpZXddXCI7XHJcbiAgICAgICAgdmFyIFR1ID0gciA/IHIucHJvdG90eXBlIDogdW5kZWZpbmVkLCBQdSA9IFR1ID8gVHUudmFsdWVPZiA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gU3UodCwgZSwgaSwgbiwgbywgciwgcykge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGkpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgQXU6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuYnl0ZUxlbmd0aCAhPSBlLmJ5dGVMZW5ndGggfHwgdC5ieXRlT2Zmc2V0ICE9IGUuYnl0ZU9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHQuYnVmZmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBlLmJ1ZmZlcjtcclxuICAgICAgICAgICAgICAgIGNhc2UgQ3U6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuYnl0ZUxlbmd0aCAhPSBlLmJ5dGVMZW5ndGggfHwgIXIobmV3IGZvKHQpLCBuZXcgZm8oZSkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgbXU6XHJcbiAgICAgICAgICAgICAgICBjYXNlIHB1OlxyXG4gICAgICAgICAgICAgICAgY2FzZSBrdTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTCgrdCwgK2UpO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBidTpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5uYW1lID09IGUubmFtZSAmJiB0Lm1lc3NhZ2UgPT0gZS5tZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBfdTpcclxuICAgICAgICAgICAgICAgIGNhc2UgeXU6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gZSArIFwiXCI7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHd1OlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gZHU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHZ1OlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gbiAmIGZ1O1xyXG4gICAgICAgICAgICAgICAgICAgIGEgfHwgKGEgPSBodSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuc2l6ZSAhPSBlLnNpemUgJiYgIWMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0gcy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGwgPT0gZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuIHw9IGd1O1xyXG4gICAgICAgICAgICAgICAgICAgIHMuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkID0gY3UoYSh0KSwgYShlKSwgbiwgbywgciwgcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc1tcImRlbGV0ZVwiXSh0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZDtcclxuICAgICAgICAgICAgICAgIGNhc2UgeHU6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFB1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQdS5jYWxsKHQpID09IFB1LmNhbGwoZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgRXUgPSBTdTtcclxuICAgICAgICB2YXIgUnUgPSAxO1xyXG4gICAgICAgIHZhciBPdSA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIEl1ID0gT3UuaGFzT3duUHJvcGVydHk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFZ1KHQsIGUsIGksIG4sIG8sIHIpIHtcclxuICAgICAgICAgICAgdmFyIHMgPSBpICYgUnUsIGEgPSB6bih0KSwgYyA9IGEubGVuZ3RoLCBsID0gem4oZSksIGQgPSBsLmxlbmd0aDtcclxuICAgICAgICAgICAgaWYgKGMgIT0gZCAmJiAhcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHUgPSBjO1xyXG4gICAgICAgICAgICB3aGlsZSAodS0tKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaCA9IGFbdV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIShzID8gaCBpbiBlIDogSXUuY2FsbChlLCBoKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgZiA9IHIuZ2V0KHQpO1xyXG4gICAgICAgICAgICBpZiAoZiAmJiByLmdldChlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGYgPT0gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBnID0gdHJ1ZTtcclxuICAgICAgICAgICAgci5zZXQodCwgZSk7XHJcbiAgICAgICAgICAgIHIuc2V0KGUsIHQpO1xyXG4gICAgICAgICAgICB2YXIgbSA9IHM7XHJcbiAgICAgICAgICAgIHdoaWxlICgrK3UgPCBjKSB7XHJcbiAgICAgICAgICAgICAgICBoID0gYVt1XTtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gdFtoXSwgYiA9IGVbaF07XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB3ID0gcyA/IG4oYiwgcCwgaCwgZSwgdCwgcikgOiBuKHAsIGIsIGgsIHQsIGUsIHIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoISh3ID09PSB1bmRlZmluZWQgPyBwID09PSBiIHx8IG8ocCwgYiwgaSwgbiwgcikgOiB3KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbSB8fCAobSA9IGggPT0gXCJjb25zdHJ1Y3RvclwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChnICYmICFtKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgayA9IHQuY29uc3RydWN0b3IsIF8gPSBlLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgICAgICAgICAgaWYgKGsgIT0gXyAmJiAoXCJjb25zdHJ1Y3RvclwiIGluIHQgJiYgXCJjb25zdHJ1Y3RvclwiIGluIGUpICYmICEodHlwZW9mIGsgPT0gXCJmdW5jdGlvblwiICYmIGsgaW5zdGFuY2VvZiBrICYmIHR5cGVvZiBfID09IFwiZnVuY3Rpb25cIiAmJiBfIGluc3RhbmNlb2YgXykpIHtcclxuICAgICAgICAgICAgICAgICAgICBnID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByW1wiZGVsZXRlXCJdKHQpO1xyXG4gICAgICAgICAgICByW1wiZGVsZXRlXCJdKGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZ1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIE51ID0gVnU7XHJcbiAgICAgICAgdmFyIE11ID0gMTtcclxuICAgICAgICB2YXIgQnUgPSBcIltvYmplY3QgQXJndW1lbnRzXVwiLCB6dSA9IFwiW29iamVjdCBBcnJheV1cIiwgTHUgPSBcIltvYmplY3QgT2JqZWN0XVwiO1xyXG4gICAgICAgIHZhciBGdSA9IE9iamVjdC5wcm90b3R5cGU7XHJcbiAgICAgICAgdmFyIER1ID0gRnUuaGFzT3duUHJvcGVydHk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGp1KHQsIGUsIGksIG4sIG8sIHIpIHtcclxuICAgICAgICAgICAgdmFyIHMgPSBKZSh0KSwgYSA9IEplKGUpLCBjID0gcyA/IHp1IDogc28odCksIGwgPSBhID8genUgOiBzbyhlKTtcclxuICAgICAgICAgICAgYyA9IGMgPT0gQnUgPyBMdSA6IGM7XHJcbiAgICAgICAgICAgIGwgPSBsID09IEJ1ID8gTHUgOiBsO1xyXG4gICAgICAgICAgICB2YXIgZCA9IGMgPT0gTHUsIHUgPSBsID09IEx1LCBoID0gYyA9PSBsO1xyXG4gICAgICAgICAgICBpZiAoaCAmJiBPYmplY3QoWWVbXCJhXCJdKSh0KSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFPYmplY3QoWWVbXCJhXCJdKShlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBkID0gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaCAmJiAhZCkge1xyXG4gICAgICAgICAgICAgICAgciB8fCAociA9IG5ldyBBZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcyB8fCBCaSh0KSA/IGN1KHQsIGUsIGksIG4sIG8sIHIpIDogRXUodCwgZSwgYywgaSwgbiwgbywgcilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIShpICYgTXUpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZiA9IGQgJiYgRHUuY2FsbCh0LCBcIl9fd3JhcHBlZF9fXCIpLCBnID0gdSAmJiBEdS5jYWxsKGUsIFwiX193cmFwcGVkX19cIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZiB8fCBnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG0gPSBmID8gdC52YWx1ZSgpIDogdCwgcCA9IGcgPyBlLnZhbHVlKCkgOiBlO1xyXG4gICAgICAgICAgICAgICAgICAgIHIgfHwgKHIgPSBuZXcgQWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvKG0sIHAsIGksIG4sIHIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByIHx8IChyID0gbmV3IEFlKTtcclxuICAgICAgICAgICAgcmV0dXJuIE51KHQsIGUsIGksIG4sIG8sIHIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgSHUgPSBqdTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gV3UodCwgZSwgaSwgbiwgbykge1xyXG4gICAgICAgICAgICBpZiAodCA9PT0gZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodCA9PSBudWxsIHx8IGUgPT0gbnVsbCB8fCAhVCh0KSAmJiAhVChlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgIT09IHQgJiYgZSAhPT0gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBIdSh0LCBlLCBpLCBuLCBXdSwgbylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBxdSA9IFd1O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBVdSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGkgPSB0eXBlb2YgaSA9PSBcImZ1bmN0aW9uXCIgPyBpIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB2YXIgbiA9IGkgPyBpKHQsIGUpIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICByZXR1cm4gbiA9PT0gdW5kZWZpbmVkID8gcXUodCwgZSwgdW5kZWZpbmVkLCBpKSA6ICEhblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyICR1ID0gVXU7XHJcblxyXG4gICAgICAgIGNsYXNzIEd1IGV4dGVuZHMgR2Qge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbmZpZyA9IHtjaGlsZExpc3Q6IHRydWUsIGNoYXJhY3RlckRhdGE6IHRydWUsIGNoYXJhY3RlckRhdGFPbGRWYWx1ZTogdHJ1ZSwgc3VidHJlZTogdHJ1ZX07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbUNvbnZlcnRlciA9IHQuZG9tQ29udmVydGVyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlciA9IHQuX3JlbmRlcmVyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9tRWxlbWVudHMgPSBbXTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX211dGF0aW9uT2JzZXJ2ZXIgPSBuZXcgd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIodGhpcy5fb25NdXRhdGlvbnMuYmluZCh0aGlzKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZmx1c2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vbk11dGF0aW9ucyh0aGlzLl9tdXRhdGlvbk9ic2VydmVyLnRha2VSZWNvcmRzKCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9ic2VydmUodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9tRWxlbWVudHMucHVzaCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX211dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZSh0LCB0aGlzLl9jb25maWcpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGVuYWJsZSgpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLmVuYWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX2RvbUVsZW1lbnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKHQsIHRoaXMuX2NvbmZpZylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGlzYWJsZSgpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLmRpc2FibGUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX211dGF0aW9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfb25NdXRhdGlvbnModCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb21Db252ZXJ0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaS50eXBlID09PSBcImNoaWxkTGlzdFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLm1hcERvbVRvVmlldyhpLnRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIHQuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgIXRoaXMuX2lzQm9ndXNCck11dGF0aW9uKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmFkZCh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBvIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5tYXBEb21Ub1ZpZXcoby50YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIHQuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8udHlwZSA9PT0gXCJjaGFyYWN0ZXJEYXRhXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZmluZENvcnJlc3BvbmRpbmdWaWV3VGV4dChvLnRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ICYmICFuLmhhcyh0LnBhcmVudCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0KHQsIHt0eXBlOiBcInRleHRcIiwgb2xkVGV4dDogdC5kYXRhLCBuZXdUZXh0OiB1ZChvLnRhcmdldCksIG5vZGU6IHR9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF0ICYmIGxkKG8udGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5hZGQoZS5tYXBEb21Ub1ZpZXcoby50YXJnZXQucGFyZW50Tm9kZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaS52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIubWFya1RvU3luYyhcInRleHRcIiwgdC5ub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBvLnB1c2godClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUubWFwVmlld1RvRG9tKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBBcnJheS5mcm9tKHQuZ2V0Q2hpbGRyZW4oKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IEFycmF5LmZyb20oZS5kb21DaGlsZHJlblRvVmlldyhpLCB7d2l0aENoaWxkcmVuOiBmYWxzZX0pKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISR1KG4sIHIsIGEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIubWFya1RvU3luYyhcImNoaWxkcmVuXCIsIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLnB1c2goe3R5cGU6IFwiY2hpbGRyZW5cIiwgb2xkQ2hpbGRyZW46IG4sIG5ld0NoaWxkcmVuOiByLCBub2RlOiB0fSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdFswXS50YXJnZXQub3duZXJEb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGxldCBzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChyICYmIHIuYW5jaG9yTm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLmRvbVBvc2l0aW9uVG9WaWV3KHIuYW5jaG9yTm9kZSwgci5hbmNob3JPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvbVBvc2l0aW9uVG9WaWV3KHIuZm9jdXNOb2RlLCByLmZvY3VzT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBuZXcgZ2wodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMuc2V0Rm9jdXMoaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoby5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmZpcmUoXCJtdXRhdGlvbnNcIiwgbywgcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmZvcmNlUmVuZGVyKClcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuaXMoXCJ0ZXh0XCIpICYmIGUuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmRhdGEgPT09IGUuZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2lzQm9ndXNCck11dGF0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0Lm5leHRTaWJsaW5nID09PSBudWxsICYmIHQucmVtb3ZlZE5vZGVzLmxlbmd0aCA9PT0gMCAmJiB0LmFkZGVkTm9kZXMubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5kb21Db252ZXJ0ZXIuZG9tVG9WaWV3KHQuYWRkZWROb2Rlc1swXSwge3dpdGhDaGlsZHJlbjogZmFsc2V9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUgJiYgZS5pcyhcImVsZW1lbnRcIiwgXCJiclwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBLdSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldyA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50ID0gdC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnQgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21UYXJnZXQgPSBlLnRhcmdldDtcclxuICAgICAgICAgICAgICAgIHFjKHRoaXMsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCB0YXJnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52aWV3LmRvbUNvbnZlcnRlci5tYXBEb21Ub1ZpZXcodGhpcy5kb21UYXJnZXQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHByZXZlbnREZWZhdWx0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0b3BQcm9wYWdhdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnQuc3RvcFByb3BhZ2F0aW9uKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgSnUgZXh0ZW5kcyBHZCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51c2VDYXB0dXJlID0gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb2JzZXJ2ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHlwZW9mIHRoaXMuZG9tRXZlbnRUeXBlID09IFwic3RyaW5nXCIgPyBbdGhpcy5kb21FdmVudFR5cGVdIDogdGhpcy5kb21FdmVudFR5cGU7XHJcbiAgICAgICAgICAgICAgICBlLmZvckVhY2goZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LCBlLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Eb21FdmVudChlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwge3VzZUNhcHR1cmU6IHRoaXMudXNlQ2FwdHVyZX0pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmaXJlKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuZmlyZSh0LCBuZXcgS3UodGhpcy52aWV3LCBlLCBpKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgWXUgZXh0ZW5kcyBKdSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudFR5cGUgPSBbXCJrZXlkb3duXCIsIFwia2V5dXBcIl1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb25Eb21FdmVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUodC50eXBlLCB0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5Q29kZTogdC5rZXlDb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIGFsdEtleTogdC5hbHRLZXksXHJcbiAgICAgICAgICAgICAgICAgICAgY3RybEtleTogdC5jdHJsS2V5IHx8IHQubWV0YUtleSxcclxuICAgICAgICAgICAgICAgICAgICBzaGlmdEtleTogdC5zaGlmdEtleSxcclxuICAgICAgICAgICAgICAgICAgICBnZXQga2V5c3Ryb2tlKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWwodGhpcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgUXUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuW1wiYVwiXS5EYXRlLm5vdygpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgWHUgPSBRdTtcclxuICAgICAgICB2YXIgWnUgPSAwIC8gMDtcclxuICAgICAgICB2YXIgdGggPSAvXlxccyt8XFxzKyQvZztcclxuICAgICAgICB2YXIgZWggPSAvXlstK10weFswLTlhLWZdKyQvaTtcclxuICAgICAgICB2YXIgaWggPSAvXjBiWzAxXSskL2k7XHJcbiAgICAgICAgdmFyIG5oID0gL14wb1swLTddKyQvaTtcclxuICAgICAgICB2YXIgb2ggPSBwYXJzZUludDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmgodCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoUXModCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBadVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjdCh0KSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSB0eXBlb2YgdC52YWx1ZU9mID09IFwiZnVuY3Rpb25cIiA/IHQudmFsdWVPZigpIDogdDtcclxuICAgICAgICAgICAgICAgIHQgPSBjdChlKSA/IGUgKyBcIlwiIDogZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCAhPSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PT0gMCA/IHQgOiArdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQgPSB0LnJlcGxhY2UodGgsIFwiXCIpO1xyXG4gICAgICAgICAgICB2YXIgaSA9IGloLnRlc3QodCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpIHx8IG5oLnRlc3QodCkgPyBvaCh0LnNsaWNlKDIpLCBpID8gMiA6IDgpIDogZWgudGVzdCh0KSA/IFp1IDogK3RcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBzaCA9IHJoO1xyXG4gICAgICAgIHZhciBhaCA9IFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiO1xyXG4gICAgICAgIHZhciBjaCA9IE1hdGgubWF4LCBsaCA9IE1hdGgubWluO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBkaCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHZhciBuLCBvLCByLCBzLCBhLCBjLCBsID0gMCwgZCA9IGZhbHNlLCB1ID0gZmFsc2UsIGggPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgIT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGFoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUgPSBzaChlKSB8fCAwO1xyXG4gICAgICAgICAgICBpZiAoY3QoaSkpIHtcclxuICAgICAgICAgICAgICAgIGQgPSAhIWkubGVhZGluZztcclxuICAgICAgICAgICAgICAgIHUgPSBcIm1heFdhaXRcIiBpbiBpO1xyXG4gICAgICAgICAgICAgICAgciA9IHUgPyBjaChzaChpLm1heFdhaXQpIHx8IDAsIGUpIDogcjtcclxuICAgICAgICAgICAgICAgIGggPSBcInRyYWlsaW5nXCIgaW4gaSA/ICEhaS50cmFpbGluZyA6IGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZihlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IG4sIHIgPSBvO1xyXG4gICAgICAgICAgICAgICAgbiA9IG8gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBsID0gZTtcclxuICAgICAgICAgICAgICAgIHMgPSB0LmFwcGx5KHIsIGkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZyh0KSB7XHJcbiAgICAgICAgICAgICAgICBsID0gdDtcclxuICAgICAgICAgICAgICAgIGEgPSBzZXRUaW1lb3V0KGIsIGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGQgPyBmKHQpIDogc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBtKHQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gdCAtIGMsIG4gPSB0IC0gbCwgbyA9IGUgLSBpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHUgPyBsaChvLCByIC0gbikgOiBvXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHAodCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSB0IC0gYywgbiA9IHQgLSBsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGMgPT09IHVuZGVmaW5lZCB8fCBpID49IGUgfHwgaSA8IDAgfHwgdSAmJiBuID49IHJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gYigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ID0gWHUoKTtcclxuICAgICAgICAgICAgICAgIGlmIChwKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHcodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGEgPSBzZXRUaW1lb3V0KGIsIG0odCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHcodCkge1xyXG4gICAgICAgICAgICAgICAgYSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIGlmIChoICYmIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZih0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbiA9IG8gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBrKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbCA9IDA7XHJcbiAgICAgICAgICAgICAgICBuID0gYyA9IG8gPSBhID0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIF8oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYSA9PT0gdW5kZWZpbmVkID8gcyA6IHcoWHUoKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdigpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ID0gWHUoKSwgaSA9IHAodCk7XHJcbiAgICAgICAgICAgICAgICBuID0gYXJndW1lbnRzO1xyXG4gICAgICAgICAgICAgICAgbyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBjID0gdDtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZyhjKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBzZXRUaW1lb3V0KGIsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZihjKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhID0gc2V0VGltZW91dChiLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdi5jYW5jZWwgPSBrO1xyXG4gICAgICAgICAgICB2LmZsdXNoID0gXztcclxuICAgICAgICAgICAgcmV0dXJuIHZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB1aCA9IGRoO1xyXG5cclxuICAgICAgICBjbGFzcyBoaCBleHRlbmRzIEdkIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlU2VsZWN0aW9uQ2hhbmdlRG9uZURlYm91bmNlZCA9IHVoKHQgPT4gdGhpcy5kb2N1bWVudC5maXJlKFwic2VsZWN0aW9uQ2hhbmdlRG9uZVwiLCB0KSwgMjAwKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvYnNlcnZlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0Lm9uKFwia2V5ZG93blwiLCAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5pc0Zha2UgJiYgZmgoaS5rZXlDb2RlKSAmJiB0aGlzLmlzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZVNlbGVjdGlvbk1vdmUoaS5rZXlDb2RlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJlU2VsZWN0aW9uQ2hhbmdlRG9uZURlYm91bmNlZC5jYW5jZWwoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGFuZGxlU2VsZWN0aW9uTW92ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IGdsKGUuZ2V0UmFuZ2VzKCksIHtiYWNrd2FyZDogZS5pc0JhY2t3YXJkLCBmYWtlOiBmYWxzZX0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgPT0gTmwuYXJyb3dsZWZ0IHx8IHQgPT0gTmwuYXJyb3d1cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc2V0VG8oaS5nZXRGaXJzdFBvc2l0aW9uKCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodCA9PSBObC5hcnJvd3JpZ2h0IHx8IHQgPT0gTmwuYXJyb3dkb3duKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zZXRUbyhpLmdldExhc3RQb3NpdGlvbigpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHtvbGRTZWxlY3Rpb246IGUsIG5ld1NlbGVjdGlvbjogaSwgZG9tU2VsZWN0aW9uOiBudWxsfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuZmlyZShcInNlbGVjdGlvbkNoYW5nZVwiLCBuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVTZWxlY3Rpb25DaGFuZ2VEb25lRGVib3VuY2VkKG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZoKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgPT0gTmwuYXJyb3dyaWdodCB8fCB0ID09IE5sLmFycm93bGVmdCB8fCB0ID09IE5sLmFycm93dXAgfHwgdCA9PSBObC5hcnJvd2Rvd25cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGdoIGV4dGVuZHMgR2Qge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25PYnNlcnZlciA9IHQuZ2V0T2JzZXJ2ZXIoR3UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb24gPSB0aGlzLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tQ29udmVydGVyID0gdC5kb21Db252ZXJ0ZXI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kb2N1bWVudHMgPSBuZXcgV2Vha1NldDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVTZWxlY3Rpb25DaGFuZ2VEb25lRGVib3VuY2VkID0gdWgodCA9PiB0aGlzLmRvY3VtZW50LmZpcmUoXCJzZWxlY3Rpb25DaGFuZ2VEb25lXCIsIHQpLCAyMDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2xlYXJJbmZpbml0ZUxvb3BJbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHRoaXMuX2NsZWFySW5maW5pdGVMb29wKCksIDFlMyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sb29wYmFja0NvdW50ZXIgPSAwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9ic2VydmUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQub3duZXJEb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kb2N1bWVudHMuaGFzKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwic2VsZWN0aW9uY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVTZWxlY3Rpb25DaGFuZ2UoZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnRzLmFkZChlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9jbGVhckluZmluaXRlTG9vcEludGVydmFsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVTZWxlY3Rpb25DaGFuZ2VEb25lRGVib3VuY2VkLmNhbmNlbCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVTZWxlY3Rpb25DaGFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvbk9ic2VydmVyLmZsdXNoKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kZWZhdWx0Vmlldy5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmRvbUNvbnZlcnRlci5kb21TZWxlY3Rpb25Ub1ZpZXcoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5yYW5nZUNvdW50ID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbi5pc0VxdWFsKGkpICYmIHRoaXMuZG9tQ29udmVydGVyLmlzRG9tU2VsZWN0aW9uQ29ycmVjdChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCsrdGhpcy5fbG9vcGJhY2tDb3VudGVyID4gNjApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbi5pc1NpbWlsYXIoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuZm9yY2VSZW5kZXIoKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0ge29sZFNlbGVjdGlvbjogdGhpcy5zZWxlY3Rpb24sIG5ld1NlbGVjdGlvbjogaSwgZG9tU2VsZWN0aW9uOiBlfTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmZpcmUoXCJzZWxlY3Rpb25DaGFuZ2VcIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlyZVNlbGVjdGlvbkNoYW5nZURvbmVEZWJvdW5jZWQodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NsZWFySW5maW5pdGVMb29wKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbG9vcGJhY2tDb3VudGVyID0gMFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBtaCBleHRlbmRzIEp1IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbUV2ZW50VHlwZSA9IFtcImZvY3VzXCIsIFwiYmx1clwiXTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXNlQ2FwdHVyZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGUub24oXCJmb2N1c1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5pc0ZvY3VzZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gdC5mb3JjZVJlbmRlcigpLCA1MClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZS5vbihcImJsdXJcIiwgKGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5zZWxlY3Rpb24uZWRpdGFibGVFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvID09PSBudWxsIHx8IG8gPT09IG4udGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuaXNGb2N1c2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZm9yY2VSZW5kZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9uRG9tRXZlbnQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHQudHlwZSwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZW5kZXJUaW1lb3V0SWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fcmVuZGVyVGltZW91dElkKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3VwZXIuZGVzdHJveSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHBoIGV4dGVuZHMgSnUge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRUeXBlID0gW1wiY29tcG9zaXRpb25zdGFydFwiLCBcImNvbXBvc2l0aW9udXBkYXRlXCIsIFwiY29tcG9zaXRpb25lbmRcIl07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGUub24oXCJjb21wb3NpdGlvbnN0YXJ0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLmlzQ29tcG9zaW5nID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiY29tcG9zaXRpb25lbmRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuaXNDb21wb3NpbmcgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb25Eb21FdmVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUodC50eXBlLCB0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBiaCBleHRlbmRzIEp1IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbUV2ZW50VHlwZSA9IFtcImJlZm9yZWlucHV0XCJdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9uRG9tRXZlbnQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHQudHlwZSwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gd2godCkge1xyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5hcHBseSh0KSA9PSBcIltvYmplY3QgUmFuZ2VdXCJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGtoKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdG9wOiBwYXJzZUludChlLmJvcmRlclRvcFdpZHRoLCAxMCksXHJcbiAgICAgICAgICAgICAgICByaWdodDogcGFyc2VJbnQoZS5ib3JkZXJSaWdodFdpZHRoLCAxMCksXHJcbiAgICAgICAgICAgICAgICBib3R0b206IHBhcnNlSW50KGUuYm9yZGVyQm90dG9tV2lkdGgsIDEwKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHBhcnNlSW50KGUuYm9yZGVyTGVmdFdpZHRoLCAxMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgX2ggPSBbXCJ0b3BcIiwgXCJyaWdodFwiLCBcImJvdHRvbVwiLCBcImxlZnRcIiwgXCJ3aWR0aFwiLCBcImhlaWdodFwiXTtcclxuXHJcbiAgICAgICAgY2xhc3Mgdmgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gd2godCk7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfc291cmNlXCIsIHt2YWx1ZTogdC5fc291cmNlIHx8IHQsIHdyaXRhYmxlOiB0cnVlLCBlbnVtZXJhYmxlOiBmYWxzZX0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKEtyKHQpIHx8IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aCh0aGlzLCB2aC5nZXREb21SYW5nZVJlY3RzKHQpWzBdKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHloKHRoaXMsIHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChIZCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHtpbm5lcldpZHRoOiBlLCBpbm5lckhlaWdodDogaX0gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIHloKHRoaXMsIHt0b3A6IDAsIHJpZ2h0OiBlLCBib3R0b206IGksIGxlZnQ6IDAsIHdpZHRoOiBlLCBoZWlnaHQ6IGl9KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB5aCh0aGlzLCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9uZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdmgodGhpcylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbW92ZVRvKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9wID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmlnaHQgPSB0ICsgdGhpcy53aWR0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm90dG9tID0gZSArIHRoaXMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0ID0gdDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1vdmVCeSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvcCArPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodCArPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0ICs9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvdHRvbSArPSBlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0SW50ZXJzZWN0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiBNYXRoLm1heCh0aGlzLnRvcCwgdC50b3ApLFxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBNYXRoLm1pbih0aGlzLnJpZ2h0LCB0LnJpZ2h0KSxcclxuICAgICAgICAgICAgICAgICAgICBib3R0b206IE1hdGgubWluKHRoaXMuYm90dG9tLCB0LmJvdHRvbSksXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogTWF0aC5tYXgodGhpcy5sZWZ0LCB0LmxlZnQpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZS53aWR0aCA9IGUucmlnaHQgLSBlLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICBlLmhlaWdodCA9IGUuYm90dG9tIC0gZS50b3A7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS53aWR0aCA8IDAgfHwgZS5oZWlnaHQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB2aChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRJbnRlcnNlY3Rpb25BcmVhKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmdldEludGVyc2VjdGlvbih0KTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuZ2V0QXJlYSgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEFyZWEoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFZpc2libGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fc291cmNlO1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0aGlzLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXhoKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSB0LnBhcmVudE5vZGUgfHwgdC5jb21tb25BbmNlc3RvckNvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaSAmJiAheGgoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyB2aChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2V0SW50ZXJzZWN0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uZ2V0QXJlYSgpIDwgZS5nZXRBcmVhKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gaS5wYXJlbnROb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNFcXVhbCh0KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgX2gpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tlXSAhPT0gdFtlXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb250YWlucyh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5nZXRJbnRlcnNlY3Rpb24odCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gISEoZSAmJiBlLmlzRXF1YWwodCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4Y2x1ZGVTY3JvbGxiYXJzQW5kQm9yZGVycygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9zb3VyY2U7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSwgaSwgbjtcclxuICAgICAgICAgICAgICAgIGlmIChIZCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0LmlubmVyV2lkdGggLSB0LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdC5pbm5lckhlaWdodCAtIHQuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBuID0gdC5nZXRDb21wdXRlZFN0eWxlKHQuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5kaXJlY3Rpb25cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGtoKHRoaXMuX3NvdXJjZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQub2Zmc2V0V2lkdGggLSB0LmNsaWVudFdpZHRoIC0gby5sZWZ0IC0gby5yaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdC5vZmZzZXRIZWlnaHQgLSB0LmNsaWVudEhlaWdodCAtIG8udG9wIC0gby5ib3R0b207XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKHQpLmRpcmVjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxlZnQgKz0gby5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9wICs9IG8udG9wO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmlnaHQgLT0gby5yaWdodDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvdHRvbSAtPSBvLmJvdHRvbTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gdGhpcy5yaWdodCAtIHRoaXMubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCA9IHRoaXMuYm90dG9tIC0gdGhpcy50b3BcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMud2lkdGggLT0gZTtcclxuICAgICAgICAgICAgICAgIGlmIChuID09PSBcImx0clwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yaWdodCAtPSBlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGVmdCArPSBlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCAtPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib3R0b20gLT0gaTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXREb21SYW5nZVJlY3RzKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBBcnJheS5mcm9tKHQuZ2V0Q2xpZW50UmVjdHMoKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnB1c2gobmV3IHZoKHQpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSB0LnN0YXJ0Q29udGFpbmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvZChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gaS5wYXJlbnROb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgdmgoaS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5yaWdodCA9IG4ubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICBuLndpZHRoID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBlLnB1c2gobilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHloKHQsIGUpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIF9oKSB7XHJcbiAgICAgICAgICAgICAgICB0W2ldID0gZVtpXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB4aCh0KSB7XHJcbiAgICAgICAgICAgIGlmICghS3IodCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0ID09PSB0Lm93bmVyRG9jdW1lbnQuYm9keVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgQ2ggPSB7fTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQWgoe3RhcmdldDogdCwgdmlld3BvcnRPZmZzZXQ6IGUgPSAwfSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gVmgodCk7XHJcbiAgICAgICAgICAgIGxldCBuID0gaTtcclxuICAgICAgICAgICAgbGV0IG8gPSBudWxsO1xyXG4gICAgICAgICAgICB3aGlsZSAobikge1xyXG4gICAgICAgICAgICAgICAgbGV0IHI7XHJcbiAgICAgICAgICAgICAgICBpZiAobiA9PSBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IE5oKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHIgPSBOaChvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgU2gociwgKCkgPT4gTWgodCwgbikpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IE1oKHQsIG4pO1xyXG4gICAgICAgICAgICAgICAgUGgobiwgcywgZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5wYXJlbnQgIT0gbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSBuLmZyYW1lRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBuID0gbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVGgodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gTmgodCk7XHJcbiAgICAgICAgICAgIFNoKGUsICgpID0+IG5ldyB2aCh0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIE9iamVjdC5hc3NpZ24oQ2gsIHtzY3JvbGxWaWV3cG9ydFRvU2hvd1RhcmdldDogQWgsIHNjcm9sbEFuY2VzdG9yc1RvU2hvd1RhcmdldDogVGh9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUGgodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZS5jbG9uZSgpLm1vdmVCeSgwLCBpKTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGUuY2xvbmUoKS5tb3ZlQnkoMCwgLWkpO1xyXG4gICAgICAgICAgICBjb25zdCByID0gbmV3IHZoKHQpLmV4Y2x1ZGVTY3JvbGxiYXJzQW5kQm9yZGVycygpO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gW28sIG5dO1xyXG4gICAgICAgICAgICBpZiAoIXMuZXZlcnkodCA9PiByLmNvbnRhaW5zKHQpKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHtzY3JvbGxYOiBzLCBzY3JvbGxZOiBhfSA9IHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoUmgobywgcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBhIC09IHIudG9wIC0gZS50b3AgKyBpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEVoKG4sIHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYSArPSBlLmJvdHRvbSAtIHIuYm90dG9tICsgaVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKE9oKGUsIHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcyAtPSByLmxlZnQgLSBlLmxlZnQgKyBpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEloKGUsIHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcyArPSBlLnJpZ2h0IC0gci5yaWdodCArIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQuc2Nyb2xsVG8ocywgYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gU2godCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gVmgodCk7XHJcbiAgICAgICAgICAgIGxldCBuLCBvO1xyXG4gICAgICAgICAgICB3aGlsZSAodCAhPSBpLmRvY3VtZW50LmJvZHkpIHtcclxuICAgICAgICAgICAgICAgIG8gPSBlKCk7XHJcbiAgICAgICAgICAgICAgICBuID0gbmV3IHZoKHQpLmV4Y2x1ZGVTY3JvbGxiYXJzQW5kQm9yZGVycygpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnRhaW5zKG8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFJoKG8sIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2Nyb2xsVG9wIC09IG4udG9wIC0gby50b3BcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEVoKG8sIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2Nyb2xsVG9wICs9IG8uYm90dG9tIC0gbi5ib3R0b21cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE9oKG8sIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2Nyb2xsTGVmdCAtPSBuLmxlZnQgLSBvLmxlZnRcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEloKG8sIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2Nyb2xsTGVmdCArPSBvLnJpZ2h0IC0gbi5yaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQgPSB0LnBhcmVudE5vZGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRWgodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5ib3R0b20gPiBlLmJvdHRvbVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUmgodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC50b3AgPCBlLnRvcFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gT2godCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5sZWZ0IDwgZS5sZWZ0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBJaCh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LnJpZ2h0ID4gZS5yaWdodFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVmgodCkge1xyXG4gICAgICAgICAgICBpZiAod2godCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LnN0YXJ0Q29udGFpbmVyLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXdcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTmgodCkge1xyXG4gICAgICAgICAgICBpZiAod2godCkpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gdC5jb21tb25BbmNlc3RvckNvbnRhaW5lcjtcclxuICAgICAgICAgICAgICAgIGlmIChvZChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBlLnBhcmVudE5vZGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5wYXJlbnROb2RlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE1oKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFZoKHQpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IHZoKHQpO1xyXG4gICAgICAgICAgICBpZiAoaSA9PT0gZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gaTtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0ICE9IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5mcmFtZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyB2aChlKS5leGNsdWRlU2Nyb2xsYmFyc0FuZEJvcmRlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICBuLm1vdmVCeShpLmxlZnQsIGkudG9wKTtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gdC5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgQmgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50ID0gbmV3IHBsKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21Db252ZXJ0ZXIgPSBuZXcgemQodGhpcy5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbVJvb3RzID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNSZW5kZXJpbmdJblByb2dyZXNzXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyID0gbmV3IENkKHRoaXMuZG9tQ29udmVydGVyLCB0aGlzLmRvY3VtZW50LnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5iaW5kKFwiaXNGb2N1c2VkXCIpLnRvKHRoaXMuZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5pdGlhbERvbVJvb3RBdHRyaWJ1dGVzID0gbmV3IFdlYWtNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb25nb2luZ0NoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zdEZpeGVyc0luUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmluZ0Rpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oYXNDaGFuZ2VkU2luY2VUaGVMYXN0UmVuZGVyaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl93cml0ZXIgPSBuZXcgJGwodGhpcy5kb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZE9ic2VydmVyKEd1KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkT2JzZXJ2ZXIoZ2gpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRPYnNlcnZlcihtaCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkZE9ic2VydmVyKFl1KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkT2JzZXJ2ZXIoaGgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRPYnNlcnZlcihwaCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoQWwuaXNBbmRyb2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRPYnNlcnZlcihiaClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGhkKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgamwodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwicmVuZGVyXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmZpcmUoXCJsYXlvdXRDaGFuZ2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc0NoYW5nZWRTaW5jZVRoZUxhc3RSZW5kZXJpbmcgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuZG9jdW1lbnQuc2VsZWN0aW9uLCBcImNoYW5nZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzQ2hhbmdlZFNpbmNlVGhlTGFzdFJlbmRlcmluZyA9IHRydWVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dGFjaERvbVJvb3QodCwgZSA9IFwibWFpblwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5kb2N1bWVudC5nZXRSb290KGUpO1xyXG4gICAgICAgICAgICAgICAgaS5fbmFtZSA9IHQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB7bmFtZTogZSwgdmFsdWU6IG99IG9mIEFycmF5LmZyb20odC5hdHRyaWJ1dGVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5bZV0gPSBvO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlID09PSBcImNsYXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVyLmFkZENsYXNzKG8uc3BsaXQoXCIgXCIpLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3dyaXRlci5zZXRBdHRyaWJ1dGUoZSwgbywgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0aWFsRG9tUm9vdEF0dHJpYnV0ZXMuc2V0KHQsIG4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl93cml0ZXIuc2V0QXR0cmlidXRlKFwiY29udGVudGVkaXRhYmxlXCIsICFpLmlzUmVhZE9ubHksIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLmlzUmVhZE9ubHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVyLmFkZENsYXNzKFwiY2stcmVhZC1vbmx5XCIsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fd3JpdGVyLnJlbW92ZUNsYXNzKFwiY2stcmVhZC1vbmx5XCIsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIG8oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tUm9vdHMuc2V0KGUsIHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21Db252ZXJ0ZXIuYmluZEVsZW1lbnRzKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIubWFya1RvU3luYyhcImNoaWxkcmVuXCIsIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIubWFya1RvU3luYyhcImF0dHJpYnV0ZXNcIiwgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJlci5kb21Eb2N1bWVudHMuYWRkKHQub3duZXJEb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICBpLm9uKFwiY2hhbmdlOmNoaWxkcmVuXCIsICh0LCBlKSA9PiB0aGlzLl9yZW5kZXJlci5tYXJrVG9TeW5jKFwiY2hpbGRyZW5cIiwgZSkpO1xyXG4gICAgICAgICAgICAgICAgaS5vbihcImNoYW5nZTphdHRyaWJ1dGVzXCIsICh0LCBlKSA9PiB0aGlzLl9yZW5kZXJlci5tYXJrVG9TeW5jKFwiYXR0cmlidXRlc1wiLCBlKSk7XHJcbiAgICAgICAgICAgICAgICBpLm9uKFwiY2hhbmdlOnRleHRcIiwgKHQsIGUpID0+IHRoaXMuX3JlbmRlcmVyLm1hcmtUb1N5bmMoXCJ0ZXh0XCIsIGUpKTtcclxuICAgICAgICAgICAgICAgIGkub24oXCJjaGFuZ2U6aXNSZWFkT25seVwiLCAoKSA9PiB0aGlzLmNoYW5nZShvKSk7XHJcbiAgICAgICAgICAgICAgICBpLm9uKFwiY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNDaGFuZ2VkU2luY2VUaGVMYXN0UmVuZGVyaW5nID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdGhpcy5fb2JzZXJ2ZXJzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5vYnNlcnZlKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRldGFjaERvbVJvb3QodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9tUm9vdHMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgQXJyYXkuZnJvbShlLmF0dHJpYnV0ZXMpLmZvckVhY2goKHtuYW1lOiB0fSkgPT4gZS5yZW1vdmVBdHRyaWJ1dGUodCkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2luaXRpYWxEb21Sb290QXR0cmlidXRlcy5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgaW4gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKHQsIGlbdF0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvbVJvb3RzLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tQ29udmVydGVyLnVuYmluZERvbUVsZW1lbnQoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0RG9tUm9vdCh0ID0gXCJtYWluXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRvbVJvb3RzLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGRPYnNlcnZlcih0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHRoaXMuX29ic2VydmVycy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlID0gbmV3IHQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlcnMuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbdCwgaV0gb2YgdGhpcy5kb21Sb290cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGUub2JzZXJ2ZShpLCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZS5lbmFibGUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldE9ic2VydmVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZlcnMuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRpc2FibGVPYnNlcnZlcnMoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fb2JzZXJ2ZXJzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5kaXNhYmxlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZW5hYmxlT2JzZXJ2ZXJzKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX29ic2VydmVycy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZW5hYmxlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2Nyb2xsVG9UaGVTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5kb2N1bWVudC5zZWxlY3Rpb24uZ2V0Rmlyc3RSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBBaCh7dGFyZ2V0OiB0aGlzLmRvbUNvbnZlcnRlci52aWV3UmFuZ2VUb0RvbSh0KSwgdmlld3BvcnRPZmZzZXQ6IDIwfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZG9jdW1lbnQuaXNGb2N1c2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZG9jdW1lbnQuc2VsZWN0aW9uLmVkaXRhYmxlRWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbUNvbnZlcnRlci5mb2N1cyh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JjZVJlbmRlcigpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoYW5nZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlbmRlcmluZ0luUHJvZ3Jlc3MgfHwgdGhpcy5fcG9zdEZpeGVyc0luUHJvZ3Jlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiY2Fubm90LWNoYW5nZS12aWV3LXRyZWU6IFwiICsgXCJBdHRlbXB0aW5nIHRvIG1ha2UgY2hhbmdlcyB0byB0aGUgdmlldyB3aGVuIGl0IGlzIGluIGFuIGluY29ycmVjdCBzdGF0ZTogcmVuZGVyaW5nIG9yIHBvc3QtZml4ZXJzIGFyZSBpbiBwcm9ncmVzcy4gXCIgKyBcIlRoaXMgbWF5IGNhdXNlIHNvbWUgdW5leHBlY3RlZCBiZWhhdmlvciBhbmQgaW5jb25zaXN0ZW5jeSBiZXR3ZWVuIHRoZSBET00gYW5kIHRoZSB2aWV3LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25nb2luZ0NoYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCh0aGlzLl93cml0ZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uZ29pbmdDaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0KHRoaXMuX3dyaXRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25nb2luZ0NoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcmVuZGVyaW5nRGlzYWJsZWQgJiYgdGhpcy5faGFzQ2hhbmdlZFNpbmNlVGhlTGFzdFJlbmRlcmluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wb3N0Rml4ZXJzSW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuX2NhbGxQb3N0Rml4ZXJzKHRoaXMuX3dyaXRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Bvc3RGaXhlcnNJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcInJlbmRlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNzW1wiYlwiXS5yZXRocm93VW5leHBlY3RlZEVycm9yKHQsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvcmNlUmVuZGVyKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faGFzQ2hhbmdlZFNpbmNlVGhlTGFzdFJlbmRlcmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX29ic2VydmVycy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZGVzdHJveSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVBvc2l0aW9uQXQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRsLl9jcmVhdGVBdCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkFmdGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkbC5fY3JlYXRlQWZ0ZXIodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUG9zaXRpb25CZWZvcmUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRsLl9jcmVhdGVCZWZvcmUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUmFuZ2UodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB1bCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSYW5nZU9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1bC5fY3JlYXRlT24odClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUmFuZ2VJbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdWwuX2NyZWF0ZUluKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVNlbGVjdGlvbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGdsKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9kaXNhYmxlUmVuZGVyaW5nKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmluZ0Rpc2FibGVkID0gdDtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2UoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUmVuZGVyaW5nSW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc2FibGVPYnNlcnZlcnMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmFibGVPYnNlcnZlcnMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNSZW5kZXJpbmdJblByb2dyZXNzID0gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoQmgsIEpjKTtcclxuXHJcbiAgICAgICAgY2xhc3Mgemgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRycyA9IEhzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpbmRleCgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoKHQgPSB0aGlzLnBhcmVudC5nZXRDaGlsZEluZGV4KHRoaXMpKSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1ub2RlLW5vdC1mb3VuZC1pbi1wYXJlbnQ6IFRoZSBub2RlJ3MgcGFyZW50IGRvZXMgbm90IGNvbnRhaW4gdGhpcyBub2RlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHN0YXJ0T2Zmc2V0KCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgodCA9IHRoaXMucGFyZW50LmdldENoaWxkU3RhcnRPZmZzZXQodGhpcykpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLW5vZGUtbm90LWZvdW5kLWluLXBhcmVudDogVGhlIG5vZGUncyBwYXJlbnQgZG9lcyBub3QgY29udGFpbiB0aGlzIG5vZGUuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgb2Zmc2V0U2l6ZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAxXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBlbmRPZmZzZXQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0T2Zmc2V0ICsgdGhpcy5vZmZzZXRTaXplXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBuZXh0U2libGluZygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgIT09IG51bGwgJiYgdGhpcy5wYXJlbnQuZ2V0Q2hpbGQodCArIDEpIHx8IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHByZXZpb3VzU2libGluZygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmluZGV4O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgIT09IG51bGwgJiYgdGhpcy5wYXJlbnQuZ2V0Q2hpbGQodCAtIDEpIHx8IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHJvb3QoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodC5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gdC5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzQXR0YWNoZWQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yb290LmlzKFwicm9vdEVsZW1lbnRcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UGF0aCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBbXTtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHdoaWxlIChlLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQudW5zaGlmdChlLnN0YXJ0T2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICBlID0gZS5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEFuY2VzdG9ycyh0ID0ge2luY2x1ZGVTZWxmOiBmYWxzZSwgcGFyZW50Rmlyc3Q6IGZhbHNlfSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSB0LmluY2x1ZGVTZWxmID8gdGhpcyA6IHRoaXMucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlW3QucGFyZW50Rmlyc3QgPyBcInB1c2hcIiA6IFwidW5zaGlmdFwiXShpKTtcclxuICAgICAgICAgICAgICAgICAgICBpID0gaS5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENvbW1vbkFuY2VzdG9yKHQsIGUgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZ2V0QW5jZXN0b3JzKGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0QW5jZXN0b3JzKGUpO1xyXG4gICAgICAgICAgICAgICAgbGV0IG8gPSAwO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGlbb10gPT0gbltvXSAmJiBpW29dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbysrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbyA9PT0gMCA/IG51bGwgOiBpW28gLSAxXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0JlZm9yZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcyA9PSB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb290ICE9PSB0LnJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmdldFBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdldFBhdGgoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBWcyhlLCBpKTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcInByZWZpeFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJleHRlbnNpb25cIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlW25dIDwgaVtuXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0FmdGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzID09IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvb3QgIT09IHQucm9vdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICF0aGlzLmlzQmVmb3JlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhc0F0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuaGFzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuZW50cmllcygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZUtleXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMua2V5cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdHRycy5zaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hdHRyaWJ1dGVzID0gQXJyYXkuZnJvbSh0aGlzLl9hdHRycykucmVkdWNlKCh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRbZVswXV0gPSBlWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHt9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJub2RlXCIgfHwgdCA9PSBcIm1vZGVsOm5vZGVcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHpoKHRoaXMuX2F0dHJzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQuX3JlbW92ZUNoaWxkcmVuKHRoaXMuaW5kZXgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRBdHRyaWJ1dGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0cnMuc2V0KHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRBdHRyaWJ1dGVzVG8odCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0cnMgPSBIcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hdHRycy5kZWxldGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NsZWFyQXR0cmlidXRlcygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2F0dHJzLmNsZWFyKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgTGggZXh0ZW5kcyB6aCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGF0YSA9IHQgfHwgXCJcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgb2Zmc2V0U2l6ZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEubGVuZ3RoXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBkYXRhKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJ0ZXh0XCIgfHwgdCA9PSBcIm1vZGVsOnRleHRcIiB8fCBzdXBlci5pcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gc3VwZXIudG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICB0LmRhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExoKHRoaXMuZGF0YSwgdGhpcy5nZXRBdHRyaWJ1dGVzKCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tSlNPTih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExoKHQuZGF0YSwgdC5hdHRyaWJ1dGVzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBGaCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGV4dE5vZGUgPSB0O1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPCAwIHx8IGUgPiB0Lm9mZnNldFNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibW9kZWwtdGV4dHByb3h5LXdyb25nLW9mZnNldGludGV4dDogR2l2ZW4gb2Zmc2V0SW5UZXh0IHZhbHVlIGlzIGluY29ycmVjdC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpIDwgMCB8fCBlICsgaSA+IHQub2Zmc2V0U2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC10ZXh0cHJveHktd3JvbmctbGVuZ3RoOiBHaXZlbiBsZW5ndGggdmFsdWUgaXMgaW5jb3JyZWN0LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gdC5kYXRhLnN1YnN0cmluZyhlLCBlICsgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9mZnNldEluVGV4dCA9IGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHN0YXJ0T2Zmc2V0KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dE5vZGUuc3RhcnRPZmZzZXQgIT09IG51bGwgPyB0aGlzLnRleHROb2RlLnN0YXJ0T2Zmc2V0ICsgdGhpcy5vZmZzZXRJblRleHQgOiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBvZmZzZXRTaXplKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5sZW5ndGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGVuZE9mZnNldCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0T2Zmc2V0ICE9PSBudWxsID8gdGhpcy5zdGFydE9mZnNldCArIHRoaXMub2Zmc2V0U2l6ZSA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzUGFydGlhbCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZnNldFNpemUgIT09IHRoaXMudGV4dE5vZGUub2Zmc2V0U2l6ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcGFyZW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dE5vZGUucGFyZW50XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCByb290KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dE5vZGUucm9vdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PSBcInRleHRQcm94eVwiIHx8IHQgPT0gXCJtb2RlbDp0ZXh0UHJveHlcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRQYXRoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMudGV4dE5vZGUuZ2V0UGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbdC5sZW5ndGggLSAxXSArPSB0aGlzLm9mZnNldEluVGV4dFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0QW5jZXN0b3JzKHQgPSB7aW5jbHVkZVNlbGY6IGZhbHNlLCBwYXJlbnRGaXJzdDogZmFsc2V9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHQuaW5jbHVkZVNlbGYgPyB0aGlzIDogdGhpcy5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVbdC5wYXJlbnRGaXJzdCA/IFwicHVzaFwiIDogXCJ1bnNoaWZ0XCJdKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBpLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFzQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHROb2RlLmhhc0F0dHJpYnV0ZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRBdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dE5vZGUuZ2V0QXR0cmlidXRlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Tm9kZS5nZXRBdHRyaWJ1dGVzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0QXR0cmlidXRlS2V5cygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHROb2RlLmdldEF0dHJpYnV0ZUtleXMoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBEaCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25vZGVzID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydE5vZGVzKDAsIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzW1N5bWJvbC5pdGVyYXRvcl0oKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbGVuZ3RoKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbWF4T2Zmc2V0KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzLnJlZHVjZSgodCwgZSkgPT4gdCArIGUub2Zmc2V0U2l6ZSwgMClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Tm9kZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbm9kZXNbdF0gfHwgbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXROb2RlSW5kZXgodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX25vZGVzLmluZGV4T2YodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZSA9PSAtMSA/IG51bGwgOiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldE5vZGVTdGFydE9mZnNldCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5nZXROb2RlSW5kZXgodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZSA9PT0gbnVsbCA/IG51bGwgOiB0aGlzLl9ub2Rlcy5zbGljZSgwLCBlKS5yZWR1Y2UoKHQsIGUpID0+IHQgKyBlLm9mZnNldFNpemUsIDApXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluZGV4VG9PZmZzZXQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgPT0gdGhpcy5fbm9kZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF4T2Zmc2V0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fbm9kZXNbdF07XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibW9kZWwtbm9kZWxpc3QtaW5kZXgtb3V0LW9mLWJvdW5kczogR2l2ZW4gaW5kZXggY2Fubm90IGJlIGZvdW5kIGluIHRoZSBub2RlIGxpc3QuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXROb2RlU3RhcnRPZmZzZXQoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb2Zmc2V0VG9JbmRleCh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IDA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdGhpcy5fbm9kZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA+PSBlICYmIHQgPCBlICsgaS5vZmZzZXRTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE5vZGVJbmRleChpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlICs9IGkub2Zmc2V0U2l6ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUgIT0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1ub2RlbGlzdC1vZmZzZXQtb3V0LW9mLWJvdW5kczogR2l2ZW4gb2Zmc2V0IGNhbm5vdCBiZSBmb3VuZCBpbiB0aGUgbm9kZSBsaXN0LlwiLCB0aGlzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUxpc3Q6IHRoaXNcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9pbnNlcnROb2Rlcyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiB6aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLW5vZGVsaXN0LWluc2VydE5vZGVzLW5vdC1ub2RlOiBUcnlpbmcgdG8gaW5zZXJ0IGFuIG9iamVjdCB3aGljaCBpcyBub3QgYSBOb2RlIGluc3RhbmNlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX25vZGVzLnNwbGljZSh0LCAwLCAuLi5lKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlTm9kZXModCwgZSA9IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ub2Rlcy5zcGxpY2UodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25vZGVzLm1hcCh0ID0+IHQudG9KU09OKCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGpoIGV4dGVuZHMgemgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcihlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGlsZHJlbiA9IG5ldyBEaDtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5zZXJ0Q2hpbGQoMCwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGNoaWxkQ291bnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4ubGVuZ3RoXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBtYXhPZmZzZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4ubWF4T2Zmc2V0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpc0VtcHR5KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRDb3VudCA9PT0gMFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0LCBlID0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucmVwbGFjZSgvXm1vZGVsOi8sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJlbGVtZW50XCIgfHwgaSA9PSB0aGlzLm5hbWUgfHwgc3VwZXIuaXModClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJlbGVtZW50XCIgJiYgZSA9PSB0aGlzLm5hbWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmdldE5vZGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGRyZW4oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW5bU3ltYm9sLml0ZXJhdG9yXSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENoaWxkSW5kZXgodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmdldE5vZGVJbmRleCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRDaGlsZFN0YXJ0T2Zmc2V0KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5nZXROb2RlU3RhcnRPZmZzZXQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb2Zmc2V0VG9JbmRleCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4ub2Zmc2V0VG9JbmRleCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXROb2RlQnlQYXRoKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGUuZ2V0Q2hpbGQoZS5vZmZzZXRUb0luZGV4KGkpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHN1cGVyLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgdC5uYW1lID0gdGhpcy5uYW1lO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX2NoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuY2hpbGRyZW4ucHVzaChlLnRvSlNPTigpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbG9uZSh0ID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0ID8gQXJyYXkuZnJvbSh0aGlzLl9jaGlsZHJlbikubWFwKHQgPT4gdC5fY2xvbmUodHJ1ZSkpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgamgodGhpcy5uYW1lLCB0aGlzLmdldEF0dHJpYnV0ZXMoKSwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FwcGVuZENoaWxkKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydENoaWxkKHRoaXMuY2hpbGRDb3VudCwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2luc2VydENoaWxkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBIaChlKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQucGFyZW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuX3JlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHQucGFyZW50ID0gdGhpc1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4uX2luc2VydE5vZGVzKHQsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVDaGlsZHJlbih0LCBlID0gMSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2NoaWxkcmVuLl9yZW1vdmVOb2Rlcyh0LCBlKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5wYXJlbnQgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZnJvbUpTT04odCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKGpoLmZyb21KU09OKGkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKExoLmZyb21KU09OKGkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBqaCh0Lm5hbWUsIHQuYXR0cmlidXRlcywgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSGgodCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgTGgodCldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFqcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgdCA9IFt0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHQpLm1hcCh0ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMaCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBGaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTGgodC5kYXRhLCB0LmdldEF0dHJpYnV0ZXMoKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBXaCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0LmJvdW5kYXJpZXMgJiYgIXQuc3RhcnRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC10cmVlLXdhbGtlci1uby1zdGFydC1wb3NpdGlvbjogTmVpdGhlciBib3VuZGFyaWVzIG5vciBzdGFydGluZyBwb3NpdGlvbiBoYXZlIGJlZW4gZGVmaW5lZC5cIiwgbnVsbClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRpcmVjdGlvbiB8fCBcImZvcndhcmRcIjtcclxuICAgICAgICAgICAgICAgIGlmIChlICE9IFwiZm9yd2FyZFwiICYmIGUgIT0gXCJiYWNrd2FyZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLXRyZWUtd2Fsa2VyLXVua25vd24tZGlyZWN0aW9uOiBPbmx5IGBiYWNrd2FyZGAgYW5kIGBmb3J3YXJkYCBkaXJlY3Rpb24gYWxsb3dlZC5cIiwgdCwge2RpcmVjdGlvbjogZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvdW5kYXJpZXMgPSB0LmJvdW5kYXJpZXMgfHwgbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0LnN0YXJ0UG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdC5zdGFydFBvc2l0aW9uLmNsb25lKClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IFVoLl9jcmVhdGVBdCh0aGlzLmJvdW5kYXJpZXNbdGhpcy5kaXJlY3Rpb24gPT0gXCJiYWNrd2FyZFwiID8gXCJlbmRcIiA6IFwic3RhcnRcIl0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uLnN0aWNraW5lc3MgPSBcInRvTm9uZVwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaW5nbGVDaGFyYWN0ZXJzID0gISF0LnNpbmdsZUNoYXJhY3RlcnM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoYWxsb3cgPSAhIXQuc2hhbGxvdztcclxuICAgICAgICAgICAgICAgIHRoaXMuaWdub3JlRWxlbWVudEVuZCA9ICEhdC5pZ25vcmVFbGVtZW50RW5kO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRhcnlTdGFydFBhcmVudCA9IHRoaXMuYm91bmRhcmllcyA/IHRoaXMuYm91bmRhcmllcy5zdGFydC5wYXJlbnQgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYm91bmRhcnlFbmRQYXJlbnQgPSB0aGlzLmJvdW5kYXJpZXMgPyB0aGlzLmJvdW5kYXJpZXMuZW5kLnBhcmVudCA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92aXNpdGVkUGFyZW50ID0gdGhpcy5wb3NpdGlvbi5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBza2lwKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlLCBpLCBuLCBvO1xyXG4gICAgICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLnBvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSB0aGlzLl92aXNpdGVkUGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICh7ZG9uZTogZSwgdmFsdWU6IGl9ID0gdGhpcy5uZXh0KCkpXHJcbiAgICAgICAgICAgICAgICB9IHdoaWxlICghZSAmJiB0KGkpKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSBuO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2l0ZWRQYXJlbnQgPSBvXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG5leHQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT0gXCJmb3J3YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbmV4dCgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmV2aW91cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9uZXh0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5wb3NpdGlvbi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3Zpc2l0ZWRQYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5wYXJlbnQgPT09IG51bGwgJiYgZS5vZmZzZXQgPT09IGkubWF4T2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkb25lOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IHRoaXMuX2JvdW5kYXJ5RW5kUGFyZW50ICYmIGUub2Zmc2V0ID09IHRoaXMuYm91bmRhcmllcy5lbmQub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtkb25lOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUudGV4dE5vZGUgPyBlLnRleHROb2RlIDogZS5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICBpZiAobiBpbnN0YW5jZW9mIGpoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNoYWxsb3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wYXRoLnB1c2goMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2l0ZWRQYXJlbnQgPSBuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5vZmZzZXQrK1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcWgoXCJlbGVtZW50U3RhcnRcIiwgbiwgdCwgZSwgMSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobiBpbnN0YW5jZW9mIExoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2luZ2xlQ2hhcmFjdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gMVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0ID0gbi5lbmRPZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib3VuZGFyeUVuZFBhcmVudCA9PSBpICYmIHRoaXMuYm91bmRhcmllcy5lbmQub2Zmc2V0IDwgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHRoaXMuYm91bmRhcmllcy5lbmQub2Zmc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IHQgLSBlLm9mZnNldFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gZS5vZmZzZXQgLSBuLnN0YXJ0T2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgRmgobiwgciwgbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5vZmZzZXQgKz0gbztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcWgoXCJ0ZXh0XCIsIHMsIHQsIGUsIG8pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucGF0aC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBlLm9mZnNldCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSBlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2l0ZWRQYXJlbnQgPSBpLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pZ25vcmVFbGVtZW50RW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9uZXh0KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcWgoXCJlbGVtZW50RW5kXCIsIGksIHQsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcHJldmlvdXMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5wb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fdmlzaXRlZFBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChpLnBhcmVudCA9PT0gbnVsbCAmJiBlLm9mZnNldCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7ZG9uZTogdHJ1ZX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpID09IHRoaXMuX2JvdW5kYXJ5U3RhcnRQYXJlbnQgJiYgZS5vZmZzZXQgPT0gdGhpcy5ib3VuZGFyaWVzLnN0YXJ0Lm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7ZG9uZTogdHJ1ZX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLnRleHROb2RlID8gZS50ZXh0Tm9kZSA6IGUubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgIGlmIChuIGluc3RhbmNlb2YgamgpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm9mZnNldC0tO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5zaGFsbG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucGF0aC5wdXNoKG4ubWF4T2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2l0ZWRQYXJlbnQgPSBuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pZ25vcmVFbGVtZW50RW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJldmlvdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHFoKFwiZWxlbWVudEVuZFwiLCBuLCB0LCBlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBxaChcImVsZW1lbnRTdGFydFwiLCBuLCB0LCBlLCAxKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobiBpbnN0YW5jZW9mIExoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2luZ2xlQ2hhcmFjdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gMVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0ID0gbi5zdGFydE9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JvdW5kYXJ5U3RhcnRQYXJlbnQgPT0gaSAmJiB0aGlzLmJvdW5kYXJpZXMuc3RhcnQub2Zmc2V0ID4gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHRoaXMuYm91bmRhcmllcy5zdGFydC5vZmZzZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gZS5vZmZzZXQgLSB0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBlLm9mZnNldCAtIG4uc3RhcnRPZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBGaChuLCByIC0gbywgbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5vZmZzZXQgLT0gbztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcWgoXCJ0ZXh0XCIsIHMsIHQsIGUsIG8pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucGF0aC5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92aXNpdGVkUGFyZW50ID0gaS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHFoKFwiZWxlbWVudFN0YXJ0XCIsIGksIHQsIGUsIDEpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHFoKHQsIGUsIGksIG4sIG8pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtkb25lOiBmYWxzZSwgdmFsdWU6IHt0eXBlOiB0LCBpdGVtOiBlLCBwcmV2aW91c1Bvc2l0aW9uOiBpLCBuZXh0UG9zaXRpb246IG4sIGxlbmd0aDogb319XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBVaCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGkgPSBcInRvTm9uZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQuaXMoXCJlbGVtZW50XCIpICYmICF0LmlzKFwiZG9jdW1lbnRGcmFnbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1wb3NpdGlvbi1yb290LWludmFsaWQ6IFBvc2l0aW9uIHJvb3QgaW52YWxpZC5cIiwgdClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBBcnJheSkgfHwgZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibW9kZWwtcG9zaXRpb24tcGF0aC1pbmNvcnJlY3QtZm9ybWF0OiBQb3NpdGlvbiBwYXRoIG11c3QgYmUgYW4gYXJyYXkgd2l0aCBhdCBsZWFzdCBvbmUgaXRlbS5cIiwgdCwge3BhdGg6IGV9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZSA9IHQuZ2V0UGF0aCgpLmNvbmNhdChlKTtcclxuICAgICAgICAgICAgICAgIHQgPSB0LnJvb3Q7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvb3QgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXRoID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RpY2tpbmVzcyA9IGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IG9mZnNldCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBDYSh0aGlzLnBhdGgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldCBvZmZzZXQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXRoW3RoaXMucGF0aC5sZW5ndGggLSAxXSA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHBhcmVudCgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gdGhpcy5yb290O1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLnBhdGgubGVuZ3RoIC0gMTsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHQuZ2V0Q2hpbGQodC5vZmZzZXRUb0luZGV4KHRoaXMucGF0aFtlXSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibW9kZWwtcG9zaXRpb24tcGF0aC1pbmNvcnJlY3Q6IFRoZSBwb3NpdGlvbidzIHBhdGggaXMgaW5jb3JyZWN0LlwiLCB0aGlzLCB7cG9zaXRpb246IHRoaXN9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0LmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1wb3NpdGlvbi1wYXRoLWluY29ycmVjdDogVGhlIHBvc2l0aW9uJ3MgcGF0aCBpcyBpbmNvcnJlY3QuXCIsIHRoaXMsIHtwb3NpdGlvbjogdGhpc30pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaW5kZXgoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQub2Zmc2V0VG9JbmRleCh0aGlzLm9mZnNldClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHRleHROb2RlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMucGFyZW50LmdldENoaWxkKHRoaXMuaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBMaCAmJiB0LnN0YXJ0T2Zmc2V0IDwgdGhpcy5vZmZzZXQgPyB0IDogbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbm9kZUFmdGVyKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dE5vZGUgPT09IG51bGwgPyB0aGlzLnBhcmVudC5nZXRDaGlsZCh0aGlzLmluZGV4KSA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IG5vZGVCZWZvcmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Tm9kZSA9PT0gbnVsbCA/IHRoaXMucGFyZW50LmdldENoaWxkKHRoaXMuaW5kZXggLSAxKSA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQXRTdGFydCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZnNldCA9PT0gMFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNBdEVuZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9mZnNldCA9PSB0aGlzLnBhcmVudC5tYXhPZmZzZXRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29tcGFyZVdpdGgodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdCAhPSB0LnJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJkaWZmZXJlbnRcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFZzKHRoaXMucGF0aCwgdC5wYXRoKTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcInNhbWVcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwic2FtZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcInByZWZpeFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJiZWZvcmVcIjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJleHRlbnNpb25cIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYWZ0ZXJcIjtcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXRoW2VdIDwgdC5wYXRoW2VdID8gXCJiZWZvcmVcIiA6IFwiYWZ0ZXJcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbih0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGUuc3RhcnRQb3NpdGlvbiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IFdoKGUpO1xyXG4gICAgICAgICAgICAgICAgaS5za2lwKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkucG9zaXRpb25cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UGFyZW50UGF0aCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhdGguc2xpY2UoMCwgLTEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEFuY2VzdG9ycygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pcyhcImRvY3VtZW50RnJhZ21lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3RoaXMucGFyZW50XVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0QW5jZXN0b3JzKHtpbmNsdWRlU2VsZjogdHJ1ZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENvbW1vblBhdGgodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdCAhPSB0LnJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW11cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBWcyh0aGlzLnBhdGgsIHQucGF0aCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdHlwZW9mIGUgPT0gXCJzdHJpbmdcIiA/IE1hdGgubWluKHRoaXMucGF0aC5sZW5ndGgsIHQucGF0aC5sZW5ndGgpIDogZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBhdGguc2xpY2UoMCwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q29tbW9uQW5jZXN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0QW5jZXN0b3JzKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRBbmNlc3RvcnMoKTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChlW25dID09IGlbbl0gJiYgZVtuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4rK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPT09IDAgPyBudWxsIDogZVtuIC0gMV1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U2hpZnRlZEJ5KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5vZmZzZXQgKyB0O1xyXG4gICAgICAgICAgICAgICAgZS5vZmZzZXQgPSBpIDwgMCA/IDAgOiBpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNBZnRlcih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb21wYXJlV2l0aCh0KSA9PSBcImFmdGVyXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNCZWZvcmUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZVdpdGgodCkgPT0gXCJiZWZvcmVcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0VxdWFsKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBhcmVXaXRoKHQpID09IFwic2FtZVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzVG91Y2hpbmcodCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuY29tcGFyZVdpdGgodCk7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJzYW1lXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcImJlZm9yZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gVWguX2NyZWF0ZUF0KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gVWguX2NyZWF0ZUF0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJhZnRlclwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gVWguX2NyZWF0ZUF0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gVWguX2NyZWF0ZUF0KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBvID0gZS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoZS5wYXRoLmxlbmd0aCArIGkucGF0aC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5pc0VxdWFsKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnBhdGgubGVuZ3RoID4gaS5wYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5vZmZzZXQgIT09IG8ubWF4T2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnBhdGggPSBlLnBhdGguc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gby5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUub2Zmc2V0KytcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaS5vZmZzZXQgIT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucGF0aCA9IGkucGF0aC5zbGljZSgwLCAtMSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwicG9zaXRpb25cIiB8fCB0ID09IFwibW9kZWw6cG9zaXRpb25cIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYXNTYW1lUGFyZW50QXModCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdCAhPT0gdC5yb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5nZXRQYXJlbnRQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRQYXJlbnRQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVnMoZSwgaSkgPT0gXCJzYW1lXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0VHJhbnNmb3JtZWRCeU9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZTtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAodC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwiaW5zZXJ0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLl9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0T3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJtb3ZlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVtb3ZlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVpbnNlcnRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2dldFRyYW5zZm9ybWVkQnlNb3ZlT3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJzcGxpdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJtZXJnZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gVWguX2NyZWF0ZUF0KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRPcGVyYXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRpb24odC5wb3NpdGlvbiwgdC5ob3dNYW55KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VHJhbnNmb3JtZWRCeU1vdmVPcGVyYXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQuc291cmNlUG9zaXRpb24sIHQudGFyZ2V0UG9zaXRpb24sIHQuaG93TWFueSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRyYW5zZm9ybWVkQnlTcGxpdE9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb3ZlZFJhbmdlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuY29udGFpbnNQb3NpdGlvbih0aGlzKSB8fCBlLnN0YXJ0LmlzRXF1YWwodGhpcykgJiYgdGhpcy5zdGlja2luZXNzID09IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRDb21iaW5lZCh0LnNwbGl0UG9zaXRpb24sIHQubW92ZVRhcmdldFBvc2l0aW9uKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5ncmF2ZXlhcmRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VHJhbnNmb3JtZWRCeU1vdmUodC5ncmF2ZXlhcmRQb3NpdGlvbiwgdC5pbnNlcnRpb25Qb3NpdGlvbiwgMSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbih0Lmluc2VydGlvblBvc2l0aW9uLCAxKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb3ZlZFJhbmdlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuY29udGFpbnNQb3NpdGlvbih0aGlzKSB8fCBlLnN0YXJ0LmlzRXF1YWwodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgbjtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHRoaXMuX2dldENvbWJpbmVkKHQuc291cmNlUG9zaXRpb24sIHQudGFyZ2V0UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnNvdXJjZVBvc2l0aW9uLmlzQmVmb3JlKHQudGFyZ2V0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBuLl9nZXRUcmFuc2Zvcm1lZEJ5RGVsZXRpb24odC5kZWxldGlvblBvc2l0aW9uLCAxKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0VxdWFsKHQuZGVsZXRpb25Qb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICBuID0gVWguX2NyZWF0ZUF0KHQuZGVsZXRpb25Qb3NpdGlvbilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHRoaXMuX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQuZGVsZXRpb25Qb3NpdGlvbiwgdC5ncmF2ZXlhcmRQb3NpdGlvbiwgMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRUcmFuc2Zvcm1lZEJ5RGVsZXRpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFVoLl9jcmVhdGVBdCh0aGlzKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvb3QgIT0gdC5yb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChWcyh0LmdldFBhcmVudFBhdGgoKSwgdGhpcy5nZXRQYXJlbnRQYXRoKCkpID09IFwic2FtZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDwgdGhpcy5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0ICsgZSA+IHRoaXMub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5vZmZzZXQgLT0gZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChWcyh0LmdldFBhcmVudFBhdGgoKSwgdGhpcy5nZXRQYXJlbnRQYXRoKCkpID09IFwicHJlZml4XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wYXRoLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDw9IHRoaXMucGF0aFtuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5vZmZzZXQgKyBlID4gdGhpcy5wYXRoW25dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5wYXRoW25dIC09IGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0aW9uKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBVaC5fY3JlYXRlQXQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb290ICE9IHQucm9vdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoVnModC5nZXRQYXJlbnRQYXRoKCksIHRoaXMuZ2V0UGFyZW50UGF0aCgpKSA9PSBcInNhbWVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lm9mZnNldCA8IHRoaXMub2Zmc2V0IHx8IHQub2Zmc2V0ID09IHRoaXMub2Zmc2V0ICYmIHRoaXMuc3RpY2tpbmVzcyAhPSBcInRvUHJldmlvdXNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLm9mZnNldCArPSBlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChWcyh0LmdldFBhcmVudFBhdGgoKSwgdGhpcy5nZXRQYXJlbnRQYXRoKCkpID09IFwicHJlZml4XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wYXRoLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDw9IHRoaXMucGF0aFtuXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnBhdGhbbl0gKz0gZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRUcmFuc2Zvcm1lZEJ5TW92ZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBlID0gZS5fZ2V0VHJhbnNmb3JtZWRCeURlbGV0aW9uKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXNFcXVhbChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBVaC5fY3JlYXRlQXQodGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9nZXRUcmFuc2Zvcm1lZEJ5RGVsZXRpb24odCwgaSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbiA9PT0gbnVsbCB8fCB0LmlzRXF1YWwodGhpcykgJiYgdGhpcy5zdGlja2luZXNzID09IFwidG9OZXh0XCIgfHwgdC5nZXRTaGlmdGVkQnkoaSkuaXNFcXVhbCh0aGlzKSAmJiB0aGlzLnN0aWNraW5lc3MgPT0gXCJ0b1ByZXZpb3VzXCI7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRDb21iaW5lZCh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbihlLCBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0Q29tYmluZWQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGF0aC5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFVoLl9jcmVhdGVBdChlKTtcclxuICAgICAgICAgICAgICAgIG4uc3RpY2tpbmVzcyA9IHRoaXMuc3RpY2tpbmVzcztcclxuICAgICAgICAgICAgICAgIG4ub2Zmc2V0ID0gbi5vZmZzZXQgKyB0aGlzLnBhdGhbaV0gLSB0Lm9mZnNldDtcclxuICAgICAgICAgICAgICAgIG4ucGF0aCA9IG4ucGF0aC5jb25jYXQodGhpcy5wYXRoLnNsaWNlKGkgKyAxKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge3Jvb3Q6IHRoaXMucm9vdC50b0pTT04oKSwgcGF0aDogQXJyYXkuZnJvbSh0aGlzLnBhdGgpLCBzdGlja2luZXNzOiB0aGlzLnN0aWNraW5lc3N9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb25lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMucm9vdCwgdGhpcy5wYXRoLCB0aGlzLnN0aWNraW5lc3MpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBfY3JlYXRlQXQodCwgZSwgaSA9IFwidG9Ob25lXCIpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgVWgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVoKHQucm9vdCwgdC5wYXRoLCB0LnN0aWNraW5lc3MpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlID09IFwiZW5kXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IG4ubWF4T2Zmc2V0XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlID09IFwiYmVmb3JlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUJlZm9yZShuLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZSA9PSBcImFmdGVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUFmdGVyKG4sIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlICE9PSAwICYmICFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1jcmVhdGVQb3NpdGlvbkF0LW9mZnNldC1yZXF1aXJlZDogXCIgKyBcIk1vZGVsI2NyZWF0ZVBvc2l0aW9uQXQoKSByZXF1aXJlcyB0aGUgb2Zmc2V0IHdoZW4gdGhlIGZpcnN0IHBhcmFtZXRlciBpcyBhIG1vZGVsIGl0ZW0uXCIsIFt0aGlzLCB0XSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuLmlzKFwiZWxlbWVudFwiKSAmJiAhbi5pcyhcImRvY3VtZW50RnJhZ21lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLXBvc2l0aW9uLXBhcmVudC1pbmNvcnJlY3Q6IFBvc2l0aW9uIHBhcmVudCBoYXZlIHRvIGJlIGEgZWxlbWVudCBvciBkb2N1bWVudCBmcmFnbWVudC5cIiwgW3RoaXMsIHRdKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5nZXRQYXRoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5wdXNoKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcyhuLnJvb3QsIG8sIGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBfY3JlYXRlQWZ0ZXIodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0LnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1wb3NpdGlvbi1hZnRlci1yb290OiBZb3UgY2Fubm90IG1ha2UgYSBwb3NpdGlvbiBhZnRlciByb290LlwiLCBbdGhpcywgdF0sIHtyb290OiB0fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVBdCh0LnBhcmVudCwgdC5lbmRPZmZzZXQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBfY3JlYXRlQmVmb3JlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdC5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibW9kZWwtcG9zaXRpb24tYmVmb3JlLXJvb3Q6IFlvdSBjYW5ub3QgbWFrZSBhIHBvc2l0aW9uIGJlZm9yZSByb290LlwiLCB0LCB7cm9vdDogdH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlQXQodC5wYXJlbnQsIHQuc3RhcnRPZmZzZXQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tSlNPTih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5yb290ID09PSBcIiRncmF2ZXlhcmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgVWgoZS5ncmF2ZXlhcmQsIHQucGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zdGlja2luZXNzID0gdC5zdGlja2luZXNzO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUuZ2V0Um9vdCh0LnJvb3QpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLXBvc2l0aW9uLWZyb21qc29uLW5vLXJvb3Q6IENhbm5vdCBjcmVhdGUgcG9zaXRpb24gZm9yIGRvY3VtZW50LiBSb290IHdpdGggc3BlY2lmaWVkIG5hbWUgZG9lcyBub3QgZXhpc3QuXCIsIGUsIHtyb290TmFtZTogdC5yb290fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWgoZS5nZXRSb290KHQucm9vdCksIHQucGF0aCwgdC5zdGlja2luZXNzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyAkaCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ID0gVWguX2NyZWF0ZUF0KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmQgPSBlID8gVWguX2NyZWF0ZUF0KGUpIDogVWguX2NyZWF0ZUF0KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGFydC5zdGlja2luZXNzID0gdGhpcy5pc0NvbGxhcHNlZCA/IFwidG9Ob25lXCIgOiBcInRvTmV4dFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmQuc3RpY2tpbmVzcyA9IHRoaXMuaXNDb2xsYXBzZWQgPyBcInRvTm9uZVwiIDogXCJ0b1ByZXZpb3VzXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBbU3ltYm9sLml0ZXJhdG9yXSgpIHtcclxuICAgICAgICAgICAgICAgIHlpZWxkKiBuZXcgV2goe2JvdW5kYXJpZXM6IHRoaXMsIGlnbm9yZUVsZW1lbnRFbmQ6IHRydWV9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNDb2xsYXBzZWQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydC5pc0VxdWFsKHRoaXMuZW5kKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNGbGF0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3RhcnQuZ2V0UGFyZW50UGF0aCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZW5kLmdldFBhcmVudFBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBWcyh0LCBlKSA9PSBcInNhbWVcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcm9vdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LnJvb3RcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29udGFpbnNQb3NpdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5pc0FmdGVyKHRoaXMuc3RhcnQpICYmIHQuaXNCZWZvcmUodGhpcy5lbmQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnRhaW5zUmFuZ2UodCwgZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuY29udGFpbnNQb3NpdGlvbih0LnN0YXJ0KSB8fCBlICYmIHRoaXMuc3RhcnQuaXNFcXVhbCh0LnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmNvbnRhaW5zUG9zaXRpb24odC5lbmQpIHx8IGUgJiYgdGhpcy5lbmQuaXNFcXVhbCh0LmVuZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaSAmJiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnRhaW5zSXRlbSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gVWguX2NyZWF0ZUJlZm9yZSh0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRhaW5zUG9zaXRpb24oZSkgfHwgdGhpcy5zdGFydC5pc0VxdWFsKGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwicmFuZ2VcIiB8fCB0ID09IFwibW9kZWw6cmFuZ2VcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0VxdWFsKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0LmlzRXF1YWwodC5zdGFydCkgJiYgdGhpcy5lbmQuaXNFcXVhbCh0LmVuZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNJbnRlcnNlY3RpbmcodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQuaXNCZWZvcmUodC5lbmQpICYmIHRoaXMuZW5kLmlzQWZ0ZXIodC5zdGFydClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0RGlmZmVyZW5jZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0ludGVyc2VjdGluZyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5zUG9zaXRpb24odC5zdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyAkaCh0aGlzLnN0YXJ0LCB0LnN0YXJ0KSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbnNQb3NpdGlvbih0LmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyAkaCh0LmVuZCwgdGhpcy5lbmQpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyAkaCh0aGlzLnN0YXJ0LCB0aGlzLmVuZCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRJbnRlcnNlY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNJbnRlcnNlY3RpbmcodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZSA9IHRoaXMuc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSB0aGlzLmVuZDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb250YWluc1Bvc2l0aW9uKHQuc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0LnN0YXJ0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5zUG9zaXRpb24odC5lbmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0LmVuZFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKGUsIGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRNaW5pbWFsRmxhdFJhbmdlcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBbXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnN0YXJ0LmdldENvbW1vblBhdGgodGhpcy5lbmQpLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBVaC5fY3JlYXRlQXQodGhpcy5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgbiA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGkucGF0aC5sZW5ndGggPiBlICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuLm1heE9mZnNldCAtIGkub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucHVzaChuZXcgJGgoaSwgaS5nZXRTaGlmdGVkQnkoZSkpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpLnBhdGggPSBpLnBhdGguc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkub2Zmc2V0Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IG4ucGFyZW50XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaS5wYXRoLmxlbmd0aCA8PSB0aGlzLmVuZC5wYXRoLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVuZC5wYXRoW2kucGF0aC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZSAtIGkub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucHVzaChuZXcgJGgoaSwgaS5nZXRTaGlmdGVkQnkobikpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpLm9mZnNldCA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5wYXRoLnB1c2goMClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFdhbGtlcih0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHQuYm91bmRhcmllcyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFdoKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0SXRlbXModCA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICB0LmJvdW5kYXJpZXMgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgdC5pZ25vcmVFbGVtZW50RW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgV2godCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHQuaXRlbVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIGdldFBvc2l0aW9ucyh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHQuYm91bmRhcmllcyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFdoKHQpO1xyXG4gICAgICAgICAgICAgICAgeWllbGQgZS5wb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdC5uZXh0UG9zaXRpb25cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0VHJhbnNmb3JtZWRCeU9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcImluc2VydFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydE9wZXJhdGlvbih0KTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJtb3ZlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVtb3ZlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVpbnNlcnRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRyYW5zZm9ybWVkQnlNb3ZlT3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcInNwbGl0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbdGhpcy5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKHQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJtZXJnZVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3RoaXMuX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbih0KV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBbbmV3ICRoKHRoaXMuc3RhcnQsIHRoaXMuZW5kKV1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0VHJhbnNmb3JtZWRCeU9wZXJhdGlvbnModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFtuZXcgJGgodGhpcy5zdGFydCwgdGhpcy5lbmQpXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBlLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlW3RdLmdldFRyYW5zZm9ybWVkQnlPcGVyYXRpb24oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3BsaWNlKHQsIDEsIC4uLm4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ICs9IG4ubGVuZ3RoIC0gMVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgZS5sZW5ndGg7IHQrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlW3RdO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IG4gPSB0ICsgMTsgbiA8IGUubGVuZ3RoOyBuKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVbbl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLmNvbnRhaW5zUmFuZ2UodCkgfHwgdC5jb250YWluc1JhbmdlKGkpIHx8IGkuaXNFcXVhbCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zcGxpY2UobiwgMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENvbW1vbkFuY2VzdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQuZ2V0Q29tbW9uQW5jZXN0b3IodGhpcy5lbmQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENvbnRhaW5lZEVsZW1lbnQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zdGFydC5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lbmQubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgIGlmICh0ICYmIHQuaXMoXCJlbGVtZW50XCIpICYmIHQgPT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtzdGFydDogdGhpcy5zdGFydC50b0pTT04oKSwgZW5kOiB0aGlzLmVuZC50b0pTT04oKX1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5zdGFydCwgdGhpcy5lbmQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0T3BlcmF0aW9uKHQsIGUgPSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRpb24odC5wb3NpdGlvbiwgdC5ob3dNYW55LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VHJhbnNmb3JtZWRCeU1vdmVPcGVyYXRpb24odCwgZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5zb3VyY2VQb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0Lmhvd01hbnk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdC50YXJnZXRQb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZShpLCBvLCBuLCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnN0YXJ0Ll9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24odCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHRoaXMuZW5kLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24odCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5lbmQuaXNFcXVhbCh0Lmluc2VydGlvblBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLmVuZC5nZXRTaGlmdGVkQnkoMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlLnJvb3QgIT0gaS5yb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IHRoaXMuZW5kLmdldFNoaWZ0ZWRCeSgtMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgJGgoZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGFydC5pc0VxdWFsKHQudGFyZ2V0UG9zaXRpb24pICYmIHRoaXMuZW5kLmlzRXF1YWwodC5kZWxldGlvblBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgJGgodGhpcy5zdGFydClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBlID0gdGhpcy5zdGFydC5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSB0aGlzLmVuZC5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUucm9vdCAhPSBpLnJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdGhpcy5lbmQuZ2V0U2hpZnRlZEJ5KC0xKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUuaXNBZnRlcihpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnNvdXJjZVBvc2l0aW9uLmlzQmVmb3JlKHQudGFyZ2V0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBVaC5fY3JlYXRlQXQoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUub2Zmc2V0ID0gMFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdC5kZWxldGlvblBvc2l0aW9uLmlzRXF1YWwoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0LmRlbGV0aW9uUG9zaXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlID0gdC50YXJnZXRQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKGUsIGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0aW9uKHQsIGUsIGkgPSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgJiYgdGhpcy5jb250YWluc1Bvc2l0aW9uKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgJGgodGhpcy5zdGFydCwgdCksIG5ldyAkaCh0LmdldFNoaWZ0ZWRCeShlKSwgdGhpcy5lbmQuX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRpb24odCwgZSkpXVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3ICRoKHRoaXMuc3RhcnQsIHRoaXMuZW5kKTtcclxuICAgICAgICAgICAgICAgICAgICBpLnN0YXJ0ID0gaS5zdGFydC5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbih0LCBlKTtcclxuICAgICAgICAgICAgICAgICAgICBpLmVuZCA9IGkuZW5kLl9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0aW9uKHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbaV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQsIGUsIGksIG4gPSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5zdGFydC5fZ2V0VHJhbnNmb3JtZWRCeU1vdmUodCwgZSwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgJGgobildXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGUuX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbih0LCBpKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5zUG9zaXRpb24oZSkgJiYgIW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoby5jb250YWluc1Bvc2l0aW9uKHRoaXMuc3RhcnQpIHx8IG8uY29udGFpbnNQb3NpdGlvbih0aGlzLmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RhcnQuX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQsIGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5lbmQuX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQsIGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyAkaChuLCBvKV1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSB0aGlzLmdldERpZmZlcmVuY2Uobyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgYyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gdGhpcy5nZXRJbnRlcnNlY3Rpb24obyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYS5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGMgPSBuZXcgJGgoYVswXS5zdGFydC5fZ2V0VHJhbnNmb3JtZWRCeURlbGV0aW9uKHQsIGkpLCBhWzBdLmVuZC5fZ2V0VHJhbnNmb3JtZWRCeURlbGV0aW9uKHQsIGkpKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhLmxlbmd0aCA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IG5ldyAkaCh0aGlzLnN0YXJ0LCB0aGlzLmVuZC5fZ2V0VHJhbnNmb3JtZWRCeURlbGV0aW9uKHQsIGkpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBzID0gYy5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbihyLCBpLCBsICE9PSBudWxsIHx8IG4pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHMgPSBbXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3ICRoKGwuc3RhcnQuX2dldENvbWJpbmVkKG8uc3RhcnQsIHIpLCBsLmVuZC5fZ2V0Q29tYmluZWQoby5zdGFydCwgcikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzLmxlbmd0aCA9PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMuc3BsaWNlKDEsIDAsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcy5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHRoaXMuc3RhcnQuX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbih0LCBlKTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gdGhpcy5lbmQuX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbih0LCBlKTtcclxuICAgICAgICAgICAgICAgIGlmIChpID09IG51bGwgJiYgbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKGksIG4pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBfY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5nZXRTaGlmdGVkQnkoZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZSA+IDAgPyBuZXcgdGhpcyhpLCBuKSA6IG5ldyB0aGlzKG4sIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBfY3JlYXRlSW4odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzKFVoLl9jcmVhdGVBdCh0LCAwKSwgVWguX2NyZWF0ZUF0KHQsIHQubWF4T2Zmc2V0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9jcmVhdGVPbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQoVWguX2NyZWF0ZUJlZm9yZSh0KSwgdC5vZmZzZXRTaXplKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgX2NyZWF0ZUZyb21SYW5nZXModCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInJhbmdlLWNyZWF0ZS1mcm9tLXJhbmdlcy1lbXB0eS1hcnJheTogQXQgbGVhc3Qgb25lIHJhbmdlIGhhcyB0byBiZSBwYXNzZWQuXCIsIG51bGwpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFswXS5jbG9uZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFswXTtcclxuICAgICAgICAgICAgICAgIHQuc29ydCgodCwgZSkgPT4gdC5zdGFydC5pc0FmdGVyKGUuc3RhcnQpID8gMSA6IC0xKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmluZGV4T2YoZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IHRoaXMoZS5zdGFydCwgZS5lbmQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IGkgLSAxOyB0cnVlOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRbZV0uZW5kLmlzRXF1YWwobi5zdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc3RhcnQgPSBVaC5fY3JlYXRlQXQodFtlXS5zdGFydClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gaSArIDE7IGUgPCB0Lmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbZV0uc3RhcnQuaXNFcXVhbChuLmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5lbmQgPSBVaC5fY3JlYXRlQXQodFtlXS5lbmQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZnJvbUpTT04odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzKFVoLmZyb21KU09OKHQuc3RhcnQsIGUpLCBVaC5mcm9tSlNPTih0LmVuZCwgZSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEdoIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlbFRvVmlld01hcHBpbmcgPSBuZXcgV2Vha01hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdUb01vZGVsTWFwcGluZyA9IG5ldyBXZWFrTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvTW9kZWxMZW5ndGhDYWxsYmFja3MgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya2VyTmFtZVRvRWxlbWVudHMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudFRvTWFya2VyTmFtZXMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdW5ib3VuZE1hcmtlck5hbWVzID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJtb2RlbFRvVmlld1Bvc2l0aW9uXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUudmlld1Bvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fbW9kZWxUb1ZpZXdNYXBwaW5nLmdldChlLm1vZGVsUG9zaXRpb24ucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBlLnZpZXdQb3NpdGlvbiA9IHRoaXMuX2ZpbmRQb3NpdGlvbkluKGksIGUubW9kZWxQb3NpdGlvbi5vZmZzZXQpXHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJ2aWV3VG9Nb2RlbFBvc2l0aW9uXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUubW9kZWxQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZmluZE1hcHBlZFZpZXdBbmNlc3RvcihlLnZpZXdQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX3ZpZXdUb01vZGVsTWFwcGluZy5nZXQoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuX3RvTW9kZWxPZmZzZXQoZS52aWV3UG9zaXRpb24ucGFyZW50LCBlLnZpZXdQb3NpdGlvbi5vZmZzZXQsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUubW9kZWxQb3NpdGlvbiA9IFVoLl9jcmVhdGVBdChuLCBvKVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd1wifSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYmluZEVsZW1lbnRzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGVsVG9WaWV3TWFwcGluZy5zZXQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92aWV3VG9Nb2RlbE1hcHBpbmcuc2V0KGUsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVuYmluZFZpZXdFbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnRvTW9kZWxFbGVtZW50KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvTW9kZWxNYXBwaW5nLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9lbGVtZW50VG9NYXJrZXJOYW1lcy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fZWxlbWVudFRvTWFya2VyTmFtZXMuZ2V0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3VuYm91bmRNYXJrZXJOYW1lcy5hZGQoZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbW9kZWxUb1ZpZXdNYXBwaW5nLmdldChlKSA9PSB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW9kZWxUb1ZpZXdNYXBwaW5nLmRlbGV0ZShlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1bmJpbmRNb2RlbEVsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudG9WaWV3RWxlbWVudCh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGVsVG9WaWV3TWFwcGluZy5kZWxldGUodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdmlld1RvTW9kZWxNYXBwaW5nLmdldChlKSA9PSB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvTW9kZWxNYXBwaW5nLmRlbGV0ZShlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBiaW5kRWxlbWVudFRvTWFya2VyKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9tYXJrZXJOYW1lVG9FbGVtZW50cy5nZXQoZSkgfHwgbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIGkuYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2VsZW1lbnRUb01hcmtlck5hbWVzLmdldCh0KSB8fCBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgbi5hZGQoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJOYW1lVG9FbGVtZW50cy5zZXQoZSwgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50VG9NYXJrZXJOYW1lcy5zZXQodCwgbilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdW5iaW5kRWxlbWVudEZyb21NYXJrZXJOYW1lKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9tYXJrZXJOYW1lVG9FbGVtZW50cy5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuZGVsZXRlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLnNpemUgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJOYW1lVG9FbGVtZW50cy5kZWxldGUoZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fZWxlbWVudFRvTWFya2VyTmFtZXMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBuLmRlbGV0ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5zaXplID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudFRvTWFya2VyTmFtZXMuZGVsZXRlKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmbHVzaFVuYm91bmRNYXJrZXJOYW1lcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBBcnJheS5mcm9tKHRoaXMuX3VuYm91bmRNYXJrZXJOYW1lcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91bmJvdW5kTWFya2VyTmFtZXMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsZWFyQmluZGluZ3MoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlbFRvVmlld01hcHBpbmcgPSBuZXcgV2Vha01hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdUb01vZGVsTWFwcGluZyA9IG5ldyBXZWFrTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya2VyTmFtZVRvRWxlbWVudHMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudFRvTWFya2VyTmFtZXMgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdW5ib3VuZE1hcmtlck5hbWVzID0gbmV3IFNldFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b01vZGVsRWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdmlld1RvTW9kZWxNYXBwaW5nLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b1ZpZXdFbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2RlbFRvVmlld01hcHBpbmcuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvTW9kZWxSYW5nZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKHRoaXMudG9Nb2RlbFBvc2l0aW9uKHQuc3RhcnQpLCB0aGlzLnRvTW9kZWxQb3NpdGlvbih0LmVuZCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvVmlld1JhbmdlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwodGhpcy50b1ZpZXdQb3NpdGlvbih0LnN0YXJ0KSwgdGhpcy50b1ZpZXdQb3NpdGlvbih0LmVuZCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvTW9kZWxQb3NpdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0ge3ZpZXdQb3NpdGlvbjogdCwgbWFwcGVyOiB0aGlzfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcInZpZXdUb01vZGVsUG9zaXRpb25cIiwgZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5tb2RlbFBvc2l0aW9uXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvVmlld1Bvc2l0aW9uKHQsIGUgPSB7aXNQaGFudG9tOiBmYWxzZX0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB7bW9kZWxQb3NpdGlvbjogdCwgbWFwcGVyOiB0aGlzLCBpc1BoYW50b206IGUuaXNQaGFudG9tfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcIm1vZGVsVG9WaWV3UG9zaXRpb25cIiwgaSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaS52aWV3UG9zaXRpb25cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWFya2VyTmFtZVRvRWxlbWVudHModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX21hcmtlck5hbWVUb0VsZW1lbnRzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJhdHRyaWJ1dGVFbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldEVsZW1lbnRzV2l0aFNhbWVJZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFkZChlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5hZGQodClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWdpc3RlclZpZXdUb01vZGVsTGVuZ3RoKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdUb01vZGVsTGVuZ3RoQ2FsbGJhY2tzLnNldCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmaW5kTWFwcGVkVmlld0FuY2VzdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoIXRoaXMuX3ZpZXdUb01vZGVsTWFwcGluZy5oYXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gZS5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF90b01vZGVsT2Zmc2V0KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpICE9IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fdG9Nb2RlbE9mZnNldCh0LnBhcmVudCwgdC5pbmRleCwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuX3RvTW9kZWxPZmZzZXQodCwgZSwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4gKyBvXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pcyhcInRleHRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBuICs9IHRoaXMuZ2V0TW9kZWxMZW5ndGgodC5nZXRDaGlsZChpKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldE1vZGVsTGVuZ3RoKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl92aWV3VG9Nb2RlbExlbmd0aENhbGxiYWNrcy5nZXQodC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl92aWV3VG9Nb2RlbExlbmd0aENhbGxiYWNrcy5nZXQodC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZSh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl92aWV3VG9Nb2RlbE1hcHBpbmcuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDFcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5pcyhcInRleHRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5kYXRhLmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmlzKFwidWlFbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSArPSB0aGlzLmdldE1vZGVsTGVuZ3RoKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9maW5kUG9zaXRpb25Jbih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICAgICAgICAgIGxldCBvID0gMDtcclxuICAgICAgICAgICAgICAgIGxldCByID0gMDtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZGwodCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdoaWxlIChvIDwgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0LmdldENoaWxkKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLmdldE1vZGVsTGVuZ3RoKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG8gKz0gbjtcclxuICAgICAgICAgICAgICAgICAgICByKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvID09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbW92ZVZpZXdQb3NpdGlvblRvVGV4dE5vZGUobmV3IGRsKHQsIHIpKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZmluZFBvc2l0aW9uSW4oaSwgZSAtIChvIC0gbikpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9tb3ZlVmlld1Bvc2l0aW9uVG9UZXh0Tm9kZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBMcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZGwoZSwgZS5kYXRhLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSBpbnN0YW5jZW9mIExzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBkbChpLCAwKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoR2gsIGRzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgS2gge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnN1bWFibGUgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGV4dFByb3h5UmVnaXN0cnkgPSBuZXcgTWFwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBlID0gSmgoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEZoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHRoaXMuX2dldFN5bWJvbEZvclRleHRQcm94eSh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25zdW1hYmxlLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnN1bWFibGUuc2V0KHQsIG5ldyBNYXApXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlLmdldCh0KS5zZXQoZSwgdHJ1ZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3VtZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBlID0gSmgoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEZoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHRoaXMuX2dldFN5bWJvbEZvclRleHRQcm94eSh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGVzdCh0LCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnN1bWFibGUuZ2V0KHQpLnNldChlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRlc3QodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZSA9IEpoKGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBGaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0aGlzLl9nZXRTeW1ib2xGb3JUZXh0UHJveHkodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9jb25zdW1hYmxlLmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChpID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZ2V0KGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXZlcnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZSA9IEpoKGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBGaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSB0aGlzLl9nZXRTeW1ib2xGb3JUZXh0UHJveHkodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnRlc3QodCwgZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlLmdldCh0KS5zZXQoZSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFN5bWJvbEZvclRleHRQcm94eSh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fdGV4dFByb3h5UmVnaXN0cnkuZ2V0KHQuc3RhcnRPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5nZXQodC5lbmRPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBuLmdldCh0LnBhcmVudClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5fYWRkU3ltYm9sRm9yVGV4dFByb3h5KHQuc3RhcnRPZmZzZXQsIHQuZW5kT2Zmc2V0LCB0LnBhcmVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hZGRTeW1ib2xGb3JUZXh0UHJveHkodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFN5bWJvbChcInRleHRQcm94eVN5bWJvbFwiKTtcclxuICAgICAgICAgICAgICAgIGxldCBvLCByO1xyXG4gICAgICAgICAgICAgICAgbyA9IHRoaXMuX3RleHRQcm94eVJlZ2lzdHJ5LmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RleHRQcm94eVJlZ2lzdHJ5LnNldCh0LCBvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgciA9IG8uZ2V0KGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoZSwgcilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHIuc2V0KGksIG4pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSmgodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5zcGxpdChcIjpcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBlLmxlbmd0aCA+IDEgPyBlWzBdICsgXCI6XCIgKyBlWzFdIDogZVswXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgWWgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkgPSBxYyh7ZGlzcGF0Y2hlcjogdGhpc30sIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnZlcnRDaGFuZ2VzKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldE1hcmtlcnNUb1JlbW92ZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJ0TWFya2VyUmVtb3ZlKGUubmFtZSwgZS5yYW5nZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldENoYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnRJbnNlcnQoJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KGUucG9zaXRpb24sIGUubGVuZ3RoKSwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVydFJlbW92ZShlLnBvc2l0aW9uLCBlLmxlbmd0aCwgZS5uYW1lLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVydEF0dHJpYnV0ZShlLnJhbmdlLCBlLmF0dHJpYnV0ZUtleSwgZS5hdHRyaWJ1dGVPbGRWYWx1ZSwgZS5hdHRyaWJ1dGVOZXdWYWx1ZSwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5jb252ZXJzaW9uQXBpLm1hcHBlci5mbHVzaFVuYm91bmRNYXJrZXJOYW1lcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2V0KHQpLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb252ZXJ0TWFya2VyUmVtb3ZlKHQsIG4sIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udmVydE1hcmtlckFkZCh0LCBuLCBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0TWFya2Vyc1RvQWRkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnRNYXJrZXJBZGQoZS5uYW1lLCBlLnJhbmdlLCBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb252ZXJ0SW5zZXJ0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS53cml0ZXIgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzaW9uQXBpLmNvbnN1bWFibGUgPSB0aGlzLl9jcmVhdGVJbnNlcnRDb25zdW1hYmxlKHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5pdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSAkaC5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQoZS5wcmV2aW91c1Bvc2l0aW9uLCBlLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHtpdGVtOiB0LCByYW5nZTogaX07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVzdEFuZEZpcmUoXCJpbnNlcnRcIiwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4uYXR0cmlidXRlS2V5ID0gZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5hdHRyaWJ1dGVPbGRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4uYXR0cmlidXRlTmV3VmFsdWUgPSB0LmdldEF0dHJpYnV0ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVzdEFuZEZpcmUoYGF0dHJpYnV0ZToke2V9YCwgbilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhckNvbnZlcnNpb25BcGkoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb252ZXJ0UmVtb3ZlKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS53cml0ZXIgPSBuO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKFwicmVtb3ZlOlwiICsgaSwge3Bvc2l0aW9uOiB0LCBsZW5ndGg6IGV9LCB0aGlzLmNvbnZlcnNpb25BcGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2xlYXJDb252ZXJzaW9uQXBpKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29udmVydEF0dHJpYnV0ZSh0LCBlLCBpLCBuLCBvKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkud3JpdGVyID0gbztcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS5jb25zdW1hYmxlID0gdGhpcy5fY3JlYXRlQ29uc3VtYWJsZUZvclJhbmdlKHQsIGBhdHRyaWJ1dGU6JHtlfWApO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBvIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gby5pdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSAkaC5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQoby5wcmV2aW91c1Bvc2l0aW9uLCBvLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHtpdGVtOiB0LCByYW5nZTogciwgYXR0cmlidXRlS2V5OiBlLCBhdHRyaWJ1dGVPbGRWYWx1ZTogaSwgYXR0cmlidXRlTmV3VmFsdWU6IG59O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Rlc3RBbmRGaXJlKGBhdHRyaWJ1dGU6JHtlfWAsIHMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhckNvbnZlcnNpb25BcGkoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb252ZXJ0U2VsZWN0aW9uKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBBcnJheS5mcm9tKGUuZ2V0TWFya2Vyc0F0UG9zaXRpb24odC5nZXRGaXJzdFBvc2l0aW9uKCkpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS53cml0ZXIgPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzaW9uQXBpLmNvbnN1bWFibGUgPSB0aGlzLl9jcmVhdGVTZWxlY3Rpb25Db25zdW1hYmxlKHQsIG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKFwic2VsZWN0aW9uXCIsIHtzZWxlY3Rpb246IHR9LCB0aGlzLmNvbnZlcnNpb25BcGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFRaCh0LmdldEZpcnN0UG9zaXRpb24oKSwgZSwgdGhpcy5jb252ZXJzaW9uQXBpLm1hcHBlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHtpdGVtOiB0LCBtYXJrZXJOYW1lOiBlLm5hbWUsIG1hcmtlclJhbmdlOiBpfTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb252ZXJzaW9uQXBpLmNvbnN1bWFibGUudGVzdCh0LCBcImFkZE1hcmtlcjpcIiArIGUubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiYWRkTWFya2VyOlwiICsgZS5uYW1lLCBuLCB0aGlzLmNvbnZlcnNpb25BcGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbTogdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IHQuZ2V0Rmlyc3RSYW5nZSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVLZXk6IGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU9sZFZhbHVlOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVOZXdWYWx1ZTogdC5nZXRBdHRyaWJ1dGUoZSlcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnZlcnNpb25BcGkuY29uc3VtYWJsZS50ZXN0KHQsIFwiYXR0cmlidXRlOlwiICsgaS5hdHRyaWJ1dGVLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImF0dHJpYnV0ZTpcIiArIGkuYXR0cmlidXRlS2V5ICsgXCI6JHRleHRcIiwgaSwgdGhpcy5jb252ZXJzaW9uQXBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29udmVyc2lvbkFwaSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnZlcnRNYXJrZXJBZGQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlLnJvb3QuZG9jdW1lbnQgfHwgZS5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkud3JpdGVyID0gaTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBcImFkZE1hcmtlcjpcIiArIHQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IEtoO1xyXG4gICAgICAgICAgICAgICAgby5hZGQoZSwgbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkuY29uc3VtYWJsZSA9IG87XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUobiwge21hcmtlck5hbWU6IHQsIG1hcmtlclJhbmdlOiBlfSwgdGhpcy5jb252ZXJzaW9uQXBpKTtcclxuICAgICAgICAgICAgICAgIGlmICghby50ZXN0KGUsIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkuY29uc3VtYWJsZSA9IHRoaXMuX2NyZWF0ZUNvbnN1bWFibGVGb3JSYW5nZShlLCBuKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBlLmdldEl0ZW1zKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY29udmVyc2lvbkFwaS5jb25zdW1hYmxlLnRlc3QoaSwgbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHtpdGVtOiBpLCByYW5nZTogJGguX2NyZWF0ZU9uKGkpLCBtYXJrZXJOYW1lOiB0LCBtYXJrZXJSYW5nZTogZX07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKG4sIG8sIHRoaXMuY29udmVyc2lvbkFwaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyQ29udmVyc2lvbkFwaSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnZlcnRNYXJrZXJSZW1vdmUodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlLnJvb3QuZG9jdW1lbnQgfHwgZS5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkud3JpdGVyID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcInJlbW92ZU1hcmtlcjpcIiArIHQsIHttYXJrZXJOYW1lOiB0LCBtYXJrZXJSYW5nZTogZX0sIHRoaXMuY29udmVyc2lvbkFwaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhckNvbnZlcnNpb25BcGkoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlSW5zZXJ0Q29uc3VtYWJsZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IEtoO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gaS5pdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYWRkKHQsIFwiaW5zZXJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldEF0dHJpYnV0ZUtleXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmFkZCh0LCBcImF0dHJpYnV0ZTpcIiArIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUNvbnN1bWFibGVGb3JSYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IEtoO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuZ2V0SXRlbXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYWRkKG4sIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlU2VsZWN0aW9uQ29uc3VtYWJsZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IEtoO1xyXG4gICAgICAgICAgICAgICAgaS5hZGQodCwgXCJzZWxlY3Rpb25cIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYWRkKHQsIFwiYWRkTWFya2VyOlwiICsgbi5uYW1lKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5hZGQodCwgXCJhdHRyaWJ1dGU6XCIgKyBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3Rlc3RBbmRGaXJlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jb252ZXJzaW9uQXBpLmNvbnN1bWFibGUudGVzdChlLml0ZW0sIHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5pdGVtLm5hbWUgfHwgXCIkdGV4dFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHQgKyBcIjpcIiArIGksIGUsIHRoaXMuY29udmVyc2lvbkFwaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NsZWFyQ29udmVyc2lvbkFwaSgpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmNvbnZlcnNpb25BcGkud3JpdGVyO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY29udmVyc2lvbkFwaS5jb25zdW1hYmxlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKFloLCBkcyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFFoKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2V0UmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IEFycmF5LmZyb20odC5nZXRBbmNlc3RvcnMoKSk7XHJcbiAgICAgICAgICAgIG8uc2hpZnQoKTtcclxuICAgICAgICAgICAgby5yZXZlcnNlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBvLnNvbWUodCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5jb250YWluc0l0ZW0odCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaS50b1ZpZXdFbGVtZW50KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhIWUuZ2V0Q3VzdG9tUHJvcGVydHkoXCJhZGRIaWdobGlnaHRcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiAhclxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgWGgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmFuZ2VzID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRycyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VG8odCwgZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGFuY2hvcigpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yYW5nZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9yYW5nZXNbdGhpcy5fcmFuZ2VzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA/IHQuZW5kIDogdC5zdGFydFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Jhbmdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX3Jhbmdlc1t0aGlzLl9yYW5nZXMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID8gdC5zdGFydCA6IHQuZW5kXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNDb2xsYXBzZWQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fcmFuZ2VzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jhbmdlc1swXS5pc0NvbGxhcHNlZFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHJhbmdlQ291bnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmFuZ2VzLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNCYWNrd2FyZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc0NvbGxhcHNlZCAmJiB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0VxdWFsKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJhbmdlQ291bnQgIT0gdC5yYW5nZUNvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmFuZ2VDb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYW5jaG9yLmlzRXF1YWwodC5hbmNob3IpIHx8ICF0aGlzLmZvY3VzLmlzRXF1YWwodC5mb2N1cykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9yYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0Ll9yYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuaXNFcXVhbChuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIGdldFJhbmdlcygpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLl9yYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCBuZXcgJGgodC5zdGFydCwgdC5lbmQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEZpcnN0UmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5fcmFuZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0IHx8IGUuc3RhcnQuaXNCZWZvcmUodC5zdGFydCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA/IG5ldyAkaCh0LnN0YXJ0LCB0LmVuZCkgOiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldExhc3RSYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9yYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXQgfHwgZS5lbmQuaXNBZnRlcih0LmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA/IG5ldyAkaCh0LnN0YXJ0LCB0LmVuZCkgOiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEZpcnN0UG9zaXRpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRGaXJzdFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA/IHQuc3RhcnQuY2xvbmUoKSA6IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0TGFzdFBvc2l0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0TGFzdFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA/IHQuZW5kLmNsb25lKCkgOiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldFRvKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmFuZ2VzKFtdKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0IGluc3RhbmNlb2YgWGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXModC5nZXRSYW5nZXMoKSwgdC5pc0JhY2t3YXJkKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ICYmIHR5cGVvZiB0LmdldFJhbmdlcyA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXModC5nZXRSYW5nZXMoKSwgdC5pc0JhY2t3YXJkKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0IGluc3RhbmNlb2YgJGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXMoW3RdLCAhIWUgJiYgISFlLmJhY2t3YXJkKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0IGluc3RhbmNlb2YgVWgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXMoW25ldyAkaCh0KV0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQgaW5zdGFuY2VvZiB6aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSAhIWkgJiYgISFpLmJhY2t3YXJkO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlID09IFwiaW5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gJGguX2NyZWF0ZUluKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlID09IFwib25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gJGguX2NyZWF0ZU9uKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG5ldyAkaChVaC5fY3JlYXRlQXQodCwgZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLXNlbGVjdGlvbi1zZXRUby1yZXF1aXJlZC1zZWNvbmQtcGFyYW1ldGVyOiBcIiArIFwic2VsZWN0aW9uLnNldFRvIHJlcXVpcmVzIHRoZSBzZWNvbmQgcGFyYW1ldGVyIHdoZW4gdGhlIGZpcnN0IHBhcmFtZXRlciBpcyBhIG5vZGUuXCIsIFt0aGlzLCB0XSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmFuZ2VzKFtvXSwgbilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoanModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSYW5nZXModCwgZSAmJiAhIWUuYmFja3dhcmQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1zZWxlY3Rpb24tc2V0VG8tbm90LXNlbGVjdGFibGU6IENhbm5vdCBzZXQgdGhlIHNlbGVjdGlvbiB0byB0aGUgZ2l2ZW4gcGxhY2UuXCIsIFt0aGlzLCB0XSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldFJhbmdlcyh0LCBlID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIHQgPSBBcnJheS5mcm9tKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuc29tZShlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgJGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1zZWxlY3Rpb24tc2V0LXJhbmdlcy1ub3QtcmFuZ2U6IFwiICsgXCJTZWxlY3Rpb24gcmFuZ2Ugc2V0IHRvIGFuIG9iamVjdCB0aGF0IGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBtb2RlbC5SYW5nZS5cIiwgW3RoaXMsIHRdKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmFuZ2VzLmV2ZXJ5KHQgPT4gIXQuaXNFcXVhbChlKSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQubGVuZ3RoID09PSB0aGlzLl9yYW5nZXMubGVuZ3RoICYmICFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVBbGxSYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHVzaFJhbmdlKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA9ICEhZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZTpyYW5nZVwiLCB7ZGlyZWN0Q2hhbmdlOiB0cnVlfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0Rm9jdXModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYW5jaG9yID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLXNlbGVjdGlvbi1zZXRGb2N1cy1uby1yYW5nZXM6IENhbm5vdCBzZXQgc2VsZWN0aW9uIGZvY3VzIGlmIHRoZXJlIGFyZSBubyByYW5nZXMgaW4gc2VsZWN0aW9uLlwiLCBbdGhpcywgdF0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gVWguX2NyZWF0ZUF0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuY29tcGFyZVdpdGgodGhpcy5mb2N1cykgPT0gXCJzYW1lXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmFuY2hvcjtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yYW5nZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcG9wUmFuZ2UoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkuY29tcGFyZVdpdGgobikgPT0gXCJiZWZvcmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3B1c2hSYW5nZShuZXcgJGgoaSwgbikpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RSYW5nZUJhY2t3YXJkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wdXNoUmFuZ2UobmV3ICRoKG4sIGkpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sYXN0UmFuZ2VCYWNrd2FyZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6cmFuZ2VcIiwge2RpcmVjdENoYW5nZTogdHJ1ZX0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuZW50cmllcygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZUtleXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMua2V5cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhc0F0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXR0cnMuaGFzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNBdHRyaWJ1dGUodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdHRycy5kZWxldGUodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiY2hhbmdlOmF0dHJpYnV0ZVwiLCB7YXR0cmlidXRlS2V5czogW3RdLCBkaXJlY3RDaGFuZ2U6IHRydWV9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2V0QXR0cmlidXRlKHQpICE9PSBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXR0cnMuc2V0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZTphdHRyaWJ1dGVcIiwge2F0dHJpYnV0ZUtleXM6IFt0XSwgZGlyZWN0Q2hhbmdlOiB0cnVlfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U2VsZWN0ZWRFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucmFuZ2VDb3VudCAhPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaXJzdFJhbmdlKCkuZ2V0Q29udGFpbmVkRWxlbWVudCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwic2VsZWN0aW9uXCIgfHwgdCA9PSBcIm1vZGVsOnNlbGVjdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0U2VsZWN0ZWRCbG9ja3MoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IFdlYWtTZXQ7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlZihlLnN0YXJ0LCB0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSAmJiBuZihpLCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBlLmdldFdhbGtlcigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLml0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLnR5cGUgPT0gXCJlbGVtZW50RW5kXCIgJiYgdGYobiwgdCwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZWYoZS5lbmQsIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuICYmICFlLmVuZC5pc1RvdWNoaW5nKFVoLl9jcmVhdGVBdChuLCAwKSkgJiYgbmYobiwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29udGFpbnNFbnRpcmVDb250ZW50KHQgPSB0aGlzLmFuY2hvci5yb290KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gVWguX2NyZWF0ZUF0KHQsIDApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFVoLl9jcmVhdGVBdCh0LCBcImVuZFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLmlzVG91Y2hpbmcodGhpcy5nZXRGaXJzdFBvc2l0aW9uKCkpICYmIGkuaXNUb3VjaGluZyh0aGlzLmdldExhc3RQb3NpdGlvbigpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcHVzaFJhbmdlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrUmFuZ2UodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMucHVzaChuZXcgJGgodC5zdGFydCwgdC5lbmQpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2hlY2tSYW5nZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHRoaXMuX3Jhbmdlcy5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmlzSW50ZXJzZWN0aW5nKHRoaXMuX3Jhbmdlc1tlXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLXNlbGVjdGlvbi1yYW5nZS1pbnRlcnNlY3RzOiBUcnlpbmcgdG8gYWRkIGEgcmFuZ2UgdGhhdCBpbnRlcnNlY3RzIHdpdGggYW5vdGhlciByYW5nZSBpbiB0aGUgc2VsZWN0aW9uLlwiLCBbdGhpcywgdF0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZGVkUmFuZ2U6IHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3RpbmdSYW5nZTogdGhpcy5fcmFuZ2VzW2VdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlQWxsUmFuZ2VzKCkge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMuX3Jhbmdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcG9wUmFuZ2UoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcG9wUmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMucG9wKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoWGgsIGRzKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWmgodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUuYWRkKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdC5yb290LmRvY3VtZW50Lm1vZGVsLnNjaGVtYS5pc0Jsb2NrKHQpICYmIHQucGFyZW50XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0Zih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBaaCh0LCBlKSAmJiBuZih0LCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZWYodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpLnJvb3QuZG9jdW1lbnQubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICBjb25zdCBvID0gdC5wYXJlbnQuZ2V0QW5jZXN0b3JzKHtwYXJlbnRGaXJzdDogdHJ1ZSwgaW5jbHVkZVNlbGY6IHRydWV9KTtcclxuICAgICAgICAgICAgbGV0IHIgPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgcyA9IG8uZmluZCh0ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByID0gbi5pc0xpbWl0KHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFyICYmIFpoKHQsIGUpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBvLmZvckVhY2godCA9PiBlLmFkZCh0KSk7XHJcbiAgICAgICAgICAgIHJldHVybiBzXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZih0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBvZih0KTtcclxuICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmNvbnRhaW5zUmFuZ2UoJGguX2NyZWF0ZU9uKGkpLCB0cnVlKTtcclxuICAgICAgICAgICAgcmV0dXJuICFuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvZih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnJvb3QuZG9jdW1lbnQubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICBsZXQgaSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICB3aGlsZSAoaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuaXNCbG9jayhpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpID0gaS5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgcmYgZXh0ZW5kcyAkaCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgc2YuY2FsbCh0aGlzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXRhY2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PSBcImxpdmVSYW5nZVwiIHx8IHQgPT0gXCJtb2RlbDpsaXZlUmFuZ2VcIiB8fCBzdXBlci5pcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b1JhbmdlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyAkaCh0aGlzLnN0YXJ0LCB0aGlzLmVuZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21SYW5nZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHJmKHQuc3RhcnQsIHQuZW5kKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZigpIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLnJvb3QuZG9jdW1lbnQubW9kZWwsIFwiYXBwbHlPcGVyYXRpb25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpLmlzRG9jdW1lbnRPcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFmLmNhbGwodGhpcywgaSlcclxuICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd1wifSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFmKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0VHJhbnNmb3JtZWRCeU9wZXJhdGlvbih0KTtcclxuICAgICAgICAgICAgY29uc3QgaSA9ICRoLl9jcmVhdGVGcm9tUmFuZ2VzKGUpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gIWkuaXNFcXVhbCh0aGlzKTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGNmKHRoaXMsIHQpO1xyXG4gICAgICAgICAgICBsZXQgciA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSB0LnNvdXJjZVBvc2l0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgciA9IHQuZGVsZXRpb25Qb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnRvUmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQgPSBpLnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmQgPSBpLmVuZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZTpyYW5nZVwiLCBlLCB7ZGVsZXRpb25Qb3NpdGlvbjogcn0pXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiY2hhbmdlOmNvbnRlbnRcIiwgdGhpcy50b1JhbmdlKCksIHtkZWxldGlvblBvc2l0aW9uOiByfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2YodCwgZSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGUudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZVwiaW5zZXJ0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuY29udGFpbnNQb3NpdGlvbihlLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGNhc2VcIm1vdmVcIjpcclxuICAgICAgICAgICAgICAgIGNhc2VcInJlbW92ZVwiOlxyXG4gICAgICAgICAgICAgICAgY2FzZVwicmVpbnNlcnRcIjpcclxuICAgICAgICAgICAgICAgIGNhc2VcIm1lcmdlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuY29udGFpbnNQb3NpdGlvbihlLnNvdXJjZVBvc2l0aW9uKSB8fCB0LnN0YXJ0LmlzRXF1YWwoZS5zb3VyY2VQb3NpdGlvbikgfHwgdC5jb250YWluc1Bvc2l0aW9uKGUudGFyZ2V0UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgY2FzZVwic3BsaXRcIjpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jb250YWluc1Bvc2l0aW9uKGUuc3BsaXRQb3NpdGlvbikgfHwgdC5jb250YWluc1Bvc2l0aW9uKGUuaW5zZXJ0aW9uUG9zaXRpb24pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhyZiwgZHMpO1xyXG4gICAgICAgIGNvbnN0IGxmID0gXCJzZWxlY3Rpb246XCI7XHJcblxyXG4gICAgICAgIGNsYXNzIGRmIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uID0gbmV3IHVmKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLmRlbGVnYXRlKFwiY2hhbmdlOnJhbmdlXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLmRlbGVnYXRlKFwiY2hhbmdlOmF0dHJpYnV0ZVwiKS50byh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbi5kZWxlZ2F0ZShcImNoYW5nZTptYXJrZXJcIikudG8odGhpcylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQ29sbGFwc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5pc0NvbGxhcHNlZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgYW5jaG9yKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5hbmNob3JcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5mb2N1c1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcmFuZ2VDb3VudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24ucmFuZ2VDb3VudFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaGFzT3duUmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmhhc093blJhbmdlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpc0JhY2t3YXJkKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5pc0JhY2t3YXJkXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpc0dyYXZpdHlPdmVycmlkZGVuKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5pc0dyYXZpdHlPdmVycmlkZGVuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBtYXJrZXJzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5tYXJrZXJzXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfcmFuZ2VzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5fcmFuZ2VzXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFJhbmdlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0UmFuZ2VzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Rmlyc3RQb3NpdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0Rmlyc3RQb3NpdGlvbigpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldExhc3RQb3NpdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0TGFzdFBvc2l0aW9uKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Rmlyc3RSYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0Rmlyc3RSYW5nZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldExhc3RSYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0TGFzdFJhbmdlKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U2VsZWN0ZWRCbG9ja3MoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmdldFNlbGVjdGVkQmxvY2tzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U2VsZWN0ZWRFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5nZXRTZWxlY3RlZEVsZW1lbnQoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb250YWluc0VudGlyZUNvbnRlbnQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5jb250YWluc0VudGlyZUNvbnRlbnQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbi5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0QXR0cmlidXRlS2V5cygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uZ2V0QXR0cmlidXRlS2V5cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLmdldEF0dHJpYnV0ZXMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRBdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGlvbi5nZXRBdHRyaWJ1dGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFzQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24uaGFzQXR0cmlidXRlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3Rpb24uX3VwZGF0ZU1hcmtlcnMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbi5fdXBkYXRlQXR0cmlidXRlcyhmYWxzZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJzZWxlY3Rpb25cIiB8fCB0ID09IFwibW9kZWw6c2VsZWN0aW9uXCIgfHwgdCA9PSBcImRvY3VtZW50U2VsZWN0aW9uXCIgfHwgdCA9PSBcIm1vZGVsOmRvY3VtZW50U2VsZWN0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldEZvY3VzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbi5zZXRGb2N1cyh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0VG8odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLnNldFRvKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRBdHRyaWJ1dGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uLnNldEF0dHJpYnV0ZSh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbi5yZW1vdmVBdHRyaWJ1dGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFN0b3JlZEF0dHJpYnV0ZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0aW9uLl9nZXRTdG9yZWRBdHRyaWJ1dGVzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX292ZXJyaWRlR3Jhdml0eSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWxlY3Rpb24ub3ZlcnJpZGVHcmF2aXR5KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3Jlc3RvcmVHcmF2aXR5KHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbi5yZXN0b3JlR3Jhdml0eSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgX2dldFN0b3JlQXR0cmlidXRlS2V5KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsZiArIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9pc1N0b3JlQXR0cmlidXRlS2V5KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LnN0YXJ0c1dpdGgobGYpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKGRmLCBkcyk7XHJcblxyXG4gICAgICAgIGNsYXNzIHVmIGV4dGVuZHMgWGgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXJrZXJzID0gbmV3IHlzKHtpZFByb3BlcnR5OiBcIm5hbWVcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kZWwgPSB0Lm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnQgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0cmlidXRlUHJpb3JpdHkgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZml4R3JhdmV5YXJkUmFuZ2VzRGF0YSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faGFzQ2hhbmdlZFJhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vdmVycmlkZGVuR3Jhdml0eVJlZ2lzdGVyID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5fbW9kZWwsIFwiYXBwbHlPcGVyYXRpb25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZVswXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuaXNEb2N1bWVudE9wZXJhdGlvbiB8fCBpLnR5cGUgPT0gXCJtYXJrZXJcIiB8fCBpLnR5cGUgPT0gXCJyZW5hbWVcIiB8fCBpLnR5cGUgPT0gXCJub29wXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLl9maXhHcmF2ZXlhcmRSYW5nZXNEYXRhLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7bGl2ZVJhbmdlOiB0LCBzb3VyY2VQb3NpdGlvbjogZX0gPSB0aGlzLl9maXhHcmF2ZXlhcmRSYW5nZXNEYXRhLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpeEdyYXZleWFyZFNlbGVjdGlvbih0LCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faGFzQ2hhbmdlZFJhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc0NoYW5nZWRSYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6cmFuZ2VcIiwge2RpcmVjdENoYW5nZTogZmFsc2V9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTpyYW5nZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuZ2V0UmFuZ2VzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kb2N1bWVudC5fdmFsaWRhdGVTZWxlY3Rpb25SYW5nZSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImRvY3VtZW50LXNlbGVjdGlvbi13cm9uZy1wb3NpdGlvbjogUmFuZ2UgZnJvbSBkb2N1bWVudCBzZWxlY3Rpb24gc3RhcnRzIG9yIGVuZHMgYXQgaW5jb3JyZWN0IHBvc2l0aW9uLlwiLCB0aGlzLCB7cmFuZ2U6IHR9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuX21vZGVsLm1hcmtlcnMsIFwidXBkYXRlXCIsICgpID0+IHRoaXMuX3VwZGF0ZU1hcmtlcnMoKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuX2RvY3VtZW50LCBcImNoYW5nZVwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGZmKHRoaXMuX21vZGVsLCBlKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGlzQ29sbGFwc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX3Jhbmdlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PT0gMCA/IHRoaXMuX2RvY3VtZW50Ll9nZXREZWZhdWx0UmFuZ2UoKS5pc0NvbGxhcHNlZCA6IHN1cGVyLmlzQ29sbGFwc2VkXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBhbmNob3IoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuYW5jaG9yIHx8IHRoaXMuX2RvY3VtZW50Ll9nZXREZWZhdWx0UmFuZ2UoKS5zdGFydFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3VwZXIuZm9jdXMgfHwgdGhpcy5fZG9jdW1lbnQuX2dldERlZmF1bHRSYW5nZSgpLmVuZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcmFuZ2VDb3VudCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yYW5nZXMubGVuZ3RoID8gdGhpcy5fcmFuZ2VzLmxlbmd0aCA6IDFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGhhc093blJhbmdlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jhbmdlcy5sZW5ndGggPiAwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBpc0dyYXZpdHlPdmVycmlkZGVuKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5fb3ZlcnJpZGRlbkdyYXZpdHlSZWdpc3Rlci5zaXplXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHRoaXMuX3Jhbmdlcy5sZW5ndGg7IHQrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jhbmdlc1t0XS5kZXRhY2goKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBnZXRSYW5nZXMoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmFuZ2VzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkKiBzdXBlci5nZXRSYW5nZXMoKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLl9kb2N1bWVudC5fZ2V0RGVmYXVsdFJhbmdlKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Rmlyc3RSYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRGaXJzdFJhbmdlKCkgfHwgdGhpcy5fZG9jdW1lbnQuX2dldERlZmF1bHRSYW5nZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldExhc3RSYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRMYXN0UmFuZ2UoKSB8fCB0aGlzLl9kb2N1bWVudC5fZ2V0RGVmYXVsdFJhbmdlKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0VG8odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIuc2V0VG8odCwgZSwgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVBdHRyaWJ1dGVzKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlTWFya2VycygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldEZvY3VzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnNldEZvY3VzKHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQXR0cmlidXRlcyh0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZU1hcmtlcnMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NldEF0dHJpYnV0ZSh0LCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbdF07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiY2hhbmdlOmF0dHJpYnV0ZVwiLCB7YXR0cmlidXRlS2V5czogZSwgZGlyZWN0Q2hhbmdlOiB0cnVlfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZW1vdmVBdHRyaWJ1dGUodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gW3RdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZTphdHRyaWJ1dGVcIiwge2F0dHJpYnV0ZUtleXM6IGUsIGRpcmVjdENoYW5nZTogdHJ1ZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG92ZXJyaWRlR3Jhdml0eSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpcygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb3ZlcnJpZGRlbkdyYXZpdHlSZWdpc3Rlci5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3ZlcnJpZGRlbkdyYXZpdHlSZWdpc3Rlci5zaXplID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQXR0cmlidXRlcyh0cnVlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVzdG9yZUdyYXZpdHkodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9vdmVycmlkZGVuR3Jhdml0eVJlZ2lzdGVyLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJkb2N1bWVudC1zZWxlY3Rpb24tZ3Jhdml0eS13cm9uZy1yZXN0b3JlOiBBdHRlbXB0aW5nIHRvIHJlc3RvcmUgdGhlIHNlbGVjdGlvbiBncmF2aXR5IGZvciBhbiB1bmtub3duIFVJRC5cIiwgdGhpcywge3VpZDogdH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vdmVycmlkZGVuR3Jhdml0eVJlZ2lzdGVyLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0dyYXZpdHlPdmVycmlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQXR0cmlidXRlcyh0cnVlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcG9wUmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMucG9wKCkuZGV0YWNoKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3B1c2hSYW5nZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fcHJlcGFyZVJhbmdlKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMucHVzaChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcHJlcGFyZVJhbmdlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrUmFuZ2UodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5yb290ID09IHRoaXMuX2RvY3VtZW50LmdyYXZleWFyZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHJmLmZyb21SYW5nZSh0KTtcclxuICAgICAgICAgICAgICAgIGUub24oXCJjaGFuZ2U6cmFuZ2VcIiwgKHQsIGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNDaGFuZ2VkUmFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnJvb3QgPT0gdGhpcy5fZG9jdW1lbnQuZ3JhdmV5YXJkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpeEdyYXZleWFyZFJhbmdlc0RhdGEucHVzaCh7bGl2ZVJhbmdlOiBlLCBzb3VyY2VQb3NpdGlvbjogbi5kZWxldGlvblBvc2l0aW9ufSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVNYXJrZXJzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9tb2RlbC5tYXJrZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZ2V0UmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdGhpcy5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaS5jb250YWluc1JhbmdlKG4sICFuLmlzQ29sbGFwc2VkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5wdXNoKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gQXJyYXkuZnJvbSh0aGlzLm1hcmtlcnMpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWFya2Vycy5oYXMoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrZXJzLmFkZChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgQXJyYXkuZnJvbSh0aGlzLm1hcmtlcnMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0LmluY2x1ZGVzKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFya2Vycy5yZW1vdmUoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6bWFya2VyXCIsIHtvbGRNYXJrZXJzOiBpLCBkaXJlY3RDaGFuZ2U6IGZhbHNlfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZUF0dHJpYnV0ZXModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IEhzKHRoaXMuX2dldFN1cnJvdW5kaW5nQXR0cmlidXRlcygpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBIcyh0aGlzLmdldEF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2F0dHJpYnV0ZVByaW9yaXR5ID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdHRycyA9IG5ldyBNYXBcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbdCwgZV0gb2YgdGhpcy5fYXR0cmlidXRlUHJpb3JpdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT0gXCJsb3dcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXR0cnMuZGVsZXRlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXR0cmlidXRlUHJpb3JpdHkuZGVsZXRlKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRBdHRyaWJ1dGVzVG8oZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFt0LCBlXSBvZiB0aGlzLmdldEF0dHJpYnV0ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaS5oYXModCkgfHwgaS5nZXQodCkgIT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbdF0gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5oYXNBdHRyaWJ1dGUodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZTphdHRyaWJ1dGVcIiwge2F0dHJpYnV0ZUtleXM6IG4sIGRpcmVjdENoYW5nZTogZmFsc2V9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0QXR0cmlidXRlKHQsIGUsIGkgPSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaSA/IFwibm9ybWFsXCIgOiBcImxvd1wiO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gPT0gXCJsb3dcIiAmJiB0aGlzLl9hdHRyaWJ1dGVQcmlvcml0eS5nZXQodCkgPT0gXCJub3JtYWxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHN1cGVyLmdldEF0dHJpYnV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChvID09PSBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRycy5zZXQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRyaWJ1dGVQcmlvcml0eS5zZXQodCwgbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlQXR0cmlidXRlKHQsIGUgPSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZSA/IFwibm9ybWFsXCIgOiBcImxvd1wiO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT0gXCJsb3dcIiAmJiB0aGlzLl9hdHRyaWJ1dGVQcmlvcml0eS5nZXQodCkgPT0gXCJub3JtYWxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0cmlidXRlUHJpb3JpdHkuc2V0KHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzdXBlci5oYXNBdHRyaWJ1dGUodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2F0dHJzLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRBdHRyaWJ1dGVzVG8odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtlLCBpXSBvZiB0aGlzLmdldEF0dHJpYnV0ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmdldChlKSA9PT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVBdHRyaWJ1dGUoZSwgZmFsc2UpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpLCBuXSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX3NldEF0dHJpYnV0ZShpLCBuLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5hZGQoaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIF9nZXRTdG9yZWRBdHRyaWJ1dGVzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0Rmlyc3RQb3NpdGlvbigpLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQ29sbGFwc2VkICYmIHQuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldEF0dHJpYnV0ZUtleXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5zdGFydHNXaXRoKGxmKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuc3Vic3RyKGxmLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZFtpLCB0LmdldEF0dHJpYnV0ZShlKV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFN1cnJvdW5kaW5nQXR0cmlidXRlcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmdldEZpcnN0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9tb2RlbC5zY2hlbWE7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRGaXJzdFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uaXRlbS5pcyhcImVsZW1lbnRcIikgJiYgZS5pc09iamVjdChuLml0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLnR5cGUgPT0gXCJ0ZXh0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBuLml0ZW0uZ2V0QXR0cmlidXRlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudGV4dE5vZGUgPyB0LnRleHROb2RlIDogdC5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRleHROb2RlID8gdC50ZXh0Tm9kZSA6IHQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0dyYXZpdHlPdmVycmlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBoZihlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGhmKG4pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0dyYXZpdHlPdmVycmlkZGVuICYmICFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0ID0gZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHQgJiYgIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSB0LnByZXZpb3VzU2libGluZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBoZih0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IG47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICh0ICYmICFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ID0gdC5uZXh0U2libGluZztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBoZih0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gdGhpcy5fZ2V0U3RvcmVkQXR0cmlidXRlcygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2ZpeEdyYXZleWFyZFNlbGVjdGlvbih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX21vZGVsLnNjaGVtYS5nZXROZWFyZXN0U2VsZWN0aW9uUmFuZ2UoaSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5fcmFuZ2VzLmluZGV4T2YodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMuc3BsaWNlKG8sIDEpO1xyXG4gICAgICAgICAgICAgICAgdC5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX3ByZXBhcmVSYW5nZShuKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yYW5nZXMuc3BsaWNlKG8sIDAsIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhmKHQpIHtcclxuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBGaCB8fCB0IGluc3RhbmNlb2YgTGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LmdldEF0dHJpYnV0ZXMoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmZih0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmRvY3VtZW50LmRpZmZlcjtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIGkuZ2V0Q2hhbmdlcygpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobi50eXBlICE9IFwiaW5zZXJ0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG4ucG9zaXRpb24ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ubGVuZ3RoID09PSBpLm1heE9mZnNldDtcclxuICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5lbnF1ZXVlQ2hhbmdlKGUsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gQXJyYXkuZnJvbShpLmdldEF0dHJpYnV0ZUtleXMoKSkuZmlsdGVyKHQgPT4gdC5zdGFydHNXaXRoKGxmKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZShuLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZ2Yge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaGVycyA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWRkKHQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9kaXNwYXRjaGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIHQoZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtZiA9IDEsIHBmID0gNDtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYmYodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gSHIodCwgbWYgfCBwZilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB3ZiA9IGJmO1xyXG5cclxuICAgICAgICBjbGFzcyBrZiBleHRlbmRzIGdmIHtcclxuICAgICAgICAgICAgZWxlbWVudFRvRWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZGQoTmYodCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZVRvRWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hZGQoTWYodCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZVRvQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZChCZih0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWFya2VyVG9FbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZCh6Zih0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWFya2VyVG9IaWdobGlnaHQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkKExmKHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfZigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS5jb25zdW1lKGUuaXRlbSwgXCJpbnNlcnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLndyaXRlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLm1hcHBlci50b1ZpZXdQb3NpdGlvbihlLnJhbmdlLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmNyZWF0ZVRleHQoZS5pdGVtLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgbi5pbnNlcnQobywgcilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdmYoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkubWFwcGVyLnRvVmlld1Bvc2l0aW9uKGUucG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUucG9zaXRpb24uZ2V0U2hpZnRlZEJ5KGUubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBpLm1hcHBlci50b1ZpZXdQb3NpdGlvbihvLCB7aXNQaGFudG9tOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gaS53cml0ZXIuY3JlYXRlUmFuZ2Uobiwgcik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gaS53cml0ZXIucmVtb3ZlKHMuZ2V0VHJpbW1lZCgpKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpLndyaXRlci5jcmVhdGVSYW5nZUluKGEpLmdldEl0ZW1zKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLm1hcHBlci51bmJpbmRWaWV3RWxlbWVudCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB5Zih0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmNyZWF0ZUF0dHJpYnV0ZUVsZW1lbnQoXCJzcGFuXCIsIGUuYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgIGlmIChlLmNsYXNzZXMpIHtcclxuICAgICAgICAgICAgICAgIGkuX2FkZENsYXNzKGUuY2xhc3NlcylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZS5wcmlvcml0eSkge1xyXG4gICAgICAgICAgICAgICAgaS5fcHJpb3JpdHkgPSBlLnByaW9yaXR5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaS5faWQgPSBlLmlkO1xyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24geGYoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4uaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghaS5jb25zdW1hYmxlLmNvbnN1bWUobiwgXCJzZWxlY3Rpb25cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuLmdldFJhbmdlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGkubWFwcGVyLnRvVmlld1JhbmdlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIG8ucHVzaChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS53cml0ZXIuc2V0U2VsZWN0aW9uKG8sIHtiYWNrd2FyZDogbi5pc0JhY2t3YXJkfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ2YoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS5jb25zdW1lKG4sIFwic2VsZWN0aW9uXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbi5nZXRGaXJzdFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gaS5tYXBwZXIudG9WaWV3UG9zaXRpb24ocik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gby5icmVha0F0dHJpYnV0ZXMocyk7XHJcbiAgICAgICAgICAgICAgICBvLnNldFNlbGVjdGlvbihhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBBZigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygby5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmVuZC5wYXJlbnQuaXNBdHRhY2hlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLndyaXRlci5tZXJnZUF0dHJpYnV0ZXModC5zdGFydClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG4uc2V0U2VsZWN0aW9uKG51bGwpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFRmKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdChpLmF0dHJpYnV0ZU9sZFZhbHVlLCBuLndyaXRlcik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdChpLmF0dHJpYnV0ZU5ld1ZhbHVlLCBuLndyaXRlcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW8gJiYgIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghbi5jb25zdW1hYmxlLmNvbnN1bWUoaS5pdGVtLCBlLm5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbi53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gcy5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5pdGVtIGluc3RhbmNlb2YgWGggfHwgaS5pdGVtIGluc3RhbmNlb2YgZGYpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLndyYXAoYS5nZXRGaXJzdFJhbmdlKCksIHIpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0ID0gbi5tYXBwZXIudG9WaWV3UmFuZ2UoaS5yYW5nZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuYXR0cmlidXRlT2xkVmFsdWUgIT09IG51bGwgJiYgbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gcy51bndyYXAodCwgbylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuYXR0cmlidXRlTmV3VmFsdWUgIT09IG51bGwgJiYgcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzLndyYXAodCwgcilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFBmKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdChpLml0ZW0sIG4ud3JpdGVyKTtcclxuICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnN1bWFibGUuY29uc3VtZShpLml0ZW0sIFwiaW5zZXJ0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbi5tYXBwZXIudG9WaWV3UG9zaXRpb24oaS5yYW5nZS5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBuLm1hcHBlci5iaW5kRWxlbWVudHMoaS5pdGVtLCBvKTtcclxuICAgICAgICAgICAgICAgIG4ud3JpdGVyLmluc2VydChyLCBvKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBTZih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZSwgaSwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaS5pc09wZW5pbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHQoaSwgbi53cml0ZXIpO1xyXG4gICAgICAgICAgICAgICAgaS5pc09wZW5pbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0KGksIG4ud3JpdGVyKTtcclxuICAgICAgICAgICAgICAgIGlmICghbyB8fCAhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGkubWFya2VyUmFuZ2U7XHJcbiAgICAgICAgICAgICAgICBpZiAocy5pc0NvbGxhcHNlZCAmJiAhbi5jb25zdW1hYmxlLmNvbnN1bWUocywgZS5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW4uY29uc3VtYWJsZS5jb25zdW1lKHQuaXRlbSwgZS5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gbi5tYXBwZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gbi53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBjLmluc2VydChhLnRvVmlld1Bvc2l0aW9uKHMuc3RhcnQpLCBvKTtcclxuICAgICAgICAgICAgICAgIG4ubWFwcGVyLmJpbmRFbGVtZW50VG9NYXJrZXIobywgaS5tYXJrZXJOYW1lKTtcclxuICAgICAgICAgICAgICAgIGlmICghcy5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGMuaW5zZXJ0KGEudG9WaWV3UG9zaXRpb24ocy5lbmQpLCByKTtcclxuICAgICAgICAgICAgICAgICAgICBuLm1hcHBlci5iaW5kRWxlbWVudFRvTWFya2VyKHIsIGkubWFya2VyTmFtZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuc3RvcCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEVmKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLm1hcHBlci5tYXJrZXJOYW1lVG9FbGVtZW50cyhlLm1hcmtlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGkubWFwcGVyLnVuYmluZEVsZW1lbnRGcm9tTWFya2VyTmFtZSh0LCBlLm1hcmtlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkud3JpdGVyLmNsZWFyKGkud3JpdGVyLmNyZWF0ZVJhbmdlT24odCksIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpLndyaXRlci5jbGVhckNsb25lZEVsZW1lbnRzR3JvdXAoZS5tYXJrZXJOYW1lKTtcclxuICAgICAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFJmKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdChpLmF0dHJpYnV0ZU9sZFZhbHVlLCBpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0KGkuYXR0cmlidXRlTmV3VmFsdWUsIGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvICYmICFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIW4uY29uc3VtYWJsZS5jb25zdW1lKGkuaXRlbSwgZS5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4ubWFwcGVyLnRvVmlld0VsZW1lbnQoaS5pdGVtKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBuLndyaXRlcjtcclxuICAgICAgICAgICAgICAgIGlmICghcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb252ZXJzaW9uLWF0dHJpYnV0ZS10by1hdHRyaWJ1dGUtb24tdGV4dDogXCIgKyBcIlRyeWluZyB0byBjb252ZXJ0IHRleHQgbm9kZSdzIGF0dHJpYnV0ZSB3aXRoIGF0dHJpYnV0ZS10by1hdHRyaWJ1dGUgY29udmVydGVyLlwiLCBbaSwgbl0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5hdHRyaWJ1dGVPbGRWYWx1ZSAhPT0gbnVsbCAmJiBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8ua2V5ID09IFwiY2xhc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gQXJyYXkuaXNBcnJheShvLnZhbHVlKSA/IG8udmFsdWUgOiBbby52YWx1ZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlbW92ZUNsYXNzKGUsIHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG8ua2V5ID09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gT2JqZWN0LmtleXMoby52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnJlbW92ZVN0eWxlKGUsIHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLnJlbW92ZUF0dHJpYnV0ZShvLmtleSwgcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5hdHRyaWJ1dGVOZXdWYWx1ZSAhPT0gbnVsbCAmJiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIua2V5ID09IFwiY2xhc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gQXJyYXkuaXNBcnJheShyLnZhbHVlKSA/IHIudmFsdWUgOiBbci52YWx1ZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmFkZENsYXNzKGUsIHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHIua2V5ID09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gT2JqZWN0LmtleXMoci52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLnNldFN0eWxlKGUsIHIudmFsdWVbZV0sIHMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhLnNldEF0dHJpYnV0ZShyLmtleSwgci52YWx1ZSwgcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE9mKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCEoaS5pdGVtIGluc3RhbmNlb2YgWGggfHwgaS5pdGVtIGluc3RhbmNlb2YgZGYpICYmICFpLml0ZW0uaXMoXCJ0ZXh0UHJveHlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBXZih0LCBpLCBuKTtcclxuICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnN1bWFibGUuY29uc3VtZShpLml0ZW0sIGUubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLndyaXRlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB5ZihyLCBvKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSByLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmIChpLml0ZW0gaW5zdGFuY2VvZiBYaCB8fCBpLml0ZW0gaW5zdGFuY2VvZiBkZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHIud3JhcChhLmdldEZpcnN0UmFuZ2UoKSwgcywgYSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG4ubWFwcGVyLnRvVmlld1JhbmdlKGkucmFuZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSByLndyYXAodCwgcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUuZ2V0SXRlbXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikgJiYgdC5pc1NpbWlsYXIocykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ubWFwcGVyLmJpbmRFbGVtZW50VG9NYXJrZXIodCwgaS5tYXJrZXJOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIElmKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCEoaS5pdGVtIGluc3RhbmNlb2YgamgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gV2YodCwgaSwgbik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW8pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghbi5jb25zdW1hYmxlLnRlc3QoaS5pdGVtLCBlLm5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbi5tYXBwZXIudG9WaWV3RWxlbWVudChpLml0ZW0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIgJiYgci5nZXRDdXN0b21Qcm9wZXJ0eShcImFkZEhpZ2hsaWdodFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4uY29uc3VtYWJsZS5jb25zdW1lKGkuaXRlbSwgZS5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgJGguX2NyZWF0ZUluKGkuaXRlbSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5jb25zdW1hYmxlLmNvbnN1bWUodC5pdGVtLCBlLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHIuZ2V0Q3VzdG9tUHJvcGVydHkoXCJhZGRIaWdobGlnaHRcIikociwgbywgbi53cml0ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4ubWFwcGVyLmJpbmRFbGVtZW50VG9NYXJrZXIociwgaS5tYXJrZXJOYW1lKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBWZih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZSwgaSwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkubWFya2VyUmFuZ2UuaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBXZih0LCBpLCBuKTtcclxuICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHlmKG4ud3JpdGVyLCBvKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLm1hcHBlci5tYXJrZXJOYW1lVG9FbGVtZW50cyhpLm1hcmtlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygcykge1xyXG4gICAgICAgICAgICAgICAgICAgIG4ubWFwcGVyLnVuYmluZEVsZW1lbnRGcm9tTWFya2VyTmFtZSh0LCBpLm1hcmtlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmlzKFwiYXR0cmlidXRlRWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLndyaXRlci51bndyYXAobi53cml0ZXIuY3JlYXRlUmFuZ2VPbih0KSwgcilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmdldEN1c3RvbVByb3BlcnR5KFwicmVtb3ZlSGlnaGxpZ2h0XCIpKHQsIG8uaWQsIG4ud3JpdGVyKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG4ud3JpdGVyLmNsZWFyQ2xvbmVkRWxlbWVudHNHcm91cChpLm1hcmtlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTmYodCkge1xyXG4gICAgICAgICAgICB0ID0gd2YodCk7XHJcbiAgICAgICAgICAgIHQudmlldyA9IEZmKHQudmlldywgXCJjb250YWluZXJcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IHtcclxuICAgICAgICAgICAgICAgIGUub24oXCJpbnNlcnQ6XCIgKyB0Lm1vZGVsLCBQZih0LnZpZXcpLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJub3JtYWxcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE1mKHQpIHtcclxuICAgICAgICAgICAgdCA9IHdmKHQpO1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbC5rZXkgPyB0Lm1vZGVsLmtleSA6IHQubW9kZWw7XHJcbiAgICAgICAgICAgIGxldCBpID0gXCJhdHRyaWJ1dGU6XCIgKyBlO1xyXG4gICAgICAgICAgICBpZiAodC5tb2RlbC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpICs9IFwiOlwiICsgdC5tb2RlbC5uYW1lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQubW9kZWwudmFsdWVzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5tb2RlbC52YWx1ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnZpZXdbZV0gPSBGZih0LnZpZXdbZV0sIFwiYXR0cmlidXRlXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0LnZpZXcgPSBGZih0LnZpZXcsIFwiYXR0cmlidXRlXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9IGpmKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLm9uKGksIFRmKG4pLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJub3JtYWxcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEJmKHQpIHtcclxuICAgICAgICAgICAgdCA9IHdmKHQpO1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbC5rZXkgPyB0Lm1vZGVsLmtleSA6IHQubW9kZWw7XHJcbiAgICAgICAgICAgIGxldCBpID0gXCJhdHRyaWJ1dGU6XCIgKyBlO1xyXG4gICAgICAgICAgICBpZiAodC5tb2RlbC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBpICs9IFwiOlwiICsgdC5tb2RlbC5uYW1lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQubW9kZWwudmFsdWVzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5tb2RlbC52YWx1ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnZpZXdbZV0gPSBIZih0LnZpZXdbZV0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0LnZpZXcgPSBIZih0LnZpZXcpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9IGpmKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLm9uKGksIFJmKG4pLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJub3JtYWxcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHpmKHQpIHtcclxuICAgICAgICAgICAgdCA9IHdmKHQpO1xyXG4gICAgICAgICAgICB0LnZpZXcgPSBGZih0LnZpZXcsIFwidWlcIik7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IHtcclxuICAgICAgICAgICAgICAgIGUub24oXCJhZGRNYXJrZXI6XCIgKyB0Lm1vZGVsLCBTZih0LnZpZXcpLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJub3JtYWxcIn0pO1xyXG4gICAgICAgICAgICAgICAgZS5vbihcInJlbW92ZU1hcmtlcjpcIiArIHQubW9kZWwsIEVmKHQudmlldyksIHtwcmlvcml0eTogdC5jb252ZXJ0ZXJQcmlvcml0eSB8fCBcIm5vcm1hbFwifSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTGYodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiYWRkTWFya2VyOlwiICsgdC5tb2RlbCwgT2YodC52aWV3KSwge3ByaW9yaXR5OiB0LmNvbnZlcnRlclByaW9yaXR5IHx8IFwibm9ybWFsXCJ9KTtcclxuICAgICAgICAgICAgICAgIGUub24oXCJhZGRNYXJrZXI6XCIgKyB0Lm1vZGVsLCBJZih0LnZpZXcpLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJub3JtYWxcIn0pO1xyXG4gICAgICAgICAgICAgICAgZS5vbihcInJlbW92ZU1hcmtlcjpcIiArIHQubW9kZWwsIFZmKHQudmlldyksIHtwcmlvcml0eTogdC5jb252ZXJ0ZXJQcmlvcml0eSB8fCBcIm5vcm1hbFwifSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRmYodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAoaSwgbikgPT4gRGYodCwgbiwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIERmKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIHQgPSB7bmFtZTogdH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgbjtcclxuICAgICAgICAgICAgY29uc3QgbyA9IE9iamVjdC5hc3NpZ24oe30sIHQuYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgIGlmIChpID09IFwiY29udGFpbmVyXCIpIHtcclxuICAgICAgICAgICAgICAgIG4gPSBlLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQodC5uYW1lLCBvKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gXCJhdHRyaWJ1dGVcIikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHtwcmlvcml0eTogdC5wcmlvcml0eSB8fCB3bC5ERUZBVUxUX1BSSU9SSVRZfTtcclxuICAgICAgICAgICAgICAgIG4gPSBlLmNyZWF0ZUF0dHJpYnV0ZUVsZW1lbnQodC5uYW1lLCBvLCBpKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbiA9IGUuY3JlYXRlVUlFbGVtZW50KHQubmFtZSwgbylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zdHlsZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBPYmplY3Qua2V5cyh0LnN0eWxlcyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG8gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc2V0U3R5bGUobywgdC5zdHlsZXNbb10sIG4pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQuY2xhc3Nlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuY2xhc3NlcztcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5hZGRDbGFzcyhpLCBuKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmFkZENsYXNzKHQsIG4pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBqZih0KSB7XHJcbiAgICAgICAgICAgIGlmICh0Lm1vZGVsLnZhbHVlcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudmlld1tlXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbihlLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQudmlld1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIZih0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZSA9PiAoe2tleTogdCwgdmFsdWU6IGV9KVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB0ID09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IHRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPT4gKHtrZXk6IHQua2V5LCB2YWx1ZTogZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBXZih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0eXBlb2YgdCA9PSBcImZ1bmN0aW9uXCIgPyB0KGUsIGkpIDogdDtcclxuICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghbi5wcmlvcml0eSkge1xyXG4gICAgICAgICAgICAgICAgbi5wcmlvcml0eSA9IDEwXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFuLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBuLmlkID0gZS5tYXJrZXJOYW1lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHFmIGV4dGVuZHMgZ2Yge1xyXG4gICAgICAgICAgICBlbGVtZW50VG9FbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZChLZih0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZWxlbWVudFRvQXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZChKZih0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXR0cmlidXRlVG9BdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkKFlmKHQpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50VG9NYXJrZXIodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRkKFFmKHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBVZigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUubW9kZWxSYW5nZSAmJiBpLmNvbnN1bWFibGUuY29uc3VtZShlLnZpZXdJdGVtLCB7bmFtZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qge21vZGVsUmFuZ2U6IHQsIG1vZGVsQ3Vyc29yOiBufSA9IGkuY29udmVydENoaWxkcmVuKGUudmlld0l0ZW0sIGUubW9kZWxDdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUubW9kZWxSYW5nZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5tb2RlbEN1cnNvciA9IG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gJGYoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuc2NoZW1hLmNoZWNrQ2hpbGQoZS5tb2RlbEN1cnNvciwgXCIkdGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLmNvbnN1bWFibGUuY29uc3VtZShlLnZpZXdJdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gaS53cml0ZXIuY3JlYXRlVGV4dChlLnZpZXdJdGVtLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLndyaXRlci5pbnNlcnQodCwgZS5tb2RlbEN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUubW9kZWxSYW5nZSA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdChlLm1vZGVsQ3Vyc29yLCB0Lm9mZnNldFNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLm1vZGVsQ3Vyc29yID0gZS5tb2RlbFJhbmdlLmVuZFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gR2YodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLm5ld1NlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgWGg7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygby5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHMucHVzaChlLnRvTW9kZWxSYW5nZSh0KSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHIuc2V0VG8ocywge2JhY2t3YXJkOiBvLmlzQmFja3dhcmR9KTtcclxuICAgICAgICAgICAgICAgIGlmICghci5pc0VxdWFsKHQuZG9jdW1lbnQuc2VsZWN0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbihyKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtmKHQpIHtcclxuICAgICAgICAgICAgdCA9IHdmKHQpO1xyXG4gICAgICAgICAgICBjb25zdCBlID0gWmYodCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBYZih0LnZpZXcpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaSA/IFwiZWxlbWVudDpcIiArIGkgOiBcImVsZW1lbnRcIjtcclxuICAgICAgICAgICAgcmV0dXJuIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaS5vbihuLCBlLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJub3JtYWxcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEpmKHQpIHtcclxuICAgICAgICAgICAgdCA9IHdmKHQpO1xyXG4gICAgICAgICAgICBpZyh0KTtcclxuICAgICAgICAgICAgY29uc3QgZSA9IG5nKHQsIGZhbHNlKTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFhmKHQudmlldyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpID8gXCJlbGVtZW50OlwiICsgaSA6IFwiZWxlbWVudFwiO1xyXG4gICAgICAgICAgICByZXR1cm4gaSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpLm9uKG4sIGUsIHtwcmlvcml0eTogdC5jb252ZXJ0ZXJQcmlvcml0eSB8fCBcImxvd1wifSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWWYodCkge1xyXG4gICAgICAgICAgICB0ID0gd2YodCk7XHJcbiAgICAgICAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0LnZpZXcgPT0gXCJzdHJpbmdcIiB8fCB0LnZpZXcua2V5KSB7XHJcbiAgICAgICAgICAgICAgICBlID0gZWcodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZyh0LCBlKTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IG5nKHQsIHRydWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiZWxlbWVudFwiLCBpLCB7cHJpb3JpdHk6IHQuY29udmVydGVyUHJpb3JpdHkgfHwgXCJsb3dcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFFmKHQpIHtcclxuICAgICAgICAgICAgdCA9IHdmKHQpO1xyXG4gICAgICAgICAgICBzZyh0KTtcclxuICAgICAgICAgICAgcmV0dXJuIEtmKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBYZih0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiB0Lm5hbWUgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQubmFtZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBaZih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnZpZXcgPyBuZXcgV3ModC52aWV3KSA6IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiAoaSwgbiwgbykgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHIgPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUubWF0Y2gobi52aWV3SXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByID0gdC5tYXRjaFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgci5uYW1lID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0Zyh0Lm1vZGVsLCBuLnZpZXdJdGVtLCBvLndyaXRlcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghby5jb25zdW1hYmxlLnRlc3Qobi52aWV3SXRlbSwgcikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBvLnNwbGl0VG9BbGxvd2VkUGFyZW50KHMsIG4ubW9kZWxDdXJzb3IpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvLndyaXRlci5pbnNlcnQocywgYS5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBvLmNvbnZlcnRDaGlsZHJlbihuLnZpZXdJdGVtLCBvLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KHMsIDApKTtcclxuICAgICAgICAgICAgICAgIG8uY29uc3VtYWJsZS5jb25zdW1lKG4udmlld0l0ZW0sIHIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IG8uZ2V0U3BsaXRQYXJ0cyhzKTtcclxuICAgICAgICAgICAgICAgIG4ubW9kZWxSYW5nZSA9IG5ldyAkaChvLndyaXRlci5jcmVhdGVQb3NpdGlvbkJlZm9yZShzKSwgby53cml0ZXIuY3JlYXRlUG9zaXRpb25BZnRlcihjW2MubGVuZ3RoIC0gMV0pKTtcclxuICAgICAgICAgICAgICAgIGlmIChhLmN1cnNvclBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4ubW9kZWxDdXJzb3IgPSBvLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KGEuY3Vyc29yUGFyZW50LCAwKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuLm1vZGVsQ3Vyc29yID0gbi5tb2RlbFJhbmdlLmVuZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0Zyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0KGUsIGkpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaS5jcmVhdGVFbGVtZW50KHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVnKHQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0LnZpZXcgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdC52aWV3ID0ge2tleTogdC52aWV3fVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnZpZXcua2V5O1xyXG4gICAgICAgICAgICBsZXQgaTtcclxuICAgICAgICAgICAgaWYgKGUgPT0gXCJjbGFzc1wiIHx8IGUgPT0gXCJzdHlsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZSA9PSBcImNsYXNzXCIgPyBcImNsYXNzZXNcIiA6IFwic3R5bGVzXCI7XHJcbiAgICAgICAgICAgICAgICBpID0ge1tuXTogdC52aWV3LnZhbHVlfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHR5cGVvZiB0LnZpZXcudmFsdWUgPT0gXCJ1bmRlZmluZWRcIiA/IC9bXFxzXFxTXSovIDogdC52aWV3LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgaSA9IHthdHRyaWJ1dGVzOiB7W2VdOiBufX1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC52aWV3Lm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGkubmFtZSA9IHQudmlldy5uYW1lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC52aWV3ID0gaTtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlnKHQsIGUgPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBlID09PSBudWxsID8gdHJ1ZSA6IHQgPT4gdC5nZXRBdHRyaWJ1dGUoZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0eXBlb2YgdC5tb2RlbCAhPSBcIm9iamVjdFwiID8gdC5tb2RlbCA6IHQubW9kZWwua2V5O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gdHlwZW9mIHQubW9kZWwgIT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgdC5tb2RlbC52YWx1ZSA9PSBcInVuZGVmaW5lZFwiID8gaSA6IHQubW9kZWwudmFsdWU7XHJcbiAgICAgICAgICAgIHQubW9kZWwgPSB7a2V5OiBuLCB2YWx1ZTogb31cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG5nKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBXcyh0LnZpZXcpO1xyXG4gICAgICAgICAgICByZXR1cm4gKG4sIG8sIHIpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBpLm1hdGNoKG8udmlld0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gdC5tb2RlbC5rZXk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gdHlwZW9mIHQubW9kZWwudmFsdWUgPT0gXCJmdW5jdGlvblwiID8gdC5tb2RlbC52YWx1ZShvLnZpZXdJdGVtKSA6IHQubW9kZWwudmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoYyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG9nKHQudmlldywgby52aWV3SXRlbSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLm1hdGNoLm5hbWUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzLm1hdGNoLm5hbWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghci5jb25zdW1hYmxlLnRlc3Qoby52aWV3SXRlbSwgcy5tYXRjaCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghby5tb2RlbFJhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbyA9IE9iamVjdC5hc3NpZ24obywgci5jb252ZXJ0Q2hpbGRyZW4oby52aWV3SXRlbSwgby5tb2RlbEN1cnNvcikpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gcmcoby5tb2RlbFJhbmdlLCB7a2V5OiBhLCB2YWx1ZTogY30sIGUsIHIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByLmNvbnN1bWFibGUuY29uc3VtZShvLnZpZXdJdGVtLCBzLm1hdGNoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvZyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0eXBlb2YgdCA9PSBcImZ1bmN0aW9uXCIgPyB0KGUpIDogdDtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBpID09IFwib2JqZWN0XCIgJiYgIVhmKGkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gIWkuY2xhc3NlcyAmJiAhaS5hdHRyaWJ1dGVzICYmICFpLnN0eWxlc1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmcodCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICBsZXQgbyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHIgb2YgQXJyYXkuZnJvbSh0LmdldEl0ZW1zKHtzaGFsbG93OiBpfSkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5zY2hlbWEuY2hlY2tBdHRyaWJ1dGUociwgZS5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi53cml0ZXIuc2V0QXR0cmlidXRlKGUua2V5LCBlLnZhbHVlLCByKTtcclxuICAgICAgICAgICAgICAgICAgICBvID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsO1xyXG4gICAgICAgICAgICB0Lm1vZGVsID0gKHQsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0eXBlb2YgZSA9PSBcInN0cmluZ1wiID8gZSA6IGUodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaS5jcmVhdGVFbGVtZW50KFwiJG1hcmtlclwiLCB7XCJkYXRhLW5hbWVcIjogbn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGFnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbCA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcgPSBuZXcgQmgoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcHBlciA9IG5ldyBHaDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG93bmNhc3REaXNwYXRjaGVyID0gbmV3IFloKHttYXBwZXI6IHRoaXMubWFwcGVyfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5tb2RlbC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLm1vZGVsLm1hcmtlcnM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiX2JlZm9yZUNoYW5nZXNcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5fZGlzYWJsZVJlbmRlcmluZyh0cnVlKVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImhpZ2hlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcIl9hZnRlckNoYW5nZXNcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5fZGlzYWJsZVJlbmRlcmluZyhmYWxzZSlcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhpLCBcImNoYW5nZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb3duY2FzdERpc3BhdGNoZXIuY29udmVydENoYW5nZXMoaS5kaWZmZXIsIG8sIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvd25jYXN0RGlzcGF0Y2hlci5jb252ZXJ0U2VsZWN0aW9uKG4sIG8sIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLnZpZXcuZG9jdW1lbnQsIFwic2VsZWN0aW9uQ2hhbmdlXCIsIEdmKHRoaXMubW9kZWwsIHRoaXMubWFwcGVyKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvd25jYXN0RGlzcGF0Y2hlci5vbihcImluc2VydDokdGV4dFwiLCBfZigpLCB7cHJpb3JpdHk6IFwibG93ZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG93bmNhc3REaXNwYXRjaGVyLm9uKFwicmVtb3ZlXCIsIHZmKCksIHtwcmlvcml0eTogXCJsb3dcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb3duY2FzdERpc3BhdGNoZXIub24oXCJzZWxlY3Rpb25cIiwgQWYoKSwge3ByaW9yaXR5OiBcImxvd1wifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvd25jYXN0RGlzcGF0Y2hlci5vbihcInNlbGVjdGlvblwiLCB4ZigpLCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG93bmNhc3REaXNwYXRjaGVyLm9uKFwic2VsZWN0aW9uXCIsIENmKCksIHtwcmlvcml0eTogXCJsb3dcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmRvY3VtZW50LnJvb3RzLmJpbmRUbyh0aGlzLm1vZGVsLmRvY3VtZW50LnJvb3RzKS51c2luZyh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5yb290TmFtZSA9PSBcIiRncmF2ZXlhcmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IGNsKHRoaXMudmlldy5kb2N1bWVudCwgdC5uYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnJvb3ROYW1lID0gdC5yb290TmFtZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcHBlci5iaW5kRWxlbWVudHModCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoYWcsIEpjKTtcclxuXHJcbiAgICAgICAgY2xhc3MgY2cge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbW1hbmRzID0gbmV3IE1hcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tbWFuZHMuc2V0KHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29tbWFuZHMuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUodCwgLi4uZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbW1hbmRjb2xsZWN0aW9uLWNvbW1hbmQtbm90LWZvdW5kOiBDb21tYW5kIGRvZXMgbm90IGV4aXN0LlwiLCB0aGlzLCB7Y29tbWFuZE5hbWU6IHR9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5leGVjdXRlKC4uLmUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogbmFtZXMoKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCogdGhpcy5fY29tbWFuZHMua2V5cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogY29tbWFuZHMoKSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCogdGhpcy5fY29tbWFuZHMudmFsdWVzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29tbWFuZHNbU3ltYm9sLml0ZXJhdG9yXSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5jb21tYW5kcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5kZXN0cm95KClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgbGcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnN1bWFibGVzID0gbmV3IE1hcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pcyhcInRleHRcIikgfHwgdC5pcyhcImRvY3VtZW50RnJhZ21lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcy5zZXQodCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NvbnN1bWFibGVzLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBuZXcgZGcodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29uc3VtYWJsZXMuc2V0KHQsIGkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLl9jb25zdW1hYmxlcy5nZXQodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGkuYWRkKGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRlc3QodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2NvbnN1bWFibGVzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGlmIChpID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJ0ZXh0XCIpIHx8IHQuaXMoXCJkb2N1bWVudEZyYWdtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpLnRlc3QoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3VtZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZXN0KHQsIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJ0ZXh0XCIpIHx8IHQuaXMoXCJkb2N1bWVudEZyYWdtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnN1bWFibGVzLnNldCh0LCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcy5nZXQodCkuY29uc3VtZShlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldmVydCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fY29uc3VtYWJsZXMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmlzKFwidGV4dFwiKSB8fCB0LmlzKFwiZG9jdW1lbnRGcmFnbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcy5zZXQodCwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnJldmVydChlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGNvbnN1bWFibGVzRnJvbUVsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHtlbGVtZW50OiB0LCBuYW1lOiB0cnVlLCBhdHRyaWJ1dGVzOiBbXSwgY2xhc3NlczogW10sIHN0eWxlczogW119O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0QXR0cmlidXRlS2V5cygpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSBcInN0eWxlXCIgfHwgdCA9PSBcImNsYXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZS5hdHRyaWJ1dGVzLnB1c2godClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldENsYXNzTmFtZXMoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5jbGFzc2VzLnB1c2godClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0LmdldFN0eWxlTmFtZXMoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zdHlsZXMucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGNyZWF0ZUZyb20odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IG5ldyBsZyh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0LmlzKFwiZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYWRkKHQsIGxnLmNvbnN1bWFibGVzRnJvbUVsZW1lbnQodCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pcyhcImRvY3VtZW50RnJhZ21lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmFkZCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBsZy5jcmVhdGVGcm9tKGksIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBkZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jYW5Db25zdW1lTmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb25zdW1hYmxlcyA9IHthdHRyaWJ1dGVzOiBuZXcgTWFwLCBzdHlsZXM6IG5ldyBNYXAsIGNsYXNzZXM6IG5ldyBNYXB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FuQ29uc3VtZU5hbWUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgaW4gdGhpcy5fY29uc3VtYWJsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSBpbiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZChlLCB0W2VdKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGVzdCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5uYW1lICYmICF0aGlzLl9jYW5Db25zdW1lTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYW5Db25zdW1lTmFtZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIGluIHRoaXMuX2NvbnN1bWFibGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgaW4gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fdGVzdChlLCB0W2VdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdW1lKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0Lm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYW5Db25zdW1lTmFtZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgaW4gdGhpcy5fY29uc3VtYWJsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSBpbiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnN1bWUoZSwgdFtlXSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldmVydCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FuQ29uc3VtZU5hbWUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgaW4gdGhpcy5fY29uc3VtYWJsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSBpbiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JldmVydChlLCB0W2VdKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FkZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gSmUoZSkgPyBlIDogW2VdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2NvbnN1bWFibGVzW3RdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gXCJhdHRyaWJ1dGVzXCIgJiYgKGUgPT09IFwiY2xhc3NcIiB8fCBlID09PSBcInN0eWxlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3Y29uc3VtYWJsZS1pbnZhbGlkLWF0dHJpYnV0ZTogQ2xhc3NlcyBhbmQgc3R5bGVzIHNob3VsZCBiZSBoYW5kbGVkIHNlcGFyYXRlbHkuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG4uc2V0KGUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID09PSBcInN0eWxlc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLmVsZW1lbnQuZG9jdW1lbnQuc3R5bGVzUHJvY2Vzc29yLmdldFJlbGF0ZWRTdHlsZXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc2V0KHQsIHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF90ZXN0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBKZShlKSA/IGUgOiBbZV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fY29uc3VtYWJsZXNbdF07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID09PSBcImF0dHJpYnV0ZXNcIiAmJiAoZSA9PT0gXCJjbGFzc1wiIHx8IGUgPT09IFwic3R5bGVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUgPT0gXCJjbGFzc1wiID8gXCJjbGFzc2VzXCIgOiBcInN0eWxlc1wiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fdGVzdCh0LCBbLi4udGhpcy5fY29uc3VtYWJsZXNbdF0ua2V5cygpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG4uZ2V0KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY29uc3VtZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gSmUoZSkgPyBlIDogW2VdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2NvbnN1bWFibGVzW3RdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gXCJhdHRyaWJ1dGVzXCIgJiYgKGUgPT09IFwiY2xhc3NcIiB8fCBlID09PSBcInN0eWxlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlID09IFwiY2xhc3NcIiA/IFwiY2xhc3Nlc1wiIDogXCJzdHlsZXNcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29uc3VtZSh0LCBbLi4udGhpcy5fY29uc3VtYWJsZXNbdF0ua2V5cygpXSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnNldChlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID09IFwic3R5bGVzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLmVsZW1lbnQuZG9jdW1lbnQuc3R5bGVzUHJvY2Vzc29yLmdldFJlbGF0ZWRTdHlsZXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldCh0LCBmYWxzZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JldmVydCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gSmUoZSkgPyBlIDogW2VdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2NvbnN1bWFibGVzW3RdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gXCJhdHRyaWJ1dGVzXCIgJiYgKGUgPT09IFwiY2xhc3NcIiB8fCBlID09PSBcInN0eWxlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlID09IFwiY2xhc3NcIiA/IFwiY2xhc3Nlc1wiIDogXCJzdHlsZXNcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmV2ZXJ0KHQsIFsuLi50aGlzLl9jb25zdW1hYmxlc1t0XS5rZXlzKCldKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuLmdldChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldChlLCB0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB1ZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc291cmNlRGVmaW5pdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2F0dHJpYnV0ZVByb3BlcnRpZXMgPSB7fTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGUoXCJjaGVja0NoaWxkXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0ZShcImNoZWNrQXR0cmlidXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoZWNrQXR0cmlidXRlXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZVswXSA9IG5ldyBoZyhlWzBdKVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImhpZ2hlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoZWNrQ2hpbGRcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlWzBdID0gbmV3IGhnKGVbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGVbMV0gPSB0aGlzLmdldERlZmluaXRpb24oZVsxXSlcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWdpc3Rlcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc291cmNlRGVmaW5pdGlvbnNbdF0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwic2NoZW1hLWNhbm5vdC1yZWdpc3Rlci1pdGVtLXR3aWNlOiBBIHNpbmdsZSBpdGVtIGNhbm5vdCBiZSByZWdpc3RlcmVkIHR3aWNlIGluIHRoZSBzY2hlbWEuXCIsIHRoaXMsIHtpdGVtTmFtZTogdH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zb3VyY2VEZWZpbml0aW9uc1t0XSA9IFtPYmplY3QuYXNzaWduKHt9LCBlKV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhckNhY2hlKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXh0ZW5kKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc291cmNlRGVmaW5pdGlvbnNbdF0pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwic2NoZW1hLWNhbm5vdC1leHRlbmQtbWlzc2luZy1pdGVtOiBDYW5ub3QgZXh0ZW5kIGFuIGl0ZW0gd2hpY2ggd2FzIG5vdCByZWdpc3RlcmVkIHlldC5cIiwgdGhpcywge2l0ZW1OYW1lOiB0fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3NvdXJjZURlZmluaXRpb25zW3RdLnB1c2goT2JqZWN0LmFzc2lnbih7fSwgZSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2xlYXJDYWNoZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldERlZmluaXRpb25zKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jb21waWxlZERlZmluaXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29tcGlsZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29tcGlsZWREZWZpbml0aW9uc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXREZWZpbml0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gdFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LmlzICYmICh0LmlzKFwidGV4dFwiKSB8fCB0LmlzKFwidGV4dFByb3h5XCIpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBcIiR0ZXh0XCJcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQubmFtZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGVmaW5pdGlvbnMoKVtlXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc1JlZ2lzdGVyZWQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5nZXREZWZpbml0aW9uKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzQmxvY2sodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0RGVmaW5pdGlvbih0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIShlICYmIGUuaXNCbG9jaylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNMaW1pdCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5nZXREZWZpbml0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gISEoZS5pc0xpbWl0IHx8IGUuaXNPYmplY3QpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzT2JqZWN0KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmdldERlZmluaXRpb24odCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gISEoZSAmJiBlLmlzT2JqZWN0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0lubGluZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5nZXREZWZpbml0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhKGUgJiYgZS5pc0lubGluZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hlY2tDaGlsZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGVja0NvbnRleHRNYXRjaChlLCB0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGVja0F0dHJpYnV0ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5nZXREZWZpbml0aW9uKHQubGFzdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpLmFsbG93QXR0cmlidXRlcy5pbmNsdWRlcyhlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGVja01lcmdlKHQsIGUgPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFVoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIGpoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwic2NoZW1hLWNoZWNrLW1lcmdlLW5vLWVsZW1lbnQtYmVmb3JlOiBUaGUgbm9kZSBiZWZvcmUgdGhlIG1lcmdlIHBvc2l0aW9uIG11c3QgYmUgYW4gZWxlbWVudC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoaSBpbnN0YW5jZW9mIGpoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwic2NoZW1hLWNoZWNrLW1lcmdlLW5vLWVsZW1lbnQtYWZ0ZXI6IFRoZSBub2RlIGFmdGVyIHRoZSBtZXJnZSBwb3NpdGlvbiBtdXN0IGJlIGFuIGVsZW1lbnQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoZWNrTWVyZ2UoZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBlLmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2hlY2tDaGlsZCh0LCBpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGRDaGlsZENoZWNrKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJjaGVja0NoaWxkXCIsIChlLCBbaSwgbl0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0KGksIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbyA9PSBcImJvb2xlYW5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5yZXR1cm4gPSBvXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImhpZ2hcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZEF0dHJpYnV0ZUNoZWNrKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJjaGVja0F0dHJpYnV0ZVwiLCAoZSwgW2ksIG5dKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHQoaSwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvID09IFwiYm9vbGVhblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnJldHVybiA9IG9cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaFwifSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0QXR0cmlidXRlUHJvcGVydGllcyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdHRyaWJ1dGVQcm9wZXJ0aWVzW3RdID0gT2JqZWN0LmFzc2lnbih0aGlzLmdldEF0dHJpYnV0ZVByb3BlcnRpZXModCksIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEF0dHJpYnV0ZVByb3BlcnRpZXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F0dHJpYnV0ZVByb3BlcnRpZXNbdF0gfHwge31cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0TGltaXRFbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBVaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0LnBhcmVudFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdCBpbnN0YW5jZW9mICRoID8gW3RdIDogQXJyYXkuZnJvbSh0LmdldFJhbmdlcygpKTtcclxuICAgICAgICAgICAgICAgICAgICBlID0gaS5yZWR1Y2UoKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZ2V0Q29tbW9uQW5jZXN0b3IoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmdldENvbW1vbkFuY2VzdG9yKGksIHtpbmNsdWRlU2VsZjogdHJ1ZX0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgbnVsbClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdoaWxlICghdGhpcy5pc0xpbWl0KGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBlLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2hlY2tBdHRyaWJ1dGVJblNlbGVjdGlvbih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdldEZpcnN0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gWy4uLmkuZ2V0QW5jZXN0b3JzKCksIG5ldyBMaChcIlwiLCB0LmdldEF0dHJpYnV0ZXMoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoZWNrQXR0cmlidXRlKG4sIGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdldFJhbmdlcygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja0F0dHJpYnV0ZShpLml0ZW0sIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAqIGdldFZhbGlkUmFuZ2VzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHQgPSBQZyh0KTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGQqIHRoaXMuX2dldFZhbGlkUmFuZ2VzRm9yUmFuZ2UoaSwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0TmVhcmVzdFNlbGVjdGlvblJhbmdlKHQsIGUgPSBcImJvdGhcIikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tDaGlsZCh0LCBcIiR0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyAkaCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IGksIG47XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5nZXRBbmNlc3RvcnMoKS5yZXZlcnNlKCkuZmluZCh0ID0+IHRoaXMuaXNMaW1pdCh0KSkgfHwgdC5yb290O1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT0gXCJib3RoXCIgfHwgZSA9PSBcImJhY2t3YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gbmV3IFdoKHtib3VuZGFyaWVzOiAkaC5fY3JlYXRlSW4obyksIHN0YXJ0UG9zaXRpb246IHQsIGRpcmVjdGlvbjogXCJiYWNrd2FyZFwifSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlID09IFwiYm90aFwiIHx8IGUgPT0gXCJmb3J3YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBuID0gbmV3IFdoKHtib3VuZGFyaWVzOiAkaC5fY3JlYXRlSW4obyksIHN0YXJ0UG9zaXRpb246IHR9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIFRnKGksIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQud2Fsa2VyID09IGkgPyBcImVsZW1lbnRFbmRcIiA6IFwiZWxlbWVudFN0YXJ0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4udHlwZSA9PSBlICYmIHRoaXMuaXNPYmplY3Qobi5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGguX2NyZWF0ZU9uKG4uaXRlbSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tDaGlsZChuLm5leHRQb3NpdGlvbiwgXCIkdGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKG4ubmV4dFBvc2l0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZpbmRBbGxvd2VkUGFyZW50KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGxldCBpID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrQ2hpbGQoaSwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNMaW1pdChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpID0gaS5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZURpc2FsbG93ZWRBdHRyaWJ1dGVzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFNnKHRoaXMsIGksIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9ICRoLl9jcmVhdGVJbihpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0UG9zaXRpb25zKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5ub2RlQmVmb3JlIHx8IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2codGhpcywgaSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlQ29udGV4dCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGhnKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbGVhckNhY2hlKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcGlsZWREZWZpbml0aW9ucyA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NvbXBpbGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0ge307XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fc291cmNlRGVmaW5pdGlvbnM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gT2JqZWN0LmtleXMoZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbbl0gPSBmZyhlW25dLCBuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBnZyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwZyh0LCBlKTtcclxuICAgICAgICAgICAgICAgICAgICBiZyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICB3Zyh0LCBlKTtcclxuICAgICAgICAgICAgICAgICAgICBrZyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcGlsZWREZWZpbml0aW9ucyA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NoZWNrQ29udGV4dE1hdGNoKHQsIGUsIGkgPSBlLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmdldEl0ZW0oaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5hbGxvd0luLmluY2x1ZGVzKG4ubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0RGVmaW5pdGlvbihuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoZWNrQ29udGV4dE1hdGNoKHQsIGUsIGkgLSAxKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogX2dldFZhbGlkUmFuZ2VzRm9yUmFuZ2UodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSB0LnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSB0LnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBvIG9mIHQuZ2V0SXRlbXMoe3NoYWxsb3c6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvLmlzKFwiZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCogdGhpcy5fZ2V0VmFsaWRSYW5nZXNGb3JSYW5nZSgkaC5fY3JlYXRlSW4obyksIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jaGVja0F0dHJpYnV0ZShvLCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWkuaXNFcXVhbChuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgbmV3ICRoKGksIG4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IFVoLl9jcmVhdGVBZnRlcihvKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuID0gVWguX2NyZWF0ZUFmdGVyKG8pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuaXNFcXVhbChuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIG5ldyAkaChpLCBuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyh1ZywgSmMpO1xyXG5cclxuICAgICAgICBjbGFzcyBoZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgaGcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gW3RdXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFBcnJheS5pc0FycmF5KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHQuZ2V0QW5jZXN0b3JzKHtpbmNsdWRlU2VsZjogdHJ1ZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodFswXSAmJiB0eXBlb2YgdFswXSAhPSBcInN0cmluZ1wiICYmIHRbMF0uaXMoXCJkb2N1bWVudEZyYWdtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zaGlmdCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pdGVtcyA9IHQubWFwKEFnKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbGVuZ3RoKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1zLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbGFzdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtc1t0aGlzLl9pdGVtcy5sZW5ndGggLSAxXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBbU3ltYm9sLml0ZXJhdG9yXSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pdGVtc1tTeW1ib2wuaXRlcmF0b3JdKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcHVzaCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IGhnKFt0XSk7XHJcbiAgICAgICAgICAgICAgICBlLl9pdGVtcyA9IFsuLi50aGlzLl9pdGVtcywgLi4uZS5faXRlbXNdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0SXRlbSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5faXRlbXNbdF1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBnZXROYW1lcygpIHtcclxuICAgICAgICAgICAgICAgIHlpZWxkKiB0aGlzLl9pdGVtcy5tYXAodCA9PiB0Lm5hbWUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGVuZHNXaXRoKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZ2V0TmFtZXMoKSkuam9pbihcIiBcIikuZW5kc1dpdGgodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhcnRzV2l0aCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLmdldE5hbWVzKCkpLmpvaW4oXCIgXCIpLnN0YXJ0c1dpdGgodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmcodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZSxcclxuICAgICAgICAgICAgICAgIGFsbG93SW46IFtdLFxyXG4gICAgICAgICAgICAgICAgYWxsb3dDb250ZW50T2Y6IFtdLFxyXG4gICAgICAgICAgICAgICAgYWxsb3dXaGVyZTogW10sXHJcbiAgICAgICAgICAgICAgICBhbGxvd0F0dHJpYnV0ZXM6IFtdLFxyXG4gICAgICAgICAgICAgICAgYWxsb3dBdHRyaWJ1dGVzT2Y6IFtdLFxyXG4gICAgICAgICAgICAgICAgaW5oZXJpdFR5cGVzRnJvbTogW11cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgX2codCwgaSk7XHJcbiAgICAgICAgICAgIHZnKHQsIGksIFwiYWxsb3dJblwiKTtcclxuICAgICAgICAgICAgdmcodCwgaSwgXCJhbGxvd0NvbnRlbnRPZlwiKTtcclxuICAgICAgICAgICAgdmcodCwgaSwgXCJhbGxvd1doZXJlXCIpO1xyXG4gICAgICAgICAgICB2Zyh0LCBpLCBcImFsbG93QXR0cmlidXRlc1wiKTtcclxuICAgICAgICAgICAgdmcodCwgaSwgXCJhbGxvd0F0dHJpYnV0ZXNPZlwiKTtcclxuICAgICAgICAgICAgdmcodCwgaSwgXCJpbmhlcml0VHlwZXNGcm9tXCIpO1xyXG4gICAgICAgICAgICB5Zyh0LCBpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdnKHQsIGUpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHRbZV0uYWxsb3dDb250ZW50T2YpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0W2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHhnKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5hbGxvd0luLnB1c2goZSlcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0W2VdLmFsbG93Q29udGVudE9mXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtZyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0W2VdLmFsbG93V2hlcmUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0W2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbi5hbGxvd0luO1xyXG4gICAgICAgICAgICAgICAgICAgIHRbZV0uYWxsb3dJbi5wdXNoKC4uLmkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGVsZXRlIHRbZV0uYWxsb3dXaGVyZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcGcodCwgZSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdFtlXS5hbGxvd0F0dHJpYnV0ZXNPZikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuLmFsbG93QXR0cmlidXRlcztcclxuICAgICAgICAgICAgICAgICAgICB0W2VdLmFsbG93QXR0cmlidXRlcy5wdXNoKC4uLmkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGVsZXRlIHRbZV0uYWxsb3dBdHRyaWJ1dGVzT2ZcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJnKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHRbZV07XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpLmluaGVyaXRUeXBlc0Zyb20pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0W2VdO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gT2JqZWN0LmtleXMobikuZmlsdGVyKHQgPT4gdC5zdGFydHNXaXRoKFwiaXNcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGUgaW4gaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlbZV0gPSBuW2VdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGVsZXRlIGkuaW5oZXJpdFR5cGVzRnJvbVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gd2codCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdFtlXTtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGkuYWxsb3dJbi5maWx0ZXIoZSA9PiB0W2VdKTtcclxuICAgICAgICAgICAgaS5hbGxvd0luID0gQXJyYXkuZnJvbShuZXcgU2V0KG4pKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24ga2codCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdFtlXTtcclxuICAgICAgICAgICAgaS5hbGxvd0F0dHJpYnV0ZXMgPSBBcnJheS5mcm9tKG5ldyBTZXQoaS5hbGxvd0F0dHJpYnV0ZXMpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX2codCwgZSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IE9iamVjdC5rZXlzKGkpLmZpbHRlcih0ID0+IHQuc3RhcnRzV2l0aChcImlzXCIpKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZVtuXSA9IGlbbl1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdmcodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBuW2ldID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlW2ldLnB1c2gobltpXSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShuW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVbaV0ucHVzaCguLi5uW2ldKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB5Zyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gaS5pbmhlcml0QWxsRnJvbTtcclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5hbGxvd0NvbnRlbnRPZi5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYWxsb3dXaGVyZS5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYWxsb3dBdHRyaWJ1dGVzT2YucHVzaCh0KTtcclxuICAgICAgICAgICAgICAgICAgICBlLmluaGVyaXRUeXBlc0Zyb20ucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB4Zyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0W2VdO1xyXG4gICAgICAgICAgICByZXR1cm4gQ2codCkuZmlsdGVyKHQgPT4gdC5hbGxvd0luLmluY2x1ZGVzKGkubmFtZSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBDZyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0KS5tYXAoZSA9PiB0W2VdKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQWcodCkge1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiB0LCAqIGdldEF0dHJpYnV0ZUtleXMoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZ2V0QXR0cmlidXRlKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdC5pcyhcImVsZW1lbnRcIikgPyB0Lm5hbWUgOiBcIiR0ZXh0XCIsICogZ2V0QXR0cmlidXRlS2V5cygpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQqIHQuZ2V0QXR0cmlidXRlS2V5cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZ2V0QXR0cmlidXRlKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuZ2V0QXR0cmlidXRlKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiogVGcodCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB3aGlsZSAoIWkpIHtcclxuICAgICAgICAgICAgICAgIGkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5uZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmRvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZHt3YWxrZXI6IHQsIHZhbHVlOiBlLnZhbHVlfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdC5kb25lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGR7d2Fsa2VyOiBlLCB2YWx1ZTogdC52YWx1ZX1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uKiBQZyh0KSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICB5aWVsZCogZS5nZXRNaW5pbWFsRmxhdFJhbmdlcygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFNnKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIGUuZ2V0QXR0cmlidXRlS2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQuY2hlY2tBdHRyaWJ1dGUoZSwgbikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnJlbW92ZUF0dHJpYnV0ZShuLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBFZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3BsaXRQYXJ0cyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RlbEN1cnNvciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkgPSBPYmplY3QuYXNzaWduKHt9LCB0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS5jb252ZXJ0SXRlbSA9IHRoaXMuX2NvbnZlcnRJdGVtLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkuY29udmVydENoaWxkcmVuID0gdGhpcy5fY29udmVydENoaWxkcmVuLmJpbmQodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkuc3BsaXRUb0FsbG93ZWRQYXJlbnQgPSB0aGlzLl9zcGxpdFRvQWxsb3dlZFBhcmVudC5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzaW9uQXBpLmdldFNwbGl0UGFydHMgPSB0aGlzLl9nZXRTcGxpdFBhcnRzLmJpbmQodGhpcylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29udmVydCh0LCBlLCBpID0gW1wiJHJvb3RcIl0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcInZpZXdDbGVhbnVwXCIsIHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kZWxDdXJzb3IgPSBPZyhpLCBlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS53cml0ZXIgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzaW9uQXBpLmNvbnN1bWFibGUgPSBsZy5jcmVhdGVGcm9tKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzaW9uQXBpLnN0b3JlID0ge307XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7bW9kZWxSYW5nZTogbn0gPSB0aGlzLl9jb252ZXJ0SXRlbSh0LCB0aGlzLl9tb2RlbEN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUVtcHR5RWxlbWVudHMoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgQXJyYXkuZnJvbSh0aGlzLl9tb2RlbEN1cnNvci5wYXJlbnQuZ2V0Q2hpbGRyZW4oKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5hcHBlbmQodCwgbylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgby5tYXJrZXJzID0gUmcobywgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGVsQ3Vyc29yID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NwbGl0UGFydHMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udmVyc2lvbkFwaS53cml0ZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb252ZXJzaW9uQXBpLnN0b3JlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jb252ZXJ0SXRlbSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gT2JqZWN0LmFzc2lnbih7dmlld0l0ZW06IHQsIG1vZGVsQ3Vyc29yOiBlLCBtb2RlbFJhbmdlOiBudWxsfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pcyhcImVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJlbGVtZW50OlwiICsgdC5uYW1lLCBpLCB0aGlzLmNvbnZlcnNpb25BcGkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwidGV4dFwiLCBpLCB0aGlzLmNvbnZlcnNpb25BcGkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImRvY3VtZW50RnJhZ21lbnRcIiwgaSwgdGhpcy5jb252ZXJzaW9uQXBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkubW9kZWxSYW5nZSAmJiAhKGkubW9kZWxSYW5nZSBpbnN0YW5jZW9mICRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ2aWV3LWNvbnZlcnNpb24tZGlzcGF0Y2hlci1pbmNvcnJlY3QtcmVzdWx0OiBJbmNvcnJlY3QgY29udmVyc2lvbiByZXN1bHQgd2FzIGRyb3BwZWQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge21vZGVsUmFuZ2U6IGkubW9kZWxSYW5nZSwgbW9kZWxDdXJzb3I6IGkubW9kZWxDdXJzb3J9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jb252ZXJ0Q2hpbGRyZW4odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyAkaChlKTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gZTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBBcnJheS5mcm9tKHQuZ2V0Q2hpbGRyZW4oKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fY29udmVydEl0ZW0oZSwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQubW9kZWxSYW5nZSBpbnN0YW5jZW9mICRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuZW5kID0gdC5tb2RlbFJhbmdlLmVuZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHQubW9kZWxDdXJzb3JcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge21vZGVsUmFuZ2U6IGksIG1vZGVsQ3Vyc29yOiBufVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc3BsaXRUb0FsbG93ZWRQYXJlbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuY29udmVyc2lvbkFwaS5zY2hlbWEuZmluZEFsbG93ZWRQYXJlbnQoZSwgdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtwb3NpdGlvbjogZX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb2RlbEN1cnNvci5wYXJlbnQuZ2V0QW5jZXN0b3JzKCkuaW5jbHVkZXMoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuY29udmVyc2lvbkFwaS53cml0ZXIuc3BsaXQoZSwgaSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi5yYW5nZS5nZXRXYWxrZXIoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gXCJlbGVtZW50RW5kXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5wdXNoKHQuaXRlbSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gby5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuaXRlbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJTcGxpdFBhaXIoZSwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge3Bvc2l0aW9uOiBuLnBvc2l0aW9uLCBjdXJzb3JQYXJlbnQ6IG4ucmFuZ2UuZW5kLnBhcmVudH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlZ2lzdGVyU3BsaXRQYWlyKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc3BsaXRQYXJ0cy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zcGxpdFBhcnRzLnNldCh0LCBbdF0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fc3BsaXRQYXJ0cy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zcGxpdFBhcnRzLnNldChlLCBpKTtcclxuICAgICAgICAgICAgICAgIGkucHVzaChlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0U3BsaXRQYXJ0cyh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc3BsaXRQYXJ0cy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gW3RdXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLl9zcGxpdFBhcnRzLmdldCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZUVtcHR5RWxlbWVudHMoKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX3NwbGl0UGFydHMua2V5cygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb25BcGkud3JpdGVyLnJlbW92ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3BsaXRQYXJ0cy5kZWxldGUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVFbXB0eUVsZW1lbnRzKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoRWcsIGRzKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUmcodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IFNldDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSAkaC5fY3JlYXRlSW4odCkuZ2V0SXRlbXMoKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG8pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0Lm5hbWUgPT0gXCIkbWFya2VyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLmFkZCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRBdHRyaWJ1dGUoXCJkYXRhLW5hbWVcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5jcmVhdGVQb3NpdGlvbkJlZm9yZSh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghbi5oYXMoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnNldChpLCBuZXcgJGgoby5jbG9uZSgpKSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5nZXQoaSkuZW5kID0gby5jbG9uZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlLnJlbW92ZSh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBPZyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGxldCBpO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgbmV3IGhnKHQpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0ge307XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbi5nZXRBdHRyaWJ1dGVLZXlzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0W2VdID0gbi5nZXRBdHRyaWJ1dGUoZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLmNyZWF0ZUVsZW1lbnQobi5uYW1lLCB0KTtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5hcHBlbmQobywgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGkgPSBVaC5fY3JlYXRlQXQobywgMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgSWcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGVzUHJvY2Vzc29yID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc29yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXBwZXIgPSBuZXcgR2g7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvd25jYXN0RGlzcGF0Y2hlciA9IG5ldyBZaCh7bWFwcGVyOiB0aGlzLm1hcHBlcn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb3duY2FzdERpc3BhdGNoZXIub24oXCJpbnNlcnQ6JHRleHRcIiwgX2YoKSwge3ByaW9yaXR5OiBcImxvd2VzdFwifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwY2FzdERpc3BhdGNoZXIgPSBuZXcgRWcoe3NjaGVtYTogdC5zY2hlbWF9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlld0RvY3VtZW50ID0gbmV3IHBsKGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld1dyaXRlciA9IG5ldyAkbCh0aGlzLnZpZXdEb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwY2FzdERpc3BhdGNoZXIub24oXCJ0ZXh0XCIsICRmKCksIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cGNhc3REaXNwYXRjaGVyLm9uKFwiZWxlbWVudFwiLCBVZigpLCB7cHJpb3JpdHk6IFwibG93ZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBjYXN0RGlzcGF0Y2hlci5vbihcImRvY3VtZW50RnJhZ21lbnRcIiwgVWYoKSwge3ByaW9yaXR5OiBcImxvd2VzdFwifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRlKFwiaW5pdFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJpbml0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJyZWFkeVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd2VzdFwifSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtyb290TmFtZTogZSA9IFwibWFpblwiLCB0cmltOiBpID0gXCJlbXB0eVwifSA9IHQgfHwge307XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NoZWNrSWZSb290c0V4aXN0cyhbZV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImRhdGFjb250cm9sbGVyLWdldC1ub24tZXhpc3RlbnQtcm9vdDogQXR0ZW1wdGluZyB0byBnZXQgZGF0YSBmcm9tIGEgbm9uLWV4aXN0aW5nIHJvb3QuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5tb2RlbC5kb2N1bWVudC5nZXRSb290KGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IFwiZW1wdHlcIiAmJiAhdGhpcy5tb2RlbC5oYXNDb250ZW50KG4sIHtpZ25vcmVXaGl0ZXNwYWNlczogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiXCJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0cmluZ2lmeShuKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdHJpbmdpZnkodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudG9WaWV3KHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc29yLnRvRGF0YShlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudmlld0RvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3ZpZXdXcml0ZXI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcHBlci5jbGVhckJpbmRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gJGguX2NyZWF0ZUluKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBxbChlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFwcGVyLmJpbmRFbGVtZW50cyh0LCBvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG93bmNhc3REaXNwYXRjaGVyLmNvbnZlcnRJbnNlcnQobiwgaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQuaXMoXCJkb2N1bWVudEZyYWdtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IFZnKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW3QsIG5dIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb3duY2FzdERpc3BhdGNoZXIuY29udmVydE1hcmtlckFkZCh0LCBuLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwuZG9jdW1lbnQudmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJkYXRhY29udHJvbGxlci1pbml0LWRvY3VtZW50LW5vdC1lbXB0eTogVHJ5aW5nIHRvIHNldCBpbml0aWFsIGRhdGEgdG8gbm90IGVtcHR5IGRvY3VtZW50LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGUubWFpbiA9IHRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY2hlY2tJZlJvb3RzRXhpc3RzKE9iamVjdC5rZXlzKGUpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJkYXRhY29udHJvbGxlci1pbml0LW5vbi1leGlzdGVudC1yb290OiBBdHRlbXB0aW5nIHRvIGluaXQgZGF0YSBvbiBhIG5vbi1leGlzdGluZyByb290LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5lbnF1ZXVlQ2hhbmdlKFwidHJhbnNwYXJlbnRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIE9iamVjdC5rZXlzKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLm1vZGVsLmRvY3VtZW50LmdldFJvb3QoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuaW5zZXJ0KHRoaXMucGFyc2UoZVtpXSwgbiksIG4sIDApXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0KHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0ge307XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm1haW4gPSB0XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NoZWNrSWZSb290c0V4aXN0cyhPYmplY3Qua2V5cyhlKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiZGF0YWNvbnRyb2xsZXItc2V0LW5vbi1leGlzdGVudC1yb290OiBBdHRlbXB0aW5nIHRvIHNldCBkYXRhIG9uIGEgbm9uLWV4aXN0aW5nIHJvb3QuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmVucXVldWVDaGFuZ2UoXCJ0cmFuc3BhcmVudFwiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbihudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZSh0aGlzLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRBdHRyaWJ1dGVLZXlzKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBPYmplY3Qua2V5cyhlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5tb2RlbC5kb2N1bWVudC5nZXRSb290KGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZSh0LmNyZWF0ZVJhbmdlSW4obikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lmluc2VydCh0aGlzLnBhcnNlKGVbaV0sIG4pLCBuLCAwKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHBhcnNlKHQsIGUgPSBcIiRyb290XCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnByb2Nlc3Nvci50b1ZpZXcodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50b01vZGVsKGksIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvTW9kZWwodCwgZSA9IFwiJHJvb3RcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwuY2hhbmdlKGkgPT4gdGhpcy51cGNhc3REaXNwYXRjaGVyLmNvbnZlcnQodCwgaSwgZSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZFN0eWxlUHJvY2Vzc29yUnVsZXModCkge1xyXG4gICAgICAgICAgICAgICAgdCh0aGlzLnN0eWxlc1Byb2Nlc3NvcilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jaGVja0lmUm9vdHNFeGlzdHModCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwuZG9jdW1lbnQuZ2V0Um9vdE5hbWVzKCkuaW5jbHVkZXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoSWcsIEpjKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVmcodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJvb3QuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9ICRoLl9jcmVhdGVJbih0KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkubW9kZWwubWFya2Vycykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG4uZ2V0SW50ZXJzZWN0aW9uKHQuZ2V0UmFuZ2UoKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHVzaChbdC5uYW1lLCBpXSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgTmcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oZWxwZXJzID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rvd25jYXN0ID0gQXJyYXkuaXNBcnJheSh0KSA/IHQgOiBbdF07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVDb252ZXJzaW9uSGVscGVycyh7bmFtZTogXCJkb3duY2FzdFwiLCBkaXNwYXRjaGVyczogdGhpcy5fZG93bmNhc3QsIGlzRG93bmNhc3Q6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwY2FzdCA9IEFycmF5LmlzQXJyYXkoZSkgPyBlIDogW2VdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlQ29udmVyc2lvbkhlbHBlcnMoe25hbWU6IFwidXBjYXN0XCIsIGRpc3BhdGNoZXJzOiB0aGlzLl91cGNhc3QsIGlzRG93bmNhc3Q6IGZhbHNlfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWRkQWxpYXModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2Rvd25jYXN0LmluY2x1ZGVzKGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX3VwY2FzdC5pbmNsdWRlcyhlKTtcclxuICAgICAgICAgICAgICAgIGlmICghbiAmJiAhaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb252ZXJzaW9uLWFkZC1hbGlhcy1kaXNwYXRjaGVyLW5vdC1yZWdpc3RlcmVkOiBcIiArIFwiVHJ5aW5nIHRvIHJlZ2lzdGVyIGFuZCBhbGlhcyBmb3IgYSBkaXNwYXRjaGVyIHRoYXQgbmFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVDb252ZXJzaW9uSGVscGVycyh7bmFtZTogdCwgZGlzcGF0Y2hlcnM6IFtlXSwgaXNEb3duY2FzdDogaX0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2hlbHBlcnMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbnZlcnNpb24tZm9yLXVua25vd24tZ3JvdXA6IFRyeWluZyB0byBhZGQgYSBjb252ZXJ0ZXIgdG8gYW4gdW5rbm93biBkaXNwYXRjaGVycyBncm91cC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWxwZXJzLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBlbGVtZW50VG9FbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9yKFwiZG93bmNhc3RcIikuZWxlbWVudFRvRWxlbWVudCh0KTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qge21vZGVsOiBlLCB2aWV3OiBpfSBvZiBNZyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yKFwidXBjYXN0XCIpLmVsZW1lbnRUb0VsZW1lbnQoe21vZGVsOiBlLCB2aWV3OiBpLCBjb252ZXJ0ZXJQcmlvcml0eTogdC5jb252ZXJ0ZXJQcmlvcml0eX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZVRvRWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcihcImRvd25jYXN0XCIpLmF0dHJpYnV0ZVRvRWxlbWVudCh0KTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qge21vZGVsOiBlLCB2aWV3OiBpfSBvZiBNZyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yKFwidXBjYXN0XCIpLmVsZW1lbnRUb0F0dHJpYnV0ZSh7dmlldzogaSwgbW9kZWw6IGUsIGNvbnZlcnRlclByaW9yaXR5OiB0LmNvbnZlcnRlclByaW9yaXR5fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXR0cmlidXRlVG9BdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb3IoXCJkb3duY2FzdFwiKS5hdHRyaWJ1dGVUb0F0dHJpYnV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qge21vZGVsOiBlLCB2aWV3OiBpfSBvZiBNZyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yKFwidXBjYXN0XCIpLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHt2aWV3OiBpLCBtb2RlbDogZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVDb252ZXJzaW9uSGVscGVycyh7bmFtZTogdCwgZGlzcGF0Y2hlcnM6IGUsIGlzRG93bmNhc3Q6IGl9KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faGVscGVycy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiY29udmVyc2lvbi1ncm91cC1leGlzdHM6IFRyeWluZyB0byByZWdpc3RlciBhIGdyb3VwIG5hbWUgdGhhdCBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaSA/IG5ldyBrZihlKSA6IG5ldyBxZihlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2hlbHBlcnMuc2V0KHQsIG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uKiBNZyh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0Lm1vZGVsLnZhbHVlcykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQubW9kZWwudmFsdWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHtrZXk6IHQubW9kZWwua2V5LCB2YWx1ZTogZX07XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudmlld1tlXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdC51cGNhc3RBbHNvID8gdC51cGNhc3RBbHNvW2VdIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkKiBCZyhpLCBuLCBvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgeWllbGQqIEJnKHQubW9kZWwsIHQudmlldywgdC51cGNhc3RBbHNvKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiogQmcodCwgZSwgaSkge1xyXG4gICAgICAgICAgICB5aWVsZHttb2RlbDogdCwgdmlldzogZX07XHJcbiAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICBpID0gQXJyYXkuaXNBcnJheShpKSA/IGkgOiBbaV07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxke21vZGVsOiB0LCB2aWV3OiBlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB6ZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQgPSBcImRlZmF1bHRcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcGVyYXRpb25zID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBiYXNlVmVyc2lvbigpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLm9wZXJhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5iYXNlVmVyc2lvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5iYXNlVmVyc2lvblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZE9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICB0LmJhdGNoID0gdGhpcztcclxuICAgICAgICAgICAgICAgIHRoaXMub3BlcmF0aW9ucy5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgTGcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhc2VWZXJzaW9uID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNEb2N1bWVudE9wZXJhdGlvbiA9IHRoaXMuYmFzZVZlcnNpb24gIT09IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdmFsaWRhdGUoKSB7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHQuX19jbGFzc05hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLmNsYXNzTmFtZTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0LmJhdGNoO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHQuaXNEb2N1bWVudE9wZXJhdGlvbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiT3BlcmF0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcyh0LmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBGZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFya2VycyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGlsZHJlbiA9IG5ldyBEaDtcclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5zZXJ0Q2hpbGQoMCwgdClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDaGlsZHJlbigpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBjaGlsZENvdW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmxlbmd0aFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbWF4T2Zmc2V0KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLm1heE9mZnNldFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNFbXB0eSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNoaWxkQ291bnQgPT09IDBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHJvb3QoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgcGFyZW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT0gXCJkb2N1bWVudEZyYWdtZW50XCIgfHwgdCA9PSBcIm1vZGVsOmRvY3VtZW50RnJhZ21lbnRcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRDaGlsZCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4uZ2V0Tm9kZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRDaGlsZHJlbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbltTeW1ib2wuaXRlcmF0b3JdKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hpbGRJbmRleCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRyZW4uZ2V0Tm9kZUluZGV4KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENoaWxkU3RhcnRPZmZzZXQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuLmdldE5vZGVTdGFydE9mZnNldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRQYXRoKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldE5vZGVCeVBhdGgodCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gZS5nZXRDaGlsZChlLm9mZnNldFRvSW5kZXgoaSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvZmZzZXRUb0luZGV4KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5vZmZzZXRUb0luZGV4KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucHVzaChlLnRvSlNPTigpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnB1c2goamguZnJvbUpTT04oaSkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKExoLmZyb21KU09OKGkpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmcoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FwcGVuZENoaWxkKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydENoaWxkKHRoaXMuY2hpbGRDb3VudCwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2luc2VydENoaWxkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBEZyhlKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQucGFyZW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuX3JlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHQucGFyZW50ID0gdGhpc1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4uX2luc2VydE5vZGVzKHQsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVDaGlsZHJlbih0LCBlID0gMSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2NoaWxkcmVuLl9yZW1vdmVOb2Rlcyh0LCBlKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5wYXJlbnQgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBEZyh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBMaCh0KV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWpzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gW3RdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odCkubWFwKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IExoKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEZoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBMaCh0LmRhdGEsIHQuZ2V0QXR0cmlidXRlcygpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGpnKHQsIGUpIHtcclxuICAgICAgICAgICAgZSA9IFVnKGUpO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZS5yZWR1Y2UoKHQsIGUpID0+IHQgKyBlLm9mZnNldFNpemUsIDApO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIEdnKHQpO1xyXG4gICAgICAgICAgICBjb25zdCBvID0gdC5pbmRleDtcclxuICAgICAgICAgICAgbi5faW5zZXJ0Q2hpbGQobywgZSk7XHJcbiAgICAgICAgICAgICRnKG4sIG8gKyBlLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICRnKG4sIG8pO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3ICRoKHQsIHQuZ2V0U2hpZnRlZEJ5KGkpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSGcodCkge1xyXG4gICAgICAgICAgICBpZiAoIXQuaXNGbGF0KSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwib3BlcmF0aW9uLXV0aWxzLXJlbW92ZS1yYW5nZS1ub3QtZmxhdDogXCIgKyBcIlRyeWluZyB0byByZW1vdmUgYSByYW5nZSB3aGljaCBzdGFydHMgYW5kIGVuZHMgaW4gZGlmZmVyZW50IGVsZW1lbnQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuc3RhcnQucGFyZW50O1xyXG4gICAgICAgICAgICBHZyh0LnN0YXJ0KTtcclxuICAgICAgICAgICAgR2codC5lbmQpO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZS5fcmVtb3ZlQ2hpbGRyZW4odC5zdGFydC5pbmRleCwgdC5lbmQuaW5kZXggLSB0LnN0YXJ0LmluZGV4KTtcclxuICAgICAgICAgICAgJGcoZSwgdC5zdGFydC5pbmRleCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBXZyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICghdC5pc0ZsYXQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJvcGVyYXRpb24tdXRpbHMtbW92ZS1yYW5nZS1ub3QtZmxhdDogXCIgKyBcIlRyeWluZyB0byBtb3ZlIGEgcmFuZ2Ugd2hpY2ggc3RhcnRzIGFuZCBlbmRzIGluIGRpZmZlcmVudCBlbGVtZW50LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBIZyh0KTtcclxuICAgICAgICAgICAgZSA9IGUuX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbih0LnN0YXJ0LCB0LmVuZC5vZmZzZXQgLSB0LnN0YXJ0Lm9mZnNldCk7XHJcbiAgICAgICAgICAgIHJldHVybiBqZyhlLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcWcodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBHZyh0LnN0YXJ0KTtcclxuICAgICAgICAgICAgR2codC5lbmQpO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5nZXRJdGVtcyh7c2hhbGxvdzogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5pcyhcInRleHRQcm94eVwiKSA/IG4udGV4dE5vZGUgOiBuO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Ll9zZXRBdHRyaWJ1dGUoZSwgaSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5fcmVtb3ZlQXR0cmlidXRlKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkZyh0LnBhcmVudCwgdC5pbmRleClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkZyh0LmVuZC5wYXJlbnQsIHQuZW5kLmluZGV4KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVWcodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBBcnJheSkpIHtcclxuICAgICAgICAgICAgICAgIHQgPSBbdF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdFtpXSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyBMaCh0W2ldKSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodFtpXSBpbnN0YW5jZW9mIEZoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG5ldyBMaCh0W2ldLmRhdGEsIHRbaV0uZ2V0QXR0cmlidXRlcygpKSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodFtpXSBpbnN0YW5jZW9mIEZnIHx8IHRbaV0gaW5zdGFuY2VvZiBEaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0W2ldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaChuKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodFtpXSBpbnN0YW5jZW9mIHpoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKHRbaV0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgdCA9IDE7IHQgPCBlLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZVt0XTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlW3QgLSAxXTtcclxuICAgICAgICAgICAgICAgIGlmIChpIGluc3RhbmNlb2YgTGggJiYgbiBpbnN0YW5jZW9mIExoICYmIEtnKGksIG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zcGxpY2UodCAtIDEsIDIsIG5ldyBMaChuLmRhdGEgKyBpLmRhdGEsIG4uZ2V0QXR0cmlidXRlcygpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC0tXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uICRnKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0Q2hpbGQoZSAtIDEpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5nZXRDaGlsZChlKTtcclxuICAgICAgICAgICAgaWYgKGkgJiYgbiAmJiBpLmlzKFwidGV4dFwiKSAmJiBuLmlzKFwidGV4dFwiKSAmJiBLZyhpLCBuKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBMaChpLmRhdGEgKyBuLmRhdGEsIGkuZ2V0QXR0cmlidXRlcygpKTtcclxuICAgICAgICAgICAgICAgIHQuX3JlbW92ZUNoaWxkcmVuKGUgLSAxLCAyKTtcclxuICAgICAgICAgICAgICAgIHQuX2luc2VydENoaWxkKGUgLSAxLCBvKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBHZyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnRleHROb2RlO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5vZmZzZXQgLSBlLnN0YXJ0T2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuaW5kZXg7XHJcbiAgICAgICAgICAgICAgICBpLl9yZW1vdmVDaGlsZHJlbihvLCAxKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgTGgoZS5kYXRhLnN1YnN0cigwLCBuKSwgZS5nZXRBdHRyaWJ1dGVzKCkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBMaChlLmRhdGEuc3Vic3RyKG4pLCBlLmdldEF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBpLl9pbnNlcnRDaGlsZChvLCBbciwgc10pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtnKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0QXR0cmlidXRlcygpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZS5nZXRBdHRyaWJ1dGVzKCk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodFsxXSAhPT0gZS5nZXRBdHRyaWJ1dGUodFswXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG4ubmV4dCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG4ubmV4dCgpLmRvbmVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEpnKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHF1KHQsIGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgWWcgPSBKZztcclxuXHJcbiAgICAgICAgY2xhc3MgUWcgZXh0ZW5kcyBMZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGksIG4sIG8pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKG8pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yYW5nZSA9IHQuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5ID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMub2xkVmFsdWUgPSBpID09PSB1bmRlZmluZWQgPyBudWxsIDogaTtcclxuICAgICAgICAgICAgICAgIHRoaXMubmV3VmFsdWUgPSBuID09PSB1bmRlZmluZWQgPyBudWxsIDogblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9sZFZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYWRkQXR0cmlidXRlXCJcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5uZXdWYWx1ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInJlbW92ZUF0dHJpYnV0ZVwiXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNoYW5nZUF0dHJpYnV0ZVwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb25lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBRZyh0aGlzLnJhbmdlLCB0aGlzLmtleSwgdGhpcy5vbGRWYWx1ZSwgdGhpcy5uZXdWYWx1ZSwgdGhpcy5iYXNlVmVyc2lvbilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UmV2ZXJzZWQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFFnKHRoaXMucmFuZ2UsIHRoaXMua2V5LCB0aGlzLm5ld1ZhbHVlLCB0aGlzLm9sZFZhbHVlLCB0aGlzLmJhc2VWZXJzaW9uICsgMSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHN1cGVyLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgdC5yYW5nZSA9IHRoaXMucmFuZ2UudG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdmFsaWRhdGUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMucmFuZ2UuaXNGbGF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImF0dHJpYnV0ZS1vcGVyYXRpb24tcmFuZ2Utbm90LWZsYXQ6IFRoZSByYW5nZSB0byBjaGFuZ2UgaXMgbm90IGZsYXQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5yYW5nZS5nZXRJdGVtcyh7c2hhbGxvdzogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMub2xkVmFsdWUgIT09IG51bGwgJiYgIVlnKHQuZ2V0QXR0cmlidXRlKHRoaXMua2V5KSwgdGhpcy5vbGRWYWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImF0dHJpYnV0ZS1vcGVyYXRpb24td3Jvbmctb2xkLXZhbHVlOiBDaGFuZ2VkIG5vZGUgaGFzIGRpZmZlcmVudCBhdHRyaWJ1dGUgdmFsdWUgdGhhbiBvcGVyYXRpb24ncyBcIiArIFwib2xkIGF0dHJpYnV0ZSB2YWx1ZS5cIiwgdGhpcywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbTogdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogdGhpcy5rZXksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5vbGRWYWx1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5vbGRWYWx1ZSA9PT0gbnVsbCAmJiB0aGlzLm5ld1ZhbHVlICE9PSBudWxsICYmIHQuaGFzQXR0cmlidXRlKHRoaXMua2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiYXR0cmlidXRlLW9wZXJhdGlvbi1hdHRyaWJ1dGUtZXhpc3RzOiBUaGUgYXR0cmlidXRlIHdpdGggZ2l2ZW4ga2V5IGFscmVhZHkgZXhpc3RzLlwiLCB0aGlzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlOiB0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB0aGlzLmtleVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2V4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIVlnKHRoaXMub2xkVmFsdWUsIHRoaXMubmV3VmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcWcodGhpcy5yYW5nZSwgdGhpcy5rZXksIHRoaXMubmV3VmFsdWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiQXR0cmlidXRlT3BlcmF0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUWcoJGguZnJvbUpTT04odC5yYW5nZSwgZSksIHQua2V5LCB0Lm9sZFZhbHVlLCB0Lm5ld1ZhbHVlLCB0LmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBYZyBleHRlbmRzIExnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVBvc2l0aW9uID0gdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ob3dNYW55ID0gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImRldGFjaFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzdXBlci50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHQuc291cmNlUG9zaXRpb24gPSB0aGlzLnNvdXJjZVBvc2l0aW9uLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3ZhbGlkYXRlKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlUG9zaXRpb24ucm9vdC5kb2N1bWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJkZXRhY2gtb3BlcmF0aW9uLW9uLWRvY3VtZW50LW5vZGU6IENhbm5vdCBkZXRhY2ggZG9jdW1lbnQgbm9kZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2V4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBIZygkaC5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQodGhpcy5zb3VyY2VQb3NpdGlvbiwgdGhpcy5ob3dNYW55KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJEZXRhY2hPcGVyYXRpb25cIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBaZyBleHRlbmRzIExnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIobik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVBvc2l0aW9uID0gdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VQb3NpdGlvbi5zdGlja2luZXNzID0gXCJ0b05leHRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuaG93TWFueSA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldFBvc2l0aW9uID0gaS5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXJnZXRQb3NpdGlvbi5zdGlja2luZXNzID0gXCJ0b05vbmVcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldFBvc2l0aW9uLnJvb3Qucm9vdE5hbWUgPT0gXCIkZ3JhdmV5YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJyZW1vdmVcIlxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNvdXJjZVBvc2l0aW9uLnJvb3Qucm9vdE5hbWUgPT0gXCIkZ3JhdmV5YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJyZWluc2VydFwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJtb3ZlXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy5zb3VyY2VQb3NpdGlvbiwgdGhpcy5ob3dNYW55LCB0aGlzLnRhcmdldFBvc2l0aW9uLCB0aGlzLmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRNb3ZlZFJhbmdlU3RhcnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50YXJnZXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeURlbGV0aW9uKHRoaXMuc291cmNlUG9zaXRpb24sIHRoaXMuaG93TWFueSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UmV2ZXJzZWQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zb3VyY2VQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbih0aGlzLnRhcmdldFBvc2l0aW9uLCB0aGlzLmhvd01hbnkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuZ2V0TW92ZWRSYW5nZVN0YXJ0KCksIHRoaXMuaG93TWFueSwgdCwgdGhpcy5iYXNlVmVyc2lvbiArIDEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF92YWxpZGF0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnNvdXJjZVBvc2l0aW9uLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnRhcmdldFBvc2l0aW9uLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnNvdXJjZVBvc2l0aW9uLm9mZnNldDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnRhcmdldFBvc2l0aW9uLm9mZnNldDtcclxuICAgICAgICAgICAgICAgIGlmIChpICsgdGhpcy5ob3dNYW55ID4gdC5tYXhPZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibW92ZS1vcGVyYXRpb24tbm9kZXMtZG8tbm90LWV4aXN0OiBUaGUgbm9kZXMgd2hpY2ggc2hvdWxkIGJlIG1vdmVkIGRvIG5vdCBleGlzdC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodCA9PT0gZSAmJiBpIDwgbiAmJiBuIDwgaSArIHRoaXMuaG93TWFueSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb3ZlLW9wZXJhdGlvbi1yYW5nZS1pbnRvLWl0c2VsZjogVHJ5aW5nIHRvIG1vdmUgYSByYW5nZSBvZiBub2RlcyB0byB0aGUgaW5zaWRlIG9mIHRoYXQgcmFuZ2UuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc291cmNlUG9zaXRpb24ucm9vdCA9PSB0aGlzLnRhcmdldFBvc2l0aW9uLnJvb3QpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoVnModGhpcy5zb3VyY2VQb3NpdGlvbi5nZXRQYXJlbnRQYXRoKCksIHRoaXMudGFyZ2V0UG9zaXRpb24uZ2V0UGFyZW50UGF0aCgpKSA9PSBcInByZWZpeFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnNvdXJjZVBvc2l0aW9uLnBhdGgubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0UG9zaXRpb24ucGF0aFt0XSA+PSBpICYmIHRoaXMudGFyZ2V0UG9zaXRpb24ucGF0aFt0XSA8IGkgKyB0aGlzLmhvd01hbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb3ZlLW9wZXJhdGlvbi1ub2RlLWludG8taXRzZWxmOiBUcnlpbmcgdG8gbW92ZSBhIHJhbmdlIG9mIG5vZGVzIGludG8gb25lIG9mIG5vZGVzIGZyb20gdGhhdCByYW5nZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2V4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBXZygkaC5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQodGhpcy5zb3VyY2VQb3NpdGlvbiwgdGhpcy5ob3dNYW55KSwgdGhpcy50YXJnZXRQb3NpdGlvbilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHN1cGVyLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgdC5zb3VyY2VQb3NpdGlvbiA9IHRoaXMuc291cmNlUG9zaXRpb24udG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICB0LnRhcmdldFBvc2l0aW9uID0gdGhpcy50YXJnZXRQb3NpdGlvbi50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiTW92ZU9wZXJhdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tSlNPTih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gVWguZnJvbUpTT04odC5zb3VyY2VQb3NpdGlvbiwgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gVWguZnJvbUpTT04odC50YXJnZXRQb3NpdGlvbiwgZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHRoaXMoaSwgdC5ob3dNYW55LCBuLCB0LmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB0bSBleHRlbmRzIExnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi5zdGlja2luZXNzID0gXCJ0b05vbmVcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZXMgPSBuZXcgRGgoVWcoZSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG91bGRSZWNlaXZlQXR0cmlidXRlcyA9IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaW5zZXJ0XCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGhvd01hbnkoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ub2Rlcy5tYXhPZmZzZXRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xvbmUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IERoKFsuLi50aGlzLm5vZGVzXS5tYXAodCA9PiB0Ll9jbG9uZSh0cnVlKSkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyB0bSh0aGlzLnBvc2l0aW9uLCB0LCB0aGlzLmJhc2VWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIGUuc2hvdWxkUmVjZWl2ZUF0dHJpYnV0ZXMgPSB0aGlzLnNob3VsZFJlY2VpdmVBdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UmV2ZXJzZWQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5wb3NpdGlvbi5yb290LmRvY3VtZW50LmdyYXZleWFyZDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgVWgodCwgWzBdKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgWmcodGhpcy5wb3NpdGlvbiwgdGhpcy5ub2Rlcy5tYXhPZmZzZXQsIGUsIHRoaXMuYmFzZVZlcnNpb24gKyAxKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdmFsaWRhdGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5wb3NpdGlvbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQgfHwgdC5tYXhPZmZzZXQgPCB0aGlzLnBvc2l0aW9uLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJpbnNlcnQtb3BlcmF0aW9uLXBvc2l0aW9uLWludmFsaWQ6IEluc2VydGlvbiBwb3NpdGlvbiBpcyBpbnZhbGlkLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLm5vZGVzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlcyA9IG5ldyBEaChbLi4udF0ubWFwKHQgPT4gdC5fY2xvbmUodHJ1ZSkpKTtcclxuICAgICAgICAgICAgICAgIGpnKHRoaXMucG9zaXRpb24sIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzdXBlci50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHQucG9zaXRpb24gPSB0aGlzLnBvc2l0aW9uLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgdC5ub2RlcyA9IHRoaXMubm9kZXMudG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IGNsYXNzTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkluc2VydE9wZXJhdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tSlNPTih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5ub2Rlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5wdXNoKGpoLmZyb21KU09OKGUpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChMaC5mcm9tSlNPTihlKSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IHRtKFVoLmZyb21KU09OKHQucG9zaXRpb24sIGUpLCBpLCB0LmJhc2VWZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgIG4uc2hvdWxkUmVjZWl2ZUF0dHJpYnV0ZXMgPSB0LnNob3VsZFJlY2VpdmVBdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZW0gZXh0ZW5kcyBMZyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGksIG4sIG8sIHIpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMub2xkUmFuZ2UgPSBlID8gZS5jbG9uZSgpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMubmV3UmFuZ2UgPSBpID8gaS5jbG9uZSgpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWZmZWN0c0RhdGEgPSBvO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya2VycyA9IG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHR5cGUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJtYXJrZXJcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9uZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZW0odGhpcy5uYW1lLCB0aGlzLm9sZFJhbmdlLCB0aGlzLm5ld1JhbmdlLCB0aGlzLl9tYXJrZXJzLCB0aGlzLmFmZmVjdHNEYXRhLCB0aGlzLmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRSZXZlcnNlZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZW0odGhpcy5uYW1lLCB0aGlzLm5ld1JhbmdlLCB0aGlzLm9sZFJhbmdlLCB0aGlzLl9tYXJrZXJzLCB0aGlzLmFmZmVjdHNEYXRhLCB0aGlzLmJhc2VWZXJzaW9uICsgMSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2V4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5uZXdSYW5nZSA/IFwiX3NldFwiIDogXCJfcmVtb3ZlXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJzW3RdKHRoaXMubmFtZSwgdGhpcy5uZXdSYW5nZSwgdHJ1ZSwgdGhpcy5hZmZlY3RzRGF0YSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHN1cGVyLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub2xkUmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9sZFJhbmdlID0gdGhpcy5vbGRSYW5nZS50b0pTT04oKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmV3UmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm5ld1JhbmdlID0gdGhpcy5uZXdSYW5nZS50b0pTT04oKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHQuX21hcmtlcnM7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IGNsYXNzTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIk1hcmtlck9wZXJhdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tSlNPTih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGVtKHQubmFtZSwgdC5vbGRSYW5nZSA/ICRoLmZyb21KU09OKHQub2xkUmFuZ2UsIGUpIDogbnVsbCwgdC5uZXdSYW5nZSA/ICRoLmZyb21KU09OKHQubmV3UmFuZ2UsIGUpIDogbnVsbCwgZS5tb2RlbC5tYXJrZXJzLCB0LmFmZmVjdHNEYXRhLCB0LmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBpbSBleHRlbmRzIExnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIobik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24uc3RpY2tpbmVzcyA9IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9sZE5hbWUgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uZXdOYW1lID0gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcInJlbmFtZVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb25lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBpbSh0aGlzLnBvc2l0aW9uLmNsb25lKCksIHRoaXMub2xkTmFtZSwgdGhpcy5uZXdOYW1lLCB0aGlzLmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRSZXZlcnNlZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgaW0odGhpcy5wb3NpdGlvbi5jbG9uZSgpLCB0aGlzLm5ld05hbWUsIHRoaXMub2xkTmFtZSwgdGhpcy5iYXNlVmVyc2lvbiArIDEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF92YWxpZGF0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnBvc2l0aW9uLm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBqaCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwicmVuYW1lLW9wZXJhdGlvbi13cm9uZy1wb3NpdGlvbjogR2l2ZW4gcG9zaXRpb24gaXMgaW52YWxpZCBvciBub2RlIGFmdGVyIGl0IGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBFbGVtZW50LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm5hbWUgIT09IHRoaXMub2xkTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJyZW5hbWUtb3BlcmF0aW9uLXdyb25nLW5hbWU6IEVsZW1lbnQgdG8gY2hhbmdlIGhhcyBkaWZmZXJlbnQgbmFtZSB0aGFuIG9wZXJhdGlvbidzIG9sZCBuYW1lLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnBvc2l0aW9uLm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgIHQubmFtZSA9IHRoaXMubmV3TmFtZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gc3VwZXIudG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICB0LnBvc2l0aW9uID0gdGhpcy5wb3NpdGlvbi50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgY2xhc3NOYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiUmVuYW1lT3BlcmF0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgaW0oVWguZnJvbUpTT04odC5wb3NpdGlvbiwgZSksIHQub2xkTmFtZSwgdC5uZXdOYW1lLCB0LmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBubSBleHRlbmRzIExnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSwgbiwgbykge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIobyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvb3QgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXkgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbGRWYWx1ZSA9IGk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5ld1ZhbHVlID0gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgdHlwZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm9sZFZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiYWRkUm9vdEF0dHJpYnV0ZVwiXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubmV3VmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJyZW1vdmVSb290QXR0cmlidXRlXCJcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY2hhbmdlUm9vdEF0dHJpYnV0ZVwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb25lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBubSh0aGlzLnJvb3QsIHRoaXMua2V5LCB0aGlzLm9sZFZhbHVlLCB0aGlzLm5ld1ZhbHVlLCB0aGlzLmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRSZXZlcnNlZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbm0odGhpcy5yb290LCB0aGlzLmtleSwgdGhpcy5uZXdWYWx1ZSwgdGhpcy5vbGRWYWx1ZSwgdGhpcy5iYXNlVmVyc2lvbiArIDEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF92YWxpZGF0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvb3QgIT0gdGhpcy5yb290LnJvb3QgfHwgdGhpcy5yb290LmlzKFwiZG9jdW1lbnRGcmFnbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJyb290YXR0cmlidXRlLW9wZXJhdGlvbi1ub3QtYS1yb290OiBUaGUgZWxlbWVudCB0byBjaGFuZ2UgaXMgbm90IGEgcm9vdCBlbGVtZW50LlwiLCB0aGlzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRoaXMucm9vdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB0aGlzLmtleVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vbGRWYWx1ZSAhPT0gbnVsbCAmJiB0aGlzLnJvb3QuZ2V0QXR0cmlidXRlKHRoaXMua2V5KSAhPT0gdGhpcy5vbGRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJyb290YXR0cmlidXRlLW9wZXJhdGlvbi13cm9uZy1vbGQtdmFsdWU6IENoYW5nZWQgbm9kZSBoYXMgZGlmZmVyZW50IGF0dHJpYnV0ZSB2YWx1ZSB0aGFuIG9wZXJhdGlvbidzIFwiICsgXCJvbGQgYXR0cmlidXRlIHZhbHVlLlwiLCB0aGlzLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3Q6IHRoaXMucm9vdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiB0aGlzLmtleVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vbGRWYWx1ZSA9PT0gbnVsbCAmJiB0aGlzLm5ld1ZhbHVlICE9PSBudWxsICYmIHRoaXMucm9vdC5oYXNBdHRyaWJ1dGUodGhpcy5rZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInJvb3RhdHRyaWJ1dGUtb3BlcmF0aW9uLWF0dHJpYnV0ZS1leGlzdHM6IFRoZSBhdHRyaWJ1dGUgd2l0aCBnaXZlbiBrZXkgYWxyZWFkeSBleGlzdHMuXCIsIHRoaXMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdDogdGhpcy5yb290LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHRoaXMua2V5XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2V4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXdWYWx1ZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdC5fc2V0QXR0cmlidXRlKHRoaXMua2V5LCB0aGlzLm5ld1ZhbHVlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuX3JlbW92ZUF0dHJpYnV0ZSh0aGlzLmtleSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdG9KU09OKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHN1cGVyLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgdC5yb290ID0gdGhpcy5yb290LnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJSb290QXR0cmlidXRlT3BlcmF0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZS5nZXRSb290KHQucm9vdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwicm9vdGF0dHJpYnV0ZS1vcGVyYXRpb24tZnJvbWpzb24tbm8tcm9vdDogQ2Fubm90IGNyZWF0ZSBSb290QXR0cmlidXRlT3BlcmF0aW9uLiBSb290IHdpdGggc3BlY2lmaWVkIG5hbWUgZG9lcyBub3QgZXhpc3QuXCIsIHRoaXMsIHtyb290TmFtZTogdC5yb290fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgbm0oZS5nZXRSb290KHQucm9vdCksIHQua2V5LCB0Lm9sZFZhbHVlLCB0Lm5ld1ZhbHVlLCB0LmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBvbSBleHRlbmRzIExnIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSwgbiwgbykge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIobyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVBvc2l0aW9uID0gdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VQb3NpdGlvbi5zdGlja2luZXNzID0gXCJ0b1ByZXZpb3VzXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhvd01hbnkgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXJnZXRQb3NpdGlvbiA9IGkuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0UG9zaXRpb24uc3RpY2tpbmVzcyA9IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyYXZleWFyZFBvc2l0aW9uID0gbi5jbG9uZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibWVyZ2VcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZGVsZXRpb25Qb3NpdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWgodGhpcy5zb3VyY2VQb3NpdGlvbi5yb290LCB0aGlzLnNvdXJjZVBvc2l0aW9uLnBhdGguc2xpY2UoMCwgLTEpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbW92ZWRSYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnNvdXJjZVBvc2l0aW9uLmdldFNoaWZ0ZWRCeShOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyAkaCh0aGlzLnNvdXJjZVBvc2l0aW9uLCB0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9uZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnNvdXJjZVBvc2l0aW9uLCB0aGlzLmhvd01hbnksIHRoaXMudGFyZ2V0UG9zaXRpb24sIHRoaXMuZ3JhdmV5YXJkUG9zaXRpb24sIHRoaXMuYmFzZVZlcnNpb24pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFJldmVyc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbih0aGlzKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnNvdXJjZVBvc2l0aW9uLnBhdGguc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBVaCh0aGlzLnNvdXJjZVBvc2l0aW9uLnJvb3QsIGUpLl9nZXRUcmFuc2Zvcm1lZEJ5TWVyZ2VPcGVyYXRpb24odGhpcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IHJtKHQsIHRoaXMuaG93TWFueSwgdGhpcy5ncmF2ZXlhcmRQb3NpdGlvbiwgdGhpcy5iYXNlVmVyc2lvbiArIDEpO1xyXG4gICAgICAgICAgICAgICAgbi5pbnNlcnRpb25Qb3NpdGlvbiA9IGk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdmFsaWRhdGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zb3VyY2VQb3NpdGlvbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy50YXJnZXRQb3NpdGlvbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1lcmdlLW9wZXJhdGlvbi1zb3VyY2UtcG9zaXRpb24taW52YWxpZDogTWVyZ2Ugc291cmNlIHBvc2l0aW9uIGlzIGludmFsaWQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFlLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtZXJnZS1vcGVyYXRpb24tdGFyZ2V0LXBvc2l0aW9uLWludmFsaWQ6IE1lcmdlIHRhcmdldCBwb3NpdGlvbiBpcyBpbnZhbGlkLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhvd01hbnkgIT0gdC5tYXhPZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibWVyZ2Utb3BlcmF0aW9uLWhvdy1tYW55LWludmFsaWQ6IE1lcmdlIG9wZXJhdGlvbiBzcGVjaWZpZXMgd3JvbmcgbnVtYmVyIG9mIG5vZGVzIHRvIG1vdmUuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9leGVjdXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc291cmNlUG9zaXRpb24ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9ICRoLl9jcmVhdGVJbih0KTtcclxuICAgICAgICAgICAgICAgIFdnKGUsIHRoaXMudGFyZ2V0UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgV2coJGguX2NyZWF0ZU9uKHQpLCB0aGlzLmdyYXZleWFyZFBvc2l0aW9uKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gc3VwZXIudG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICB0LnNvdXJjZVBvc2l0aW9uID0gdC5zb3VyY2VQb3NpdGlvbi50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHQudGFyZ2V0UG9zaXRpb24gPSB0LnRhcmdldFBvc2l0aW9uLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgdC5ncmF2ZXlhcmRQb3NpdGlvbiA9IHQuZ3JhdmV5YXJkUG9zaXRpb24udG9KU09OKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IGNsYXNzTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIk1lcmdlT3BlcmF0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBVaC5mcm9tSlNPTih0LnNvdXJjZVBvc2l0aW9uLCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVaC5mcm9tSlNPTih0LnRhcmdldFBvc2l0aW9uLCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBVaC5mcm9tSlNPTih0LmdyYXZleWFyZFBvc2l0aW9uLCBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdGhpcyhpLCB0Lmhvd01hbnksIG4sIG8sIHQuYmFzZVZlcnNpb24pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHJtIGV4dGVuZHMgTGcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcihuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRQb3NpdGlvbiA9IHQuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3BsaXRQb3NpdGlvbi5zdGlja2luZXNzID0gXCJ0b05leHRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuaG93TWFueSA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluc2VydGlvblBvc2l0aW9uID0gcm0uZ2V0SW5zZXJ0aW9uUG9zaXRpb24odCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluc2VydGlvblBvc2l0aW9uLnN0aWNraW5lc3MgPSBcInRvTm9uZVwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncmF2ZXlhcmRQb3NpdGlvbiA9IGkgPyBpLmNsb25lKCkgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhdmV5YXJkUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdyYXZleWFyZFBvc2l0aW9uLnN0aWNraW5lc3MgPSBcInRvTmV4dFwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic3BsaXRcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbW92ZVRhcmdldFBvc2l0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuaW5zZXJ0aW9uUG9zaXRpb24ucGF0aC5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgdC5wdXNoKDApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaCh0aGlzLmluc2VydGlvblBvc2l0aW9uLnJvb3QsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBtb3ZlZFJhbmdlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3BsaXRQb3NpdGlvbi5nZXRTaGlmdGVkQnkoTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgJGgodGhpcy5zcGxpdFBvc2l0aW9uLCB0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjbG9uZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnNwbGl0UG9zaXRpb24sIHRoaXMuaG93TWFueSwgdGhpcy5ncmF2ZXlhcmRQb3NpdGlvbiwgdGhpcy5iYXNlVmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICB0Lmluc2VydGlvblBvc2l0aW9uID0gdGhpcy5pbnNlcnRpb25Qb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFJldmVyc2VkKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3BsaXRQb3NpdGlvbi5yb290LmRvY3VtZW50LmdyYXZleWFyZDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgVWgodCwgWzBdKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgb20odGhpcy5tb3ZlVGFyZ2V0UG9zaXRpb24sIHRoaXMuaG93TWFueSwgdGhpcy5zcGxpdFBvc2l0aW9uLCBlLCB0aGlzLmJhc2VWZXJzaW9uICsgMSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3ZhbGlkYXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3BsaXRQb3NpdGlvbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5zcGxpdFBvc2l0aW9uLm9mZnNldDtcclxuICAgICAgICAgICAgICAgIGlmICghdCB8fCB0Lm1heE9mZnNldCA8IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwic3BsaXQtb3BlcmF0aW9uLXBvc2l0aW9uLWludmFsaWQ6IFNwbGl0IHBvc2l0aW9uIGlzIGludmFsaWQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF0LnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJzcGxpdC1vcGVyYXRpb24tc3BsaXQtaW4tcm9vdDogQ2Fubm90IHNwbGl0IHJvb3QgZWxlbWVudC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5ob3dNYW55ICE9IHQubWF4T2Zmc2V0IC0gdGhpcy5zcGxpdFBvc2l0aW9uLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJzcGxpdC1vcGVyYXRpb24taG93LW1hbnktaW52YWxpZDogU3BsaXQgb3BlcmF0aW9uIHNwZWNpZmllcyB3cm9uZyBudW1iZXIgb2Ygbm9kZXMgdG8gbW92ZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5ncmF2ZXlhcmRQb3NpdGlvbiAmJiAhdGhpcy5ncmF2ZXlhcmRQb3NpdGlvbi5ub2RlQWZ0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwic3BsaXQtb3BlcmF0aW9uLWdyYXZleWFyZC1wb3NpdGlvbi1pbnZhbGlkOiBHcmF2ZXlhcmQgcG9zaXRpb24gaW52YWxpZC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2V4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zcGxpdFBvc2l0aW9uLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdyYXZleWFyZFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgV2coJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KHRoaXMuZ3JhdmV5YXJkUG9zaXRpb24sIDEpLCB0aGlzLmluc2VydGlvblBvc2l0aW9uKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5fY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBqZyh0aGlzLmluc2VydGlvblBvc2l0aW9uLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyAkaChVaC5fY3JlYXRlQXQodCwgdGhpcy5zcGxpdFBvc2l0aW9uLm9mZnNldCksIFVoLl9jcmVhdGVBdCh0LCB0Lm1heE9mZnNldCkpO1xyXG4gICAgICAgICAgICAgICAgV2coZSwgdGhpcy5tb3ZlVGFyZ2V0UG9zaXRpb24pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzdXBlci50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHQuc3BsaXRQb3NpdGlvbiA9IHRoaXMuc3BsaXRQb3NpdGlvbi50b0pTT04oKTtcclxuICAgICAgICAgICAgICAgIHQuaW5zZXJ0aW9uUG9zaXRpb24gPSB0aGlzLmluc2VydGlvblBvc2l0aW9uLnRvSlNPTigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JhdmV5YXJkUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmdyYXZleWFyZFBvc2l0aW9uID0gdGhpcy5ncmF2ZXlhcmRQb3NpdGlvbi50b0pTT04oKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBjbGFzc05hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJTcGxpdE9wZXJhdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXRJbnNlcnRpb25Qb3NpdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5wYXRoLnNsaWNlKDAsIC0xKTtcclxuICAgICAgICAgICAgICAgIGVbZS5sZW5ndGggLSAxXSsrO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaCh0LnJvb3QsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tSlNPTih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gVWguZnJvbUpTT04odC5zcGxpdFBvc2l0aW9uLCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVaC5mcm9tSlNPTih0Lmluc2VydGlvblBvc2l0aW9uLCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0LmdyYXZleWFyZFBvc2l0aW9uID8gVWguZnJvbUpTT04odC5ncmF2ZXlhcmRQb3NpdGlvbiwgZSkgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyB0aGlzKGksIHQuaG93TWFueSwgbywgdC5iYXNlVmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICByLmluc2VydGlvblBvc2l0aW9uID0gbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiByXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHNtIGV4dGVuZHMgamgge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpID0gXCJtYWluXCIpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnQgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb290TmFtZSA9IGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGRvY3VtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RvY3VtZW50XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJlcGxhY2UoXCJtb2RlbDpcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA9PSBcInJvb3RFbGVtZW50XCIgfHwgc3VwZXIuaXModClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkgPT0gXCJyb290RWxlbWVudFwiICYmIGUgPT0gdGhpcy5uYW1lIHx8IHN1cGVyLmlzKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRvSlNPTigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvb3ROYW1lXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGFtIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbCA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoID0gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVUZXh0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTGgodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlRWxlbWVudCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGpoKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEZnXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluc2VydCh0LCBlLCBpID0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBMaCAmJiB0LmRhdGEgPT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFVoLl9jcmVhdGVBdChlLCBpKTtcclxuICAgICAgICAgICAgICAgIGlmICh0LnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChobSh0LnJvb3QsIG4ucm9vdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlKCRoLl9jcmVhdGVPbih0KSwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnJvb3QuZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC13cml0ZXItaW5zZXJ0LWZvcmJpZGRlbi1tb3ZlOiBcIiArIFwiQ2Fubm90IG1vdmUgYSBub2RlIGZyb20gYSBkb2N1bWVudCB0byBhIGRpZmZlcmVudCB0cmVlLiBcIiArIFwiSXQgaXMgZm9yYmlkZGVuIHRvIG1vdmUgYSBub2RlIHRoYXQgd2FzIGFscmVhZHkgaW4gYSBkb2N1bWVudCBvdXRzaWRlIG9mIGl0LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLnJvb3QuZG9jdW1lbnQgPyBuLnJvb3QuZG9jdW1lbnQudmVyc2lvbiA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IHRtKG4sIHQsIG8pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBMaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHIuc2hvdWxkUmVjZWl2ZUF0dHJpYnV0ZXMgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoLmFkZE9wZXJhdGlvbihyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuYXBwbHlPcGVyYXRpb24ocik7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEZnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbZSwgaV0gb2YgdC5tYXJrZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBVaC5fY3JlYXRlQXQoaS5yb290LCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyAkaChpLnN0YXJ0Ll9nZXRDb21iaW5lZCh0LCBuKSwgaS5lbmQuX2dldENvbWJpbmVkKHQsIG4pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHtyYW5nZTogbywgdXNpbmdPcGVyYXRpb246IHRydWUsIGFmZmVjdHNEYXRhOiB0cnVlfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwubWFya2Vycy5oYXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTWFya2VyKGUsIHIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZE1hcmtlcihlLCByKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbnNlcnRUZXh0KHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgRmcgfHwgZSBpbnN0YW5jZW9mIGpoIHx8IGUgaW5zdGFuY2VvZiBVaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0KHRoaXMuY3JlYXRlVGV4dCh0KSwgZSwgaSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQodGhpcy5jcmVhdGVUZXh0KHQsIGUpLCBpLCBuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbnNlcnRFbGVtZW50KHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgRmcgfHwgZSBpbnN0YW5jZW9mIGpoIHx8IGUgaW5zdGFuY2VvZiBVaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0KHRoaXMuY3JlYXRlRWxlbWVudCh0KSwgZSwgaSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQodGhpcy5jcmVhdGVFbGVtZW50KHQsIGUpLCBpLCBuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhcHBlbmQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQodCwgZSwgXCJlbmRcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXBwZW5kVGV4dCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEZnIHx8IGUgaW5zdGFuY2VvZiBqaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0KHRoaXMuY3JlYXRlVGV4dCh0KSwgZSwgXCJlbmRcIilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQodGhpcy5jcmVhdGVUZXh0KHQsIGUpLCBpLCBcImVuZFwiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhcHBlbmRFbGVtZW50KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgRmcgfHwgZSBpbnN0YW5jZW9mIGpoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnQodGhpcy5jcmVhdGVFbGVtZW50KHQpLCBlLCBcImVuZFwiKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmluc2VydCh0aGlzLmNyZWF0ZUVsZW1lbnQodCwgZSksIGksIFwiZW5kXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldEF0dHJpYnV0ZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NlcnRXcml0ZXJVc2VkQ29ycmVjdGx5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSBpbnN0YW5jZW9mICRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZ2V0TWluaW1hbEZsYXRSYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbSh0aGlzLCB0LCBlLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG0odGhpcywgdCwgZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0QXR0cmlidXRlcyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpLCBuXSBvZiBIcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXR0cmlidXRlKGksIG4sIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NlcnRXcml0ZXJVc2VkQ29ycmVjdGx5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mICRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZ2V0TWluaW1hbEZsYXRSYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbSh0aGlzLCB0LCBudWxsLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG0odGhpcywgdCwgbnVsbCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xlYXJBdHRyaWJ1dGVzKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2VydFdyaXRlclVzZWRDb3JyZWN0bHkoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5nZXRBdHRyaWJ1dGVLZXlzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVBdHRyaWJ1dGUoZSwgdClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mICRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUodClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuZ2V0SXRlbXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBtb3ZlKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2VydFdyaXRlclVzZWRDb3JyZWN0bHkoKTtcclxuICAgICAgICAgICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiAkaCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLW1vdmUtaW52YWxpZC1yYW5nZTogSW52YWxpZCByYW5nZSB0byBtb3ZlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0LmlzRmxhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ3cml0ZXItbW92ZS1yYW5nZS1ub3QtZmxhdDogUmFuZ2UgdG8gbW92ZSBpcyBub3QgZmxhdC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBVaC5fY3JlYXRlQXQoZSwgaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5pc0VxdWFsKHQuc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRPcGVyYXRpb25Gb3JBZmZlY3RlZE1hcmtlcnMoXCJtb3ZlXCIsIHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFobSh0LnJvb3QsIG4ucm9vdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLW1vdmUtZGlmZmVyZW50LWRvY3VtZW50OiBSYW5nZSBpcyBnb2luZyB0byBiZSBtb3ZlZCBiZXR3ZWVuIGRpZmZlcmVudCBkb2N1bWVudHMuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5yb290LmRvY3VtZW50ID8gdC5yb290LmRvY3VtZW50LnZlcnNpb24gOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyBaZyh0LnN0YXJ0LCB0LmVuZC5vZmZzZXQgLSB0LnN0YXJ0Lm9mZnNldCwgbiwgbyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoLmFkZE9wZXJhdGlvbihyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuYXBwbHlPcGVyYXRpb24ocilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2VydFdyaXRlclVzZWRDb3JyZWN0bHkoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0IGluc3RhbmNlb2YgJGggPyB0IDogJGguX2NyZWF0ZU9uKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZ2V0TWluaW1hbEZsYXRSYW5nZXMoKS5yZXZlcnNlKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZE9wZXJhdGlvbkZvckFmZmVjdGVkTWFya2VycyhcIm1vdmVcIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdW0odC5zdGFydCwgdC5lbmQub2Zmc2V0IC0gdC5zdGFydC5vZmZzZXQsIHRoaXMuYmF0Y2gsIHRoaXMubW9kZWwpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1lcmdlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2VydFdyaXRlclVzZWRDb3JyZWN0bHkoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm5vZGVCZWZvcmU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRPcGVyYXRpb25Gb3JBZmZlY3RlZE1hcmtlcnMoXCJtZXJnZVwiLCB0KTtcclxuICAgICAgICAgICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBqaCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLW1lcmdlLW5vLWVsZW1lbnQtYmVmb3JlOiBOb2RlIGJlZm9yZSBtZXJnZSBwb3NpdGlvbiBtdXN0IGJlIGFuIGVsZW1lbnQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIShpIGluc3RhbmNlb2YgamgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndyaXRlci1tZXJnZS1uby1lbGVtZW50LWFmdGVyOiBOb2RlIGFmdGVyIG1lcmdlIHBvc2l0aW9uIG11c3QgYmUgYW4gZWxlbWVudC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdC5yb290LmRvY3VtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2VEZXRhY2hlZCh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZXJnZSh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkZyb21QYXRoKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1vZGVsLmNyZWF0ZVBvc2l0aW9uRnJvbVBhdGgodCwgZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUG9zaXRpb25BdCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5jcmVhdGVQb3NpdGlvbkF0KHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVBvc2l0aW9uQWZ0ZXIodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwuY3JlYXRlUG9zaXRpb25BZnRlcih0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkJlZm9yZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5jcmVhdGVQb3NpdGlvbkJlZm9yZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5jcmVhdGVSYW5nZSh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSYW5nZUluKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1vZGVsLmNyZWF0ZVJhbmdlSW4odClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUmFuZ2VPbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5jcmVhdGVSYW5nZU9uKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVNlbGVjdGlvbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5jcmVhdGVTZWxlY3Rpb24odCwgZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21lcmdlRGV0YWNoZWQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0Lm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgIHRoaXMubW92ZSgkaC5fY3JlYXRlSW4oaSksIFVoLl9jcmVhdGVBdChlLCBcImVuZFwiKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZShpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfbWVyZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFVoLl9jcmVhdGVBdCh0Lm5vZGVCZWZvcmUsIFwiZW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFVoLl9jcmVhdGVBdCh0Lm5vZGVBZnRlciwgMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5yb290LmRvY3VtZW50LmdyYXZleWFyZDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgVWgobiwgWzBdKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0LnJvb3QuZG9jdW1lbnQudmVyc2lvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgb20oaSwgdC5ub2RlQWZ0ZXIubWF4T2Zmc2V0LCBlLCBvLCByKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmF0Y2guYWRkT3BlcmF0aW9uKHMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5hcHBseU9wZXJhdGlvbihzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5hbWUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGpoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ3cml0ZXItcmVuYW1lLW5vdC1lbGVtZW50LWluc3RhbmNlOiBUcnlpbmcgdG8gcmVuYW1lIGFuIG9iamVjdCB3aGljaCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgRWxlbWVudC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJvb3QuZG9jdW1lbnQgPyB0LnJvb3QuZG9jdW1lbnQudmVyc2lvbiA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IGltKFVoLl9jcmVhdGVCZWZvcmUodCksIHQubmFtZSwgZSwgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhdGNoLmFkZE9wZXJhdGlvbihuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuYXBwbHlPcGVyYXRpb24obilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3BsaXQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmICghaS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLXNwbGl0LWVsZW1lbnQtbm8tcGFyZW50OiBFbGVtZW50IHdpdGggbm8gcGFyZW50IGNhbiBub3QgYmUgc3BsaXQuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gaS5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdC5wYXJlbnQuZ2V0QW5jZXN0b3JzKHtpbmNsdWRlU2VsZjogdHJ1ZX0pLmluY2x1ZGVzKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndyaXRlci1zcGxpdC1pbnZhbGlkLWxpbWl0LWVsZW1lbnQ6IExpbWl0IGVsZW1lbnQgaXMgbm90IGEgcG9zaXRpb24gYW5jZXN0b3IuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgbiwgbztcclxuICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaS5yb290LmRvY3VtZW50ID8gaS5yb290LmRvY3VtZW50LnZlcnNpb24gOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBpLm1heE9mZnNldCAtIHQub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgcm0odCwgciwgbnVsbCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYXRjaC5hZGRPcGVyYXRpb24ocyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5hcHBseU9wZXJhdGlvbihzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW4gJiYgIW8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB0LnBhcmVudC5uZXh0U2libGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ID0gdGhpcy5jcmVhdGVQb3NpdGlvbkFmdGVyKHQucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdC5wYXJlbnRcclxuICAgICAgICAgICAgICAgIH0gd2hpbGUgKGkgIT09IGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtwb3NpdGlvbjogdCwgcmFuZ2U6IG5ldyAkaChVaC5fY3JlYXRlQXQobiwgXCJlbmRcIiksIFVoLl9jcmVhdGVBdChvLCAwKSl9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHdyYXAodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0LmlzRmxhdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ3cml0ZXItd3JhcC1yYW5nZS1ub3QtZmxhdDogUmFuZ2UgdG8gd3JhcCBpcyBub3QgZmxhdC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlIGluc3RhbmNlb2YgamggPyBlIDogbmV3IGpoKGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuY2hpbGRDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLXdyYXAtZWxlbWVudC1ub3QtZW1wdHk6IEVsZW1lbnQgdG8gd3JhcCB3aXRoIGlzIG5vdCBlbXB0eS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpLnBhcmVudCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ3cml0ZXItd3JhcC1lbGVtZW50LWF0dGFjaGVkOiBFbGVtZW50IHRvIHdyYXAgd2l0aCBpcyBhbHJlYWR5IGF0dGFjaGVkIHRvIHRyZWUgbW9kZWwuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluc2VydChpLCB0LnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgJGgodC5zdGFydC5nZXRTaGlmdGVkQnkoMSksIHQuZW5kLmdldFNoaWZ0ZWRCeSgxKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmUobiwgVWguX2NyZWF0ZUF0KGksIDApKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1bndyYXAodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQucGFyZW50ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndyaXRlci11bndyYXAtZWxlbWVudC1uby1wYXJlbnQ6IFRyeWluZyB0byB1bndyYXAgYW4gZWxlbWVudCB3aGljaCBoYXMgbm8gcGFyZW50LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlKCRoLl9jcmVhdGVJbih0KSwgdGhpcy5jcmVhdGVQb3NpdGlvbkFmdGVyKHQpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZE1hcmtlcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NlcnRXcml0ZXJVc2VkQ29ycmVjdGx5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUgfHwgdHlwZW9mIGUudXNpbmdPcGVyYXRpb24gIT0gXCJib29sZWFuXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLWFkZE1hcmtlci1uby11c2luZ09wZXJhdGlvbjogVGhlIG9wdGlvbnMudXNpbmdPcGVyYXRpb24gcGFyYW1ldGVyIGlzIHJlcXVpcmVkIHdoZW4gYWRkaW5nIGEgbmV3IG1hcmtlci5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnVzaW5nT3BlcmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUucmFuZ2U7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5hZmZlY3RzRGF0YSA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBlLmFmZmVjdHNEYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZWwubWFya2Vycy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLWFkZE1hcmtlci1tYXJrZXItZXhpc3RzOiBNYXJrZXIgd2l0aCBwcm92aWRlZCBuYW1lIGFscmVhZHkgZXhpc3RzLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndyaXRlci1hZGRNYXJrZXItbm8tcmFuZ2U6IFJhbmdlIHBhcmFtZXRlciBpcyByZXF1aXJlZCB3aGVuIGFkZGluZyBhIG5ldyBtYXJrZXIuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5tYXJrZXJzLl9zZXQodCwgbiwgaSwgbylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRtKHRoaXMsIHQsIG51bGwsIG4sIG8pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwubWFya2Vycy5nZXQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlTWFya2VyKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Fzc2VydFdyaXRlclVzZWRDb3JyZWN0bHkoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0eXBlb2YgdCA9PSBcInN0cmluZ1wiID8gdCA6IHQubmFtZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLm1vZGVsLm1hcmtlcnMuZ2V0KGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndyaXRlci11cGRhdGVNYXJrZXItbWFya2VyLW5vdC1leGlzdHM6IE1hcmtlciB3aXRoIHByb3ZpZGVkIG5hbWUgZG9lcyBub3QgZXhpc3RzLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5tYXJrZXJzLl9yZWZyZXNoKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHR5cGVvZiBlLnVzaW5nT3BlcmF0aW9uID09IFwiYm9vbGVhblwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHR5cGVvZiBlLmFmZmVjdHNEYXRhID09IFwiYm9vbGVhblwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHIgPyBlLmFmZmVjdHNEYXRhIDogbi5hZmZlY3RzRGF0YTtcclxuICAgICAgICAgICAgICAgIGlmICghbyAmJiAhZS5yYW5nZSAmJiAhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ3cml0ZXItdXBkYXRlTWFya2VyLXdyb25nLW9wdGlvbnM6IE9uZSBvZiB0aGUgb3B0aW9ucyBpcyByZXF1aXJlZCAtIHByb3ZpZGUgcmFuZ2UsIHVzaW5nT3BlcmF0aW9ucyBvciBhZmZlY3RzRGF0YS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBuLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gZS5yYW5nZSA/IGUucmFuZ2UgOiBhO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8gJiYgZS51c2luZ09wZXJhdGlvbiAhPT0gbi5tYW5hZ2VkVXNpbmdPcGVyYXRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUudXNpbmdPcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG0odGhpcywgaSwgbnVsbCwgYywgcylcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkbSh0aGlzLCBpLCBhLCBudWxsLCBzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5tYXJrZXJzLl9zZXQoaSwgYywgdW5kZWZpbmVkLCBzKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuLm1hbmFnZWRVc2luZ09wZXJhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBkbSh0aGlzLCBpLCBhLCBjLCBzKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLm1hcmtlcnMuX3NldChpLCBjLCB1bmRlZmluZWQsIHMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZU1hcmtlcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NlcnRXcml0ZXJVc2VkQ29ycmVjdGx5KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHlwZW9mIHQgPT0gXCJzdHJpbmdcIiA/IHQgOiB0Lm5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubW9kZWwubWFya2Vycy5oYXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwid3JpdGVyLXJlbW92ZU1hcmtlci1uby1tYXJrZXI6IFRyeWluZyB0byByZW1vdmUgbWFya2VyIHdoaWNoIGRvZXMgbm90IGV4aXN0LlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMubW9kZWwubWFya2Vycy5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkubWFuYWdlZFVzaW5nT3BlcmF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubW9kZWwubWFya2Vycy5fcmVtb3ZlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZ2V0UmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIGRtKHRoaXMsIGUsIG4sIG51bGwsIGkuYWZmZWN0c0RhdGEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldFNlbGVjdGlvbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NlcnRXcml0ZXJVc2VkQ29ycmVjdGx5KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5fc2V0VG8odCwgZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0U2VsZWN0aW9uRm9jdXModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24uX3NldEZvY3VzKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldFNlbGVjdGlvbkF0dHJpYnV0ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NlcnRXcml0ZXJVc2VkQ29ycmVjdGx5KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRTZWxlY3Rpb25BdHRyaWJ1dGUodCwgZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbZSwgaV0gb2YgSHModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0U2VsZWN0aW9uQXR0cmlidXRlKGUsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW1vdmVTZWxlY3Rpb25BdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZShlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgb3ZlcnJpZGVTZWxlY3Rpb25HcmF2aXR5KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uLl9vdmVycmlkZUdyYXZpdHkoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXN0b3JlU2VsZWN0aW9uR3Jhdml0eSh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5fcmVzdG9yZUdyYXZpdHkodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldFNlbGVjdGlvbkF0dHJpYnV0ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5pc0NvbGxhcHNlZCAmJiBpLmFuY2hvci5wYXJlbnQuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBkZi5fZ2V0U3RvcmVBdHRyaWJ1dGVLZXkodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUobiwgZSwgaS5hbmNob3IucGFyZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5fc2V0QXR0cmlidXRlKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVTZWxlY3Rpb25BdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuaXNDb2xsYXBzZWQgJiYgZS5hbmNob3IucGFyZW50LmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZGYuX2dldFN0b3JlQXR0cmlidXRlS2V5KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKGksIGUuYW5jaG9yLnBhcmVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuX3JlbW92ZUF0dHJpYnV0ZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYXNzZXJ0V3JpdGVyVXNlZENvcnJlY3RseSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGVsLl9jdXJyZW50V3JpdGVyICE9PSB0aGlzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndyaXRlci1pbmNvcnJlY3QtdXNlOiBUcnlpbmcgdG8gdXNlIGEgd3JpdGVyIG91dHNpZGUgdGhlIGNoYW5nZSgpIGJsb2NrLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYWRkT3BlcmF0aW9uRm9yQWZmZWN0ZWRNYXJrZXJzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0aGlzLm1vZGVsLm1hcmtlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkubWFuYWdlZFVzaW5nT3BlcmF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5nZXRSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT0gXCJtb3ZlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGUuY29udGFpbnNQb3NpdGlvbihuLnN0YXJ0KSB8fCBlLnN0YXJ0LmlzRXF1YWwobi5zdGFydCkgfHwgZS5jb250YWluc1Bvc2l0aW9uKG4uZW5kKSB8fCBlLmVuZC5pc0VxdWFsKG4uZW5kKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLm5vZGVCZWZvcmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG4uc3RhcnQucGFyZW50ID09IHQgJiYgbi5zdGFydC5pc0F0RW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5lbmQucGFyZW50ID09IGkgJiYgbi5lbmQub2Zmc2V0ID09IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBuLmVuZC5ub2RlQWZ0ZXIgPT0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IG4uc3RhcnQubm9kZUFmdGVyID09IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSByIHx8IHMgfHwgYSB8fCBjXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTWFya2VyKGkubmFtZSwge3JhbmdlOiBufSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNtKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IHQubW9kZWw7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBvLmRvY3VtZW50O1xyXG4gICAgICAgICAgICBsZXQgcyA9IG4uc3RhcnQ7XHJcbiAgICAgICAgICAgIGxldCBhO1xyXG4gICAgICAgICAgICBsZXQgYztcclxuICAgICAgICAgICAgbGV0IGw7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuLmdldFdhbGtlcih7c2hhbGxvdzogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICBsID0gdC5pdGVtLmdldEF0dHJpYnV0ZShlKTtcclxuICAgICAgICAgICAgICAgIGlmIChhICYmIGMgIT0gbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjICE9IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHMgPSBhXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhID0gdC5uZXh0UG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICBjID0gbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhIGluc3RhbmNlb2YgVWggJiYgYSAhPSBzICYmIGMgIT0gaSkge1xyXG4gICAgICAgICAgICAgICAgZCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3ICRoKHMsIGEpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IG4ucm9vdC5kb2N1bWVudCA/IHIudmVyc2lvbiA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0gbmV3IFFnKG4sIGUsIGMsIGksIGwpO1xyXG4gICAgICAgICAgICAgICAgdC5iYXRjaC5hZGRPcGVyYXRpb24oZCk7XHJcbiAgICAgICAgICAgICAgICBvLmFwcGx5T3BlcmF0aW9uKGQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxtKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IHQubW9kZWw7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBvLmRvY3VtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBzID0gbi5nZXRBdHRyaWJ1dGUoZSk7XHJcbiAgICAgICAgICAgIGxldCBhLCBjO1xyXG4gICAgICAgICAgICBpZiAocyAhPSBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gbi5yb290ID09PSBuO1xyXG4gICAgICAgICAgICAgICAgaWYgKGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5kb2N1bWVudCA/IHIudmVyc2lvbiA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IG5ldyBubShuLCBlLCBzLCBpLCB0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhID0gbmV3ICRoKFVoLl9jcmVhdGVCZWZvcmUobiksIHQuY3JlYXRlUG9zaXRpb25BZnRlcihuKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGEucm9vdC5kb2N1bWVudCA/IHIudmVyc2lvbiA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IG5ldyBRZyhhLCBlLCBzLCBpLCBvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdC5iYXRjaC5hZGRPcGVyYXRpb24oYyk7XHJcbiAgICAgICAgICAgICAgICBvLmFwcGx5T3BlcmF0aW9uKGMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRtKHQsIGUsIGksIG4sIG8pIHtcclxuICAgICAgICAgICAgY29uc3QgciA9IHQubW9kZWw7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSByLmRvY3VtZW50O1xyXG4gICAgICAgICAgICBjb25zdCBhID0gbmV3IGVtKGUsIGksIG4sIHIubWFya2Vycywgbywgcy52ZXJzaW9uKTtcclxuICAgICAgICAgICAgdC5iYXRjaC5hZGRPcGVyYXRpb24oYSk7XHJcbiAgICAgICAgICAgIHIuYXBwbHlPcGVyYXRpb24oYSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVtKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgIGlmICh0LnJvb3QuZG9jdW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyBVaChpLmdyYXZleWFyZCwgWzBdKTtcclxuICAgICAgICAgICAgICAgIG8gPSBuZXcgWmcodCwgZSwgciwgaS52ZXJzaW9uKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbyA9IG5ldyBYZyh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkuYWRkT3BlcmF0aW9uKG8pO1xyXG4gICAgICAgICAgICBuLmFwcGx5T3BlcmF0aW9uKG8pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBobSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0ID09PSBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2Ygc20gJiYgZSBpbnN0YW5jZW9mIHNtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZm0ge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJDb2xsZWN0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZXNJbkVsZW1lbnQgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudFNuYXBzaG90cyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2VkTWFya2VycyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2VDb3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXNXaXRoR3JhdmV5YXJkID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgaXNFbXB0eSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGFuZ2VzSW5FbGVtZW50LnNpemUgPT0gMCAmJiB0aGlzLl9jaGFuZ2VkTWFya2Vycy5zaXplID09IDBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaEl0ZW0odCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5JbnNlcnRlZEVsZW1lbnQodC5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrUmVtb3ZlKHQucGFyZW50LCB0LnN0YXJ0T2Zmc2V0LCB0Lm9mZnNldFNpemUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya0luc2VydCh0LnBhcmVudCwgdC5zdGFydE9mZnNldCwgdC5vZmZzZXRTaXplKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSAkaC5fY3JlYXRlT24odCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fbWFya2VyQ29sbGVjdGlvbi5nZXRNYXJrZXJzSW50ZXJzZWN0aW5nUmFuZ2UoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5nZXRSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnVmZmVyTWFya2VyQ2hhbmdlKHQubmFtZSwgZSwgZSwgdC5hZmZlY3RzRGF0YSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXMgPSBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJ1ZmZlck9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHQudHlwZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcImluc2VydFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0luSW5zZXJ0ZWRFbGVtZW50KHQucG9zaXRpb24ucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya0luc2VydCh0LnBvc2l0aW9uLnBhcmVudCwgdC5wb3NpdGlvbi5vZmZzZXQsIHQubm9kZXMubWF4T2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwiYWRkQXR0cmlidXRlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVtb3ZlQXR0cmlidXRlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwiY2hhbmdlQXR0cmlidXRlXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQucmFuZ2UuZ2V0SXRlbXMoe3NoYWxsb3c6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5JbnNlcnRlZEVsZW1lbnQoZS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21hcmtBdHRyaWJ1dGUoZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJyZW1vdmVcIjpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlXCJtb3ZlXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVpbnNlcnRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5zb3VyY2VQb3NpdGlvbi5pc0VxdWFsKHQudGFyZ2V0UG9zaXRpb24pIHx8IHQuc291cmNlUG9zaXRpb24uZ2V0U2hpZnRlZEJ5KHQuaG93TWFueSkuaXNFcXVhbCh0LnRhcmdldFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX2lzSW5JbnNlcnRlZEVsZW1lbnQodC5zb3VyY2VQb3NpdGlvbi5wYXJlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5faXNJbkluc2VydGVkRWxlbWVudCh0LnRhcmdldFBvc2l0aW9uLnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya1JlbW92ZSh0LnNvdXJjZVBvc2l0aW9uLnBhcmVudCwgdC5zb3VyY2VQb3NpdGlvbi5vZmZzZXQsIHQuaG93TWFueSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21hcmtJbnNlcnQodC50YXJnZXRQb3NpdGlvbi5wYXJlbnQsIHQuZ2V0TW92ZWRSYW5nZVN0YXJ0KCkub2Zmc2V0LCB0Lmhvd01hbnkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZVwicmVuYW1lXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5JbnNlcnRlZEVsZW1lbnQodC5wb3NpdGlvbi5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrUmVtb3ZlKHQucG9zaXRpb24ucGFyZW50LCB0LnBvc2l0aW9uLm9mZnNldCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21hcmtJbnNlcnQodC5wb3NpdGlvbi5wYXJlbnQsIHQucG9zaXRpb24ub2Zmc2V0LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdCh0LnBvc2l0aW9uLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX21hcmtlckNvbGxlY3Rpb24uZ2V0TWFya2Vyc0ludGVyc2VjdGluZ1JhbmdlKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5nZXRSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWZmZXJNYXJrZXJDaGFuZ2UodC5uYW1lLCBlLCBlLCB0LmFmZmVjdHNEYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcInNwbGl0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc3BsaXRQb3NpdGlvbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNJbkluc2VydGVkRWxlbWVudChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya1JlbW92ZShlLCB0LnNwbGl0UG9zaXRpb24ub2Zmc2V0LCB0Lmhvd01hbnkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0luSW5zZXJ0ZWRFbGVtZW50KHQuaW5zZXJ0aW9uUG9zaXRpb24ucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya0luc2VydCh0Lmluc2VydGlvblBvc2l0aW9uLnBhcmVudCwgdC5pbnNlcnRpb25Qb3NpdGlvbi5vZmZzZXQsIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuZ3JhdmV5YXJkUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21hcmtSZW1vdmUodC5ncmF2ZXlhcmRQb3NpdGlvbi5wYXJlbnQsIHQuZ3JhdmV5YXJkUG9zaXRpb24ub2Zmc2V0LCAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2VcIm1lcmdlXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc291cmNlUG9zaXRpb24ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2lzSW5JbnNlcnRlZEVsZW1lbnQoZS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrUmVtb3ZlKGUucGFyZW50LCBlLnN0YXJ0T2Zmc2V0LCAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdyYXZleWFyZFBvc2l0aW9uLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya0luc2VydChpLCB0LmdyYXZleWFyZFBvc2l0aW9uLm9mZnNldCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRhcmdldFBvc2l0aW9uLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0luSW5zZXJ0ZWRFbGVtZW50KG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrSW5zZXJ0KG4sIHQudGFyZ2V0UG9zaXRpb24ub2Zmc2V0LCBlLm1heE9mZnNldClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXMgPSBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJ1ZmZlck1hcmtlckNoYW5nZSh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5fY2hhbmdlZE1hcmtlcnMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlZE1hcmtlcnMuc2V0KHQsIHtvbGRSYW5nZTogZSwgbmV3UmFuZ2U6IGksIGFmZmVjdHNEYXRhOiBufSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgby5uZXdSYW5nZSA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5hZmZlY3RzRGF0YSA9IG47XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8ub2xkUmFuZ2UgPT0gbnVsbCAmJiBvLm5ld1JhbmdlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlZE1hcmtlcnMuZGVsZXRlKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRNYXJrZXJzVG9SZW1vdmUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gW107XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtlLCBpXSBvZiB0aGlzLl9jaGFuZ2VkTWFya2Vycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLm9sZFJhbmdlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5wdXNoKHtuYW1lOiBlLCByYW5nZTogaS5vbGRSYW5nZX0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0TWFya2Vyc1RvQWRkKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbZSwgaV0gb2YgdGhpcy5fY2hhbmdlZE1hcmtlcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaS5uZXdSYW5nZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucHVzaCh7bmFtZTogZSwgcmFuZ2U6IGkubmV3UmFuZ2V9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldENoYW5nZWRNYXJrZXJzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5fY2hhbmdlZE1hcmtlcnMpLm1hcCh0ID0+ICh7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdFswXSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7b2xkUmFuZ2U6IHRbMV0ub2xkUmFuZ2UsIG5ld1JhbmdlOiB0WzFdLm5ld1JhbmdlfVxyXG4gICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhc0RhdGFDaGFuZ2VzKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBbLCB0XSBvZiB0aGlzLl9jaGFuZ2VkTWFya2Vycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmFmZmVjdHNEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NoYW5nZXNJbkVsZW1lbnQuc2l6ZSA+IDBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hhbmdlcyh0ID0ge2luY2x1ZGVDaGFuZ2VzSW5HcmF2ZXlhcmQ6IGZhbHNlfSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NhY2hlZENoYW5nZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5pbmNsdWRlQ2hhbmdlc0luR3JhdmV5YXJkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRDaGFuZ2VzV2l0aEdyYXZleWFyZC5zbGljZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZENoYW5nZXMuc2xpY2UoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLl9jaGFuZ2VzSW5FbGVtZW50LmtleXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9jaGFuZ2VzSW5FbGVtZW50LmdldCh0KS5zb3J0KCh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0Lm9mZnNldCA9PT0gZS5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgIT0gZS50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQudHlwZSA9PSBcInJlbW92ZVwiID8gLTEgOiAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0Lm9mZnNldCA8IGUub2Zmc2V0ID8gLTEgOiAxXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2VsZW1lbnRTbmFwc2hvdHMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBnbSh0LmdldENoaWxkcmVuKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBtbShuLmxlbmd0aCwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2Ygcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PT0gXCJpXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaCh0aGlzLl9nZXRJbnNlcnREaWZmKHQsIHMsIG9bc10ubmFtZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcysrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gXCJyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaCh0aGlzLl9nZXRSZW1vdmVEaWZmKHQsIHMsIG5bYV0ubmFtZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSsrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gXCJhXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBvW3NdLmF0dHJpYnV0ZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gblthXS5hdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob1tzXS5uYW1lID09IFwiJHRleHRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBuZXcgJGgoVWguX2NyZWF0ZUF0KHQsIHMpLCBVaC5fY3JlYXRlQXQodCwgcyArIDEpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5vZmZzZXRUb0luZGV4KHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBuZXcgJGgoVWguX2NyZWF0ZUF0KHQsIHMpLCBVaC5fY3JlYXRlQXQodC5nZXRDaGlsZChlKSwgMCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnB1c2goLi4udGhpcy5fZ2V0QXR0cmlidXRlc0RpZmYoYywgciwgaSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcysrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYSsrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhKytcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuc29ydCgodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnBvc2l0aW9uLnJvb3QgIT0gZS5wb3NpdGlvbi5yb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnBvc2l0aW9uLnJvb3Qucm9vdE5hbWUgPCBlLnBvc2l0aW9uLnJvb3Qucm9vdE5hbWUgPyAtMSA6IDFcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQucG9zaXRpb24uaXNFcXVhbChlLnBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jaGFuZ2VDb3VudCAtIGUuY2hhbmdlQ291bnRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQucG9zaXRpb24uaXNCZWZvcmUoZS5wb3NpdGlvbikgPyAtMSA6IDFcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgdCA9IDE7IHQgPCBlLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGVbdCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlW3RdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLnR5cGUgPT0gXCJyZW1vdmVcIiAmJiBuLnR5cGUgPT0gXCJyZW1vdmVcIiAmJiBpLm5hbWUgPT0gXCIkdGV4dFwiICYmIG4ubmFtZSA9PSBcIiR0ZXh0XCIgJiYgaS5wb3NpdGlvbi5pc0VxdWFsKG4ucG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBpLnR5cGUgPT0gXCJpbnNlcnRcIiAmJiBuLnR5cGUgPT0gXCJpbnNlcnRcIiAmJiBpLm5hbWUgPT0gXCIkdGV4dFwiICYmIG4ubmFtZSA9PSBcIiR0ZXh0XCIgJiYgaS5wb3NpdGlvbi5wYXJlbnQgPT0gbi5wb3NpdGlvbi5wYXJlbnQgJiYgaS5wb3NpdGlvbi5vZmZzZXQgKyBpLmxlbmd0aCA9PSBuLnBvc2l0aW9uLm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gaS50eXBlID09IFwiYXR0cmlidXRlXCIgJiYgbi50eXBlID09IFwiYXR0cmlidXRlXCIgJiYgaS5wb3NpdGlvbi5wYXJlbnQgPT0gbi5wb3NpdGlvbi5wYXJlbnQgJiYgaS5yYW5nZS5pc0ZsYXQgJiYgbi5yYW5nZS5pc0ZsYXQgJiYgaS5wb3NpdGlvbi5vZmZzZXQgKyBpLmxlbmd0aCA9PSBuLnBvc2l0aW9uLm9mZnNldCAmJiBpLmF0dHJpYnV0ZUtleSA9PSBuLmF0dHJpYnV0ZUtleSAmJiBpLmF0dHJpYnV0ZU9sZFZhbHVlID09IG4uYXR0cmlidXRlT2xkVmFsdWUgJiYgaS5hdHRyaWJ1dGVOZXdWYWx1ZSA9PSBuLmF0dHJpYnV0ZU5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvIHx8IHIgfHwgcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlW3QgLSAxXS5sZW5ndGgrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVbdCAtIDFdLnJhbmdlLmVuZCA9IGVbdCAtIDFdLnJhbmdlLmVuZC5nZXRTaGlmdGVkQnkoMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNwbGljZSh0LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC0tXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdC5jaGFuZ2VDb3VudDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC50eXBlID09IFwiYXR0cmlidXRlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHQucG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0Lmxlbmd0aFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZUNvdW50ID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlZENoYW5nZXNXaXRoR3JhdmV5YXJkID0gZS5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVkQ2hhbmdlcyA9IGUuc2xpY2UoKS5maWx0ZXIocG0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaW5jbHVkZUNoYW5nZXNJbkdyYXZleWFyZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRDaGFuZ2VzV2l0aEdyYXZleWFyZFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FjaGVkQ2hhbmdlc1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXNldCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZXNJbkVsZW1lbnQuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRTbmFwc2hvdHMuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZWRNYXJrZXJzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZWRDaGFuZ2VzID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfbWFya0luc2VydCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0ge3R5cGU6IFwiaW5zZXJ0XCIsIG9mZnNldDogZSwgaG93TWFueTogaSwgY291bnQ6IHRoaXMuX2NoYW5nZUNvdW50Kyt9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya0NoYW5nZSh0LCBuKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfbWFya1JlbW92ZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0ge3R5cGU6IFwicmVtb3ZlXCIsIG9mZnNldDogZSwgaG93TWFueTogaSwgY291bnQ6IHRoaXMuX2NoYW5nZUNvdW50Kyt9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya0NoYW5nZSh0LCBuKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUFsbE5lc3RlZENoYW5nZXModCwgZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21hcmtBdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHt0eXBlOiBcImF0dHJpYnV0ZVwiLCBvZmZzZXQ6IHQuc3RhcnRPZmZzZXQsIGhvd01hbnk6IHQub2Zmc2V0U2l6ZSwgY291bnQ6IHRoaXMuX2NoYW5nZUNvdW50Kyt9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFya0NoYW5nZSh0LnBhcmVudCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21hcmtDaGFuZ2UodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWFrZVNuYXBzaG90KHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2dldENoYW5nZXNGb3JFbGVtZW50KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2hhbmdlKGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKGUpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBpLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlbdF0uaG93TWFueSA8IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zcGxpY2UodCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQtLVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldENoYW5nZXNGb3JFbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NoYW5nZXNJbkVsZW1lbnQuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2NoYW5nZXNJbkVsZW1lbnQuZ2V0KHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFuZ2VzSW5FbGVtZW50LnNldCh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21ha2VTbmFwc2hvdCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2VsZW1lbnRTbmFwc2hvdHMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudFNuYXBzaG90cy5zZXQodCwgZ20odC5nZXRDaGlsZHJlbigpKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2hhbmRsZUNoYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0Lm5vZGVzVG9IYW5kbGUgPSB0Lmhvd01hbnk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0Lm9mZnNldCArIHQuaG93TWFueTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5vZmZzZXQgKyBpLmhvd01hbnk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcImluc2VydFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLnR5cGUgPT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDw9IGkub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5vZmZzZXQgKz0gdC5ob3dNYW55XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQub2Zmc2V0IDwgbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuaG93TWFueSArPSB0Lm5vZGVzVG9IYW5kbGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ub2Rlc1RvSGFuZGxlID0gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLnR5cGUgPT0gXCJyZW1vdmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDwgaS5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLm9mZnNldCArPSB0Lmhvd01hbnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaS50eXBlID09IFwiYXR0cmlidXRlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0Lm9mZnNldCA8PSBpLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkub2Zmc2V0ICs9IHQuaG93TWFueVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm9mZnNldCA8IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5ob3dNYW55O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuaG93TWFueSA9IHQub2Zmc2V0IC0gaS5vZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS51bnNoaWZ0KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhdHRyaWJ1dGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3dNYW55OiBvIC0gaS5ob3dNYW55LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogdGhpcy5fY2hhbmdlQ291bnQrK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLnR5cGUgPT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPD0gaS5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLm9mZnNldCAtPSB0Lmhvd01hbnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobiA8PSBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDwgaS5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG4gLSBpLm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5vZmZzZXQgPSB0Lm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5ob3dNYW55IC09IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubm9kZXNUb0hhbmRsZSAtPSBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5ob3dNYW55IC09IHQubm9kZXNUb0hhbmRsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ub2Rlc1RvSGFuZGxlID0gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDw9IGkub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubm9kZXNUb0hhbmRsZSAtPSBpLmhvd01hbnk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuaG93TWFueSA9IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQub2Zmc2V0IDwgbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gbyAtIHQub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmhvd01hbnkgLT0gZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ub2Rlc1RvSGFuZGxlIC09IGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA8PSBpLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkub2Zmc2V0IC09IHQuaG93TWFueVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm9mZnNldCA8IGkub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ub2Rlc1RvSGFuZGxlICs9IGkuaG93TWFueTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmhvd01hbnkgPSAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkudHlwZSA9PSBcImF0dHJpYnV0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA8PSBpLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkub2Zmc2V0IC09IHQuaG93TWFueVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm9mZnNldCA8IGkub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG4gLSBpLm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLm9mZnNldCA9IHQub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuaG93TWFueSAtPSBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQub2Zmc2V0IDwgbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuIDw9IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuaG93TWFueTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5ob3dNYW55ID0gdC5vZmZzZXQgLSBpLm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG4gLSBpLmhvd01hbnkgLSB0Lm5vZGVzVG9IYW5kbGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUudW5zaGlmdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImF0dHJpYnV0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiB0Lm9mZnNldCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvd01hbnk6IG8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogdGhpcy5fY2hhbmdlQ291bnQrK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuaG93TWFueSAtPSBvIC0gdC5vZmZzZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcImF0dHJpYnV0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLnR5cGUgPT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQub2Zmc2V0IDwgaS5vZmZzZXQgJiYgbiA+IGkub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPiBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImF0dHJpYnV0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiBvLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG93TWFueTogbiAtIG8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudDogdGhpcy5fY2hhbmdlQ291bnQrK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVDaGFuZ2UodCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm5vZGVzVG9IYW5kbGUgPSBpLm9mZnNldCAtIHQub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuaG93TWFueSA9IHQubm9kZXNUb0hhbmRsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm9mZnNldCA+PSBpLm9mZnNldCAmJiB0Lm9mZnNldCA8IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA+IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ub2Rlc1RvSGFuZGxlID0gbiAtIG87XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2Zmc2V0ID0gb1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubm9kZXNUb0hhbmRsZSA9IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5vZmZzZXQgPCBpLm9mZnNldCAmJiBuID4gaS5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImF0dHJpYnV0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IGkub2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3dNYW55OiBuIC0gaS5vZmZzZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiB0aGlzLl9jaGFuZ2VDb3VudCsrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVDaGFuZ2UobywgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubm9kZXNUb0hhbmRsZSA9IGkub2Zmc2V0IC0gdC5vZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ob3dNYW55ID0gdC5ub2Rlc1RvSGFuZGxlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkudHlwZSA9PSBcImF0dHJpYnV0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5vZmZzZXQgPj0gaS5vZmZzZXQgJiYgbiA8PSBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ub2Rlc1RvSGFuZGxlID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lmhvd01hbnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2Zmc2V0ID0gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm9mZnNldCA8PSBpLm9mZnNldCAmJiBuID49IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmhvd01hbnkgPSAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0Lmhvd01hbnkgPSB0Lm5vZGVzVG9IYW5kbGU7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdC5ub2Rlc1RvSGFuZGxlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRJbnNlcnREaWZmKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJpbnNlcnRcIixcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogVWguX2NyZWF0ZUF0KHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUNvdW50OiB0aGlzLl9jaGFuZ2VDb3VudCsrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRSZW1vdmVEaWZmKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJyZW1vdmVcIixcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogVWguX2NyZWF0ZUF0KHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZUNvdW50OiB0aGlzLl9jaGFuZ2VDb3VudCsrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRBdHRyaWJ1dGVzRGlmZih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gW107XHJcbiAgICAgICAgICAgICAgICBpID0gbmV3IE1hcChpKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW28sIHJdIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaS5oYXMobykgPyBpLmdldChvKSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgIT09IHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYXR0cmlidXRlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdC5zdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlOiB0LmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVLZXk6IG8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVPbGRWYWx1ZTogcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU5ld1ZhbHVlOiBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ291bnQ6IHRoaXMuX2NoYW5nZUNvdW50KytcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaS5kZWxldGUobylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2UsIG9dIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImF0dHJpYnV0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdC5zdGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IHQuY2xvbmUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVLZXk6IGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZU9sZFZhbHVlOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVOZXdWYWx1ZTogbyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlQ291bnQ6IHRoaXMuX2NoYW5nZUNvdW50KytcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2lzSW5JbnNlcnRlZEVsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fY2hhbmdlc0luRWxlbWVudC5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5zdGFydE9mZnNldDtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcImluc2VydFwiICYmIG4gPj0gdC5vZmZzZXQgJiYgbiA8IHQub2Zmc2V0ICsgdC5ob3dNYW55KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzSW5JbnNlcnRlZEVsZW1lbnQoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZUFsbE5lc3RlZENoYW5nZXModCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyAkaChVaC5fY3JlYXRlQXQodCwgZSksIFVoLl9jcmVhdGVBdCh0LCBlICsgaSkpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4uZ2V0SXRlbXMoe3NoYWxsb3c6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmlzKFwiZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50U25hcHNob3RzLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hhbmdlc0luRWxlbWVudC5kZWxldGUodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZUFsbE5lc3RlZENoYW5nZXModCwgMCwgdC5tYXhPZmZzZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnbSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpLmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgaS5kYXRhLmxlbmd0aDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaCh7bmFtZTogXCIkdGV4dFwiLCBhdHRyaWJ1dGVzOiBuZXcgTWFwKGkuZ2V0QXR0cmlidXRlcygpKX0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnB1c2goe25hbWU6IGkubmFtZSwgYXR0cmlidXRlczogbmV3IE1hcChpLmdldEF0dHJpYnV0ZXMoKSl9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtbSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBbXTtcclxuICAgICAgICAgICAgbGV0IG4gPSAwO1xyXG4gICAgICAgICAgICBsZXQgbyA9IDA7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5vZmZzZXQgPiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0Lm9mZnNldCAtIG47IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2goXCJlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG8gKz0gdC5vZmZzZXQgLSBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC50eXBlID09IFwiaW5zZXJ0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHQuaG93TWFueTsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChcImlcIilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHQub2Zmc2V0ICsgdC5ob3dNYW55XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0Lmhvd01hbnk7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2goXCJyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0Lm9mZnNldDtcclxuICAgICAgICAgICAgICAgICAgICBvICs9IHQuaG93TWFueVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnB1c2goLi4uXCJhXCIucmVwZWF0KHQuaG93TWFueSkuc3BsaXQoXCJcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0Lm9mZnNldCArIHQuaG93TWFueTtcclxuICAgICAgICAgICAgICAgICAgICBvICs9IHQuaG93TWFueVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvIDwgdCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0IC0gbyAtIG47IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGkucHVzaChcImVcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcG0odCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5wb3NpdGlvbiAmJiB0LnBvc2l0aW9uLnJvb3Qucm9vdE5hbWUgPT0gXCIkZ3JhdmV5YXJkXCI7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJhbmdlICYmIHQucmFuZ2Uucm9vdC5yb290TmFtZSA9PSBcIiRncmF2ZXlhcmRcIjtcclxuICAgICAgICAgICAgcmV0dXJuICFlICYmICFpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBibSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BlcmF0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdW5kb1BhaXJzID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VuZG9uZU9wZXJhdGlvbnMgPSBuZXcgU2V0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZE9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb3BlcmF0aW9ucy5pbmNsdWRlcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BlcmF0aW9ucy5wdXNoKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldE9wZXJhdGlvbnModCA9IDAsIGUgPSBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0IDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29wZXJhdGlvbnMuc2xpY2UodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0T3BlcmF0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcGVyYXRpb25zW3RdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldE9wZXJhdGlvbkFzVW5kb25lKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VuZG9QYWlycy5zZXQoZSwgdCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91bmRvbmVPcGVyYXRpb25zLmFkZCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc1VuZG9pbmdPcGVyYXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuZG9QYWlycy5oYXModClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaXNVbmRvbmVPcGVyYXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VuZG9uZU9wZXJhdGlvbnMuaGFzKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFVuZG9uZU9wZXJhdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdW5kb1BhaXJzLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB3bSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhIXQgJiYgdC5sZW5ndGggPT0gMSAmJiAvW1xcdTAzMDAtXFx1MDM2ZlxcdTFhYjAtXFx1MWFmZlxcdTFkYzAtXFx1MWRmZlxcdTIwZDAtXFx1MjBmZlxcdWZlMjAtXFx1ZmUyZl0vLnRlc3QodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGttKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhdCAmJiB0Lmxlbmd0aCA9PSAxICYmIC9bXFx1ZDgwMC1cXHVkYmZmXS8udGVzdCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX20odCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISF0ICYmIHQubGVuZ3RoID09IDEgJiYgL1tcXHVkYzAwLVxcdWRmZmZdLy50ZXN0KHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB2bSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBrbSh0LmNoYXJBdChlIC0gMSkpICYmIF9tKHQuY2hhckF0KGUpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24geW0odCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gd20odC5jaGFyQXQoZSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCB4bSA9IFwiJGdyYXZleWFyZFwiO1xyXG5cclxuICAgICAgICBjbGFzcyBDbSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeSA9IG5ldyBibSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uID0gbmV3IGRmKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb290cyA9IG5ldyB5cyh7aWRQcm9wZXJ0eTogXCJyb290TmFtZVwifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpZmZlciA9IG5ldyBmbSh0Lm1hcmtlcnMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcG9zdEZpeGVycyA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9oYXNTZWxlY3Rpb25DaGFuZ2VkRnJvbVRoZUxhc3RDaGFuZ2VCbG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVSb290KFwiJHJvb3RcIiwgeG0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LCBcImFwcGx5T3BlcmF0aW9uXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGVbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuaXNEb2N1bWVudE9wZXJhdGlvbiAmJiBpLmJhc2VWZXJzaW9uICE9PSB0aGlzLnZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLWRvY3VtZW50LWFwcGx5T3BlcmF0aW9uLXdyb25nLXZlcnNpb246IE9ubHkgb3BlcmF0aW9ucyB3aXRoIG1hdGNoaW5nIHZlcnNpb25zIGNhbiBiZSBhcHBsaWVkLlwiLCB0aGlzLCB7b3BlcmF0aW9uOiBpfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaGVzdFwifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQsIFwiYXBwbHlPcGVyYXRpb25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZVswXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaS5pc0RvY3VtZW50T3BlcmF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlmZmVyLmJ1ZmZlck9wZXJhdGlvbihpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoXCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odCwgXCJhcHBseU9wZXJhdGlvblwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLmlzRG9jdW1lbnRPcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlzdG9yeS5hZGRPcGVyYXRpb24oaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5zZWxlY3Rpb24sIFwiY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNTZWxlY3Rpb25DaGFuZ2VkRnJvbVRoZUxhc3RDaGFuZ2VCbG9jayA9IHRydWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0Lm1hcmtlcnMsIFwidXBkYXRlXCIsICh0LCBlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWZmZXIuYnVmZmVyTWFya2VyQ2hhbmdlKGUubmFtZSwgaSwgbiwgZS5hZmZlY3RzRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5vbihcImNoYW5nZVwiLCAodCwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWZmZXIuYnVmZmVyTWFya2VyQ2hhbmdlKGUubmFtZSwgaSwgZS5nZXRSYW5nZSgpLCBlLmFmZmVjdHNEYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBncmF2ZXlhcmQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSb290KHhtKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSb290KHQgPSBcIiRyb290XCIsIGUgPSBcIm1haW5cIikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdHMuZ2V0KGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1vZGVsLWRvY3VtZW50LWNyZWF0ZVJvb3QtbmFtZS1leGlzdHM6IFJvb3Qgd2l0aCBzcGVjaWZpZWQgbmFtZSBhbHJlYWR5IGV4aXN0cy5cIiwgdGhpcywge25hbWU6IGV9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBzbSh0aGlzLCB0LCBlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdHMuYWRkKGkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFJvb3QodCA9IFwibWFpblwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yb290cy5nZXQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Um9vdE5hbWVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5yb290cywgdCA9PiB0LnJvb3ROYW1lKS5maWx0ZXIodCA9PiB0ICE9IHhtKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWdpc3RlclBvc3RGaXhlcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3N0Rml4ZXJzLmFkZCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0pTT04oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gQnModGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0LnNlbGVjdGlvbiA9IFwiW2VuZ2luZS5tb2RlbC5Eb2N1bWVudFNlbGVjdGlvbl1cIjtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwgPSBcIltlbmdpbmUubW9kZWwuTW9kZWxdXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGFuZGxlQ2hhbmdlQmxvY2sodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0RvY3VtZW50Q2hhbmdlZEZyb21UaGVMYXN0Q2hhbmdlQmxvY2soKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxQb3N0Rml4ZXJzKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9uLnJlZnJlc2goKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kaWZmZXIuaGFzRGF0YUNoYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6ZGF0YVwiLCB0LmJhdGNoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZVwiLCB0LmJhdGNoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbi5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWZmZXIucmVzZXQoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5faGFzU2VsZWN0aW9uQ2hhbmdlZEZyb21UaGVMYXN0Q2hhbmdlQmxvY2sgPSBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGFzRG9jdW1lbnRDaGFuZ2VkRnJvbVRoZUxhc3RDaGFuZ2VCbG9jaygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5kaWZmZXIuaXNFbXB0eSB8fCB0aGlzLl9oYXNTZWxlY3Rpb25DaGFuZ2VkRnJvbVRoZUxhc3RDaGFuZ2VCbG9ja1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0RGVmYXVsdFJvb3QoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5yb290cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICE9PSB0aGlzLmdyYXZleWFyZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdyYXZleWFyZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0RGVmYXVsdFJhbmdlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX2dldERlZmF1bHRSb290KCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmNyZWF0ZVBvc2l0aW9uRnJvbVBhdGgodCwgWzBdKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLmdldE5lYXJlc3RTZWxlY3Rpb25SYW5nZShuKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvIHx8IGUuY3JlYXRlUmFuZ2UobilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3ZhbGlkYXRlU2VsZWN0aW9uUmFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFtKHQuc3RhcnQpICYmIEFtKHQuZW5kKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2FsbFBvc3RGaXhlcnModCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdGhpcy5fcG9zdEZpeGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbi5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBpKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gd2hpbGUgKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKENtLCBkcyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEFtKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQudGV4dE5vZGU7XHJcbiAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQub2Zmc2V0IC0gZS5zdGFydE9mZnNldDtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhdm0oaSwgbikgJiYgIXltKGksIG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFRtIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJzID0gbmV3IE1hcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBbU3ltYm9sLml0ZXJhdG9yXSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXJrZXJzLnZhbHVlcygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWFya2Vycy5oYXModClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXJrZXJzLmdldCh0KSB8fCBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXQodCwgZSwgaSA9IGZhbHNlLCBuID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0IGluc3RhbmNlb2YgUG0gPyB0Lm5hbWUgOiB0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuX21hcmtlcnMuZ2V0KG8pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gci5nZXRSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0LmlzRXF1YWwoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgci5fYXR0YWNoTGl2ZVJhbmdlKHJmLmZyb21SYW5nZShlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9IHIubWFuYWdlZFVzaW5nT3BlcmF0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLl9tYW5hZ2VkVXNpbmdPcGVyYXRpb25zID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcyA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBuID09PSBcImJvb2xlYW5cIiAmJiBuICE9IHIuYWZmZWN0c0RhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgci5fYWZmZWN0c0RhdGEgPSBuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJ1cGRhdGU6XCIgKyBvLCByLCB0LCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gclxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHJmLmZyb21SYW5nZShlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBuZXcgUG0obywgcywgaSwgbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJzLnNldChvLCBhKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcInVwZGF0ZTpcIiArIG8sIGEsIG51bGwsIGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCBpbnN0YW5jZW9mIFBtID8gdC5uYW1lIDogdDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9tYXJrZXJzLmdldChlKTtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWFya2Vycy5kZWxldGUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwidXBkYXRlOlwiICsgZSwgaSwgaS5nZXRSYW5nZSgpLCBudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXN0cm95TWFya2VyKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlZnJlc2godCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQgaW5zdGFuY2VvZiBQbSA/IHQubmFtZSA6IHQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fbWFya2Vycy5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibWFya2VyY29sbGVjdGlvbi1yZWZyZXNoLW1hcmtlci1ub3QtZXhpc3RzOiBNYXJrZXIgd2l0aCBwcm92aWRlZCBuYW1lIGRvZXMgbm90IGV4aXN0cy5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmdldFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJ1cGRhdGU6XCIgKyBlLCBpLCBuLCBuLCBpLm1hbmFnZWRVc2luZ09wZXJhdGlvbnMsIGkuYWZmZWN0c0RhdGEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0TWFya2Vyc0F0UG9zaXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5nZXRSYW5nZSgpLmNvbnRhaW5zUG9zaXRpb24odCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKiBnZXRNYXJrZXJzSW50ZXJzZWN0aW5nUmFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5nZXRSYW5nZSgpLmdldEludGVyc2VjdGlvbih0KSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX21hcmtlcnMudmFsdWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZXN0cm95TWFya2VyKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYXJrZXJzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0TWFya2Vyc0dyb3VwKHQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9tYXJrZXJzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUubmFtZS5zdGFydHNXaXRoKHQgKyBcIjpcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2Rlc3Ryb3lNYXJrZXIodCkge1xyXG4gICAgICAgICAgICAgICAgdC5zdG9wTGlzdGVuaW5nKCk7XHJcbiAgICAgICAgICAgICAgICB0Ll9kZXRhY2hMaXZlUmFuZ2UoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhUbSwgZHMpO1xyXG5cclxuICAgICAgICBjbGFzcyBQbSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmFtZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saXZlUmFuZ2UgPSB0aGlzLl9hdHRhY2hMaXZlUmFuZ2UoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYW5hZ2VkVXNpbmdPcGVyYXRpb25zID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FmZmVjdHNEYXRhID0gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbWFuYWdlZFVzaW5nT3BlcmF0aW9ucygpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fbGl2ZVJhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIm1hcmtlci1kZXN0cm95ZWQ6IENhbm5vdCB1c2UgYSBkZXN0cm95ZWQgbWFya2VyIGluc3RhbmNlLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21hbmFnZWRVc2luZ09wZXJhdGlvbnNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGFmZmVjdHNEYXRhKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9saXZlUmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwibWFya2VyLWRlc3Ryb3llZDogQ2Fubm90IHVzZSBhIGRlc3Ryb3llZCBtYXJrZXIgaW5zdGFuY2UuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYWZmZWN0c0RhdGFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0U3RhcnQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xpdmVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtYXJrZXItZGVzdHJveWVkOiBDYW5ub3QgdXNlIGEgZGVzdHJveWVkIG1hcmtlciBpbnN0YW5jZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXZlUmFuZ2Uuc3RhcnQuY2xvbmUoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRFbmQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xpdmVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtYXJrZXItZGVzdHJveWVkOiBDYW5ub3QgdXNlIGEgZGVzdHJveWVkIG1hcmtlciBpbnN0YW5jZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXZlUmFuZ2UuZW5kLmNsb25lKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0UmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xpdmVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtYXJrZXItZGVzdHJveWVkOiBDYW5ub3QgdXNlIGEgZGVzdHJveWVkIG1hcmtlciBpbnN0YW5jZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXZlUmFuZ2UudG9SYW5nZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IFwibWFya2VyXCIgfHwgdCA9PSBcIm1vZGVsOm1hcmtlclwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hdHRhY2hMaXZlUmFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xpdmVSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RldGFjaExpdmVSYW5nZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0LmRlbGVnYXRlKFwiY2hhbmdlOnJhbmdlXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdC5kZWxlZ2F0ZShcImNoYW5nZTpjb250ZW50XCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGl2ZVJhbmdlID0gdDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9kZXRhY2hMaXZlUmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saXZlUmFuZ2Uuc3RvcERlbGVnYXRpbmcoXCJjaGFuZ2U6cmFuZ2VcIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saXZlUmFuZ2Uuc3RvcERlbGVnYXRpbmcoXCJjaGFuZ2U6Y29udGVudFwiLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpdmVSYW5nZS5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpdmVSYW5nZSA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoUG0sIGRzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgU20gZXh0ZW5kcyBMZyB7XHJcbiAgICAgICAgICAgIGdldCB0eXBlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibm9vcFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsb25lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTbSh0aGlzLmJhc2VWZXJzaW9uKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRSZXZlcnNlZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU20odGhpcy5iYXNlVmVyc2lvbiArIDEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9leGVjdXRlKCkge1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IGNsYXNzTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIk5vT3BlcmF0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgRW0gPSB7fTtcclxuICAgICAgICBFbVtRZy5jbGFzc05hbWVdID0gUWc7XHJcbiAgICAgICAgRW1bdG0uY2xhc3NOYW1lXSA9IHRtO1xyXG4gICAgICAgIEVtW2VtLmNsYXNzTmFtZV0gPSBlbTtcclxuICAgICAgICBFbVtaZy5jbGFzc05hbWVdID0gWmc7XHJcbiAgICAgICAgRW1bU20uY2xhc3NOYW1lXSA9IFNtO1xyXG4gICAgICAgIEVtW0xnLmNsYXNzTmFtZV0gPSBMZztcclxuICAgICAgICBFbVtpbS5jbGFzc05hbWVdID0gaW07XHJcbiAgICAgICAgRW1bbm0uY2xhc3NOYW1lXSA9IG5tO1xyXG4gICAgICAgIEVtW3JtLmNsYXNzTmFtZV0gPSBybTtcclxuICAgICAgICBFbVtvbS5jbGFzc05hbWVdID0gb207XHJcblxyXG4gICAgICAgIGNsYXNzIFJtIHtcclxuICAgICAgICAgICAgc3RhdGljIGZyb21KU09OKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBFbVt0Ll9fY2xhc3NOYW1lXS5mcm9tSlNPTih0LCBlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBPbSBleHRlbmRzIFVoIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSA9IFwidG9Ob25lXCIpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnJvb3QuaXMoXCJyb290RWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJtb2RlbC1saXZlcG9zaXRpb24tcm9vdC1ub3Qtcm9vdGVsZW1lbnQ6IExpdmVQb3NpdGlvbidzIHJvb3QgaGFzIHRvIGJlIGFuIGluc3RhbmNlIG9mIFJvb3RFbGVtZW50LlwiLCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgSW0uY2FsbCh0aGlzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXRhY2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PSBcImxpdmVQb3NpdGlvblwiIHx8IHQgPT0gXCJtb2RlbDpsaXZlUG9zaXRpb25cIiB8fCBzdXBlci5pcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b1Bvc2l0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaCh0aGlzLnJvb3QsIHRoaXMucGF0aC5zbGljZSgpLCB0aGlzLnN0aWNraW5lc3MpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBmcm9tUG9zaXRpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzKHQucm9vdCwgdC5wYXRoLnNsaWNlKCksIGUgPyBlIDogdC5zdGlja2luZXNzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBJbSgpIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLnJvb3QuZG9jdW1lbnQubW9kZWwsIFwiYXBwbHlPcGVyYXRpb25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpLmlzRG9jdW1lbnRPcGVyYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFZtLmNhbGwodGhpcywgaSlcclxuICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd1wifSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFZtKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZ2V0VHJhbnNmb3JtZWRCeU9wZXJhdGlvbih0KTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzRXF1YWwoZSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLnRvUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGF0aCA9IGUucGF0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdCA9IGUucm9vdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImNoYW5nZVwiLCB0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhPbSwgZHMpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBObSh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LmNoYW5nZShvID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCByO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IHQuZG9jdW1lbnQuc2VsZWN0aW9uXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkgaW5zdGFuY2VvZiBYaCB8fCBpIGluc3RhbmNlb2YgZGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gaVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gby5jcmVhdGVTZWxlY3Rpb24oaSwgbilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghci5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZGVsZXRlQ29udGVudChyLCB7ZG9Ob3RBdXRvcGFyYWdyYXBoOiB0cnVlfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgTW0odCwgbywgci5hbmNob3IpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGE7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5pcyhcImRvY3VtZW50RnJhZ21lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBhID0gZS5nZXRDaGlsZHJlbigpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGEgPSBbZV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHMuaGFuZGxlTm9kZXMoYSwge2lzRmlyc3Q6IHRydWUsIGlzTGFzdDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IHMuZ2V0U2VsZWN0aW9uUmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIGlmIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIgaW5zdGFuY2VvZiBkZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLnNldFNlbGVjdGlvbihjKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIuc2V0VG8oYylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IHMuZ2V0QWZmZWN0ZWRSYW5nZSgpIHx8IHQuY3JlYXRlUmFuZ2Uoci5hbmNob3IpO1xyXG4gICAgICAgICAgICAgICAgcy5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgTW0ge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMud3JpdGVyID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW5NZXJnZVdpdGggPSBuZXcgU2V0KFt0aGlzLnBvc2l0aW9uLnBhcmVudF0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWEgPSB0LnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpbHRlckF0dHJpYnV0ZXNPZiA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRTdGFydCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZmZlY3RlZEVuZCA9IG51bGxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFuZGxlTm9kZXModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdCA9IEFycmF5LmZyb20odCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdFtpXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVOb2RlKG4sIHtpc0ZpcnN0OiBpID09PSAwICYmIGUuaXNGaXJzdCwgaXNMYXN0OiBpID09PSB0Lmxlbmd0aCAtIDEgJiYgZS5pc0xhc3R9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWEucmVtb3ZlRGlzYWxsb3dlZEF0dHJpYnV0ZXModGhpcy5fZmlsdGVyQXR0cmlidXRlc09mLCB0aGlzLndyaXRlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maWx0ZXJBdHRyaWJ1dGVzT2YgPSBbXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRTZWxlY3Rpb25SYW5nZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5vZGVUb1NlbGVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkaC5fY3JlYXRlT24odGhpcy5ub2RlVG9TZWxlY3QpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RlbC5zY2hlbWEuZ2V0TmVhcmVzdFNlbGVjdGlvblJhbmdlKHRoaXMucG9zaXRpb24pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEFmZmVjdGVkUmFuZ2UoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2FmZmVjdGVkU3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyAkaCh0aGlzLl9hZmZlY3RlZFN0YXJ0LCB0aGlzLl9hZmZlY3RlZEVuZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hZmZlY3RlZFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRTdGFydC5kZXRhY2goKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FmZmVjdGVkRW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRFbmQuZGV0YWNoKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2hhbmRsZU5vZGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2NoZW1hLmlzT2JqZWN0KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlT2JqZWN0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2NoZWNrQW5kU3BsaXRUb0FsbG93ZWRQb3NpdGlvbih0LCBlKTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZURpc2FsbG93ZWROb2RlKHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5zZXJ0KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2VTaWJsaW5nc09mKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVPYmplY3QodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NoZWNrQW5kU3BsaXRUb0FsbG93ZWRQb3NpdGlvbih0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2luc2VydCh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90cnlBdXRvcGFyYWdyYXBoaW5nKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVEaXNhbGxvd2VkTm9kZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pcyhcImVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZU5vZGVzKHQuZ2V0Q2hpbGRyZW4oKSwgZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJ5QXV0b3BhcmFncmFwaGluZyh0LCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaW5zZXJ0KHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5zY2hlbWEuY2hlY2tDaGlsZCh0aGlzLnBvc2l0aW9uLCB0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJpbnNlcnRjb250ZW50LXdyb25nLXBvc2l0aW9uOiBHaXZlbiBub2RlIGNhbm5vdCBiZSBpbnNlcnRlZCBvbiB0aGUgZ2l2ZW4gcG9zaXRpb24uXCIsIHRoaXMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZTogdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHRoaXMucG9zaXRpb25cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IE9tLmZyb21Qb3NpdGlvbih0aGlzLnBvc2l0aW9uLCBcInRvTmV4dFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldEFmZmVjdGVkQm91bmRhcmllcyh0aGlzLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMud3JpdGVyLmluc2VydCh0LCB0aGlzLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSBlLnRvUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGUuZGV0YWNoKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zY2hlbWEuaXNPYmplY3QodCkgJiYgIXRoaXMuc2NoZW1hLmNoZWNrQ2hpbGQodGhpcy5wb3NpdGlvbiwgXCIkdGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZVRvU2VsZWN0ID0gdFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vZGVUb1NlbGVjdCA9IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpbHRlckF0dHJpYnV0ZXNPZi5wdXNoKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRBZmZlY3RlZEJvdW5kYXJpZXModCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9hZmZlY3RlZFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRTdGFydCA9IE9tLmZyb21Qb3NpdGlvbih0LCBcInRvUHJldmlvdXNcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fYWZmZWN0ZWRFbmQgfHwgdGhpcy5fYWZmZWN0ZWRFbmQuaXNCZWZvcmUodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWZmZWN0ZWRFbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRFbmQuZGV0YWNoKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRFbmQgPSBPbS5mcm9tUG9zaXRpb24odCwgXCJ0b05leHRcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21lcmdlU2libGluZ3NPZih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgamgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fY2FuTWVyZ2VMZWZ0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2Nhbk1lcmdlUmlnaHQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gT20uX2NyZWF0ZUJlZm9yZSh0KTtcclxuICAgICAgICAgICAgICAgIG8uc3RpY2tpbmVzcyA9IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gT20uX2NyZWF0ZUFmdGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgci5zdGlja2luZXNzID0gXCJ0b05leHRcIjtcclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IE9tLmZyb21Qb3NpdGlvbih0aGlzLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB0LnN0aWNraW5lc3MgPSBcInRvTmV4dFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hZmZlY3RlZFN0YXJ0LmlzRXF1YWwobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRTdGFydC5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRTdGFydCA9IE9tLl9jcmVhdGVBdChvLm5vZGVCZWZvcmUsIFwiZW5kXCIsIFwidG9QcmV2aW91c1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndyaXRlci5tZXJnZShvKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoby5pc0VxdWFsKHRoaXMuX2FmZmVjdGVkRW5kKSAmJiBlLmlzTGFzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZmZlY3RlZEVuZC5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRFbmQgPSBPbS5fY3JlYXRlQXQoby5ub2RlQmVmb3JlLCBcImVuZFwiLCBcInRvTmV4dFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdC50b1Bvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5kZXRhY2goKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucG9zaXRpb24uaXNFcXVhbChyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiaW5zZXJ0Y29udGVudC1pbnZhbGlkLWluc2VydGlvbi1wb3NpdGlvblwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gVWguX2NyZWF0ZUF0KHIubm9kZUJlZm9yZSwgXCJlbmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IE9tLmZyb21Qb3NpdGlvbih0aGlzLnBvc2l0aW9uLCBcInRvUHJldmlvdXNcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FmZmVjdGVkRW5kLmlzRXF1YWwocikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWZmZWN0ZWRFbmQuZGV0YWNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FmZmVjdGVkRW5kID0gT20uX2NyZWF0ZUF0KHIubm9kZUJlZm9yZSwgXCJlbmRcIiwgXCJ0b05leHRcIilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53cml0ZXIubWVyZ2Uocik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIuZ2V0U2hpZnRlZEJ5KC0xKS5pc0VxdWFsKHRoaXMuX2FmZmVjdGVkU3RhcnQpICYmIGUuaXNGaXJzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZmZlY3RlZFN0YXJ0LmRldGFjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZmZlY3RlZFN0YXJ0ID0gT20uX2NyZWF0ZUF0KHIubm9kZUJlZm9yZSwgMCwgXCJ0b1ByZXZpb3VzXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucG9zaXRpb24gPSB0LnRvUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICB0LmRldGFjaCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaSB8fCBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlsdGVyQXR0cmlidXRlc09mLnB1c2godGhpcy5wb3NpdGlvbi5wYXJlbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvLmRldGFjaCgpO1xyXG4gICAgICAgICAgICAgICAgci5kZXRhY2goKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2FuTWVyZ2VMZWZ0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnByZXZpb3VzU2libGluZztcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLmlzRmlyc3QgJiYgaSBpbnN0YW5jZW9mIGpoICYmIHRoaXMuY2FuTWVyZ2VXaXRoLmhhcyhpKSAmJiB0aGlzLm1vZGVsLnNjaGVtYS5jaGVja01lcmdlKGksIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jYW5NZXJnZVJpZ2h0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0Lm5leHRTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuaXNMYXN0ICYmIGkgaW5zdGFuY2VvZiBqaCAmJiB0aGlzLmNhbk1lcmdlV2l0aC5oYXMoaSkgJiYgdGhpcy5tb2RlbC5zY2hlbWEuY2hlY2tNZXJnZSh0LCBpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdHJ5QXV0b3BhcmFncmFwaGluZyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy53cml0ZXIuY3JlYXRlRWxlbWVudChcInBhcmFncmFwaFwiKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9nZXRBbGxvd2VkSW4oaSwgdGhpcy5wb3NpdGlvbi5wYXJlbnQpICYmIHRoaXMuc2NoZW1hLmNoZWNrQ2hpbGQoaSwgdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLl9hcHBlbmRDaGlsZCh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVOb2RlKGksIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jaGVja0FuZFNwbGl0VG9BbGxvd2VkUG9zaXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX2dldEFsbG93ZWRJbih0LCB0aGlzLnBvc2l0aW9uLnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdoaWxlIChlICE9IHRoaXMucG9zaXRpb24ucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2NoZW1hLmlzTGltaXQodGhpcy5wb3NpdGlvbi5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wb3NpdGlvbi5pc0F0U3RhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMucG9zaXRpb24ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdGhpcy53cml0ZXIuY3JlYXRlUG9zaXRpb25CZWZvcmUodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmlzRW1wdHkgJiYgdC5wYXJlbnQgPT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVyLnJlbW92ZSh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnBvc2l0aW9uLmlzQXRFbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbiA9IHRoaXMud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIodGhpcy5wb3NpdGlvbi5wYXJlbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIodGhpcy5wb3NpdGlvbi5wYXJlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRBZmZlY3RlZEJvdW5kYXJpZXModGhpcy5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud3JpdGVyLnNwbGl0KHRoaXMucG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uID0gdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5NZXJnZVdpdGguYWRkKHRoaXMucG9zaXRpb24ubm9kZUFmdGVyKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRBbGxvd2VkSW4odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2NoZW1hLmNoZWNrQ2hpbGQoZSwgdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldEFsbG93ZWRJbih0LCBlLnBhcmVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEJtKHQsIGUsIGkgPSB7fSkge1xyXG4gICAgICAgICAgICBpZiAoZS5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2V0Rmlyc3RSYW5nZSgpO1xyXG4gICAgICAgICAgICBpZiAobi5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBvID0gdC5zY2hlbWE7XHJcbiAgICAgICAgICAgIHQuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpLmRvTm90UmVzZXRFbnRpcmVDb250ZW50ICYmIEhtKG8sIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgam0odCwgZSwgbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbi5zdGFydDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBPbS5mcm9tUG9zaXRpb24obi5lbmQsIFwidG9OZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLnN0YXJ0LmlzVG91Y2hpbmcobi5lbmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5yZW1vdmUobilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghaS5sZWF2ZVVubWVyZ2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgem0odCwgciwgcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5yZW1vdmVEaXNhbGxvd2VkQXR0cmlidXRlcyhyLnBhcmVudC5nZXRDaGlsZHJlbigpLCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgV20odCwgZSwgcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuZG9Ob3RBdXRvcGFyYWdyYXBoICYmIExtKG8sIHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgRG0odCwgciwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHMuZGV0YWNoKClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHptKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaS5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGlmIChuID09IG8pIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0Lm1vZGVsLnNjaGVtYS5pc0xpbWl0KG4pIHx8IHQubW9kZWwuc2NoZW1hLmlzTGltaXQobykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghRm0oZSwgaSwgdC5tb2RlbC5zY2hlbWEpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlID0gdC5jcmVhdGVQb3NpdGlvbkFmdGVyKG4pO1xyXG4gICAgICAgICAgICBpID0gdC5jcmVhdGVQb3NpdGlvbkJlZm9yZShvKTtcclxuICAgICAgICAgICAgaWYgKCFpLmlzRXF1YWwoZSkpIHtcclxuICAgICAgICAgICAgICAgIHQuaW5zZXJ0KG8sIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5tZXJnZShlKTtcclxuICAgICAgICAgICAgd2hpbGUgKGkucGFyZW50LmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBpLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGkgPSB0LmNyZWF0ZVBvc2l0aW9uQmVmb3JlKGUpO1xyXG4gICAgICAgICAgICAgICAgdC5yZW1vdmUoZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB6bSh0LCBlLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTG0odCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5jaGVja0NoaWxkKGUsIFwiJHRleHRcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNoZWNrQ2hpbGQoZSwgXCJwYXJhZ3JhcGhcIik7XHJcbiAgICAgICAgICAgIHJldHVybiAhaSAmJiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBGbSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgJGgodCwgZSk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuLmdldFdhbGtlcigpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5pc0xpbWl0KHQuaXRlbSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRG0odCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5jcmVhdGVFbGVtZW50KFwicGFyYWdyYXBoXCIpO1xyXG4gICAgICAgICAgICB0Lmluc2VydChuLCBlKTtcclxuICAgICAgICAgICAgV20odCwgaSwgdC5jcmVhdGVQb3NpdGlvbkF0KG4sIDApKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gam0odCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5tb2RlbC5zY2hlbWEuZ2V0TGltaXRFbGVtZW50KGUpO1xyXG4gICAgICAgICAgICB0LnJlbW92ZSh0LmNyZWF0ZVJhbmdlSW4oaSkpO1xyXG4gICAgICAgICAgICBEbSh0LCB0LmNyZWF0ZVBvc2l0aW9uQXQoaSwgMCksIGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIbSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdldExpbWl0RWxlbWVudChlKTtcclxuICAgICAgICAgICAgaWYgKCFlLmNvbnRhaW5zRW50aXJlQ29udGVudChpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2V0Rmlyc3RSYW5nZSgpO1xyXG4gICAgICAgICAgICBpZiAobi5zdGFydC5wYXJlbnQgPT0gbi5lbmQucGFyZW50KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdC5jaGVja0NoaWxkKGksIFwicGFyYWdyYXBoXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBXbSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgZGYpIHtcclxuICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKGkpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBlLnNldFRvKGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHFtID0gJyAsLj8hOjtcIi0oKSc7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFVtKHQsIGUsIGkgPSB7fSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5zY2hlbWE7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBpLmRpcmVjdGlvbiAhPSBcImJhY2t3YXJkXCI7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBpLnVuaXQgPyBpLnVuaXQgOiBcImNoYXJhY3RlclwiO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gZS5mb2N1cztcclxuICAgICAgICAgICAgY29uc3QgYSA9IG5ldyBXaCh7Ym91bmRhcmllczogSm0ocywgbyksIHNpbmdsZUNoYXJhY3RlcnM6IHRydWUsIGRpcmVjdGlvbjogbyA/IFwiZm9yd2FyZFwiIDogXCJiYWNrd2FyZFwifSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSB7d2Fsa2VyOiBhLCBzY2hlbWE6IG4sIGlzRm9yd2FyZDogbywgdW5pdDogcn07XHJcbiAgICAgICAgICAgIGxldCBsO1xyXG4gICAgICAgICAgICB3aGlsZSAobCA9IGEubmV4dCgpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobC5kb25lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gJG0oYywgbC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgZGYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbkZvY3VzKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRGb2N1cyhpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gJG0odCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoZS50eXBlID09IFwidGV4dFwiKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC51bml0ID09PSBcIndvcmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBLbSh0LndhbGtlciwgdC5pc0ZvcndhcmQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gR20odC53YWxrZXIsIHQudW5pdCwgdC5pc0ZvcndhcmQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUudHlwZSA9PSAodC5pc0ZvcndhcmQgPyBcImVsZW1lbnRTdGFydFwiIDogXCJlbGVtZW50RW5kXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5zY2hlbWEuaXNPYmplY3QoZS5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBVaC5fY3JlYXRlQXQoZS5pdGVtLCB0LmlzRm9yd2FyZCA/IFwiYWZ0ZXJcIiA6IFwiYmVmb3JlXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5zY2hlbWEuY2hlY2tDaGlsZChlLm5leHRQb3NpdGlvbiwgXCIkdGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLm5leHRQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuc2NoZW1hLmlzTGltaXQoZS5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQud2Fsa2VyLnNraXAoKCkgPT4gdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5zY2hlbWEuY2hlY2tDaGlsZChlLm5leHRQb3NpdGlvbiwgXCIkdGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLm5leHRQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBHbSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnBvc2l0aW9uLnRleHROb2RlO1xyXG4gICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZGF0YTtcclxuICAgICAgICAgICAgICAgIGxldCBvID0gdC5wb3NpdGlvbi5vZmZzZXQgLSBpLnN0YXJ0T2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHZtKG4sIG8pIHx8IGUgPT0gXCJjaGFyYWN0ZXJcIiAmJiB5bShuLCBvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQubmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSB0LnBvc2l0aW9uLm9mZnNldCAtIGkuc3RhcnRPZmZzZXRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdC5wb3NpdGlvblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gS20odCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IHQucG9zaXRpb24udGV4dE5vZGU7XHJcbiAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbiA9IHQucG9zaXRpb24ub2Zmc2V0IC0gaS5zdGFydE9mZnNldDtcclxuICAgICAgICAgICAgICAgIHdoaWxlICghWW0oaS5kYXRhLCBuLCBlKSAmJiAhUW0oaSwgbiwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gZSA/IHQucG9zaXRpb24ubm9kZUFmdGVyIDogdC5wb3NpdGlvbi5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvICYmIG8uaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBvLmRhdGEuY2hhckF0KGUgPyAwIDogby5kYXRhLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXFtLmluY2x1ZGVzKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm5leHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0LnBvc2l0aW9uLnRleHROb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHQucG9zaXRpb24ub2Zmc2V0IC0gaS5zdGFydE9mZnNldFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0LnBvc2l0aW9uXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBKbSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnJvb3Q7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBVaC5fY3JlYXRlQXQoaSwgZSA/IFwiZW5kXCIgOiAwKTtcclxuICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgJGgodCwgbilcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgJGgobiwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWW0odCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZSArIChpID8gMCA6IC0xKTtcclxuICAgICAgICAgICAgcmV0dXJuIHFtLmluY2x1ZGVzKHQuY2hhckF0KG4pKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUW0odCwgZSwgaSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PT0gKGkgPyB0LmVuZE9mZnNldCA6IDApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBYbSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmdldEZpcnN0UmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIGlmICghbiB8fCBuLmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLnN0YXJ0LnJvb3Q7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbi5zdGFydC5nZXRDb21tb25QYXRoKG4uZW5kKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvLmdldE5vZGVCeVBhdGgocik7XHJcbiAgICAgICAgICAgICAgICBsZXQgYTtcclxuICAgICAgICAgICAgICAgIGlmIChuLnN0YXJ0LnBhcmVudCA9PSBuLmVuZC5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhID0gblxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhID0gdC5jcmVhdGVSYW5nZSh0LmNyZWF0ZVBvc2l0aW9uQXQocywgbi5zdGFydC5wYXRoW3IubGVuZ3RoXSksIHQuY3JlYXRlUG9zaXRpb25BdChzLCBuLmVuZC5wYXRoW3IubGVuZ3RoXSArIDEpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGEuZW5kLm9mZnNldCAtIGEuc3RhcnQub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGEuZ2V0SXRlbXMoe3NoYWxsb3c6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmlzKFwidGV4dFByb3h5XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuYXBwZW5kVGV4dChlLmRhdGEsIGUuZ2V0QXR0cmlidXRlcygpLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuYXBwZW5kKGUuX2Nsb25lKHRydWUpLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChhICE9IG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gbi5fZ2V0VHJhbnNmb3JtZWRCeU1vdmUoYS5zdGFydCwgdC5jcmVhdGVQb3NpdGlvbkF0KGksIDApLCBjKVswXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5jcmVhdGVSYW5nZSh0LmNyZWF0ZVBvc2l0aW9uQXQoaSwgMCksIGUuc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0LmNyZWF0ZVJhbmdlKGUuZW5kLCB0LmNyZWF0ZVBvc2l0aW9uQXQoaSwgXCJlbmRcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIFptKHIsIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIFptKG8sIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWm0odCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgIEFycmF5LmZyb20odC5nZXRJdGVtcyh7ZGlyZWN0aW9uOiBcImJhY2t3YXJkXCJ9KSkubWFwKHQgPT4gZS5jcmVhdGVSYW5nZU9uKHQpKS5maWx0ZXIoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gKGUuc3RhcnQuaXNBZnRlcih0LnN0YXJ0KSB8fCBlLnN0YXJ0LmlzRXF1YWwodC5zdGFydCkpICYmIChlLmVuZC5pc0JlZm9yZSh0LmVuZCkgfHwgZS5lbmQuaXNFcXVhbCh0LmVuZCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgfSkuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgIGkucHVzaCh0LnN0YXJ0LnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICBlLnJlbW92ZSh0KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaS5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSB0O1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKGkucGFyZW50ICYmIGkuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlLmNyZWF0ZVJhbmdlT24oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGUucmVtb3ZlKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0cCh0KSB7XHJcbiAgICAgICAgICAgIHQuZG9jdW1lbnQucmVnaXN0ZXJQb3N0Rml4ZXIoZSA9PiBlcChlLCB0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVwKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZS5zY2hlbWE7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcclxuICAgICAgICAgICAgbGV0IHIgPSBmYWxzZTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkuZ2V0UmFuZ2VzKCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBpcCh0LCBuKTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgby5wdXNoKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHIgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG8ucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbihhcChvKSwge2JhY2t3YXJkOiBpLmlzQmFja3dhcmR9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpcCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0LmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnAodCwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gb3AodCwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG5wKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuc3RhcnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmdldE5lYXJlc3RTZWxlY3Rpb25SYW5nZShpKTtcclxuICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghbi5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBvID0gbi5zdGFydDtcclxuICAgICAgICAgICAgaWYgKGkuaXNFcXVhbChvKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3ICRoKG8pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnN0YXJ0O1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5lbmQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBlLmNoZWNrQ2hpbGQoaSwgXCIkdGV4dFwiKTtcclxuICAgICAgICAgICAgY29uc3QgciA9IGUuY2hlY2tDaGlsZChuLCBcIiR0ZXh0XCIpO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gZS5nZXRMaW1pdEVsZW1lbnQoaSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGEgPSBlLmdldExpbWl0RWxlbWVudChuKTtcclxuICAgICAgICAgICAgaWYgKHMgPT09IGEpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvICYmIHIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHNwKGksIG4sIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkubm9kZUFmdGVyICYmIGUuaXNPYmplY3QoaS5ub2RlQWZ0ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0ID8gbnVsbCA6IGUuZ2V0TmVhcmVzdFNlbGVjdGlvblJhbmdlKGksIFwiZm9yd2FyZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbi5ub2RlQmVmb3JlICYmIGUuaXNPYmplY3Qobi5ub2RlQmVmb3JlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gciA/IG51bGwgOiBlLmdldE5lYXJlc3RTZWxlY3Rpb25SYW5nZShuLCBcImJhY2t3YXJkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBvID8gby5zdGFydCA6IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IHMgPyBzLnN0YXJ0IDogbjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKGEsIGMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgYyA9IHMgJiYgIXMuaXMoXCJyb290RWxlbWVudFwiKTtcclxuICAgICAgICAgICAgY29uc3QgbCA9IGEgJiYgIWEuaXMoXCJyb290RWxlbWVudFwiKTtcclxuICAgICAgICAgICAgaWYgKGMgfHwgbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGkubm9kZUFmdGVyICYmIG4ubm9kZUJlZm9yZSAmJiBpLm5vZGVBZnRlci5wYXJlbnQgPT09IG4ubm9kZUJlZm9yZS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gYyAmJiAoIXQgfHwgIWNwKGkubm9kZUFmdGVyLCBlKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbCAmJiAoIXQgfHwgIWNwKG4ubm9kZUJlZm9yZSwgZSkpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGQgPSBpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHUgPSBuO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBkID0gVWguX2NyZWF0ZUJlZm9yZShycChzLCBlKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdSA9IFVoLl9jcmVhdGVBZnRlcihycChhLCBlKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgJGgoZCwgdSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcnAodCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IHQ7XHJcbiAgICAgICAgICAgIGxldCBuID0gaTtcclxuICAgICAgICAgICAgd2hpbGUgKGUuaXNMaW1pdChuKSAmJiBuLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgaSA9IG47XHJcbiAgICAgICAgICAgICAgICBuID0gbi5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3AodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5ub2RlQWZ0ZXIgJiYgIWkuaXNMaW1pdCh0Lm5vZGVBZnRlcikgfHwgaS5jaGVja0NoaWxkKHQsIFwiJHRleHRcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBlLm5vZGVCZWZvcmUgJiYgIWkuaXNMaW1pdChlLm5vZGVCZWZvcmUpIHx8IGkuY2hlY2tDaGlsZChlLCBcIiR0ZXh0XCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gbiB8fCBvXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhcCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgZS5wdXNoKHQuc2hpZnQoKSk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5wb3AoKTtcclxuICAgICAgICAgICAgICAgIGlmIChpLmlzSW50ZXJzZWN0aW5nKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuc3RhcnQuaXNBZnRlcihpLnN0YXJ0KSA/IGkuc3RhcnQgOiB0LnN0YXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0LmVuZC5pc0FmdGVyKGkuZW5kKSA/IHQuZW5kIDogaS5lbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyAkaChuLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnB1c2gocilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHVzaChpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjcCh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ICYmIGUuaXNPYmplY3QodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGxwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtlcnMgPSBuZXcgVG07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50ID0gbmV3IENtKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWEgPSBuZXcgdWc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nQ2hhbmdlcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFdyaXRlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBbXCJpbnNlcnRDb250ZW50XCIsIFwiZGVsZXRlQ29udGVudFwiLCBcIm1vZGlmeVNlbGVjdGlvblwiLCBcImdldFNlbGVjdGVkQ29udGVudFwiLCBcImFwcGx5T3BlcmF0aW9uXCJdLmZvckVhY2godCA9PiB0aGlzLmRlY29yYXRlKHQpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJhcHBseU9wZXJhdGlvblwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuX3ZhbGlkYXRlKClcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1hLnJlZ2lzdGVyKFwiJHJvb3RcIiwge2lzTGltaXQ6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1hLnJlZ2lzdGVyKFwiJGJsb2NrXCIsIHthbGxvd0luOiBcIiRyb290XCIsIGlzQmxvY2s6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1hLnJlZ2lzdGVyKFwiJHRleHRcIiwge2FsbG93SW46IFwiJGJsb2NrXCIsIGlzSW5saW5lOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVtYS5yZWdpc3RlcihcIiRjbGlwYm9hcmRIb2xkZXJcIiwge2FsbG93Q29udGVudE9mOiBcIiRyb290XCIsIGlzTGltaXQ6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0luOiBcIiRjbGlwYm9hcmRIb2xkZXJcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWEucmVnaXN0ZXIoXCIkbWFya2VyXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlbWEuYWRkQ2hpbGRDaGVjaygodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLm5hbWUgPT09IFwiJG1hcmtlclwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0cCh0aGlzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ0NoYW5nZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdDaGFuZ2VzLnB1c2goe2JhdGNoOiBuZXcgemcsIGNhbGxiYWNrOiB0fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9ydW5QZW5kaW5nQ2hhbmdlcygpWzBdXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQodGhpcy5fY3VycmVudFdyaXRlcilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3NbXCJiXCJdLnJldGhyb3dVbmV4cGVjdGVkRXJyb3IodCwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZW5xdWV1ZUNoYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gbmV3IHpnKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdCA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBuZXcgemdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ0NoYW5nZXMucHVzaCh7YmF0Y2g6IHQsIGNhbGxiYWNrOiBlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdDaGFuZ2VzLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3J1blBlbmRpbmdDaGFuZ2VzKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3NbXCJiXCJdLnJldGhyb3dVbmV4cGVjdGVkRXJyb3IodCwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXBwbHlPcGVyYXRpb24odCkge1xyXG4gICAgICAgICAgICAgICAgdC5fZXhlY3V0ZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluc2VydENvbnRlbnQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE5tKHRoaXMsIHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlbGV0ZUNvbnRlbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgQm0odGhpcywgdCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbW9kaWZ5U2VsZWN0aW9uKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIFVtKHRoaXMsIHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFNlbGVjdGVkQ29udGVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWG0odGhpcywgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFzQ29udGVudCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdCBpbnN0YW5jZW9mIGpoID8gJGguX2NyZWF0ZUluKHQpIDogdDtcclxuICAgICAgICAgICAgICAgIGlmIChpLmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5tYXJrZXJzLmdldE1hcmtlcnNJbnRlcnNlY3RpbmdSYW5nZShpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmFmZmVjdHNEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3Qge2lnbm9yZVdoaXRlc3BhY2VzOiBuID0gZmFsc2V9ID0gZSB8fCB7fTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpLmdldEl0ZW1zKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5pcyhcInRleHRQcm94eVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC5kYXRhLnNlYXJjaCgvXFxTLykgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNjaGVtYS5pc09iamVjdCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkZyb21QYXRoKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWgodCwgZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUG9zaXRpb25BdCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVWguX2NyZWF0ZUF0KHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVBvc2l0aW9uQWZ0ZXIodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFVoLl9jcmVhdGVBZnRlcih0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkJlZm9yZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVWguX2NyZWF0ZUJlZm9yZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSYW5nZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3ICRoKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVJhbmdlSW4odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRoLl9jcmVhdGVJbih0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVSYW5nZU9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkaC5fY3JlYXRlT24odClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlU2VsZWN0aW9uKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgWGgodCwgZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlQmF0Y2godCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB6Zyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVPcGVyYXRpb25Gcm9tSlNPTih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUm0uZnJvbUpTT04odCwgdGhpcy5kb2N1bWVudClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3J1blBlbmRpbmdDaGFuZ2VzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiX2JlZm9yZUNoYW5nZXNcIik7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5fcGVuZGluZ0NoYW5nZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3BlbmRpbmdDaGFuZ2VzWzBdLmJhdGNoO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRXcml0ZXIgPSBuZXcgYW0odGhpcywgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3BlbmRpbmdDaGFuZ2VzWzBdLmNhbGxiYWNrKHRoaXMuX2N1cnJlbnRXcml0ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQucHVzaChpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50Ll9oYW5kbGVDaGFuZ2VCbG9jayh0aGlzLl9jdXJyZW50V3JpdGVyKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nQ2hhbmdlcy5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRXcml0ZXIgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJfYWZ0ZXJDaGFuZ2VzXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMobHAsIEpjKTtcclxuXHJcbiAgICAgICAgY2xhc3MgZHAge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVyID0gT2JqZWN0LmNyZWF0ZShxZClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGlzdGVuVG8odCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGlzdGVuZXIubGlzdGVuVG8odCwgXCJrZXlkb3duXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGlzdGVuZXIuZmlyZShcIl9rZXlkb3duOlwiICsgTWwoZSksIGUpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXQodCwgZSwgaSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gQmwodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5wcmlvcml0eTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVyLmxpc3RlblRvKHRoaXMuX2xpc3RlbmVyLCBcIl9rZXlkb3duOlwiICsgbiwgKHQsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlKGksICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHQucmV0dXJuID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBvfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcHJlc3ModCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5fbGlzdGVuZXIuZmlyZShcIl9rZXlkb3duOlwiICsgTWwodCksIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9saXN0ZW5lci5zdG9wTGlzdGVuaW5nKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdXAgZXh0ZW5kcyBkcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvciA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0KHQsIGUsIGkgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBlID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZTtcclxuICAgICAgICAgICAgICAgICAgICBlID0gKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZXhlY3V0ZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3VwZXIuc2V0KHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGhwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0ID0gdC5jb250ZXh0IHx8IG5ldyBJcyh7bGFuZ3VhZ2U6IHQubGFuZ3VhZ2V9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuX2FkZEVkaXRvcih0aGlzLCAhdC5jb250ZXh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBBcnJheS5mcm9tKHRoaXMuY29uc3RydWN0b3IuYnVpbHRpblBsdWdpbnMgfHwgW10pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcgPSBuZXcgSnIodCwgdGhpcy5jb25zdHJ1Y3Rvci5kZWZhdWx0Q29uZmlnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLmRlZmluZShcInBsdWdpbnNcIiwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5kZWZpbmUodGhpcy5fY29udGV4dC5fZ2V0RWRpdG9yQ29uZmlnKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW5zID0gbmV3IHhzKHRoaXMsIGUsIHRoaXMuX2NvbnRleHQucGx1Z2lucyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2FsZSA9IHRoaXMuX2NvbnRleHQubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50ID0gdGhpcy5sb2NhbGUudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZHMgPSBuZXcgY2c7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInN0YXRlXCIsIFwiaW5pdGlhbGl6aW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwicmVhZHlcIiwgKCkgPT4gdGhpcy5zdGF0ZSA9IFwicmVhZHlcIiwge3ByaW9yaXR5OiBcImhpZ2hcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbmNlKFwiZGVzdHJveVwiLCAoKSA9PiB0aGlzLnN0YXRlID0gXCJkZXN0cm95ZWRcIiwge3ByaW9yaXR5OiBcImhpZ2hcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc1JlYWRPbmx5XCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwgPSBuZXcgbHA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IFZjO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gbmV3IElnKHRoaXMubW9kZWwsIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0aW5nID0gbmV3IGFnKHRoaXMubW9kZWwsIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0aW5nLnZpZXcuZG9jdW1lbnQuYmluZChcImlzUmVhZE9ubHlcIikudG8odGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb24gPSBuZXcgTmcoW3RoaXMuZWRpdGluZy5kb3duY2FzdERpc3BhdGNoZXIsIHRoaXMuZGF0YS5kb3duY2FzdERpc3BhdGNoZXJdLCB0aGlzLmRhdGEudXBjYXN0RGlzcGF0Y2hlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb24uYWRkQWxpYXMoXCJkYXRhRG93bmNhc3RcIiwgdGhpcy5kYXRhLmRvd25jYXN0RGlzcGF0Y2hlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnZlcnNpb24uYWRkQWxpYXMoXCJlZGl0aW5nRG93bmNhc3RcIiwgdGhpcy5lZGl0aW5nLmRvd25jYXN0RGlzcGF0Y2hlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMgPSBuZXcgdXAodGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lZGl0aW5nLnZpZXcuZG9jdW1lbnQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXRQbHVnaW5zKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuY29uZmlnO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0KFwicGx1Z2luc1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdldChcInJlbW92ZVBsdWdpbnNcIikgfHwgW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5nZXQoXCJleHRyYVBsdWdpbnNcIikgfHwgW107XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wbHVnaW5zLmluaXQoZS5jb25jYXQobiksIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT0gXCJpbml0aWFsaXppbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSBuZXcgUHJvbWlzZSh0ID0+IHRoaXMub25jZShcInJlYWR5XCIsIHQpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiZGVzdHJveVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLmRlc3Ryb3koKVxyXG4gICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB0aGlzLnBsdWdpbnMuZGVzdHJveSgpKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdGluZy5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzLmRlc3Ryb3koKVxyXG4gICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB0aGlzLl9jb250ZXh0Ll9yZW1vdmVFZGl0b3IodGhpcykpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUoLi4udCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbW1hbmRzLmV4ZWN1dGUoLi4udClcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzc1tcImJcIl0ucmV0aHJvd1VuZXhwZWN0ZWRFcnJvcih0LCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhocCwgSmMpO1xyXG5cclxuICAgICAgICBjbGFzcyBmcCB7XHJcbiAgICAgICAgICAgIGdldEh0bWwodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudChcIlwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICAgICAgICBpLmFwcGVuZENoaWxkKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkuaW5uZXJIVE1MXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9tUGFyc2VyID0gbmV3IERPTVBhcnNlcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RvbUNvbnZlcnRlciA9IG5ldyB6ZCh0LCB7YmxvY2tGaWxsZXJNb2RlOiBcIm5ic3BcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faHRtbFdyaXRlciA9IG5ldyBmcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b0RhdGEodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX2RvbUNvbnZlcnRlci52aWV3VG9Eb20odCwgZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2h0bWxXcml0ZXIuZ2V0SHRtbChlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0b1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3RvRG9tKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RvbUNvbnZlcnRlci5kb21Ub1ZpZXcoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3RvRG9tKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9kb21QYXJzZXIucGFyc2VGcm9tU3RyaW5nKHQsIFwidGV4dC9odG1sXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuYm9keS5jaGlsZE5vZGVzO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYXBwZW5kQ2hpbGQoblswXSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIG1wIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0VuYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhY2sgPSBuZXcgU2V0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvcmNlRGlzYWJsZWQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YWNrLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXNhYmxlU3RhY2suc2l6ZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbihcInNldDppc0VuYWJsZWRcIiwgcHAsIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsZWFyRm9yY2VEaXNhYmxlZCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhY2suZGVsZXRlKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rpc2FibGVTdGFjay5zaXplID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZihcInNldDppc0VuYWJsZWRcIiwgcHApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBpc0NvbnRleHRQbHVnaW4oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMobXAsIEpjKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcHAodCkge1xyXG4gICAgICAgICAgICB0LnJldHVybiA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0LnN0b3AoKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgYnAgZXh0ZW5kcyB5cyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHtpZFByb3BlcnR5OiBcInZpZXdVaWRcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImFkZFwiLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5pc1JlbmRlcmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucmVuZGVyKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuZWxlbWVudCAmJiB0aGlzLl9wYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGUuZWxlbWVudCwgdGhpcy5fcGFyZW50RWxlbWVudC5jaGlsZHJlbltpXSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJyZW1vdmVcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5lbGVtZW50ICYmIHRoaXMuX3BhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5lbGVtZW50LnJlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2FsZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXJlbnRFbGVtZW50ID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXAodCA9PiB0LmRlc3Ryb3koKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0UGFyZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BhcmVudEVsZW1lbnQgPSB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlbGVnYXRlKC4uLnQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdC5sZW5ndGggfHwgIXdwKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInVpLXZpZXdjb2xsZWN0aW9uLWRlbGVnYXRlLXdyb25nLWV2ZW50czogQWxsIGV2ZW50IG5hbWVzIG11c3QgYmUgc3RyaW5ncy5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG86IGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdGhpcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmRlbGVnYXRlKG4pLnRvKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbihcImFkZFwiLCAoaSwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmRlbGVnYXRlKGkpLnRvKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uKFwicmVtb3ZlXCIsIChpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc3RvcERlbGVnYXRpbmcoaSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHdwKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuZXZlcnkodCA9PiB0eXBlb2YgdCA9PSBcInN0cmluZ1wiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qga3AgPSBcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIjtcclxuXHJcbiAgICAgICAgY2xhc3MgX3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIE9wKFJwKHQpKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1JlbmRlcmVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXZlcnREYXRhID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fcmVuZGVyTm9kZSh7aW50b0ZyYWdtZW50OiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1JlbmRlcmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFwcGx5KHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JldmVydERhdGEgPSBxcCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyTm9kZSh7bm9kZTogdCwgaXNBcHBseWluZzogdHJ1ZSwgcmV2ZXJ0RGF0YTogdGhpcy5fcmV2ZXJ0RGF0YX0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV2ZXJ0KHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcmV2ZXJ0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJ1aS10ZW1wbGF0ZS1yZXZlcnQtbm90LWFwcGxpZWQ6IEF0dGVtcHRpbmcgdG8gcmV2ZXJ0IGEgdGVtcGxhdGUgd2hpY2ggaGFzIG5vdCBiZWVuIGFwcGxpZWQgeWV0LlwiLCBbdGhpcywgdF0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXZlcnRUZW1wbGF0ZUZyb21Ob2RlKHQsIHRoaXMuX3JldmVydERhdGEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogZ2V0Vmlld3MoKSB7XHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiogdChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqcChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIGlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoSHAoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCogdChpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHlpZWxkKiB0KHRoaXMpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBiaW5kKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG8oaSwgbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHlwKHtldmVudE5hbWVPckZ1bmN0aW9uOiBpLCBhdHRyaWJ1dGU6IGksIG9ic2VydmFibGU6IHQsIGVtaXR0ZXI6IGUsIGNhbGxiYWNrOiBufSlcclxuICAgICAgICAgICAgICAgICAgICB9LCBpZihpLCBuLCBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgeHAoe29ic2VydmFibGU6IHQsIGVtaXR0ZXI6IGUsIGF0dHJpYnV0ZTogaSwgdmFsdWVJZlRydWU6IG4sIGNhbGxiYWNrOiBvfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBleHRlbmQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuX2lzUmVuZGVyZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidGVtcGxhdGUtZXh0ZW5kLXJlbmRlcjogQXR0ZW1wdGluZyB0byBleHRlbmQgYSB0ZW1wbGF0ZSB3aGljaCBoYXMgYWxyZWFkeSBiZWVuIHJlbmRlcmVkLlwiLCBbdGhpcywgdF0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBGcCh0LCBPcChScChlKSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW5kZXJOb2RlKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQubm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLnRhZyAmJiB0aGlzLnRleHRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMudGFnID8gdGhpcy50ZXh0IDogIXRoaXMudGV4dFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKCd1aS10ZW1wbGF0ZS13cm9uZy1zeW50YXg6IE5vZGUgZGVmaW5pdGlvbiBtdXN0IGhhdmUgZWl0aGVyIFwidGFnXCIgb3IgXCJ0ZXh0XCIgd2hlbiByZW5kZXJpbmcgYSBuZXcgTm9kZS4nLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJUZXh0KHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJFbGVtZW50KHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW5kZXJFbGVtZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gdC5ub2RlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQubm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyh0aGlzLm5zIHx8IGtwLCB0aGlzLnRhZylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlckF0dHJpYnV0ZXModCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJFbGVtZW50Q2hpbGRyZW4odCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXRVcExpc3RlbmVycyh0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW5kZXJUZXh0KHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gdC5ub2RlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJldmVydERhdGEudGV4dCA9IGUudGV4dENvbnRlbnRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQubm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXCIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoQ3AodGhpcy50ZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb09ic2VydmFibGUoe3NjaGVtYTogdGhpcy50ZXh0LCB1cGRhdGVyOiBQcChlKSwgZGF0YTogdH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUudGV4dENvbnRlbnQgPSB0aGlzLnRleHQuam9pbihcIlwiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbmRlckF0dHJpYnV0ZXModCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGUsIGksIG4sIG87XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHQubm9kZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0LnJldmVydERhdGE7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGUgaW4gdGhpcy5hdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHIuZ2V0QXR0cmlidXRlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLmF0dHJpYnV0ZXNbZV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcy5hdHRyaWJ1dGVzW2VdID0gblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBvID0gY3QoaVswXSkgJiYgaVswXS5ucyA/IGlbMF0ubnMgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChDcChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gbyA/IGlbMF0udmFsdWUgOiBpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocyAmJiBVcChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS51bnNoaWZ0KG4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmluZFRvT2JzZXJ2YWJsZSh7c2NoZW1hOiBhLCB1cGRhdGVyOiBTcChyLCBlLCBvKSwgZGF0YTogdH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlID09IFwic3R5bGVcIiAmJiB0eXBlb2YgaVswXSAhPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW5kZXJTdHlsZUF0dHJpYnV0ZShpWzBdLCB0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzICYmIG4gJiYgVXAoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkudW5zaGlmdChuKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBpLm1hcCh0ID0+IHQgPyB0LnZhbHVlIHx8IHQgOiB0KS5yZWR1Y2UoKHQsIGUpID0+IHQuY29uY2F0KGUpLCBbXSkucmVkdWNlKHpwLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFEcChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zZXRBdHRyaWJ1dGVOUyhvLCBlLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVuZGVyU3R5bGVBdHRyaWJ1dGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUubm9kZTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBpbiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHRbbl07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKENwKG8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRUb09ic2VydmFibGUoe3NjaGVtYTogW29dLCB1cGRhdGVyOiBFcChpLCBuKSwgZGF0YTogZX0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zdHlsZVtuXSA9IG9cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW5kZXJFbGVtZW50Q2hpbGRyZW4odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubm9kZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmludG9GcmFnbWVudCA/IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSA6IGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5pc0FwcGx5aW5nO1xyXG4gICAgICAgICAgICAgICAgbGV0IG8gPSAwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIHRoaXMuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoV3AocikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnNldFBhcmVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5hcHBlbmRDaGlsZCh0LmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGpwKHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyLmlzUmVuZGVyZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnJlbmRlcigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFwcGVuZENoaWxkKHIuZWxlbWVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoeGQocikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5hcHBlbmRDaGlsZChyKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5yZXZlcnREYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHFwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmNoaWxkcmVuLnB1c2gobik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLl9yZW5kZXJOb2RlKHtub2RlOiBpLmNoaWxkTm9kZXNbbysrXSwgaXNBcHBseWluZzogdHJ1ZSwgcmV2ZXJ0RGF0YTogbn0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFwcGVuZENoaWxkKHIucmVuZGVyKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pbnRvRnJhZ21lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmFwcGVuZENoaWxkKGkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRVcExpc3RlbmVycyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZXZlbnRMaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBpbiB0aGlzLmV2ZW50TGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZXZlbnRMaXN0ZW5lcnNbZV0ubWFwKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbbiwgb10gPSBlLnNwbGl0KFwiQFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGkuYWN0aXZhdGVEb21FdmVudExpc3RlbmVyKG4sIG8sIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQucmV2ZXJ0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnJldmVydERhdGEuYmluZGluZ3MucHVzaChpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2JpbmRUb09ic2VydmFibGUoe3NjaGVtYTogdCwgdXBkYXRlcjogZSwgZGF0YTogaX0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLnJldmVydERhdGE7XHJcbiAgICAgICAgICAgICAgICBUcCh0LCBlLCBpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0LmZpbHRlcih0ID0+ICFEcCh0KSkuZmlsdGVyKHQgPT4gdC5vYnNlcnZhYmxlKS5tYXAobiA9PiBuLmFjdGl2YXRlQXR0cmlidXRlTGlzdGVuZXIodCwgZSwgaSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBuLmJpbmRpbmdzLnB1c2gobylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JldmVydFRlbXBsYXRlRnJvbU5vZGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUuYmluZGluZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZS50ZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC50ZXh0Q29udGVudCA9IGUudGV4dDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBpbiBlLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5hdHRyaWJ1dGVzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoaSwgbilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGUuY2hpbGRyZW4ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXZlcnRUZW1wbGF0ZUZyb21Ob2RlKHQuY2hpbGROb2Rlc1tpXSwgZS5jaGlsZHJlbltpXSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoX3AsIGRzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgdnAge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFZhbHVlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLm9ic2VydmFibGVbdGhpcy5hdHRyaWJ1dGVdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FsbGJhY2sgPyB0aGlzLmNhbGxiYWNrKGUsIHQpIDogZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhY3RpdmF0ZUF0dHJpYnV0ZUxpc3RlbmVyKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSAoKSA9PiBUcCh0LCBlLCBpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW1pdHRlci5saXN0ZW5Ubyh0aGlzLm9ic2VydmFibGUsIFwiY2hhbmdlOlwiICsgdGhpcy5hdHRyaWJ1dGUsIG4pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXR0ZXIuc3RvcExpc3RlbmluZyh0aGlzLm9ic2VydmFibGUsIFwiY2hhbmdlOlwiICsgdGhpcy5hdHRyaWJ1dGUsIG4pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHlwIGV4dGVuZHMgdnAge1xyXG4gICAgICAgICAgICBhY3RpdmF0ZURvbUV2ZW50TGlzdGVuZXIodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9ICh0LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlIHx8IGkudGFyZ2V0Lm1hdGNoZXMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmV2ZW50TmFtZU9yRnVuY3Rpb24gPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50TmFtZU9yRnVuY3Rpb24oaSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2JzZXJ2YWJsZS5maXJlKHRoaXMuZXZlbnROYW1lT3JGdW5jdGlvbiwgaSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVtaXR0ZXIubGlzdGVuVG8oaS5ub2RlLCB0LCBuKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0dGVyLnN0b3BMaXN0ZW5pbmcoaS5ub2RlLCB0LCBuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB4cCBleHRlbmRzIHZwIHtcclxuICAgICAgICAgICAgZ2V0VmFsdWUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHN1cGVyLmdldFZhbHVlKHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERwKGUpID8gZmFsc2UgOiB0aGlzLnZhbHVlSWZUcnVlIHx8IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ3AodCkge1xyXG4gICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gdC52YWx1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5zb21lKENwKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQgaW5zdGFuY2VvZiB2cCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEFwKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQubWFwKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiB2cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmdldFZhbHVlKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVHAodCwgZSwge25vZGU6IGl9KSB7XHJcbiAgICAgICAgICAgIGxldCBuID0gQXAodCwgaSk7XHJcbiAgICAgICAgICAgIGlmICh0Lmxlbmd0aCA9PSAxICYmIHRbMF0gaW5zdGFuY2VvZiB4cCkge1xyXG4gICAgICAgICAgICAgICAgbiA9IG5bMF1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG4gPSBuLnJlZHVjZSh6cCwgXCJcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoRHAobikpIHtcclxuICAgICAgICAgICAgICAgIGUucmVtb3ZlKClcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGUuc2V0KG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFBwKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHNldChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC50ZXh0Q29udGVudCA9IGVcclxuICAgICAgICAgICAgICAgIH0sIHJlbW92ZSgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnRleHRDb250ZW50ID0gXCJcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBTcCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBzZXQobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlTlMoaSwgZSwgbilcclxuICAgICAgICAgICAgICAgIH0sIHJlbW92ZSgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZU5TKGksIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEVwKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHNldChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zdHlsZVtlXSA9IGlcclxuICAgICAgICAgICAgICAgIH0sIHJlbW92ZSgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnN0eWxlW2VdID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBScCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSAkcih0LCB0ID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0ICYmICh0IGluc3RhbmNlb2YgdnAgfHwgSHAodCkgfHwganAodCkgfHwgV3AodCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBPcCh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gTnAodClcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0LnRleHQpIHtcclxuICAgICAgICAgICAgICAgIE1wKHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQub24pIHtcclxuICAgICAgICAgICAgICAgIHQuZXZlbnRMaXN0ZW5lcnMgPSBWcCh0Lm9uKTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0Lm9uXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0LnRleHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBJcCh0LmF0dHJpYnV0ZXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAodC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChXcCh0LmNoaWxkcmVuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnB1c2godC5jaGlsZHJlbilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdC5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEhwKGkpIHx8IGpwKGkpIHx8IHhkKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHVzaChuZXcgX3AoaSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0LmNoaWxkcmVuID0gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBJcCh0KSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBpbiB0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodFtlXS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbZV0udmFsdWUgPSBbXS5jb25jYXQodFtlXS52YWx1ZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIEJwKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFZwKHQpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBlIGluIHQpIHtcclxuICAgICAgICAgICAgICAgIEJwKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5wKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHt0ZXh0OiBbdF19XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBNcCh0KSB7XHJcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0LnRleHQpKSB7XHJcbiAgICAgICAgICAgICAgICB0LnRleHQgPSBbdC50ZXh0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCcCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0W2VdKSkge1xyXG4gICAgICAgICAgICAgICAgdFtlXSA9IFt0W2VdXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB6cCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmIChEcChlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChEcCh0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHt0fSAke2V9YFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBMcCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBpbiBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodFtpXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbaV0ucHVzaCguLi5lW2ldKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0W2ldID0gZVtpXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBGcCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdC5hdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hdHRyaWJ1dGVzID0ge31cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIExwKHQuYXR0cmlidXRlcywgZS5hdHRyaWJ1dGVzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlLmV2ZW50TGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQuZXZlbnRMaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmV2ZW50TGlzdGVuZXJzID0ge31cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIExwKHQuZXZlbnRMaXN0ZW5lcnMsIGUuZXZlbnRMaXN0ZW5lcnMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUudGV4dCkge1xyXG4gICAgICAgICAgICAgICAgdC50ZXh0LnB1c2goLi4uZS50ZXh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlLmNoaWxkcmVuICYmIGUuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5jaGlsZHJlbi5sZW5ndGggIT0gZS5jaGlsZHJlbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwidWktdGVtcGxhdGUtZXh0ZW5kLWNoaWxkcmVuLW1pc21hdGNoOiBUaGUgbnVtYmVyIG9mIGNoaWxkcmVuIGluIGV4dGVuZGVkIGRlZmluaXRpb24gZG9lcyBub3QgbWF0Y2guXCIsIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIEZwKHQuY2hpbGRyZW5baSsrXSwgbilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRHAodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIXQgJiYgdCAhPT0gMFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24ganAodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIEdwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIcCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgX3BcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFdwKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBicFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcXAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7Y2hpbGRyZW46IFtdLCBiaW5kaW5nczogW10sIGF0dHJpYnV0ZXM6IHt9fVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVXAodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCA9PSBcImNsYXNzXCIgfHwgdCA9PSBcInN0eWxlXCJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciAkcCA9IGkoMTUpO1xyXG5cclxuICAgICAgICBjbGFzcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUmVuZGVyZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9jYWxlID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMudCA9IHQgJiYgdC50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld0NvbGxlY3Rpb25zID0gbmV3IHlzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdW5ib3VuZENoaWxkcmVuID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92aWV3Q29sbGVjdGlvbnMub24oXCJhZGRcIiwgKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpLmxvY2FsZSA9IHRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0ZShcInJlbmRlclwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgYmluZFRlbXBsYXRlKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JpbmRUZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iaW5kVGVtcGxhdGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iaW5kVGVtcGxhdGUgPSBfcC5iaW5kKHRoaXMsIHRoaXMpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZUNvbGxlY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IGJwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld0NvbGxlY3Rpb25zLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZ2lzdGVyQ2hpbGQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFqcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdW5ib3VuZENoaWxkcmVuLmFkZChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXJlZ2lzdGVyQ2hpbGQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFqcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdW5ib3VuZENoaWxkcmVuLnJlbW92ZShlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRUZW1wbGF0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlID0gbmV3IF9wKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4dGVuZFRlbXBsYXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIF9wLmV4dGVuZCh0aGlzLnRlbXBsYXRlLCB0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlbmRlcmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcInVpLXZpZXctcmVuZGVyLWFscmVhZHktcmVuZGVyZWQ6IFRoaXMgVmlldyBoYXMgYWxyZWFkeSBiZWVuIHJlbmRlcmVkLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGVtcGxhdGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLnRlbXBsYXRlLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJDaGlsZCh0aGlzLnRlbXBsYXRlLmdldFZpZXdzKCkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzUmVuZGVyZWQgPSB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdDb2xsZWN0aW9ucy5tYXAodCA9PiB0LmRlc3Ryb3koKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50ZW1wbGF0ZSAmJiB0aGlzLnRlbXBsYXRlLl9yZXZlcnREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZS5yZXZlcnQodGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhHcCwgcWQpO1xyXG4gICAgICAgIHZzKEdwLCBKYyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtwKHQpIHtcclxuICAgICAgICAgICAgd2hpbGUgKHQgJiYgdC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT0gXCJodG1sXCIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChJZC53aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS5wb3NpdGlvbiAhPSBcInN0YXRpY1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQgPSB0LnBhcmVudEVsZW1lbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSnAoe2VsZW1lbnQ6IHQsIHRhcmdldDogZSwgcG9zaXRpb25zOiBpLCBsaW1pdGVyOiBuLCBmaXRJblZpZXdwb3J0OiBvfSkge1xyXG4gICAgICAgICAgICBpZiAoZ3QoZSkpIHtcclxuICAgICAgICAgICAgICAgIGUgPSBlKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZ3QobikpIHtcclxuICAgICAgICAgICAgICAgIG4gPSBuKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByID0gS3AodC5wYXJlbnRFbGVtZW50KTtcclxuICAgICAgICAgICAgY29uc3QgcyA9IG5ldyB2aCh0KTtcclxuICAgICAgICAgICAgY29uc3QgYSA9IG5ldyB2aChlKTtcclxuICAgICAgICAgICAgbGV0IGM7XHJcbiAgICAgICAgICAgIGxldCBsO1xyXG4gICAgICAgICAgICBpZiAoIW4gJiYgIW8pIHtcclxuICAgICAgICAgICAgICAgIFtsLCBjXSA9IFlwKGlbMF0sIGEsIHMpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbiAmJiBuZXcgdmgobikuZ2V0VmlzaWJsZSgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG8gJiYgbmV3IHZoKElkLndpbmRvdyk7XHJcbiAgICAgICAgICAgICAgICBbbCwgY10gPSBRcChpLCBhLCBzLCB0LCBlKSB8fCBZcChpWzBdLCBhLCBzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB7bGVmdDogZCwgdG9wOiB1fSA9IFhwKGMpO1xyXG4gICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFhwKG5ldyB2aChyKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0ga2gocik7XHJcbiAgICAgICAgICAgICAgICBkIC09IHQubGVmdDtcclxuICAgICAgICAgICAgICAgIHUgLT0gdC50b3A7XHJcbiAgICAgICAgICAgICAgICBkICs9IHIuc2Nyb2xsTGVmdDtcclxuICAgICAgICAgICAgICAgIHUgKz0gci5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgICAgICBkIC09IGUubGVmdDtcclxuICAgICAgICAgICAgICAgIHUgLT0gZS50b3BcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge2xlZnQ6IGQsIHRvcDogdSwgbmFtZTogbH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFlwKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3Qge2xlZnQ6IG4sIHRvcDogbywgbmFtZTogcn0gPSB0KGUsIGkpO1xyXG4gICAgICAgICAgICByZXR1cm4gW3IsIGkuY2xvbmUoKS5tb3ZlVG8obiwgbyldXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBRcCh0LCBlLCBpLCBuLCBvKSB7XHJcbiAgICAgICAgICAgIGxldCByID0gMDtcclxuICAgICAgICAgICAgbGV0IHMgPSAwO1xyXG4gICAgICAgICAgICBsZXQgYTtcclxuICAgICAgICAgICAgbGV0IGM7XHJcbiAgICAgICAgICAgIGNvbnN0IGwgPSBpLmdldEFyZWEoKTtcclxuICAgICAgICAgICAgdC5zb21lKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgW2QsIHVdID0gWXAodCwgZSwgaSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaDtcclxuICAgICAgICAgICAgICAgIGxldCBmO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5nZXRJbnRlcnNlY3Rpb24obyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gdC5nZXRJbnRlcnNlY3Rpb25BcmVhKHUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoID0gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaCA9IG4uZ2V0SW50ZXJzZWN0aW9uQXJlYSh1KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IG8uZ2V0SW50ZXJzZWN0aW9uQXJlYSh1KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG8gJiYgIW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZiA+IHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghbyAmJiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGggPiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGcoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGYgPiBzICYmIGggPj0gcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnKClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYgPj0gcyAmJiBoID4gcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gZygpIHtcclxuICAgICAgICAgICAgICAgICAgICBzID0gZjtcclxuICAgICAgICAgICAgICAgICAgICByID0gaDtcclxuICAgICAgICAgICAgICAgICAgICBhID0gdTtcclxuICAgICAgICAgICAgICAgICAgICBjID0gZFxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBoID09PSBsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gYSA/IFtjLCBhXSA6IG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFhwKHtsZWZ0OiB0LCB0b3A6IGV9KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHtzY3JvbGxYOiBpLCBzY3JvbGxZOiBufSA9IElkLndpbmRvdztcclxuICAgICAgICAgICAgcmV0dXJuIHtsZWZ0OiB0ICsgaSwgdG9wOiBlICsgbn1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFpwKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPT4gZSArIHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0YiA9IGkoMTcpO1xyXG4gICAgICAgIGNvbnN0IGViID0gWnAoXCJweFwiKTtcclxuICAgICAgICBjb25zdCBpYiA9IElkLmRvY3VtZW50LmJvZHk7XHJcblxyXG4gICAgICAgIGNsYXNzIG5iIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwidG9wXCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJsZWZ0XCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJwb3NpdGlvblwiLCBcImFycm93X253XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc1Zpc2libGVcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ3aXRoQXJyb3dcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImNsYXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50ID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay1iYWxsb29uLXBhbmVsXCIsIGUudG8oXCJwb3NpdGlvblwiLCB0ID0+IGBjay1iYWxsb29uLXBhbmVsXyR7dH1gKSwgZS5pZihcImlzVmlzaWJsZVwiLCBcImNrLWJhbGxvb24tcGFuZWxfdmlzaWJsZVwiKSwgZS5pZihcIndpdGhBcnJvd1wiLCBcImNrLWJhbGxvb24tcGFuZWxfd2l0aC1hcnJvd1wiKSwgZS50byhcImNsYXNzXCIpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHt0b3A6IGUudG8oXCJ0b3BcIiwgZWIpLCBsZWZ0OiBlLnRvKFwibGVmdFwiLCBlYil9XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5jb250ZW50XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzaG93KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2libGUgPSB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhpZGUoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzVmlzaWJsZSA9IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dGFjaFRvKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5iLmRlZmF1bHRQb3NpdGlvbnM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gT2JqZWN0LmFzc2lnbih7fSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuZWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbnM6IFtlLnNvdXRoQXJyb3dOb3J0aCwgZS5zb3V0aEFycm93Tm9ydGhNaWRkbGVXZXN0LCBlLnNvdXRoQXJyb3dOb3J0aE1pZGRsZUVhc3QsIGUuc291dGhBcnJvd05vcnRoV2VzdCwgZS5zb3V0aEFycm93Tm9ydGhFYXN0LCBlLm5vcnRoQXJyb3dTb3V0aCwgZS5ub3J0aEFycm93U291dGhNaWRkbGVXZXN0LCBlLm5vcnRoQXJyb3dTb3V0aE1pZGRsZUVhc3QsIGUubm9ydGhBcnJvd1NvdXRoV2VzdCwgZS5ub3J0aEFycm93U291dGhFYXN0XSxcclxuICAgICAgICAgICAgICAgICAgICBsaW1pdGVyOiBpYixcclxuICAgICAgICAgICAgICAgICAgICBmaXRJblZpZXdwb3J0OiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9LCB0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuYi5fZ2V0T3B0aW1hbFBvc2l0aW9uKGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHBhcnNlSW50KG4ubGVmdCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gcGFyc2VJbnQobi50b3ApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4ubmFtZTtcclxuICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywge3RvcDogciwgbGVmdDogbywgcG9zaXRpb246IHN9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwaW4odCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bnBpbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGluV2hlbklzVmlzaWJsZUNhbGxiYWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFydFBpbm5pbmcodClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdG9wUGlubmluZygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0UGlubmluZyh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcywgXCJjaGFuZ2U6aXNWaXNpYmxlXCIsIHRoaXMuX3BpbldoZW5Jc1Zpc2libGVDYWxsYmFjaylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdW5waW4oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGluV2hlbklzVmlzaWJsZUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RvcFBpbm5pbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcywgXCJjaGFuZ2U6aXNWaXNpYmxlXCIsIHRoaXMuX3BpbldoZW5Jc1Zpc2libGVDYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGluV2hlbklzVmlzaWJsZUNhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGUoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc3RhcnRQaW5uaW5nKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNoVG8odCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gb2IodC50YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubGltaXRlciA/IG9iKHQubGltaXRlcikgOiBpYjtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oSWQuZG9jdW1lbnQsIFwic2Nyb2xsXCIsIChuLCBvKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG8udGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBlICYmIHIuY29udGFpbnMoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IGkgJiYgci5jb250YWlucyhpKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocyB8fCBhIHx8ICFlIHx8ICFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNoVG8odClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7dXNlQ2FwdHVyZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhJZC53aW5kb3csIFwicmVzaXplXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dGFjaFRvKHQpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc3RvcFBpbm5pbmcoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoSWQuZG9jdW1lbnQsIFwic2Nyb2xsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKElkLndpbmRvdywgXCJyZXNpemVcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb2IodCkge1xyXG4gICAgICAgICAgICBpZiAoS3IodCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHdoKHQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5jb21tb25BbmNlc3RvckNvbnRhaW5lclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvYih0KCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCA9IDI1O1xyXG4gICAgICAgIG5iLmFycm93VmVydGljYWxPZmZzZXQgPSAxMDtcclxuICAgICAgICBuYi5fZ2V0T3B0aW1hbFBvc2l0aW9uID0gSnA7XHJcbiAgICAgICAgbmIuZGVmYXVsdFBvc2l0aW9ucyA9IHtcclxuICAgICAgICAgICAgbm9ydGhXZXN0QXJyb3dTb3V0aFdlc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiByYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCAtIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfc3dcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbm9ydGhXZXN0QXJyb3dTb3V0aE1pZGRsZVdlc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiByYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCAtIGUud2lkdGggKiAuMjUgLSBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X3Ntd1wiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBub3J0aFdlc3RBcnJvd1NvdXRoOiAodCwgZSkgPT4gKHt0b3A6IHJiKHQsIGUpLCBsZWZ0OiB0LmxlZnQgLSBlLndpZHRoIC8gMiwgbmFtZTogXCJhcnJvd19zXCJ9KSxcclxuICAgICAgICAgICAgbm9ydGhXZXN0QXJyb3dTb3V0aE1pZGRsZUVhc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiByYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCAtIGUud2lkdGggKiAuNzUgKyBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X3NtZVwiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBub3J0aFdlc3RBcnJvd1NvdXRoRWFzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5sZWZ0IC0gZS53aWR0aCArIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfc2VcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbm9ydGhBcnJvd1NvdXRoV2VzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5sZWZ0ICsgdC53aWR0aCAvIDIgLSBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X3N3XCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIG5vcnRoQXJyb3dTb3V0aE1pZGRsZVdlc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiByYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCArIHQud2lkdGggLyAyIC0gZS53aWR0aCAqIC4yNSAtIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfc213XCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIG5vcnRoQXJyb3dTb3V0aDogKHQsIGUpID0+ICh7dG9wOiByYih0LCBlKSwgbGVmdDogdC5sZWZ0ICsgdC53aWR0aCAvIDIgLSBlLndpZHRoIC8gMiwgbmFtZTogXCJhcnJvd19zXCJ9KSxcclxuICAgICAgICAgICAgbm9ydGhBcnJvd1NvdXRoTWlkZGxlRWFzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5sZWZ0ICsgdC53aWR0aCAvIDIgLSBlLndpZHRoICogLjc1ICsgbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19zbWVcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbm9ydGhBcnJvd1NvdXRoRWFzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5sZWZ0ICsgdC53aWR0aCAvIDIgLSBlLndpZHRoICsgbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19zZVwiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBub3J0aEVhc3RBcnJvd1NvdXRoV2VzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5yaWdodCAtIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfc3dcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbm9ydGhFYXN0QXJyb3dTb3V0aE1pZGRsZVdlc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiByYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQucmlnaHQgLSBlLndpZHRoICogLjI1IC0gbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19zbXdcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgbm9ydGhFYXN0QXJyb3dTb3V0aDogKHQsIGUpID0+ICh7dG9wOiByYih0LCBlKSwgbGVmdDogdC5yaWdodCAtIGUud2lkdGggLyAyLCBuYW1lOiBcImFycm93X3NcIn0pLFxyXG4gICAgICAgICAgICBub3J0aEVhc3RBcnJvd1NvdXRoTWlkZGxlRWFzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5yaWdodCAtIGUud2lkdGggKiAuNzUgKyBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X3NtZVwiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBub3J0aEVhc3RBcnJvd1NvdXRoRWFzdDogKHQsIGUpID0+ICh7XHJcbiAgICAgICAgICAgICAgICB0b3A6IHJiKHQsIGUpLFxyXG4gICAgICAgICAgICAgICAgbGVmdDogdC5yaWdodCAtIGUud2lkdGggKyBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X3NlXCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHNvdXRoV2VzdEFycm93Tm9ydGhXZXN0OiAodCwgZSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIHRvcDogc2IodCwgZSksXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiB0LmxlZnQgLSBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X253XCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHNvdXRoV2VzdEFycm93Tm9ydGhNaWRkbGVXZXN0OiAodCwgZSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIHRvcDogc2IodCwgZSksXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiB0LmxlZnQgLSBlLndpZHRoICogLjI1IC0gbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19ubXdcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc291dGhXZXN0QXJyb3dOb3J0aDogKHQsIGUpID0+ICh7dG9wOiBzYih0LCBlKSwgbGVmdDogdC5sZWZ0IC0gZS53aWR0aCAvIDIsIG5hbWU6IFwiYXJyb3dfblwifSksXHJcbiAgICAgICAgICAgIHNvdXRoV2VzdEFycm93Tm9ydGhNaWRkbGVFYXN0OiAodCwgZSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIHRvcDogc2IodCwgZSksXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiB0LmxlZnQgLSBlLndpZHRoICogLjc1ICsgbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19ubWVcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc291dGhXZXN0QXJyb3dOb3J0aEVhc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCAtIGUud2lkdGggKyBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X25lXCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHNvdXRoQXJyb3dOb3J0aFdlc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCArIHQud2lkdGggLyAyIC0gbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19ud1wiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBzb3V0aEFycm93Tm9ydGhNaWRkbGVXZXN0OiAodCwgZSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIHRvcDogc2IodCwgZSksXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiB0LmxlZnQgKyB0LndpZHRoIC8gMiAtIGUud2lkdGggKiAuMjUgLSBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X25td1wiXHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICBzb3V0aEFycm93Tm9ydGg6ICh0LCBlKSA9PiAoe3RvcDogc2IodCwgZSksIGxlZnQ6IHQubGVmdCArIHQud2lkdGggLyAyIC0gZS53aWR0aCAvIDIsIG5hbWU6IFwiYXJyb3dfblwifSksXHJcbiAgICAgICAgICAgIHNvdXRoQXJyb3dOb3J0aE1pZGRsZUVhc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCArIHQud2lkdGggLyAyIC0gZS53aWR0aCAqIC43NSArIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfbm1lXCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHNvdXRoQXJyb3dOb3J0aEVhc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCArIHQud2lkdGggLyAyIC0gZS53aWR0aCArIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfbmVcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc291dGhFYXN0QXJyb3dOb3J0aFdlc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQucmlnaHQgLSBuYi5hcnJvd0hvcml6b250YWxPZmZzZXQsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFycm93X253XCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHNvdXRoRWFzdEFycm93Tm9ydGhNaWRkbGVXZXN0OiAodCwgZSkgPT4gKHtcclxuICAgICAgICAgICAgICAgIHRvcDogc2IodCwgZSksXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiB0LnJpZ2h0IC0gZS53aWR0aCAqIC4yNSAtIG5iLmFycm93SG9yaXpvbnRhbE9mZnNldCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IFwiYXJyb3dfbm13XCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIHNvdXRoRWFzdEFycm93Tm9ydGg6ICh0LCBlKSA9PiAoe3RvcDogc2IodCwgZSksIGxlZnQ6IHQucmlnaHQgLSBlLndpZHRoIC8gMiwgbmFtZTogXCJhcnJvd19uXCJ9KSxcclxuICAgICAgICAgICAgc291dGhFYXN0QXJyb3dOb3J0aE1pZGRsZUVhc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQucmlnaHQgLSBlLndpZHRoICogLjc1ICsgbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19ubWVcIlxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgc291dGhFYXN0QXJyb3dOb3J0aEVhc3Q6ICh0LCBlKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgdG9wOiBzYih0LCBlKSxcclxuICAgICAgICAgICAgICAgIGxlZnQ6IHQucmlnaHQgLSBlLndpZHRoICsgbmIuYXJyb3dIb3Jpem9udGFsT2Zmc2V0LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhcnJvd19uZVwiXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmIodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC50b3AgLSBlLmhlaWdodCAtIG5iLmFycm93VmVydGljYWxPZmZzZXRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNiKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuYm90dG9tICsgbmIuYXJyb3dWZXJ0aWNhbE9mZnNldFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGFiID0gaSgxOSk7XHJcblxyXG4gICAgICAgIGNsYXNzIGNiIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImNvbnRlbnRcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInZpZXdCb3hcIiwgXCIwIDAgMjAgMjBcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImZpbGxDb2xvclwiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJzdmdcIixcclxuICAgICAgICAgICAgICAgICAgICBuczogXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1pY29uXCJdLCB2aWV3Qm94OiB0LnRvKFwidmlld0JveFwiKX1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlWE1MQ29udGVudCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29sb3JGaWxsUGF0aHMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJjaGFuZ2U6Y29udGVudFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlWE1MQ29udGVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbG9yRmlsbFBhdGhzKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTpmaWxsQ29sb3JcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbG9yRmlsbFBhdGhzKClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVYTUxDb250ZW50KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSAobmV3IERPTVBhcnNlcikucGFyc2VGcm9tU3RyaW5nKHRoaXMuY29udGVudC50cmltKCksIFwiaW1hZ2Uvc3ZnK3htbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmdldEF0dHJpYnV0ZShcInZpZXdCb3hcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3Qm94ID0gaVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZS5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGUuY2hpbGROb2Rlc1swXSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jb2xvckZpbGxQYXRocygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbGxDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNrLWljb25fX2ZpbGxcIikuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zdHlsZS5maWxsID0gdGhpcy5maWxsQ29sb3JcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbGIgPSBpKDIxKTtcclxuXHJcbiAgICAgICAgY2xhc3MgZGIgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ0ZXh0XCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJwb3NpdGlvblwiLCBcInNcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay10b29sdGlwXCIsIGUudG8oXCJwb3NpdGlvblwiLCB0ID0+IFwiY2stdG9vbHRpcF9cIiArIHQpLCBlLmlmKFwidGV4dFwiLCBcImNrLWhpZGRlblwiLCB0ID0+ICF0LnRyaW0oKSldfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiBcInNwYW5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLXRvb2x0aXBfX3RleHRcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3t0ZXh0OiBlLnRvKFwidGV4dFwiKX1dXHJcbiAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB1YiA9IGkoMjMpO1xyXG5cclxuICAgICAgICBjbGFzcyBoYiBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gaXMoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiY2xhc3NcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImxhYmVsU3R5bGVcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImljb25cIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzRW5hYmxlZFwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNPblwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzVmlzaWJsZVwiLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNUb2dnbGVhYmxlXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwia2V5c3Ryb2tlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJsYWJlbFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwidGFiaW5kZXhcIiwgLTEpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ0b29sdGlwXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ0b29sdGlwUG9zaXRpb25cIiwgXCJzXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ0eXBlXCIsIFwiYnV0dG9uXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ3aXRoVGV4dFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcIndpdGhLZXlzdHJva2VcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b29sdGlwVmlldyA9IHRoaXMuX2NyZWF0ZVRvb2x0aXBWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhYmVsVmlldyA9IHRoaXMuX2NyZWF0ZUxhYmVsVmlldyhpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaWNvblZpZXcgPSBuZXcgY2I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmljb25WaWV3LmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFwiY2stYnV0dG9uX19pY29uXCJ9fSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZVZpZXcgPSB0aGlzLl9jcmVhdGVLZXlzdHJva2VWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmQoXCJfdG9vbHRpcFN0cmluZ1wiKS50byh0aGlzLCBcInRvb2x0aXBcIiwgdGhpcywgXCJsYWJlbFwiLCB0aGlzLCBcImtleXN0cm9rZVwiLCB0aGlzLl9nZXRUb29sdGlwU3RyaW5nLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFtcImNrXCIsIFwiY2stYnV0dG9uXCIsIGUudG8oXCJjbGFzc1wiKSwgZS5pZihcImlzRW5hYmxlZFwiLCBcImNrLWRpc2FibGVkXCIsIHQgPT4gIXQpLCBlLmlmKFwiaXNWaXNpYmxlXCIsIFwiY2staGlkZGVuXCIsIHQgPT4gIXQpLCBlLnRvKFwiaXNPblwiLCB0ID0+IHQgPyBcImNrLW9uXCIgOiBcImNrLW9mZlwiKSwgZS5pZihcIndpdGhUZXh0XCIsIFwiY2stYnV0dG9uX3dpdGgtdGV4dFwiKSwgZS5pZihcIndpdGhLZXlzdHJva2VcIiwgXCJjay1idXR0b25fd2l0aC1rZXlzdHJva2VcIildLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBlLnRvKFwidHlwZVwiLCB0ID0+IHQgPyB0IDogXCJidXR0b25cIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmluZGV4OiBlLnRvKFwidGFiaW5kZXhcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IGBjay1lZGl0b3JfX2FyaWEtbGFiZWxfJHtpfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXJpYS1kaXNhYmxlZFwiOiBlLmlmKFwiaXNFbmFibGVkXCIsIHRydWUsIHQgPT4gIXQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFyaWEtcHJlc3NlZFwiOiBlLnRvKFwiaXNPblwiLCB0ID0+IHRoaXMuaXNUb2dnbGVhYmxlID8gU3RyaW5nKHQpIDogZmFsc2UpXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5jaGlsZHJlbixcclxuICAgICAgICAgICAgICAgICAgICBvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb3VzZWRvd246IGUudG8odCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksIGNsaWNrOiBlLnRvKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiZXhlY3V0ZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmljb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmljb25WaWV3LmJpbmQoXCJjb250ZW50XCIpLnRvKHRoaXMsIFwiaWNvblwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmFkZCh0aGlzLmljb25WaWV3KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQodGhpcy50b29sdGlwVmlldyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmFkZCh0aGlzLmxhYmVsVmlldyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy53aXRoS2V5c3Ryb2tlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQodGhpcy5rZXlzdHJva2VWaWV3KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5mb2N1cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVUb29sdGlwVmlldygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgZGI7XHJcbiAgICAgICAgICAgICAgICB0LmJpbmQoXCJ0ZXh0XCIpLnRvKHRoaXMsIFwiX3Rvb2x0aXBTdHJpbmdcIik7XHJcbiAgICAgICAgICAgICAgICB0LmJpbmQoXCJwb3NpdGlvblwiKS50byh0aGlzLCBcInRvb2x0aXBQb3NpdGlvblwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVMYWJlbFZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBHcDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIGUuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJzcGFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay1idXR0b25fX2xhYmVsXCJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogaS50byhcImxhYmVsU3R5bGVcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBgY2stZWRpdG9yX19hcmlhLWxhYmVsXyR7dH1gXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3t0ZXh0OiB0aGlzLmJpbmRUZW1wbGF0ZS50byhcImxhYmVsXCIpfV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUtleXN0cm9rZVZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IEdwO1xyXG4gICAgICAgICAgICAgICAgdC5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcInNwYW5cIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stYnV0dG9uX19rZXlzdHJva2VcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IHRoaXMuYmluZFRlbXBsYXRlLnRvKFwia2V5c3Ryb2tlXCIsIHQgPT4gemwodCkpfV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFRvb2x0aXBTdHJpbmcodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHQgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID0gemwoaSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdChlLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke2V9JHtpID8gYCAoJHtpfSlgIDogXCJcIn1gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBmYiB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0ZvY3VzZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJmb2N1c2VkRWxlbWVudFwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25leHRFdmVudExvb3BUaW1lb3V0ID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2VsZW1lbnRzLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJmb2N1c1RyYWNrZXItYWRkLWVsZW1lbnQtYWxyZWFkeS1leGlzdFwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LCBcImZvY3VzXCIsICgpID0+IHRoaXMuX2ZvY3VzKHQpLCB7dXNlQ2FwdHVyZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LCBcImJsdXJcIiwgKCkgPT4gdGhpcy5fYmx1cigpLCB7dXNlQ2FwdHVyZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudHMuYWRkKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCA9PT0gdGhpcy5mb2N1c2VkRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JsdXIodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9lbGVtZW50cy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudHMuZGVsZXRlKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZm9jdXModCkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX25leHRFdmVudExvb3BUaW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNlZEVsZW1lbnQgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9ibHVyKCkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX25leHRFdmVudExvb3BUaW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25leHRFdmVudExvb3BUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c2VkRWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfSwgMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoZmIsIHFkKTtcclxuICAgICAgICB2cyhmYiwgSmMpO1xyXG4gICAgICAgIHZhciBnYiA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xMS40NjMgNS4xODdhLjg4OC44ODggMCAxIDEgMS4yNTQgMS4yNTVMOS4xNiAxMGwzLjU1NyAzLjU1N2EuODg4Ljg4OCAwIDEgMS0xLjI1NCAxLjI1NUw3LjI2IDEwLjYxYS44ODguODg4IDAgMCAxIC4xNi0xLjM4Mmw0LjA0My00LjA0MnpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgbWIgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNOC41MzcgMTQuODEzYS44ODguODg4IDAgMSAxLTEuMjU0LTEuMjU1TDEwLjg0IDEwIDcuMjgzIDYuNDQyYS44ODguODg4IDAgMSAxIDEuMjU0LTEuMjU1TDEyLjc0IDkuMzlhLjg4OC44ODggMCAwIDEtLjE2IDEuMzgybC00LjA0MyA0LjA0MnpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgcGIgPSBpKDI1KTtcclxuICAgICAgICB2YXIgYmIgPSBpKDI3KTtcclxuICAgICAgICBjb25zdCB3YiA9IFpwKFwicHhcIik7XHJcblxyXG4gICAgICAgIGNsYXNzIGtiIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJDb250ZXh0dWFsQmFsbG9vblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wb3NpdGlvbkxpbWl0ZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5zZWxlY3Rpb24uZWRpdGFibGVFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20oaS5yb290KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwidmlzaWJsZVZpZXdcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcgPSBuZXcgbmIodC5sb2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgdC51aS52aWV3LmJvZHkuYWRkKHRoaXMudmlldyk7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmZvY3VzVHJhY2tlci5hZGQodGhpcy52aWV3LmVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvU3RhY2sgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faWRUb1N0YWNrID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiX251bWJlck9mU3RhY2tzXCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJfc2luZ2xlVmlld01vZGVcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcm90YXRvclZpZXcgPSB0aGlzLl9jcmVhdGVSb3RhdG9yVmlldygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmFrZVBhbmVsc1ZpZXcgPSB0aGlzLl9jcmVhdGVGYWtlUGFuZWxzVmlldygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhc1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5fdmlld1RvU3RhY2sua2V5cygpKS5pbmNsdWRlcyh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzVmlldyh0LnZpZXcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbnRleHR1YWxiYWxsb29uLWFkZC12aWV3LWV4aXN0OiBDYW5ub3QgYWRkIGNvbmZpZ3VyYXRpb24gb2YgdGhlIHNhbWUgdmlldyB0d2ljZS5cIiwgW3RoaXMsIHRdKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc3RhY2tJZCB8fCBcIm1haW5cIjtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5faWRUb1N0YWNrLmhhcyhlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2lkVG9TdGFjay5zZXQoZSwgbmV3IE1hcChbW3QudmlldywgdF1dKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvU3RhY2suc2V0KHQudmlldywgdGhpcy5faWRUb1N0YWNrLmdldChlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbnVtYmVyT2ZTdGFja3MgPSB0aGlzLl9pZFRvU3RhY2suc2l6ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3Zpc2libGVTdGFjayB8fCB0LnNpbmdsZVZpZXdNb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N0YWNrKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2lkVG9TdGFjay5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5zaW5nbGVWaWV3TW9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N0YWNrKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpLnNldCh0LnZpZXcsIHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdmlld1RvU3RhY2suc2V0KHQudmlldywgaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gdGhpcy5fdmlzaWJsZVN0YWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2hvd1ZpZXcodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5oYXNWaWV3KHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbnRleHR1YWxiYWxsb29uLXJlbW92ZS12aWV3LW5vdC1leGlzdDogQ2Fubm90IHJlbW92ZSB0aGUgY29uZmlndXJhdGlvbiBvZiBhIG5vbi1leGlzdGVudCB2aWV3LlwiLCBbdGhpcywgdF0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fdmlld1RvU3RhY2suZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NpbmdsZVZpZXdNb2RlICYmIHRoaXMudmlzaWJsZVZpZXcgPT09IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zaW5nbGVWaWV3TW9kZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52aXNpYmxlVmlldyA9PT0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnNpemUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lkVG9TdGFjay5zaXplID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2hvd05leHRTdGFjaygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aXNpYmxlVmlldyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yb3RhdG9yVmlldy5oaWRlVmlldygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zaG93VmlldyhBcnJheS5mcm9tKGUudmFsdWVzKCkpW2Uuc2l6ZSAtIDJdKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlLnNpemUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pZFRvU3RhY2suZGVsZXRlKHRoaXMuX2dldFN0YWNrSWQoZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX251bWJlck9mU3RhY2tzID0gdGhpcy5faWRUb1N0YWNrLnNpemVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5kZWxldGUodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZXdUb1N0YWNrLmRlbGV0ZSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVQb3NpdGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2libGVTdGFjay5nZXQodGhpcy52aXNpYmxlVmlldykucG9zaXRpb24gPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcucGluKHRoaXMuX2dldEJhbGxvb25Qb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Zha2VQYW5lbHNWaWV3LnVwZGF0ZVBvc2l0aW9uKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2hvd1N0YWNrKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlzaWJsZVN0YWNrID0gdDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9pZFRvU3RhY2suZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImNvbnRleHR1YWxiYWxsb29uLXNob3dzdGFjay1zdGFjay1ub3QtZXhpc3Q6IENhbm5vdCBzaG93IGEgc3RhY2sgdGhhdCBkb2VzIG5vdCBleGlzdC5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl92aXNpYmxlU3RhY2sgPT09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dWaWV3KEFycmF5LmZyb20oZS52YWx1ZXMoKSkucG9wKCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfdmlzaWJsZVN0YWNrKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdUb1N0YWNrLmdldCh0aGlzLnZpc2libGVWaWV3KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0U3RhY2tJZCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gQXJyYXkuZnJvbSh0aGlzLl9pZFRvU3RhY2suZW50cmllcygpKS5maW5kKGUgPT4gZVsxXSA9PT0gdCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVswXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2hvd05leHRTdGFjaygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBBcnJheS5mcm9tKHRoaXMuX2lkVG9TdGFjay52YWx1ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHQuaW5kZXhPZih0aGlzLl92aXNpYmxlU3RhY2spICsgMTtcclxuICAgICAgICAgICAgICAgIGlmICghdFtlXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dTdGFjayh0aGlzLl9nZXRTdGFja0lkKHRbZV0pKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2hvd1ByZXZTdGFjaygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBBcnJheS5mcm9tKHRoaXMuX2lkVG9TdGFjay52YWx1ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSA9IHQuaW5kZXhPZih0aGlzLl92aXNpYmxlU3RhY2spIC0gMTtcclxuICAgICAgICAgICAgICAgIGlmICghdFtlXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0Lmxlbmd0aCAtIDFcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N0YWNrKHRoaXMuX2dldFN0YWNrSWQodFtlXSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVSb3RhdG9yVmlldygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgX2IodGhpcy5lZGl0b3IubG9jYWxlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5sb2NhbGUudDtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5jb250ZW50LmFkZCh0KTtcclxuICAgICAgICAgICAgICAgIHQuYmluZChcImlzTmF2aWdhdGlvblZpc2libGVcIikudG8odGhpcywgXCJfbnVtYmVyT2ZTdGFja3NcIiwgdGhpcywgXCJfc2luZ2xlVmlld01vZGVcIiwgKHQsIGUpID0+ICFlICYmIHQgPiAxKTtcclxuICAgICAgICAgICAgICAgIHQub24oXCJjaGFuZ2U6aXNOYXZpZ2F0aW9uVmlzaWJsZVwiLCAoKSA9PiB0aGlzLnVwZGF0ZVBvc2l0aW9uKCksIHtwcmlvcml0eTogXCJsb3dcIn0pO1xyXG4gICAgICAgICAgICAgICAgdC5iaW5kKFwiY291bnRlclwiKS50byh0aGlzLCBcInZpc2libGVWaWV3XCIsIHRoaXMsIFwiX251bWJlck9mU3RhY2tzXCIsICh0LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBBcnJheS5mcm9tKHRoaXMuX2lkVG9TdGFjay52YWx1ZXMoKSkuaW5kZXhPZih0aGlzLl92aXNpYmxlU3RhY2spICsgMTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZShcImx1XCIsIFtuLCBpXSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5idXR0b25OZXh0Vmlldy5vbihcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmZvY3VzVHJhY2tlci5pc0ZvY3VzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2hvd05leHRTdGFjaygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQuYnV0dG9uUHJldlZpZXcub24oXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5mb2N1c1RyYWNrZXIuaXNGb2N1c2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dQcmV2U3RhY2soKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlRmFrZVBhbmVsc1ZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IHZiKHRoaXMuZWRpdG9yLmxvY2FsZSwgdGhpcy52aWV3KTtcclxuICAgICAgICAgICAgICAgIHQuYmluZChcIm51bWJlck9mUGFuZWxzXCIpLnRvKHRoaXMsIFwiX251bWJlck9mU3RhY2tzXCIsIHRoaXMsIFwiX3NpbmdsZVZpZXdNb2RlXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9ICFlICYmIHQgPj0gMjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSA/IE1hdGgubWluKHQgLSAxLCAyKSA6IDBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5saXN0ZW5Ubyh0aGlzLnZpZXcsIFwiY2hhbmdlOnRvcFwiLCAoKSA9PiB0LnVwZGF0ZVBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgdC5saXN0ZW5Ubyh0aGlzLnZpZXcsIFwiY2hhbmdlOmxlZnRcIiwgKCkgPT4gdC51cGRhdGVQb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnVpLnZpZXcuYm9keS5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2hvd1ZpZXcoe3ZpZXc6IHQsIGJhbGxvb25DbGFzc05hbWU6IGUgPSBcIlwiLCB3aXRoQXJyb3c6IGkgPSB0cnVlLCBzaW5nbGVWaWV3TW9kZTogbiA9IGZhbHNlfSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmNsYXNzID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy53aXRoQXJyb3cgPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcm90YXRvclZpZXcuc2hvd1ZpZXcodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpc2libGVWaWV3ID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5waW4odGhpcy5fZ2V0QmFsbG9vblBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmFrZVBhbmVsc1ZpZXcudXBkYXRlUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2luZ2xlVmlld01vZGUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRCYWxsb29uUG9zaXRpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IEFycmF5LmZyb20odGhpcy5fdmlzaWJsZVN0YWNrLnZhbHVlcygpKS5wb3AoKS5wb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmICh0ICYmICF0LmxpbWl0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gT2JqZWN0LmFzc2lnbih7fSwgdCwge2xpbWl0ZXI6IHRoaXMucG9zaXRpb25MaW1pdGVyfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIF9iIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzTmF2aWdhdGlvblZpc2libGVcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlciA9IG5ldyBmYjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uUHJldlZpZXcgPSB0aGlzLl9jcmVhdGVCdXR0b25WaWV3KGUoXCJsdlwiKSwgZ2IpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idXR0b25OZXh0VmlldyA9IHRoaXMuX2NyZWF0ZUJ1dHRvblZpZXcoZShcImx3XCIpLCBtYik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQgPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stYmFsbG9vbi1yb3RhdG9yXCJdLCBcInotaW5kZXhcIjogXCItMVwifSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrLWJhbGxvb24tcm90YXRvcl9fbmF2aWdhdGlvblwiLCBpLnRvKFwiaXNOYXZpZ2F0aW9uVmlzaWJsZVwiLCB0ID0+IHQgPyBcIlwiIDogXCJjay1oaWRkZW5cIildfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt0aGlzLmJ1dHRvblByZXZWaWV3LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJjay1iYWxsb29uLXJvdGF0b3JfX2NvdW50ZXJcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt7dGV4dDogaS50byhcImNvdW50ZXJcIil9XVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLmJ1dHRvbk5leHRWaWV3XVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHt0YWc6IFwiZGl2XCIsIGF0dHJpYnV0ZXM6IHtjbGFzczogXCJjay1iYWxsb29uLXJvdGF0b3JfX2NvbnRlbnRcIn0sIGNoaWxkcmVuOiB0aGlzLmNvbnRlbnR9XVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVuZGVyKCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzaG93Vmlldyh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQuYWRkKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhpZGVWaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50LmNsZWFyKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUJ1dHRvblZpZXcodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBoYih0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBpLnNldCh7bGFiZWw6IHQsIGljb246IGUsIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHZiIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwidG9wXCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJsZWZ0XCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJoZWlnaHRcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcIndpZHRoXCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJudW1iZXJPZlBhbmVsc1wiLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudCA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vblBhbmVsVmlldyA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2stZmFrZS1wYW5lbFwiLCBpLnRvKFwibnVtYmVyT2ZQYW5lbHNcIiwgdCA9PiB0ID8gXCJcIiA6IFwiY2staGlkZGVuXCIpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogaS50byhcInRvcFwiLCB3YiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBpLnRvKFwibGVmdFwiLCB3YiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogaS50byhcIndpZHRoXCIsIHdiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogaS50byhcImhlaWdodFwiLCB3YilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY29udGVudFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwiY2hhbmdlOm51bWJlck9mUGFuZWxzXCIsICh0LCBlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZFBhbmVscyhpIC0gbilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVQYW5lbHMobiAtIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUG9zaXRpb24oKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FkZFBhbmVscyh0KSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodC0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBHcDtcclxuICAgICAgICAgICAgICAgICAgICB0LnNldFRlbXBsYXRlKHt0YWc6IFwiZGl2XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnQuYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJDaGlsZCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVtb3ZlUGFuZWxzKHQpIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlICh0LS0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5jb250ZW50Lmxhc3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZW50LnJlbW92ZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlcmVnaXN0ZXJDaGlsZCh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0LmRlc3Ryb3koKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVQb3NpdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm51bWJlck9mUGFuZWxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qge3RvcDogdCwgbGVmdDogZX0gPSB0aGlzLl9iYWxsb29uUGFuZWxWaWV3O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHt3aWR0aDogaSwgaGVpZ2h0OiBufSA9IG5ldyB2aCh0aGlzLl9iYWxsb29uUGFuZWxWaWV3LmVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywge3RvcDogdCwgbGVmdDogZSwgd2lkdGg6IGksIGhlaWdodDogbn0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHliIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCB0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0LmFjdGlvbnMgJiYgdC5rZXlzdHJva2VIYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIGluIHQuYWN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IHQuYWN0aW9uc1tlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBpID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBbaV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5rZXlzdHJva2VIYW5kbGVyLnNldChuLCAodCwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZV0oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBmaXJzdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZvY3VzYWJsZXMuZmluZCh4YikgfHwgbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbGFzdCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZvY3VzYWJsZXMuZmlsdGVyKHhiKS5zbGljZSgtMSlbMF0gfHwgbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgbmV4dCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRGb2N1c2FibGVJdGVtKDEpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBwcmV2aW91cygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXRGb2N1c2FibGVJdGVtKC0xKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgY3VycmVudCgpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvY3VzVHJhY2tlci5mb2N1c2VkRWxlbWVudCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzYWJsZXMuZmluZCgoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmVsZW1lbnQgPT09IHRoaXMuZm9jdXNUcmFja2VyLmZvY3VzZWRFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzRmlyc3QoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1cyh0aGlzLmZpcnN0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1c0xhc3QoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1cyh0aGlzLmxhc3QpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzTmV4dCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzKHRoaXMubmV4dClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXNQcmV2aW91cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzKHRoaXMucHJldmlvdXMpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9mb2N1cyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0Rm9jdXNhYmxlSXRlbSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5jdXJyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZm9jdXNhYmxlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1t0ID09PSAxID8gXCJmaXJzdFwiIDogXCJsYXN0XCJdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgbiA9IChlICsgaSArIHQpICUgaTtcclxuICAgICAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5mb2N1c2FibGVzLmdldChuKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoeGIoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IChuICsgaSArIHQpICUgaVxyXG4gICAgICAgICAgICAgICAgfSB3aGlsZSAobiAhPT0gZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB4Yih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhISh0LmZvY3VzICYmIElkLndpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQuZWxlbWVudCkuZGlzcGxheSAhPSBcIm5vbmVcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIENiIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe3RhZzogXCJzcGFuXCIsIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay10b29sYmFyX19zZXBhcmF0b3JcIl19fSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgQWIgPSAxMDA7XHJcblxyXG4gICAgICAgIGNsYXNzIFRiIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFUYi5fb2JzZXJ2ZXJJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIFRiLl9jcmVhdGVPYnNlcnZlcigpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50ID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gZTtcclxuICAgICAgICAgICAgICAgIFRiLl9hZGRFbGVtZW50Q2FsbGJhY2sodCwgZSk7XHJcbiAgICAgICAgICAgICAgICBUYi5fb2JzZXJ2ZXJJbnN0YW5jZS5vYnNlcnZlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBUYi5fZGVsZXRlRWxlbWVudENhbGxiYWNrKHRoaXMuX2VsZW1lbnQsIHRoaXMuX2NhbGxiYWNrKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgX2FkZEVsZW1lbnRDYWxsYmFjayh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIVRiLl9lbGVtZW50Q2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGIuX2VsZW1lbnRDYWxsYmFja3MgPSBuZXcgTWFwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IFRiLl9lbGVtZW50Q2FsbGJhY2tzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIFRiLl9lbGVtZW50Q2FsbGJhY2tzLnNldCh0LCBpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5hZGQoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9kZWxldGVFbGVtZW50Q2FsbGJhY2sodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFRiLl9nZXRFbGVtZW50Q2FsbGJhY2tzKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLmRlbGV0ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBUYi5fZWxlbWVudENhbGxiYWNrcy5kZWxldGUodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFRiLl9vYnNlcnZlckluc3RhbmNlLnVub2JzZXJ2ZSh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChUYi5fZWxlbWVudENhbGxiYWNrcyAmJiAhVGIuX2VsZW1lbnRDYWxsYmFja3Muc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIFRiLl9vYnNlcnZlckluc3RhbmNlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBUYi5fZWxlbWVudENhbGxiYWNrcyA9IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIF9nZXRFbGVtZW50Q2FsbGJhY2tzKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghVGIuX2VsZW1lbnRDYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRiLl9lbGVtZW50Q2FsbGJhY2tzLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgX2NyZWF0ZU9ic2VydmVyKCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIElkLndpbmRvdy5SZXNpemVPYnNlcnZlciA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IElkLndpbmRvdy5SZXNpemVPYnNlcnZlclxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gUGJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFRiLl9vYnNlcnZlckluc3RhbmNlID0gbmV3IHQodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IFRiLl9nZXRFbGVtZW50Q2FsbGJhY2tzKGUudGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaShlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgVGIuX29ic2VydmVySW5zdGFuY2UgPSBudWxsO1xyXG4gICAgICAgIFRiLl9lbGVtZW50Q2FsbGJhY2tzID0gbnVsbDtcclxuXHJcbiAgICAgICAgY2xhc3MgUGIge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50cyA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcmV2aW91c1JlY3RzID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BlcmlvZGljQ2hlY2tUaW1lb3V0ID0gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvYnNlcnZlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrRWxlbWVudFJlY3RzQW5kRXhlY3V0ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZWxlbWVudHMuc2l6ZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0UGVyaW9kaWNDaGVjaygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVub2JzZXJ2ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50cy5kZWxldGUodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcmV2aW91c1JlY3RzLmRlbGV0ZSh0KTtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fZWxlbWVudHMuc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0b3BQZXJpb2RpY0NoZWNrKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3N0YXJ0UGVyaW9kaWNDaGVjaygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tFbGVtZW50UmVjdHNBbmRFeGVjdXRlQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZXJpb2RpY0NoZWNrVGltZW91dCA9IHNldFRpbWVvdXQodCwgQWIpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhJZC53aW5kb3csIFwicmVzaXplXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0VsZW1lbnRSZWN0c0FuZEV4ZWN1dGVDYWxsYmFjaygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3BlcmlvZGljQ2hlY2tUaW1lb3V0ID0gc2V0VGltZW91dCh0LCBBYilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3N0b3BQZXJpb2RpY0NoZWNrKCkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3BlcmlvZGljQ2hlY2tUaW1lb3V0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJldmlvdXNSZWN0cy5jbGVhcigpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jaGVja0VsZW1lbnRSZWN0c0FuZEV4ZWN1dGVDYWxsYmFjaygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLl9lbGVtZW50cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNSZWN0Q2hhbmdlZChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnB1c2goe3RhcmdldDogZSwgY29udGVudFJlY3Q6IHRoaXMuX3ByZXZpb3VzUmVjdHMuZ2V0KGUpfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFjayh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGFzUmVjdENoYW5nZWQodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0Lm93bmVyRG9jdW1lbnQuYm9keS5jb250YWlucyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyB2aCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9wcmV2aW91c1JlY3RzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSAhaSB8fCAhaS5pc0VxdWFsKGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJldmlvdXNSZWN0cy5zZXQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhQYiwgcWQpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBTYih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LmJpbmRUZW1wbGF0ZS50byhlID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gdC5lbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBFYiBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzVmlzaWJsZVwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInBvc2l0aW9uXCIsIFwic2VcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLXJlc2V0XCIsIFwiY2stZHJvcGRvd25fX3BhbmVsXCIsIGUudG8oXCJwb3NpdGlvblwiLCB0ID0+IGBjay1kcm9wZG93bl9fcGFuZWxfJHt0fWApLCBlLmlmKFwiaXNWaXNpYmxlXCIsIFwiY2stZHJvcGRvd25fX3BhbmVsLXZpc2libGVcIildfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5jaGlsZHJlbixcclxuICAgICAgICAgICAgICAgICAgICBvbjoge3NlbGVjdHN0YXJ0OiBlLnRvKHQgPT4gdC5wcmV2ZW50RGVmYXVsdCgpKX1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5maXJzdC5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzTGFzdCgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmNoaWxkcmVuLmxhc3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0LmZvY3VzTGFzdCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZm9jdXNMYXN0KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBSYiA9IGkoMjkpO1xyXG5cclxuICAgICAgICBjbGFzcyBPYiBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvblZpZXcgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYW5lbFZpZXcgPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc09wZW5cIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0VuYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImNsYXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpZFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwicGFuZWxQb3NpdGlvblwiLCBcImF1dG9cIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlciA9IG5ldyBmYjtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcyA9IG5ldyBkcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBbXCJja1wiLCBcImNrLWRyb3Bkb3duXCIsIG4udG8oXCJjbGFzc1wiKSwgbi5pZihcImlzRW5hYmxlZFwiLCBcImNrLWRpc2FibGVkXCIsIHQgPT4gIXQpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IG4udG8oXCJpZFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcmlhLWRlc2NyaWJlZGJ5XCI6IG4udG8oXCJhcmlhRGVzY3JpYmVkQnlJZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtlLCBpXVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBlLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrLWRyb3Bkb3duX19idXR0b25cIl19fSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVuZGVyKCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuYnV0dG9uVmlldywgXCJvcGVuXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzT3BlbiA9ICF0aGlzLmlzT3BlblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhbmVsVmlldy5iaW5kKFwiaXNWaXNpYmxlXCIpLnRvKHRoaXMsIFwiaXNPcGVuXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTppc09wZW5cIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc09wZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBhbmVsUG9zaXRpb24gPT09IFwiYXV0b1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFuZWxWaWV3LnBvc2l0aW9uID0gT2IuX2dldE9wdGltYWxQb3NpdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiB0aGlzLnBhbmVsVmlldy5lbGVtZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLmJ1dHRvblZpZXcuZWxlbWVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpdEluVmlld3BvcnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbnM6IHRoaXMuX3BhbmVsUG9zaXRpb25zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLm5hbWVcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhbmVsVmlldy5wb3NpdGlvbiA9IHRoaXMucGFuZWxQb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzLmxpc3RlblRvKHRoaXMuZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodGhpcy5lbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzT3Blbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvblZpZXcuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcy5zZXQoXCJhcnJvd2Rvd25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5idXR0b25WaWV3LmlzRW5hYmxlZCAmJiAhdGhpcy5pc09wZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc09wZW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcy5zZXQoXCJhcnJvd3JpZ2h0XCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzLnNldChcImFycm93bGVmdFwiLCB0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcy5zZXQoXCJlc2NcIiwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvblZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgX3BhbmVsUG9zaXRpb25zKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge3NvdXRoRWFzdDogdCwgc291dGhXZXN0OiBlLCBub3J0aEVhc3Q6IGksIG5vcnRoV2VzdDogbn0gPSBPYi5kZWZhdWx0UGFuZWxQb3NpdGlvbnM7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sb2NhbGUudWlMYW5ndWFnZURpcmVjdGlvbiA9PT0gXCJsdHJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdCwgZSwgaSwgbl1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtlLCB0LCBuLCBpXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBPYi5kZWZhdWx0UGFuZWxQb3NpdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIHNvdXRoRWFzdDogdCA9PiAoe3RvcDogdC5ib3R0b20sIGxlZnQ6IHQubGVmdCwgbmFtZTogXCJzZVwifSksXHJcbiAgICAgICAgICAgIHNvdXRoV2VzdDogKHQsIGUpID0+ICh7dG9wOiB0LmJvdHRvbSwgbGVmdDogdC5sZWZ0IC0gZS53aWR0aCArIHQud2lkdGgsIG5hbWU6IFwic3dcIn0pLFxyXG4gICAgICAgICAgICBub3J0aEVhc3Q6ICh0LCBlKSA9PiAoe3RvcDogdC50b3AgLSBlLmhlaWdodCwgbGVmdDogdC5sZWZ0LCBuYW1lOiBcIm5lXCJ9KSxcclxuICAgICAgICAgICAgbm9ydGhXZXN0OiAodCwgZSkgPT4gKHt0b3A6IHQuYm90dG9tIC0gZS5oZWlnaHQsIGxlZnQ6IHQubGVmdCAtIGUud2lkdGggKyB0LndpZHRoLCBuYW1lOiBcIm53XCJ9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgT2IuX2dldE9wdGltYWxQb3NpdGlvbiA9IEpwO1xyXG4gICAgICAgIHZhciBJYiA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMTAgMTBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0uOTQxIDQuNTIzYS43NS43NSAwIDEgMSAxLjA2LTEuMDZsMy4wMDYgMy4wMDUgMy4wMDUtMy4wMDVhLjc1Ljc1IDAgMSAxIDEuMDYgMS4wNmwtMy41NDkgMy41NWEuNzUuNzUgMCAwIDEtMS4xNjgtLjEzNkwuOTQxIDQuNTIzelwiLz48L3N2Zz4nO1xyXG5cclxuICAgICAgICBjbGFzcyBWYiBleHRlbmRzIGhiIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFycm93VmlldyA9IHRoaXMuX2NyZWF0ZUFycm93VmlldygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge1wiYXJpYS1oYXNwb3B1cFwiOiB0cnVlfX0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWxlZ2F0ZShcImV4ZWN1dGVcIikudG8odGhpcywgXCJvcGVuXCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQodGhpcy5hcnJvd1ZpZXcpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVBcnJvd1ZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IGNiO1xyXG4gICAgICAgICAgICAgICAgdC5jb250ZW50ID0gSWI7XHJcbiAgICAgICAgICAgICAgICB0LmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFwiY2stZHJvcGRvd25fX2Fycm93XCJ9fSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgTmIgPSBpKDMxKTtcclxuXHJcbiAgICAgICAgY2xhc3MgTWIgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyID0gbmV3IGZiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzID0gbmV3IGRwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIgPSBuZXcgeWIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZXM6IHRoaXMuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNUcmFja2VyOiB0aGlzLmZvY3VzVHJhY2tlcixcclxuICAgICAgICAgICAgICAgICAgICBrZXlzdHJva2VIYW5kbGVyOiB0aGlzLmtleXN0cm9rZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uczoge2ZvY3VzUHJldmlvdXM6IFwiYXJyb3d1cFwiLCBmb2N1c05leHQ6IFwiYXJyb3dkb3duXCJ9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe3RhZzogXCJ1bFwiLCBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stcmVzZXRcIiwgXCJjay1saXN0XCJdfSwgY2hpbGRyZW46IHRoaXMuaXRlbXN9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLml0ZW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIuYWRkKHQuZWxlbWVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMub24oXCJhZGRcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQoZS5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLm9uKFwicmVtb3ZlXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIucmVtb3ZlKGUuZWxlbWVudClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzLmxpc3RlblRvKHRoaXMuZWxlbWVudClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c0N5Y2xlci5mb2N1c0ZpcnN0KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXNMYXN0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIuZm9jdXNMYXN0KClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgQmIgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7dGFnOiBcImxpXCIsIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1saXN0X19pdGVtXCJdfSwgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW59KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uZmlyc3QuZm9jdXMoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB6YiBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHt0YWc6IFwibGlcIiwgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLWxpc3RfX3NlcGFyYXRvclwiXX19KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgTGIgPSBpKDMzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgRmIgZXh0ZW5kcyBoYiB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1RvZ2dsZWFibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVTd2l0Y2hWaWV3ID0gdGhpcy5fY3JlYXRlVG9nZ2xlVmlldygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge2NsYXNzOiBcImNrLXN3aXRjaGJ1dHRvblwifX0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQodGhpcy50b2dnbGVTd2l0Y2hWaWV3KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlVG9nZ2xlVmlldygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgR3A7XHJcbiAgICAgICAgICAgICAgICB0LnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1idXR0b25fX3RvZ2dsZVwiXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt7dGFnOiBcInNwYW5cIiwgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLWJ1dHRvbl9fdG9nZ2xlX19pbm5lclwiXX19XVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBEYih7ZW1pdHRlcjogdCwgYWN0aXZhdG9yOiBlLCBjYWxsYmFjazogaSwgY29udGV4dEVsZW1lbnRzOiBufSkge1xyXG4gICAgICAgICAgICB0Lmxpc3RlblRvKGRvY3VtZW50LCBcIm1vdXNlZG93blwiLCAodCwge3RhcmdldDogb30pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmNvbnRhaW5zKG8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGkoKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGpiID0gaSgzNSk7XHJcbiAgICAgICAgdmFyIEhiID0gaSgzNyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFdiKHQsIGUgPSBWYikge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IGUodCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgRWIodCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgT2IodCwgaSwgbik7XHJcbiAgICAgICAgICAgIGkuYmluZChcImlzRW5hYmxlZFwiKS50byhvKTtcclxuICAgICAgICAgICAgaWYgKGkgaW5zdGFuY2VvZiBWYikge1xyXG4gICAgICAgICAgICAgICAgaS5iaW5kKFwiaXNPblwiKS50byhvLCBcImlzT3BlblwiKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaS5hcnJvd1ZpZXcuYmluZChcImlzT25cIikudG8obywgXCJpc09wZW5cIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkYihvKTtcclxuICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHFiKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQubG9jYWxlO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaS50O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gdC50b29sYmFyVmlldyA9IG5ldyBYYihpKTtcclxuICAgICAgICAgICAgby5zZXQoXCJhcmlhTGFiZWxcIiwgbihcImxnXCIpKTtcclxuICAgICAgICAgICAgdC5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge2NsYXNzOiBbXCJjay10b29sYmFyLWRyb3Bkb3duXCJdfX0pO1xyXG4gICAgICAgICAgICBlLm1hcCh0ID0+IG8uaXRlbXMuYWRkKHQpKTtcclxuICAgICAgICAgICAgdC5wYW5lbFZpZXcuY2hpbGRyZW4uYWRkKG8pO1xyXG4gICAgICAgICAgICBvLml0ZW1zLmRlbGVnYXRlKFwiZXhlY3V0ZVwiKS50byh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVWIodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5sb2NhbGU7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lmxpc3RWaWV3ID0gbmV3IE1iKGkpO1xyXG4gICAgICAgICAgICBuLml0ZW1zLmJpbmRUbyhlKS51c2luZygoe3R5cGU6IHQsIG1vZGVsOiBlfSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgPT09IFwic2VwYXJhdG9yXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHpiKGkpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQgPT09IFwiYnV0dG9uXCIgfHwgdCA9PT0gXCJzd2l0Y2hidXR0b25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgQmIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT09IFwiYnV0dG9uXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG5ldyBoYihpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBuZXcgRmIoaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgby5iaW5kKC4uLk9iamVjdC5rZXlzKGUpKS50byhlKTtcclxuICAgICAgICAgICAgICAgICAgICBvLmRlbGVnYXRlKFwiZXhlY3V0ZVwiKS50byhuKTtcclxuICAgICAgICAgICAgICAgICAgICBuLmNoaWxkcmVuLmFkZChvKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdC5wYW5lbFZpZXcuY2hpbGRyZW4uYWRkKG4pO1xyXG4gICAgICAgICAgICBuLml0ZW1zLmRlbGVnYXRlKFwiZXhlY3V0ZVwiKS50byh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gJGIodCkge1xyXG4gICAgICAgICAgICBHYih0KTtcclxuICAgICAgICAgICAgS2IodCk7XHJcbiAgICAgICAgICAgIEpiKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBHYih0KSB7XHJcbiAgICAgICAgICAgIHQub24oXCJyZW5kZXJcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgRGIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGVtaXR0ZXI6IHQsIGFjdGl2YXRvcjogKCkgPT4gdC5pc09wZW4sIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuaXNPcGVuID0gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9LCBjb250ZXh0RWxlbWVudHM6IFt0LmVsZW1lbnRdXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gS2IodCkge1xyXG4gICAgICAgICAgICB0Lm9uKFwiZXhlY3V0ZVwiLCBlID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlLnNvdXJjZSBpbnN0YW5jZW9mIEZiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0LmlzT3BlbiA9IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBKYih0KSB7XHJcbiAgICAgICAgICAgIHQua2V5c3Ryb2tlcy5zZXQoXCJhcnJvd2Rvd25cIiwgKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmlzT3Blbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucGFuZWxWaWV3LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0LmtleXN0cm9rZXMuc2V0KFwiYXJyb3d1cFwiLCAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXNPcGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5wYW5lbFZpZXcuZm9jdXNMYXN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgWWIgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxjaXJjbGUgY3g9XCI5LjVcIiBjeT1cIjQuNVwiIHI9XCIxLjVcIi8+PGNpcmNsZSBjeD1cIjkuNVwiIGN5PVwiMTAuNVwiIHI9XCIxLjVcIi8+PGNpcmNsZSBjeD1cIjkuNVwiIGN5PVwiMTYuNVwiIHI9XCIxLjVcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgUWIgPSBpKDM5KTtcclxuXHJcbiAgICAgICAgY2xhc3MgWGIgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGUgfHwge307XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImFyaWFMYWJlbFwiLCBuKFwibHJcIikpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJtYXhXaWR0aFwiLCBcImF1dG9cIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlciA9IG5ldyBmYjtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcyA9IG5ldyBkcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiY2xhc3NcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzQ29tcGFjdFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zVmlldyA9IG5ldyBaYih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uYWRkKHRoaXMuaXRlbXNWaWV3KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNhYmxlcyA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIgPSBuZXcgeWIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZXM6IHRoaXMuZm9jdXNhYmxlcyxcclxuICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrZXI6IHRoaXMuZm9jdXNUcmFja2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGtleXN0cm9rZUhhbmRsZXI6IHRoaXMua2V5c3Ryb2tlcyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiB7Zm9jdXNQcmV2aW91czogW1wiYXJyb3dsZWZ0XCIsIFwiYXJyb3d1cFwiXSwgZm9jdXNOZXh0OiBbXCJhcnJvd3JpZ2h0XCIsIFwiYXJyb3dkb3duXCJdfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay10b29sYmFyXCIsIGkudG8oXCJjbGFzc1wiKSwgaS5pZihcImlzQ29tcGFjdFwiLCBcImNrLXRvb2xiYXJfY29tcGFjdFwiKV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IFwidG9vbGJhclwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFyaWEtbGFiZWxcIjogaS50byhcImFyaWFMYWJlbFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHttYXhXaWR0aDogaS50byhcIm1heFdpZHRoXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW4sXHJcbiAgICAgICAgICAgICAgICAgICAgb246IHttb3VzZWRvd246IFNiKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iZWhhdmlvciA9IHRoaXMub3B0aW9ucy5zaG91bGRHcm91cFdoZW5GdWxsID8gbmV3IGV3KHRoaXMpIDogbmV3IHR3KHRoaXMpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodC5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5vbihcImFkZFwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZChlLmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMub24oXCJyZW1vdmVcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5yZW1vdmUoZS5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JlaGF2aW9yLnJlbmRlcih0aGlzKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmVoYXZpb3IuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmRlc3Ryb3koKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyLmZvY3VzRmlyc3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1c0xhc3QoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c0N5Y2xlci5mb2N1c0xhc3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmaWxsRnJvbUNvbmZpZyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0Lm1hcCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSBcInxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLmFkZChuZXcgQ2IpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLmFkZChlLmNyZWF0ZSh0KSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oT2JqZWN0KHNzW1wiYVwiXSkoXCJ0b29sYmFydmlldy1pdGVtLXVuYXZhaWxhYmxlOiBUaGUgcmVxdWVzdGVkIHRvb2xiYXIgaXRlbSBpcyB1bmF2YWlsYWJsZS5cIiksIHtuYW1lOiB0fSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBaYiBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLXRvb2xiYXJfX2l0ZW1zXCJdfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5jaGlsZHJlblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdHcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0LnNldChcImlzVmVydGljYWxcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdC5pdGVtc1ZpZXcuY2hpbGRyZW4uYmluZFRvKHQuaXRlbXMpLnVzaW5nKHQgPT4gdCk7XHJcbiAgICAgICAgICAgICAgICB0LmZvY3VzYWJsZXMuYmluZFRvKHQuaXRlbXMpLnVzaW5nKHQgPT4gdCk7XHJcbiAgICAgICAgICAgICAgICB0LmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFtlLmlmKFwiaXNWZXJ0aWNhbFwiLCBcImNrLXRvb2xiYXJfdmVydGljYWxcIildfX0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZXcge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdDaGlsZHJlbiA9IHQuY2hpbGRyZW47XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdGb2N1c2FibGVzID0gdC5mb2N1c2FibGVzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3SXRlbXNWaWV3ID0gdC5pdGVtc1ZpZXc7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdGb2N1c1RyYWNrZXIgPSB0LmZvY3VzVHJhY2tlcjtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlld0xvY2FsZSA9IHQubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bmdyb3VwZWRJdGVtcyA9IHQuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncm91cGVkSXRlbXMgPSB0LmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBlZEl0ZW1zRHJvcGRvd24gPSB0aGlzLl9jcmVhdGVHcm91cGVkSXRlbXNEcm9wZG93bigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemVPYnNlcnZlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlZFBhZGRpbmcgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdC5pdGVtc1ZpZXcuY2hpbGRyZW4uYmluZFRvKHRoaXMudW5ncm91cGVkSXRlbXMpLnVzaW5nKHQgPT4gdCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVuZ3JvdXBlZEl0ZW1zLm9uKFwiYWRkXCIsIHRoaXMuX3VwZGF0ZUZvY3VzQ3ljbGVhYmxlSXRlbXMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVuZ3JvdXBlZEl0ZW1zLm9uKFwicmVtb3ZlXCIsIHRoaXMuX3VwZGF0ZUZvY3VzQ3ljbGVhYmxlSXRlbXMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB0LmNoaWxkcmVuLm9uKFwiYWRkXCIsIHRoaXMuX3VwZGF0ZUZvY3VzQ3ljbGVhYmxlSXRlbXMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB0LmNoaWxkcmVuLm9uKFwicmVtb3ZlXCIsIHRoaXMuX3VwZGF0ZUZvY3VzQ3ljbGVhYmxlSXRlbXMuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICB0Lml0ZW1zLm9uKFwiYWRkXCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPiB0aGlzLnVuZ3JvdXBlZEl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyb3VwZWRJdGVtcy5hZGQoZSwgaSAtIHRoaXMudW5ncm91cGVkSXRlbXMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudW5ncm91cGVkSXRlbXMuYWRkKGUsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUdyb3VwaW5nKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5pdGVtcy5vbihcInJlbW92ZVwiLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpID4gdGhpcy51bmdyb3VwZWRJdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ncm91cGVkSXRlbXMucmVtb3ZlKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51bmdyb3VwZWRJdGVtcy5yZW1vdmUoZSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlR3JvdXBpbmcoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrLXRvb2xiYXJfZ3JvdXBpbmdcIl19fSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVuZGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlld0VsZW1lbnQgPSB0LmVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbmFibGVHcm91cGluZ09uUmVzaXplKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lbmFibGVHcm91cGluZ09uTWF4V2lkdGhDaGFuZ2UodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBlZEl0ZW1zRHJvcGRvd24uZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpemVPYnNlcnZlci5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZUdyb3VwaW5nKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnZpZXdFbGVtZW50Lm93bmVyRG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLnZpZXdFbGVtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHQ7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5fYXJlSXRlbXNPdmVyZmxvd2luZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2dyb3VwTGFzdEl0ZW0oKTtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0ICYmIHRoaXMuZ3JvdXBlZEl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmdyb3VwZWRJdGVtcy5sZW5ndGggJiYgIXRoaXMuX2FyZUl0ZW1zT3ZlcmZsb3dpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdW5ncm91cEZpcnN0SXRlbSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hcmVJdGVtc092ZXJmbG93aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2dyb3VwTGFzdEl0ZW0oKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9hcmVJdGVtc092ZXJmbG93aW5nKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLnVuZ3JvdXBlZEl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMudmlld0VsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy52aWV3TG9jYWxlLnVpTGFuZ3VhZ2VEaXJlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IHZoKHQubGFzdENoaWxkKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgdmgodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FjaGVkUGFkZGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBJZC53aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZSA9PT0gXCJsdHJcIiA/IFwicGFkZGluZ1JpZ2h0XCIgOiBcInBhZGRpbmdMZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZWRQYWRkaW5nID0gTnVtYmVyLnBhcnNlSW50KGlbbl0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZSA9PT0gXCJsdHJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpLnJpZ2h0ID4gbi5yaWdodCAtIHRoaXMuY2FjaGVkUGFkZGluZ1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaS5sZWZ0IDwgbi5sZWZ0ICsgdGhpcy5jYWNoZWRQYWRkaW5nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9lbmFibGVHcm91cGluZ09uUmVzaXplKCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2l6ZU9ic2VydmVyID0gbmV3IFRiKHRoaXMudmlld0VsZW1lbnQsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdCB8fCB0ICE9PSBlLmNvbnRlbnRSZWN0LndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUdyb3VwaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBlLmNvbnRlbnRSZWN0LndpZHRoXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVHcm91cGluZygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9lbmFibGVHcm91cGluZ09uTWF4V2lkdGhDaGFuZ2UodCkge1xyXG4gICAgICAgICAgICAgICAgdC5vbihcImNoYW5nZTptYXhXaWR0aFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlR3JvdXBpbmcoKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dyb3VwTGFzdEl0ZW0oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ3JvdXBlZEl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0NoaWxkcmVuLmFkZChuZXcgQ2IpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0NoaWxkcmVuLmFkZCh0aGlzLmdyb3VwZWRJdGVtc0Ryb3Bkb3duKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdGb2N1c1RyYWNrZXIuYWRkKHRoaXMuZ3JvdXBlZEl0ZW1zRHJvcGRvd24uZWxlbWVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JvdXBlZEl0ZW1zLmFkZCh0aGlzLnVuZ3JvdXBlZEl0ZW1zLnJlbW92ZSh0aGlzLnVuZ3JvdXBlZEl0ZW1zLmxhc3QpLCAwKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdW5ncm91cEZpcnN0SXRlbSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudW5ncm91cGVkSXRlbXMuYWRkKHRoaXMuZ3JvdXBlZEl0ZW1zLnJlbW92ZSh0aGlzLmdyb3VwZWRJdGVtcy5maXJzdCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmdyb3VwZWRJdGVtcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdDaGlsZHJlbi5yZW1vdmUodGhpcy5ncm91cGVkSXRlbXNEcm9wZG93bik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3Q2hpbGRyZW4ucmVtb3ZlKHRoaXMudmlld0NoaWxkcmVuLmxhc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0ZvY3VzVHJhY2tlci5yZW1vdmUodGhpcy5ncm91cGVkSXRlbXNEcm9wZG93bi5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlR3JvdXBlZEl0ZW1zRHJvcGRvd24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy52aWV3TG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBXYih0KTtcclxuICAgICAgICAgICAgICAgIGkuY2xhc3MgPSBcImNrLXRvb2xiYXJfX2dyb3VwZWQtZHJvcGRvd25cIjtcclxuICAgICAgICAgICAgICAgIGkucGFuZWxQb3NpdGlvbiA9IHQudWlMYW5ndWFnZURpcmVjdGlvbiA9PT0gXCJsdHJcIiA/IFwic3dcIiA6IFwic2VcIjtcclxuICAgICAgICAgICAgICAgIHFiKGksIFtdKTtcclxuICAgICAgICAgICAgICAgIGkuYnV0dG9uVmlldy5zZXQoe2xhYmVsOiBlKFwibHNcIiksIHRvb2x0aXA6IHRydWUsIGljb246IFlifSk7XHJcbiAgICAgICAgICAgICAgICBpLnRvb2xiYXJWaWV3Lml0ZW1zLmJpbmRUbyh0aGlzLmdyb3VwZWRJdGVtcykudXNpbmcodCA9PiB0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91cGRhdGVGb2N1c0N5Y2xlYWJsZUl0ZW1zKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3Rm9jdXNhYmxlcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bmdyb3VwZWRJdGVtcy5tYXAodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3Rm9jdXNhYmxlcy5hZGQodClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ3JvdXBlZEl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld0ZvY3VzYWJsZXMuYWRkKHRoaXMuZ3JvdXBlZEl0ZW1zRHJvcGRvd24pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGl3KHQpIHtcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7aXRlbXM6IHR9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge2l0ZW1zOiBbXX1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7aXRlbXM6IFtdfSwgdClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IG53ID0gWnAoXCJweFwiKTtcclxuXHJcbiAgICAgICAgY2xhc3Mgb3cgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkJhbGxvb25Ub29sYmFyXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBba2JdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbkNvbmZpZyA9IGl3KHQuY29uZmlnLmdldChcImJhbGxvb25Ub29sYmFyXCIpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9vbGJhclZpZXcgPSB0aGlzLl9jcmVhdGVUb29sYmFyVmlldygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIgPSBuZXcgZmI7XHJcbiAgICAgICAgICAgICAgICB0LnVpLm9uY2UoXCJyZWFkeVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIuYWRkKHQudWkuZ2V0RWRpdGFibGVFbGVtZW50KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZCh0aGlzLnRvb2xiYXJWaWV3LmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24gPSB0LnBsdWdpbnMuZ2V0KGtiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVTZWxlY3Rpb25DaGFuZ2VEZWJvdW5jZWQgPSB1aCgoKSA9PiB0aGlzLmZpcmUoXCJfc2VsZWN0aW9uQ2hhbmdlRGVib3VuY2VkXCIpLCAyMDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0ZShcInNob3dcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5mb2N1c1RyYWNrZXIsIFwiY2hhbmdlOmlzRm9jdXNlZFwiLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9iYWxsb29uLnZpc2libGVWaWV3ID09PSB0aGlzLnRvb2xiYXJWaWV3O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaSAmJiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwiY2hhbmdlOnJhbmdlXCIsICh0LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuZGlyZWN0Q2hhbmdlIHx8IGUuaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlyZVNlbGVjdGlvbkNoYW5nZURlYm91bmNlZCgpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcywgXCJfc2VsZWN0aW9uQ2hhbmdlRGVib3VuY2VkXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lZGl0b3IuZWRpdGluZy52aWV3LmRvY3VtZW50LmlzRm9jdXNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3coKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9iYWxsb29uQ29uZmlnLnNob3VsZE5vdEdyb3VwV2hlbkZ1bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQsIFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC51aS52aWV3LmVkaXRhYmxlLmVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyID0gbmV3IFRiKGUsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9vbGJhclZpZXcubWF4V2lkdGggPSBudyhuZXcgdmgoZSkud2lkdGggKiAuOSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZnRlckluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IudWkuY29tcG9uZW50RmFjdG9yeTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9vbGJhclZpZXcuZmlsbEZyb21Db25maWcodGhpcy5fYmFsbG9vbkNvbmZpZy5pdGVtcywgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVRvb2xiYXJWaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9ICF0aGlzLl9iYWxsb29uQ29uZmlnLnNob3VsZE5vdEdyb3VwV2hlbkZ1bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFhiKHRoaXMuZWRpdG9yLmxvY2FsZSwge3Nob3VsZEdyb3VwV2hlbkZ1bGw6IHR9KTtcclxuICAgICAgICAgICAgICAgIGUuZXh0ZW5kVGVtcGxhdGUoe2F0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2stdG9vbGJhcl9mbG9hdGluZ1wiXX19KTtcclxuICAgICAgICAgICAgICAgIGUucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzaG93KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JhbGxvb24uaGFzVmlldyh0aGlzLnRvb2xiYXJWaWV3KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuZnJvbSh0aGlzLnRvb2xiYXJWaWV3Lml0ZW1zKS5ldmVyeSh0ID0+IHQuaXNFbmFibGVkICE9PSB1bmRlZmluZWQgJiYgIXQuaXNFbmFibGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLmVkaXRvci51aSwgXCJ1cGRhdGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24udXBkYXRlUG9zaXRpb24odGhpcy5fZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSgpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uLmFkZCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzogdGhpcy50b29sYmFyVmlldyxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogdGhpcy5fZ2V0QmFsbG9vblBvc2l0aW9uRGF0YSgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhbGxvb25DbGFzc05hbWU6IFwiY2stdG9vbGJhci1jb250YWluZXJcIlxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGlkZSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iYWxsb29uLmhhc1ZpZXcodGhpcy50b29sYmFyVmlldykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5lZGl0b3IudWksIFwidXBkYXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24ucmVtb3ZlKHRoaXMudG9vbGJhclZpZXcpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRCYWxsb29uUG9zaXRpb25EYXRhKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZWRpdGluZy52aWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5zZWxlY3Rpb24uaXNCYWNrd2FyZDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBvID8gbi5nZXRGaXJzdFJhbmdlKCkgOiBuLmdldExhc3RSYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdmguZ2V0RG9tUmFuZ2VSZWN0cyhlLmRvbUNvbnZlcnRlci52aWV3UmFuZ2VUb0RvbSh0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVswXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkubGVuZ3RoID4gMSAmJiBpW2kubGVuZ3RoIC0gMV0ud2lkdGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnBvcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVtpLmxlbmd0aCAtIDFdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCBwb3NpdGlvbnM6IHJ3KG8pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcmVTZWxlY3Rpb25DaGFuZ2VEZWJvdW5jZWQuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvb2xiYXJWaWV3LmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZXNpemVPYnNlcnZlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZU9ic2VydmVyLmRlc3Ryb3koKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBydyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuYi5kZWZhdWx0UG9zaXRpb25zO1xyXG4gICAgICAgICAgICByZXR1cm4gdCA/IFtlLm5vcnRoV2VzdEFycm93U291dGgsIGUubm9ydGhXZXN0QXJyb3dTb3V0aFdlc3QsIGUubm9ydGhXZXN0QXJyb3dTb3V0aEVhc3QsIGUubm9ydGhXZXN0QXJyb3dTb3V0aE1pZGRsZUVhc3QsIGUubm9ydGhXZXN0QXJyb3dTb3V0aE1pZGRsZVdlc3QsIGUuc291dGhXZXN0QXJyb3dOb3J0aCwgZS5zb3V0aFdlc3RBcnJvd05vcnRoV2VzdCwgZS5zb3V0aFdlc3RBcnJvd05vcnRoRWFzdCwgZS5zb3V0aFdlc3RBcnJvd05vcnRoTWlkZGxlV2VzdCwgZS5zb3V0aFdlc3RBcnJvd05vcnRoTWlkZGxlRWFzdF0gOiBbZS5zb3V0aEVhc3RBcnJvd05vcnRoLCBlLnNvdXRoRWFzdEFycm93Tm9ydGhFYXN0LCBlLnNvdXRoRWFzdEFycm93Tm9ydGhXZXN0LCBlLnNvdXRoRWFzdEFycm93Tm9ydGhNaWRkbGVFYXN0LCBlLnNvdXRoRWFzdEFycm93Tm9ydGhNaWRkbGVXZXN0LCBlLm5vcnRoRWFzdEFycm93U291dGgsIGUubm9ydGhFYXN0QXJyb3dTb3V0aEVhc3QsIGUubm9ydGhFYXN0QXJyb3dTb3V0aFdlc3QsIGUubm9ydGhFYXN0QXJyb3dTb3V0aE1pZGRsZUVhc3QsIGUubm9ydGhFYXN0QXJyb3dTb3V0aE1pZGRsZVdlc3RdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBzdyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbXBvbmVudHMgPSBuZXcgTWFwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogbmFtZXMoKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fY29tcG9uZW50cy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIHQub3JpZ2luYWxOYW1lXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiY29tcG9uZW50ZmFjdG9yeS1pdGVtLWV4aXN0czogVGhlIGl0ZW0gYWxyZWFkeSBleGlzdHMgaW4gdGhlIGNvbXBvbmVudCBmYWN0b3J5LlwiLCB0aGlzLCB7bmFtZTogdH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb21wb25lbnRzLnNldChhdyh0KSwge2NhbGxiYWNrOiBlLCBvcmlnaW5hbE5hbWU6IHR9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJjb21wb25lbnRmYWN0b3J5LWl0ZW0tbWlzc2luZzogVGhlIHJlcXVpcmVkIGNvbXBvbmVudCBpcyBub3QgcmVnaXN0ZXJlZCBpbiB0aGUgZmFjdG9yeS5cIiwgdGhpcywge25hbWU6IHR9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbXBvbmVudHMuZ2V0KGF3KHQpKS5jYWxsYmFjayh0aGlzLmVkaXRvci5sb2NhbGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGhhcyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29tcG9uZW50cy5oYXMoYXcodCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGF3KHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh0KS50b0xvd2VyQ2FzZSgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBjdyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50RmFjdG9yeSA9IG5ldyBzdyh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyID0gbmV3IGZiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWRpdGFibGVFbGVtZW50c01hcCA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQuZWRpdGluZy52aWV3LmRvY3VtZW50LCBcImxheW91dENoYW5nZWRcIiwgKCkgPT4gdGhpcy51cGRhdGUoKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGVsZW1lbnQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1cGRhdGUoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJ1cGRhdGVcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX2VkaXRhYmxlRWxlbWVudHNNYXAudmFsdWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmNrZWRpdG9ySW5zdGFuY2UgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9lZGl0YWJsZUVsZW1lbnRzTWFwID0gbmV3IE1hcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRFZGl0YWJsZUVsZW1lbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWRpdGFibGVFbGVtZW50c01hcC5zZXQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUuY2tlZGl0b3JJbnN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuY2tlZGl0b3JJbnN0YW5jZSA9IHRoaXMuZWRpdG9yXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldEVkaXRhYmxlRWxlbWVudCh0ID0gXCJtYWluXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9lZGl0YWJsZUVsZW1lbnRzTWFwLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRFZGl0YWJsZUVsZW1lbnRzTmFtZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZWRpdGFibGVFbGVtZW50c01hcC5rZXlzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9lZGl0YWJsZUVsZW1lbnRzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiZWRpdG9yLXVpLWRlcHJlY2F0ZWQtZWRpdGFibGUtZWxlbWVudHM6IFwiICsgXCJUaGUgRWRpdG9yVUkjX2VkaXRhYmxlRWxlbWVudHMgcHJvcGVydHkgaGFzIGJlZW4gZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZWFyIGZ1dHVyZS5cIiwge2VkaXRvclVJOiB0aGlzfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZWRpdGFibGVFbGVtZW50c01hcFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhjdywgZHMpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBsdyh7b3JpZ2luOiB0LCBvcmlnaW5LZXlzdHJva2VIYW5kbGVyOiBlLCBvcmlnaW5Gb2N1c1RyYWNrZXI6IGksIHRvb2xiYXI6IG4sIGJlZm9yZUZvY3VzOiBvLCBhZnRlckJsdXI6IHJ9KSB7XHJcbiAgICAgICAgICAgIGkuYWRkKG4uZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGUuc2V0KFwiQWx0K0YxMFwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuaXNGb2N1c2VkICYmICFuLmZvY3VzVHJhY2tlci5pc0ZvY3VzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbi5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbi5rZXlzdHJva2VzLnNldChcIkVzY1wiLCAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4uZm9jdXNUcmFja2VyLmlzRm9jdXNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZHcgPSBpKDQxKTtcclxuICAgICAgICBjb25zdCB1dyA9IG5ldyBXZWFrTWFwO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBodyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHt2aWV3OiBlLCBlbGVtZW50OiBpLCB0ZXh0OiBuLCBpc0RpcmVjdEhvc3Q6IG8gPSB0cnVlfSA9IHQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBlLmRvY3VtZW50O1xyXG4gICAgICAgICAgICBpZiAoIXV3LmhhcyhyKSkge1xyXG4gICAgICAgICAgICAgICAgdXcuc2V0KHIsIG5ldyBNYXApO1xyXG4gICAgICAgICAgICAgICAgci5yZWdpc3RlclBvc3RGaXhlcih0ID0+IGJ3KHIsIHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHV3LmdldChyKS5zZXQoaSwge3RleHQ6IG4sIGlzRGlyZWN0SG9zdDogb30pO1xyXG4gICAgICAgICAgICBlLmNoYW5nZSh0ID0+IGJ3KHIsIHQpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZncodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZS5kb2N1bWVudDtcclxuICAgICAgICAgICAgdC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXV3LmhhcyhpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHV3LmdldChpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLmdldChlKTtcclxuICAgICAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wbGFjZWhvbGRlclwiLCBvLmhvc3RFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIG13KHQsIG8uaG9zdEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgbi5kZWxldGUoZSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGd3KHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKCFlLmhhc0NsYXNzKFwiY2stcGxhY2Vob2xkZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIHQuYWRkQ2xhc3MoXCJjay1wbGFjZWhvbGRlclwiLCBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtdyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmhhc0NsYXNzKFwiY2stcGxhY2Vob2xkZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIHQucmVtb3ZlQ2xhc3MoXCJjay1wbGFjZWhvbGRlclwiLCBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBwdyh0KSB7XHJcbiAgICAgICAgICAgIGlmICghdC5pc0F0dGFjaGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSAhQXJyYXkuZnJvbSh0LmdldENoaWxkcmVuKCkpLnNvbWUodCA9PiAhdC5pcyhcInVpRWxlbWVudFwiKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmRvY3VtZW50O1xyXG4gICAgICAgICAgICBpZiAoIWkuaXNGb2N1c2VkICYmIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbiA9IGkuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICBjb25zdCBvID0gbi5hbmNob3I7XHJcbiAgICAgICAgICAgIGlmIChlICYmIG8gJiYgby5wYXJlbnQgIT09IHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBidyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB1dy5nZXQodCk7XHJcbiAgICAgICAgICAgIGxldCBuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgW3QsIG9dIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh3dyhlLCB0LCBvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHd3KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3Qge3RleHQ6IG4sIGlzRGlyZWN0SG9zdDogb30gPSBpO1xyXG4gICAgICAgICAgICBjb25zdCByID0gbyA/IGUgOiBrdyhlKTtcclxuICAgICAgICAgICAgbGV0IHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKCFyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpLmhvc3RFbGVtZW50ID0gcjtcclxuICAgICAgICAgICAgaWYgKHIuZ2V0QXR0cmlidXRlKFwiZGF0YS1wbGFjZWhvbGRlclwiKSAhPT0gbikge1xyXG4gICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXBsYWNlaG9sZGVyXCIsIG4sIHIpO1xyXG4gICAgICAgICAgICAgICAgcyA9IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocHcocikpIHtcclxuICAgICAgICAgICAgICAgIGlmIChndyh0LCByKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHMgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobXcodCwgcikpIHtcclxuICAgICAgICAgICAgICAgIHMgPSB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGt3KHQpIHtcclxuICAgICAgICAgICAgaWYgKHQuY2hpbGRDb3VudCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0Q2hpbGQoMCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5pcyhcImVsZW1lbnRcIikgJiYgIWUuaXMoXCJ1aUVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBfdyBleHRlbmRzIGN3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcgPSBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBlbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmlldy5lZGl0YWJsZS5lbGVtZW50XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy52aWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGx1Z2lucy5nZXQoXCJCYWxsb29uVG9vbGJhclwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLmVkaXRhYmxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4uZG9jdW1lbnQuZ2V0Um9vdCgpO1xyXG4gICAgICAgICAgICAgICAgby5uYW1lID0gci5yb290TmFtZTtcclxuICAgICAgICAgICAgICAgIGUucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gby5lbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRFZGl0YWJsZUVsZW1lbnQoby5uYW1lLCBzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZChzKTtcclxuICAgICAgICAgICAgICAgIG8uYmluZChcImlzRm9jdXNlZFwiKS50byh0aGlzLmZvY3VzVHJhY2tlcik7XHJcbiAgICAgICAgICAgICAgICBuLmF0dGFjaERvbVJvb3Qocyk7XHJcbiAgICAgICAgICAgICAgICBsdyh7XHJcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luOiBuLFxyXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbkZvY3VzVHJhY2tlcjogdGhpcy5mb2N1c1RyYWNrZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luS2V5c3Ryb2tlSGFuZGxlcjogdC5rZXlzdHJva2VzLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvb2xiYXI6IGkudG9vbGJhclZpZXcsXHJcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlRm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBhZnRlckJsdXIoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuaGlkZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbml0UGxhY2Vob2xkZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcInJlYWR5XCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy52aWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGUuZGV0YWNoRG9tUm9vdCh0LmVkaXRhYmxlLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgdC5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2luaXRQbGFjZWhvbGRlcigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50LmdldFJvb3QoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnNvdXJjZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5jb25maWcuZ2V0KFwicGxhY2Vob2xkZXJcIikgfHwgbiAmJiBuLnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0ZXh0YXJlYVwiICYmIG4uZ2V0QXR0cmlidXRlKFwicGxhY2Vob2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIGh3KHt2aWV3OiBlLCBlbGVtZW50OiBpLCB0ZXh0OiBvLCBpc0RpcmVjdEhvc3Q6IGZhbHNlfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHZ3ID0gXCJbb2JqZWN0IFN0cmluZ11cIjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24geXcodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHQgPT0gXCJzdHJpbmdcIiB8fCAhSmUodCkgJiYgVCh0KSAmJiBfKHQpID09IHZ3XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgeHcgPSB5dztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ3codCwgZSwgaSA9IHt9LCBuID0gW10pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGkgJiYgaS54bWxucztcclxuICAgICAgICAgICAgY29uc3QgciA9IG8gPyB0LmNyZWF0ZUVsZW1lbnROUyhvLCBlKSA6IHQuY3JlYXRlRWxlbWVudChlKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IGluIGkpIHtcclxuICAgICAgICAgICAgICAgIHIuc2V0QXR0cmlidXRlKHQsIGlbdF0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHh3KG4pIHx8ICFqcyhuKSkge1xyXG4gICAgICAgICAgICAgICAgbiA9IFtuXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAobGV0IGUgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHh3KGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQuY3JlYXRlVGV4dE5vZGUoZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHIuYXBwZW5kQ2hpbGQoZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gclxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgQXcgZXh0ZW5kcyBicCB7XHJcbiAgICAgICAgICAgIGF0dGFjaFRvRG9tKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keUNvbGxlY3Rpb25Db250YWluZXIgPSBuZXcgX3Aoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBbXCJja1wiLCBcImNrLXJlc2V0X2FsbFwiLCBcImNrLWJvZHlcIiwgXCJjay1yb3VuZGVkLWNvcm5lcnNcIl0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpcjogdGhpcy5sb2NhbGUudWlMYW5ndWFnZURpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXNcclxuICAgICAgICAgICAgICAgIH0pLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNrLWJvZHktd3JhcHBlclwiKTtcclxuICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQgPSBDdyhkb2N1bWVudCwgXCJkaXZcIiwge2NsYXNzOiBcImNrLWJvZHktd3JhcHBlclwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdC5hcHBlbmRDaGlsZCh0aGlzLl9ib2R5Q29sbGVjdGlvbkNvbnRhaW5lcilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGV0YWNoRnJvbURvbSgpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5Q29sbGVjdGlvbkNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JvZHlDb2xsZWN0aW9uQ29udGFpbmVyLnJlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jay1ib2R5LXdyYXBwZXJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAodCAmJiB0LmNoaWxkRWxlbWVudENvdW50ID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBUdyA9IGkoNDMpO1xyXG5cclxuICAgICAgICBjbGFzcyBQdyBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkgPSBuZXcgQXcodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVuZGVyKCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkuYXR0YWNoVG9Eb20oKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5LmRldGFjaEZyb21Eb20oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgU3cgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFtcImNrXCIsIFwiY2stY29udGVudFwiLCBcImNrLWVkaXRvcl9fZWRpdGFibGVcIiwgXCJjay1yb3VuZGVkLWNvcm5lcnNcIl0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhbmc6IHQuY29udGVudExhbmd1YWdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXI6IHQuY29udGVudExhbmd1YWdlRGlyZWN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0ZvY3VzZWRcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWRpdGFibGVFbGVtZW50ID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2hhc0V4dGVybmFsRWxlbWVudCA9ICEhdGhpcy5fZWRpdGFibGVFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZWRpdGluZ1ZpZXcgPSBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0V4dGVybmFsRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcGxhdGUuYXBwbHkodGhpcy5lbGVtZW50ID0gdGhpcy5fZWRpdGFibGVFbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lZGl0YWJsZUVsZW1lbnQgPSB0aGlzLmVsZW1lbnRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJjaGFuZ2U6aXNGb2N1c2VkXCIsICgpID0+IHRoaXMuX3VwZGF0ZUlzRm9jdXNlZENsYXNzZXMoKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVJc0ZvY3VzZWRDbGFzc2VzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNFeHRlcm5hbEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlLnJldmVydCh0aGlzLl9lZGl0YWJsZUVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzdXBlci5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZUlzRm9jdXNlZENsYXNzZXMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fZWRpdGluZ1ZpZXc7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5pc1JlbmRlcmluZ0luUHJvZ3Jlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpKHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUodGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBlKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmNoYW5nZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZG9jdW1lbnQuZ2V0Um9vdChlLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmFkZENsYXNzKGUuaXNGb2N1c2VkID8gXCJjay1mb2N1c2VkXCIgOiBcImNrLWJsdXJyZWRcIiwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucmVtb3ZlQ2xhc3MoZS5pc0ZvY3VzZWQgPyBcImNrLWJsdXJyZWRcIiA6IFwiY2stZm9jdXNlZFwiLCBuKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaShuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbmNlKFwiY2hhbmdlOmlzUmVuZGVyaW5nSW5Qcm9ncmVzc1wiLCAodCwgbywgcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUobilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkobilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEV3IGV4dGVuZHMgU3cge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBlLCBpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW5kVGVtcGxhdGUoe2F0dHJpYnV0ZXM6IHtyb2xlOiBcInRleHRib3hcIiwgY2xhc3M6IFwiY2stZWRpdG9yX19lZGl0YWJsZV9pbmxpbmVcIn19KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9lZGl0aW5nVmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICB0LmNoYW5nZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5kb2N1bWVudC5nZXRSb290KHRoaXMubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIGUoXCJvZlwiLCBbdGhpcy5uYW1lXSksIG4pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBSdyBleHRlbmRzIFB3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRhYmxlID0gbmV3IEV3KHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlckNoaWxkKHRoaXMuZWRpdGFibGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE93KHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBIVE1MVGV4dEFyZWFFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICB0LnZhbHVlID0gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQuaW5uZXJIVE1MID0gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSXcodCkge1xyXG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LnZhbHVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHQuaW5uZXJIVE1MXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBWdyA9IHtcclxuICAgICAgICAgICAgc2V0RGF0YSh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEuc2V0KHQpXHJcbiAgICAgICAgICAgIH0sIGdldERhdGEodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5nZXQodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIE53ID0gVnc7XHJcbiAgICAgICAgY29uc3QgTXcgPSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVNvdXJjZUVsZW1lbnQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc291cmNlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJlZGl0b3ItbWlzc2luZy1zb3VyY2VlbGVtZW50OiBDYW5ub3QgdXBkYXRlIHRoZSBzb3VyY2UgZWxlbWVudCBvZiBhIGRldGFjaGVkIGVkaXRvci5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE93KHRoaXMuc291cmNlRWxlbWVudCwgdGhpcy5kYXRhLmdldCgpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgQncgPSBNdztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gencodCkge1xyXG4gICAgICAgICAgICBpZiAoIWd0KHQudXBkYXRlU291cmNlRWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJhdHRhY2h0b2Zvcm0tbWlzc2luZy1lbGVtZW50YXBpLWludGVyZmFjZTogRWRpdG9yIHBhc3NlZCB0byBhdHRhY2hUb0Zvcm0oKSBtdXN0IGltcGxlbWVudCBFbGVtZW50QXBpLlwiLCB0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnNvdXJjZUVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcInRleHRhcmVhXCIgJiYgZS5mb3JtKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmZvcm07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gKCkgPT4gdC51cGRhdGVTb3VyY2VFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZ3Qobi5zdWJtaXQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IG4uc3VibWl0O1xyXG4gICAgICAgICAgICAgICAgICAgIG4uc3VibWl0ID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuYXBwbHkobilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgbyk7XHJcbiAgICAgICAgICAgICAgICB0Lm9uKFwiZGVzdHJveVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4uc3VibWl0ID0gaVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEx3KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuc291cmNlRWxlbWVudDtcclxuICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZS5ja2VkaXRvckluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiZWRpdG9yLXNvdXJjZS1lbGVtZW50LWFscmVhZHktdXNlZDogXCIgKyBcIlRoZSBET00gZWxlbWVudCBjYW5ub3QgYmUgdXNlZCB0byBjcmVhdGUgbXVsdGlwbGUgZWRpdG9yIGluc3RhbmNlcy5cIiwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlLmNrZWRpdG9ySW5zdGFuY2UgPSB0O1xyXG4gICAgICAgICAgICB0Lm9uY2UoXCJkZXN0cm95XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBlLmNrZWRpdG9ySW5zdGFuY2VcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEZ3IGV4dGVuZHMgaHAge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcihlKTtcclxuICAgICAgICAgICAgICAgIGlmIChLcih0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc291cmNlRWxlbWVudCA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgTHcodGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmNvbmZpZy5nZXQoXCJwbHVnaW5zXCIpO1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKG93KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29uZmlnLnNldChcInBsdWdpbnNcIiwgaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZy5kZWZpbmUoXCJiYWxsb29uVG9vbGJhclwiLCB0aGlzLmNvbmZpZy5nZXQoXCJ0b29sYmFyXCIpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5wcm9jZXNzb3IgPSBuZXcgZ3AodGhpcy5kYXRhLnZpZXdEb2N1bWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmRvY3VtZW50LmNyZWF0ZVJvb3QoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgUncodGhpcy5sb2NhbGUsIHRoaXMuZWRpdGluZy52aWV3LCB0aGlzLnNvdXJjZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51aSA9IG5ldyBfdyh0aGlzLCBuKTtcclxuICAgICAgICAgICAgICAgIHp3KHRoaXMpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXREYXRhKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVpLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdXBlci5kZXN0cm95KCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBPdyh0aGlzLnNvdXJjZUVsZW1lbnQsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGNyZWF0ZSh0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gS3IodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gJiYgdC50YWdOYW1lID09PSBcIlRFWFRBUkVBXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcImVkaXRvci13cm9uZy1lbGVtZW50OiBUaGlzIHR5cGUgb2YgZWRpdG9yIGNhbm5vdCBiZSBpbml0aWFsaXplZCBpbnNpZGUgPHRleHRhcmVhPiBlbGVtZW50LlwiLCBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IHRoaXModCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaShvLmluaXRQbHVnaW5zKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8udWkuaW5pdCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbiAmJiBlLmluaXRpYWxEYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiZWRpdG9yLWNyZWF0ZS1pbml0aWFsLWRhdGE6IFwiICsgXCJUaGUgY29uZmlnLmluaXRpYWxEYXRhIG9wdGlvbiBjYW5ub3QgYmUgdXNlZCB0b2dldGhlciB3aXRoIGluaXRpYWwgZGF0YSBwYXNzZWQgaW4gRWRpdG9yLmNyZWF0ZSgpLlwiLCBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmluaXRpYWxEYXRhIHx8IER3KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gby5kYXRhLmluaXQoaSlcclxuICAgICAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IG8uZmlyZShcInJlYWR5XCIpKS50aGVuKCgpID0+IG8pKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoRncsIE53KTtcclxuICAgICAgICB2cyhGdywgQncpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBEdyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLcih0KSA/IEl3KHQpIDogdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3Mgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvciA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInZhbHVlXCIsIHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzRW5hYmxlZFwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhY2sgPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0ZShcImV4ZWN1dGVcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LCBcImNoYW5nZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImV4ZWN1dGVcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8ga2JhbGFzaGV2IChpbWFnZSB1cGxvYWQgYnV0dG9uIGZpeClcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoIXRoaXMuaXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImhpZ2hcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LCBcImNoYW5nZTppc1JlYWRPbmx5XCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JjZURpc2FibGVkKFwicmVhZE9ubHlNb2RlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckZvcmNlRGlzYWJsZWQoXCJyZWFkT25seU1vZGVcIilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvcmNlRGlzYWJsZWQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YWNrLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXNhYmxlU3RhY2suc2l6ZSA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbihcInNldDppc0VuYWJsZWRcIiwgSHcsIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNsZWFyRm9yY2VEaXNhYmxlZCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhY2suZGVsZXRlKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rpc2FibGVTdGFjay5zaXplID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9mZihcInNldDppc0VuYWJsZWRcIiwgSHcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhqdywgSmMpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBIdyh0KSB7XHJcbiAgICAgICAgICAgIHQucmV0dXJuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBXdyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm5leHQoKTtcclxuICAgICAgICAgICAgaWYgKGUuZG9uZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZS52YWx1ZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcXcgPSBbXCJsZWZ0XCIsIFwicmlnaHRcIiwgXCJjZW50ZXJcIiwgXCJqdXN0aWZ5XCJdO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBVdyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBxdy5pbmNsdWRlcyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gJHcodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5jb250ZW50TGFuZ3VhZ2VEaXJlY3Rpb24gPT0gXCJydGxcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT09IFwicmlnaHRcIlxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQgPT09IFwibGVmdFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IEd3ID0gXCJhbGlnbm1lbnRcIjtcclxuXHJcbiAgICAgICAgY2xhc3MgS3cgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sb2NhbGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gV3codGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uLmdldFNlbGVjdGVkQmxvY2tzKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSAhIWkgJiYgdGhpcy5fY2FuQmVBbGlnbmVkKGkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVkICYmIGkuaGFzQXR0cmlidXRlKFwiYWxpZ25tZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGkuZ2V0QXR0cmlidXRlKFwiYWxpZ25tZW50XCIpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBlLmNvbnRlbnRMYW5ndWFnZURpcmVjdGlvbiA9PT0gXCJydGxcIiA/IFwicmlnaHRcIiA6IFwibGVmdFwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUodCA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5sb2NhbGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICBuLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gQXJyYXkuZnJvbShvLnNlbGVjdGlvbi5nZXRTZWxlY3RlZEJsb2NrcygpKS5maWx0ZXIodCA9PiB0aGlzLl9jYW5CZUFsaWduZWQodCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlWzBdLmdldEF0dHJpYnV0ZShcImFsaWdubWVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gJHcociwgaSkgfHwgbiA9PT0gciB8fCAhcjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBKdyhlLCB0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFl3KGUsIHQsIHIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NhbkJlQWxpZ25lZCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lZGl0b3IubW9kZWwuc2NoZW1hLmNoZWNrQXR0cmlidXRlKHQsIEd3KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBKdyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBlLnJlbW92ZUF0dHJpYnV0ZShHdywgaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWXcodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoR3csIGksIG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFF3IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJBbGlnbm1lbnRFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbmZpZy5kZWZpbmUoXCJhbGlnbm1lbnRcIiwge29wdGlvbnM6IFsuLi5xd119KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuY29uZmlnLmdldChcImFsaWdubWVudC5vcHRpb25zXCIpLmZpbHRlcihVdyk7XHJcbiAgICAgICAgICAgICAgICBpLmV4dGVuZChcIiRibG9ja1wiLCB7YWxsb3dBdHRyaWJ1dGVzOiBcImFsaWdubWVudFwifSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKFwiYWxpZ25tZW50XCIsIHtpc0Zvcm1hdHRpbmc6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBYdyhuLmZpbHRlcih0ID0+ICEkdyh0LCBlKSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmF0dHJpYnV0ZVRvQXR0cmlidXRlKG8pO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJhbGlnbm1lbnRcIiwgbmV3IEt3KHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBYdyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB7bW9kZWw6IHtrZXk6IFwiYWxpZ25tZW50XCIsIHZhbHVlczogdC5zbGljZSgpfSwgdmlldzoge319O1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgZS52aWV3W2ldID0ge2tleTogXCJzdHlsZVwiLCB2YWx1ZToge1widGV4dC1hbGlnblwiOiBpfX1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFp3ID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTIgMy43NWMwIC40MTQuMzM2Ljc1Ljc1Ljc1aDE0LjVhLjc1Ljc1IDAgMSAwIDAtMS41SDIuNzVhLjc1Ljc1IDAgMCAwLS43NS43NXptMCA4YzAgLjQxNC4zMzYuNzUuNzUuNzVoMTQuNWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1em0wIDRjMCAuNDE0LjMzNi43NS43NS43NWg5LjkyOWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1em0wLThjMCAuNDE0LjMzNi43NS43NS43NWg5LjkyOWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciB0ayA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xOCAzLjc1YS43NS43NSAwIDAgMS0uNzUuNzVIMi43NWEuNzUuNzUgMCAxIDEgMC0xLjVoMTQuNWEuNzUuNzUgMCAwIDEgLjc1Ljc1em0wIDhhLjc1Ljc1IDAgMCAxLS43NS43NUgyLjc1YS43NS43NSAwIDEgMSAwLTEuNWgxNC41YS43NS43NSAwIDAgMSAuNzUuNzV6bTAgNGEuNzUuNzUgMCAwIDEtLjc1Ljc1SDcuMzIxYS43NS43NSAwIDEgMSAwLTEuNWg5LjkyOWEuNzUuNzUgMCAwIDEgLjc1Ljc1em0wLThhLjc1Ljc1IDAgMCAxLS43NS43NUg3LjMyMWEuNzUuNzUgMCAxIDEgMC0xLjVoOS45MjlhLjc1Ljc1IDAgMCAxIC43NS43NXpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgZWsgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMiAzLjc1YzAgLjQxNC4zMzYuNzUuNzUuNzVoMTQuNWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1em0wIDhjMCAuNDE0LjMzNi43NS43NS43NWgxNC41YS43NS43NSAwIDEgMCAwLTEuNUgyLjc1YS43NS43NSAwIDAgMC0uNzUuNzV6bTIuMjg2IDRjMCAuNDE0LjMzNi43NS43NS43NWg5LjkyOGEuNzUuNzUgMCAxIDAgMC0xLjVINS4wMzZhLjc1Ljc1IDAgMCAwLS43NS43NXptMC04YzAgLjQxNC4zMzYuNzUuNzUuNzVoOS45MjhhLjc1Ljc1IDAgMSAwIDAtMS41SDUuMDM2YS43NS43NSAwIDAgMC0uNzUuNzV6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIGlrID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTIgMy43NWMwIC40MTQuMzM2Ljc1Ljc1Ljc1aDE0LjVhLjc1Ljc1IDAgMSAwIDAtMS41SDIuNzVhLjc1Ljc1IDAgMCAwLS43NS43NXptMCA4YzAgLjQxNC4zMzYuNzUuNzUuNzVoMTQuNWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1em0wIDRjMCAuNDE0LjMzNi43NS43NS43NWg5LjkyOWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1em0wLThjMCAuNDE0LjMzNi43NS43NS43NWgxNC41YS43NS43NSAwIDEgMCAwLTEuNUgyLjc1YS43NS43NSAwIDAgMC0uNzUuNzV6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgbmsgPSBuZXcgTWFwKFtbXCJsZWZ0XCIsIFp3XSwgW1wicmlnaHRcIiwgdGtdLCBbXCJjZW50ZXJcIiwgZWtdLCBbXCJqdXN0aWZ5XCIsIGlrXV0pO1xyXG5cclxuICAgICAgICBjbGFzcyBvayBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgZ2V0IGxvY2FsaXplZE9wdGlvblRpdGxlcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci50O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtsZWZ0OiB0KFwiaXdcIiksIHJpZ2h0OiB0KFwiaXhcIiksIGNlbnRlcjogdChcIml5XCIpLCBqdXN0aWZ5OiB0KFwiaXpcIil9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkFsaWdubWVudFVJXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnVpLmNvbXBvbmVudEZhY3Rvcnk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuY29uZmlnLmdldChcImFsaWdubWVudC5vcHRpb25zXCIpO1xyXG4gICAgICAgICAgICAgICAgbi5maWx0ZXIoVXcpLmZvckVhY2godCA9PiB0aGlzLl9hZGRCdXR0b24odCkpO1xyXG4gICAgICAgICAgICAgICAgZS5hZGQoXCJhbGlnbm1lbnRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IFdiKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLm1hcCh0ID0+IGUuY3JlYXRlKGBhbGlnbm1lbnQ6JHt0fWApKTtcclxuICAgICAgICAgICAgICAgICAgICBxYihvLCByKTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJ1dHRvblZpZXcuc2V0KHtsYWJlbDogaShcImphXCIpLCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby50b29sYmFyVmlldy5pc1ZlcnRpY2FsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBvLnRvb2xiYXJWaWV3LmFyaWFMYWJlbCA9IGkoXCJqYlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBvLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFwiY2stYWxpZ25tZW50LWRyb3Bkb3duXCJ9fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHQuY29udGVudExhbmd1YWdlRGlyZWN0aW9uID09PSBcInJ0bFwiID8gdGsgOiBadztcclxuICAgICAgICAgICAgICAgICAgICBvLmJ1dHRvblZpZXcuYmluZChcImljb25cIikudG9NYW55KHIsIFwiaXNPblwiLCAoLi4udCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5maW5kSW5kZXgodCA9PiB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByW2VdLmljb25cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc0VuYWJsZWRcIikudG9NYW55KHIsIFwiaXNFbmFibGVkXCIsICguLi50KSA9PiB0LnNvbWUodCA9PiB0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hZGRCdXR0b24odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgZS51aS5jb21wb25lbnRGYWN0b3J5LmFkZChgYWxpZ25tZW50OiR7dH1gLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5jb21tYW5kcy5nZXQoXCJhbGlnbm1lbnRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBoYihpKTtcclxuICAgICAgICAgICAgICAgICAgICBvLnNldCh7bGFiZWw6IHRoaXMubG9jYWxpemVkT3B0aW9uVGl0bGVzW3RdLCBpY29uOiBuay5nZXQodCksIHRvb2x0aXA6IHRydWUsIGlzVG9nZ2xlYWJsZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYmluZChcImlzRW5hYmxlZFwiKS50byhuKTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc09uXCIpLnRvKG4sIFwidmFsdWVcIiwgZSA9PiBlID09PSB0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG8sIFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZXhlY3V0ZShcImFsaWdubWVudFwiLCB7dmFsdWU6IHR9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5lZGl0aW5nLnZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyByayBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbUXcsIG9rXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJBbGlnbm1lbnRcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBzayB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgaXNDb250ZXh0UGx1Z2luKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoc2ssIEpjKTtcclxuXHJcbiAgICAgICAgY2xhc3MgYWsgZXh0ZW5kcyBzayB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlBlbmRpbmdBY3Rpb25zXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaGFzQW55XCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbnMgPSBuZXcgeXMoe2lkUHJvcGVydHk6IFwiX2lkXCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FjdGlvbnMuZGVsZWdhdGUoXCJhZGRcIiwgXCJyZW1vdmVcIikudG8odGhpcylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWRkKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdCAhPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oXCJwZW5kaW5nYWN0aW9ucy1hZGQtaW52YWxpZC1tZXNzYWdlOiBUaGUgbWVzc2FnZSBtdXN0IGJlIGEgc3RyaW5nLlwiLCB0aGlzKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IE9iamVjdC5jcmVhdGUoSmMpO1xyXG4gICAgICAgICAgICAgICAgZS5zZXQoXCJtZXNzYWdlXCIsIHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9ucy5hZGQoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0FueSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW1vdmUodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aW9ucy5yZW1vdmUodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhc0FueSA9ICEhdGhpcy5fYWN0aW9ucy5sZW5ndGhcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGZpcnN0KCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvbnMuZ2V0KDApXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FjdGlvbnNbU3ltYm9sLml0ZXJhdG9yXSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGNrIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IHdpbmRvdy5GaWxlUmVhZGVyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2RhdGEgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImxvYWRlZFwiLCAwKTtcclxuICAgICAgICAgICAgICAgIHQub25wcm9ncmVzcyA9IHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGVkID0gdC5sb2FkZWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGVycm9yKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRlci5lcnJvclxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgZGF0YSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kYXRhXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlYWQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3JlYWRlcjtcclxuICAgICAgICAgICAgICAgIHRoaXMudG90YWwgPSB0LnNpemU7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kYXRhID0gdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgZS5vbmVycm9yID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuKFwiZXJyb3JcIilcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGUub25hYm9ydCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbihcImFib3J0ZWRcIilcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5yZWFkQXNEYXRhVVJMKHQpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhYm9ydCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5hYm9ydCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKGNrLCBKYyk7XHJcblxyXG4gICAgICAgIGNsYXNzIGxrIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJGaWxlUmVwb3NpdG9yeVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2FrXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZXJzID0gbmV3IHlzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZXJzLm9uKFwiYWRkXCIsICgpID0+IHRoaXMuX3VwZGF0ZVBlbmRpbmdBY3Rpb24oKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRlcnMub24oXCJyZW1vdmVcIiwgKCkgPT4gdGhpcy5fdXBkYXRlUGVuZGluZ0FjdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlcnNNYXAgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ0FjdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInVwbG9hZGVkXCIsIDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ1cGxvYWRUb3RhbFwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZChcInVwbG9hZGVkUGVyY2VudFwiKS50byh0aGlzLCBcInVwbG9hZGVkXCIsIHRoaXMsIFwidXBsb2FkVG90YWxcIiwgKHQsIGUpID0+IGUgPyB0IC8gZSAqIDEwMCA6IDApXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldExvYWRlcih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZGVyc01hcC5nZXQodCkgfHwgbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVMb2FkZXIodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNyZWF0ZVVwbG9hZEFkYXB0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oT2JqZWN0KHNzW1wiYVwiXSkoXCJmaWxlcmVwb3NpdG9yeS1uby11cGxvYWQtYWRhcHRlcjogVXBsb2FkIGFkYXB0ZXIgaXMgbm90IGRlZmluZWQuXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBkayhQcm9taXNlLnJlc29sdmUodCksIHRoaXMuY3JlYXRlVXBsb2FkQWRhcHRlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRlcnMuYWRkKGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyc01hcC5zZXQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmZpbGUudGhlbih0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyc01hcC5zZXQodCwgZSlcclxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUub24oXCJjaGFuZ2U6dXBsb2FkZWRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5sb2FkZXJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQgKz0gZS51cGxvYWRlZFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZGVkID0gdFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiY2hhbmdlOnVwbG9hZFRvdGFsXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMubG9hZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS51cGxvYWRUb3RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdCArPSBlLnVwbG9hZFRvdGFsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGxvYWRUb3RhbCA9IHRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveUxvYWRlcih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCBpbnN0YW5jZW9mIGRrID8gdCA6IHRoaXMuZ2V0TG9hZGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgZS5fZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZXJzLnJlbW92ZShlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlcnNNYXAuZm9yRWFjaCgodCwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ID09PSBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlcnNNYXAuZGVsZXRlKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZVBlbmRpbmdBY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoYWspO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubG9hZGVycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3BlbmRpbmdBY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0ID0+IGAke2UoXCJsYlwiKX0gJHtwYXJzZUludCh0KX0lLmA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdBY3Rpb24gPSB0LmFkZChpKHRoaXMudXBsb2FkZWRQZXJjZW50KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdBY3Rpb24uYmluZChcIm1lc3NhZ2VcIikudG8odGhpcywgXCJ1cGxvYWRlZFBlcmNlbnRcIiwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlKHRoaXMuX3BlbmRpbmdBY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdBY3Rpb24gPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKGxrLCBKYyk7XHJcblxyXG4gICAgICAgIGNsYXNzIGRrIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pZCA9IGlzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxlUHJvbWlzZVdyYXBwZXIgPSB0aGlzLl9jcmVhdGVGaWxlUHJvbWlzZVdyYXBwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGFwdGVyID0gZSh0aGlzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlciA9IG5ldyBjaztcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwic3RhdHVzXCIsIFwiaWRsZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwidXBsb2FkZWRcIiwgMCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInVwbG9hZFRvdGFsXCIsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kKFwidXBsb2FkZWRQZXJjZW50XCIpLnRvKHRoaXMsIFwidXBsb2FkZWRcIiwgdGhpcywgXCJ1cGxvYWRUb3RhbFwiLCAodCwgZSkgPT4gZSA/IHQgLyBlICogMTAwIDogMCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInVwbG9hZFJlc3BvbnNlXCIsIG51bGwpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBmaWxlKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9maWxlUHJvbWlzZVdyYXBwZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9maWxlUHJvbWlzZVdyYXBwZXIucHJvbWlzZS50aGVuKHQgPT4gdGhpcy5fZmlsZVByb21pc2VXcmFwcGVyID8gdCA6IG51bGwpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBkYXRhKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWRlci5kYXRhXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlYWQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgIT0gXCJpZGxlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiZmlsZXJlcG9zaXRvcnktcmVhZC13cm9uZy1zdGF0dXM6IFlvdSBjYW5ub3QgY2FsbCByZWFkIGlmIHRoZSBzdGF0dXMgaXMgZGlmZmVyZW50IHRoYW4gaWRsZS5cIiwgdGhpcylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gXCJyZWFkaW5nXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWxlLnRoZW4odCA9PiB0aGlzLl9yZWFkZXIucmVhZCh0KSkudGhlbih0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiaWRsZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gXCJhYm9ydGVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcImFib3J0ZWRcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3dcImFib3J0ZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiZXJyb3JcIjtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyB0aGlzLl9yZWFkZXIuZXJyb3IgPyB0aGlzLl9yZWFkZXIuZXJyb3IgOiB0XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1cGxvYWQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgIT0gXCJpZGxlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgc3NbXCJiXCJdKFwiZmlsZXJlcG9zaXRvcnktdXBsb2FkLXdyb25nLXN0YXR1czogWW91IGNhbm5vdCBjYWxsIHVwbG9hZCBpZiB0aGUgc3RhdHVzIGlzIGRpZmZlcmVudCB0aGFuIGlkbGUuXCIsIHRoaXMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwidXBsb2FkaW5nXCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWxlLnRoZW4oKCkgPT4gdGhpcy5fYWRhcHRlci51cGxvYWQoKSkudGhlbih0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZFJlc3BvbnNlID0gdDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiaWRsZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IFwiYWJvcnRlZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93XCJhYm9ydGVkXCJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcImVycm9yXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgdFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWJvcnQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5zdGF0dXM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiYWJvcnRlZFwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9maWxlUHJvbWlzZVdyYXBwZXIuaXNGdWxmaWxsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maWxlUHJvbWlzZVdyYXBwZXIucHJvbWlzZS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZmlsZVByb21pc2VXcmFwcGVyLnJlamVjdGVyKFwiYWJvcnRlZFwiKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ID09IFwicmVhZGluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLmFib3J0KClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodCA9PSBcInVwbG9hZGluZ1wiICYmIHRoaXMuX2FkYXB0ZXIuYWJvcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGFwdGVyLmFib3J0KClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rlc3Ryb3koKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpbGVQcm9taXNlV3JhcHBlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlciA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FkYXB0ZXIgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZFJlc3BvbnNlID0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVGaWxlUHJvbWlzZVdyYXBwZXIodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgZS5wcm9taXNlID0gbmV3IFByb21pc2UoKGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLnJlamVjdGVyID0gbjtcclxuICAgICAgICAgICAgICAgICAgICBlLmlzRnVsZmlsbGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdC50aGVuKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmlzRnVsZmlsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmlzRnVsZmlsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbih0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKGRrLCBKYyk7XHJcblxyXG4gICAgICAgIGNsYXNzIHVrIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtsa11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiQmFzZTY0VXBsb2FkQWRhcHRlclwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChsaykuY3JlYXRlVXBsb2FkQWRhcHRlciA9IHQgPT4gbmV3IGhrKHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGhrIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkZXIgPSB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVwbG9hZCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnJlYWRlciA9IG5ldyB3aW5kb3cuRmlsZVJlYWRlcjtcclxuICAgICAgICAgICAgICAgICAgICBpLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdCh7ZGVmYXVsdDogaS5yZXN1bHR9KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5hZGRFdmVudExpc3RlbmVyKFwiYWJvcnRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlci5maWxlLnRoZW4odCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucmVhZEFzRGF0YVVSTCh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhYm9ydCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVhZGVyLmFib3J0KClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZmsgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5fZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdGhpcy5fY2hlY2tFbmFibGVkKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBBcnJheS5mcm9tKG4uZ2V0U2VsZWN0ZWRCbG9ja3MoKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdC5mb3JjZVZhbHVlID09PSB1bmRlZmluZWQgPyAhdGhpcy52YWx1ZSA6IHQuZm9yY2VWYWx1ZTtcclxuICAgICAgICAgICAgICAgIGUuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVRdW90ZSh0LCBvLmZpbHRlcihnaykpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG8uZmlsdGVyKHQgPT4gZ2sodCkgfHwgcGsoaSwgdCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hcHBseVF1b3RlKHQsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBXdyh0LmdldFNlbGVjdGVkQmxvY2tzKCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhKGUgJiYgZ2soZSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jaGVja0VuYWJsZWQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBXdyh0LmdldFNlbGVjdGVkQmxvY2tzKCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGsoZSwgaSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZVF1b3RlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIG1rKHQsIGUpLnJldmVyc2UoKS5mb3JFYWNoKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnN0YXJ0LmlzQXRTdGFydCAmJiBlLmVuZC5pc0F0RW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQudW53cmFwKGUuc3RhcnQucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnN0YXJ0LmlzQXRTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jcmVhdGVQb3NpdGlvbkJlZm9yZShlLnN0YXJ0LnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQubW92ZShlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZS5lbmQuaXNBdEVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNwbGl0KGUuZW5kKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jcmVhdGVQb3NpdGlvbkFmdGVyKGUuZW5kLnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5tb3ZlKGUsIGkpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYXBwbHlRdW90ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgICAgICBtayh0LCBlKS5yZXZlcnNlKCkuZm9yRWFjaChlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbiA9IGdrKGUuc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gdC5jcmVhdGVFbGVtZW50KFwiYmxvY2tRdW90ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC53cmFwKGUsIG4pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGkucHVzaChuKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpLnJldmVyc2UoKS5yZWR1Y2UoKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5uZXh0U2libGluZyA9PSBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQubWVyZ2UodC5jcmVhdGVQb3NpdGlvbkFmdGVyKGUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdrKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQucGFyZW50Lm5hbWUgPT0gXCJibG9ja1F1b3RlXCIgPyB0LnBhcmVudCA6IG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1rKHQsIGUpIHtcclxuICAgICAgICAgICAgbGV0IGk7XHJcbiAgICAgICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICAgICAgY29uc3QgbyA9IFtdO1xyXG4gICAgICAgICAgICB3aGlsZSAobiA8IGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gZVtuXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBlW24gKyAxXTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0LmNyZWF0ZVBvc2l0aW9uQmVmb3JlKHIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXMgfHwgci5uZXh0U2libGluZyAhPSBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgby5wdXNoKHQuY3JlYXRlUmFuZ2UoaSwgdC5jcmVhdGVQb3NpdGlvbkFmdGVyKHIpKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG4rK1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBwayh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmNoZWNrQ2hpbGQoZS5wYXJlbnQsIFwiYmxvY2tRdW90ZVwiKTtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHQuY2hlY2tDaGlsZChbXCIkcm9vdFwiLCBcImJsb2NrUXVvdGVcIl0sIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gaSAmJiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBiayBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiQmxvY2tRdW90ZUVkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJibG9ja1F1b3RlXCIsIG5ldyBmayh0KSk7XHJcbiAgICAgICAgICAgICAgICBlLnJlZ2lzdGVyKFwiYmxvY2tRdW90ZVwiLCB7YWxsb3dXaGVyZTogXCIkYmxvY2tcIiwgYWxsb3dDb250ZW50T2Y6IFwiJHJvb3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgZS5hZGRDaGlsZENoZWNrKCh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuZW5kc1dpdGgoXCJibG9ja1F1b3RlXCIpICYmIGUubmFtZSA9PSBcImJsb2NrUXVvdGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5lbGVtZW50VG9FbGVtZW50KHttb2RlbDogXCJibG9ja1F1b3RlXCIsIHZpZXc6IFwiYmxvY2txdW90ZVwifSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLmRvY3VtZW50LnJlZ2lzdGVyUG9zdEZpeGVyKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0Lm1vZGVsLmRvY3VtZW50LmRpZmZlci5nZXRDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcImluc2VydFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wb3NpdGlvbi5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uaXMoXCJibG9ja1F1b3RlXCIpICYmIG4uaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkucmVtb3ZlKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG4uaXMoXCJibG9ja1F1b3RlXCIpICYmICFlLmNoZWNrQ2hpbGQodC5wb3NpdGlvbiwgbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnVud3JhcChuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuLmlzKFwiZWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLmNyZWF0ZVJhbmdlSW4obik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuZ2V0SXRlbXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5pcyhcImJsb2NrUXVvdGVcIikgJiYgIWUuY2hlY2tDaGlsZChpLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKG4pLCBuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS51bndyYXAobik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQudHlwZSA9PSBcInJlbW92ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5wb3NpdGlvbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5pcyhcImJsb2NrUXVvdGVcIikgJiYgZS5pc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5yZW1vdmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFmdGVySW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvbW1hbmRzLmdldChcImJsb2NrUXVvdGVcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5kb2N1bWVudCwgXCJlbnRlclwiLCAodCwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5zZWxlY3Rpb24uZ2V0TGFzdFBvc2l0aW9uKCkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuLnNlbGVjdGlvbi5pc0NvbGxhcHNlZCAmJiBvLmlzRW1wdHkgJiYgZS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5leGVjdXRlKFwiYmxvY2tRdW90ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3LnNjcm9sbFRvVGhlU2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zdG9wKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgd2sgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMyAxMC40MjNhNi41IDYuNSAwIDAgMSA2LjA1Ni02LjQwOGwuMDM4LjY3QzYuNDQ4IDUuNDIzIDUuMzU0IDcuNjYzIDUuMjIgMTBIOWMuNTUyIDAgLjUuNDMyLjUuOTg2djQuNTExYzAgLjU1NC0uNDQ4LjUwMy0xIC41MDNoLTVjLS41NTIgMC0uNS0uNDQ5LS41LTEuMDAzdi00LjU3NHptOCAwYTYuNSA2LjUgMCAwIDEgNi4wNTYtNi40MDhsLjAzOC42N2MtMi42NDYuNzM5LTMuNzQgMi45NzktMy44NzMgNS4zMTVIMTdjLjU1MiAwIC41LjQzMi41Ljk4NnY0LjUxMWMwIC41NTQtLjQ0OC41MDMtMSAuNTAzaC01Yy0uNTUyIDAtLjUtLjQ0OS0uNS0xLjAwM3YtNC41NzR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIGtrID0gaSg0NSk7XHJcblxyXG4gICAgICAgIGNsYXNzIF9rIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoXCJibG9ja1F1b3RlXCIsIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChcImJsb2NrUXVvdGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBoYihpKTtcclxuICAgICAgICAgICAgICAgICAgICBvLnNldCh7bGFiZWw6IGUoXCJqY1wiKSwgaWNvbjogd2ssIHRvb2x0aXA6IHRydWUsIGlzVG9nZ2xlYWJsZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYmluZChcImlzT25cIiwgXCJpc0VuYWJsZWRcIikudG8obiwgXCJ2YWx1ZVwiLCBcImlzRW5hYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG8sIFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY3V0ZShcImJsb2NrUXVvdGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdmsgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2JrLCBfa11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiQmxvY2tRdW90ZVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHlrIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlS2V5ID0gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5fZ2V0VmFsdWVGcm9tRmlyc3RBbGxvd2VkTm9kZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSB0LnNjaGVtYS5jaGVja0F0dHJpYnV0ZUluU2VsZWN0aW9uKGUuc2VsZWN0aW9uLCB0aGlzLmF0dHJpYnV0ZUtleSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHQuZm9yY2VWYWx1ZSA9PT0gdW5kZWZpbmVkID8gIXRoaXMudmFsdWUgOiB0LmZvcmNlVmFsdWU7XHJcbiAgICAgICAgICAgICAgICBlLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb25BdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVLZXksIHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZUtleSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnNjaGVtYS5nZXRWYWxpZFJhbmdlcyhuLmdldFJhbmdlcygpLCB0aGlzLmF0dHJpYnV0ZUtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlKHRoaXMuYXR0cmlidXRlS2V5LCBvLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZUtleSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRWYWx1ZUZyb21GaXJzdEFsbG93ZWROb2RlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaS5oYXNBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVLZXkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaS5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldEl0ZW1zKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuY2hlY2tBdHRyaWJ1dGUoaSwgdGhpcy5hdHRyaWJ1dGVLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaS5oYXNBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVLZXkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeGsgPSBcImJvbGRcIjtcclxuXHJcbiAgICAgICAgY2xhc3MgQ2sgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkJvbGRFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0F0dHJpYnV0ZXM6IHhrfSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKHhrLCB7aXNGb3JtYXR0aW5nOiB0cnVlLCBjb3B5T25FbnRlcjogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmF0dHJpYnV0ZVRvRWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHhrLCB2aWV3OiBcInN0cm9uZ1wiLCB1cGNhc3RBbHNvOiBbXCJiXCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5nZXRTdHlsZShcImZvbnQtd2VpZ2h0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPT0gXCJib2xkXCIgfHwgTnVtYmVyKGUpID49IDYwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtuYW1lOiB0cnVlLCBzdHlsZXM6IFtcImZvbnQtd2VpZ2h0XCJdfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoeGssIG5ldyB5ayh0LCB4aykpO1xyXG4gICAgICAgICAgICAgICAgdC5rZXlzdHJva2VzLnNldChcIkNUUkwrQlwiLCB4aylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEFrID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTEwLjE4NyAxN0g1Ljc3M2MtLjYzNyAwLTEuMDkyLS4xMzgtMS4zNjQtLjQxNS0uMjczLS4yNzctLjQwOS0uNzE4LS40MDktMS4zMjNWNC43MzhjMC0uNjE3LjE0LTEuMDYyLjQxOS0xLjMzMi4yNzktLjI3LjczLS40MDYgMS4zNTQtLjQwNmg0LjY4Yy42OSAwIDEuMjg4LjA0MSAxLjc5My4xMjQuNTA2LjA4My45Ni4yNDIgMS4zNi40NzguMzQxLjE5Ny42NDQuNDQ3LjkwNi43NWEzLjI2MiAzLjI2MiAwIDAgMSAuODA4IDIuMTYyYzAgMS40MDEtLjcyMiAyLjQyNi0yLjE2NyAzLjA3NUMxNS4wNSAxMC4xNzUgMTYgMTEuMzE1IDE2IDEzLjAxYTMuNzU2IDMuNzU2IDAgMCAxLTIuMjk2IDMuNTA0IDYuMSA2LjEgMCAwIDEtMS41MTcuMzc3Yy0uNTcxLjA3My0xLjIzOC4xMS0yIC4xMXptLS4yMTctNi4yMTdIN3Y0LjA4N2gzLjA2OWMxLjk3NyAwIDIuOTY1LS42OSAyLjk2NS0yLjA3MiAwLS43MDctLjI1Ni0xLjIyLS43NjgtMS41MzctLjUxMi0uMzE5LTEuMjc3LS40NzgtMi4yOTYtLjQ3OHpNNyA1LjEzdjMuNjE5aDIuNjA2Yy43MjkgMCAxLjI5Mi0uMDY3IDEuNjktLjJhMS42IDEuNiAwIDAgMCAuOTEtLjc2NWMuMTY1LS4yNjcuMjQ3LS41NjYuMjQ3LS44OTcgMC0uNzA3LS4yNi0xLjE3Ni0uNzc4LTEuNDA5LS41MTktLjIzMi0xLjMxLS4zNDgtMi4zNzUtLjM0OEg3elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIGNvbnN0IFRrID0gXCJib2xkXCI7XHJcblxyXG4gICAgICAgIGNsYXNzIFBrIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoVGssIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChUayk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBoYihpKTtcclxuICAgICAgICAgICAgICAgICAgICBvLnNldCh7bGFiZWw6IGUoXCJqaVwiKSwgaWNvbjogQWssIGtleXN0cm9rZTogXCJDVFJMK0JcIiwgdG9vbHRpcDogdHJ1ZSwgaXNUb2dnbGVhYmxlOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5iaW5kKFwiaXNPblwiLCBcImlzRW5hYmxlZFwiKS50byhuLCBcInZhbHVlXCIsIFwiaXNFbmFibGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obywgXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKFRrKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5lZGl0aW5nLnZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBTayBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbQ2ssIFBrXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJCb2xkXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgRWsgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVLZXkgPSBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBlLnNlbGVjdGlvbi5nZXRBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVLZXkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSB0LnNjaGVtYS5jaGVja0F0dHJpYnV0ZUluU2VsZWN0aW9uKGUuc2VsZWN0aW9uLCB0aGlzLmF0dHJpYnV0ZUtleSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHQudmFsdWU7XHJcbiAgICAgICAgICAgICAgICBlLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb25BdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVLZXksIG8pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZUtleSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnNjaGVtYS5nZXRWYWxpZFJhbmdlcyhuLmdldFJhbmdlcygpLCB0aGlzLmF0dHJpYnV0ZUtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlKHRoaXMuYXR0cmlidXRlS2V5LCBvLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZUtleSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBSayA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggY2xhc3M9XCJjay1pY29uX19maWxsXCIgZD1cIk0xNi45MzUgNS4zMjhhMiAyIDAgMCAxIDAgMi44MjlsLTcuNzc4IDcuNzc4YTIgMiAwIDAgMS0yLjgyOSAwTDMuNSAxMy4xMDdhMS45OTkgMS45OTkgMCAxIDEgMi44MjgtMi44MjlsLjcwNy43MDdhMSAxIDAgMCAwIDEuNDE0IDBsNS42NTgtNS42NTdhMiAyIDAgMCAxIDIuODI4IDB6XCIvPjxwYXRoIGQ9XCJNMTQuODE0IDYuMDM1TDguNDQ4IDEyLjRhMSAxIDAgMCAxLTEuNDE0IDBsLTEuNDEzLTEuNDE1QTEgMSAwIDEgMCA0LjIwNyAxMi40bDIuODI5IDIuODI5YTEgMSAwIDAgMCAxLjQxNCAwbDcuNzc4LTcuNzc4YTEgMSAwIDEgMC0xLjQxNC0xLjQxNXpcIi8+PC9zdmc+JztcclxuXHJcbiAgICAgICAgY2xhc3MgT2sgZXh0ZW5kcyBoYiB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJjb2xvclwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaGFzQm9yZGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pY29uID0gUms7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmV4dGVuZFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7YmFja2dyb3VuZENvbG9yOiBlLnRvKFwiY29sb3JcIil9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay1jb2xvci1ncmlkX190aWxlXCIsIGUuaWYoXCJoYXNCb3JkZXJcIiwgXCJjay1jb2xvci10YWJsZV9fY29sb3ItdGlsZV9ib3JkZXJlZFwiKV1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaWNvblZpZXcuZmlsbENvbG9yID0gXCJoc2woMCwgMCUsIDEwMCUpXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIElrID0gaSg0Nyk7XHJcblxyXG4gICAgICAgIGNsYXNzIFZrIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlICYmIGUuY29sb3JEZWZpbml0aW9ucyB8fCBbXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB7fTtcclxuICAgICAgICAgICAgICAgIGlmIChlICYmIGUuY29sdW1ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIG4uZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoICR7ZS5jb2x1bW5zfSwgMWZyKWBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwic2VsZWN0ZWRDb2xvclwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyID0gbmV3IGZiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzID0gbmV3IGRwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIgPSBuZXcgeWIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZXM6IHRoaXMuaXRlbXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNUcmFja2VyOiB0aGlzLmZvY3VzVHJhY2tlcixcclxuICAgICAgICAgICAgICAgICAgICBrZXlzdHJva2VIYW5kbGVyOiB0aGlzLmtleXN0cm9rZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uczoge2ZvY3VzUHJldmlvdXM6IFwiYXJyb3dsZWZ0XCIsIGZvY3VzTmV4dDogXCJhcnJvd3JpZ2h0XCJ9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMub24oXCJhZGRcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLmlzT24gPSBlLmNvbG9yID09PSB0aGlzLnNlbGVjdGVkQ29sb3JcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaS5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgT2s7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zZXQoe2NvbG9yOiB0LmNvbG9yLCBsYWJlbDogdC5sYWJlbCwgdG9vbHRpcDogdHJ1ZSwgaGFzQm9yZGVyOiB0Lm9wdGlvbnMuaGFzQm9yZGVyfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5vbihcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJleGVjdXRlXCIsIHt2YWx1ZTogdC5jb2xvciwgaGFzQm9yZGVyOiB0Lm9wdGlvbnMuaGFzQm9yZGVyLCBsYWJlbDogdC5sYWJlbH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5hZGQoZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1jb2xvci1ncmlkXCJdLCBzdHlsZTogbn1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTpzZWxlY3RlZENvbG9yXCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5pc09uID0gdC5jb2xvciA9PT0gaVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXRlbXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5maXJzdC5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzTGFzdCgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLml0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMubGFzdC5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodC5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5vbihcImFkZFwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZChlLmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMub24oXCJyZW1vdmVcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5yZW1vdmUoZS5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgTmsgPSBpKDQ5KTtcclxuXHJcbiAgICAgICAgY2xhc3MgTWsgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJ0ZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJmb3JcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlkID0gYGNrLWVkaXRvcl9fbGFiZWxfJHtpcygpfWA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwibGFiZWxcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stbGFiZWxcIl0sIGlkOiB0aGlzLmlkLCBmb3I6IGUudG8oXCJmb3JcIil9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IGUudG8oXCJ0ZXh0XCIpfV1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEJrIGV4dGVuZHMgeXMge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNFbXB0eVwiLCB0cnVlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZmluZChlID0+IGUuY29sb3IgPT09IHQuY29sb3IpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzdXBlci5hZGQodCwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzRW1wdHlcIiwgZmFsc2UpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gc3VwZXIucmVtb3ZlKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0VtcHR5XCIsIHRydWUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYXNDb2xvcih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gISF0aGlzLmZpbmQoZSA9PiBlLmNvbG9yID09PSB0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhCaywgSmMpO1xyXG4gICAgICAgIHZhciB6ayA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk04LjYzNiA5LjUzMWwtMi43NTggMy45NGEuNS41IDAgMCAwIC4xMjIuNjk2bDMuMjI0IDIuMjg0aDEuMzE0bDIuNjM2LTMuNzM2TDguNjM2IDkuNTN6bS4yODggOC40NTFMNS4xNCAxNS4zOTZhMiAyIDAgMCAxLS40OTEtMi43ODZsNi42NzMtOS41M2EyIDIgMCAwIDEgMi43ODUtLjQ5bDMuNzQyIDIuNjJhMiAyIDAgMCAxIC40OTEgMi43ODVsLTcuMjY5IDEwLjA1My0yLjE0Ny0uMDY2elwiLz48cGF0aCBkPVwiTTQgMThoNS41MjN2LTFINHptLTIgMGgxdi0xSDJ6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIExrID0gaSg1MSk7XHJcblxyXG4gICAgICAgIGNsYXNzIEZrIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCB7Y29sb3JzOiBlLCBjb2x1bW5zOiBpLCByZW1vdmVCdXR0b25MYWJlbDogbiwgZG9jdW1lbnRDb2xvcnNMYWJlbDogbywgZG9jdW1lbnRDb2xvcnNDb3VudDogcn0pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvckRlZmluaXRpb25zID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyID0gbmV3IGZiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzID0gbmV3IGRwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJzZWxlY3RlZENvbG9yXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVCdXR0b25MYWJlbCA9IG47XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbHVtbnMgPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudENvbG9ycyA9IG5ldyBCaztcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRDb2xvcnNDb3VudCA9IHI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c0N5Y2xlciA9IG5ldyB5Yih7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlczogdGhpcy5pdGVtcyxcclxuICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrZXI6IHRoaXMuZm9jdXNUcmFja2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGtleXN0cm9rZUhhbmRsZXI6IHRoaXMua2V5c3Ryb2tlcyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiB7Zm9jdXNQcmV2aW91czogXCJhcnJvd3VwXCIsIGZvY3VzTmV4dDogXCJhcnJvd2Rvd25cIn1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9jdW1lbnRDb2xvcnNMYWJlbCA9IG87XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHt0YWc6IFwiZGl2XCIsIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1jb2xvci10YWJsZVwiXX0sIGNoaWxkcmVuOiB0aGlzLml0ZW1zfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLmFkZCh0aGlzLl9yZW1vdmVDb2xvckJ1dHRvbigpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVEb2N1bWVudENvbG9ycyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmRvY3VtZW50Q29sb3JzQ291bnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50Q29sb3JzLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG8gb2YgaS5nZXRSb290TmFtZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBpLmdldFJvb3Qobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHQuY3JlYXRlUmFuZ2VJbihyKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygcy5nZXRJdGVtcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmlzKFwidGV4dFByb3h5XCIpICYmIHQuaGFzQXR0cmlidXRlKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRDb2xvclRvRG9jdW1lbnRDb2xvcnModC5nZXRBdHRyaWJ1dGUoZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9jdW1lbnRDb2xvcnMubGVuZ3RoID49IG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlU2VsZWN0ZWRDb2xvcnMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5kb2N1bWVudENvbG9yc0dyaWQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5zdGF0aWNDb2xvcnNHcmlkO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuc2VsZWN0ZWRDb2xvcjtcclxuICAgICAgICAgICAgICAgIGUuc2VsZWN0ZWRDb2xvciA9IGk7XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2VsZWN0ZWRDb2xvciA9IGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVuZGVyKCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZCh0LmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhcHBlbmRHcmlkcygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXRpY0NvbG9yc0dyaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGljQ29sb3JzR3JpZCA9IHRoaXMuX2NyZWF0ZVN0YXRpY0NvbG9yc0dyaWQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMuYWRkKHRoaXMuc3RhdGljQ29sb3JzR3JpZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5kb2N1bWVudENvbG9yc0NvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IF9wLmJpbmQodGhpcy5kb2N1bWVudENvbG9ycywgdGhpcy5kb2N1bWVudENvbG9ycyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBNayh0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS50ZXh0ID0gdGhpcy5fZG9jdW1lbnRDb2xvcnNMYWJlbDtcclxuICAgICAgICAgICAgICAgICAgICBlLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stY29sb3ItZ3JpZF9fbGFiZWxcIiwgdC5pZihcImlzRW1wdHlcIiwgXCJjay1oaWRkZW5cIildfX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMuYWRkKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRDb2xvcnNHcmlkID0gdGhpcy5fY3JlYXRlRG9jdW1lbnRDb2xvcnNHcmlkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5hZGQodGhpcy5kb2N1bWVudENvbG9yc0dyaWQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIuZm9jdXNGaXJzdCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzTGFzdCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyLmZvY3VzTGFzdCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVDb2xvckJ1dHRvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgaGI7XHJcbiAgICAgICAgICAgICAgICB0LnNldCh7d2l0aFRleHQ6IHRydWUsIGljb246IHprLCB0b29sdGlwOiB0cnVlLCBsYWJlbDogdGhpcy5yZW1vdmVCdXR0b25MYWJlbH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jbGFzcyA9IFwiY2stY29sb3ItdGFibGVfX3JlbW92ZS1jb2xvclwiO1xyXG4gICAgICAgICAgICAgICAgdC5vbihcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImV4ZWN1dGVcIiwge3ZhbHVlOiBudWxsfSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVN0YXRpY0NvbG9yc0dyaWQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IFZrKHRoaXMubG9jYWxlLCB7Y29sb3JEZWZpbml0aW9uczogdGhpcy5jb2xvckRlZmluaXRpb25zLCBjb2x1bW5zOiB0aGlzLmNvbHVtbnN9KTtcclxuICAgICAgICAgICAgICAgIHQuZGVsZWdhdGUoXCJleGVjdXRlXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZURvY3VtZW50Q29sb3JzR3JpZCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBfcC5iaW5kKHRoaXMuZG9jdW1lbnRDb2xvcnMsIHRoaXMuZG9jdW1lbnRDb2xvcnMpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBWayh0aGlzLmxvY2FsZSwge2NvbHVtbnM6IHRoaXMuY29sdW1uc30pO1xyXG4gICAgICAgICAgICAgICAgZS5kZWxlZ2F0ZShcImV4ZWN1dGVcIikudG8odGhpcyk7XHJcbiAgICAgICAgICAgICAgICBlLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IHQuaWYoXCJpc0VtcHR5XCIsIFwiY2staGlkZGVuXCIpfX0pO1xyXG4gICAgICAgICAgICAgICAgZS5pdGVtcy5iaW5kVG8odGhpcy5kb2N1bWVudENvbG9ycykudXNpbmcodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBPaztcclxuICAgICAgICAgICAgICAgICAgICBlLnNldCh7Y29sb3I6IHQuY29sb3IsIGhhc0JvcmRlcjogdC5vcHRpb25zICYmIHQub3B0aW9ucy5oYXNCb3JkZXJ9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNldCh7bGFiZWw6IHQubGFiZWwsIHRvb2x0aXA6IHRydWV9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImV4ZWN1dGVcIiwge3ZhbHVlOiB0LmNvbG9yfSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50Q29sb3JzLm9uKFwiY2hhbmdlOmlzRW1wdHlcIiwgKHQsIGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNlbGVjdGVkQ29sb3IgPSBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYWRkQ29sb3JUb0RvY3VtZW50Q29sb3JzKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmNvbG9yRGVmaW5pdGlvbnMuZmluZChlID0+IGUuY29sb3IgPT09IHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudENvbG9ycy5hZGQoe2NvbG9yOiB0LCBsYWJlbDogdCwgb3B0aW9uczoge2hhc0JvcmRlcjogZmFsc2V9fSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudENvbG9ycy5hZGQoT2JqZWN0LmFzc2lnbih7fSwgZSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IERrID0gXCJmb250U2l6ZVwiO1xyXG4gICAgICAgIGNvbnN0IGprID0gXCJmb250RmFtaWx5XCI7XHJcbiAgICAgICAgY29uc3QgSGsgPSBcImZvbnRDb2xvclwiO1xyXG4gICAgICAgIGNvbnN0IFdrID0gXCJmb250QmFja2dyb3VuZENvbG9yXCI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHFrKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHttb2RlbDoge2tleTogdCwgdmFsdWVzOiBbXX0sIHZpZXc6IHt9LCB1cGNhc3RBbHNvOiB7fX07XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICBpLm1vZGVsLnZhbHVlcy5wdXNoKHQubW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgaS52aWV3W3QubW9kZWxdID0gdC52aWV3O1xyXG4gICAgICAgICAgICAgICAgaWYgKHQudXBjYXN0QWxzbykge1xyXG4gICAgICAgICAgICAgICAgICAgIGkudXBjYXN0QWxzb1t0Lm1vZGVsXSA9IHQudXBjYXN0QWxzb1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBVayh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IEtrKGUuZ2V0U3R5bGUodCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiAkayh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZSwgaSkgPT4gaS5jcmVhdGVBdHRyaWJ1dGVFbGVtZW50KFwic3BhblwiLCB7c3R5bGU6IGAke3R9OiR7ZX1gfSwge3ByaW9yaXR5OiA3fSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEdrKHtkcm9wZG93blZpZXc6IHQsIGNvbG9yczogZSwgY29sdW1uczogaSwgcmVtb3ZlQnV0dG9uTGFiZWw6IG4sIGRvY3VtZW50Q29sb3JzTGFiZWw6IG8sIGRvY3VtZW50Q29sb3JzQ291bnQ6IHJ9KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0LmxvY2FsZTtcclxuICAgICAgICAgICAgY29uc3QgYSA9IG5ldyBGayhzLCB7XHJcbiAgICAgICAgICAgICAgICBjb2xvcnM6IGUsXHJcbiAgICAgICAgICAgICAgICBjb2x1bW5zOiBpLFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlQnV0dG9uTGFiZWw6IG4sXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudENvbG9yc0xhYmVsOiBvLFxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnRDb2xvcnNDb3VudDogclxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdC5jb2xvclRhYmxlVmlldyA9IGE7XHJcbiAgICAgICAgICAgIHQucGFuZWxWaWV3LmNoaWxkcmVuLmFkZChhKTtcclxuICAgICAgICAgICAgYS5kZWxlZ2F0ZShcImV4ZWN1dGVcIikudG8odCwgXCJleGVjdXRlXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gYVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gS2sodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5yZXBsYWNlKC9cXHMvZywgXCJcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEprIGV4dGVuZHMgRWsge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBqaylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWWsodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5tYXAoUWspLmZpbHRlcih0ID0+ICEhdClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFFrKHQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0ID09PSBcImRlZmF1bHRcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt0aXRsZTogXCJEZWZhdWx0XCIsIG1vZGVsOiB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ICE9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gWGsodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFhrKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQucmVwbGFjZSgvXCJ8Jy9nLCBcIlwiKS5zcGxpdChcIixcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBlWzBdO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZS5tYXAoWmspLmpvaW4oXCIsIFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIHt0aXRsZTogaSwgbW9kZWw6IGksIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgc3R5bGVzOiB7XCJmb250LWZhbWlseVwiOiBufSwgcHJpb3JpdHk6IDd9fVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWmsodCkge1xyXG4gICAgICAgICAgICB0ID0gdC50cmltKCk7XHJcbiAgICAgICAgICAgIGlmICh0LmluZGV4T2YoXCIgXCIpID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdCA9IGAnJHt0fSdgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHRfIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJGb250RmFtaWx5RWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdC5jb25maWcuZGVmaW5lKGprLCB7b3B0aW9uczogW1wiZGVmYXVsdFwiLCBcIkFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWZcIiwgXCJDb3VyaWVyIE5ldywgQ291cmllciwgbW9ub3NwYWNlXCIsIFwiR2VvcmdpYSwgc2VyaWZcIiwgXCJMdWNpZGEgU2FucyBVbmljb2RlLCBMdWNpZGEgR3JhbmRlLCBzYW5zLXNlcmlmXCIsIFwiVGFob21hLCBHZW5ldmEsIHNhbnMtc2VyaWZcIiwgXCJUaW1lcyBOZXcgUm9tYW4sIFRpbWVzLCBzZXJpZlwiLCBcIlRyZWJ1Y2hldCBNUywgSGVsdmV0aWNhLCBzYW5zLXNlcmlmXCIsIFwiVmVyZGFuYSwgR2VuZXZhLCBzYW5zLXNlcmlmXCJdfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0F0dHJpYnV0ZXM6IGprfSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKGprLCB7aXNGb3JtYXR0aW5nOiB0cnVlLCBjb3B5T25FbnRlcjogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFlrKHQuY29uZmlnLmdldChcImZvbnRGYW1pbHkub3B0aW9uc1wiKSkuZmlsdGVyKHQgPT4gdC5tb2RlbCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gcWsoamssIGUpO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmF0dHJpYnV0ZVRvRWxlbWVudChpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKGprLCBuZXcgSmsodCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGVfIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBxYyh0aGlzLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhlXywgSmMpO1xyXG4gICAgICAgIHZhciBpXyA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xMS4wMyAzaDYuMTQ5YS43NS43NSAwIDEgMSAwIDEuNWgtNS41MTRMMTEuMDMgM3ptMS4yNyAzaDQuODc5YS43NS43NSAwIDEgMSAwIDEuNWgtNC4yNDRMMTIuMyA2em0xLjI3IDNoMy42MDlhLjc1Ljc1IDAgMSAxIDAgMS41aC0yLjk3M0wxMy41NyA5em0tMi43NTQgMi41TDguMDM4IDQuNzg1IDUuMjYxIDExLjVoNS41NTV6bS42MiAxLjVINC42NDFsLTEuNjY2IDQuMDI4SDEuMzEybDUuNzg5LTE0aDEuODc1bDUuNzg5IDE0aC0xLjY2M0wxMS40MzYgMTN6XCIvPjwvc3ZnPic7XHJcblxyXG4gICAgICAgIGNsYXNzIG5fIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9nZXRMb2NhbGl6ZWRPcHRpb25zKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb21tYW5kcy5nZXQoamspO1xyXG4gICAgICAgICAgICAgICAgdC51aS5jb21wb25lbnRGYWN0b3J5LmFkZChqaywgbyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IFdiKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIFViKHIsIG9fKGksIG4pKTtcclxuICAgICAgICAgICAgICAgICAgICByLmJ1dHRvblZpZXcuc2V0KHtsYWJlbDogZShcImpvXCIpLCBpY29uOiBpXywgdG9vbHRpcDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHIuZXh0ZW5kVGVtcGxhdGUoe2F0dHJpYnV0ZXM6IHtjbGFzczogXCJjay1mb250LWZhbWlseS1kcm9wZG93blwifX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHIuYmluZChcImlzRW5hYmxlZFwiKS50byhuKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHIsIFwiZXhlY3V0ZVwiLCBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKGUuc291cmNlLmNvbW1hbmROYW1lLCB7dmFsdWU6IGUuc291cmNlLmNvbW1hbmRQYXJhbX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRMb2NhbGl6ZWRPcHRpb25zKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBZayh0LmNvbmZpZy5nZXQoamspLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkubWFwKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnRpdGxlID09PSBcIkRlZmF1bHRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnRpdGxlID0gZShcImpwXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvXyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgeXM7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYnV0dG9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IG5ldyBlXyh7Y29tbWFuZE5hbWU6IGprLCBjb21tYW5kUGFyYW06IG4ubW9kZWwsIGxhYmVsOiBuLnRpdGxlLCB3aXRoVGV4dDogdHJ1ZX0pXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5iaW5kKFwiaXNPblwiKS50byhlLCBcInZhbHVlXCIsIHQgPT4gdCA9PT0gbi5tb2RlbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobi52aWV3ICYmIG4udmlldy5zdHlsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm1vZGVsLnNldChcImxhYmVsU3R5bGVcIiwgYGZvbnQtZmFtaWx5OiAke24udmlldy5zdHlsZXNbXCJmb250LWZhbWlseVwiXX1gKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5hZGQodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3Mgcl8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3RfLCBuX11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRm9udEZhbWlseVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHNfIGV4dGVuZHMgRWsge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBEaylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYV8odCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5tYXAobF8pLmZpbHRlcih0ID0+ICEhdClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGNfID0ge1xyXG4gICAgICAgICAgICB0aW55OiB7dGl0bGU6IFwiVGlueVwiLCBtb2RlbDogXCJ0aW55XCIsIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgY2xhc3NlczogXCJ0ZXh0LXRpbnlcIiwgcHJpb3JpdHk6IDd9fSxcclxuICAgICAgICAgICAgc21hbGw6IHt0aXRsZTogXCJTbWFsbFwiLCBtb2RlbDogXCJzbWFsbFwiLCB2aWV3OiB7bmFtZTogXCJzcGFuXCIsIGNsYXNzZXM6IFwidGV4dC1zbWFsbFwiLCBwcmlvcml0eTogN319LFxyXG4gICAgICAgICAgICBiaWc6IHt0aXRsZTogXCJCaWdcIiwgbW9kZWw6IFwiYmlnXCIsIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgY2xhc3NlczogXCJ0ZXh0LWJpZ1wiLCBwcmlvcml0eTogN319LFxyXG4gICAgICAgICAgICBodWdlOiB7dGl0bGU6IFwiSHVnZVwiLCBtb2RlbDogXCJodWdlXCIsIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgY2xhc3NlczogXCJ0ZXh0LWh1Z2VcIiwgcHJpb3JpdHk6IDd9fVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxfKHQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjX1t0XSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNfW3RdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQgPT09IFwiZGVmYXVsdFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge21vZGVsOiB1bmRlZmluZWQsIHRpdGxlOiBcIkRlZmF1bHRcIn1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBlID0gcGFyc2VGbG9hdCh0KTtcclxuICAgICAgICAgICAgaWYgKGlzTmFOKGUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZF8oZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRfKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IFN0cmluZyh0KTtcclxuICAgICAgICAgICAgcmV0dXJuIHt0aXRsZTogZSwgbW9kZWw6IHQsIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgc3R5bGVzOiB7XCJmb250LXNpemVcIjogYCR7dH1weGB9LCBwcmlvcml0eTogN319XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB1XyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRm9udFNpemVFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbmZpZy5kZWZpbmUoRGssIHtvcHRpb25zOiBbXCJ0aW55XCIsIFwic21hbGxcIiwgXCJkZWZhdWx0XCIsIFwiYmlnXCIsIFwiaHVnZVwiXX0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGFfKHRoaXMuZWRpdG9yLmNvbmZpZy5nZXQoXCJmb250U2l6ZS5vcHRpb25zXCIpKS5maWx0ZXIodCA9PiB0Lm1vZGVsKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBxayhEaywgZSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uYXR0cmlidXRlVG9FbGVtZW50KGkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoRGssIG5ldyBzXyh0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0F0dHJpYnV0ZXM6IERrfSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKERrLCB7aXNGb3JtYXR0aW5nOiB0cnVlLCBjb3B5T25FbnRlcjogdHJ1ZX0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBoXyA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk05LjgxNiAxMS41TDcuMDM4IDQuNzg1IDQuMjYxIDExLjVoNS41NTV6bS42MiAxLjVIMy42NDFsLTEuNjY2IDQuMDI4SC4zMTJsNS43ODktMTRoMS44NzVsNS43ODkgMTRoLTEuNjYzTDEwLjQzNiAxM3ptNy41NSAyLjI3OWwuNzc5LS43NzkuNzA3LjcwNy0yLjI2NSAyLjI2NS0yLjE5My0yLjI2NS43MDctLjcwNy43NjUuNzY1VjQuODI1YzAtLjA0MiAwLS4wODMuMDAyLS4xMjNsLS43Ny43Ny0uNzA3LS43MDdMMTcuMjA3IDIuNWwyLjI2NSAyLjI2NS0uNzA3LjcwNy0uNzgyLS43ODJjLjAwMi4wNDMuMDAzLjA4OS4wMDMuMTM1djEwLjQ1NHpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgZl8gPSBpKDUzKTtcclxuXHJcbiAgICAgICAgY2xhc3MgZ18gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2dldExvY2FsaXplZE9wdGlvbnMoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChEayk7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKERrLCBvID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gV2Iobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgVWIociwgbV8oaSwgbikpO1xyXG4gICAgICAgICAgICAgICAgICAgIHIuYnV0dG9uVmlldy5zZXQoe2xhYmVsOiBlKFwianFcIiksIGljb246IGhfLCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgci5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge2NsYXNzOiBbXCJjay1mb250LXNpemUtZHJvcGRvd25cIl19fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgci5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8ociwgXCJleGVjdXRlXCIsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoZS5zb3VyY2UuY29tbWFuZE5hbWUsIHt2YWx1ZTogZS5zb3VyY2UuY29tbWFuZFBhcmFtfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gclxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldExvY2FsaXplZE9wdGlvbnMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHtEZWZhdWx0OiBlKFwianBcIiksIFRpbnk6IGUoXCJqclwiKSwgU21hbGw6IGUoXCJqc1wiKSwgQmlnOiBlKFwianRcIiksIEh1Z2U6IGUoXCJqdVwiKX07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gYV8odC5jb25maWcuZ2V0KERrKS5vcHRpb25zKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuLm1hcCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaVt0LnRpdGxlXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBlICE9IHQudGl0bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IE9iamVjdC5hc3NpZ24oe30sIHQsIHt0aXRsZTogZX0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtXyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgeXM7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYnV0dG9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IG5ldyBlXyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmROYW1lOiBEayxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZFBhcmFtOiBuLm1vZGVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbi50aXRsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFwiY2stZm9udHNpemUtb3B0aW9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpdGhUZXh0OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAobi52aWV3ICYmIG4udmlldy5zdHlsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm1vZGVsLnNldChcImxhYmVsU3R5bGVcIiwgYGZvbnQtc2l6ZToke24udmlldy5zdHlsZXNbXCJmb250LXNpemVcIl19YClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuLnZpZXcgJiYgbi52aWV3LmNsYXNzZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm1vZGVsLnNldChcImNsYXNzXCIsIGAke3QubW9kZWwuY2xhc3N9ICR7bi52aWV3LmNsYXNzZXN9YClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQubW9kZWwuYmluZChcImlzT25cIikudG8oZSwgXCJ2YWx1ZVwiLCB0ID0+IHQgPT09IG4ubW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgaS5hZGQodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgcF8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3VfLCBnX11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRm9udFNpemVcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBiXyBleHRlbmRzIEVrIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgSGspXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHdfIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJGb250Q29sb3JFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbmZpZy5kZWZpbmUoSGssIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcnM6IFt7Y29sb3I6IFwiaHNsKDAsIDAlLCAwJSlcIiwgbGFiZWw6IFwiQmxhY2tcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDAlLCAzMCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkRpbSBncmV5XCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDAsIDAlLCA2MCUpXCIsIGxhYmVsOiBcIkdyZXlcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDAlLCA5MCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkxpZ2h0IGdyZXlcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtjb2xvcjogXCJoc2woMCwgMCUsIDEwMCUpXCIsIGxhYmVsOiBcIldoaXRlXCIsIGhhc0JvcmRlcjogdHJ1ZX0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDc1JSwgNjAlKVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJSZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtjb2xvcjogXCJoc2woMzAsIDc1JSwgNjAlKVwiLCBsYWJlbDogXCJPcmFuZ2VcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDYwLCA3NSUsIDYwJSlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiWWVsbG93XCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDkwLCA3NSUsIDYwJSlcIiwgbGFiZWw6IFwiTGlnaHQgZ3JlZW5cIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDEyMCwgNzUlLCA2MCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkdyZWVuXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDE1MCwgNzUlLCA2MCUpXCIsIGxhYmVsOiBcIkFxdWFtYXJpbmVcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDE4MCwgNzUlLCA2MCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIlR1cnF1b2lzZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSwge2NvbG9yOiBcImhzbCgyMTAsIDc1JSwgNjAlKVwiLCBsYWJlbDogXCJMaWdodCBibHVlXCJ9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcImhzbCgyNDAsIDc1JSwgNjAlKVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJCbHVlXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDI3MCwgNzUlLCA2MCUpXCIsIGxhYmVsOiBcIlB1cnBsZVwifV0sIGNvbHVtbnM6IDVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcInVwY2FzdFwiKS5lbGVtZW50VG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgc3R5bGVzOiB7Y29sb3I6IC9bXFxzXFxTXSsvfX0sXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHtrZXk6IEhrLCB2YWx1ZTogVWsoXCJjb2xvclwiKX1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcImRvd25jYXN0XCIpLmF0dHJpYnV0ZVRvRWxlbWVudCh7bW9kZWw6IEhrLCB2aWV3OiAkayhcImNvbG9yXCIpfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChIaywgbmV3IGJfKHQpKTtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0F0dHJpYnV0ZXM6IEhrfSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKEhrLCB7aXNGb3JtYXR0aW5nOiB0cnVlLCBjb3B5T25FbnRlcjogdHJ1ZX0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGtfKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQudDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHtcclxuICAgICAgICAgICAgICAgIEJsYWNrOiBpKFwibHhcIiksXHJcbiAgICAgICAgICAgICAgICBcIkRpbSBncmV5XCI6IGkoXCJseVwiKSxcclxuICAgICAgICAgICAgICAgIEdyZXk6IGkoXCJselwiKSxcclxuICAgICAgICAgICAgICAgIFwiTGlnaHQgZ3JleVwiOiBpKFwibWFcIiksXHJcbiAgICAgICAgICAgICAgICBXaGl0ZTogaShcIm1iXCIpLFxyXG4gICAgICAgICAgICAgICAgUmVkOiBpKFwibWNcIiksXHJcbiAgICAgICAgICAgICAgICBPcmFuZ2U6IGkoXCJtZFwiKSxcclxuICAgICAgICAgICAgICAgIFllbGxvdzogaShcIm1lXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJMaWdodCBncmVlblwiOiBpKFwibWZcIiksXHJcbiAgICAgICAgICAgICAgICBHcmVlbjogaShcIm1nXCIpLFxyXG4gICAgICAgICAgICAgICAgQXF1YW1hcmluZTogaShcIm1oXCIpLFxyXG4gICAgICAgICAgICAgICAgVHVycXVvaXNlOiBpKFwibWlcIiksXHJcbiAgICAgICAgICAgICAgICBcIkxpZ2h0IGJsdWVcIjogaShcIm1qXCIpLFxyXG4gICAgICAgICAgICAgICAgQmx1ZTogaShcIm1rXCIpLFxyXG4gICAgICAgICAgICAgICAgUHVycGxlOiBpKFwibWxcIilcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmV0dXJuIGUubWFwKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5bdC5sYWJlbF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZSAmJiBlICE9IHQubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmxhYmVsID0gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9fKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQubWFwKHZfKS5maWx0ZXIodCA9PiAhIXQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB2Xyh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogdC5yZXBsYWNlKC8gL2csIFwiXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiB0LFxyXG4gICAgICAgICAgICAgICAgICAgIGhhc0JvcmRlcjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzoge25hbWU6IFwic3BhblwiLCBzdHlsZXM6IHtjb2xvcjogdH19XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiB0LmNvbG9yLnJlcGxhY2UoLyAvZywgXCJcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHQubGFiZWwgfHwgdC5jb2xvcixcclxuICAgICAgICAgICAgICAgICAgICBoYXNCb3JkZXI6IHQuaGFzQm9yZGVyID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IHQuaGFzQm9yZGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHtuYW1lOiBcInNwYW5cIiwgc3R5bGVzOiB7Y29sb3I6IGAke3QuY29sb3J9YH19XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHlfIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCB7Y29tbWFuZE5hbWU6IGUsIGljb246IGksIGNvbXBvbmVudE5hbWU6IG4sIGRyb3Bkb3duTGFiZWw6IG99KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29tbWFuZE5hbWUgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnROYW1lID0gbjtcclxuICAgICAgICAgICAgICAgIHRoaXMuaWNvbiA9IGk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRyb3Bkb3duTGFiZWwgPSBvO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2x1bW5zID0gdC5jb25maWcuZ2V0KGAke3RoaXMuY29tcG9uZW50TmFtZX0uY29sdW1uc2ApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvclRhYmxlVmlld1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldCh0aGlzLmNvbW1hbmROYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBfXyh0LmNvbmZpZy5nZXQodGhpcy5jb21wb25lbnROYW1lKS5jb2xvcnMpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGtfKGUsIG8pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHQuY29uZmlnLmdldChgJHt0aGlzLmNvbXBvbmVudE5hbWV9LmRvY3VtZW50Q29sb3JzYCk7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKHRoaXMuY29tcG9uZW50TmFtZSwgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IFdiKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JUYWJsZVZpZXcgPSBHayh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duVmlldzogbyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzOiByLm1hcCh0ID0+ICh7bGFiZWw6IHQubGFiZWwsIGNvbG9yOiB0Lm1vZGVsLCBvcHRpb25zOiB7aGFzQm9yZGVyOiB0Lmhhc0JvcmRlcn19KSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IHRoaXMuY29sdW1ucyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlQnV0dG9uTGFiZWw6IGkoXCJsaVwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRDb2xvcnNMYWJlbDogcyAhPT0gMCA/IGkoXCJsalwiKSA6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRDb2xvcnNDb3VudDogcyA9PT0gdW5kZWZpbmVkID8gdGhpcy5jb2x1bW5zIDogc1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JUYWJsZVZpZXcuYmluZChcInNlbGVjdGVkQ29sb3JcIikudG8obiwgXCJ2YWx1ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJ1dHRvblZpZXcuc2V0KHtsYWJlbDogdGhpcy5kcm9wZG93bkxhYmVsLCBpY29uOiB0aGlzLmljb24sIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IFwiY2stY29sb3ItdWktZHJvcGRvd25cIn19KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc0VuYWJsZWRcIikudG8obik7XHJcbiAgICAgICAgICAgICAgICAgICAgby5vbihcImV4ZWN1dGVcIiwgKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKHRoaXMuY29tbWFuZE5hbWUsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5vbihcImNoYW5nZTppc09wZW5cIiwgKGUsIGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5jb2xvclRhYmxlVmlldy5hcHBlbmRHcmlkcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMgIT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbG9yVGFibGVWaWV3LnVwZGF0ZURvY3VtZW50Q29sb3JzKHQubW9kZWwsIHRoaXMuY29tcG9uZW50TmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29sb3JUYWJsZVZpZXcudXBkYXRlU2VsZWN0ZWRDb2xvcnMoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB4XyA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xMi40IDEwLjNMMTAgNC41bC0yLjQgNS44aDQuOHptLjUgMS4ySDcuMUw1LjcgMTVINC4ybDUtMTJoMS42bDUgMTJoLTEuNUwxMyAxMS41em0zLjEgN0g0YTEgMSAwIDAgMSAwLTJoMTJhMSAxIDAgMCAxIDAgMnpcIi8+PC9zdmc+JztcclxuXHJcbiAgICAgICAgY2xhc3MgQ18gZXh0ZW5kcyB5XyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmxvY2FsZS50O1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwge2NvbW1hbmROYW1lOiBIaywgY29tcG9uZW50TmFtZTogSGssIGljb246IHhfLCBkcm9wZG93bkxhYmVsOiBlKFwianZcIil9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJGb250Q29sb3JVSVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEFfIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt3XywgQ19dXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkZvbnRDb2xvclwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFRfIGV4dGVuZHMgRWsge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBXaylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgUF8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkZvbnRCYWNrZ3JvdW5kQ29sb3JFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbmZpZy5kZWZpbmUoV2ssIHtcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcnM6IFt7Y29sb3I6IFwiaHNsKDAsIDAlLCAwJSlcIiwgbGFiZWw6IFwiQmxhY2tcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDAlLCAzMCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkRpbSBncmV5XCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDAsIDAlLCA2MCUpXCIsIGxhYmVsOiBcIkdyZXlcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDAlLCA5MCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkxpZ2h0IGdyZXlcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtjb2xvcjogXCJoc2woMCwgMCUsIDEwMCUpXCIsIGxhYmVsOiBcIldoaXRlXCIsIGhhc0JvcmRlcjogdHJ1ZX0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDc1JSwgNjAlKVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJSZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtjb2xvcjogXCJoc2woMzAsIDc1JSwgNjAlKVwiLCBsYWJlbDogXCJPcmFuZ2VcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDYwLCA3NSUsIDYwJSlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiWWVsbG93XCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDkwLCA3NSUsIDYwJSlcIiwgbGFiZWw6IFwiTGlnaHQgZ3JlZW5cIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDEyMCwgNzUlLCA2MCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkdyZWVuXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDE1MCwgNzUlLCA2MCUpXCIsIGxhYmVsOiBcIkFxdWFtYXJpbmVcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiaHNsKDE4MCwgNzUlLCA2MCUpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIlR1cnF1b2lzZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSwge2NvbG9yOiBcImhzbCgyMTAsIDc1JSwgNjAlKVwiLCBsYWJlbDogXCJMaWdodCBibHVlXCJ9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBcImhzbCgyNDAsIDc1JSwgNjAlKVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJCbHVlXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDI3MCwgNzUlLCA2MCUpXCIsIGxhYmVsOiBcIlB1cnBsZVwifV0sIGNvbHVtbnM6IDVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcInVwY2FzdFwiKS5lbGVtZW50VG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJzcGFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlczoge1wiYmFja2dyb3VuZC1jb2xvclwiOiAvW1xcc1xcU10rL31cclxuICAgICAgICAgICAgICAgICAgICB9LCBtb2RlbDoge2tleTogV2ssIHZhbHVlOiBVayhcImJhY2tncm91bmQtY29sb3JcIil9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5mb3IoXCJkb3duY2FzdFwiKS5hdHRyaWJ1dGVUb0VsZW1lbnQoe21vZGVsOiBXaywgdmlldzogJGsoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChXaywgbmV3IFRfKHQpKTtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0F0dHJpYnV0ZXM6IFdrfSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKFdrLCB7aXNGb3JtYXR0aW5nOiB0cnVlLCBjb3B5T25FbnRlcjogdHJ1ZX0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBTXyA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk00IDJoMTJhMiAyIDAgMCAxIDIgMnYxMmEyIDIgMCAwIDEtMiAySDRhMiAyIDAgMCAxLTItMlY0YTIgMiAwIDAgMSAyLTJ6bTguMzggOS4yNjJINy42MkwxMCA1LjUwNmwyLjM4IDUuNzU2em0uNTMyIDEuMjg1TDE0LjM0IDE2aDEuNDI2TDEwLjgwNCA0SDkuMTk2TDQuMjM0IDE2SDUuNjZsMS40MjgtMy40NTNoNS44MjR6XCIvPjwvc3ZnPic7XHJcblxyXG4gICAgICAgIGNsYXNzIEVfIGV4dGVuZHMgeV8ge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sb2NhbGUudDtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIHtjb21tYW5kTmFtZTogV2ssIGNvbXBvbmVudE5hbWU6IFdrLCBpY29uOiBTXywgZHJvcGRvd25MYWJlbDogZShcImp3XCIpfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRm9udEJhY2tncm91bmRDb2xvclVJXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgUl8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1BfLCBFX11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRm9udEJhY2tncm91bmRDb2xvclwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIE9fIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gV3coZS5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRCbG9ja3MoKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gISFpICYmIGkuaXMoXCJwYXJhZ3JhcGhcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9ICEhaSAmJiBJXyhpLCB0LnNjaGVtYSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgZS5jaGFuZ2UobiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9ICh0LnNlbGVjdGlvbiB8fCBpLnNlbGVjdGlvbikuZ2V0U2VsZWN0ZWRCbG9ja3MoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXQuaXMoXCJwYXJhZ3JhcGhcIikgJiYgSV8odCwgZS5zY2hlbWEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnJlbmFtZSh0LCBcInBhcmFncmFwaFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSV8odCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZS5jaGVja0NoaWxkKHQucGFyZW50LCBcInBhcmFncmFwaFwiKSAmJiAhZS5pc09iamVjdCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgVl8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlBhcmFncmFwaFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmRhdGE7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInBhcmFncmFwaFwiLCBuZXcgT18odCkpO1xyXG4gICAgICAgICAgICAgICAgZS5zY2hlbWEucmVnaXN0ZXIoXCJwYXJhZ3JhcGhcIiwge2luaGVyaXRBbGxGcm9tOiBcIiRibG9ja1wifSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uZWxlbWVudFRvRWxlbWVudCh7bW9kZWw6IFwicGFyYWdyYXBoXCIsIHZpZXc6IFwicFwifSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uZm9yKFwidXBjYXN0XCIpLmVsZW1lbnRUb0VsZW1lbnQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVZfLnBhcmFncmFwaExpa2VFbGVtZW50cy5oYXModC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5pc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmNyZWF0ZUVsZW1lbnQoXCJwYXJhZ3JhcGhcIilcclxuICAgICAgICAgICAgICAgICAgICB9LCBjb252ZXJ0ZXJQcmlvcml0eTogXCJsb3dcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpLnVwY2FzdERpc3BhdGNoZXIub24oXCJlbGVtZW50XCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpLmNvbnN1bWFibGUudGVzdChlLnZpZXdJdGVtLCB7bmFtZTogZS52aWV3SXRlbS5uYW1lfSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNXyhlLnZpZXdJdGVtLCBlLm1vZGVsQ3Vyc29yLCBpLnNjaGVtYSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihlLCBOXyhlLnZpZXdJdGVtLCBlLm1vZGVsQ3Vyc29yLCBpKSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIGkudXBjYXN0RGlzcGF0Y2hlci5vbihcInRleHRcIiwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5tb2RlbFJhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoTV8oZS52aWV3SXRlbSwgZS5tb2RlbEN1cnNvciwgaS5zY2hlbWEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZSwgTl8oZS52aWV3SXRlbSwgZS5tb2RlbEN1cnNvciwgaSkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd2VzdFwifSk7XHJcbiAgICAgICAgICAgICAgICBlLmRvY3VtZW50LnJlZ2lzdGVyUG9zdEZpeGVyKHQgPT4gdGhpcy5fYXV0b3BhcmFncmFwaEVtcHR5Um9vdHModCkpO1xyXG4gICAgICAgICAgICAgICAgdC5kYXRhLm9uKFwicmVhZHlcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuZW5xdWV1ZUNoYW5nZShcInRyYW5zcGFyZW50XCIsIHQgPT4gdGhpcy5fYXV0b3BhcmFncmFwaEVtcHR5Um9vdHModCkpXHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93ZXN0XCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYXV0b3BhcmFncmFwaEVtcHR5Um9vdHModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUuZG9jdW1lbnQuZ2V0Um9vdE5hbWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5kb2N1bWVudC5nZXRSb290KGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuLmlzRW1wdHkgJiYgbi5yb290TmFtZSAhPSBcIiRncmF2ZXlhcmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5zY2hlbWEuY2hlY2tDaGlsZChuLCBcInBhcmFncmFwaFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5pbnNlcnRFbGVtZW50KFwicGFyYWdyYXBoXCIsIG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgVl8ucGFyYWdyYXBoTGlrZUVsZW1lbnRzID0gbmV3IFNldChbXCJibG9ja3F1b3RlXCIsIFwiZGRcIiwgXCJkaXZcIiwgXCJkdFwiLCBcImgxXCIsIFwiaDJcIiwgXCJoM1wiLCBcImg0XCIsIFwiaDVcIiwgXCJoNlwiLCBcImxpXCIsIFwicFwiLCBcInRkXCJdKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTl8odCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaS53cml0ZXIuY3JlYXRlRWxlbWVudChcInBhcmFncmFwaFwiKTtcclxuICAgICAgICAgICAgaS53cml0ZXIuaW5zZXJ0KG4sIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gaS5jb252ZXJ0SXRlbSh0LCBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KG4sIDApKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTV8odCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaS5jcmVhdGVDb250ZXh0KGUpO1xyXG4gICAgICAgICAgICBpZiAoIWkuY2hlY2tDaGlsZChuLCBcInBhcmFncmFwaFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFpLmNoZWNrQ2hpbGQobi5wdXNoKFwicGFyYWdyYXBoXCIpLCB0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEJfIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWxFbGVtZW50cyA9IGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBXdyh0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRCbG9ja3MoKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gISF0ICYmIHRoaXMubW9kZWxFbGVtZW50cy5pbmNsdWRlcyh0Lm5hbWUpICYmIHQubmFtZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gISF0ICYmIHRoaXMubW9kZWxFbGVtZW50cy5zb21lKGUgPT4gel8odCwgZSwgdGhpcy5lZGl0b3IubW9kZWwuc2NoZW1hKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgZS5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IEFycmF5LmZyb20oaS5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRCbG9ja3MoKSkuZmlsdGVyKHQgPT4gel8odCwgbiwgZS5zY2hlbWEpKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWUuaXMobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucmVuYW1lKGUsIG4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB6Xyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpLmNoZWNrQ2hpbGQodC5wYXJlbnQsIGUpICYmICFpLmlzT2JqZWN0KHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBMXyA9IFwicGFyYWdyYXBoXCI7XHJcblxyXG4gICAgICAgIGNsYXNzIEZfIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJIZWFkaW5nRWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdC5jb25maWcuZGVmaW5lKFwiaGVhZGluZ1wiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9uczogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IFwicGFyYWdyYXBoXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlBhcmFncmFwaFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJjay1oZWFkaW5nX3BhcmFncmFwaFwiXHJcbiAgICAgICAgICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogXCJoZWFkaW5nMVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3OiBcImgyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIkhlYWRpbmcgMVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJjay1oZWFkaW5nX2hlYWRpbmcxXCJcclxuICAgICAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBcImhlYWRpbmcyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXc6IFwiaDNcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiSGVhZGluZyAyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImNrLWhlYWRpbmdfaGVhZGluZzJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHttb2RlbDogXCJoZWFkaW5nM1wiLCB2aWV3OiBcImg0XCIsIHRpdGxlOiBcIkhlYWRpbmcgM1wiLCBjbGFzczogXCJjay1oZWFkaW5nX2hlYWRpbmczXCJ9XVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbVl9dXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jb25maWcuZ2V0KFwiaGVhZGluZy5vcHRpb25zXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5tb2RlbCAhPT0gTF8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEucmVnaXN0ZXIobi5tb2RlbCwge2luaGVyaXRBbGxGcm9tOiBcIiRibG9ja1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5lbGVtZW50VG9FbGVtZW50KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gobi5tb2RlbClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGREZWZhdWx0SDFDb252ZXJzaW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJoZWFkaW5nXCIsIG5ldyBCXyh0LCBpKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWZ0ZXJJbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuY29tbWFuZHMuZ2V0KFwiZW50ZXJcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jb25maWcuZ2V0KFwiaGVhZGluZy5vcHRpb25zXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwiYWZ0ZXJFeGVjdXRlXCIsIChlLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0Lm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gaS5zb21lKHQgPT4gby5pcyh0Lm1vZGVsKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyICYmICFvLmlzKExfKSAmJiBvLmNoaWxkQ291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ud3JpdGVyLnJlbmFtZShvLCBMXylcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hZGREZWZhdWx0SDFDb252ZXJzaW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5mb3IoXCJ1cGNhc3RcIikuZWxlbWVudFRvRWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IFwiaGVhZGluZzFcIixcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiBcImgxXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udmVydGVyUHJpb3JpdHk6IG9zLmdldChcImxvd1wiKSArIDFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIERfKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHtcclxuICAgICAgICAgICAgICAgIFBhcmFncmFwaDogZShcIm55XCIpLFxyXG4gICAgICAgICAgICAgICAgXCJIZWFkaW5nIDFcIjogZShcIm56XCIpLFxyXG4gICAgICAgICAgICAgICAgXCJIZWFkaW5nIDJcIjogZShcIm9hXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJIZWFkaW5nIDNcIjogZShcIm9iXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJIZWFkaW5nIDRcIjogZShcIm9jXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJIZWFkaW5nIDVcIjogZShcIm9kXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJIZWFkaW5nIDZcIjogZShcIm9lXCIpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybiB0LmNvbmZpZy5nZXQoXCJoZWFkaW5nLm9wdGlvbnNcIikubWFwKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGlbdC50aXRsZV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZSAmJiBlICE9IHQudGl0bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnRpdGxlID0gZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBqXyA9IGkoMTEpO1xyXG5cclxuICAgICAgICBjbGFzcyBIXyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gRF8odCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZShcImpkXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUoXCJqZVwiKTtcclxuICAgICAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoXCJoZWFkaW5nXCIsIGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IHlzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSB0LmNvbW1hbmRzLmdldChcImhlYWRpbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IHQuY29tbWFuZHMuZ2V0KFwicGFyYWdyYXBoXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBbYV07XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHt0eXBlOiBcImJ1dHRvblwiLCBtb2RlbDogbmV3IGVfKHtsYWJlbDogdC50aXRsZSwgY2xhc3M6IHQuY2xhc3MsIHdpdGhUZXh0OiB0cnVlfSl9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5tb2RlbCA9PT0gXCJwYXJhZ3JhcGhcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5tb2RlbC5iaW5kKFwiaXNPblwiKS50byhjLCBcInZhbHVlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5tb2RlbC5zZXQoXCJjb21tYW5kTmFtZVwiLCBcInBhcmFncmFwaFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwucHVzaChjKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5tb2RlbC5iaW5kKFwiaXNPblwiKS50byhhLCBcInZhbHVlXCIsIGUgPT4gZSA9PT0gdC5tb2RlbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLm1vZGVsLnNldCh7Y29tbWFuZE5hbWU6IFwiaGVhZGluZ1wiLCBjb21tYW5kVmFsdWU6IHQubW9kZWx9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMuYWRkKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByW3QubW9kZWxdID0gdC50aXRsZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkID0gV2IoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgVWIoZCwgcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5idXR0b25WaWV3LnNldCh7aXNPbjogZmFsc2UsIHdpdGhUZXh0OiB0cnVlLCB0b29sdGlwOiBvfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZC5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge2NsYXNzOiBbXCJjay1oZWFkaW5nLWRyb3Bkb3duXCJdfX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGQuYmluZChcImlzRW5hYmxlZFwiKS50b01hbnkobCwgXCJpc0VuYWJsZWRcIiwgKC4uLnQpID0+IHQuc29tZSh0ID0+IHQpKTtcclxuICAgICAgICAgICAgICAgICAgICBkLmJ1dHRvblZpZXcuYmluZChcImxhYmVsXCIpLnRvKGEsIFwidmFsdWVcIiwgYywgXCJ2YWx1ZVwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdCB8fCBlICYmIFwicGFyYWdyYXBoXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByW2ldID8gcltpXSA6IG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGQsIFwiZXhlY3V0ZVwiLCBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKGUuc291cmNlLmNvbW1hbmROYW1lLCBlLnNvdXJjZS5jb21tYW5kVmFsdWUgPyB7dmFsdWU6IGUuc291cmNlLmNvbW1hbmRWYWx1ZX0gOiB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFdfIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtGXywgSF9dXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkhlYWRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBxXyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhY2sgPSBbXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZGQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3N0YWNrO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGlbMF07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnNlcnREZXNjcmlwdG9yKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGlbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAobiAhPT0gbyAmJiAhVV8obiwgbykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6dG9wXCIsIHtvbGREZXNjcmlwdG9yOiBuLCBuZXdEZXNjcmlwdG9yOiBvLCB3cml0ZXI6IGV9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW1vdmUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3N0YWNrO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGlbMF07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVEZXNjcmlwdG9yKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGlbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAobiAhPT0gbyAmJiAhVV8obiwgbykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJjaGFuZ2U6dG9wXCIsIHtvbGREZXNjcmlwdG9yOiBuLCBuZXdEZXNjcmlwdG9yOiBvLCB3cml0ZXI6IGV9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaW5zZXJ0RGVzY3JpcHRvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fc3RhY2s7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5maW5kSW5kZXgoZSA9PiBlLmlkID09PSB0LmlkKTtcclxuICAgICAgICAgICAgICAgIGlmIChVXyh0LCBlW2ldKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3BsaWNlKGksIDEpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoZVtuXSAmJiAkXyhlW25dLCB0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4rK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZS5zcGxpY2UobiwgMCwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZURlc2NyaXB0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuX3N0YWNrO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZmluZEluZGV4KGUgPT4gZS5pZCA9PT0gdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zcGxpY2UoaSwgMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMocV8sIGRzKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVV8odCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCAmJiBlICYmIHQucHJpb3JpdHkgPT0gZS5wcmlvcml0eSAmJiBHXyh0LmNsYXNzZXMpID09IEdfKGUuY2xhc3NlcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uICRfKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKHQucHJpb3JpdHkgPiBlLnByaW9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQucHJpb3JpdHkgPCBlLnByaW9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gR18odC5jbGFzc2VzKSA+IEdfKGUuY2xhc3NlcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEdfKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodCkgPyB0LnNvcnQoKS5qb2luKFwiLFwiKSA6IHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBLXyA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMTYgMTZcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk00IDB2MUgxdjNIMFYuNUEuNS41IDAgMCAxIC41IDBINHptOCAwaDMuNWEuNS41IDAgMCAxIC41LjVWNGgtMVYxaC0zVjB6TTQgMTZILjVhLjUuNSAwIDAgMS0uNS0uNVYxMmgxdjNoM3Yxem04IDB2LTFoM3YtM2gxdjMuNWEuNS41IDAgMCAxLS41LjVIMTJ6XCIvPjxwYXRoIGZpbGwtb3BhY2l0eT1cIi4yNTZcIiBkPVwiTTEgMWgxNHYxNEgxelwiLz48ZyBjbGFzcz1cImNrLWljb25fX3NlbGVjdGVkLWluZGljYXRvclwiPjxwYXRoIGQ9XCJNNyAwaDJ2MUg3VjB6TTAgN2gxdjJIMFY3em0xNSAwaDF2MmgtMVY3em0tOCA4aDJ2MUg3di0xelwiLz48cGF0aCBmaWxsLW9wYWNpdHk9XCIuMjU0XCIgZD1cIk0xIDFoMTR2MTRIMXpcIi8+PC9nPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgSl8gPSBcImNrLXdpZGdldFwiO1xyXG4gICAgICAgIGNvbnN0IFlfID0gXCJjay13aWRnZXRfc2VsZWN0ZWRcIjtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUV8odCkge1xyXG4gICAgICAgICAgICBpZiAoIXQuaXMoXCJlbGVtZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gISF0LmdldEN1c3RvbVByb3BlcnR5KFwid2lkZ2V0XCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBYXyh0LCBlLCBpID0ge30pIHtcclxuICAgICAgICAgICAgaWYgKCFBbC5pc0VkZ2UpIHtcclxuICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKFwiY29udGVudGVkaXRhYmxlXCIsIFwiZmFsc2VcIiwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlLmFkZENsYXNzKEpfLCB0KTtcclxuICAgICAgICAgICAgZS5zZXRDdXN0b21Qcm9wZXJ0eShcIndpZGdldFwiLCB0cnVlLCB0KTtcclxuICAgICAgICAgICAgdC5nZXRGaWxsZXJPZmZzZXQgPSBydjtcclxuICAgICAgICAgICAgaWYgKGkubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIHR2KHQsIGkubGFiZWwsIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGkuaGFzU2VsZWN0aW9uSGFuZGxlKSB7XHJcbiAgICAgICAgICAgICAgICBzdih0LCBlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFpfKHQsIGUsICh0LCBlLCBpKSA9PiBpLmFkZENsYXNzKG4oZS5jbGFzc2VzKSwgdCksICh0LCBlLCBpKSA9PiBpLnJlbW92ZUNsYXNzKG4oZS5jbGFzc2VzKSwgdCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gdDtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIG4odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodCkgPyB0IDogW3RdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFpfKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBxXztcclxuICAgICAgICAgICAgby5vbihcImNoYW5nZTp0b3BcIiwgKGUsIG8pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChvLm9sZERlc2NyaXB0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBuKHQsIG8ub2xkRGVzY3JpcHRvciwgby53cml0ZXIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoby5uZXdEZXNjcmlwdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSh0LCBvLm5ld0Rlc2NyaXB0b3IsIG8ud3JpdGVyKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZS5zZXRDdXN0b21Qcm9wZXJ0eShcImFkZEhpZ2hsaWdodFwiLCAodCwgZSwgaSkgPT4gby5hZGQoZSwgaSksIHQpO1xyXG4gICAgICAgICAgICBlLnNldEN1c3RvbVByb3BlcnR5KFwicmVtb3ZlSGlnaGxpZ2h0XCIsICh0LCBlLCBpKSA9PiBvLnJlbW92ZShlLCBpKSwgdClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHR2KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaS5zZXRDdXN0b21Qcm9wZXJ0eShcIndpZGdldExhYmVsXCIsIGUsIHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBldih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldEN1c3RvbVByb3BlcnR5KFwid2lkZ2V0TGFiZWxcIik7XHJcbiAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGUgPT0gXCJmdW5jdGlvblwiID8gZSgpIDogZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaXYodCwgZSkge1xyXG4gICAgICAgICAgICBlLmFkZENsYXNzKFtcImNrLWVkaXRvcl9fZWRpdGFibGVcIiwgXCJjay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZVwiXSwgdCk7XHJcbiAgICAgICAgICAgIGlmICghQWwuaXNFZGdlKSB7XHJcbiAgICAgICAgICAgICAgICBlLnNldEF0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiLCB0LmlzUmVhZE9ubHkgPyBcImZhbHNlXCIgOiBcInRydWVcIiwgdCk7XHJcbiAgICAgICAgICAgICAgICB0Lm9uKFwiY2hhbmdlOmlzUmVhZE9ubHlcIiwgKGksIG4sIG8pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLnNldEF0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiLCBvID8gXCJmYWxzZVwiIDogXCJ0cnVlXCIsIHQpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQub24oXCJjaGFuZ2U6aXNGb2N1c2VkXCIsIChpLCBuLCBvKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYWRkQ2xhc3MoXCJjay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZV9mb2N1c2VkXCIsIHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucmVtb3ZlQ2xhc3MoXCJjay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZV9mb2N1c2VkXCIsIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbnYodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5nZXRTZWxlY3RlZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgaWYgKGkgJiYgZS5zY2hlbWEuaXNCbG9jayhpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuY3JlYXRlUG9zaXRpb25BZnRlcihpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldFNlbGVjdGVkQmxvY2tzKCkubmV4dCgpLnZhbHVlO1xyXG4gICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4uaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmNyZWF0ZVBvc2l0aW9uQXQobiwgMClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIobik7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5mb2N1cy5pc1RvdWNoaW5nKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBlLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHQuZm9jdXNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG92KHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7bWFwcGVyOiBvLCB2aWV3UG9zaXRpb246IHJ9ID0gbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvLmZpbmRNYXBwZWRWaWV3QW5jZXN0b3Iocik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUocykpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBvLnRvTW9kZWxFbGVtZW50KHMpO1xyXG4gICAgICAgICAgICAgICAgbi5tb2RlbFBvc2l0aW9uID0gdC5jcmVhdGVQb3NpdGlvbkF0KGEsIHIuaXNBdFN0YXJ0ID8gXCJiZWZvcmVcIiA6IFwiYWZ0ZXJcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcnYoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzdih0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBlLmNyZWF0ZVVJRWxlbWVudChcImRpdlwiLCB7Y2xhc3M6IFwiY2sgY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxlXCJ9LCAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnRvRG9tRWxlbWVudCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgY2I7XHJcbiAgICAgICAgICAgICAgICBpLnNldChcImNvbnRlbnRcIiwgS18pO1xyXG4gICAgICAgICAgICAgICAgaS5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIGUuYXBwZW5kQ2hpbGQoaS5lbGVtZW50KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgZS5pbnNlcnQoZS5jcmVhdGVQb3NpdGlvbkF0KHQsIDApLCBpKTtcclxuICAgICAgICAgICAgZS5hZGRDbGFzcyhbXCJjay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlXCJdLCB0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgYXYgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGN2KHRoaXMuZWRpdG9yLm1vZGVsKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgdC5jaGFuZ2UoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuY3JlYXRlRWxlbWVudChcImhvcml6b250YWxMaW5lXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuaW5zZXJ0Q29udGVudChpKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbiA9IGkubmV4dFNpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG4gJiYgdC5zY2hlbWEuY2hlY2tDaGlsZChuLCBcIiR0ZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbyAmJiB0LnNjaGVtYS5jaGVja0NoaWxkKGkucGFyZW50LCBcInBhcmFncmFwaFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gZS5jcmVhdGVFbGVtZW50KFwicGFyYWdyYXBoXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lmluc2VydENvbnRlbnQobiwgZS5jcmVhdGVQb3NpdGlvbkFmdGVyKGkpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnNldFNlbGVjdGlvbihuLCAwKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGN2KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuc2NoZW1hO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgIHJldHVybiBsdihpLCBlLCB0KSAmJiAhZHYoaSwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGx2KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHV2KHQsIGkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZS5jaGVja0NoaWxkKG4sIFwiaG9yaXpvbnRhbExpbmVcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGR2KHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpICYmIGUuaXNPYmplY3QoaSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHV2KHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IG52KHQsIGUpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaS5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGlmIChuLmlzRW1wdHkgJiYgIW4uaXMoXCIkcm9vdFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGFyZW50XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBodiA9IGkoNTYpO1xyXG5cclxuICAgICAgICBjbGFzcyBmdiBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSG9yaXpvbnRhbExpbmVFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb252ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgZS5yZWdpc3RlcihcImhvcml6b250YWxMaW5lXCIsIHtpc09iamVjdDogdHJ1ZSwgYWxsb3dXaGVyZTogXCIkYmxvY2tcIn0pO1xyXG4gICAgICAgICAgICAgICAgbi5mb3IoXCJkYXRhRG93bmNhc3RcIikuZWxlbWVudFRvRWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IFwiaG9yaXpvbnRhbExpbmVcIixcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiAodCwgZSkgPT4gZS5jcmVhdGVFbXB0eUVsZW1lbnQoXCJoclwiKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImVkaXRpbmdEb3duY2FzdFwiKS5lbGVtZW50VG9FbGVtZW50KHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogXCJob3Jpem9udGFsTGluZVwiLCB2aWV3OiAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaShcImpmXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5jcmVhdGVDb250YWluZXJFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gZS5jcmVhdGVFbXB0eUVsZW1lbnQoXCJoclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5hZGRDbGFzcyhcImNrLWhvcml6b250YWwtbGluZVwiLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRDdXN0b21Qcm9wZXJ0eShcImhyXCIsIHRydWUsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmluc2VydChlLmNyZWF0ZVBvc2l0aW9uQXQobywgMCksIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ3YobywgZSwgbilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwidXBjYXN0XCIpLmVsZW1lbnRUb0VsZW1lbnQoe3ZpZXc6IFwiaHJcIiwgbW9kZWw6IFwiaG9yaXpvbnRhbExpbmVcIn0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJob3Jpem9udGFsTGluZVwiLCBuZXcgYXYodCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGd2KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgZS5zZXRDdXN0b21Qcm9wZXJ0eShcImhvcml6b250YWxMaW5lXCIsIHRydWUsIHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gWF8odCwgZSwge2xhYmVsOiBpfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtdiA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0yIDloMTZ2MkgyelwiLz48L3N2Zz4nO1xyXG5cclxuICAgICAgICBjbGFzcyBwdiBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKFwiaG9yaXpvbnRhbExpbmVcIiwgaSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuY29tbWFuZHMuZ2V0KFwiaG9yaXpvbnRhbExpbmVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBoYihpKTtcclxuICAgICAgICAgICAgICAgICAgICBvLnNldCh7bGFiZWw6IGUoXCJqZlwiKSwgaWNvbjogbXYsIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc0VuYWJsZWRcIikudG8obiwgXCJpc0VuYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhvLCBcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoXCJob3Jpem9udGFsTGluZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5lZGl0aW5nLnZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBidiBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbZnYsIHB2XVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJIb3Jpem9udGFsTGluZVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHd2IGV4dGVuZHMgR2Qge1xyXG4gICAgICAgICAgICBvYnNlcnZlKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odCwgXCJsb2FkXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUudGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLnRhZ05hbWUgPT0gXCJJTUdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXJlRXZlbnRzKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwge3VzZUNhcHR1cmU6IHRydWV9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZmlyZUV2ZW50cyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50LmZpcmUoXCJsYXlvdXRDaGFuZ2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuZmlyZShcImltYWdlTG9hZGVkXCIsIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGt2KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgZS5zZXRDdXN0b21Qcm9wZXJ0eShcImltYWdlXCIsIHRydWUsIHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gWF8odCwgZSwge2xhYmVsOiBufSk7XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBuKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IEF2KHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuZ2V0QXR0cmlidXRlKFwiYWx0XCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPyBgJHtufSAke2l9YCA6IGlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX3YodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISF0LmdldEN1c3RvbVByb3BlcnR5KFwiaW1hZ2VcIikgJiYgUV8odClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHZ2KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIGlmIChlICYmIF92KGUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB5dih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhIXQgJiYgdC5pcyhcImltYWdlXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB4dih0LCBlLCBpID0ge30pIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHQuY3JlYXRlRWxlbWVudChcImltYWdlXCIsIGkpO1xyXG4gICAgICAgICAgICBjb25zdCBvID0gbnYoZS5kb2N1bWVudC5zZWxlY3Rpb24sIGUpO1xyXG4gICAgICAgICAgICBlLmluc2VydENvbnRlbnQobiwgbyk7XHJcbiAgICAgICAgICAgIGlmIChuLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24obiwgXCJvblwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBDdih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnNjaGVtYTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICByZXR1cm4gVHYoaSwgZSwgdCkgJiYgIVB2KGksIGUpICYmIFN2KGkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBBdih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHQuZ2V0Q2hpbGRyZW4oKSkuZmluZCh0ID0+IHQuaXMoXCJpbWdcIikpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBUdih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBFdih0LCBpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGUuY2hlY2tDaGlsZChuLCBcImltYWdlXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBQdih0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmdldFNlbGVjdGVkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gaSAmJiBlLmlzT2JqZWN0KGkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBTdih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbLi4udC5mb2N1cy5nZXRBbmNlc3RvcnMoKV0uZXZlcnkodCA9PiAhdC5pcyhcImltYWdlXCIpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRXYodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gbnYodCwgZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpLnBhcmVudDtcclxuICAgICAgICAgICAgaWYgKG4uaXNFbXB0eSAmJiAhbi5pcyhcIiRyb290XCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUnYoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IHtcclxuICAgICAgICAgICAgICAgIGUub24oXCJlbGVtZW50OmZpZ3VyZVwiLCB0KVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS50ZXN0KGUudmlld0l0ZW0sIHtuYW1lOiB0cnVlLCBjbGFzc2VzOiBcImltYWdlXCJ9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEF2KGUudmlld0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuIHx8ICFuLmhhc0F0dHJpYnV0ZShcInNyY1wiKSB8fCAhaS5jb25zdW1hYmxlLnRlc3Qobiwge25hbWU6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkuY29udmVydEl0ZW0obiwgZS5tb2RlbEN1cnNvcik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gV3coby5tb2RlbFJhbmdlLmdldEl0ZW1zKCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpLmNvbnZlcnRDaGlsZHJlbihlLnZpZXdJdGVtLCBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KHIsIDApKTtcclxuICAgICAgICAgICAgICAgIGUubW9kZWxSYW5nZSA9IG8ubW9kZWxSYW5nZTtcclxuICAgICAgICAgICAgICAgIGUubW9kZWxDdXJzb3IgPSBvLm1vZGVsQ3Vyc29yXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE92KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiYXR0cmlidXRlOnNyY3NldDppbWFnZVwiLCB0KVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS5jb25zdW1lKGUuaXRlbSwgdC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkud3JpdGVyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkubWFwcGVyLnRvVmlld0VsZW1lbnQoZS5pdGVtKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBBdihvKTtcclxuICAgICAgICAgICAgICAgIGlmIChlLmF0dHJpYnV0ZU5ld1ZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuYXR0cmlidXRlT2xkVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnJlbW92ZUF0dHJpYnV0ZShcInNyY3NldFwiLCByKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5yZW1vdmVBdHRyaWJ1dGUoXCJzaXplc1wiLCByKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQud2lkdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ucmVtb3ZlQXR0cmlidXRlKFwid2lkdGhcIiwgcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuYXR0cmlidXRlTmV3VmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnNldEF0dHJpYnV0ZShcInNyY3NldFwiLCB0LmRhdGEsIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnNldEF0dHJpYnV0ZShcInNpemVzXCIsIFwiMTAwdndcIiwgcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHQud2lkdGgsIHIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEl2KHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaS5vbihgYXR0cmlidXRlOiR7dH06aW1hZ2VgLCBlKVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS5jb25zdW1lKGUuaXRlbSwgdC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkud3JpdGVyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkubWFwcGVyLnRvVmlld0VsZW1lbnQoZS5pdGVtKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBBdihvKTtcclxuICAgICAgICAgICAgICAgIGlmIChlLmF0dHJpYnV0ZU5ld1ZhbHVlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5zZXRBdHRyaWJ1dGUoZS5hdHRyaWJ1dGVLZXksIGUuYXR0cmlidXRlTmV3VmFsdWUsIHIpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG4ucmVtb3ZlQXR0cmlidXRlKGUuYXR0cmlidXRlS2V5LCByKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBWdiBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gQ3YodGhpcy5lZGl0b3IubW9kZWwpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgZS5jaGFuZ2UoaSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEFycmF5LmlzQXJyYXkodC5zb3VyY2UpID8gdC5zb3VyY2UgOiBbdC5zb3VyY2VdO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHh2KGksIGUsIHtzcmM6IHR9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIE52IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJJbWFnZUVkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbnZlcnNpb247XHJcbiAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5hZGRPYnNlcnZlcih3dik7XHJcbiAgICAgICAgICAgICAgICBlLnJlZ2lzdGVyKFwiaW1hZ2VcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzT2JqZWN0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzQmxvY2s6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dXaGVyZTogXCIkYmxvY2tcIixcclxuICAgICAgICAgICAgICAgICAgICBhbGxvd0F0dHJpYnV0ZXM6IFtcImFsdFwiLCBcInNyY1wiLCBcInNyY3NldFwiXVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImRhdGFEb3duY2FzdFwiKS5lbGVtZW50VG9FbGVtZW50KHttb2RlbDogXCJpbWFnZVwiLCB2aWV3OiAodCwgZSkgPT4gTXYoZSl9KTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwiZWRpdGluZ0Rvd25jYXN0XCIpLmVsZW1lbnRUb0VsZW1lbnQoe21vZGVsOiBcImltYWdlXCIsIHZpZXc6ICh0LCBlKSA9PiBrdihNdihlKSwgZSwgaShcImp4XCIpKX0pO1xyXG4gICAgICAgICAgICAgICAgbi5mb3IoXCJkb3duY2FzdFwiKS5hZGQoSXYoXCJzcmNcIikpLmFkZChJdihcImFsdFwiKSkuYWRkKE92KCkpO1xyXG4gICAgICAgICAgICAgICAgbi5mb3IoXCJ1cGNhc3RcIikuZWxlbWVudFRvRWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzoge25hbWU6IFwiaW1nXCIsIGF0dHJpYnV0ZXM6IHtzcmM6IHRydWV9fSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogKHQsIGUpID0+IGUuY3JlYXRlRWxlbWVudChcImltYWdlXCIsIHtzcmM6IHQuZ2V0QXR0cmlidXRlKFwic3JjXCIpfSlcclxuICAgICAgICAgICAgICAgIH0pLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiB7bmFtZTogXCJpbWdcIiwga2V5OiBcImFsdFwifSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogXCJhbHRcIlxyXG4gICAgICAgICAgICAgICAgfSkuYXR0cmlidXRlVG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHtuYW1lOiBcImltZ1wiLCBrZXk6IFwic3Jjc2V0XCJ9LCBtb2RlbDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6IFwic3Jjc2V0XCIsIHZhbHVlOiB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB7ZGF0YTogdC5nZXRBdHRyaWJ1dGUoXCJzcmNzZXRcIil9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuaGFzQXR0cmlidXRlKFwid2lkdGhcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLndpZHRoID0gdC5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLmFkZChSdigpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiaW1hZ2VJbnNlcnRcIiwgbmV3IFZ2KHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBNdih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNyZWF0ZUVtcHR5RWxlbWVudChcImltZ1wiKTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuY3JlYXRlQ29udGFpbmVyRWxlbWVudChcImZpZ3VyZVwiLCB7Y2xhc3M6IFwiaW1hZ2VcIn0pO1xyXG4gICAgICAgICAgICB0Lmluc2VydCh0LmNyZWF0ZVBvc2l0aW9uQXQoaSwgMCksIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgQnYgZXh0ZW5kcyBKdSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudFR5cGUgPSBcIm1vdXNlZG93blwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9uRG9tRXZlbnQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHQudHlwZSwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHp2ID0gaSg1OCk7XHJcbiAgICAgICAgY29uc3QgTHYgPSBCbChcIkN0cmwrQVwiKTtcclxuXHJcbiAgICAgICAgY2xhc3MgRnYgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIldpZGdldFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcmV2aW91c2x5U2VsZWN0ZWQgPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZWRpdGluZy5kb3duY2FzdERpc3BhdGNoZXIub24oXCJzZWxlY3Rpb25cIiwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbGVhclByZXZpb3VzbHlTZWxlY3RlZFdpZGdldHMoaS53cml0ZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLndyaXRlcjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG8uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHMgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBvLmdldFJhbmdlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5pdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFFfKHQpICYmICFXdih0LCBzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uYWRkQ2xhc3MoWV8sIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ByZXZpb3VzbHlTZWxlY3RlZC5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT0gcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldFNlbGVjdGlvbihvLmdldFJhbmdlcygpLCB7ZmFrZTogdHJ1ZSwgbGFiZWw6IGV2KHIpfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIHQuYWRkT2JzZXJ2ZXIoQnYpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhlLCBcIm1vdXNlZG93blwiLCAoLi4udCkgPT4gdGhpcy5fb25Nb3VzZWRvd24oLi4udCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhlLCBcImtleWRvd25cIiwgKC4uLnQpID0+IHRoaXMuX29uS2V5ZG93biguLi50KSwge3ByaW9yaXR5OiBcImhpZ2hcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhlLCBcImRlbGV0ZVwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYW5kbGVEZWxldGUoZS5kaXJlY3Rpb24gPT0gXCJmb3J3YXJkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zdG9wKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaFwifSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX29uTW91c2Vkb3duKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgbGV0IHIgPSBlLnRhcmdldDtcclxuICAgICAgICAgICAgICAgIGlmIChIdihyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChBbC5pc1NhZmFyaSAmJiBlLmRvbUV2ZW50LmRldGFpbCA+PSAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLmVkaXRpbmcubWFwcGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC50b01vZGVsRWxlbWVudChyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IubW9kZWwuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24obiwgXCJpblwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghUV8ocikpIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gci5maW5kQW5jZXN0b3IoUV8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW8uaXNGb2N1c2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gaS5lZGl0aW5nLm1hcHBlci50b01vZGVsRWxlbWVudChyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NldFNlbGVjdGlvbk92ZXJFbGVtZW50KHMpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9vbktleWRvd24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUua2V5Q29kZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5sb2NhbGUuY29udGVudExhbmd1YWdlRGlyZWN0aW9uID09PSBcImx0clwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkgPT0gTmwuYXJyb3dkb3duIHx8IGkgPT0gTmxbbiA/IFwiYXJyb3dyaWdodFwiIDogXCJhcnJvd2xlZnRcIl07XHJcbiAgICAgICAgICAgICAgICBsZXQgciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKER2KGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IHRoaXMuX2hhbmRsZUFycm93S2V5cyhvKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqdihlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHIgPSB0aGlzLl9zZWxlY3RBbGxOZXN0ZWRFZGl0YWJsZUNvbnRlbnQoKSB8fCB0aGlzLl9zZWxlY3RBbGxDb250ZW50KClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA9PT0gTmwuZW50ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gdGhpcy5faGFuZGxlRW50ZXJLZXkoZS5zaGlmdEtleSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVEZWxldGUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZWRpdG9yLmlzUmVhZE9ubHkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmICghaS5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2dldE9iamVjdEVsZW1lbnROZXh0VG9TZWxlY3Rpb24odCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm1vZGVsLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSBpLmFuY2hvci5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChlLmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5yZW1vdmUoaSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRTZWxlY3Rpb25PdmVyRWxlbWVudChuKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVBcnJvd0tleXModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gby5nZXRTZWxlY3RlZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChyICYmIGkuaXNPYmplY3QocikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdCA/IG8uZ2V0TGFzdFBvc2l0aW9uKCkgOiBvLmdldEZpcnN0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gaS5nZXROZWFyZXN0U2VsZWN0aW9uUmFuZ2UobiwgdCA/IFwiZm9yd2FyZFwiIDogXCJiYWNrd2FyZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKHIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIW8uaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLl9nZXRPYmplY3RFbGVtZW50TmV4dFRvU2VsZWN0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEhcyAmJiBpLmlzT2JqZWN0KHMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0U2VsZWN0aW9uT3ZlckVsZW1lbnQocyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2hhbmRsZUVudGVyS2V5KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmdldFNlbGVjdGVkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHF2KG4sIGUuc2NoZW1hKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuY2hhbmdlKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IGkuY3JlYXRlUG9zaXRpb25BdChuLCB0ID8gXCJiZWZvcmVcIiA6IFwiYWZ0ZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBpLmNyZWF0ZUVsZW1lbnQoXCJwYXJhZ3JhcGhcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnNjaGVtYS5pc0Jsb2NrKG4ucGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuc2NoZW1hLmZpbmRBbGxvd2VkUGFyZW50KG8sIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGkuc3BsaXQobywgdCkucG9zaXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmluc2VydChyLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zZXRTZWxlY3Rpb24ociwgXCJpblwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZWxlY3RBbGxOZXN0ZWRFZGl0YWJsZUNvbnRlbnQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5zY2hlbWEuZ2V0TGltaXRFbGVtZW50KGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuZ2V0Rmlyc3RSYW5nZSgpLnJvb3QgPT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24odC5jcmVhdGVSYW5nZUluKGkpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2VsZWN0QWxsQ29udGVudCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5lZGl0aW5nO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4uc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG8uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAociAmJiBRXyhyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLm1hcHBlci50b01vZGVsRWxlbWVudChyLnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKHQuY3JlYXRlUmFuZ2VJbihpKSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRTZWxlY3Rpb25PdmVyRWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5tb2RlbC5jaGFuZ2UoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zZXRTZWxlY3Rpb24oZS5jcmVhdGVSYW5nZU9uKHQpKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldE9iamVjdEVsZW1lbnROZXh0VG9TZWxlY3Rpb24odCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuY3JlYXRlU2VsZWN0aW9uKG4pO1xyXG4gICAgICAgICAgICAgICAgZS5tb2RpZnlTZWxlY3Rpb24obywge2RpcmVjdGlvbjogdCA/IFwiZm9yd2FyZFwiIDogXCJiYWNrd2FyZFwifSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdCA/IG8uZm9jdXMubm9kZUJlZm9yZSA6IG8uZm9jdXMubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKCEhciAmJiBpLmlzT2JqZWN0KHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbGVhclByZXZpb3VzbHlTZWxlY3RlZFdpZGdldHModCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX3ByZXZpb3VzbHlTZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlQ2xhc3MoWV8sIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcmV2aW91c2x5U2VsZWN0ZWQuY2xlYXIoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBEdih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ID09IE5sLmFycm93cmlnaHQgfHwgdCA9PSBObC5hcnJvd2xlZnQgfHwgdCA9PSBObC5hcnJvd3VwIHx8IHQgPT0gTmwuYXJyb3dkb3duXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBqdih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBNbCh0KSA9PSBMdlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSHYodCkge1xyXG4gICAgICAgICAgICB3aGlsZSAodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJlZGl0YWJsZUVsZW1lbnRcIikgJiYgIXQuaXMoXCJyb290RWxlbWVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoUV8odCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQgPSB0LnBhcmVudFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gV3YodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHQuZ2V0QW5jZXN0b3JzKCkpLmluY2x1ZGVzKGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBxdih0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ICYmIGUuaXNPYmplY3QodCkgJiYgIWUuaXNJbmxpbmUodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFV2IGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRTZWxlY3RlZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0geXYodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoeXYodCkgJiYgdC5oYXNBdHRyaWJ1dGUoXCJhbHRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdC5nZXRBdHRyaWJ1dGUoXCJhbHRcIilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQuc2VsZWN0aW9uLmdldFNlbGVjdGVkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgZS5jaGFuZ2UoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdC5uZXdWYWx1ZSwgaSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzICR2IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJJbWFnZVRleHRBbHRlcm5hdGl2ZUVkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuY29tbWFuZHMuYWRkKFwiaW1hZ2VUZXh0QWx0ZXJuYXRpdmVcIiwgbmV3IFV2KHRoaXMuZWRpdG9yKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEd2ID0gaSg2MCk7XHJcblxyXG4gICAgICAgIGNsYXNzIEt2IGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBgY2staW5wdXQtJHtpcygpfWA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gYGNrLXN0YXR1cy0ke2lzKCl9YDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwibGFiZWxcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInZhbHVlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc1JlYWRPbmx5XCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiZXJyb3JUZXh0XCIsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpbmZvVGV4dFwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFiZWxWaWV3ID0gdGhpcy5fY3JlYXRlTGFiZWxWaWV3KGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dFZpZXcgPSB0aGlzLl9jcmVhdGVJbnB1dFZpZXcoZSwgaSwgbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1c1ZpZXcgPSB0aGlzLl9jcmVhdGVTdGF0dXNWaWV3KG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kKFwiX3N0YXR1c1RleHRcIikudG8odGhpcywgXCJlcnJvclRleHRcIiwgdGhpcywgXCJpbmZvVGV4dFwiLCAodCwgZSkgPT4gdCB8fCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stbGFiZWxlZC1pbnB1dFwiLCBvLmlmKFwiaXNSZWFkT25seVwiLCBcImNrLWRpc2FibGVkXCIpXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt0aGlzLmxhYmVsVmlldywgdGhpcy5pbnB1dFZpZXcsIHRoaXMuc3RhdHVzVmlld11cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVMYWJlbFZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBNayh0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBlLmZvciA9IHQ7XHJcbiAgICAgICAgICAgICAgICBlLmJpbmQoXCJ0ZXh0XCIpLnRvKHRoaXMsIFwibGFiZWxcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlSW5wdXRWaWV3KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgdCh0aGlzLmxvY2FsZSwgaSk7XHJcbiAgICAgICAgICAgICAgICBuLmlkID0gZTtcclxuICAgICAgICAgICAgICAgIG4uYXJpYURlc2NyaWJlZEJ5SWQgPSBpO1xyXG4gICAgICAgICAgICAgICAgbi5iaW5kKFwidmFsdWVcIikudG8odGhpcyk7XHJcbiAgICAgICAgICAgICAgICBuLmJpbmQoXCJpc1JlYWRPbmx5XCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgbi5iaW5kKFwiaGFzRXJyb3JcIikudG8odGhpcywgXCJlcnJvclRleHRcIiwgdCA9PiAhIXQpO1xyXG4gICAgICAgICAgICAgICAgbi5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yVGV4dCA9IG51bGxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVN0YXR1c1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBHcCh0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICBlLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay1sYWJlbGVkLWlucHV0X19zdGF0dXNcIiwgaS5pZihcImVycm9yVGV4dFwiLCBcImNrLWxhYmVsZWQtaW5wdXRfX3N0YXR1c19lcnJvclwiKSwgaS5pZihcIl9zdGF0dXNUZXh0XCIsIFwiY2staGlkZGVuXCIsIHQgPT4gIXQpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IGkuaWYoXCJlcnJvclRleHRcIiwgXCJhbGVydFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt7dGV4dDogaS50byhcIl9zdGF0dXNUZXh0XCIpfV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VsZWN0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dFZpZXcuc2VsZWN0KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0Vmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBKdiA9IGkoNjIpO1xyXG5cclxuICAgICAgICBjbGFzcyBZdiBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInZhbHVlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpZFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwicGxhY2Vob2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzUmVhZE9ubHlcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJoYXNFcnJvclwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImFyaWFEZXNjcmliZWRCeUlkXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImlucHV0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInRleHRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFtcImNrXCIsIFwiY2staW5wdXRcIiwgXCJjay1pbnB1dC10ZXh0XCIsIGUuaWYoXCJoYXNFcnJvclwiLCBcImNrLWVycm9yXCIpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGUudG8oXCJpZFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IGUudG8oXCJwbGFjZWhvbGRlclwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZG9ubHk6IGUudG8oXCJpc1JlYWRPbmx5XCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFyaWEtaW52YWxpZFwiOiBlLmlmKFwiaGFzRXJyb3JcIiwgdHJ1ZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXJpYS1kZXNjcmliZWRieVwiOiBlLnRvKFwiYXJpYURlc2NyaWJlZEJ5SWRcIilcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG9uOiB7aW5wdXQ6IGUudG8oXCJpbnB1dFwiKX1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9ICF0ICYmIHQgIT09IDAgPyBcIlwiIDogdFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHQodGhpcy52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwiY2hhbmdlOnZhbHVlXCIsIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdChuKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VsZWN0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnNlbGVjdCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmZvY3VzKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUXYoe3ZpZXc6IHR9KSB7XHJcbiAgICAgICAgICAgIHQubGlzdGVuVG8odC5lbGVtZW50LCBcInN1Ym1pdFwiLCAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgdC5maXJlKFwic3VibWl0XCIpXHJcbiAgICAgICAgICAgIH0sIHt1c2VDYXB0dXJlOiB0cnVlfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBYdiA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk02Ljk3MiAxNi42MTVhLjk5Ny45OTcgMCAwIDEtLjc0NC0uMjkybC00LjU5Ni00LjU5NmExIDEgMCAxIDEgMS40MTQtMS40MTRsMy45MjYgMy45MjYgOS45MzctOS45MzdhMSAxIDAgMCAxIDEuNDE0IDEuNDE1TDcuNzE3IDE2LjMyM2EuOTk3Ljk5NyAwIDAgMS0uNzQ1LjI5MnpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgWnYgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMTEuNTkxIDEwLjE3N2w0LjI0MyA0LjI0MmExIDEgMCAwIDEtMS40MTUgMS40MTVsLTQuMjQyLTQuMjQzLTQuMjQzIDQuMjQzYTEgMSAwIDAgMS0xLjQxNC0xLjQxNWw0LjI0My00LjI0Mkw0LjUyIDUuOTM0QTEgMSAwIDAgMSA1LjkzNCA0LjUybDQuMjQzIDQuMjQzIDQuMjQyLTQuMjQzYTEgMSAwIDEgMSAxLjQxNSAxLjQxNGwtNC4yNDMgNC4yNDN6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIHR5ID0gaSg2NCk7XHJcblxyXG4gICAgICAgIGNsYXNzIGV5IGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmxvY2FsZS50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIgPSBuZXcgZmI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMgPSBuZXcgZHA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhYmVsZWRJbnB1dCA9IHRoaXMuX2NyZWF0ZUxhYmVsZWRJbnB1dFZpZXcoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUJ1dHRvblZpZXcgPSB0aGlzLl9jcmVhdGVCdXR0b24oZShcImxvXCIpLCBYdiwgXCJjay1idXR0b24tc2F2ZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUJ1dHRvblZpZXcudHlwZSA9IFwic3VibWl0XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvblZpZXcgPSB0aGlzLl9jcmVhdGVCdXR0b24oZShcImxwXCIpLCBadiwgXCJjay1idXR0b24tY2FuY2VsXCIsIFwiY2FuY2VsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNhYmxlcyA9IG5ldyBicDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyID0gbmV3IHliKHtcclxuICAgICAgICAgICAgICAgICAgICBmb2N1c2FibGVzOiB0aGlzLl9mb2N1c2FibGVzLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzVHJhY2tlcjogdGhpcy5mb2N1c1RyYWNrZXIsXHJcbiAgICAgICAgICAgICAgICAgICAga2V5c3Ryb2tlSGFuZGxlcjogdGhpcy5rZXlzdHJva2VzLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IHtmb2N1c1ByZXZpb3VzOiBcInNoaWZ0ICsgdGFiXCIsIGZvY3VzTmV4dDogXCJ0YWJcIn1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImZvcm1cIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stdGV4dC1hbHRlcm5hdGl2ZS1mb3JtXCJdLCB0YWJpbmRleDogXCItMVwifSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3RoaXMubGFiZWxlZElucHV0LCB0aGlzLnNhdmVCdXR0b25WaWV3LCB0aGlzLmNhbmNlbEJ1dHRvblZpZXddXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcy5saXN0ZW5Ubyh0aGlzLmVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgUXYoe3ZpZXc6IHRoaXN9KTtcclxuICAgICAgICAgICAgICAgIFt0aGlzLmxhYmVsZWRJbnB1dCwgdGhpcy5zYXZlQnV0dG9uVmlldywgdGhpcy5jYW5jZWxCdXR0b25WaWV3XS5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzYWJsZXMuYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZCh0LmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlQnV0dG9uKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIodGhpcy5sb2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiB0LCBpY29uOiBlLCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICBvLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7Y2xhc3M6IGl9fSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIG8uZGVsZWdhdGUoXCJleGVjdXRlXCIpLnRvKHRoaXMsIG4pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlTGFiZWxlZElucHV0VmlldygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsZS50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBLdih0aGlzLmxvY2FsZSwgWXYpO1xyXG4gICAgICAgICAgICAgICAgZS5sYWJlbCA9IHQoXCJsdFwiKTtcclxuICAgICAgICAgICAgICAgIGUuaW5wdXRWaWV3LnBsYWNlaG9sZGVyID0gdChcImx0XCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGl5ID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTUuMDg1IDYuMjJMMi45NDMgNC4wNzhhLjc1Ljc1IDAgMSAxIDEuMDYtMS4wNmwyLjU5MiAyLjU5QTExLjA5NCAxMS4wOTQgMCAwIDEgMTAgNS4wNjhjNC43MzggMCA4LjU3OCAzLjEwMSA4LjU3OCA1LjA4MyAwIDEuMTk3LTEuNDAxIDIuODAzLTMuNTU1IDMuODg3bDEuNzE0IDEuNzEzYS43NS43NSAwIDAgMS0uMDkgMS4xMzguNDg4LjQ4OCAwIDAgMS0uMTUuMDg0Ljc1Ljc1IDAgMCAxLS44MjEtLjE2TDYuMTcgNy4zMDRjLS4yNTguMTEtLjUxLjIzMy0uNzU3LjM2NWw2LjIzOSA2LjI0LS4wMDYuMDA1Ljc4Ljc4Yy0uMzg4LjA5NC0uNzguMTY2LTEuMTc0LjIxNWwtMS4xMS0xLjExaC4wMTFMNC41NSA4LjE5N2E3LjIgNy4yIDAgMCAwLS42NjUuNTE0bC0uMTEyLjA5OCA0Ljg5NyA0Ljg5Ny0uMDA1LjAwNiAxLjI3NiAxLjI3NmExMC4xNjQgMTAuMTY0IDAgMCAxLTEuNDc3LS4xMTdsLS40NzktLjQ3OS0uMDA5LjAwOS00Ljg2My00Ljg2My0uMDIyLjAzMWEyLjU2MyAyLjU2MyAwIDAgMC0uMTI0LjJjLS4wNDMuMDc3LS4wOC4xNTgtLjEwOC4yNDFhLjUzNC41MzQgMCAwIDAtLjAyOC4xMzMuMjkuMjkgMCAwIDAgLjAwOC4wNzIuOTI3LjkyNyAwIDAgMCAuMDgyLjIyNmMuMDY3LjEzMy4xNDUuMjYuMjM0LjM3OWwzLjI0MiAzLjM2NS4wMjUuMDEuNTkuNjIzYy0zLjI2NS0uOTE4LTUuNTktMy4xNTUtNS41OS00LjY2OCAwLTEuMTk0IDEuNDQ4LTIuODM4IDMuNjYzLTMuOTN6bTcuMDcuNTMxYTQuNjMyIDQuNjMyIDAgMCAxIDEuMTA4IDUuOTkybC4zNDUuMzQ0LjA0Ni0uMDE4YTkuMzEzIDkuMzEzIDAgMCAwIDItMS4xMTJjLjI1Ni0uMTg3LjUtLjM5Mi43MjctLjYxMy4xMzctLjEzNC4yNy0uMjc3LjM5Mi0uNDMxLjA3Mi0uMDkxLjE0MS0uMTg1LjIwMy0uMjg2LjA1Ny0uMDkzLjEwNy0uMTkuMTQ4LS4yOTJhLjcyLjcyIDAgMCAwIC4wMzYtLjEyLjI5LjI5IDAgMCAwIC4wMDgtLjA3Mi40OTIuNDkyIDAgMCAwLS4wMjgtLjEzMy45OTkuOTk5IDAgMCAwLS4wMzYtLjA5NiAyLjE2NSAyLjE2NSAwIDAgMC0uMDcxLS4xNDUgMi45MTcgMi45MTcgMCAwIDAtLjEyNS0uMiAzLjU5MiAzLjU5MiAwIDAgMC0uMjYzLS4zMzUgNS40NDQgNS40NDQgMCAwIDAtLjUzLS41MjMgNy45NTUgNy45NTUgMCAwIDAtMS4wNTQtLjc2OCA5Ljc2NiA5Ljc2NiAwIDAgMC0xLjg3OS0uODkxYy0uMzM3LS4xMTgtLjY4LS4yMTktMS4wMjctLjMwMXptLTIuODUuMjFsLS4wNjkuMDAyYS41MDguNTA4IDAgMCAwLS4yNTQuMDk3LjQ5Ni40OTYgMCAwIDAtLjEwNC42NzkuNDk4LjQ5OCAwIDAgMCAuMzI2LjE5OWwuMDQ1LjAwNWMuMDkxLjAwMy4xODEuMDAzLjI3Mi4wMTJhMi40NSAyLjQ1IDAgMCAxIDIuMDE3IDEuNTEzYy4wMjQuMDYxLjA0My4xMjUuMDY5LjE4NWEuNDk0LjQ5NCAwIDAgMCAuNDUuMjg3aC4wMDhhLjQ5Ni40OTYgMCAwIDAgLjM1LS4xNTguNDgyLjQ4MiAwIDAgMCAuMTMtLjMzNS42MzguNjM4IDAgMCAwLS4wNDgtLjIxOSAzLjM3OSAzLjM3OSAwIDAgMC0uMzYtLjcyMyAzLjQzOCAzLjQzOCAwIDAgMC0yLjc5MS0xLjU0M2wtLjAyOC0uMDAxaC0uMDEzelwiLz48L3N2Zz4nO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBueSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnBsdWdpbnMuZ2V0KFwiQ29udGV4dHVhbEJhbGxvb25cIik7XHJcbiAgICAgICAgICAgIGlmICh2dih0LmVkaXRpbmcudmlldy5kb2N1bWVudC5zZWxlY3Rpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gb3kodCk7XHJcbiAgICAgICAgICAgICAgICBlLnVwZGF0ZVBvc2l0aW9uKGkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG95KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZWRpdGluZy52aWV3O1xyXG4gICAgICAgICAgICBjb25zdCBpID0gbmIuZGVmYXVsdFBvc2l0aW9ucztcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldDogZS5kb21Db252ZXJ0ZXIudmlld1RvRG9tKGUuZG9jdW1lbnQuc2VsZWN0aW9uLmdldFNlbGVjdGVkRWxlbWVudCgpKSxcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uczogW2kubm9ydGhBcnJvd1NvdXRoLCBpLm5vcnRoQXJyb3dTb3V0aFdlc3QsIGkubm9ydGhBcnJvd1NvdXRoRWFzdCwgaS5zb3V0aEFycm93Tm9ydGgsIGkuc291dGhBcnJvd05vcnRoV2VzdCwgaS5zb3V0aEFycm93Tm9ydGhFYXN0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyByeSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBba2JdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkltYWdlVGV4dEFsdGVybmF0aXZlVUlcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlQnV0dG9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jcmVhdGVGb3JtKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Zvcm0uZGVzdHJveSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVCdXR0b24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgdC51aS5jb21wb25lbnRGYWN0b3J5LmFkZChcImltYWdlVGV4dEFsdGVybmF0aXZlXCIsIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChcImltYWdlVGV4dEFsdGVybmF0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiBlKFwibGhcIiksIGljb246IGl5LCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKG4sIFwiaXNFbmFibGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obywgXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2hvd0Zvcm0oKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlRm9ybSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbiA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiQ29udGV4dHVhbEJhbGxvb25cIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb3JtID0gbmV3IGV5KHQubG9jYWxlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Zvcm0ucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMuX2Zvcm0sIFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoXCJpbWFnZVRleHRBbHRlcm5hdGl2ZVwiLCB7bmV3VmFsdWU6IHRoaXMuX2Zvcm0ubGFiZWxlZElucHV0LmlucHV0Vmlldy5lbGVtZW50LnZhbHVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZUZvcm0odHJ1ZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLl9mb3JtLCBcImNhbmNlbFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZUZvcm0odHJ1ZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9ybS5rZXlzdHJva2VzLnNldChcIkVzY1wiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVGb3JtKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQudWksIFwidXBkYXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXZ2KGkuc2VsZWN0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oaWRlRm9ybSh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG55KHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBEYih7XHJcbiAgICAgICAgICAgICAgICAgICAgZW1pdHRlcjogdGhpcy5fZm9ybSxcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmF0b3I6ICgpID0+IHRoaXMuX2lzVmlzaWJsZSxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0RWxlbWVudHM6IFt0aGlzLl9iYWxsb29uLnZpZXcuZWxlbWVudF0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuX2hpZGVGb3JtKClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zaG93Rm9ybSgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc1Zpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvbW1hbmRzLmdldChcImltYWdlVGV4dEFsdGVybmF0aXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2Zvcm0ubGFiZWxlZElucHV0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0luQmFsbG9vbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24uYWRkKHt2aWV3OiB0aGlzLl9mb3JtLCBwb3NpdGlvbjogb3kodCl9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS52YWx1ZSA9IGkuaW5wdXRWaWV3LmVsZW1lbnQudmFsdWUgPSBlLnZhbHVlIHx8IFwiXCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb3JtLmxhYmVsZWRJbnB1dC5zZWxlY3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGlkZUZvcm0odCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0luQmFsbG9vbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Zvcm0uZm9jdXNUcmFja2VyLmlzRm9jdXNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Zvcm0uc2F2ZUJ1dHRvblZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi5yZW1vdmUodGhpcy5fZm9ybSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfaXNWaXNpYmxlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24udmlzaWJsZVZpZXcgPT09IHRoaXMuX2Zvcm1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9pc0luQmFsbG9vbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWxsb29uLmhhc1ZpZXcodGhpcy5fZm9ybSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3Mgc3kgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gWyR2LCByeV1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW1hZ2VUZXh0QWx0ZXJuYXRpdmVcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgYXkgPSBpKDY2KTtcclxuXHJcbiAgICAgICAgY2xhc3MgY3kgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW052LCBGdiwgc3ldXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkltYWdlXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgbHkgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2tiXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJXaWRnZXRUb29sYmFyUmVwb3NpdG9yeVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5wbHVnaW5zLmhhcyhcIkJhbGxvb25Ub29sYmFyXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQucGx1Z2lucy5nZXQoXCJCYWxsb29uVG9vbGJhclwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwic2hvd1wiLCBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGh5KHQuZWRpdGluZy52aWV3LmRvY3VtZW50LnNlbGVjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaFwifSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3Rvb2xiYXJEZWZpbml0aW9ucyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoXCJDb250ZXh0dWFsQmFsbG9vblwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub24oXCJjaGFuZ2U6aXNFbmFibGVkXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVUb29sYmFyc1Zpc2liaWxpdHkoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQudWksIFwidXBkYXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVUb29sYmFyc1Zpc2liaWxpdHkoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQudWkuZm9jdXNUcmFja2VyLCBcImNoYW5nZTppc0ZvY3VzZWRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVRvb2xiYXJzVmlzaWJpbGl0eSgpXHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93XCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMuX3Rvb2xiYXJEZWZpbml0aW9ucy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQudmlldy5kZXN0cm95KClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVnaXN0ZXIodCwge2FyaWFMYWJlbDogZSwgaXRlbXM6IGksIGdldFJlbGF0ZWRFbGVtZW50OiBuLCBiYWxsb29uQ2xhc3NOYW1lOiBvID0gXCJjay10b29sYmFyLWNvbnRhaW5lclwifSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHIudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBuZXcgWGIoci5sb2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgYS5hcmlhTGFiZWwgPSBlIHx8IHMoXCJrZlwiKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl90b29sYmFyRGVmaW5pdGlvbnMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IHNzW1wiYlwiXShcIndpZGdldC10b29sYmFyLWR1cGxpY2F0ZWQ6IFRvb2xiYXIgd2l0aCB0aGUgZ2l2ZW4gaWQgd2FzIGFscmVhZHkgYWRkZWQuXCIsIHRoaXMsIHt0b29sYmFySWQ6IHR9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYS5maWxsRnJvbUNvbmZpZyhpLCByLnVpLmNvbXBvbmVudEZhY3RvcnkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdG9vbGJhckRlZmluaXRpb25zLnNldCh0LCB7dmlldzogYSwgZ2V0UmVsYXRlZEVsZW1lbnQ6IG4sIGJhbGxvb25DbGFzc05hbWU6IG99KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfdXBkYXRlVG9vbGJhcnNWaXNpYmlsaXR5KCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHQgPSAwO1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuX3Rvb2xiYXJEZWZpbml0aW9ucy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLmdldFJlbGF0ZWRFbGVtZW50KHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5kb2N1bWVudC5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0VuYWJsZWQgfHwgIW8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVG9vbGJhckluQmFsbG9vbihuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVRvb2xiYXIobilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuZWRpdG9yLnVpLmZvY3VzVHJhY2tlci5pc0ZvY3VzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVG9vbGJhclZpc2libGUobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVUb29sYmFyKG4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gby5nZXRBbmNlc3RvcnMoKS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyID4gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gbztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dUb29sYmFyKGksIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oaWRlVG9vbGJhcih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uLnJlbW92ZSh0LnZpZXcpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuX2JhbGxvb24sIFwiY2hhbmdlOnZpc2libGVWaWV3XCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zaG93VG9vbGJhcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNUb29sYmFyVmlzaWJsZSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGR5KHRoaXMuZWRpdG9yLCBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghdGhpcy5faXNUb29sYmFySW5CYWxsb29uKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi5hZGQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3OiB0LnZpZXcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB1eSh0aGlzLmVkaXRvciwgZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbGxvb25DbGFzc05hbWU6IHQuYmFsbG9vbkNsYXNzTmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5fYmFsbG9vbiwgXCJjaGFuZ2U6dmlzaWJsZVZpZXdcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fdG9vbGJhckRlZmluaXRpb25zLnZhbHVlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNUb29sYmFyVmlzaWJsZSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldFJlbGF0ZWRFbGVtZW50KHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5kb2N1bWVudC5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR5KHRoaXMuZWRpdG9yLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2lzVG9vbGJhclZpc2libGUodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24udmlzaWJsZVZpZXcgPT09IHQudmlld1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaXNUb29sYmFySW5CYWxsb29uKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWxsb29uLmhhc1ZpZXcodC52aWV3KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBkeSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnBsdWdpbnMuZ2V0KFwiQ29udGV4dHVhbEJhbGxvb25cIik7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB1eSh0LCBlKTtcclxuICAgICAgICAgICAgaS51cGRhdGVQb3NpdGlvbihuKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXkodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5lZGl0aW5nLnZpZXc7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuYi5kZWZhdWx0UG9zaXRpb25zO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBpLmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20oZSksXHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbnM6IFtuLm5vcnRoQXJyb3dTb3V0aCwgbi5ub3J0aEFycm93U291dGhXZXN0LCBuLm5vcnRoQXJyb3dTb3V0aEVhc3QsIG4uc291dGhBcnJvd05vcnRoLCBuLnNvdXRoQXJyb3dOb3J0aFdlc3QsIG4uc291dGhBcnJvd05vcnRoRWFzdF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaHkodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5nZXRTZWxlY3RlZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgcmV0dXJuICEhKGUgJiYgUV8oZSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBmeSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbbHldXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkltYWdlVG9vbGJhclwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFmdGVySW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5wbHVnaW5zLmdldChseSk7XHJcbiAgICAgICAgICAgICAgICBpLnJlZ2lzdGVyKFwiaW1hZ2VcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGFyaWFMYWJlbDogZShcImFcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHQuY29uZmlnLmdldChcImltYWdlLnRvb2xiYXJcIikgfHwgW10sXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0UmVsYXRlZEVsZW1lbnQ6IHZ2XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBneSBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlZmF1bHRTdHlsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZXMgPSBlLnJlZHVjZSgodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbZS5uYW1lXSA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaXNEZWZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVmYXVsdFN0eWxlID0gZS5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICB9LCB7fSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IHl2KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQuaGFzQXR0cmlidXRlKFwiaW1hZ2VTdHlsZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmdldEF0dHJpYnV0ZShcImltYWdlU3R5bGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuc3R5bGVzW2VdID8gZSA6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLmRlZmF1bHRTdHlsZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZG9jdW1lbnQuc2VsZWN0aW9uLmdldFNlbGVjdGVkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgaS5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3R5bGVzW2VdLmlzRGVmYXVsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZShcImltYWdlU3R5bGVcIiwgbilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNldEF0dHJpYnV0ZShcImltYWdlU3R5bGVcIiwgZSwgbilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBteSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZSwgaSwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnN1bWFibGUuY29uc3VtZShpLml0ZW0sIGUubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBieShpLmF0dHJpYnV0ZU5ld1ZhbHVlLCB0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBieShpLmF0dHJpYnV0ZU9sZFZhbHVlLCB0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLm1hcHBlci50b1ZpZXdFbGVtZW50KGkuaXRlbSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gbi53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGEucmVtb3ZlQ2xhc3Moci5jbGFzc05hbWUsIHMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIGEuYWRkQ2xhc3Moby5jbGFzc05hbWUsIHMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHB5KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZmlsdGVyKHQgPT4gIXQuaXNEZWZhdWx0KTtcclxuICAgICAgICAgICAgcmV0dXJuICh0LCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkubW9kZWxSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkudmlld0l0ZW07XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gV3coaS5tb2RlbFJhbmdlLmdldEl0ZW1zKCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLnNjaGVtYS5jaGVja0F0dHJpYnV0ZShyLCBcImltYWdlU3R5bGVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4uY29uc3VtYWJsZS5jb25zdW1lKG8sIHtjbGFzc2VzOiB0LmNsYXNzTmFtZX0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ud3JpdGVyLnNldEF0dHJpYnV0ZShcImltYWdlU3R5bGVcIiwgdC5uYW1lLCByKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYnkodCwgZSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkubmFtZSA9PT0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB3eSA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0yIDQuNVYzaDE2djEuNXptMi41IDNWMTJoMTFWNy41aC0xMXpNNC4wNjEgNkgxNS45NGMuNTg2IDAgMS4wNjEuNDA3IDEuMDYxLjkxdjUuNjhjMCAuNTAzLS40NzUuOTEtMS4wNjEuOTFINC4wNmMtLjU4NSAwLTEuMDYtLjQwNy0xLjA2LS45MVY2LjkxQzMgNi40MDYgMy40NzUgNiA0LjA2MSA2ek0yIDE2LjVWMTVoMTZ2MS41elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciBreSA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xpcC1ydWxlPVwiZXZlbm9kZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlLW1pdGVybGltaXQ9XCIxLjQxNFwiPjxwYXRoIGQ9XCJNMTggNC41VjNIMnYxLjVoMTZ6bTAgM1Y2aC01LjY3NHYxLjVIMTh6bTAgM1Y5aC01LjY3NHYxLjVIMTh6bTAgM1YxMmgtNS42NzR2MS41SDE4em0tOC41LTZWMTJoLTZWNy41aDZ6bS44MTgtMS41SDIuNjgyQzIuMzA1IDYgMiA2LjQwNyAyIDYuOTF2NS42OGMwIC41MDMuMzA1LjkxLjY4Mi45MWg3LjYzNmMuMzc3IDAgLjY4Mi0uNDA3LjY4Mi0uOTFWNi45MWMwLS41MDMtLjMwNS0uOTEtLjY4Mi0uOTF6TTE4IDE2LjVWMTVIMnYxLjVoMTZ6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIF95ID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTIgNC41VjNoMTZ2MS41em00LjUgM1YxMmg3VjcuNWgtN3pNNS43NTggNmg4LjQ4NGMuNDE5IDAgLjc1OC40MDcuNzU4LjkxdjUuNjgxYzAgLjUwMi0uMzQuOTA5LS43NTguOTA5SDUuNzU4Yy0uNDE5IDAtLjc1OC0uNDA3LS43NTgtLjkxVjYuOTFjMC0uNTAzLjM0LS45MS43NTgtLjkxek0yIDE2LjVWMTVoMTZ2MS41elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciB2eSA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0yIDQuNVYzaDE2djEuNXptMCAzVjZoNS42NzR2MS41em0wIDNWOWg1LjY3NHYxLjV6bTAgM1YxMmg1LjY3NHYxLjV6bTguNS02VjEyaDZWNy41aC02ek05LjY4MiA2aDcuNjM2Yy4zNzcgMCAuNjgyLjQwNy42ODIuOTF2NS42OGMwIC41MDMtLjMwNS45MS0uNjgyLjkxSDkuNjgyYy0uMzc3IDAtLjY4Mi0uNDA3LS42ODItLjkxVjYuOTFjMC0uNTAzLjMwNS0uOTEuNjgyLS45MXpNMiAxNi41VjE1aDE2djEuNXpcIi8+PC9zdmc+JztcclxuICAgICAgICBjb25zdCB5eSA9IHtcclxuICAgICAgICAgICAgZnVsbDoge25hbWU6IFwiZnVsbFwiLCB0aXRsZTogXCJGdWxsIHNpemUgaW1hZ2VcIiwgaWNvbjogd3ksIGlzRGVmYXVsdDogdHJ1ZX0sXHJcbiAgICAgICAgICAgIHNpZGU6IHtuYW1lOiBcInNpZGVcIiwgdGl0bGU6IFwiU2lkZSBpbWFnZVwiLCBpY29uOiB2eSwgY2xhc3NOYW1lOiBcImltYWdlLXN0eWxlLXNpZGVcIn0sXHJcbiAgICAgICAgICAgIGFsaWduTGVmdDoge25hbWU6IFwiYWxpZ25MZWZ0XCIsIHRpdGxlOiBcIkxlZnQgYWxpZ25lZCBpbWFnZVwiLCBpY29uOiBreSwgY2xhc3NOYW1lOiBcImltYWdlLXN0eWxlLWFsaWduLWxlZnRcIn0sXHJcbiAgICAgICAgICAgIGFsaWduQ2VudGVyOiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImFsaWduQ2VudGVyXCIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJDZW50ZXJlZCBpbWFnZVwiLFxyXG4gICAgICAgICAgICAgICAgaWNvbjogX3ksXHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFwiaW1hZ2Utc3R5bGUtYWxpZ24tY2VudGVyXCJcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYWxpZ25SaWdodDoge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJhbGlnblJpZ2h0XCIsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJSaWdodCBhbGlnbmVkIGltYWdlXCIsXHJcbiAgICAgICAgICAgICAgICBpY29uOiB2eSxcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJpbWFnZS1zdHlsZS1hbGlnbi1yaWdodFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IHh5ID0ge2Z1bGw6IHd5LCBsZWZ0OiBreSwgcmlnaHQ6IHZ5LCBjZW50ZXI6IF95fTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ3kodCA9IFtdKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0Lm1hcChBeSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEF5KHQpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0ID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0O1xyXG4gICAgICAgICAgICAgICAgaWYgKHl5W2VdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IE9iamVjdC5hc3NpZ24oe30sIHl5W2VdKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oT2JqZWN0KHNzW1wiYVwiXSkoXCJpbWFnZS1zdHlsZS1ub3QtZm91bmQ6IFRoZXJlIGlzIG5vIHN1Y2ggaW1hZ2Ugc3R5bGUgb2YgZ2l2ZW4gbmFtZS5cIiksIHtuYW1lOiBlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHtuYW1lOiBlfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHl5W3QubmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB5eVt0Lm5hbWVdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IE9iamVjdC5hc3NpZ24oe30sIHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIGluIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXQuaGFzT3duUHJvcGVydHkobikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaVtuXSA9IGVbbl1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0ID0gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdC5pY29uID09IFwic3RyaW5nXCIgJiYgeHlbdC5pY29uXSkge1xyXG4gICAgICAgICAgICAgICAgdC5pY29uID0geHlbdC5pY29uXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBUeSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW1hZ2VTdHlsZUVkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZGF0YTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmVkaXRpbmc7XHJcbiAgICAgICAgICAgICAgICB0LmNvbmZpZy5kZWZpbmUoXCJpbWFnZS5zdHlsZXNcIiwgW1wiZnVsbFwiLCBcInNpZGVcIl0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IEN5KHQuY29uZmlnLmdldChcImltYWdlLnN0eWxlc1wiKSk7XHJcbiAgICAgICAgICAgICAgICBlLmV4dGVuZChcImltYWdlXCIsIHthbGxvd0F0dHJpYnV0ZXM6IFwiaW1hZ2VTdHlsZVwifSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbXkobyk7XHJcbiAgICAgICAgICAgICAgICBuLmRvd25jYXN0RGlzcGF0Y2hlci5vbihcImF0dHJpYnV0ZTppbWFnZVN0eWxlOmltYWdlXCIsIHIpO1xyXG4gICAgICAgICAgICAgICAgaS5kb3duY2FzdERpc3BhdGNoZXIub24oXCJhdHRyaWJ1dGU6aW1hZ2VTdHlsZTppbWFnZVwiLCByKTtcclxuICAgICAgICAgICAgICAgIGkudXBjYXN0RGlzcGF0Y2hlci5vbihcImVsZW1lbnQ6ZmlndXJlXCIsIHB5KG8pLCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiaW1hZ2VTdHlsZVwiLCBuZXcgZ3kodCwgbykpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBQeSA9IGkoNjgpO1xyXG5cclxuICAgICAgICBjbGFzcyBTeSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW1hZ2VTdHlsZVVJXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGxvY2FsaXplZERlZmF1bHRTdHlsZXNUaXRsZXMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IudDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJGdWxsIHNpemUgaW1hZ2VcIjogdChcImp5XCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiU2lkZSBpbWFnZVwiOiB0KFwianpcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgXCJMZWZ0IGFsaWduZWQgaW1hZ2VcIjogdChcImthXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiQ2VudGVyZWQgaW1hZ2VcIjogdChcImtiXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiUmlnaHQgYWxpZ25lZCBpbWFnZVwiOiB0KFwia2NcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvbmZpZy5nZXQoXCJpbWFnZS5zdHlsZXNcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gRXkoQ3koZSksIHRoaXMubG9jYWxpemVkRGVmYXVsdFN0eWxlc1RpdGxlcyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUJ1dHRvbih0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlQnV0dG9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBgaW1hZ2VTdHlsZToke3QubmFtZX1gO1xyXG4gICAgICAgICAgICAgICAgZS51aS5jb21wb25lbnRGYWN0b3J5LmFkZChpLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5jb21tYW5kcy5nZXQoXCJpbWFnZVN0eWxlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiB0LnRpdGxlLCBpY29uOiB0Lmljb24sIHRvb2x0aXA6IHRydWUsIGlzVG9nZ2xlYWJsZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYmluZChcImlzRW5hYmxlZFwiKS50byhuLCBcImlzRW5hYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc09uXCIpLnRvKG4sIFwidmFsdWVcIiwgZSA9PiBlID09PSB0Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obywgXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5leGVjdXRlKFwiaW1hZ2VTdHlsZVwiLCB7dmFsdWU6IHQubmFtZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEV5KHQsIGUpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlW2kudGl0bGVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS50aXRsZSA9IGVbaS50aXRsZV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgUnkgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1R5LCBTeV1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW1hZ2VTdHlsZVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIE95IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJhY3RpdmVIYW5kbGVQb3NpdGlvblwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwicHJvcG9zZWRXaWR0aFBlcmNlbnRzXCIsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJwcm9wb3NlZFdpZHRoXCIsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJwcm9wb3NlZEhlaWdodFwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwicHJvcG9zZWRIYW5kbGVIb3N0V2lkdGhcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInByb3Bvc2VkSGFuZGxlSG9zdEhlaWdodFwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVmZXJlbmNlQ29vcmRpbmF0ZXMgPSBudWxsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJlZ2luKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgdmgoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUhhbmRsZVBvc2l0aW9uID0gTXkodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWZlcmVuY2VDb29yZGluYXRlcyA9IFZ5KGUsIEJ5KHRoaXMuYWN0aXZlSGFuZGxlUG9zaXRpb24pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxXaWR0aCA9IG4ud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsSGVpZ2h0ID0gbi5oZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFzcGVjdFJhdGlvID0gbi53aWR0aCAvIG4uaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGkuc3R5bGUud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBpZiAobyAmJiBvLm1hdGNoKC9eXFxkK1xcLj9cXGQqJSQvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxXaWR0aFBlcmNlbnRzID0gcGFyc2VGbG9hdChvKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbmFsV2lkdGhQZXJjZW50cyA9IEl5KGksIG4pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3Bvc2VkV2lkdGggPSB0LndpZHRoO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wb3NlZEhlaWdodCA9IHQuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wb3NlZFdpZHRoUGVyY2VudHMgPSB0LndpZHRoUGVyY2VudHM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3Bvc2VkSGFuZGxlSG9zdFdpZHRoID0gdC5oYW5kbGVIb3N0V2lkdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3Bvc2VkSGFuZGxlSG9zdEhlaWdodCA9IHQuaGFuZGxlSG9zdEhlaWdodFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhPeSwgSmMpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBJeSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KGkub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGkpLndpZHRoKTtcclxuICAgICAgICAgICAgcmV0dXJuIGUud2lkdGggLyBuICogMTAwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBWeSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgdmgodCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLnNwbGl0KFwiLVwiKTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IHt4OiBuWzFdID09IFwicmlnaHRcIiA/IGkucmlnaHQgOiBpLmxlZnQsIHk6IG5bMF0gPT0gXCJib3R0b21cIiA/IGkuYm90dG9tIDogaS50b3B9O1xyXG4gICAgICAgICAgICBvLnggKz0gdC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LnNjcm9sbFg7XHJcbiAgICAgICAgICAgIG8ueSArPSB0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuc2Nyb2xsWTtcclxuICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE55KHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGBjay13aWRnZXRfX3Jlc2l6ZXJfX2hhbmRsZS0ke3R9YFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTXkodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gW1widG9wLWxlZnRcIiwgXCJ0b3AtcmlnaHRcIiwgXCJib3R0b20tcmlnaHRcIiwgXCJib3R0b20tbGVmdFwiXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmNsYXNzTGlzdC5jb250YWlucyhOeShpKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCeSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnNwbGl0KFwiLVwiKTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHt0b3A6IFwiYm90dG9tXCIsIGJvdHRvbTogXCJ0b3BcIiwgbGVmdDogXCJyaWdodFwiLCByaWdodDogXCJsZWZ0XCJ9O1xyXG4gICAgICAgICAgICByZXR1cm4gYCR7aVtlWzBdXX0tJHtpW2VbMV1dfWBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHp5IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kb21SZXNpemVyV3JhcHBlciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl92aWV3UmVzaXplcldyYXBwZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0VuYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRlKFwiYmVnaW5cIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRlY29yYXRlKFwiY2FuY2VsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0ZShcImNvbW1pdFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGUoXCJ1cGRhdGVTaXplXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNvbW1pdFwiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc3RhdGUucHJvcG9zZWRXaWR0aCAmJiAhdGhpcy5zdGF0ZS5wcm9wb3NlZFdpZHRoUGVyY2VudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xlYW51cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoXCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhdHRhY2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9vcHRpb25zLnZpZXdFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX29wdGlvbnMuZWRpdG9yLmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGkuY2hhbmdlKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmNyZWF0ZVVJRWxlbWVudChcImRpdlwiLCB7Y2xhc3M6IFwiY2sgY2stcmVzZXRfYWxsIGNrLXdpZGdldF9fcmVzaXplclwifSwgKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnRvRG9tRWxlbWVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5fYXBwZW5kSGFuZGxlcyhpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5fYXBwZW5kU2l6ZVVJKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Ll9kb21SZXNpemVyV3JhcHBlciA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQub24oXCJjaGFuZ2U6aXNFbmFibGVkXCIsICh0LCBlLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnN0eWxlLmRpc3BsYXkgPSBuID8gXCJcIiA6IFwibm9uZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnN0eWxlLmRpc3BsYXkgPSB0LmlzRW5hYmxlZCA/IFwiXCIgOiBcIm5vbmVcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5pbnNlcnQoaS5jcmVhdGVQb3NpdGlvbkF0KGUsIFwiZW5kXCIpLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBpLmFkZENsYXNzKFwiY2std2lkZ2V0X3dpdGgtcmVzaXplclwiLCBlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92aWV3UmVzaXplcldyYXBwZXIgPSBuXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBiZWdpbih0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlID0gbmV3IE95KHRoaXMuX29wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2l6ZVVJLmJpbmRUb1N0YXRlKHRoaXMuX29wdGlvbnMsIHRoaXMuc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5iZWdpbih0LCB0aGlzLl9nZXRIYW5kbGVIb3N0KCksIHRoaXMuX2dldFJlc2l6ZUhvc3QoKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlU2l6ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fcHJvcG9zZU5ld1NpemUodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fb3B0aW9ucy5lZGl0b3IuZWRpdGluZy52aWV3O1xyXG4gICAgICAgICAgICAgICAgaS5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX29wdGlvbnMudW5pdCB8fCBcIiVcIjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gKGkgPT09IFwiJVwiID8gZS53aWR0aFBlcmNlbnRzIDogZS53aWR0aCkgKyBpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0U3R5bGUoXCJ3aWR0aFwiLCBuLCB0aGlzLl9vcHRpb25zLnZpZXdFbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fZ2V0SGFuZGxlSG9zdCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyB2aChuKTtcclxuICAgICAgICAgICAgICAgIGUuaGFuZGxlSG9zdFdpZHRoID0gTWF0aC5yb3VuZChvLndpZHRoKTtcclxuICAgICAgICAgICAgICAgIGUuaGFuZGxlSG9zdEhlaWdodCA9IE1hdGgucm91bmQoby5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyB2aChuKTtcclxuICAgICAgICAgICAgICAgIGUud2lkdGggPSBNYXRoLnJvdW5kKHIud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgZS5oZWlnaHQgPSBNYXRoLnJvdW5kKHIuaGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVkcmF3KG8pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS51cGRhdGUoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29tbWl0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX29wdGlvbnMudW5pdCB8fCBcIiVcIjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSAodCA9PT0gXCIlXCIgPyB0aGlzLnN0YXRlLnByb3Bvc2VkV2lkdGhQZXJjZW50cyA6IHRoaXMuc3RhdGUucHJvcG9zZWRXaWR0aCkgKyB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5vbkNvbW1pdChlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFudXAoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjYW5jZWwoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jbGVhbnVwKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVkcmF3KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9kb21SZXNpemVyV3JhcHBlcjtcclxuICAgICAgICAgICAgICAgIGlmIChpKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5lZGl0b3IuZWRpdGluZy52aWV3LmNoYW5nZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGUucGFyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuX2dldEhhbmRsZUhvc3QoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHQgfHwgbmV3IHZoKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnNldFN0eWxlKFwid2lkdGhcIiwgci53aWR0aCArIFwicHhcIiwgdGhpcy5fdmlld1Jlc2l6ZXJXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zZXRTdHlsZShcImhlaWdodFwiLCByLmhlaWdodCArIFwicHhcIiwgdGhpcy5fdmlld1Jlc2l6ZXJXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHtsZWZ0OiBvLm9mZnNldExlZnQsIHRvcDogby5vZmZzZXRUb3AsIGhlaWdodDogby5vZmZzZXRIZWlnaHQsIHdpZHRoOiBvLm9mZnNldFdpZHRofTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFuLmlzU2FtZU5vZGUobykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0U3R5bGUoXCJsZWZ0XCIsIHMubGVmdCArIFwicHhcIiwgdGhpcy5fdmlld1Jlc2l6ZXJXcmFwcGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0U3R5bGUoXCJ0b3BcIiwgcy50b3AgKyBcInB4XCIsIHRoaXMuX3ZpZXdSZXNpemVyV3JhcHBlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnNldFN0eWxlKFwiaGVpZ2h0XCIsIHMuaGVpZ2h0ICsgXCJweFwiLCB0aGlzLl92aWV3UmVzaXplcldyYXBwZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5zZXRTdHlsZShcIndpZHRoXCIsIHMud2lkdGggKyBcInB4XCIsIHRoaXMuX3ZpZXdSZXNpemVyV3JhcHBlcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaSh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5vd25lckRvY3VtZW50ICYmIHQub3duZXJEb2N1bWVudC5jb250YWlucyh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb250YWluc0hhbmRsZSh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZG9tUmVzaXplcldyYXBwZXIuY29udGFpbnModClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGlzUmVzaXplSGFuZGxlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LmNsYXNzTGlzdC5jb250YWlucyhcImNrLXdpZGdldF9fcmVzaXplcl9faGFuZGxlXCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbGVhbnVwKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2l6ZVVJLmRpc21pc3MoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NpemVVSS5pc1Zpc2libGUgPSBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcHJvcG9zZU5ld1NpemUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuc3RhdGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gRHkodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5fb3B0aW9ucy5pc0NlbnRlcmVkID8gdGhpcy5fb3B0aW9ucy5pc0NlbnRlcmVkKHRoaXMpIDogdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgeDogZS5fcmVmZXJlbmNlQ29vcmRpbmF0ZXMueCAtIChpLnggKyBlLm9yaWdpbmFsV2lkdGgpLFxyXG4gICAgICAgICAgICAgICAgICAgIHk6IGkueSAtIGUub3JpZ2luYWxIZWlnaHQgLSBlLl9yZWZlcmVuY2VDb29yZGluYXRlcy55XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gJiYgZS5hY3RpdmVIYW5kbGVQb3NpdGlvbi5lbmRzV2l0aChcIi1yaWdodFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG8ueCA9IGkueCAtIChlLl9yZWZlcmVuY2VDb29yZGluYXRlcy54ICsgZS5vcmlnaW5hbFdpZHRoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBvLnggKj0gMlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHt3aWR0aDogTWF0aC5hYnMoZS5vcmlnaW5hbFdpZHRoICsgby54KSwgaGVpZ2h0OiBNYXRoLmFicyhlLm9yaWdpbmFsSGVpZ2h0ICsgby55KX07XHJcbiAgICAgICAgICAgICAgICByLmRvbWluYW50ID0gci53aWR0aCAvIGUuYXNwZWN0UmF0aW8gPiByLmhlaWdodCA/IFwid2lkdGhcIiA6IFwiaGVpZ2h0XCI7XHJcbiAgICAgICAgICAgICAgICByLm1heCA9IHJbci5kb21pbmFudF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0ge3dpZHRoOiByLndpZHRoLCBoZWlnaHQ6IHIuaGVpZ2h0fTtcclxuICAgICAgICAgICAgICAgIGlmIChyLmRvbWluYW50ID09IFwid2lkdGhcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHMuaGVpZ2h0ID0gcy53aWR0aCAvIGUuYXNwZWN0UmF0aW9cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcy53aWR0aCA9IHMuaGVpZ2h0ICogZS5hc3BlY3RSYXRpb1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogTWF0aC5yb3VuZChzLndpZHRoKSxcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IE1hdGgucm91bmQocy5oZWlnaHQpLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoUGVyY2VudHM6IE1hdGgubWluKE1hdGgucm91bmQoZS5vcmlnaW5hbFdpZHRoUGVyY2VudHMgLyBlLm9yaWdpbmFsV2lkdGggKiBzLndpZHRoICogMTAwKSAvIDEwMCwgMTAwKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0UmVzaXplSG9zdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9kb21SZXNpemVyV3JhcHBlci5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbnMuZ2V0UmVzaXplSG9zdCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0SGFuZGxlSG9zdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLl9kb21SZXNpemVyV3JhcHBlci5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbnMuZ2V0SGFuZGxlSG9zdCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfYXBwZW5kSGFuZGxlcyh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW1widG9wLWxlZnRcIiwgXCJ0b3AtcmlnaHRcIiwgXCJib3R0b20tcmlnaHRcIiwgXCJib3R0b20tbGVmdFwiXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hcHBlbmRDaGlsZChuZXcgX3Aoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogYGNrLXdpZGdldF9fcmVzaXplcl9faGFuZGxlICR7RnkoaSl9YH1cclxuICAgICAgICAgICAgICAgICAgICB9KS5yZW5kZXIoKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FwcGVuZFNpemVVSSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IEx5O1xyXG4gICAgICAgICAgICAgICAgZS5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NpemVVSSA9IGU7XHJcbiAgICAgICAgICAgICAgICB0LmFwcGVuZENoaWxkKGUuZWxlbWVudClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdnMoenksIEpjKTtcclxuXHJcbiAgICAgICAgY2xhc3MgTHkgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBbXCJja1wiLCBcImNrLXNpemUtdmlld1wiLCB0LnRvKFwiYWN0aXZlSGFuZGxlUG9zaXRpb25cIiwgdCA9PiB0ID8gYGNrLW9yaWVudGF0aW9uLSR7dH1gIDogXCJcIildLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge2Rpc3BsYXk6IHQuaWYoXCJpc1Zpc2libGVcIiwgXCJub25lXCIsIHQgPT4gIXQpfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt7dGV4dDogdC50byhcImxhYmVsXCIpfV1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGJpbmRUb1N0YXRlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZChcImlzVmlzaWJsZVwiKS50byhlLCBcInByb3Bvc2VkV2lkdGhcIiwgZSwgXCJwcm9wb3NlZEhlaWdodFwiLCAodCwgZSkgPT4gdCAhPT0gbnVsbCAmJiBlICE9PSBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZChcImxhYmVsXCIpLnRvKGUsIFwicHJvcG9zZWRIYW5kbGVIb3N0V2lkdGhcIiwgZSwgXCJwcm9wb3NlZEhhbmRsZUhvc3RIZWlnaHRcIiwgZSwgXCJwcm9wb3NlZFdpZHRoUGVyY2VudHNcIiwgKGUsIGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC51bml0ID09PSBcInB4XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke2V9w5cke2l9YFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtufSVgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmQoXCJhY3RpdmVIYW5kbGVQb3NpdGlvblwiKS50byhlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkaXNtaXNzKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy51bmJpbmQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNWaXNpYmxlID0gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRnkodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYGNrLXdpZGdldF9fcmVzaXplcl9faGFuZGxlLSR7dH1gXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBEeSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7eDogdC5wYWdlWCwgeTogdC5wYWdlWX1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBqeSA9IFwiRXhwZWN0ZWQgYSBmdW5jdGlvblwiO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBIeSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gdHJ1ZSwgbyA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdCAhPSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoankpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGN0KGkpKSB7XHJcbiAgICAgICAgICAgICAgICBuID0gXCJsZWFkaW5nXCIgaW4gaSA/ICEhaS5sZWFkaW5nIDogbjtcclxuICAgICAgICAgICAgICAgIG8gPSBcInRyYWlsaW5nXCIgaW4gaSA/ICEhaS50cmFpbGluZyA6IG9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdWgodCwgZSwge2xlYWRpbmc6IG4sIG1heFdhaXQ6IGUsIHRyYWlsaW5nOiBvfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBXeSA9IEh5O1xyXG4gICAgICAgIHZhciBxeSA9IGkoNzApO1xyXG5cclxuICAgICAgICBjbGFzcyBVeSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiV2lkZ2V0UmVzaXplXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiX3Zpc2libGVSZXNpemVyXCIsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJfYWN0aXZlUmVzaXplclwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZXJzID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBJZC53aW5kb3cuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5tb2RlbC5zY2hlbWEuc2V0QXR0cmlidXRlUHJvcGVydGllcyhcIndpZHRoXCIsIHtpc0Zvcm1hdHRpbmc6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyID0gT2JqZWN0LmNyZWF0ZShxZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlci5saXN0ZW5Ubyh0LCBcIm1vdXNlZG93blwiLCB0aGlzLl9tb3VzZURvd25MaXN0ZW5lci5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyLmxpc3RlblRvKHQsIFwibW91c2Vtb3ZlXCIsIHRoaXMuX21vdXNlTW92ZUxpc3RlbmVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXIubGlzdGVuVG8odCwgXCJtb3VzZXVwXCIsIHRoaXMuX21vdXNlVXBMaXN0ZW5lci5iaW5kKHRoaXMpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Zpc2libGVSZXNpemVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2libGVSZXNpemVyLnJlZHJhdygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBXeShlLCAyMDApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTpfdmlzaWJsZVJlc2l6ZXJcIiwgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci51aS5vbihcInVwZGF0ZVwiLCBpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyLmxpc3RlblRvKElkLndpbmRvdywgXCJyZXNpemVcIiwgaSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3LmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIG4ub24oXCJjaGFuZ2VcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuLmdldFNlbGVjdGVkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Zpc2libGVSZXNpemVyID0gdGhpcy5fZ2V0UmVzaXplckJ5Vmlld0VsZW1lbnQodCkgfHwgbnVsbFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX29ic2VydmVyLnN0b3BMaXN0ZW5pbmcoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLl9yZXNpemVycy52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZGVzdHJveSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dGFjaFRvKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgenkodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3IucGx1Z2lucztcclxuICAgICAgICAgICAgICAgIGUuYXR0YWNoKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5oYXMoXCJXaWRnZXRUb29sYmFyUmVwb3NpdG9yeVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLmdldChcIldpZGdldFRvb2xiYXJSZXBvc2l0b3J5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJiZWdpblwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZm9yY2VEaXNhYmxlZChcInJlc2l6ZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJjYW5jZWxcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmNsZWFyRm9yY2VEaXNhYmxlZChcInJlc2l6ZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwiY29tbWl0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5jbGVhckZvcmNlRGlzYWJsZWQoXCJyZXNpemVcIilcclxuICAgICAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaGVzdFwifSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2l6ZXJzLnNldCh0LnZpZXdFbGVtZW50LCBlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRSZXNpemVyQnlIYW5kbGUodCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHRoaXMuX3Jlc2l6ZXJzLnZhbHVlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY29udGFpbnNIYW5kbGUodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRSZXNpemVyQnlWaWV3RWxlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVzaXplcnMuZ2V0KHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9tb3VzZURvd25MaXN0ZW5lcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXp5LmlzUmVzaXplSGFuZGxlKGUudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUudGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZlUmVzaXplciA9IHRoaXMuX2dldFJlc2l6ZXJCeUhhbmRsZShpKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hY3RpdmVSZXNpemVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZlUmVzaXplci5iZWdpbihpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfbW91c2VNb3ZlTGlzdGVuZXIodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FjdGl2ZVJlc2l6ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmVSZXNpemVyLnVwZGF0ZVNpemUoZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX21vdXNlVXBMaXN0ZW5lcigpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hY3RpdmVSZXNpemVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZlUmVzaXplci5jb21taXQoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hY3RpdmVSZXNpemVyID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2cyhVeSwgSmMpO1xyXG5cclxuICAgICAgICBjbGFzcyAkeSBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IHl2KHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0IHx8ICF0Lmhhc0F0dHJpYnV0ZShcIndpZHRoXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG51bGxcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHt3aWR0aDogdC5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSwgaGVpZ2h0OiBudWxsfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRTZWxlY3RlZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIGUuY2hhbmdlKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgdC53aWR0aCwgaSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBHeSA9IGkoNzIpO1xyXG5cclxuICAgICAgICBjbGFzcyBLeSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbVXldXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkltYWdlUmVzaXplXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgJHkodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWdpc3RlclNjaGVtYSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJDb252ZXJ0ZXJzKCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImltYWdlUmVzaXplXCIsIGUpO1xyXG4gICAgICAgICAgICAgICAgdC5lZGl0aW5nLmRvd25jYXN0RGlzcGF0Y2hlci5vbihcImluc2VydDppbWFnZVwiLCAoaSwgbiwgbykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBvLm1hcHBlci50b1ZpZXdFbGVtZW50KG4uaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHQucGx1Z2lucy5nZXQoVXkpLmF0dGFjaFRvKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogdC5jb25maWcuZ2V0KFwiaW1hZ2UucmVzaXplVW5pdFwiKSB8fCBcIiVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxFbGVtZW50OiBuLml0ZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdFbGVtZW50OiByLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlZGl0b3I6IHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldEhhbmRsZUhvc3QodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQucXVlcnlTZWxlY3RvcihcImltZ1wiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRSZXNpemVIb3N0KHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQ2VudGVyZWQoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5pdGVtLmdldEF0dHJpYnV0ZShcImltYWdlU3R5bGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXQgfHwgdCA9PSBcImZ1bGxcIiB8fCB0ID09IFwiYWxpZ25DZW50ZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNvbW1pdChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoXCJpbWFnZVJlc2l6ZVwiLCB7d2lkdGg6IGV9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5vbihcInVwZGF0ZVNpemVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXIuaGFzQ2xhc3MoXCJpbWFnZV9yZXNpemVkXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5hZGRDbGFzcyhcImltYWdlX3Jlc2l6ZWRcIiwgcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBzLmJpbmQoXCJpc0VuYWJsZWRcIikudG8oZSlcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZWdpc3RlclNjaGVtYSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm1vZGVsLnNjaGVtYS5leHRlbmQoXCJpbWFnZVwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBcIndpZHRoXCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVnaXN0ZXJDb252ZXJ0ZXJzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcImRvd25jYXN0XCIpLmFkZCh0ID0+IHQub24oXCJhdHRyaWJ1dGU6d2lkdGg6aW1hZ2VcIiwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS5jb25zdW1lKGUuaXRlbSwgdC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkud3JpdGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLm1hcHBlci50b1ZpZXdFbGVtZW50KGUuaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuYXR0cmlidXRlTmV3VmFsdWUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5zZXRTdHlsZShcIndpZHRoXCIsIGUuYXR0cmlidXRlTmV3VmFsdWUsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLmFkZENsYXNzKFwiaW1hZ2VfcmVzaXplZFwiLCBvKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ucmVtb3ZlU3R5bGUoXCJ3aWR0aFwiLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5yZW1vdmVDbGFzcyhcImltYWdlX3Jlc2l6ZWRcIiwgbylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uZm9yKFwidXBjYXN0XCIpLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiB7bmFtZTogXCJmaWd1cmVcIiwgc3R5bGVzOiB7d2lkdGg6IC8uKy99fSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2tleTogXCJ3aWR0aFwiLCB2YWx1ZTogdCA9PiB0LmdldFN0eWxlKFwid2lkdGhcIil9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBKeSBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ1dHRvblZpZXcgPSBuZXcgaGIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxlSW5wdXRWaWV3ID0gbmV3IFl5KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsZUlucHV0Vmlldy5iaW5kKFwiYWNjZXB0ZWRUeXBlXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsZUlucHV0Vmlldy5iaW5kKFwiYWxsb3dNdWx0aXBsZUZpbGVzXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlsZUlucHV0Vmlldy5kZWxlZ2F0ZShcImRvbmVcIikudG8odGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogXCJjay1maWxlLWRpYWxvZy1idXR0b25cIn0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt0aGlzLmJ1dHRvblZpZXcsIHRoaXMuX2ZpbGVJbnB1dFZpZXddXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uVmlldy5vbihcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZpbGVJbnB1dFZpZXcub3BlbigpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnV0dG9uVmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFl5IGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiYWNjZXB0ZWRUeXBlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJhbGxvd011bHRpcGxlRmlsZXNcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImlucHV0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2staGlkZGVuXCJdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImZpbGVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiaW5kZXg6IFwiLTFcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0OiBlLnRvKFwiYWNjZXB0ZWRUeXBlXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtdWx0aXBsZTogZS50byhcImFsbG93TXVsdGlwbGVGaWxlc1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlOiBlLnRvKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQgJiYgdGhpcy5lbGVtZW50LmZpbGVzICYmIHRoaXMuZWxlbWVudC5maWxlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJkb25lXCIsIHRoaXMuZWxlbWVudC5maWxlcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvcGVuKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmNsaWNrKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFF5ID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTYuOTEgMTAuNTRjLjI2LS4yMy42NC0uMjEuODguMDNsMy4zNiAzLjE0IDIuMjMtMi4wNmEuNjQuNjQgMCAwIDEgLjg3IDBsMi41MiAyLjk3VjQuNUgzLjJ2MTAuMTJsMy43MS00LjA4em0xMC4yNy03LjUxYy42IDAgMS4wOS40NyAxLjA5IDEuMDV2MTEuODRjMCAuNTktLjQ5IDEuMDYtMS4wOSAxLjA2SDIuNzljLS42IDAtMS4wOS0uNDctMS4wOS0xLjA2VjQuMDhjMC0uNTguNDktMS4wNSAxLjEtMS4wNWgxNC4zOHptLTUuMjIgNS41NmExLjk2IDEuOTYgMCAxIDEgMy40LTEuOTYgMS45NiAxLjk2IDAgMCAxLTMuNCAxLjk2elwiLz48L3N2Zz4nO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBYeSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1hcCh0ID0+IHQucmVwbGFjZShcIitcIiwgXCJcXFxcK1wiKSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKGBeaW1hZ2VcXFxcLygke2Uuam9pbihcInxcIil9KSRgKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWnkodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldEF0dHJpYnV0ZShcInNyY1wiKTtcclxuICAgICAgICAgICAgICAgIGZldGNoKG4pLnRoZW4odCA9PiB0LmJsb2IoKSkudGhlbih0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gZXgodCwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG8ucmVwbGFjZShcImltYWdlL1wiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gYGltYWdlLiR7cn1gO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBpeCh0LCBzLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICBhID8gZShhKSA6IGkoKVxyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goaSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHR4KHQpIHtcclxuICAgICAgICAgICAgaWYgKCF0LmlzKFwiZWxlbWVudFwiLCBcImltZ1wiKSB8fCAhdC5nZXRBdHRyaWJ1dGUoXCJzcmNcIikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0LmdldEF0dHJpYnV0ZShcInNyY1wiKS5tYXRjaCgvXmRhdGE6aW1hZ2VcXC9cXHcrO2Jhc2U2NCwvZykgfHwgdC5nZXRBdHRyaWJ1dGUoXCJzcmNcIikubWF0Y2goL15ibG9iOi9nKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXgodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC50eXBlXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5tYXRjaCgvZGF0YTooaW1hZ2VcXC9cXHcrKTtiYXNlNjQvKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUubWF0Y2goL2RhdGE6KGltYWdlXFwvXFx3Kyk7YmFzZTY0LylbMV0udG9Mb3dlckNhc2UoKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaW1hZ2UvanBlZ1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGl4KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRmlsZShbdF0sIGUsIHt0eXBlOiBpfSlcclxuICAgICAgICAgICAgfSBjYXRjaCAodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgbnggZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgdC51aS5jb21wb25lbnRGYWN0b3J5LmFkZChcImltYWdlVXBsb2FkXCIsIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgSnkoaSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGtiYWxhc2hldiAgKGltYWdlIHVwbG9hZCBidXR0b24gZml4KVxyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLmJ1dHRvblZpZXcsICdpc0VuYWJsZWQnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldDogKCkgPT4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5jb21tYW5kcy5nZXQoXCJpbWFnZVVwbG9hZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdC5jb25maWcuZ2V0KFwiaW1hZ2UudXBsb2FkLnR5cGVzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBYeShyKTtcclxuICAgICAgICAgICAgICAgICAgICBuLnNldCh7YWNjZXB0ZWRUeXBlOiByLm1hcCh0ID0+IGBpbWFnZS8ke3R9YCkuam9pbihcIixcIiksIGFsbG93TXVsdGlwbGVGaWxlczogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uYnV0dG9uVmlldy5zZXQoe2xhYmVsOiBlKFwia2RcIiksIGljb246IFF5LCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5idXR0b25WaWV3LmJpbmQoXCJpc0VuYWJsZWRcIikudG8obyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5vbihcImRvbmVcIiwgKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEFycmF5LmZyb20oaSkuZmlsdGVyKHQgPT4gcy50ZXN0KHQudHlwZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY3V0ZShcImltYWdlVXBsb2FkXCIsIHtmaWxlOiBufSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgb3ggPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCA3MDAgMjUwXCI+PHJlY3Qgcng9XCI0XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIHJ4ID0gaSg3NCk7XHJcbiAgICAgICAgdmFyIHN4ID0gaSg3Nik7XHJcbiAgICAgICAgdmFyIGF4ID0gaSg3OCk7XHJcblxyXG4gICAgICAgIGNsYXNzIGN4IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxhY2Vob2xkZXIgPSBcImRhdGE6aW1hZ2Uvc3ZnK3htbDt1dGY4LFwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG94KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgdC5lZGl0aW5nLmRvd25jYXN0RGlzcGF0Y2hlci5vbihcImF0dHJpYnV0ZTp1cGxvYWRTdGF0dXM6aW1hZ2VcIiwgKC4uLnQpID0+IHRoaXMudXBsb2FkU3RhdHVzQ2hhbmdlKC4uLnQpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB1cGxvYWRTdGF0dXNDaGFuZ2UodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuaXRlbTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBvLmdldEF0dHJpYnV0ZShcInVwbG9hZElkXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpLmNvbnN1bWFibGUuY29uc3VtZShlLml0ZW0sIHQubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLnBsdWdpbnMuZ2V0KGxrKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSByID8gZS5hdHRyaWJ1dGVOZXdWYWx1ZSA6IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gdGhpcy5wbGFjZWhvbGRlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBuLmVkaXRpbmcubWFwcGVyLnRvVmlld0VsZW1lbnQobyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0gaS53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBpZiAoYSA9PSBcInJlYWRpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGx4KGwsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHV4KGMsIGwsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGEgPT0gXCJ1cGxvYWRpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzLmxvYWRlcnMuZ2V0KHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGx4KGwsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1eChjLCBsLCBkKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGh4KGwsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmeChsLCBkLCB0LCBuLmVkaXRpbmcudmlldyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF94KGwsIGQsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGEgPT0gXCJjb21wbGV0ZVwiICYmIHMubG9hZGVycy5nZXQocikgJiYgIUFsLmlzRWRnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG14KGwsIGQsIG4uZWRpdGluZy52aWV3KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZ3gobCwgZCk7XHJcbiAgICAgICAgICAgICAgICBoeChsLCBkKTtcclxuICAgICAgICAgICAgICAgIGR4KGwsIGQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGx4KHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKCF0Lmhhc0NsYXNzKFwiY2stYXBwZWFyXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBlLmFkZENsYXNzKFwiY2stYXBwZWFyXCIsIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGR4KHQsIGUpIHtcclxuICAgICAgICAgICAgZS5yZW1vdmVDbGFzcyhcImNrLWFwcGVhclwiLCB0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdXgodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBpZiAoIWUuaGFzQ2xhc3MoXCJjay1pbWFnZS11cGxvYWQtcGxhY2Vob2xkZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIGkuYWRkQ2xhc3MoXCJjay1pbWFnZS11cGxvYWQtcGxhY2Vob2xkZXJcIiwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBuID0gQXYoZSk7XHJcbiAgICAgICAgICAgIGlmIChuLmdldEF0dHJpYnV0ZShcInNyY1wiKSAhPT0gdCkge1xyXG4gICAgICAgICAgICAgICAgaS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdCwgbilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXd4KGUsIFwicGxhY2Vob2xkZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIGkuaW5zZXJ0KGkuY3JlYXRlUG9zaXRpb25BZnRlcihuKSwgYngoaSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGh4KHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKHQuaGFzQ2xhc3MoXCJjay1pbWFnZS11cGxvYWQtcGxhY2Vob2xkZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIGUucmVtb3ZlQ2xhc3MoXCJjay1pbWFnZS11cGxvYWQtcGxhY2Vob2xkZXJcIiwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBreCh0LCBlLCBcInBsYWNlaG9sZGVyXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBmeCh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBweChlKTtcclxuICAgICAgICAgICAgZS5pbnNlcnQoZS5jcmVhdGVQb3NpdGlvbkF0KHQsIFwiZW5kXCIpLCBvKTtcclxuICAgICAgICAgICAgaS5vbihcImNoYW5nZTp1cGxvYWRlZFBlcmNlbnRcIiwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIG4uY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0U3R5bGUoXCJ3aWR0aFwiLCBpICsgXCIlXCIsIG8pXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ3godCwgZSkge1xyXG4gICAgICAgICAgICBreCh0LCBlLCBcInByb2dyZXNzQmFyXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBteCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmNyZWF0ZVVJRWxlbWVudChcImRpdlwiLCB7Y2xhc3M6IFwiY2staW1hZ2UtdXBsb2FkLWNvbXBsZXRlLWljb25cIn0pO1xyXG4gICAgICAgICAgICBlLmluc2VydChlLmNyZWF0ZVBvc2l0aW9uQXQodCwgXCJlbmRcIiksIG4pO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGkuY2hhbmdlKHQgPT4gdC5yZW1vdmUodC5jcmVhdGVSYW5nZU9uKG4pKSlcclxuICAgICAgICAgICAgfSwgM2UzKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcHgodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5jcmVhdGVVSUVsZW1lbnQoXCJkaXZcIiwge2NsYXNzOiBcImNrLXByb2dyZXNzLWJhclwifSk7XHJcbiAgICAgICAgICAgIHQuc2V0Q3VzdG9tUHJvcGVydHkoXCJwcm9ncmVzc0JhclwiLCB0cnVlLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJ4KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuY3JlYXRlVUlFbGVtZW50KFwiZGl2XCIsIHtjbGFzczogXCJjay11cGxvYWQtcGxhY2Vob2xkZXItbG9hZGVyXCJ9KTtcclxuICAgICAgICAgICAgdC5zZXRDdXN0b21Qcm9wZXJ0eShcInBsYWNlaG9sZGVyXCIsIHRydWUsIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gd3godCwgZSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdC5nZXRDaGlsZHJlbigpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5nZXRDdXN0b21Qcm9wZXJ0eShlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGt4KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHd4KHQsIGkpO1xyXG4gICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgZS5yZW1vdmUoZS5jcmVhdGVSYW5nZU9uKG4pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfeCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmIChpLmRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBBdih0KTtcclxuICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKFwic3JjXCIsIGkuZGF0YSwgbilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdnggZXh0ZW5kcyBzayB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIk5vdGlmaWNhdGlvblwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwic2hvdzp3YXJuaW5nXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KGUubWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNob3dTdWNjZXNzKHQsIGUgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2hvd05vdGlmaWNhdGlvbih7bWVzc2FnZTogdCwgdHlwZTogXCJzdWNjZXNzXCIsIG5hbWVzcGFjZTogZS5uYW1lc3BhY2UsIHRpdGxlOiBlLnRpdGxlfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2hvd0luZm8odCwgZSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zaG93Tm90aWZpY2F0aW9uKHttZXNzYWdlOiB0LCB0eXBlOiBcImluZm9cIiwgbmFtZXNwYWNlOiBlLm5hbWVzcGFjZSwgdGl0bGU6IGUudGl0bGV9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzaG93V2FybmluZyh0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dOb3RpZmljYXRpb24oe21lc3NhZ2U6IHQsIHR5cGU6IFwid2FybmluZ1wiLCBuYW1lc3BhY2U6IGUubmFtZXNwYWNlLCB0aXRsZTogZS50aXRsZX0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zaG93Tm90aWZpY2F0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBgc2hvdzoke3QudHlwZX1gICsgKHQubmFtZXNwYWNlID8gYDoke3QubmFtZXNwYWNlfWAgOiBcIlwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZShlLCB7bWVzc2FnZTogdC5tZXNzYWdlLCB0eXBlOiB0LnR5cGUsIHRpdGxlOiB0LnRpdGxlIHx8IFwiXCJ9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB5eCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXMgPSB4eCh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25hdGl2ZSA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IHR5cGVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hdGl2ZS50eXBlc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXREYXRhKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYXRpdmUuZ2V0RGF0YSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXREYXRhKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX25hdGl2ZS5zZXREYXRhKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHh4KHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZmlsZXMgPyBBcnJheS5mcm9tKHQuZmlsZXMpIDogW107XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0Lml0ZW1zID8gQXJyYXkuZnJvbSh0Lml0ZW1zKSA6IFtdO1xyXG4gICAgICAgICAgICBpZiAoZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGkuZmlsdGVyKHQgPT4gdC5raW5kID09PSBcImZpbGVcIikubWFwKHQgPT4gdC5nZXRBc0ZpbGUoKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEN4IGV4dGVuZHMgSnUge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudFR5cGUgPSBbXCJwYXN0ZVwiLCBcImNvcHlcIiwgXCJjdXRcIiwgXCJkcm9wXCIsIFwiZHJhZ292ZXJcIl07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwicGFzdGVcIiwgaSwge3ByaW9yaXR5OiBcImxvd1wifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwiZHJvcFwiLCBpLCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBpKHQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZHJvcFJhbmdlID8gW2kuZHJvcFJhbmdlXSA6IEFycmF5LmZyb20oZS5zZWxlY3Rpb24uZ2V0UmFuZ2VzKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgdHMoZSwgXCJjbGlwYm9hcmRJbnB1dFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBlLmZpcmUobywge2RhdGFUcmFuc2ZlcjogaS5kYXRhVHJhbnNmZXIsIHRhcmdldFJhbmdlczogbn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvLnN0b3AuY2FsbGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuc3RvcFByb3BhZ2F0aW9uKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9uRG9tRXZlbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHtkYXRhVHJhbnNmZXI6IG5ldyB5eCh0LmNsaXBib2FyZERhdGEgPyB0LmNsaXBib2FyZERhdGEgOiB0LmRhdGFUcmFuc2Zlcil9O1xyXG4gICAgICAgICAgICAgICAgaWYgKHQudHlwZSA9PSBcImRyb3BcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuZHJvcFJhbmdlID0gQXgodGhpcy52aWV3LCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHQudHlwZSwgdCwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQXgodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZS50YXJnZXQub3duZXJEb2N1bWVudDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUuY2xpZW50WDtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGUuY2xpZW50WTtcclxuICAgICAgICAgICAgbGV0IHI7XHJcbiAgICAgICAgICAgIGlmIChpLmNhcmV0UmFuZ2VGcm9tUG9pbnQgJiYgaS5jYXJldFJhbmdlRnJvbVBvaW50KG4sIG8pKSB7XHJcbiAgICAgICAgICAgICAgICByID0gaS5jYXJldFJhbmdlRnJvbVBvaW50KG4sIG8pXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5yYW5nZVBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgciA9IGkuY3JlYXRlUmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIHIuc2V0U3RhcnQoZS5yYW5nZVBhcmVudCwgZS5yYW5nZU9mZnNldCk7XHJcbiAgICAgICAgICAgICAgICByLmNvbGxhcHNlKHRydWUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LmRvbUNvbnZlcnRlci5kb21SYW5nZVRvVmlldyhyKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuZG9jdW1lbnQuc2VsZWN0aW9uLmdldEZpcnN0UmFuZ2UoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBUeCh0KSB7XHJcbiAgICAgICAgICAgIHQgPSB0LnJlcGxhY2UoLzwvZywgXCImbHQ7XCIpLnJlcGxhY2UoLz4vZywgXCImZ3Q7XCIpLnJlcGxhY2UoL1xcbi9nLCBcIjwvcD48cD5cIikucmVwbGFjZSgvXlxccy8sIFwiJm5ic3A7XCIpLnJlcGxhY2UoL1xccyQvLCBcIiZuYnNwO1wiKS5yZXBsYWNlKC9cXHNcXHMvZywgXCIgJm5ic3A7XCIpO1xyXG4gICAgICAgICAgICBpZiAodC5pbmRleE9mKFwiPC9wPjxwPlwiKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gYDxwPiR7dH08L3A+YFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBQeCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LnJlcGxhY2UoLzxzcGFuKD86IGNsYXNzPVwiQXBwbGUtY29udmVydGVkLXNwYWNlXCJ8KT4oXFxzKyk8XFwvc3Bhbj4vZywgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlLmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiIFwiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgU3ggPSBbXCJmaWdjYXB0aW9uXCIsIFwibGlcIl07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEV4KHQpIHtcclxuICAgICAgICAgICAgbGV0IGUgPSBcIlwiO1xyXG4gICAgICAgICAgICBpZiAodC5pcyhcInRleHRcIikgfHwgdC5pcyhcInRleHRQcm94eVwiKSkge1xyXG4gICAgICAgICAgICAgICAgZSA9IHQuZGF0YVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHQuaXMoXCJpbWdcIikgJiYgdC5oYXNBdHRyaWJ1dGUoXCJhbHRcIikpIHtcclxuICAgICAgICAgICAgICAgIGUgPSB0LmdldEF0dHJpYnV0ZShcImFsdFwiKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBFeChuKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSAmJiAoaS5pcyhcImNvbnRhaW5lckVsZW1lbnRcIikgfHwgbi5pcyhcImNvbnRhaW5lckVsZW1lbnRcIikpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTeC5pbmNsdWRlcyhpLm5hbWUpIHx8IFN4LmluY2x1ZGVzKG4ubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgKz0gXCJcXG5cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSArPSBcIlxcblxcblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZSArPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFJ4IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJDbGlwYm9hcmRcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5lZGl0aW5nLnZpZXc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2h0bWxEYXRhUHJvY2Vzc29yID0gbmV3IGdwKG4pO1xyXG4gICAgICAgICAgICAgICAgaS5hZGRPYnNlcnZlcihDeCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG4sIFwiY2xpcGJvYXJkSW5wdXRcIiwgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXNSZWFkT25seSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obiwgXCJjbGlwYm9hcmRJbnB1dFwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmRhdGFUcmFuc2ZlcjtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4uZ2V0RGF0YShcInRleHQvaHRtbFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gUHgobi5nZXREYXRhKFwidGV4dC9odG1sXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobi5nZXREYXRhKFwidGV4dC9wbGFpblwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gVHgobi5nZXREYXRhKFwidGV4dC9wbGFpblwiKSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbyA9IHRoaXMuX2h0bWxEYXRhUHJvY2Vzc29yLnRvVmlldyhvKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJpbnB1dFRyYW5zZm9ybWF0aW9uXCIsIHtjb250ZW50OiBvLCBkYXRhVHJhbnNmZXI6IG59KTtcclxuICAgICAgICAgICAgICAgICAgICBpLnNjcm9sbFRvVGhlU2VsZWN0aW9uKClcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0aGlzLCBcImlucHV0VHJhbnNmb3JtYXRpb25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWUuY29udGVudC5pc0VtcHR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRvTW9kZWwoZS5jb250ZW50LCBcIiRjbGlwYm9hcmRIb2xkZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmNoaWxkQ291bnQgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5pbnNlcnRDb250ZW50KG4pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd1wifSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbyhpLCBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG8uZGF0YVRyYW5zZmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIG8ucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gdC5kYXRhLnRvVmlldyh0Lm1vZGVsLmdldFNlbGVjdGVkQ29udGVudChlLnNlbGVjdGlvbikpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uZmlyZShcImNsaXBib2FyZE91dHB1dFwiLCB7ZGF0YVRyYW5zZmVyOiByLCBjb250ZW50OiBzLCBtZXRob2Q6IGkubmFtZX0pXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhuLCBcImNvcHlcIiwgbywge3ByaW9yaXR5OiBcImxvd1wifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG4sIFwiY3V0XCIsIChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXNSZWFkT25seSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvKGUsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd1wifSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG4sIFwiY2xpcGJvYXJkT3V0cHV0XCIsIChpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuLmNvbnRlbnQuaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLmRhdGFUcmFuc2Zlci5zZXREYXRhKFwidGV4dC9odG1sXCIsIHRoaXMuX2h0bWxEYXRhUHJvY2Vzc29yLnRvRGF0YShuLmNvbnRlbnQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5kYXRhVHJhbnNmZXIuc2V0RGF0YShcInRleHQvcGxhaW5cIiwgRXgobi5jb250ZW50KSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4ubWV0aG9kID09IFwiY3V0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5tb2RlbC5kZWxldGVDb250ZW50KGUuc2VsZWN0aW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJsb3dcIn0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIE94IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb2N1bWVudCA9IHRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlRG9jdW1lbnRGcmFnbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHFsKHRoaXMuZG9jdW1lbnQsIHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZUVsZW1lbnQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB6Yyh0aGlzLmRvY3VtZW50LCB0LCBlLCBpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVUZXh0KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgTHModGhpcy5kb2N1bWVudCwgdClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xvbmUodCwgZSA9IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5fY2xvbmUoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYXBwZW5kQ2hpbGQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuX2FwcGVuZENoaWxkKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluc2VydENoaWxkKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpLl9pbnNlcnRDaGlsZCh0LCBlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW1vdmVDaGlsZHJlbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaS5fcmVtb3ZlQ2hpbGRyZW4odCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGRyZW4oZS5nZXRDaGlsZEluZGV4KHQpLCAxLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlcGxhY2UodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5nZXRDaGlsZEluZGV4KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpbGRyZW4obiwgMSwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnNlcnRDaGlsZChuLCBlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVud3JhcEVsZW1lbnQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5nZXRDaGlsZEluZGV4KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5zZXJ0Q2hpbGQoaSwgdC5nZXRDaGlsZHJlbigpLCBlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5hbWUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyB6Yyh0aGlzLmRvY3VtZW50LCB0LCBlLmdldEF0dHJpYnV0ZXMoKSwgZS5nZXRDaGlsZHJlbigpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoZSwgaSkgPyBpIDogbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGUodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaS5fc2V0QXR0cmlidXRlKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZUF0dHJpYnV0ZSh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBlLl9yZW1vdmVBdHRyaWJ1dGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWRkQ2xhc3ModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZS5fYWRkQ2xhc3ModClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVtb3ZlQ2xhc3ModCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZS5fcmVtb3ZlQ2xhc3ModClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0U3R5bGUodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKE4odCkgJiYgaSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGkuX3NldFN0eWxlKHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZVN0eWxlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGUuX3JlbW92ZVN0eWxlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldEN1c3RvbVByb3BlcnR5KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIGkuX3NldEN1c3RvbVByb3BlcnR5KHQsIGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbW92ZUN1c3RvbVByb3BlcnR5KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLl9yZW1vdmVDdXN0b21Qcm9wZXJ0eSh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVQb3NpdGlvbkF0KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkbC5fY3JlYXRlQXQodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUG9zaXRpb25BZnRlcih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGwuX2NyZWF0ZUFmdGVyKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVBvc2l0aW9uQmVmb3JlKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkbC5fY3JlYXRlQmVmb3JlKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVJhbmdlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgdWwodCwgZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3JlYXRlUmFuZ2VPbih0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdWwuX2NyZWF0ZU9uKHQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVJhbmdlSW4odCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVsLl9jcmVhdGVJbih0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVTZWxlY3Rpb24odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBnbCh0LCBlLCBpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBJeCBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gQ3YodGhpcy5lZGl0b3IubW9kZWwpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGtiYWxhc2hldiAgKGltYWdlIHVwbG9hZCBidXR0b24gZml4KVxyXG4gICAgICAgICAgICAgICAgZS5tb2RlbC5kZWxldGVDb250ZW50KGUubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLnBsdWdpbnMuZ2V0KGxrKTtcclxuICAgICAgICAgICAgICAgIGkuY2hhbmdlKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBBcnJheS5pc0FycmF5KHQuZmlsZSkgPyB0LmZpbGUgOiBbdC5maWxlXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBWeChlLCBpLCBuLCB0KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFZ4KHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGkuY3JlYXRlTG9hZGVyKG4pO1xyXG4gICAgICAgICAgICBpZiAoIW8pIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHh2KHQsIGUsIHt1cGxvYWRJZDogby5pZH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBOeCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbbGssIHZ4LCBSeF1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW1hZ2VVcGxvYWRFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbmZpZy5kZWZpbmUoXCJpbWFnZVwiLCB7dXBsb2FkOiB7dHlwZXM6IFtcImpwZWdcIiwgXCJwbmdcIiwgXCJnaWZcIiwgXCJibXBcIiwgXCJ3ZWJwXCIsIFwidGlmZlwiXX19KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5tb2RlbC5zY2hlbWE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb252ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHQucGx1Z2lucy5nZXQobGspO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IFh5KHQuY29uZmlnLmdldChcImltYWdlLnVwbG9hZC50eXBlc1wiKSk7XHJcbiAgICAgICAgICAgICAgICBpLmV4dGVuZChcImltYWdlXCIsIHthbGxvd0F0dHJpYnV0ZXM6IFtcInVwbG9hZElkXCIsIFwidXBsb2FkU3RhdHVzXCJdfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImltYWdlVXBsb2FkXCIsIG5ldyBJeCh0KSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcInVwY2FzdFwiKS5hdHRyaWJ1dGVUb0F0dHJpYnV0ZSh7dmlldzoge25hbWU6IFwiaW1nXCIsIGtleTogXCJ1cGxvYWRJZFwifSwgbW9kZWw6IFwidXBsb2FkSWRcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LmVkaXRpbmcudmlldy5kb2N1bWVudCwgXCJjbGlwYm9hcmRJbnB1dFwiLCAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChNeChpLmRhdGFUcmFuc2ZlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBBcnJheS5mcm9tKGkuZGF0YVRyYW5zZmVyLmZpbGVzKS5maWx0ZXIodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIudGVzdCh0LnR5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGkudGFyZ2V0UmFuZ2VzLm1hcChlID0+IHQuZWRpdGluZy5tYXBwZXIudG9Nb2RlbFJhbmdlKGUpKTtcclxuICAgICAgICAgICAgICAgICAgICB0Lm1vZGVsLmNoYW5nZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zZXRTZWxlY3Rpb24obyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lm1vZGVsLmVucXVldWVDaGFuZ2UoXCJkZWZhdWx0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoXCJpbWFnZVVwbG9hZFwiLCB7ZmlsZTogbn0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LnBsdWdpbnMuZ2V0KFJ4KSwgXCJpbnB1dFRyYW5zZm9ybWF0aW9uXCIsIChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEFycmF5LmZyb20odC5lZGl0aW5nLnZpZXcuY3JlYXRlUmFuZ2VJbihpLmNvbnRlbnQpKS5maWx0ZXIodCA9PiB0eCh0Lml0ZW0pICYmICF0Lml0ZW0uZ2V0QXR0cmlidXRlKFwidXBsb2FkUHJvY2Vzc2VkXCIpKS5tYXAodCA9PiAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9taXNlOiBaeSh0Lml0ZW0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUVsZW1lbnQ6IHQuaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW4ubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IE94KHQuZWRpdGluZy52aWV3LmRvY3VtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLnNldEF0dHJpYnV0ZShcInVwbG9hZFByb2Nlc3NlZFwiLCB0cnVlLCB0LmltYWdlRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBvLmNyZWF0ZUxvYWRlcih0LnByb21pc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJcIiwgdC5pbWFnZUVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zZXRBdHRyaWJ1dGUoXCJ1cGxvYWRJZFwiLCBlLmlkLCB0LmltYWdlRWxlbWVudClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQub24oXCJkcmFnb3ZlclwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5kaWZmZXIuZ2V0Q2hhbmdlcyh7aW5jbHVkZUNoYW5nZXNJbkdyYXZleWFyZDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT0gXCJpbnNlcnRcIiAmJiBlLm5hbWUgIT0gXCIkdGV4dFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5wb3NpdGlvbi5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5wb3NpdGlvbi5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIEJ4KHQsIGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0QXR0cmlidXRlKFwidXBsb2FkSWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBvLmxvYWRlcnMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmFib3J0KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGkuc3RhdHVzID09IFwiaWRsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRBbmRVcGxvYWQoaSwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVhZEFuZFVwbG9hZCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLmxvY2FsZS50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGkucGx1Z2lucy5nZXQobGspO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGkucGx1Z2lucy5nZXQodngpO1xyXG4gICAgICAgICAgICAgICAgbi5lbnF1ZXVlQ2hhbmdlKFwidHJhbnNwYXJlbnRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoXCJ1cGxvYWRTdGF0dXNcIiwgXCJyZWFkaW5nXCIsIGUpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LnJlYWQoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdC51cGxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoQWwuaXNTYWZhcmkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkuZWRpdGluZy5tYXBwZXIudG9WaWV3RWxlbWVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEF2KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmVkaXRpbmcudmlldy5vbmNlKFwicmVuZGVyXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbi5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLmVkaXRpbmcudmlldy5kb21Db252ZXJ0ZXIubWFwVmlld1RvRG9tKG4ucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc3R5bGUuZGlzcGxheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5fY2tIYWNrID0gdC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnN0eWxlLmRpc3BsYXkgPSBlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG4uZW5xdWV1ZUNoYW5nZShcInRyYW5zcGFyZW50XCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNldEF0dHJpYnV0ZShcInVwbG9hZFN0YXR1c1wiLCBcInVwbG9hZGluZ1wiLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICB9KS50aGVuKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG4uZW5xdWV1ZUNoYW5nZShcInRyYW5zcGFyZW50XCIsIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnNldEF0dHJpYnV0ZXMoe3VwbG9hZFN0YXR1czogXCJjb21wbGV0ZVwiLCBzcmM6IHQuZGVmYXVsdH0sIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZUFuZFNldFNyY3NldEF0dHJpYnV0ZU9uSW1hZ2UodCwgZSwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBhKClcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnN0YXR1cyAhPT0gXCJlcnJvclwiICYmIHQuc3RhdHVzICE9PSBcImFib3J0ZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LnN0YXR1cyA9PSBcImVycm9yXCIgJiYgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzLnNob3dXYXJuaW5nKGksIHt0aXRsZTogbyhcImtlXCIpLCBuYW1lc3BhY2U6IFwidXBsb2FkXCJ9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5lbnF1ZXVlQ2hhbmdlKFwidHJhbnNwYXJlbnRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5lbnF1ZXVlQ2hhbmdlKFwidHJhbnNwYXJlbnRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKFwidXBsb2FkSWRcIiwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKFwidXBsb2FkU3RhdHVzXCIsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgci5kZXN0cm95TG9hZGVyKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9wYXJzZUFuZFNldFNyY3NldEF0dHJpYnV0ZU9uSW1hZ2UodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSAwO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IE9iamVjdC5rZXlzKHQpLmZpbHRlcih0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gcGFyc2VJbnQodCwgMTApO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiA9IE1hdGgubWF4KG4sIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLm1hcChlID0+IGAke3RbZV19ICR7ZX13YCkuam9pbihcIiwgXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8gIT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc2V0QXR0cmlidXRlKFwic3Jjc2V0XCIsIHtkYXRhOiBvLCB3aWR0aDogbn0sIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE14KHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odC50eXBlcykuaW5jbHVkZXMoXCJ0ZXh0L2h0bWxcIikgJiYgdC5nZXREYXRhKFwidGV4dC9odG1sXCIpICE9PSBcIlwiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCeCh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHQubW9kZWwuY3JlYXRlUmFuZ2VPbihlKSkuZmlsdGVyKHQgPT4gdC5pdGVtLmlzKFwiaW1hZ2VcIikpLm1hcCh0ID0+IHQuaXRlbSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHp4IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJJbWFnZVVwbG9hZFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW054LCBueCwgY3hdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEx4IGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoaWxkQ29tbWFuZHMgPSBbXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKC4uLnQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9nZXRGaXJzdEVuYWJsZWRDb21tYW5kKCk7XHJcbiAgICAgICAgICAgICAgICBlLmV4ZWN1dGUodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVnaXN0ZXJDaGlsZENvbW1hbmQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hpbGRDb21tYW5kcy5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgdC5vbihcImNoYW5nZTppc0VuYWJsZWRcIiwgKCkgPT4gdGhpcy5fY2hlY2tFbmFibGVkKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tFbmFibGVkKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NoZWNrRW5hYmxlZCgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gISF0aGlzLl9nZXRGaXJzdEVuYWJsZWRDb21tYW5kKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldEZpcnN0RW5hYmxlZENvbW1hbmQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY2hpbGRDb21tYW5kcy5maW5kKHQgPT4gdC5pc0VuYWJsZWQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEZ4IGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJJbmRlbnRFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiaW5kZW50XCIsIG5ldyBMeCh0KSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcIm91dGRlbnRcIiwgbmV3IEx4KHQpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgRHggPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMiAzLjc1YzAgLjQxNC4zMzYuNzUuNzUuNzVoMTQuNWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAwIDAtLjc1Ljc1em01IDZjMCAuNDE0LjMzNi43NS43NS43NWg5LjVhLjc1Ljc1IDAgMSAwIDAtMS41aC05LjVhLjc1Ljc1IDAgMCAwLS43NS43NXpNMi43NSAxNi41aDE0LjVhLjc1Ljc1IDAgMSAwIDAtMS41SDIuNzVhLjc1Ljc1IDAgMSAwIDAgMS41ek0xLjYzMiA2Ljk1TDUuMDIgOS4zNThhLjQuNCAwIDAgMS0uMDEzLjY2MWwtMy4zOSAyLjIwN0EuNC40IDAgMCAxIDEgMTEuODkyVjcuMjc1YS40LjQgMCAwIDEgLjYzMi0uMzI2elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciBqeCA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0yIDMuNzVjMCAuNDE0LjMzNi43NS43NS43NWgxNC41YS43NS43NSAwIDEgMCAwLTEuNUgyLjc1YS43NS43NSAwIDAgMC0uNzUuNzV6bTUgNmMwIC40MTQuMzM2Ljc1Ljc1Ljc1aDkuNWEuNzUuNzUgMCAxIDAgMC0xLjVoLTkuNWEuNzUuNzUgMCAwIDAtLjc1Ljc1ek0yLjc1IDE2LjVoMTQuNWEuNzUuNzUgMCAxIDAgMC0xLjVIMi43NWEuNzUuNzUgMCAxIDAgMCAxLjV6bTEuNjE4LTkuNTVMLjk4IDkuMzU4YS40LjQgMCAwIDAgLjAxMy42NjFsMy4zOSAyLjIwN0EuNC40IDAgMCAwIDUgMTEuODkyVjcuMjc1YS40LjQgMCAwIDAtLjYzMi0uMzI2elwiLz48L3N2Zz4nO1xyXG5cclxuICAgICAgICBjbGFzcyBIeCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW5kZW50VUlcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLnVpTGFuZ3VhZ2VEaXJlY3Rpb24gPT0gXCJsdHJcIiA/IER4IDogang7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS51aUxhbmd1YWdlRGlyZWN0aW9uID09IFwibHRyXCIgPyBqeCA6IER4O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmaW5lQnV0dG9uKFwiaW5kZW50XCIsIGkoXCJqZ1wiKSwgbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZpbmVCdXR0b24oXCJvdXRkZW50XCIsIGkoXCJqaFwiKSwgbylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2RlZmluZUJ1dHRvbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBuLnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKHQsIG8gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmNvbW1hbmRzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IGhiKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIHMuc2V0KHtsYWJlbDogZSwgaWNvbjogaSwgdG9vbHRpcDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHMuYmluZChcImlzT25cIiwgXCJpc0VuYWJsZWRcIikudG8ociwgXCJ2YWx1ZVwiLCBcImlzRW5hYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHMsIFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4uZXhlY3V0ZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5lZGl0aW5nLnZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBXeCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSW5kZW50XCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbRngsIEh4XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBxeCBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbmRlbnRCZWhhdmlvciA9IGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFd3KGUuZG9jdW1lbnQuc2VsZWN0aW9uLmdldFNlbGVjdGVkQmxvY2tzKCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpIHx8ICFlLnNjaGVtYS5jaGVja0F0dHJpYnV0ZShpLCBcImJsb2NrSW5kZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdGhpcy5faW5kZW50QmVoYXZpb3IuY2hlY2tFbmFibGVkKGkuZ2V0QXR0cmlidXRlKFwiYmxvY2tJbmRlbnRcIikpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gVXgodCk7XHJcbiAgICAgICAgICAgICAgICB0LmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaS5nZXRBdHRyaWJ1dGUoXCJibG9ja0luZGVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX2luZGVudEJlaGF2aW9yLmdldE5leHRJbmRlbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnNldEF0dHJpYnV0ZShcImJsb2NrSW5kZW50XCIsIG4sIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZShcImJsb2NrSW5kZW50XCIsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBVeCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuc2NoZW1hO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gQXJyYXkuZnJvbShlLmdldFNlbGVjdGVkQmxvY2tzKCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gbi5maWx0ZXIodCA9PiBpLmNoZWNrQXR0cmlidXRlKHQsIFwiYmxvY2tJbmRlbnRcIikpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyAkeCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNGb3J3YXJkID0gdC5kaXJlY3Rpb24gPT09IFwiZm9yd2FyZFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vZmZzZXQgPSB0Lm9mZnNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMudW5pdCA9IHQudW5pdFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjaGVja0VuYWJsZWQodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHBhcnNlRmxvYXQodCB8fCAwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRm9yd2FyZCB8fCBlID4gMFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXROZXh0SW5kZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBwYXJzZUZsb2F0KHQgfHwgMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gIXQgfHwgdC5lbmRzV2l0aCh0aGlzLnVuaXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNGb3J3YXJkID8gdGhpcy5vZmZzZXQgKyB0aGlzLnVuaXQgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmlzRm9yd2FyZCA/IHRoaXMub2Zmc2V0IDogLXRoaXMub2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUgKyBuO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG8gPiAwID8gbyArIHRoaXMudW5pdCA6IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBHeCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNGb3J3YXJkID0gdC5kaXJlY3Rpb24gPT09IFwiZm9yd2FyZFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGFzc2VzID0gdC5jbGFzc2VzXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNoZWNrRW5hYmxlZCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5jbGFzc2VzLmluZGV4T2YodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0ZvcndhcmQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZSA8IHRoaXMuY2xhc3Nlcy5sZW5ndGggLSAxXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlID49IDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0TmV4dEluZGVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5jbGFzc2VzLmluZGV4T2YodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5pc0ZvcndhcmQgPyAxIDogLTE7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGFzc2VzW2UgKyBpXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBLeCA9IC9eIyhbMC05YS1mXXszLDR9fFswLTlhLWZdezZ9fFswLTlhLWZdezh9KSQvaTtcclxuICAgICAgICBjb25zdCBKeCA9IC9ecmdiXFwoWyBdPyhbMC05XXsxLDN9WyAlXT8sWyBdPyl7MiwzfVswLTldezEsM31bICVdP1xcKSQvaTtcclxuICAgICAgICBjb25zdCBZeCA9IC9ecmdiYVxcKFsgXT8oWzAtOV17MSwzfVsgJV0/LFsgXT8pezN9KDF8WzAtOV0rJXxbMF0/XFwuP1swLTldKylcXCkkL2k7XHJcbiAgICAgICAgY29uc3QgUXggPSAvXmhzbFxcKFsgXT8oWzAtOV17MSwzfVsgJV0/WyxdP1sgXSopezN9KDF8WzAtOV0rJXxbMF0/XFwuP1swLTldKyk/XFwpJC9pO1xyXG4gICAgICAgIGNvbnN0IFh4ID0gL15oc2xhXFwoWyBdPyhbMC05XXsxLDN9WyAlXT8sWyBdPyl7MiwzfSgxfFswLTldKyV8WzBdP1xcLj9bMC05XSspXFwpJC9pO1xyXG4gICAgICAgIGNvbnN0IFp4ID0gbmV3IFNldChbXCJibGFja1wiLCBcInNpbHZlclwiLCBcImdyYXlcIiwgXCJ3aGl0ZVwiLCBcIm1hcm9vblwiLCBcInJlZFwiLCBcInB1cnBsZVwiLCBcImZ1Y2hzaWFcIiwgXCJncmVlblwiLCBcImxpbWVcIiwgXCJvbGl2ZVwiLCBcInllbGxvd1wiLCBcIm5hdnlcIiwgXCJibHVlXCIsIFwidGVhbFwiLCBcImFxdWFcIiwgXCJvcmFuZ2VcIiwgXCJhbGljZWJsdWVcIiwgXCJhbnRpcXVld2hpdGVcIiwgXCJhcXVhbWFyaW5lXCIsIFwiYXp1cmVcIiwgXCJiZWlnZVwiLCBcImJpc3F1ZVwiLCBcImJsYW5jaGVkYWxtb25kXCIsIFwiYmx1ZXZpb2xldFwiLCBcImJyb3duXCIsIFwiYnVybHl3b29kXCIsIFwiY2FkZXRibHVlXCIsIFwiY2hhcnRyZXVzZVwiLCBcImNob2NvbGF0ZVwiLCBcImNvcmFsXCIsIFwiY29ybmZsb3dlcmJsdWVcIiwgXCJjb3Juc2lsa1wiLCBcImNyaW1zb25cIiwgXCJjeWFuXCIsIFwiZGFya2JsdWVcIiwgXCJkYXJrY3lhblwiLCBcImRhcmtnb2xkZW5yb2RcIiwgXCJkYXJrZ3JheVwiLCBcImRhcmtncmVlblwiLCBcImRhcmtncmV5XCIsIFwiZGFya2toYWtpXCIsIFwiZGFya21hZ2VudGFcIiwgXCJkYXJrb2xpdmVncmVlblwiLCBcImRhcmtvcmFuZ2VcIiwgXCJkYXJrb3JjaGlkXCIsIFwiZGFya3JlZFwiLCBcImRhcmtzYWxtb25cIiwgXCJkYXJrc2VhZ3JlZW5cIiwgXCJkYXJrc2xhdGVibHVlXCIsIFwiZGFya3NsYXRlZ3JheVwiLCBcImRhcmtzbGF0ZWdyZXlcIiwgXCJkYXJrdHVycXVvaXNlXCIsIFwiZGFya3Zpb2xldFwiLCBcImRlZXBwaW5rXCIsIFwiZGVlcHNreWJsdWVcIiwgXCJkaW1ncmF5XCIsIFwiZGltZ3JleVwiLCBcImRvZGdlcmJsdWVcIiwgXCJmaXJlYnJpY2tcIiwgXCJmbG9yYWx3aGl0ZVwiLCBcImZvcmVzdGdyZWVuXCIsIFwiZ2FpbnNib3JvXCIsIFwiZ2hvc3R3aGl0ZVwiLCBcImdvbGRcIiwgXCJnb2xkZW5yb2RcIiwgXCJncmVlbnllbGxvd1wiLCBcImdyZXlcIiwgXCJob25leWRld1wiLCBcImhvdHBpbmtcIiwgXCJpbmRpYW5yZWRcIiwgXCJpbmRpZ29cIiwgXCJpdm9yeVwiLCBcImtoYWtpXCIsIFwibGF2ZW5kZXJcIiwgXCJsYXZlbmRlcmJsdXNoXCIsIFwibGF3bmdyZWVuXCIsIFwibGVtb25jaGlmZm9uXCIsIFwibGlnaHRibHVlXCIsIFwibGlnaHRjb3JhbFwiLCBcImxpZ2h0Y3lhblwiLCBcImxpZ2h0Z29sZGVucm9keWVsbG93XCIsIFwibGlnaHRncmF5XCIsIFwibGlnaHRncmVlblwiLCBcImxpZ2h0Z3JleVwiLCBcImxpZ2h0cGlua1wiLCBcImxpZ2h0c2FsbW9uXCIsIFwibGlnaHRzZWFncmVlblwiLCBcImxpZ2h0c2t5Ymx1ZVwiLCBcImxpZ2h0c2xhdGVncmF5XCIsIFwibGlnaHRzbGF0ZWdyZXlcIiwgXCJsaWdodHN0ZWVsYmx1ZVwiLCBcImxpZ2h0eWVsbG93XCIsIFwibGltZWdyZWVuXCIsIFwibGluZW5cIiwgXCJtYWdlbnRhXCIsIFwibWVkaXVtYXF1YW1hcmluZVwiLCBcIm1lZGl1bWJsdWVcIiwgXCJtZWRpdW1vcmNoaWRcIiwgXCJtZWRpdW1wdXJwbGVcIiwgXCJtZWRpdW1zZWFncmVlblwiLCBcIm1lZGl1bXNsYXRlYmx1ZVwiLCBcIm1lZGl1bXNwcmluZ2dyZWVuXCIsIFwibWVkaXVtdHVycXVvaXNlXCIsIFwibWVkaXVtdmlvbGV0cmVkXCIsIFwibWlkbmlnaHRibHVlXCIsIFwibWludGNyZWFtXCIsIFwibWlzdHlyb3NlXCIsIFwibW9jY2FzaW5cIiwgXCJuYXZham93aGl0ZVwiLCBcIm9sZGxhY2VcIiwgXCJvbGl2ZWRyYWJcIiwgXCJvcmFuZ2VyZWRcIiwgXCJvcmNoaWRcIiwgXCJwYWxlZ29sZGVucm9kXCIsIFwicGFsZWdyZWVuXCIsIFwicGFsZXR1cnF1b2lzZVwiLCBcInBhbGV2aW9sZXRyZWRcIiwgXCJwYXBheWF3aGlwXCIsIFwicGVhY2hwdWZmXCIsIFwicGVydVwiLCBcInBpbmtcIiwgXCJwbHVtXCIsIFwicG93ZGVyYmx1ZVwiLCBcInJvc3licm93blwiLCBcInJveWFsYmx1ZVwiLCBcInNhZGRsZWJyb3duXCIsIFwic2FsbW9uXCIsIFwic2FuZHlicm93blwiLCBcInNlYWdyZWVuXCIsIFwic2Vhc2hlbGxcIiwgXCJzaWVubmFcIiwgXCJza3libHVlXCIsIFwic2xhdGVibHVlXCIsIFwic2xhdGVncmF5XCIsIFwic2xhdGVncmV5XCIsIFwic25vd1wiLCBcInNwcmluZ2dyZWVuXCIsIFwic3RlZWxibHVlXCIsIFwidGFuXCIsIFwidGhpc3RsZVwiLCBcInRvbWF0b1wiLCBcInR1cnF1b2lzZVwiLCBcInZpb2xldFwiLCBcIndoZWF0XCIsIFwid2hpdGVzbW9rZVwiLCBcInllbGxvd2dyZWVuXCIsIFwicmViZWNjYXB1cnBsZVwiLCBcImN1cnJlbnRjb2xvclwiLCBcInRyYW5zcGFyZW50XCJdKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdEModCkge1xyXG4gICAgICAgICAgICBpZiAodC5zdGFydHNXaXRoKFwiI1wiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEt4LnRlc3QodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zdGFydHNXaXRoKFwicmdiXCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gSngudGVzdCh0KSB8fCBZeC50ZXN0KHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQuc3RhcnRzV2l0aChcImhzbFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFF4LnRlc3QodCkgfHwgWHgudGVzdCh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBaeC5oYXModC50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZUMgPSBbXCJub25lXCIsIFwiaGlkZGVuXCIsIFwiZG90dGVkXCIsIFwiZGFzaGVkXCIsIFwic29saWRcIiwgXCJkb3VibGVcIiwgXCJncm9vdmVcIiwgXCJyaWRnZVwiLCBcImluc2V0XCIsIFwib3V0c2V0XCJdO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBpQyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlQy5pbmNsdWRlcyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbkMgPSAvXihbKy1dP1swLTldKlsuXT9bMC05XSsocHh8Y218bW18aW58cGN8cHR8Y2h8ZW18ZXh8cmVtfHZofHZ3fHZtaW58dm1heCl8MCkkLztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb0ModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbkMudGVzdCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgckMgPSAvXlsrLV0/WzAtOV0qWy5dP1swLTldKyUkLztcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc0ModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gckMudGVzdCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgYUMgPSBbXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIFwicmVwZWF0XCIsIFwic3BhY2VcIiwgXCJyb3VuZFwiLCBcIm5vLXJlcGVhdFwiXTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY0ModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYUMuaW5jbHVkZXModClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGxDID0gW1wiY2VudGVyXCIsIFwidG9wXCIsIFwiYm90dG9tXCIsIFwibGVmdFwiLCBcInJpZ2h0XCJdO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBkQyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsQy5pbmNsdWRlcyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdUMgPSBbXCJmaXhlZFwiLCBcInNjcm9sbFwiLCBcImxvY2FsXCJdO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBoQyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB1Qy5pbmNsdWRlcyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgZkMgPSAvXnVybFxcKC87XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdDKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZDLnRlc3QodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1DKHQgPSBcIlwiKSB7XHJcbiAgICAgICAgICAgIGlmICh0ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge3RvcDogdW5kZWZpbmVkLCByaWdodDogdW5kZWZpbmVkLCBib3R0b206IHVuZGVmaW5lZCwgbGVmdDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBrQyh0KTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IGVbMF07XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlWzJdIHx8IGk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBlWzFdIHx8IGk7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBlWzNdIHx8IG87XHJcbiAgICAgICAgICAgIHJldHVybiB7dG9wOiBpLCBib3R0b206IG4sIHJpZ2h0OiBvLCBsZWZ0OiByfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcEModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7dG9wOiBpLCByaWdodDogbiwgYm90dG9tOiBvLCBsZWZ0OiByfSA9IGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gW107XHJcbiAgICAgICAgICAgICAgICBpZiAoIVtpLCBuLCByLCBvXS5ldmVyeSh0ID0+ICEhdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzLnB1c2goW3QgKyBcIi10b3BcIiwgaV0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMucHVzaChbdCArIFwiLXJpZ2h0XCIsIG5dKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzLnB1c2goW3QgKyBcIi1ib3R0b21cIiwgb10pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMucHVzaChbdCArIFwiLWxlZnRcIiwgcl0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzLnB1c2goW3QsIGJDKGUpXSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJDKHt0b3A6IHQsIHJpZ2h0OiBlLCBib3R0b206IGksIGxlZnQ6IG59KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcclxuICAgICAgICAgICAgaWYgKG4gIT09IGUpIHtcclxuICAgICAgICAgICAgICAgIG8ucHVzaCh0LCBlLCBpLCBuKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGkgIT09IHQpIHtcclxuICAgICAgICAgICAgICAgIG8ucHVzaCh0LCBlLCBpKVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUgIT09IHQpIHtcclxuICAgICAgICAgICAgICAgIG8ucHVzaCh0LCBlKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgby5wdXNoKHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG8uam9pbihcIiBcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHdDKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPT4gKHtwYXRoOiB0LCB2YWx1ZTogbUMoZSl9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24ga0ModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5yZXBsYWNlKC8sIC9nLCBcIixcIikuc3BsaXQoXCIgXCIpLm1hcCh0ID0+IHQucmVwbGFjZSgvLC9nLCBcIiwgXCIpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX0ModCkge1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJtYXJnaW5cIiwgd0MoXCJtYXJnaW5cIikpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJtYXJnaW4tdG9wXCIsIHQgPT4gKHtwYXRoOiBcIm1hcmdpbi50b3BcIiwgdmFsdWU6IHR9KSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcIm1hcmdpbi1yaWdodFwiLCB0ID0+ICh7cGF0aDogXCJtYXJnaW4ucmlnaHRcIiwgdmFsdWU6IHR9KSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcIm1hcmdpbi1ib3R0b21cIiwgdCA9PiAoe3BhdGg6IFwibWFyZ2luLmJvdHRvbVwiLCB2YWx1ZTogdH0pKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwibWFyZ2luLWxlZnRcIiwgdCA9PiAoe3BhdGg6IFwibWFyZ2luLmxlZnRcIiwgdmFsdWU6IHR9KSk7XHJcbiAgICAgICAgICAgIHQuc2V0UmVkdWNlcihcIm1hcmdpblwiLCBwQyhcIm1hcmdpblwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0U3R5bGVSZWxhdGlvbihcIm1hcmdpblwiLCBbXCJtYXJnaW4tdG9wXCIsIFwibWFyZ2luLXJpZ2h0XCIsIFwibWFyZ2luLWJvdHRvbVwiLCBcIm1hcmdpbi1sZWZ0XCJdKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdkMgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdC5jb25maWcuZGVmaW5lKFwiaW5kZW50QmxvY2tcIiwge29mZnNldDogNDAsIHVuaXQ6IFwicHhcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkluZGVudEJsb2NrXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNvbmZpZy5nZXQoXCJpbmRlbnRCbG9ja1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSAhZS5jbGFzc2VzIHx8ICFlLmNsYXNzZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IE9iamVjdC5hc3NpZ24oe2RpcmVjdGlvbjogXCJmb3J3YXJkXCJ9LCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBPYmplY3QuYXNzaWduKHtkaXJlY3Rpb246IFwiYmFja3dhcmRcIn0sIGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmRhdGEuYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyhfQyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0dXBDb252ZXJzaW9uVXNpbmdPZmZzZXQodC5jb252ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImluZGVudEJsb2NrXCIsIG5ldyBxeCh0LCBuZXcgJHgobikpKTtcclxuICAgICAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcIm91dGRlbnRCbG9ja1wiLCBuZXcgcXgodCwgbmV3ICR4KG8pKSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0dXBDb252ZXJzaW9uVXNpbmdDbGFzc2VzKGUuY2xhc3Nlcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJpbmRlbnRCbG9ja1wiLCBuZXcgcXgodCwgbmV3IEd4KG4pKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJvdXRkZW50QmxvY2tcIiwgbmV3IHF4KHQsIG5ldyBHeChvKSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFmdGVySW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmNvbW1hbmRzLmdldChcImluZGVudFwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChcIm91dGRlbnRcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gW1wicGFyYWdyYXBoXCIsIFwiaGVhZGluZzFcIiwgXCJoZWFkaW5nMlwiLCBcImhlYWRpbmczXCIsIFwiaGVhZGluZzRcIiwgXCJoZWFkaW5nNVwiLCBcImhlYWRpbmc2XCJdO1xyXG4gICAgICAgICAgICAgICAgby5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlLmlzUmVnaXN0ZXJlZCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmV4dGVuZCh0LCB7YWxsb3dBdHRyaWJ1dGVzOiBcImJsb2NrSW5kZW50XCJ9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaS5yZWdpc3RlckNoaWxkQ29tbWFuZCh0LmNvbW1hbmRzLmdldChcImluZGVudEJsb2NrXCIpKTtcclxuICAgICAgICAgICAgICAgIG4ucmVnaXN0ZXJDaGlsZENvbW1hbmQodC5jb21tYW5kcy5nZXQoXCJvdXRkZW50QmxvY2tcIikpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXR1cENvbnZlcnNpb25Vc2luZ09mZnNldCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5jb252ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLmxvY2FsZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmNvbnRlbnRMYW5ndWFnZURpcmVjdGlvbiA9PT0gXCJydGxcIiA/IFwibWFyZ2luLXJpZ2h0XCIgOiBcIm1hcmdpbi1sZWZ0XCI7XHJcbiAgICAgICAgICAgICAgICB0LmZvcihcInVwY2FzdFwiKS5hdHRyaWJ1dGVUb0F0dHJpYnV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzoge3N0eWxlczoge1tpXTogL1tcXHNcXFNdKy99fSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2tleTogXCJibG9ja0luZGVudFwiLCB2YWx1ZTogdCA9PiB0LmdldFN0eWxlKGkpfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LmZvcihcImRvd25jYXN0XCIpLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogXCJibG9ja0luZGVudFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHQgPT4gKHtrZXk6IFwic3R5bGVcIiwgdmFsdWU6IHtbaV06IHR9fSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXR1cENvbnZlcnNpb25Vc2luZ0NsYXNzZXModCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHttb2RlbDoge2tleTogXCJibG9ja0luZGVudFwiLCB2YWx1ZXM6IFtdfSwgdmlldzoge319O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm1vZGVsLnZhbHVlcy5wdXNoKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUudmlld1tpXSA9IHtrZXk6IFwiY2xhc3NcIiwgdmFsdWU6IFtpXX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmNvbnZlcnNpb24uYXR0cmlidXRlVG9BdHRyaWJ1dGUoZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgeUMgPSBcIml0YWxpY1wiO1xyXG5cclxuICAgICAgICBjbGFzcyB4QyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiSXRhbGljRWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5leHRlbmQoXCIkdGV4dFwiLCB7YWxsb3dBdHRyaWJ1dGVzOiB5Q30pO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEuc2V0QXR0cmlidXRlUHJvcGVydGllcyh5Qywge2lzRm9ybWF0dGluZzogdHJ1ZSwgY29weU9uRW50ZXI6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5hdHRyaWJ1dGVUb0VsZW1lbnQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiB5QyxcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiBcImlcIixcclxuICAgICAgICAgICAgICAgICAgICB1cGNhc3RBbHNvOiBbXCJlbVwiLCB7c3R5bGVzOiB7XCJmb250LXN0eWxlXCI6IFwiaXRhbGljXCJ9fV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoeUMsIG5ldyB5ayh0LCB5QykpO1xyXG4gICAgICAgICAgICAgICAgdC5rZXlzdHJva2VzLnNldChcIkNUUkwrSVwiLCB5QylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIENDID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTkuNTg2IDE0LjYzM2wuMDIxLjAwNGMtLjAzNi4zMzUuMDk1LjY1NS4zOTMuOTYyLjA4Mi4wODMuMTczLjE1LjI3NC4yMDFoMS40NzRhLjYuNiAwIDEgMSAwIDEuMkg1LjMwNGEuNi42IDAgMCAxIDAtMS4yaDEuMTVjLjQ3NC0uMDcuODA5LS4xODIgMS4wMDUtLjMzNC4xNTctLjEyMi4yOTEtLjMyLjQwNC0uNTk3bDIuNDE2LTkuNTVhMS4wNTMgMS4wNTMgMCAwIDAtLjI4MS0uODIzIDEuMTIgMS4xMiAwIDAgMC0uNDQyLS4yOTZIOC4xNWEuNi42IDAgMCAxIDAtMS4yaDYuNDQzYS42LjYgMCAxIDEgMCAxLjJoLTEuMTk1Yy0uMzc2LjA1Ni0uNjUuMTU1LS44MjMuMjk2LS4yMTUuMTc1LS40MjMuNDM5LS42MjMuNzlsLTIuMzY2IDkuMzQ3elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIGNvbnN0IEFDID0gXCJpdGFsaWNcIjtcclxuXHJcbiAgICAgICAgY2xhc3MgVEMgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgdC51aS5jb21wb25lbnRGYWN0b3J5LmFkZChBQywgaSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuY29tbWFuZHMuZ2V0KEFDKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IGhiKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uc2V0KHtsYWJlbDogZShcImpqXCIpLCBpY29uOiBDQywga2V5c3Ryb2tlOiBcIkNUUkwrSVwiLCB0b29sdGlwOiB0cnVlLCBpc1RvZ2dsZWFibGU6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc09uXCIsIFwiaXNFbmFibGVkXCIpLnRvKG4sIFwidmFsdWVcIiwgXCJpc0VuYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhvLCBcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoQUMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFBDIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt4QywgVENdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkl0YWxpY1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFNDKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkuY3JlYXRlUmFuZ2UoRUModCwgZSwgdHJ1ZSwgaSksIEVDKHQsIGUsIGZhbHNlLCBpKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEVDKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgbGV0IG8gPSB0LnRleHROb2RlIHx8IChpID8gdC5ub2RlQmVmb3JlIDogdC5ub2RlQWZ0ZXIpO1xyXG4gICAgICAgICAgICBsZXQgciA9IG51bGw7XHJcbiAgICAgICAgICAgIHdoaWxlIChvICYmIG8uZ2V0QXR0cmlidXRlKFwibGlua0hyZWZcIikgPT0gZSkge1xyXG4gICAgICAgICAgICAgICAgciA9IG87XHJcbiAgICAgICAgICAgICAgICBvID0gaSA/IG8ucHJldmlvdXNTaWJsaW5nIDogby5uZXh0U2libGluZ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByID8gbi5jcmVhdGVQb3NpdGlvbkF0KHIsIGkgPyBcImJlZm9yZVwiIDogXCJhZnRlclwiKSA6IHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFJDIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFudWFsRGVjb3JhdG9ycyA9IG5ldyB5c1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXN0b3JlTWFudWFsRGVjb3JhdG9yU3RhdGVzKCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMubWFudWFsRGVjb3JhdG9ycykge1xyXG4gICAgICAgICAgICAgICAgICAgIHQudmFsdWUgPSB0aGlzLl9nZXREZWNvcmF0b3JTdGF0ZUZyb21Nb2RlbCh0LmlkKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gZS5zZWxlY3Rpb24uZ2V0QXR0cmlidXRlKFwibGlua0hyZWZcIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5tYW51YWxEZWNvcmF0b3JzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC52YWx1ZSA9IHRoaXMuX2dldERlY29yYXRvclN0YXRlRnJvbU1vZGVsKHQuaWQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IHQuc2NoZW1hLmNoZWNrQXR0cmlidXRlSW5TZWxlY3Rpb24oZS5zZWxlY3Rpb24sIFwibGlua0hyZWZcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBpbiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVbdF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgci5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5jaGFuZ2UoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4uaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG4uZ2V0Rmlyc3RQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5oYXNBdHRyaWJ1dGUoXCJsaW5rSHJlZlwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IFNDKHMsIG4uZ2V0QXR0cmlidXRlKFwibGlua0hyZWZcIiksIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJsaW5rSHJlZlwiLCB0LCBhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnNldEF0dHJpYnV0ZSh0LCB0cnVlLCBhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmZvckVhY2godCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5yZW1vdmVBdHRyaWJ1dGUodCwgYSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRTZWxlY3Rpb24oYSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0ICE9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gSHMobi5nZXRBdHRyaWJ1dGVzKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5zZXQoXCJsaW5rSHJlZlwiLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnNldCh0LCB0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gZS5jcmVhdGVUZXh0KHQsIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5pbnNlcnRDb250ZW50KGEsIHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRTZWxlY3Rpb24oZS5jcmVhdGVSYW5nZU9uKGEpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IGkuc2NoZW1hLmdldFZhbGlkUmFuZ2VzKG4uZ2V0UmFuZ2VzKCksIFwibGlua0hyZWZcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnNldEF0dHJpYnV0ZShcImxpbmtIcmVmXCIsIHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKHQsIHRydWUsIGkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnJlbW92ZUF0dHJpYnV0ZSh0LCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXREZWNvcmF0b3JTdGF0ZUZyb21Nb2RlbCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5zZWxlY3Rpb24uZ2V0QXR0cmlidXRlKHQpIHx8IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIE9DIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24uaGFzQXR0cmlidXRlKFwibGlua0hyZWZcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChcImxpbmtcIik7XHJcbiAgICAgICAgICAgICAgICBlLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5pc0NvbGxhcHNlZCA/IFtTQyhpLmdldEZpcnN0UG9zaXRpb24oKSwgaS5nZXRBdHRyaWJ1dGUoXCJsaW5rSHJlZlwiKSwgZSldIDogaS5nZXRSYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUF0dHJpYnV0ZShcImxpbmtIcmVmXCIsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIG4ubWFudWFsRGVjb3JhdG9ycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKGkuaWQsIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBJQyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIHZhciBuID0gdC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGkgPSBpID09PSB1bmRlZmluZWQgPyBuIDogaTtcclxuICAgICAgICAgICAgcmV0dXJuICFlICYmIGkgPj0gbiA/IHQgOiBPYSh0LCBlLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFZDID0gSUM7XHJcbiAgICAgICAgdmFyIE5DID0gXCJcXFxcdWQ4MDAtXFxcXHVkZmZmXCIsIE1DID0gXCJcXFxcdTAzMDAtXFxcXHUwMzZmXCIsIEJDID0gXCJcXFxcdWZlMjAtXFxcXHVmZTJmXCIsIHpDID0gXCJcXFxcdTIwZDAtXFxcXHUyMGZmXCIsXHJcbiAgICAgICAgICAgIExDID0gTUMgKyBCQyArIHpDLCBGQyA9IFwiXFxcXHVmZTBlXFxcXHVmZTBmXCI7XHJcbiAgICAgICAgdmFyIERDID0gXCJcXFxcdTIwMGRcIjtcclxuICAgICAgICB2YXIgakMgPSBSZWdFeHAoXCJbXCIgKyBEQyArIE5DICsgTEMgKyBGQyArIFwiXVwiKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSEModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gakMudGVzdCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFdDID0gSEM7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHFDKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuc3BsaXQoXCJcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBVQyA9IHFDO1xyXG4gICAgICAgIHZhciAkQyA9IFwiXFxcXHVkODAwLVxcXFx1ZGZmZlwiLCBHQyA9IFwiXFxcXHUwMzAwLVxcXFx1MDM2ZlwiLCBLQyA9IFwiXFxcXHVmZTIwLVxcXFx1ZmUyZlwiLCBKQyA9IFwiXFxcXHUyMGQwLVxcXFx1MjBmZlwiLFxyXG4gICAgICAgICAgICBZQyA9IEdDICsgS0MgKyBKQywgUUMgPSBcIlxcXFx1ZmUwZVxcXFx1ZmUwZlwiO1xyXG4gICAgICAgIHZhciBYQyA9IFwiW1wiICsgJEMgKyBcIl1cIiwgWkMgPSBcIltcIiArIFlDICsgXCJdXCIsIHRBID0gXCJcXFxcdWQ4M2NbXFxcXHVkZmZiLVxcXFx1ZGZmZl1cIiwgZUEgPSBcIig/OlwiICsgWkMgKyBcInxcIiArIHRBICsgXCIpXCIsXHJcbiAgICAgICAgICAgIGlBID0gXCJbXlwiICsgJEMgKyBcIl1cIiwgbkEgPSBcIig/OlxcXFx1ZDgzY1tcXFxcdWRkZTYtXFxcXHVkZGZmXSl7Mn1cIiwgb0EgPSBcIltcXFxcdWQ4MDAtXFxcXHVkYmZmXVtcXFxcdWRjMDAtXFxcXHVkZmZmXVwiLFxyXG4gICAgICAgICAgICByQSA9IFwiXFxcXHUyMDBkXCI7XHJcbiAgICAgICAgdmFyIHNBID0gZUEgKyBcIj9cIiwgYUEgPSBcIltcIiArIFFDICsgXCJdP1wiLFxyXG4gICAgICAgICAgICBjQSA9IFwiKD86XCIgKyByQSArIFwiKD86XCIgKyBbaUEsIG5BLCBvQV0uam9pbihcInxcIikgKyBcIilcIiArIGFBICsgc0EgKyBcIikqXCIsIGxBID0gYUEgKyBzQSArIGNBLFxyXG4gICAgICAgICAgICBkQSA9IFwiKD86XCIgKyBbaUEgKyBaQyArIFwiP1wiLCBaQywgbkEsIG9BLCBYQ10uam9pbihcInxcIikgKyBcIilcIjtcclxuICAgICAgICB2YXIgdUEgPSBSZWdFeHAodEEgKyBcIig/PVwiICsgdEEgKyBcIil8XCIgKyBkQSArIGxBLCBcImdcIik7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhBKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQubWF0Y2godUEpIHx8IFtdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZkEgPSBoQTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ0EodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gV0ModCkgPyBmQSh0KSA6IFVDKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbUEgPSBnQTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcEEodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgIGUgPSBfYShlKTtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gV0MoZSkgPyBtQShlKSA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gaSA/IGlbMF0gOiBlLmNoYXJBdCgwKTtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gaSA/IFZDKGksIDEpLmpvaW4oXCJcIikgOiBlLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5bdF0oKSArIG9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGJBID0gcEE7XHJcbiAgICAgICAgdmFyIHdBID0gYkEoXCJ0b1VwcGVyQ2FzZVwiKTtcclxuICAgICAgICB2YXIga0EgPSB3QTtcclxuICAgICAgICBjb25zdCBfQSA9IC9bXFx1MDAwMC1cXHUwMDIwXFx1MDBBMFxcdTE2ODBcXHUxODBFXFx1MjAwMC1cXHUyMDI5XFx1MjA1ZlxcdTMwMDBdL2c7XHJcbiAgICAgICAgY29uc3QgdkEgPSAvXig/Oig/Omh0dHBzP3xmdHBzP3xtYWlsdG8pOnxbXmEtel18W2EteisuLV0rKD86W15hLXorLjotXXwkKSkvaTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24geUEodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5pcyhcImF0dHJpYnV0ZUVsZW1lbnRcIikgJiYgISF0LmdldEN1c3RvbVByb3BlcnR5KFwibGlua1wiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24geEEodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZS5jcmVhdGVBdHRyaWJ1dGVFbGVtZW50KFwiYVwiLCB7aHJlZjogdH0sIHtwcmlvcml0eTogNX0pO1xyXG4gICAgICAgICAgICBlLnNldEN1c3RvbVByb3BlcnR5KFwibGlua1wiLCB0cnVlLCBpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIENBKHQpIHtcclxuICAgICAgICAgICAgdCA9IFN0cmluZyh0KTtcclxuICAgICAgICAgICAgcmV0dXJuIEFBKHQpID8gdCA6IFwiI1wiXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBBQSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnJlcGxhY2UoX0EsIFwiXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gZS5tYXRjaCh2QSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFRBKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHtcIk9wZW4gaW4gYSBuZXcgdGFiXCI6IHQoXCJtbVwiKSwgRG93bmxvYWRhYmxlOiB0KFwibW5cIil9O1xyXG4gICAgICAgICAgICBlLmZvckVhY2godCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5sYWJlbCAmJiBpW3QubGFiZWxdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5sYWJlbCA9IGlbdC5sYWJlbF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUEEodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpLCBuXSBvZiBPYmplY3QuZW50cmllcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBPYmplY3QuYXNzaWduKHt9LCBuLCB7aWQ6IGBsaW5rJHtrQShpKX1gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFNBIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZpbml0aW9ucyA9IG5ldyBTZXRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGxlbmd0aCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZWZpbml0aW9ucy5zaXplXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZm9yRWFjaCh0ID0+IHRoaXMuX2RlZmluaXRpb25zLmFkZCh0KSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVmaW5pdGlvbnMuYWRkKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldERpc3BhdGNoZXIoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbihcImF0dHJpYnV0ZTpsaW5rSHJlZlwiLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWkuY29uc3VtYWJsZS50ZXN0KGUuaXRlbSwgXCJhdHRyaWJ1dGU6bGlua0hyZWZcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLndyaXRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG4uZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5fZGVmaW5pdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmNyZWF0ZUF0dHJpYnV0ZUVsZW1lbnQoXCJhXCIsIHQuYXR0cmlidXRlcywge3ByaW9yaXR5OiA1fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldEN1c3RvbVByb3BlcnR5KFwibGlua1wiLCB0cnVlLCByKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmNhbGxiYWNrKGUuYXR0cmlidXRlTmV3VmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuaXRlbS5pcyhcInNlbGVjdGlvblwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLndyYXAoby5nZXRGaXJzdFJhbmdlKCksIHIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi53cmFwKGkubWFwcGVyLnRvVmlld1JhbmdlKGUucmFuZ2UpLCByKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi51bndyYXAoaS5tYXBwZXIudG9WaWV3UmFuZ2UoZS5yYW5nZSksIHIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaFwifSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgRUEge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih7aWQ6IHQsIGxhYmVsOiBlLCBhdHRyaWJ1dGVzOiBpfSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pZCA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInZhbHVlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYWJlbCA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZzKEVBLCBKYyk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFJBKHt2aWV3OiB0LCBtb2RlbDogZSwgZW1pdHRlcjogaSwgYXR0cmlidXRlOiBuLCBsb2NhbGU6IG99KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgT0EoZSwgaSwgbik7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgaS5saXN0ZW5Ubyh0LmRvY3VtZW50LCBcImtleWRvd25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghcy5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUuc2hpZnRLZXkgfHwgZS5hbHRLZXkgfHwgZS5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5rZXlDb2RlID09IE5sLmFycm93cmlnaHQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5rZXlDb2RlID09IE5sLmFycm93bGVmdDtcclxuICAgICAgICAgICAgICAgIGlmICghaSAmJiAhbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IHMuZ2V0Rmlyc3RQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IG8uY29udGVudExhbmd1YWdlRGlyZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgbGV0IGw7XHJcbiAgICAgICAgICAgICAgICBpZiAoYyA9PT0gXCJsdHJcIiAmJiBpIHx8IGMgPT09IFwicnRsXCIgJiYgbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGwgPSByLmhhbmRsZUZvcndhcmRNb3ZlbWVudChhLCBlKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsID0gci5oYW5kbGVCYWNrd2FyZE1vdmVtZW50KGEsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIHtwcmlvcml0eTogb3MuZ2V0KFwiaGlnaFwiKSArIDF9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgT0Ege1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlID0gaTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGVsU2VsZWN0aW9uID0gdC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vdmVycmlkZVVpZCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc05leHRHcmF2aXR5UmVzdG9yYXRpb25Ta2lwcGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBlLmxpc3RlblRvKHRoaXMuX21vZGVsU2VsZWN0aW9uLCBcImNoYW5nZTpyYW5nZVwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc05leHRHcmF2aXR5UmVzdG9yYXRpb25Ta2lwcGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzTmV4dEdyYXZpdHlSZXN0b3JhdGlvblNraXBwZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNHcmF2aXR5T3ZlcnJpZGRlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmRpcmVjdENoYW5nZSAmJiBJQSh0aGlzLl9tb2RlbFNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCksIGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXN0b3JlR3Jhdml0eSgpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYW5kbGVGb3J3YXJkTW92ZW1lbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuYXR0cmlidXRlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzR3Jhdml0eU92ZXJyaWRkZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0LmlzQXRTdGFydCAmJiB0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChNQSh0LCBpKSAmJiB0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcmV2ZW50Q2FyZXRNb3ZlbWVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVTZWxlY3Rpb25BdHRyaWJ1dGUoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKFZBKHQsIGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3ZlcnJpZGVHcmF2aXR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChOQSh0LCBpKSAmJiB0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcmV2ZW50Q2FyZXRNb3ZlbWVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vdmVycmlkZUdyYXZpdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBoYW5kbGVCYWNrd2FyZE1vdmVtZW50KHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmF0dHJpYnV0ZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0dyYXZpdHlPdmVycmlkZGVuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1BKHQsIGkpICYmIHRoaXMuX2hhc1NlbGVjdGlvbkF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcmV2ZW50Q2FyZXRNb3ZlbWVudChlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzdG9yZUdyYXZpdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3RvcmVHcmF2aXR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0LmlzQXRTdGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1BKHQsIGkpICYmICF0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFNlbGVjdGlvbkF0dHJpYnV0ZUZyb21UaGVOb2RlQmVmb3JlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5pc0F0RW5kICYmIE5BKHQsIGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCQSh0LCBpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NraXBOZXh0QXV0b21hdGljR3Jhdml0eVJlc3RvcmF0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3ZlcnJpZGVHcmF2aXR5KClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRTZWxlY3Rpb25BdHRyaWJ1dGVGcm9tVGhlTm9kZUJlZm9yZSh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXNBdFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNTZWxlY3Rpb25BdHRyaWJ1dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJldmVudENhcmV0TW92ZW1lbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoQkEodCwgaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2tpcE5leHRBdXRvbWF0aWNHcmF2aXR5UmVzdG9yYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3ZlcnJpZGVHcmF2aXR5KClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfaXNHcmF2aXR5T3ZlcnJpZGRlbigpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIXRoaXMuX292ZXJyaWRlVWlkXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfaGFzU2VsZWN0aW9uQXR0cmlidXRlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vZGVsU2VsZWN0aW9uLmhhc0F0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX292ZXJyaWRlR3Jhdml0eSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX292ZXJyaWRlVWlkID0gdGhpcy5tb2RlbC5jaGFuZ2UodCA9PiB0Lm92ZXJyaWRlU2VsZWN0aW9uR3Jhdml0eSgpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVzdG9yZUdyYXZpdHkoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJlc3RvcmVTZWxlY3Rpb25HcmF2aXR5KHRoaXMuX292ZXJyaWRlVWlkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vdmVycmlkZVVpZCA9IG51bGxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9wcmV2ZW50Q2FyZXRNb3ZlbWVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICB0LnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZSgpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKHRoaXMuYXR0cmlidXRlKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldFNlbGVjdGlvbkF0dHJpYnV0ZUZyb21UaGVOb2RlQmVmb3JlKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmF0dHJpYnV0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuY2hhbmdlKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc2V0U2VsZWN0aW9uQXR0cmlidXRlKHRoaXMuYXR0cmlidXRlLCB0Lm5vZGVCZWZvcmUuZ2V0QXR0cmlidXRlKGUpKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NraXBOZXh0QXV0b21hdGljR3Jhdml0eVJlc3RvcmF0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXNOZXh0R3Jhdml0eVJlc3RvcmF0aW9uU2tpcHBlZCA9IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSUEodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gVkEodCwgZSkgfHwgTkEodCwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFZBKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3Qge25vZGVCZWZvcmU6IGksIG5vZGVBZnRlcjogbn0gPSB0O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaSA/IGkuaGFzQXR0cmlidXRlKGUpIDogZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuID8gbi5oYXNBdHRyaWJ1dGUoZSkgOiBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIHIgJiYgKCFvIHx8IGkuZ2V0QXR0cmlidXRlKGUpICE9PSBuLmdldEF0dHJpYnV0ZShlKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5BKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3Qge25vZGVCZWZvcmU6IGksIG5vZGVBZnRlcjogbn0gPSB0O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaSA/IGkuaGFzQXR0cmlidXRlKGUpIDogZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuID8gbi5oYXNBdHRyaWJ1dGUoZSkgOiBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIG8gJiYgKCFyIHx8IGkuZ2V0QXR0cmlidXRlKGUpICE9PSBuLmdldEF0dHJpYnV0ZShlKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE1BKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3Qge25vZGVCZWZvcmU6IGksIG5vZGVBZnRlcjogbn0gPSB0O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaSA/IGkuaGFzQXR0cmlidXRlKGUpIDogZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuID8gbi5oYXNBdHRyaWJ1dGUoZSkgOiBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKCFyIHx8ICFvKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbi5nZXRBdHRyaWJ1dGUoZSkgIT09IGkuZ2V0QXR0cmlidXRlKGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCQSh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBJQSh0LmdldFNoaWZ0ZWRCeSgtMSksIGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgekEgPSBpKDgwKTtcclxuICAgICAgICBjb25zdCBMQSA9IFwiY2stbGlua19zZWxlY3RlZFwiO1xyXG4gICAgICAgIGNvbnN0IEZBID0gXCJhdXRvbWF0aWNcIjtcclxuICAgICAgICBjb25zdCBEQSA9IFwibWFudWFsXCI7XHJcbiAgICAgICAgY29uc3QgakEgPSAvXihodHRwcz86KT9cXC9cXC8vO1xyXG5cclxuICAgICAgICBjbGFzcyBIQSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiTGlua0VkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHQuY29uZmlnLmRlZmluZShcImxpbmtcIiwge2FkZFRhcmdldFRvRXh0ZXJuYWxMaW5rczogZmFsc2V9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEuZXh0ZW5kKFwiJHRleHRcIiwge2FsbG93QXR0cmlidXRlczogXCJsaW5rSHJlZlwifSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uZm9yKFwiZGF0YURvd25jYXN0XCIpLmF0dHJpYnV0ZVRvRWxlbWVudCh7bW9kZWw6IFwibGlua0hyZWZcIiwgdmlldzogeEF9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5mb3IoXCJlZGl0aW5nRG93bmNhc3RcIikuYXR0cmlidXRlVG9FbGVtZW50KHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogXCJsaW5rSHJlZlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6ICh0LCBlKSA9PiB4QShDQSh0KSwgZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcInVwY2FzdFwiKS5lbGVtZW50VG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHtuYW1lOiBcImFcIiwgYXR0cmlidXRlczoge2hyZWY6IHRydWV9fSxcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2tleTogXCJsaW5rSHJlZlwiLCB2YWx1ZTogdCA9PiB0LmdldEF0dHJpYnV0ZShcImhyZWZcIil9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwibGlua1wiLCBuZXcgUkModCkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJ1bmxpbmtcIiwgbmV3IE9DKHQpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBUQSh0LnQsIFBBKHQuY29uZmlnLmdldChcImxpbmsuZGVjb3JhdG9yc1wiKSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlQXV0b21hdGljRGVjb3JhdG9ycyhpLmZpbHRlcih0ID0+IHQubW9kZSA9PT0gRkEpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZU1hbnVhbERlY29yYXRvcnMoaS5maWx0ZXIodCA9PiB0Lm1vZGUgPT09IERBKSk7XHJcbiAgICAgICAgICAgICAgICBSQSh7dmlldzogdC5lZGl0aW5nLnZpZXcsIG1vZGVsOiB0Lm1vZGVsLCBlbWl0dGVyOiB0aGlzLCBhdHRyaWJ1dGU6IFwibGlua0hyZWZcIiwgbG9jYWxlOiBlfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZXR1cExpbmtIaWdobGlnaHQoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZW5hYmxlQXV0b21hdGljRGVjb3JhdG9ycyh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IFNBO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuY29uZmlnLmdldChcImxpbmsuYWRkVGFyZ2V0VG9FeHRlcm5hbExpbmtzXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5hZGQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogXCJsaW5rSXNFeHRlcm5hbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBGQSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IHQgPT4gakEudGVzdCh0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge3RhcmdldDogXCJfYmxhbmtcIiwgcmVsOiBcIm5vb3BlbmVyIG5vcmVmZXJyZXJcIn1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5hZGQodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmNvbnZlcnNpb24uZm9yKFwiZG93bmNhc3RcIikuYWRkKGkuZ2V0RGlzcGF0Y2hlcigpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZW5hYmxlTWFudWFsRGVjb3JhdG9ycyh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5jb21tYW5kcy5nZXQoXCJsaW5rXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkubWFudWFsRGVjb3JhdG9ycztcclxuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLm1vZGVsLnNjaGVtYS5leHRlbmQoXCIkdGV4dFwiLCB7YWxsb3dBdHRyaWJ1dGVzOiB0LmlkfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5hZGQobmV3IEVBKHQpKTtcclxuICAgICAgICAgICAgICAgICAgICBlLmNvbnZlcnNpb24uZm9yKFwiZG93bmNhc3RcIikuYXR0cmlidXRlVG9FbGVtZW50KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHQuaWQsIHZpZXc6IChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuLmdldCh0LmlkKS5hdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLmNyZWF0ZUF0dHJpYnV0ZUVsZW1lbnQoXCJhXCIsIGUsIHtwcmlvcml0eTogNX0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0Q3VzdG9tUHJvcGVydHkoXCJsaW5rXCIsIHRydWUsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLmNvbnZlcnNpb24uZm9yKFwidXBjYXN0XCIpLmVsZW1lbnRUb0F0dHJpYnV0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiYVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogbi5nZXQodC5pZCkuYXR0cmlidXRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBtb2RlbDoge2tleTogdC5pZH1cclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3NldHVwTGlua0hpZ2hsaWdodCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgU2V0O1xyXG4gICAgICAgICAgICAgICAgZS5kb2N1bWVudC5yZWdpc3RlclBvc3RGaXhlcihlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG8gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5oYXNBdHRyaWJ1dGUoXCJsaW5rSHJlZlwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gU0Mobi5nZXRGaXJzdFBvc2l0aW9uKCksIG4uZ2V0QXR0cmlidXRlKFwibGlua0hyZWZcIiksIHQubW9kZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gdC5lZGl0aW5nLm1hcHBlci50b1ZpZXdSYW5nZShyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMuZ2V0SXRlbXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuaXMoXCJhXCIpICYmICF0Lmhhc0NsYXNzKExBKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuYWRkQ2xhc3MoTEEsIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcImVkaXRpbmdEb3duY2FzdFwiKS5hZGQodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbihcImluc2VydFwiLCBuLCB7cHJpb3JpdHk6IFwiaGlnaGVzdFwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbihcInJlbW92ZVwiLCBuLCB7cHJpb3JpdHk6IFwiaGlnaGVzdFwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbihcImF0dHJpYnV0ZVwiLCBuLCB7cHJpb3JpdHk6IFwiaGlnaGVzdFwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbihcInNlbGVjdGlvblwiLCBuLCB7cHJpb3JpdHk6IFwiaGlnaGVzdFwifSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIG4oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkudmFsdWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZUNsYXNzKExBLCBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLmRlbGV0ZShlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFdBIGV4dGVuZHMgSnUge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRUeXBlID0gXCJjbGlja1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9uRG9tRXZlbnQodCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5maXJlKHQudHlwZSwgdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHFBID0gaSg4Mik7XHJcblxyXG4gICAgICAgIGNsYXNzIFVBIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlID0gW10pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyID0gbmV3IGZiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5rZXlzdHJva2VzID0gbmV3IGRwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy51cmxJbnB1dFZpZXcgPSB0aGlzLl9jcmVhdGVVcmxJbnB1dCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlQnV0dG9uVmlldyA9IHRoaXMuX2NyZWF0ZUJ1dHRvbihpKFwibG9cIiksIFh2LCBcImNrLWJ1dHRvbi1zYXZlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlQnV0dG9uVmlldy50eXBlID0gXCJzdWJtaXRcIjtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsQnV0dG9uVmlldyA9IHRoaXMuX2NyZWF0ZUJ1dHRvbihpKFwibHBcIiksIFp2LCBcImNrLWJ1dHRvbi1jYW5jZWxcIiwgXCJjYW5jZWxcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tYW51YWxEZWNvcmF0b3JTd2l0Y2hlcyA9IHRoaXMuX2NyZWF0ZU1hbnVhbERlY29yYXRvclN3aXRjaGVzKGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuX2NyZWF0ZUZvcm1DaGlsZHJlbihlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzYWJsZXMgPSBuZXcgYnA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c0N5Y2xlciA9IG5ldyB5Yih7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlczogdGhpcy5fZm9jdXNhYmxlcyxcclxuICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrZXI6IHRoaXMuZm9jdXNUcmFja2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGtleXN0cm9rZUhhbmRsZXI6IHRoaXMua2V5c3Ryb2tlcyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiB7Zm9jdXNQcmV2aW91czogXCJzaGlmdCArIHRhYlwiLCBmb2N1c05leHQ6IFwidGFiXCJ9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBbXCJja1wiLCBcImNrLWxpbmstZm9ybVwiXTtcclxuICAgICAgICAgICAgICAgIGlmIChlLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4ucHVzaChcImNrLWxpbmstZm9ybV9sYXlvdXQtdmVydGljYWxcIilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe3RhZzogXCJmb3JtXCIsIGF0dHJpYnV0ZXM6IHtjbGFzczogbiwgdGFiaW5kZXg6IFwiLTFcIn0sIGNoaWxkcmVuOiB0aGlzLmNoaWxkcmVufSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0RGVjb3JhdG9yU3dpdGNoZXNTdGF0ZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuX21hbnVhbERlY29yYXRvclN3aXRjaGVzKS5yZWR1Y2UoKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0W2UubmFtZV0gPSBlLmlzT247XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgICAgIH0sIHt9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlci5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIFF2KHt2aWV3OiB0aGlzfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gW3RoaXMudXJsSW5wdXRWaWV3LCAuLi50aGlzLl9tYW51YWxEZWNvcmF0b3JTd2l0Y2hlcywgdGhpcy5zYXZlQnV0dG9uVmlldywgdGhpcy5jYW5jZWxCdXR0b25WaWV3XTtcclxuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c2FibGVzLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodC5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyLmZvY3VzRmlyc3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlVXJsSW5wdXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5sb2NhbGUudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgS3YodGhpcy5sb2NhbGUsIFl2KTtcclxuICAgICAgICAgICAgICAgIGUubGFiZWwgPSB0KFwibHFcIik7XHJcbiAgICAgICAgICAgICAgICBlLmlucHV0Vmlldy5wbGFjZWhvbGRlciA9IFwiaHR0cHM6Ly9leGFtcGxlLmNvbVwiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUJ1dHRvbih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IGhiKHRoaXMubG9jYWxlKTtcclxuICAgICAgICAgICAgICAgIG8uc2V0KHtsYWJlbDogdCwgaWNvbjogZSwgdG9vbHRpcDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgby5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge2NsYXNzOiBpfX0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBvLmRlbGVnYXRlKFwiZXhlY3V0ZVwiKS50byh0aGlzLCBuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZU1hbnVhbERlY29yYXRvclN3aXRjaGVzKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBGYih0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZXQoe25hbWU6IGkuaWQsIGxhYmVsOiBpLmxhYmVsLCB3aXRoVGV4dDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuYmluZChcImlzT25cIikudG8oaSwgXCJ2YWx1ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9uKFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0KFwidmFsdWVcIiwgIXQuaXNPbilcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLmFkZCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUZvcm1DaGlsZHJlbih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBlLmFkZCh0aGlzLnVybElucHV0Vmlldyk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IEdwO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwidWxcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuX21hbnVhbERlY29yYXRvclN3aXRjaGVzLm1hcCh0ID0+ICh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwibGlcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbdF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stbGlzdF9faXRlbVwiXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stcmVzZXRcIiwgXCJjay1saXN0XCJdfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYWRkKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlLmFkZCh0aGlzLnNhdmVCdXR0b25WaWV3KTtcclxuICAgICAgICAgICAgICAgIGUuYWRkKHRoaXMuY2FuY2VsQnV0dG9uVmlldyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgJEEgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMTEuMDc3IDE1bC45OTEtMS40MTZhLjc1Ljc1IDAgMSAxIDEuMjI5Ljg2bC0xLjE0OCAxLjY0YS43NDguNzQ4IDAgMCAxLS4yMTcuMjA2IDUuMjUxIDUuMjUxIDAgMCAxLTguNTAzLTUuOTU1Ljc0MS43NDEgMCAwIDEgLjEyLS4yNzRsMS4xNDctMS42MzlhLjc1Ljc1IDAgMSAxIDEuMjI4Ljg2TDQuOTMzIDEwLjdsLjAwNi4wMDNhMy43NSAzLjc1IDAgMCAwIDYuMTMyIDQuMjk0bC4wMDYuMDA0em01LjQ5NC01LjMzNWEuNzQ4Ljc0OCAwIDAgMS0uMTIuMjc0bC0xLjE0NyAxLjYzOWEuNzUuNzUgMCAxIDEtMS4yMjgtLjg2bC44Ni0xLjIzYTMuNzUgMy43NSAwIDAgMC02LjE0NC00LjMwMWwtLjg2IDEuMjI5YS43NS43NSAwIDAgMS0xLjIyOS0uODZsMS4xNDgtMS42NGEuNzQ4Ljc0OCAwIDAgMSAuMjE3LS4yMDYgNS4yNTEgNS4yNTEgMCAwIDEgOC41MDMgNS45NTV6bS00LjU2My0yLjUzMmEuNzUuNzUgMCAwIDEgLjE4NCAxLjA0NWwtMy4xNTUgNC41MDVhLjc1Ljc1IDAgMSAxLTEuMjI5LS44NmwzLjE1NS00LjUwNmEuNzUuNzUgMCAwIDEgMS4wNDUtLjE4NHptNC45MTkgMTAuNTYybC0xLjQxNCAxLjQxNGEuNzUuNzUgMCAxIDEtMS4wNi0xLjA2bDEuNDE0LTEuNDE1LTEuNDE1LTEuNDE0YS43NS43NSAwIDAgMSAxLjA2MS0xLjA2bDEuNDE0IDEuNDE0IDEuNDE0LTEuNDE1YS43NS43NSAwIDAgMSAxLjA2MSAxLjA2MWwtMS40MTQgMS40MTQgMS40MTQgMS40MTVhLjc1Ljc1IDAgMCAxLTEuMDYgMS4wNmwtMS40MTUtMS40MTR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIEdBID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTcuMyAxNy4zN2wtLjA2MS4wODhhMS41MTggMS41MTggMCAwIDEtLjkzNC41MzVsLTQuMTc4LjY2My0uODA2LTQuMTUzYTEuNDk1IDEuNDk1IDAgMCAxIC4xODctMS4wNThsLjA1Ni0uMDg2TDguNzcgMi42MzljLjk1OC0xLjM1MSAyLjgwMy0xLjA3NiA0LjI5Ni0uMDMgMS40OTcgMS4wNDcgMi4zODcgMi42OTMgMS40MzMgNC4wNTVMNy4zIDE3LjM3ek05LjE0IDQuNzI4bC01LjU0NSA4LjM0NiAzLjI3NyAyLjI5NCA1LjU0NC04LjM0Nkw5LjE0IDQuNzI4ek02LjA3IDE2LjUxMmwtMy4yNzYtMi4yOTUuNTMgMi43MyAyLjc0Ni0uNDM1ek05Ljk5NCAzLjUwNkwxMy4yNzEgNS44Yy4zMTYtLjQ1Mi0uMTYtMS4zMzMtMS4wNjUtMS45NjYtLjkwNS0uNjM0LTEuODk1LS43OC0yLjIxMi0uMzI4ek04IDE4LjVMOS4zNzUgMTdIMTl2MS41SDh6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIEtBID0gaSg4NCk7XHJcblxyXG4gICAgICAgIGNsYXNzIEpBIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlciA9IG5ldyBmYjtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcyA9IG5ldyBkcDtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldmlld0J1dHRvblZpZXcgPSB0aGlzLl9jcmVhdGVQcmV2aWV3QnV0dG9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnVubGlua0J1dHRvblZpZXcgPSB0aGlzLl9jcmVhdGVCdXR0b24oZShcImxrXCIpLCAkQSwgXCJ1bmxpbmtcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRCdXR0b25WaWV3ID0gdGhpcy5fY3JlYXRlQnV0dG9uKGUoXCJsbFwiKSwgR0EsIFwiZWRpdFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaHJlZlwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzYWJsZXMgPSBuZXcgYnA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c0N5Y2xlciA9IG5ldyB5Yih7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNhYmxlczogdGhpcy5fZm9jdXNhYmxlcyxcclxuICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrZXI6IHRoaXMuZm9jdXNUcmFja2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGtleXN0cm9rZUhhbmRsZXI6IHRoaXMua2V5c3Ryb2tlcyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiB7Zm9jdXNQcmV2aW91czogXCJzaGlmdCArIHRhYlwiLCBmb2N1c05leHQ6IFwidGFiXCJ9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stbGluay1hY3Rpb25zXCJdLCB0YWJpbmRleDogXCItMVwifSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3RoaXMucHJldmlld0J1dHRvblZpZXcsIHRoaXMuZWRpdEJ1dHRvblZpZXcsIHRoaXMudW5saW5rQnV0dG9uVmlld11cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFt0aGlzLnByZXZpZXdCdXR0b25WaWV3LCB0aGlzLmVkaXRCdXR0b25WaWV3LCB0aGlzLnVubGlua0J1dHRvblZpZXddO1xyXG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzYWJsZXMuYWRkKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNUcmFja2VyLmFkZCh0LmVsZW1lbnQpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcy5saXN0ZW5Ubyh0aGlzLmVsZW1lbnQpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIuZm9jdXNGaXJzdCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVCdXR0b24odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBoYih0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBuLnNldCh7bGFiZWw6IHQsIGljb246IGUsIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIG4uZGVsZWdhdGUoXCJleGVjdXRlXCIpLnRvKHRoaXMsIGkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVByZXZpZXdCdXR0b24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbmV3IGhiKHRoaXMubG9jYWxlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICB0LnNldCh7d2l0aFRleHQ6IHRydWUsIHRvb2x0aXA6IGkoXCJsbVwiKX0pO1xyXG4gICAgICAgICAgICAgICAgdC5leHRlbmRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay1saW5rLWFjdGlvbnNfX3ByZXZpZXdcIl0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY6IGUudG8oXCJocmVmXCIsIHQgPT4gdCAmJiBDQSh0KSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogXCJfYmxhbmtcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVsOiBcIm5vb3BlbmVyIG5vcmVmZXJyZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5iaW5kKFwibGFiZWxcIikudG8odGhpcywgXCJocmVmXCIsIHQgPT4gdCB8fCBpKFwibG5cIikpO1xyXG4gICAgICAgICAgICAgICAgdC5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKHRoaXMsIFwiaHJlZlwiLCB0ID0+ICEhdCk7XHJcbiAgICAgICAgICAgICAgICB0LnRlbXBsYXRlLnRhZyA9IFwiYVwiO1xyXG4gICAgICAgICAgICAgICAgdC50ZW1wbGF0ZS5ldmVudExpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFlBID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTExLjA3NyAxNWwuOTkxLTEuNDE2YS43NS43NSAwIDEgMSAxLjIyOS44NmwtMS4xNDggMS42NGEuNzQ4Ljc0OCAwIDAgMS0uMjE3LjIwNiA1LjI1MSA1LjI1MSAwIDAgMS04LjUwMy01Ljk1NS43NDEuNzQxIDAgMCAxIC4xMi0uMjc0bDEuMTQ3LTEuNjM5YS43NS43NSAwIDEgMSAxLjIyOC44Nkw0LjkzMyAxMC43bC4wMDYuMDAzYTMuNzUgMy43NSAwIDAgMCA2LjEzMiA0LjI5NGwuMDA2LjAwNHptNS40OTQtNS4zMzVhLjc0OC43NDggMCAwIDEtLjEyLjI3NGwtMS4xNDcgMS42MzlhLjc1Ljc1IDAgMSAxLTEuMjI4LS44NmwuODYtMS4yM2EzLjc1IDMuNzUgMCAwIDAtNi4xNDQtNC4zMDFsLS44NiAxLjIyOWEuNzUuNzUgMCAwIDEtMS4yMjktLjg2bDEuMTQ4LTEuNjRhLjc0OC43NDggMCAwIDEgLjIxNy0uMjA2IDUuMjUxIDUuMjUxIDAgMCAxIDguNTAzIDUuOTU1em0tNC41NjMtMi41MzJhLjc1Ljc1IDAgMCAxIC4xODQgMS4wNDVsLTMuMTU1IDQuNTA1YS43NS43NSAwIDEgMS0xLjIyOS0uODZsMy4xNTUtNC41MDZhLjc1Ljc1IDAgMCAxIDEuMDQ1LS4xODR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgUUEgPSBcIkN0cmwrS1wiO1xyXG5cclxuICAgICAgICBjbGFzcyBYQSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBba2JdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkxpbmtVSVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5hZGRPYnNlcnZlcihXQSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbnNWaWV3ID0gdGhpcy5fY3JlYXRlQWN0aW9uc1ZpZXcoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybVZpZXcgPSB0aGlzLl9jcmVhdGVGb3JtVmlldygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbiA9IHQucGx1Z2lucy5nZXQoa2IpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlVG9vbGJhckxpbmtCdXR0b24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZVVzZXJCYWxsb29uSW50ZXJhY3Rpb25zKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybVZpZXcuZGVzdHJveSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVBY3Rpb25zVmlldygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgSkEodC5sb2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuY29tbWFuZHMuZ2V0KFwibGlua1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChcInVubGlua1wiKTtcclxuICAgICAgICAgICAgICAgIGUuYmluZChcImhyZWZcIikudG8oaSwgXCJ2YWx1ZVwiKTtcclxuICAgICAgICAgICAgICAgIGUuZWRpdEJ1dHRvblZpZXcuYmluZChcImlzRW5hYmxlZFwiKS50byhpKTtcclxuICAgICAgICAgICAgICAgIGUudW5saW5rQnV0dG9uVmlldy5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhlLCBcImVkaXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZEZvcm1WaWV3KClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhlLCBcInVubGlua1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKFwidW5saW5rXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVVSSgpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGUua2V5c3Ryb2tlcy5zZXQoXCJFc2NcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oaWRlVUkoKTtcclxuICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZS5rZXlzdHJva2VzLnNldChRQSwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRGb3JtVmlldygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlRm9ybVZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jb21tYW5kcy5nZXQoXCJsaW5rXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBVQSh0LmxvY2FsZSwgZS5tYW51YWxEZWNvcmF0b3JzKTtcclxuICAgICAgICAgICAgICAgIGkudXJsSW5wdXRWaWV3LmJpbmQoXCJ2YWx1ZVwiKS50byhlLCBcInZhbHVlXCIpO1xyXG4gICAgICAgICAgICAgICAgaS51cmxJbnB1dFZpZXcuYmluZChcImlzUmVhZE9ubHlcIikudG8oZSwgXCJpc0VuYWJsZWRcIiwgdCA9PiAhdCk7XHJcbiAgICAgICAgICAgICAgICBpLnNhdmVCdXR0b25WaWV3LmJpbmQoXCJpc0VuYWJsZWRcIikudG8oZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGksIFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoXCJsaW5rXCIsIGkudXJsSW5wdXRWaWV3LmlucHV0Vmlldy5lbGVtZW50LnZhbHVlLCBpLmdldERlY29yYXRvclN3aXRjaGVzU3RhdGUoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xvc2VGb3JtVmlldygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oaSwgXCJjYW5jZWxcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlRm9ybVZpZXcoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpLmtleXN0cm9rZXMuc2V0KFwiRXNjXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xvc2VGb3JtVmlldygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlVG9vbGJhckxpbmtCdXR0b24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jb21tYW5kcy5nZXQoXCJsaW5rXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHQua2V5c3Ryb2tlcy5zZXQoUUEsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Nob3dVSSh0cnVlKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKFwibGlua1wiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IGhiKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uaXNFbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBuLmxhYmVsID0gaShcImxmXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uaWNvbiA9IFlBO1xyXG4gICAgICAgICAgICAgICAgICAgIG4ua2V5c3Ryb2tlID0gUUE7XHJcbiAgICAgICAgICAgICAgICAgICAgbi50b29sdGlwID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBuLmlzVG9nZ2xlYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKGUsIFwiaXNFbmFibGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uYmluZChcImlzT25cIikudG8oZSwgXCJ2YWx1ZVwiLCB0ID0+ICEhdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhuLCBcImV4ZWN1dGVcIiwgKCkgPT4gdGhpcy5fc2hvd1VJKHRydWUpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2VuYWJsZVVzZXJCYWxsb29uSW50ZXJhY3Rpb25zKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odCwgXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX2dldFNlbGVjdGVkTGlua0VsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zaG93VUkoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3Iua2V5c3Ryb2tlcy5zZXQoXCJUYWJcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXJlQWN0aW9uc1Zpc2libGUgJiYgIXRoaXMuYWN0aW9uc1ZpZXcuZm9jdXNUcmFja2VyLmlzRm9jdXNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbnNWaWV3LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoXCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmtleXN0cm9rZXMuc2V0KFwiRXNjXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzVUlWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVVSSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIERiKHtcclxuICAgICAgICAgICAgICAgICAgICBlbWl0dGVyOiB0aGlzLmZvcm1WaWV3LFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2YXRvcjogKCkgPT4gdGhpcy5faXNVSUluUGFuZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dEVsZW1lbnRzOiBbdGhpcy5fYmFsbG9vbi52aWV3LmVsZW1lbnRdLFxyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB0aGlzLl9oaWRlVUkoKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FkZEFjdGlvbnNWaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FyZUFjdGlvbnNJblBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uLmFkZCh7dmlldzogdGhpcy5hY3Rpb25zVmlldywgcG9zaXRpb246IHRoaXMuX2dldEJhbGxvb25Qb3NpdGlvbkRhdGEoKX0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9hZGRGb3JtVmlldygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0Zvcm1JblBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5jb21tYW5kcy5nZXQoXCJsaW5rXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi5hZGQoe3ZpZXc6IHRoaXMuZm9ybVZpZXcsIHBvc2l0aW9uOiB0aGlzLl9nZXRCYWxsb29uUG9zaXRpb25EYXRhKCl9KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9iYWxsb29uLnZpc2libGVWaWV3ID09PSB0aGlzLmZvcm1WaWV3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtVmlldy51cmxJbnB1dFZpZXcuc2VsZWN0KClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybVZpZXcudXJsSW5wdXRWaWV3LmlucHV0Vmlldy5lbGVtZW50LnZhbHVlID0gZS52YWx1ZSB8fCBcIlwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jbG9zZUZvcm1WaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLmNvbW1hbmRzLmdldChcImxpbmtcIik7XHJcbiAgICAgICAgICAgICAgICB0LnJlc3RvcmVNYW51YWxEZWNvcmF0b3JTdGF0ZXMoKTtcclxuICAgICAgICAgICAgICAgIGlmICh0LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW1vdmVGb3JtVmlldygpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZGVVSSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZW1vdmVGb3JtVmlldygpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0Zvcm1JblBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtVmlldy5zYXZlQnV0dG9uVmlldy5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24ucmVtb3ZlKHRoaXMuZm9ybVZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zaG93VUkodCA9IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2dldFNlbGVjdGVkTGlua0VsZW1lbnQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZEFjdGlvbnNWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi5zaG93U3RhY2soXCJtYWluXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZEZvcm1WaWV3KClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FyZUFjdGlvbnNWaXNpYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkZEZvcm1WaWV3KClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRBY3Rpb25zVmlldygpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24uc2hvd1N0YWNrKFwibWFpblwiKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0VXBkYXRpbmdVSSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oaWRlVUkoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2lzVUlJblBhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodC51aSwgXCJ1cGRhdGVcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5fYmFsbG9vbiwgXCJjaGFuZ2U6dmlzaWJsZVZpZXdcIik7XHJcbiAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRm9ybVZpZXcoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24ucmVtb3ZlKHRoaXMuYWN0aW9uc1ZpZXcpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zdGFydFVwZGF0aW5nVUkoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IHRoaXMuX2dldFNlbGVjdGVkTGlua0VsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fZ2V0U2VsZWN0ZWRMaW5rRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSByKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgJiYgIXQgfHwgIWkgJiYgZSAhPT0gbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oaWRlVUkoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNVSVZpc2libGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi51cGRhdGVQb3NpdGlvbih0aGlzLl9nZXRCYWxsb29uUG9zaXRpb25EYXRhKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHIoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuc2VsZWN0aW9uLmZvY3VzLmdldEFuY2VzdG9ycygpLnJldmVyc2UoKS5maW5kKHQgPT4gdC5pcyhcImVsZW1lbnRcIikpXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LnVpLCBcInVwZGF0ZVwiLCBvKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5fYmFsbG9vbiwgXCJjaGFuZ2U6dmlzaWJsZVZpZXdcIiwgbylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9pc0Zvcm1JblBhbmVsKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24uaGFzVmlldyh0aGlzLmZvcm1WaWV3KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgX2FyZUFjdGlvbnNJblBhbmVsKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24uaGFzVmlldyh0aGlzLmFjdGlvbnNWaWV3KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgX2FyZUFjdGlvbnNWaXNpYmxlKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhbGxvb24udmlzaWJsZVZpZXcgPT09IHRoaXMuYWN0aW9uc1ZpZXdcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9pc1VJSW5QYW5lbCgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0Zvcm1JblBhbmVsIHx8IHRoaXMuX2FyZUFjdGlvbnNJblBhbmVsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfaXNVSVZpc2libGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fYmFsbG9vbi52aXNpYmxlVmlldztcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ID09IHRoaXMuZm9ybVZpZXcgfHwgdGhpcy5fYXJlQWN0aW9uc1Zpc2libGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldEJhbGxvb25Qb3NpdGlvbkRhdGEoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5fZ2V0U2VsZWN0ZWRMaW5rRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkgPyB0LmRvbUNvbnZlcnRlci5tYXBWaWV3VG9Eb20oaSkgOiB0LmRvbUNvbnZlcnRlci52aWV3UmFuZ2VUb0RvbShlLnNlbGVjdGlvbi5nZXRGaXJzdFJhbmdlKCkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt0YXJnZXQ6IG59XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRTZWxlY3RlZExpbmtFbGVtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmIChlLmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFpBKGUuZ2V0Rmlyc3RQb3NpdGlvbigpKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5nZXRGaXJzdFJhbmdlKCkuZ2V0VHJpbW1lZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBaQShpLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gWkEoaS5lbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbiB8fCBuICE9IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQuY3JlYXRlUmFuZ2VJbihuKS5nZXRUcmltbWVkKCkuaXNFcXVhbChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBaQSh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0LmdldEFuY2VzdG9ycygpLmZpbmQodCA9PiB5QSh0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHRUIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtIQSwgWEFdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIkxpbmtcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBlVCBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5fZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdGhpcy5fY2hlY2tFbmFibGVkKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IEFycmF5LmZyb20oZS5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRCbG9ja3MoKSkuZmlsdGVyKGUgPT4gblQoZSwgdC5zY2hlbWEpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnZhbHVlID09PSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSBpW2kubGVuZ3RoIC0gMV0ubmV4dFNpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoZSAmJiBlLm5hbWUgPT0gXCJsaXN0SXRlbVwiICYmIGUuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0IDwgbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSB0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdCAtIG47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnB1c2goe2VsZW1lbnQ6IGUsIGxpc3RJbmRlbnQ6IGl9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBlLm5leHRTaWJsaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG8ucmV2ZXJzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIsIGUubGlzdEluZGVudCwgZS5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IE51bWJlci5QT1NJVElWRV9JTkZJTklUWTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLmlzKFwibGlzdEl0ZW1cIikgJiYgZS5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpIDwgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBlLmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gdCA9PT0gMCA/IDEgOiB0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpVChpLCB0cnVlLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaVQoaSwgZmFsc2UsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpLnJldmVyc2UoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobiAmJiBlLm5hbWUgPT0gXCJsaXN0SXRlbVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbmFtZShlLCBcInBhcmFncmFwaFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFuICYmIGUubmFtZSAhPSBcImxpc3RJdGVtXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlcyh7bGlzdFR5cGU6IHRoaXMudHlwZSwgbGlzdEluZGVudDogMH0sIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5yZW5hbWUoZSwgXCJsaXN0SXRlbVwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFuICYmIGUubmFtZSA9PSBcImxpc3RJdGVtXCIgJiYgZS5nZXRBdHRyaWJ1dGUoXCJsaXN0VHlwZVwiKSAhPSB0aGlzLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlKFwibGlzdFR5cGVcIiwgdGhpcy50eXBlLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFd3KHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRTZWxlY3RlZEJsb2NrcygpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIXQgJiYgdC5pcyhcImxpc3RJdGVtXCIpICYmIHQuZ2V0QXR0cmlidXRlKFwibGlzdFR5cGVcIikgPT0gdGhpcy50eXBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jaGVja0VuYWJsZWQoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBXdyh0LmdldFNlbGVjdGVkQmxvY2tzKCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblQoaSwgZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaVQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZSA/IHRbMF0gOiB0W3QubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmIChuLmlzKFwibGlzdEl0ZW1cIikpIHtcclxuICAgICAgICAgICAgICAgIGxldCBvID0gbltlID8gXCJwcmV2aW91c1NpYmxpbmdcIiA6IFwibmV4dFNpYmxpbmdcIl07XHJcbiAgICAgICAgICAgICAgICBsZXQgciA9IG4uZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChvICYmIG8uaXMoXCJsaXN0SXRlbVwiKSAmJiBvLmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIikgPj0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyID4gby5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBvLmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8uZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSA9PSByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRbZSA/IFwidW5zaGlmdFwiIDogXCJwdXNoXCJdKG8pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG8gPSBvW2UgPyBcInByZXZpb3VzU2libGluZ1wiIDogXCJuZXh0U2libGluZ1wiXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBuVCh0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlLmNoZWNrQ2hpbGQodC5wYXJlbnQsIFwibGlzdEl0ZW1cIikgJiYgIWUuaXNPYmplY3QodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIG9UIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2luZGVudEJ5ID0gZSA9PSBcImZvcndhcmRcIiA/IDEgOiAtMVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSB0aGlzLl9jaGVja0VuYWJsZWQoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IEFycmF5LmZyb20oZS5zZWxlY3Rpb24uZ2V0U2VsZWN0ZWRCbG9ja3MoKSk7XHJcbiAgICAgICAgICAgICAgICB0LmNoYW5nZSh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaVtpLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBuID0gZS5uZXh0U2libGluZztcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAobiAmJiBuLm5hbWUgPT0gXCJsaXN0SXRlbVwiICYmIG4uZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSA+IGUuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gobik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBuLm5leHRTaWJsaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pbmRlbnRCeSA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGkucmV2ZXJzZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIikgKyB0aGlzLl9pbmRlbnRCeTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlbmFtZShlLCBcInBhcmFncmFwaFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIsIGksIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY2hlY2tFbmFibGVkKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IFd3KHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRTZWxlY3RlZEJsb2NrcygpKTtcclxuICAgICAgICAgICAgICAgIGlmICghdCB8fCAhdC5pcyhcImxpc3RJdGVtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faW5kZW50QnkgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRBdHRyaWJ1dGUoXCJsaXN0VHlwZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbiA9IHQucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChuICYmIG4uaXMoXCJsaXN0SXRlbVwiKSAmJiBuLmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIikgPj0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpID09IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmdldEF0dHJpYnV0ZShcImxpc3RUeXBlXCIpID09IGlcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuID0gbi5wcmV2aW91c1NpYmxpbmdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByVCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQoXCJsaVwiKTtcclxuICAgICAgICAgICAgZS5nZXRGaWxsZXJPZmZzZXQgPSBoVDtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNUKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IGUubWFwcGVyO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZS53cml0ZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0LmdldEF0dHJpYnV0ZShcImxpc3RUeXBlXCIpID09IFwibnVtYmVyZWRcIiA/IFwib2xcIiA6IFwidWxcIjtcclxuICAgICAgICAgICAgY29uc3QgciA9IHJUKG4pO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gbi5jcmVhdGVDb250YWluZXJFbGVtZW50KG8sIG51bGwpO1xyXG4gICAgICAgICAgICBuLmluc2VydChuLmNyZWF0ZVBvc2l0aW9uQXQocywgMCksIHIpO1xyXG4gICAgICAgICAgICBpLmJpbmRFbGVtZW50cyh0LCByKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFUKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGUucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCByID0gaS5tYXBwZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSBpLndyaXRlcjtcclxuICAgICAgICAgICAgbGV0IGEgPSByLnRvVmlld1Bvc2l0aW9uKG4uY3JlYXRlUG9zaXRpb25CZWZvcmUodCkpO1xyXG4gICAgICAgICAgICBjb25zdCBjID0gZFQodC5wcmV2aW91c1NpYmxpbmcsIHtcclxuICAgICAgICAgICAgICAgIHNhbWVJbmRlbnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBzbWFsbGVySW5kZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgbGlzdEluZGVudDogdC5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjb25zdCBsID0gdC5wcmV2aW91c1NpYmxpbmc7XHJcbiAgICAgICAgICAgIGlmIChjICYmIGMuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSA9PSB0LmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSByLnRvVmlld0VsZW1lbnQoYyk7XHJcbiAgICAgICAgICAgICAgICBhID0gcy5icmVha0NvbnRhaW5lcihzLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIodCkpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobCAmJiBsLm5hbWUgPT0gXCJsaXN0SXRlbVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYSA9IHIudG9WaWV3UG9zaXRpb24obi5jcmVhdGVQb3NpdGlvbkF0KGwsIFwiZW5kXCIpKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBhID0gci50b1ZpZXdQb3NpdGlvbihuLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKHQpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGEgPSBsVChhKTtcclxuICAgICAgICAgICAgcy5pbnNlcnQoYSwgbyk7XHJcbiAgICAgICAgICAgIGlmIChsICYmIGwubmFtZSA9PSBcImxpc3RJdGVtXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSByLnRvVmlld0VsZW1lbnQobCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gcy5jcmVhdGVSYW5nZShzLmNyZWF0ZVBvc2l0aW9uQXQodCwgMCksIGEpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuZ2V0V2Fsa2VyKHtpZ25vcmVFbGVtZW50RW5kOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lml0ZW0uaXMoXCJsaVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gcy5icmVha0NvbnRhaW5lcihzLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKHQuaXRlbSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5pdGVtLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHMuY3JlYXRlUG9zaXRpb25BdChlLCBcImVuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY1Qocywgci5ub2RlQmVmb3JlLCByLm5vZGVBZnRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHMubW92ZShzLmNyZWF0ZVJhbmdlT24obyksIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnBvc2l0aW9uID0gaVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBvLm5leHRTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgJiYgKGkuaXMoXCJ1bFwiKSB8fCBpLmlzKFwib2xcIikpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpLmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHIudG9Nb2RlbEVsZW1lbnQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpICYmIGkuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSA+IHQuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcy5icmVha0NvbnRhaW5lcihzLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIobikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzLm1vdmUocy5jcmVhdGVSYW5nZU9uKG4ucGFyZW50KSwgcy5jcmVhdGVQb3NpdGlvbkF0KGUsIFwiZW5kXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjVChzLCBvLCBvLm5leHRTaWJsaW5nKTtcclxuICAgICAgICAgICAgY1Qocywgby5wcmV2aW91c1NpYmxpbmcsIG8pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjVCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmICghZSB8fCAhaSB8fCBlLm5hbWUgIT0gXCJ1bFwiICYmIGUubmFtZSAhPSBcIm9sXCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGUubmFtZSAhPSBpLm5hbWUgfHwgZS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSAhPT0gaS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdC5tZXJnZUNvbnRhaW5lcnModC5jcmVhdGVQb3NpdGlvbkFmdGVyKGUpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbFQodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5nZXRMYXN0TWF0Y2hpbmdQb3NpdGlvbih0ID0+IHQuaXRlbS5pcyhcInVpRWxlbWVudFwiKSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRUKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9ICEhZS5zYW1lSW5kZW50O1xyXG4gICAgICAgICAgICBjb25zdCBuID0gISFlLnNtYWxsZXJJbmRlbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBlLmxpc3RJbmRlbnQ7XHJcbiAgICAgICAgICAgIGxldCByID0gdDtcclxuICAgICAgICAgICAgd2hpbGUgKHIgJiYgci5uYW1lID09IFwibGlzdEl0ZW1cIikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHIuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChpICYmIG8gPT0gdCB8fCBuICYmIG8gPiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHIgPSByLnByZXZpb3VzU2libGluZ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1VCh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoZSwgbyA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdC5jb21tYW5kcy5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IGhiKG8pO1xyXG4gICAgICAgICAgICAgICAgcy5zZXQoe2xhYmVsOiBpLCBpY29uOiBuLCB0b29sdGlwOiB0cnVlLCBpc1RvZ2dsZWFibGU6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHMuYmluZChcImlzT25cIiwgXCJpc0VuYWJsZWRcIikudG8ociwgXCJ2YWx1ZVwiLCBcImlzRW5hYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgIHMub24oXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5lZGl0aW5nLnZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaFQoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHQgPSAhdGhpcy5pc0VtcHR5ICYmICh0aGlzLmdldENoaWxkKDApLm5hbWUgPT0gXCJ1bFwiIHx8IHRoaXMuZ2V0Q2hpbGQoMCkubmFtZSA9PSBcIm9sXCIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0VtcHR5IHx8IHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIEhjLmNhbGwodGhpcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZUKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5jb25zdW1hYmxlO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvLnRlc3QoaS5pdGVtLCBcImluc2VydFwiKSB8fCAhby50ZXN0KGkuaXRlbSwgXCJhdHRyaWJ1dGU6bGlzdFR5cGVcIikgfHwgIW8udGVzdChpLml0ZW0sIFwiYXR0cmlidXRlOmxpc3RJbmRlbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG8uY29uc3VtZShpLml0ZW0sIFwiaW5zZXJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgby5jb25zdW1lKGkuaXRlbSwgXCJhdHRyaWJ1dGU6bGlzdFR5cGVcIik7XHJcbiAgICAgICAgICAgICAgICBvLmNvbnN1bWUoaS5pdGVtLCBcImF0dHJpYnV0ZTpsaXN0SW5kZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGkuaXRlbTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBzVChyLCBuKTtcclxuICAgICAgICAgICAgICAgIGFUKHIsIHMsIG4sIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdUKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5tYXBwZXIudG9WaWV3UG9zaXRpb24oaS5wb3NpdGlvbikuZ2V0TGFzdE1hdGNoaW5nUG9zaXRpb24odCA9PiAhdC5pdGVtLmlzKFwibGlcIikpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG8ubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4ud3JpdGVyO1xyXG4gICAgICAgICAgICAgICAgcy5icmVha0NvbnRhaW5lcihzLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKHIpKTtcclxuICAgICAgICAgICAgICAgIHMuYnJlYWtDb250YWluZXIocy5jcmVhdGVQb3NpdGlvbkFmdGVyKHIpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSByLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBhLnByZXZpb3VzU2libGluZztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBzLmNyZWF0ZVJhbmdlT24oYSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0gcy5yZW1vdmUobCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYyAmJiBjLm5leHRTaWJsaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY1QocywgYywgYy5uZXh0U2libGluZylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBuLm1hcHBlci50b01vZGVsRWxlbWVudChyKTtcclxuICAgICAgICAgICAgICAgIEVUKHUuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSArIDEsIGkucG9zaXRpb24sIGwuc3RhcnQsIHIsIG4sIHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMuY3JlYXRlUmFuZ2VJbihkKS5nZXRJdGVtcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5tYXBwZXIudW5iaW5kVmlld0VsZW1lbnQodClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuc3RvcCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1UKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaWYgKCFpLmNvbnN1bWFibGUuY29uc3VtZShlLml0ZW0sIFwiYXR0cmlidXRlOmxpc3RUeXBlXCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBuID0gaS5tYXBwZXIudG9WaWV3RWxlbWVudChlLml0ZW0pO1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaS53cml0ZXI7XHJcbiAgICAgICAgICAgIG8uYnJlYWtDb250YWluZXIoby5jcmVhdGVQb3NpdGlvbkJlZm9yZShuKSk7XHJcbiAgICAgICAgICAgIG8uYnJlYWtDb250YWluZXIoby5jcmVhdGVQb3NpdGlvbkFmdGVyKG4pKTtcclxuICAgICAgICAgICAgY29uc3QgciA9IG4ucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBzID0gZS5hdHRyaWJ1dGVOZXdWYWx1ZSA9PSBcIm51bWJlcmVkXCIgPyBcIm9sXCIgOiBcInVsXCI7XHJcbiAgICAgICAgICAgIG8ucmVuYW1lKHMsIHIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBwVCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpLm1hcHBlci50b1ZpZXdFbGVtZW50KGUuaXRlbSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuLnBhcmVudDtcclxuICAgICAgICAgICAgY29uc3QgciA9IGkud3JpdGVyO1xyXG4gICAgICAgICAgICBjVChyLCBvLCBvLm5leHRTaWJsaW5nKTtcclxuICAgICAgICAgICAgY1Qociwgby5wcmV2aW91c1NpYmxpbmcsIG8pO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZS5pdGVtLmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgIGkuY29uc3VtYWJsZS5jb25zdW1lKHQsIFwiaW5zZXJ0XCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJUKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW4uY29uc3VtYWJsZS5jb25zdW1lKGkuaXRlbSwgXCJhdHRyaWJ1dGU6bGlzdEluZGVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ubWFwcGVyLnRvVmlld0VsZW1lbnQoaS5pdGVtKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLndyaXRlcjtcclxuICAgICAgICAgICAgICAgIHIuYnJlYWtDb250YWluZXIoci5jcmVhdGVQb3NpdGlvbkJlZm9yZShvKSk7XHJcbiAgICAgICAgICAgICAgICByLmJyZWFrQ29udGFpbmVyKHIuY3JlYXRlUG9zaXRpb25BZnRlcihvKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gby5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gcy5wcmV2aW91c1NpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gci5jcmVhdGVSYW5nZU9uKHMpO1xyXG4gICAgICAgICAgICAgICAgci5yZW1vdmUoYyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYSAmJiBhLm5leHRTaWJsaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY1QociwgYSwgYS5uZXh0U2libGluZylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIEVUKGkuYXR0cmlidXRlT2xkVmFsdWUgKyAxLCBpLnJhbmdlLnN0YXJ0LCBjLnN0YXJ0LCBvLCBuLCB0KTtcclxuICAgICAgICAgICAgICAgIGFUKGkuaXRlbSwgbywgbiwgdCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaS5pdGVtLmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLmNvbnN1bWFibGUuY29uc3VtZSh0LCBcImluc2VydFwiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB3VCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmIChlLml0ZW0ubmFtZSAhPSBcImxpc3RJdGVtXCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCB0ID0gaS5tYXBwZXIudG9WaWV3UG9zaXRpb24oZS5yYW5nZS5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS53cml0ZXI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gW107XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodC5wYXJlbnQubmFtZSA9PSBcInVsXCIgfHwgdC5wYXJlbnQubmFtZSA9PSBcIm9sXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ID0gbi5icmVha0NvbnRhaW5lcih0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5wYXJlbnQubmFtZSAhPSBcImxpXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG4uY3JlYXRlUG9zaXRpb25BdCh0LnBhcmVudCwgXCJlbmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmlzRXF1YWwoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG4ucmVtb3ZlKG4uY3JlYXRlUmFuZ2UoZSwgaSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLnB1c2godClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IG4uY3JlYXRlUG9zaXRpb25BZnRlcih0LnBhcmVudClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChvLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IG8ubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG4uaW5zZXJ0KHQsIG9bZV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gci5lbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGNUKG4sIGksIGkubmV4dFNpYmxpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgJiYgZS5wYXJlbnQgPT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQub2Zmc2V0LS1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjVChuLCB0Lm5vZGVCZWZvcmUsIHQubm9kZUFmdGVyKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBrVCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpLm1hcHBlci50b1ZpZXdQb3NpdGlvbihlLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IG4ubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgY29uc3QgciA9IG4ubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICBjVChpLndyaXRlciwgbywgcilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9UKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgaWYgKGkuY29uc3VtYWJsZS5jb25zdW1lKGUudmlld0l0ZW0sIHtuYW1lOiB0cnVlfSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLndyaXRlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNyZWF0ZUVsZW1lbnQoXCJsaXN0SXRlbVwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBPVChlLnZpZXdJdGVtKTtcclxuICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiLCBvLCBuKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBlLnZpZXdJdGVtLnBhcmVudCAmJiBlLnZpZXdJdGVtLnBhcmVudC5uYW1lID09IFwib2xcIiA/IFwibnVtYmVyZWRcIiA6IFwiYnVsbGV0ZWRcIjtcclxuICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlKFwibGlzdFR5cGVcIiwgciwgbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gaS5zcGxpdFRvQWxsb3dlZFBhcmVudChuLCBlLm1vZGVsQ3Vyc29yKTtcclxuICAgICAgICAgICAgICAgIGlmICghcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdC5pbnNlcnQobiwgcy5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gUFQobiwgZS52aWV3SXRlbS5nZXRDaGlsZHJlbigpLCBpKTtcclxuICAgICAgICAgICAgICAgIGUubW9kZWxSYW5nZSA9IHQuY3JlYXRlUmFuZ2UoZS5tb2RlbEN1cnNvciwgYSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocy5jdXJzb3JQYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm1vZGVsQ3Vyc29yID0gdC5jcmVhdGVQb3NpdGlvbkF0KHMuY3Vyc29yUGFyZW50LCAwKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm1vZGVsQ3Vyc29yID0gZS5tb2RlbFJhbmdlLmVuZFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB2VCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmIChpLmNvbnN1bWFibGUudGVzdChlLnZpZXdJdGVtLCB7bmFtZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gQXJyYXkuZnJvbShlLnZpZXdJdGVtLmdldENoaWxkcmVuKCkpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gIShlLmlzKFwibGlcIikgfHwgUlQoZSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuX3JlbW92ZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB5VCh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGlmIChpLmNvbnN1bWFibGUudGVzdChlLnZpZXdJdGVtLCB7bmFtZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS52aWV3SXRlbS5jaGlsZENvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gWy4uLmUudmlld0l0ZW0uZ2V0Q2hpbGRyZW4oKV07XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgbGV0IG4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSAmJiAhUlQoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5fcmVtb3ZlKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaXMoXCJ0ZXh0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLl9kYXRhID0gZS5kYXRhLnJlcGxhY2UoL15cXHMrLywgXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWUubmV4dFNpYmxpbmcgfHwgUlQoZS5uZXh0U2libGluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuX2RhdGEgPSBlLmRhdGEucmVwbGFjZSgvXFxzKyQvLCBcIlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChSVChlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24geFQodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpLmlzUGhhbnRvbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkubW9kZWxQb3NpdGlvbi5ub2RlQmVmb3JlO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gJiYgbi5pcyhcImxpc3RJdGVtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGkubWFwcGVyLnRvVmlld0VsZW1lbnQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuZ2V0QW5jZXN0b3JzKCkuZmluZChSVCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHQuY3JlYXRlUG9zaXRpb25BdChlLCAwKS5nZXRXYWxrZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodC50eXBlID09IFwiZWxlbWVudFN0YXJ0XCIgJiYgdC5pdGVtLmlzKFwibGlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkudmlld1Bvc2l0aW9uID0gdC5wcmV2aW91c1Bvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0LnR5cGUgPT0gXCJlbGVtZW50RW5kXCIgJiYgdC5pdGVtID09IG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkudmlld1Bvc2l0aW9uID0gdC5uZXh0UG9zaXRpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBDVCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkudmlld1Bvc2l0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGkubWFwcGVyO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8ubmFtZSA9PSBcInVsXCIgfHwgby5uYW1lID09IFwib2xcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbi5pc0F0RW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSByLnRvTW9kZWxFbGVtZW50KG4ubm9kZUFmdGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5tb2RlbFBvc2l0aW9uID0gdC5jcmVhdGVQb3NpdGlvbkJlZm9yZShlKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSByLnRvTW9kZWxFbGVtZW50KG4ubm9kZUJlZm9yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSByLmdldE1vZGVsTGVuZ3RoKG4ubm9kZUJlZm9yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkubW9kZWxQb3NpdGlvbiA9IHQuY3JlYXRlUG9zaXRpb25CZWZvcmUoZSkuZ2V0U2hpZnRlZEJ5KG8pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG8ubmFtZSA9PSBcImxpXCIgJiYgbi5ub2RlQmVmb3JlICYmIChuLm5vZGVCZWZvcmUubmFtZSA9PSBcInVsXCIgfHwgbi5ub2RlQmVmb3JlLm5hbWUgPT0gXCJvbFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSByLnRvTW9kZWxFbGVtZW50KG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IG4ubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoYyAmJiBSVChjKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhICs9IHIuZ2V0TW9kZWxMZW5ndGgoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBjLnByZXZpb3VzU2libGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpLm1vZGVsUG9zaXRpb24gPSB0LmNyZWF0ZVBvc2l0aW9uQmVmb3JlKHMpLmdldFNoaWZ0ZWRCeShhKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBBVCh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmRvY3VtZW50LmRpZmZlci5nZXRDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICBsZXQgbyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG4udHlwZSA9PSBcImluc2VydFwiICYmIG4ubmFtZSA9PSBcImxpc3RJdGVtXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByKG4ucG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG4udHlwZSA9PSBcImluc2VydFwiICYmIG4ubmFtZSAhPSBcImxpc3RJdGVtXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5uYW1lICE9IFwiJHRleHRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbi5wb3NpdGlvbi5ub2RlQWZ0ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpLmhhc0F0dHJpYnV0ZShcImxpc3RJbmRlbnRcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucmVtb3ZlQXR0cmlidXRlKFwibGlzdEluZGVudFwiLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkuaGFzQXR0cmlidXRlKFwibGlzdFR5cGVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucmVtb3ZlQXR0cmlidXRlKFwibGlzdFR5cGVcIiwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBBcnJheS5mcm9tKHQuY3JlYXRlUmFuZ2VJbihpKSkuZmlsdGVyKHQgPT4gdC5pdGVtLmlzKFwibGlzdEl0ZW1cIikpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByKGUucHJldmlvdXNQb3NpdGlvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbi5wb3NpdGlvbi5nZXRTaGlmdGVkQnkobi5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHIoaSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobi50eXBlID09IFwicmVtb3ZlXCIgJiYgbi5uYW1lID09IFwibGlzdEl0ZW1cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHIobi5wb3NpdGlvbilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobi50eXBlID09IFwiYXR0cmlidXRlXCIgJiYgbi5hdHRyaWJ1dGVLZXkgPT0gXCJsaXN0SW5kZW50XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByKG4ucmFuZ2Uuc3RhcnQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG4udHlwZSA9PSBcImF0dHJpYnV0ZVwiICYmIG4uYXR0cmlidXRlS2V5ID09IFwibGlzdFR5cGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHIobi5yYW5nZS5zdGFydClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi52YWx1ZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgcyh0KTtcclxuICAgICAgICAgICAgICAgIGEodClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbztcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHIodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubm9kZUJlZm9yZTtcclxuICAgICAgICAgICAgICAgIGlmICghZSB8fCAhZS5pcyhcImxpc3RJdGVtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubm9kZUFmdGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlICYmIGUuaXMoXCJsaXN0SXRlbVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnNldChlLCBlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSBlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuLmhhcyhpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGkucHJldmlvdXNTaWJsaW5nICYmIGkucHJldmlvdXNTaWJsaW5nLmlzKFwibGlzdEl0ZW1cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGkucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5oYXMoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG4uc2V0KHQubm9kZUJlZm9yZSwgaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gcyh0KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICBsZXQgbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodCAmJiB0LmlzKFwibGlzdEl0ZW1cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdC5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyID4gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSByIC0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA+IHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9IHIgLSBuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIsIHMsIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gdC5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpICsgMVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ID0gdC5uZXh0U2libGluZ1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBhKHQpIHtcclxuICAgICAgICAgICAgICAgIGxldCBpID0gW107XHJcbiAgICAgICAgICAgICAgICBsZXQgbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAodCAmJiB0LmlzKFwibGlzdEl0ZW1cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdC5nZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuICYmIG4uZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSA+IHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGkuc2xpY2UoMCwgciArIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyICE9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlbcl0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpW3JdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuZ2V0QXR0cmlidXRlKFwibGlzdFR5cGVcIikgIT0gbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKFwibGlzdFR5cGVcIiwgbiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlbcl0gPSB0LmdldEF0dHJpYnV0ZShcImxpc3RUeXBlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IHQubmV4dFNpYmxpbmdcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVFQodCwgW2UsIGldKSB7XHJcbiAgICAgICAgICAgIGxldCBuID0gZS5pcyhcImRvY3VtZW50RnJhZ21lbnRcIikgPyBlLmdldENoaWxkKDApIDogZTtcclxuICAgICAgICAgICAgbGV0IG87XHJcbiAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgbyA9IHRoaXMuZG9jdW1lbnQuc2VsZWN0aW9uXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBvID0gdGhpcy5jcmVhdGVTZWxlY3Rpb24oaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobiAmJiBuLmlzKFwibGlzdEl0ZW1cIikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBvLmdldEZpcnN0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICh0LnBhcmVudC5pcyhcImxpc3RJdGVtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQucGFyZW50XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQubm9kZUJlZm9yZSAmJiB0Lm5vZGVCZWZvcmUuaXMoXCJsaXN0SXRlbVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0Lm5vZGVCZWZvcmVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG4gJiYgbi5pcyhcImxpc3RJdGVtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLl9zZXRBdHRyaWJ1dGUoXCJsaXN0SW5kZW50XCIsIG4uZ2V0QXR0cmlidXRlKFwibGlzdEluZGVudFwiKSArIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IG4ubmV4dFNpYmxpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUFQodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCB7d3JpdGVyOiBuLCBzY2hlbWE6IG99ID0gaTtcclxuICAgICAgICAgICAgbGV0IHIgPSBuLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIodCk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocy5uYW1lID09IFwidWxcIiB8fCBzLm5hbWUgPT0gXCJvbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgciA9IGkuY29udmVydEl0ZW0ocywgcikubW9kZWxDdXJzb3JcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGkuY29udmVydEl0ZW0ocywgbi5jcmVhdGVQb3NpdGlvbkF0KHQsIFwiZW5kXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gZS5tb2RlbFJhbmdlLnN0YXJ0Lm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gYSAmJiBhLmlzKFwiZWxlbWVudFwiKSAmJiAhby5jaGVja0NoaWxkKHQsIGEubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUubW9kZWxDdXJzb3IucGFyZW50LmlzKFwibGlzdEl0ZW1cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQgPSBlLm1vZGVsQ3Vyc29yLnBhcmVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IFNUKGUubW9kZWxDdXJzb3IpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgciA9IG4uY3JlYXRlUG9zaXRpb25BZnRlcih0KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gclxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gU1QodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IFdoKHtzdGFydFBvc2l0aW9uOiB0fSk7XHJcbiAgICAgICAgICAgIGxldCBpO1xyXG4gICAgICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgICAgICBpID0gZS5uZXh0KClcclxuICAgICAgICAgICAgfSB3aGlsZSAoIWkudmFsdWUuaXRlbS5pcyhcImxpc3RJdGVtXCIpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGkudmFsdWUuaXRlbVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRVQodCwgZSwgaSwgbiwgbywgcikge1xyXG4gICAgICAgICAgICBjb25zdCBzID0gZFQoZS5ub2RlQmVmb3JlLCB7c2FtZUluZGVudDogdHJ1ZSwgc21hbGxlckluZGVudDogdHJ1ZSwgbGlzdEluZGVudDogdCwgZm9vOiBcImJcIn0pO1xyXG4gICAgICAgICAgICBjb25zdCBhID0gby5tYXBwZXI7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSBvLndyaXRlcjtcclxuICAgICAgICAgICAgY29uc3QgbCA9IHMgPyBzLmdldEF0dHJpYnV0ZShcImxpc3RJbmRlbnRcIikgOiBudWxsO1xyXG4gICAgICAgICAgICBsZXQgZDtcclxuICAgICAgICAgICAgaWYgKCFzKSB7XHJcbiAgICAgICAgICAgICAgICBkID0gaVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGwgPT0gdCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGEudG9WaWV3RWxlbWVudChzKS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBkID0gYy5jcmVhdGVQb3NpdGlvbkFmdGVyKHQpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gci5jcmVhdGVQb3NpdGlvbkF0KHMsIFwiZW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgZCA9IGEudG9WaWV3UG9zaXRpb24odClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkID0gbFQoZCk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBbLi4ubi5nZXRDaGlsZHJlbigpXSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKFJUKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IGMubW92ZShjLmNyZWF0ZVJhbmdlT24odCksIGQpLmVuZDtcclxuICAgICAgICAgICAgICAgICAgICBjVChjLCB0LCB0Lm5leHRTaWJsaW5nKTtcclxuICAgICAgICAgICAgICAgICAgICBjVChjLCB0LnByZXZpb3VzU2libGluZywgdClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUlQodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5pcyhcIm9sXCIpIHx8IHQuaXMoXCJ1bFwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gT1QodCkge1xyXG4gICAgICAgICAgICBsZXQgZSA9IDA7XHJcbiAgICAgICAgICAgIGxldCBpID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIHdoaWxlIChpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5pcyhcImxpXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSsrXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLnByZXZpb3VzU2libGluZztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiB0LmlzKFwibGlcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSsrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaSA9IGkucGFyZW50XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIElUIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJMaXN0RWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1ZfXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEucmVnaXN0ZXIoXCJsaXN0SXRlbVwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5oZXJpdEFsbEZyb206IFwiJGJsb2NrXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYWxsb3dBdHRyaWJ1dGVzOiBbXCJsaXN0VHlwZVwiLCBcImxpc3RJbmRlbnRcIl1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZGF0YTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmVkaXRpbmc7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLmRvY3VtZW50LnJlZ2lzdGVyUG9zdEZpeGVyKGUgPT4gQVQodC5tb2RlbCwgZSkpO1xyXG4gICAgICAgICAgICAgICAgaS5tYXBwZXIucmVnaXN0ZXJWaWV3VG9Nb2RlbExlbmd0aChcImxpXCIsIFZUKTtcclxuICAgICAgICAgICAgICAgIGUubWFwcGVyLnJlZ2lzdGVyVmlld1RvTW9kZWxMZW5ndGgoXCJsaVwiLCBWVCk7XHJcbiAgICAgICAgICAgICAgICBpLm1hcHBlci5vbihcIm1vZGVsVG9WaWV3UG9zaXRpb25cIiwgeFQoaS52aWV3KSk7XHJcbiAgICAgICAgICAgICAgICBpLm1hcHBlci5vbihcInZpZXdUb01vZGVsUG9zaXRpb25cIiwgQ1QodC5tb2RlbCkpO1xyXG4gICAgICAgICAgICAgICAgZS5tYXBwZXIub24oXCJtb2RlbFRvVmlld1Bvc2l0aW9uXCIsIHhUKGkudmlldykpO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmZvcihcImVkaXRpbmdEb3duY2FzdFwiKS5hZGQoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5vbihcImluc2VydFwiLCB3VCwge3ByaW9yaXR5OiBcImhpZ2hcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJpbnNlcnQ6bGlzdEl0ZW1cIiwgZlQodC5tb2RlbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJhdHRyaWJ1dGU6bGlzdFR5cGU6bGlzdEl0ZW1cIiwgbVQsIHtwcmlvcml0eTogXCJoaWdoXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwiYXR0cmlidXRlOmxpc3RUeXBlOmxpc3RJdGVtXCIsIHBULCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwiYXR0cmlidXRlOmxpc3RJbmRlbnQ6bGlzdEl0ZW1cIiwgYlQodC5tb2RlbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJyZW1vdmU6bGlzdEl0ZW1cIiwgZ1QodC5tb2RlbCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJyZW1vdmVcIiwga1QsIHtwcmlvcml0eTogXCJsb3dcIn0pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5mb3IoXCJkYXRhRG93bmNhc3RcIikuYWRkKGUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUub24oXCJpbnNlcnRcIiwgd1QsIHtwcmlvcml0eTogXCJoaWdoXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwiaW5zZXJ0Omxpc3RJdGVtXCIsIGZUKHQubW9kZWwpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uZm9yKFwidXBjYXN0XCIpLmFkZCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9uKFwiZWxlbWVudDp1bFwiLCB2VCwge3ByaW9yaXR5OiBcImhpZ2hcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHQub24oXCJlbGVtZW50Om9sXCIsIHZULCB7cHJpb3JpdHk6IFwiaGlnaFwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5vbihcImVsZW1lbnQ6bGlcIiwgeVQsIHtwcmlvcml0eTogXCJoaWdoXCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9uKFwiZWxlbWVudDpsaVwiLCBfVClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5vbihcImluc2VydENvbnRlbnRcIiwgVFQsIHtwcmlvcml0eTogXCJoaWdoXCJ9KTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwibnVtYmVyZWRMaXN0XCIsIG5ldyBlVCh0LCBcIm51bWJlcmVkXCIpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiYnVsbGV0ZWRMaXN0XCIsIG5ldyBlVCh0LCBcImJ1bGxldGVkXCIpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiaW5kZW50TGlzdFwiLCBuZXcgb1QodCwgXCJmb3J3YXJkXCIpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwib3V0ZGVudExpc3RcIiwgbmV3IG9UKHQsIFwiYmFja3dhcmRcIikpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkudmlldy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obiwgXCJlbnRlclwiLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5zZWxlY3Rpb24uZ2V0TGFzdFBvc2l0aW9uKCkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpLnNlbGVjdGlvbi5pc0NvbGxhcHNlZCAmJiBuLm5hbWUgPT0gXCJsaXN0SXRlbVwiICYmIG4uaXNFbXB0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5leGVjdXRlKFwib3V0ZGVudExpc3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zdG9wKClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obiwgXCJkZWxldGVcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5kaXJlY3Rpb24gIT09IFwiYmFja3dhcmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmdldEZpcnN0UG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW4uaXNBdFN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8ubmFtZSAhPT0gXCJsaXN0SXRlbVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gby5wcmV2aW91c1NpYmxpbmcgJiYgby5wcmV2aW91c1NpYmxpbmcubmFtZSA9PT0gXCJsaXN0SXRlbVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5leGVjdXRlKFwib3V0ZGVudExpc3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwiaGlnaFwifSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdCA9PiAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5jb21tYW5kcy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4uaXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmV4ZWN1dGUodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0LmtleXN0cm9rZXMuc2V0KFwiVGFiXCIsIG8oXCJpbmRlbnRMaXN0XCIpKTtcclxuICAgICAgICAgICAgICAgIHQua2V5c3Ryb2tlcy5zZXQoXCJTaGlmdCtUYWJcIiwgbyhcIm91dGRlbnRMaXN0XCIpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhZnRlckluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IuY29tbWFuZHM7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5nZXQoXCJpbmRlbnRcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXQoXCJvdXRkZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnJlZ2lzdGVyQ2hpbGRDb21tYW5kKHQuZ2V0KFwiaW5kZW50TGlzdFwiKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5yZWdpc3RlckNoaWxkQ29tbWFuZCh0LmdldChcIm91dGRlbnRMaXN0XCIpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBWVCh0KSB7XHJcbiAgICAgICAgICAgIGxldCBlID0gMTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkubmFtZSA9PSBcInVsXCIgfHwgaS5uYW1lID09IFwib2xcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBpLmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZSArPSBWVCh0KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIE5UID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTcgNS43NWMwIC40MTQuMzM2Ljc1Ljc1Ljc1aDkuNWEuNzUuNzUgMCAxIDAgMC0xLjVoLTkuNWEuNzUuNzUgMCAwIDAtLjc1Ljc1ek0zLjUgM3Y1SDJWMy43SDF2LTFoMi41VjN6TS4zNDMgMTcuODU3bDIuNTktMy4yNTdIMi45MmEuNi42IDAgMSAwLTEuMDQgMEguMzAyYTIgMiAwIDEgMSAzLjk5NSAwaC0uMDAxYy0uMDQ4LjQwNS0uMTYuNzM0LS4zMzMuOTg4LS4xNzUuMjU0LS41OS42OTItMS4yNDQgMS4zMTJINC4zdjFoLTRsLjA0My0uMDQzek03IDE0Ljc1YS43NS43NSAwIDAgMSAuNzUtLjc1aDkuNWEuNzUuNzUgMCAxIDEgMCAxLjVoLTkuNWEuNzUuNzUgMCAwIDEtLjc1LS43NXpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgTVQgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNNyA1Ljc1YzAgLjQxNC4zMzYuNzUuNzUuNzVoOS41YS43NS43NSAwIDEgMCAwLTEuNWgtOS41YS43NS43NSAwIDAgMC0uNzUuNzV6bS02IDBDMSA0Ljc4NCAxLjc3NyA0IDIuNzUgNGMuOTY2IDAgMS43NS43NzcgMS43NSAxLjc1IDAgLjk2Ni0uNzc3IDEuNzUtMS43NSAxLjc1QzEuNzg0IDcuNSAxIDYuNzIzIDEgNS43NXptNiA5YzAgLjQxNC4zMzYuNzUuNzUuNzVoOS41YS43NS43NSAwIDEgMCAwLTEuNWgtOS41YS43NS43NSAwIDAgMC0uNzUuNzV6bS02IDBjMC0uOTY2Ljc3Ny0xLjc1IDEuNzUtMS43NS45NjYgMCAxLjc1Ljc3NyAxLjc1IDEuNzUgMCAuOTY2LS43NzcgMS43NS0xLjc1IDEuNzUtLjk2NiAwLTEuNzUtLjc3Ny0xLjc1LTEuNzV6XCIvPjwvc3ZnPic7XHJcblxyXG4gICAgICAgIGNsYXNzIEJUIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLnQ7XHJcbiAgICAgICAgICAgICAgICB1VCh0aGlzLmVkaXRvciwgXCJudW1iZXJlZExpc3RcIiwgdChcImxjXCIpLCBOVCk7XHJcbiAgICAgICAgICAgICAgICB1VCh0aGlzLmVkaXRvciwgXCJidWxsZXRlZExpc3RcIiwgdChcImxkXCIpLCBNVClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgelQgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW0lULCBCVF1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiTGlzdFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBMVCA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk04LjY5IDE0LjkxNWMuMDUzLjA1Mi4xNzMuMDgzLjM2LjA5M2EuMzY2LjM2NiAwIDAgMSAuMzQ1LjQ4NWwtLjAwMy4wMWEuNzM4LjczOCAwIDAgMS0uNjk3LjQ5N2gtMi42N2EuMzc0LjM3NCAwIDAgMS0uMzUzLS40OTZsLjAxMy0uMDM4YS42ODEuNjgxIDAgMCAxIC42NDQtLjQ1OGMuMTk3LS4wMTIuMzI1LS4wNDMuMzg2LS4wOTNhLjI4LjI4IDAgMCAwIC4wNzItLjExTDkuNTkyIDQuNUg2LjI2OWMtLjM1OS0uMDE3LS42MDkuMDEzLS43NS4wOS0uMTQyLjA3OC0uMjg5LjI2NS0uNDQyLjU2My0uMTkyLjI5LS41MTYuNDY0LS44NjQuNDY0SDQuMTdhLjQzLjQzIDAgMCAxLS40MDctLjU2OUw0LjQ2IDNoMTMuMDhsLS42MiAyLjA0M2EuODEuODEgMCAwIDEtLjc3NS41NzRoLS4xMTRhLjQ4Ni40ODYgMCAwIDEtLjQ4Ni0uNDg2Yy4wMDEtLjI4NC0uMDU0LS40NjQtLjE2Ny0uNTQtLjExMi0uMDc2LS4zNjctLjEwNi0uNzY2LS4wOTFoLTMuMjhsLTIuNjggMTAuMjU3Yy0uMDA2LjA3NC4wMDcuMTI3LjAzOC4xNTh6TTMgMTdoOGEuNS41IDAgMSAxIDAgMUgzYS41LjUgMCAxIDEgMC0xem0xMS4yOTkgMS4xN2EuNzUuNzUgMCAxIDEtMS4wNi0xLjA2bDEuNDE0LTEuNDE1LTEuNDE1LTEuNDE0YS43NS43NSAwIDAgMSAxLjA2LTEuMDZsMS40MTUgMS40MTQgMS40MTQtMS40MTVhLjc1Ljc1IDAgMSAxIDEuMDYgMS4wNmwtMS40MTMgMS40MTUgMS40MTQgMS40MTVhLjc1Ljc1IDAgMCAxLTEuMDYgMS4wNmwtMS40MTUtMS40MTQtMS40MTQgMS40MTR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgRlQgPSBcInJlbW92ZUZvcm1hdFwiO1xyXG5cclxuICAgICAgICBjbGFzcyBEVCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiUmVtb3ZlRm9ybWF0VUlcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoRlQsIGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNvbW1hbmRzLmdldChGVCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBoYihpKTtcclxuICAgICAgICAgICAgICAgICAgICBvLnNldCh7bGFiZWw6IGUoXCJsYVwiKSwgaWNvbjogTFQsIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc09uXCIsIFwiaXNFbmFibGVkXCIpLnRvKG4sIFwidmFsdWVcIiwgXCJpc0VuYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhvLCBcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoRlQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGpUIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSAhIVd3KHRoaXMuX2dldEZvcm1hdHRpbmdJdGVtcyh0LmRvY3VtZW50LnNlbGVjdGlvbiwgdC5zY2hlbWEpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgdC5jaGFuZ2UoaSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuX2dldEZvcm1hdHRpbmdJdGVtcyh0LmRvY3VtZW50LnNlbGVjdGlvbiwgZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uaXMoXCJzZWxlY3Rpb25cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLl9nZXRGb3JtYXR0aW5nQXR0cmlidXRlcyhuLCBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkucmVtb3ZlU2VsZWN0aW9uQXR0cmlidXRlKHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gaS5jcmVhdGVSYW5nZU9uKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBvIG9mIHRoaXMuX2dldEZvcm1hdHRpbmdBdHRyaWJ1dGVzKG4sIGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5yZW1vdmVBdHRyaWJ1dGUobywgdClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogX2dldEZvcm1hdHRpbmdJdGVtcyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdCA9PiAhIVd3KHRoaXMuX2dldEZvcm1hdHRpbmdBdHRyaWJ1dGVzKHQsIGUpKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldFJhbmdlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUuZ2V0SXRlbXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeWllbGQgdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICogX2dldEZvcm1hdHRpbmdBdHRyaWJ1dGVzKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2ldIG9mIHQuZ2V0QXR0cmlidXRlcygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0QXR0cmlidXRlUHJvcGVydGllcyhpKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiB0LmlzRm9ybWF0dGluZykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB5aWVsZCBpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBIVCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiUmVtb3ZlRm9ybWF0RWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInJlbW92ZUZvcm1hdFwiLCBuZXcgalQodCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFdUIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtIVCwgRFRdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlJlbW92ZUZvcm1hdFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHFUIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSA9IDIwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2l6ZSA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbWl0ID0gZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMb2NrZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZUNhbGxiYWNrID0gKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS50eXBlICE9IFwidHJhbnNwYXJlbnRcIiAmJiBlICE9PSB0aGlzLl9iYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXNldCh0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWxlY3Rpb25DaGFuZ2VDYWxsYmFjayA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXNldCgpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5kb2N1bWVudC5vbihcImNoYW5nZVwiLCB0aGlzLl9jaGFuZ2VDYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5vbihcImNoYW5nZTpyYW5nZVwiLCB0aGlzLl9zZWxlY3Rpb25DaGFuZ2VDYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5vbihcImNoYW5nZTphdHRyaWJ1dGVcIiwgdGhpcy5fc2VsZWN0aW9uQ2hhbmdlQ2FsbGJhY2spXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBiYXRjaCgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fYmF0Y2gpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9iYXRjaCA9IHRoaXMubW9kZWwuY3JlYXRlQmF0Y2goKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JhdGNoXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlucHV0KHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2l6ZSArPSB0O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2l6ZSA+PSB0aGlzLmxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXQodHJ1ZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbG9jaygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMb2NrZWQgPSB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHVubG9jaygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMb2NrZWQgPSBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5kb2N1bWVudC5vZmYoXCJjaGFuZ2VcIiwgdGhpcy5fY2hhbmdlQ2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24ub2ZmKFwiY2hhbmdlOnJhbmdlXCIsIHRoaXMuX3NlbGVjdGlvbkNoYW5nZUNhbGxiYWNrKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uLm9mZihcImNoYW5nZTphdHRyaWJ1dGVcIiwgdGhpcy5fc2VsZWN0aW9uQ2hhbmdlQ2FsbGJhY2spXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZXNldCh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNMb2NrZWQgfHwgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2JhdGNoID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNpemUgPSAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFVUIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2J1ZmZlciA9IG5ldyBxVCh0Lm1vZGVsLCBlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JhdGNoZXMgPSBuZXcgV2Vha1NldFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgYnVmZmVyKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlclxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYnVmZmVyLmRlc3Ryb3koKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC50ZXh0IHx8IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdC5yYW5nZSA/IGUuY3JlYXRlU2VsZWN0aW9uKHQucmFuZ2UpIDogaS5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gdC5yZXN1bHRSYW5nZTtcclxuICAgICAgICAgICAgICAgIGUuZW5xdWV1ZUNoYW5nZSh0aGlzLl9idWZmZXIuYmF0Y2gsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2J1ZmZlci5sb2NrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5kZWxldGVDb250ZW50KHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuaW5zZXJ0Q29udGVudCh0LmNyZWF0ZVRleHQobiwgaS5zZWxlY3Rpb24uZ2V0QXR0cmlidXRlcygpKSwgcilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24ocylcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFyLmlzKFwiZG9jdW1lbnRTZWxlY3Rpb25cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24ocilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnVmZmVyLnVubG9jaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2J1ZmZlci5pbnB1dChvKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9iYXRjaGVzLmFkZCh0aGlzLl9idWZmZXIuYmF0Y2gpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiAkVCh0KSB7XHJcbiAgICAgICAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQubW9kZWw7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgY29uc3QgbyA9IHQuY29tbWFuZHMuZ2V0KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgIGlmIChBbC5pc0FuZHJvaWQpIHtcclxuICAgICAgICAgICAgICAgIG4uZG9jdW1lbnQub24oXCJiZWZvcmVpbnB1dFwiLCAodCwgZSkgPT4gcihlKSwge3ByaW9yaXR5OiBcImxvd2VzdFwifSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIG4uZG9jdW1lbnQub24oXCJrZXlkb3duXCIsICh0LCBlKSA9PiByKGUpLCB7cHJpb3JpdHk6IFwibG93ZXN0XCJ9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG4uZG9jdW1lbnQub24oXCJjb21wb3NpdGlvbnN0YXJ0XCIsIHMsIHtwcmlvcml0eTogXCJsb3dlc3RcIn0pO1xyXG4gICAgICAgICAgICBuLmRvY3VtZW50Lm9uKFwiY29tcG9zaXRpb25lbmRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZSA9IGkuY3JlYXRlU2VsZWN0aW9uKGkuZG9jdW1lbnQuc2VsZWN0aW9uKVxyXG4gICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93ZXN0XCJ9KTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHIodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGkuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5kb2N1bWVudC5pc0NvbXBvc2luZztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBlICYmIGUuaXNFcXVhbChyLnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICghby5pc0VuYWJsZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChLVCh0KSB8fCByLnNlbGVjdGlvbi5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHMgJiYgdC5rZXlDb2RlID09PSAyMjkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghcyAmJiB0LmtleUNvZGUgPT09IDIyOSAmJiBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuc2VsZWN0aW9uLnJhbmdlQ291bnQgPT09IDEgPyB0LnNlbGVjdGlvbi5nZXRGaXJzdFJhbmdlKCkuaXNGbGF0IDogdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGlmICh0LnNlbGVjdGlvbi5pc0NvbGxhcHNlZCB8fCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gYSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBvLmJ1ZmZlcjtcclxuICAgICAgICAgICAgICAgIHQubG9jaygpO1xyXG4gICAgICAgICAgICAgICAgaS5lbnF1ZXVlQ2hhbmdlKHQuYmF0Y2gsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpLmRlbGV0ZUNvbnRlbnQoaS5kb2N1bWVudC5zZWxlY3Rpb24pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQudW5sb2NrKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgR1QgPSBbTWwoXCJhcnJvd1VwXCIpLCBNbChcImFycm93UmlnaHRcIiksIE1sKFwiYXJyb3dEb3duXCIpLCBNbChcImFycm93TGVmdFwiKSwgOSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyNywgMzMsIDM0LCAzNSwgMzYsIDQ1LCA5MSwgOTMsIDE0NCwgMTQ1LCAxNzMsIDE3NCwgMTc1LCAxNzYsIDE3NywgMTc4LCAxNzksIDI1NV07XHJcbiAgICAgICAgZm9yIChsZXQgdCA9IDExMjsgdCA8PSAxMzU7IHQrKykge1xyXG4gICAgICAgICAgICBHVC5wdXNoKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBLVCh0KSB7XHJcbiAgICAgICAgICAgIGlmICh0LmN0cmxLZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIEdULmluY2x1ZGVzKHQua2V5Q29kZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEpUKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgICAgIGxldCBvO1xyXG4gICAgICAgICAgICB0LmZvckVhY2godCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodCA9PSBcImVxdWFsXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbisrXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQgPT0gXCJpbnNlcnRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzKFwiaW5zZXJ0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8udmFsdWVzLnB1c2goZVtuXSlcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB7dHlwZTogXCJpbnNlcnRcIiwgaW5kZXg6IG4sIHZhbHVlczogW2Vbbl1dfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuKytcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMoXCJkZWxldGVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5ob3dNYW55KytcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSB7dHlwZTogXCJkZWxldGVcIiwgaW5kZXg6IG4sIGhvd01hbnk6IDF9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcigpO1xyXG4gICAgICAgICAgICByZXR1cm4gaTtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHIoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIGkucHVzaChvKTtcclxuICAgICAgICAgICAgICAgICAgICBvID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBzKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvICYmIG8udHlwZSA9PSB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFlUKHQpIHtcclxuICAgICAgICAgICAgaWYgKHQubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS50eXBlID09PSBcImNoaWxkcmVuXCIgJiYgIVFUKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFFUKHQpIHtcclxuICAgICAgICAgICAgaWYgKHQubmV3Q2hpbGRyZW4ubGVuZ3RoIC0gdC5vbGRDaGlsZHJlbi5sZW5ndGggIT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZSA9IF9kKHQub2xkQ2hpbGRyZW4sIHQubmV3Q2hpbGRyZW4sIFhUKTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IEpUKGUsIHQubmV3Q2hpbGRyZW4pO1xyXG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBuID0gaVswXTtcclxuICAgICAgICAgICAgaWYgKCEoISFuLnZhbHVlc1swXSAmJiBuLnZhbHVlc1swXS5pcyhcInRleHRcIikpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWFQodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoISF0ICYmIHQuaXMoXCJ0ZXh0XCIpICYmICEhZSAmJiBlLmlzKFwidGV4dFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuZGF0YSA9PT0gZS5kYXRhXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdCA9PT0gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBaVCh0KSB7XHJcbiAgICAgICAgICAgIHQuZWRpdGluZy52aWV3LmRvY3VtZW50Lm9uKFwibXV0YXRpb25zXCIsIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBuZXcgdFAodCkuaGFuZGxlKGksIG4pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB0UCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yID0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdGluZyA9IHRoaXMuZWRpdG9yLmVkaXRpbmdcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaGFuZGxlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChZVCh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNvbnRhaW5lckNoaWxkcmVuTXV0YXRpb25zKHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZVRleHRNdXRhdGlvbihpLCBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlVGV4dE5vZGVJbnNlcnRpb24oaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVDb250YWluZXJDaGlsZHJlbk11dGF0aW9ucyh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZVAodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5lZGl0aW5nLnZpZXcuZG9tQ29udmVydGVyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ubWFwVmlld1RvRG9tKGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyB6ZCh0aGlzLmVkaXRvci5lZGl0aW5nLnZpZXcuZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuZWRpdG9yLmRhdGEudG9Nb2RlbChyLmRvbVRvVmlldyhvKSkuZ2V0Q2hpbGQoMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gdGhpcy5lZGl0b3IuZWRpdGluZy5tYXBwZXIudG9Nb2RlbEVsZW1lbnQoaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBBcnJheS5mcm9tKHMuZ2V0Q2hpbGRyZW4oKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gQXJyYXkuZnJvbShhLmdldENoaWxkcmVuKCkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZCA9IGNbYy5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBsW2wubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZCAmJiBkLmlzKFwic29mdEJyZWFrXCIpICYmIHUgJiYgIXUuaXMoXCJzb2Z0QnJlYWtcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjLnBvcCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBoID0gdGhpcy5lZGl0b3IubW9kZWwuc2NoZW1hO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpUChjLCBoKSB8fCAhaVAobCwgaCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGYgPSBjLm1hcCh0ID0+IHQuaXMoXCJ0ZXh0XCIpID8gdC5kYXRhIDogXCJAXCIpLmpvaW4oXCJcIikucmVwbGFjZSgvXFx1MDBBMC9nLCBcIiBcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnID0gbC5tYXAodCA9PiB0LmlzKFwidGV4dFwiKSA/IHQuZGF0YSA6IFwiQFwiKS5qb2luKFwiXCIpLnJlcGxhY2UoL1xcdTAwQTAvZywgXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGcgPT09IGYpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IG0gPSBfZChnLCBmKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtmaXJzdENoYW5nZUF0OiBwLCBpbnNlcnRpb25zOiBiLCBkZWxldGlvbnM6IHd9ID0gblAobSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgayA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSB0aGlzLmVkaXRpbmcubWFwcGVyLnRvTW9kZWxSYW5nZShlLmdldEZpcnN0UmFuZ2UoKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IF8gPSBmLnN1YnN0cihwLCBiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLmVkaXRvci5tb2RlbC5jcmVhdGVSYW5nZSh0aGlzLmVkaXRvci5tb2RlbC5jcmVhdGVQb3NpdGlvbkF0KGEsIHApLCB0aGlzLmVkaXRvci5tb2RlbC5jcmVhdGVQb3NpdGlvbkF0KGEsIHAgKyB3KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5leGVjdXRlKFwiaW5wdXRcIiwge3RleHQ6IF8sIHJhbmdlOiB2LCByZXN1bHRSYW5nZToga30pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVUZXh0TXV0YXRpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHQudHlwZSAhPSBcInRleHRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubmV3VGV4dC5yZXBsYWNlKC9cXHUwMEEwL2csIFwiIFwiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0Lm9sZFRleHQucmVwbGFjZSgvXFx1MDBBMC9nLCBcIiBcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAobiA9PT0gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IF9kKG4sIGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge2ZpcnN0Q2hhbmdlQXQ6IHIsIGluc2VydGlvbnM6IHMsIGRlbGV0aW9uczogYX0gPSBuUChvKTtcclxuICAgICAgICAgICAgICAgIGxldCBjID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYyA9IHRoaXMuZWRpdGluZy5tYXBwZXIudG9Nb2RlbFJhbmdlKGUuZ2V0Rmlyc3RSYW5nZSgpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IHRoaXMuZWRpdGluZy52aWV3LmNyZWF0ZVBvc2l0aW9uQXQodC5ub2RlLCByKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGQgPSB0aGlzLmVkaXRpbmcubWFwcGVyLnRvTW9kZWxQb3NpdGlvbihsKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSB0aGlzLmVkaXRvci5tb2RlbC5jcmVhdGVSYW5nZShkLCBkLmdldFNoaWZ0ZWRCeShhKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBoID0gaS5zdWJzdHIociwgcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5leGVjdXRlKFwiaW5wdXRcIiwge3RleHQ6IGgsIHJhbmdlOiB1LCByZXN1bHRSYW5nZTogY30pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9oYW5kbGVUZXh0Tm9kZUluc2VydGlvbih0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC50eXBlICE9IFwiY2hpbGRyZW5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IFFUKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdGluZy52aWV3LmNyZWF0ZVBvc2l0aW9uQXQodC5ub2RlLCBlLmluZGV4KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRpbmcubWFwcGVyLnRvTW9kZWxQb3NpdGlvbihpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLnZhbHVlc1swXS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZXhlY3V0ZShcImlucHV0XCIsIHt0ZXh0OiBvLnJlcGxhY2UoL1xcdTAwQTAvZywgXCIgXCIpLCByYW5nZTogdGhpcy5lZGl0b3IubW9kZWwuY3JlYXRlUmFuZ2Uobil9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlUCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1hcCh0ID0+IHQubm9kZSkucmVkdWNlKCh0LCBlKSA9PiB0LmdldENvbW1vbkFuY2VzdG9yKGUsIHtpbmNsdWRlU2VsZjogdHJ1ZX0pKTtcclxuICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZS5nZXRBbmNlc3RvcnMoe1xyXG4gICAgICAgICAgICAgICAgaW5jbHVkZVNlbGY6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBwYXJlbnRGaXJzdDogdHJ1ZVxyXG4gICAgICAgICAgICB9KS5maW5kKHQgPT4gdC5pcyhcImNvbnRhaW5lckVsZW1lbnRcIikgfHwgdC5pcyhcInJvb3RFbGVtZW50XCIpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaVAodCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5ldmVyeSh0ID0+IGUuaXNJbmxpbmUodCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBuUCh0KSB7XHJcbiAgICAgICAgICAgIGxldCBlID0gbnVsbDtcclxuICAgICAgICAgICAgbGV0IGkgPSBudWxsO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0W25dO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8gIT0gXCJlcXVhbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGUgPT09IG51bGwgPyBuIDogZTtcclxuICAgICAgICAgICAgICAgICAgICBpID0gblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBuID0gMDtcclxuICAgICAgICAgICAgbGV0IG8gPSAwO1xyXG4gICAgICAgICAgICBmb3IgKGxldCByID0gZTsgciA8PSBpOyByKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0W3JdICE9IFwiaW5zZXJ0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBuKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0W3JdICE9IFwiZGVsZXRlXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvKytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4ge2luc2VydGlvbnM6IG8sIGRlbGV0aW9uczogbiwgZmlyc3RDaGFuZ2VBdDogZX1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIG9QIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJJbnB1dFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFVUKHQsIHQuY29uZmlnLmdldChcInR5cGluZy51bmRvU3RlcFwiKSB8fCAyMCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImlucHV0XCIsIGUpO1xyXG4gICAgICAgICAgICAgICAgJFQodCk7XHJcbiAgICAgICAgICAgICAgICBaVCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpc0lucHV0KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5jb21tYW5kcy5nZXQoXCJpbnB1dFwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlLl9iYXRjaGVzLmhhcyh0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyByUCBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9idWZmZXIgPSBuZXcgcVQodC5tb2RlbCwgdC5jb25maWcuZ2V0KFwidHlwaW5nLnVuZG9TdGVwXCIpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgYnVmZmVyKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlclxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBlLmVucXVldWVDaGFuZ2UodGhpcy5fYnVmZmVyLmJhdGNoLCBuID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9idWZmZXIubG9jaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLmNyZWF0ZVNlbGVjdGlvbih0LnNlbGVjdGlvbiB8fCBpLnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG8uaXNDb2xsYXBzZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8uaXNDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5tb2RpZnlTZWxlY3Rpb24obywge2RpcmVjdGlvbjogdGhpcy5kaXJlY3Rpb24sIHVuaXQ6IHQudW5pdH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zaG91bGRFbnRpcmVDb250ZW50QmVSZXBsYWNlZFdpdGhQYXJhZ3JhcGgodC5zZXF1ZW5jZSB8fCAxKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXBsYWNlRW50aXJlQ29udGVudFdpdGhQYXJhZ3JhcGgobik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoby5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uZ2V0Rmlyc3RSYW5nZSgpLmdldE1pbmltYWxGbGF0UmFuZ2VzKCkuZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcyArPSBmbCh0LmdldFdhbGtlcih7c2luZ2xlQ2hhcmFjdGVyczogdHJ1ZSwgaWdub3JlRWxlbWVudEVuZDogdHJ1ZSwgc2hhbGxvdzogdHJ1ZX0pKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGUuZGVsZXRlQ29udGVudChvLCB7ZG9Ob3RSZXNldEVudGlyZUNvbnRlbnQ6IHIsIGRpcmVjdGlvbjogdGhpcy5kaXJlY3Rpb259KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9idWZmZXIuaW5wdXQocyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5zZXRTZWxlY3Rpb24obyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnVmZmVyLnVubG9jaygpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2hvdWxkRW50aXJlQ29udGVudEJlUmVwbGFjZWRXaXRoUGFyYWdyYXBoKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5zY2hlbWEuZ2V0TGltaXRFbGVtZW50KG4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4uaXNDb2xsYXBzZWQgJiYgbi5jb250YWluc0VudGlyZUNvbnRlbnQobyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICghZS5zY2hlbWEuY2hlY2tDaGlsZChvLCBcInBhcmFncmFwaFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG8uZ2V0Q2hpbGQoMCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocyAmJiBzLm5hbWUgPT09IFwicGFyYWdyYXBoXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZXBsYWNlRW50aXJlQ29udGVudFdpdGhQYXJhZ3JhcGgodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5zY2hlbWEuZ2V0TGltaXRFbGVtZW50KG4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHQuY3JlYXRlRWxlbWVudChcInBhcmFncmFwaFwiKTtcclxuICAgICAgICAgICAgICAgIHQucmVtb3ZlKHQuY3JlYXRlUmFuZ2VJbihvKSk7XHJcbiAgICAgICAgICAgICAgICB0Lmluc2VydChyLCBvKTtcclxuICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKHIsIDApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHNQIGV4dGVuZHMgR2Qge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICAgICAgICAgICAgZS5vbihcImtleXVwXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSBObC5kZWxldGUgfHwgZS5rZXlDb2RlID09IE5sLmJhY2tzcGFjZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZS5vbihcImtleWRvd25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSBObC5kZWxldGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5kaXJlY3Rpb24gPSBcImZvcndhcmRcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby51bml0ID0gXCJjaGFyYWN0ZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09IE5sLmJhY2tzcGFjZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLmRpcmVjdGlvbiA9IFwiYmFja3dhcmRcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby51bml0ID0gXCJjb2RlUG9pbnRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gQWwuaXNNYWMgPyBlLmFsdEtleSA6IGUuY3RybEtleTtcclxuICAgICAgICAgICAgICAgICAgICBvLnVuaXQgPSByID8gXCJ3b3JkXCIgOiBvLnVuaXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXF1ZW5jZSA9ICsraTtcclxuICAgICAgICAgICAgICAgICAgICBuKHQsIGUuZG9tRXZlbnQsIG8pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChBbC5pc0FuZHJvaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwiYmVmb3JlaW5wdXRcIiwgKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkuZG9tRXZlbnQuaW5wdXRUeXBlICE9IFwiZGVsZXRlQ29udGVudEJhY2t3YXJkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB7dW5pdDogXCJjb2RlcG9pbnRcIiwgZGlyZWN0aW9uOiBcImJhY2t3YXJkXCIsIHNlcXVlbmNlOiAxfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IGkuZG9tVGFyZ2V0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyLmFuY2hvck5vZGUgPT0gci5mb2N1c05vZGUgJiYgci5hbmNob3JPZmZzZXQgKyAxICE9IHIuZm9jdXNPZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2VsZWN0aW9uVG9SZW1vdmUgPSB0LmRvbUNvbnZlcnRlci5kb21TZWxlY3Rpb25Ub1ZpZXcocilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuKGUsIGkuZG9tRXZlbnQsIG8pXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBuKHQsIGksIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbztcclxuICAgICAgICAgICAgICAgICAgICBlLm9uY2UoXCJkZWxldGVcIiwgdCA9PiBvID0gdCwge3ByaW9yaXR5OiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFl9KTtcclxuICAgICAgICAgICAgICAgICAgICBlLmZpcmUoXCJkZWxldGVcIiwgbmV3IEt1KGUsIGksIG4pKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobyAmJiBvLnN0b3AuY2FsbGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvYnNlcnZlKCkge1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBhUCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRGVsZXRlXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmVkaXRpbmcudmlldztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgZS5hZGRPYnNlcnZlcihzUCk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImZvcndhcmREZWxldGVcIiwgbmV3IHJQKHQsIFwiZm9yd2FyZFwiKSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImRlbGV0ZVwiLCBuZXcgclAodCwgXCJiYWNrd2FyZFwiKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGksIFwiZGVsZXRlXCIsIChpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHt1bml0OiBuLnVuaXQsIHNlcXVlbmNlOiBuLnNlcXVlbmNlfTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobi5zZWxlY3Rpb25Ub1JlbW92ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbC5jcmVhdGVTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygbi5zZWxlY3Rpb25Ub1JlbW92ZS5nZXRSYW5nZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5wdXNoKHQuZWRpdGluZy5tYXBwZXIudG9Nb2RlbFJhbmdlKGUpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc2V0VG8oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8uc2VsZWN0aW9uID0gZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUobi5kaXJlY3Rpb24gPT0gXCJmb3J3YXJkXCIgPyBcImZvcndhcmREZWxldGVcIiA6IFwiZGVsZXRlXCIsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIG4ucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBlLnNjcm9sbFRvVGhlU2VsZWN0aW9uKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKEFsLmlzQW5kcm9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGksIFwiZGVsZXRlXCIsIChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmRvbVRhcmdldC5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldFNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yTm9kZTogbi5hbmNob3JOb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yT2Zmc2V0OiBuLmFuY2hvck9mZnNldCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzTm9kZTogbi5mb2N1c05vZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09mZnNldDogbi5mb2N1c09mZnNldFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd2VzdFwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhpLCBcImtleXVwXCIsIChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaS5kb21UYXJnZXQub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuY29sbGFwc2UodC5hbmNob3JOb2RlLCB0LmFuY2hvck9mZnNldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmV4dGVuZCh0LmZvY3VzTm9kZSwgdC5mb2N1c09mZnNldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgY1AgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW29QLCBhUF1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiVHlwaW5nXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgbFAgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFiZWxWaWV3ID0gbmV3IE1rKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYWJlbFZpZXcudGV4dCA9IGkoXCJiXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ncm91cERyb3Bkb3duVmlldyA9IHRoaXMuX2NyZWF0ZUdyb3VwRHJvcGRvd24oZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdyb3VwRHJvcGRvd25WaWV3LnBhbmVsUG9zaXRpb24gPSB0LnVpTGFuZ3VhZ2VEaXJlY3Rpb24gPT09IFwicnRsXCIgPyBcInNlXCIgOiBcInN3XCI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLXNwZWNpYWwtY2hhcmFjdGVycy1uYXZpZ2F0aW9uXCJdfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3RoaXMubGFiZWxWaWV3LCB0aGlzLmdyb3VwRHJvcGRvd25WaWV3XVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IGN1cnJlbnRHcm91cE5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ncm91cERyb3Bkb3duVmlldy52YWx1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlR3JvdXBEcm9wZG93bih0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5sb2NhbGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IFdiKGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuX2dldENoYXJhY3Rlckdyb3VwTGlzdEl0ZW1EZWZpbml0aW9ucyhuLCB0KTtcclxuICAgICAgICAgICAgICAgIG4uc2V0KFwidmFsdWVcIiwgby5maXJzdC5tb2RlbC5sYWJlbCk7XHJcbiAgICAgICAgICAgICAgICBuLmJ1dHRvblZpZXcuYmluZChcImxhYmVsXCIpLnRvKG4sIFwidmFsdWVcIik7XHJcbiAgICAgICAgICAgICAgICBuLmJ1dHRvblZpZXcuc2V0KHtpc09uOiBmYWxzZSwgd2l0aFRleHQ6IHRydWUsIHRvb2x0aXA6IGkoXCJsZVwiKX0pO1xyXG4gICAgICAgICAgICAgICAgbi5vbihcImV4ZWN1dGVcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi52YWx1ZSA9IHQuc291cmNlLmxhYmVsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG4uZGVsZWdhdGUoXCJleGVjdXRlXCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgVWIobiwgbyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0Q2hhcmFjdGVyR3JvdXBMaXN0SXRlbURlZmluaXRpb25zKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgeXM7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB7dHlwZTogXCJidXR0b25cIiwgbW9kZWw6IG5ldyBlXyh7bGFiZWw6IG4sIHdpdGhUZXh0OiB0cnVlfSl9O1xyXG4gICAgICAgICAgICAgICAgICAgIGUubW9kZWwuYmluZChcImlzT25cIikudG8odCwgXCJ2YWx1ZVwiLCB0ID0+IHQgPT09IGUubW9kZWwubGFiZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYWRkKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZFAgPSBpKDg2KTtcclxuXHJcbiAgICAgICAgY2xhc3MgdVAgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aWxlcyA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1jaGFyYWN0ZXItZ3JpZF9fdGlsZXNcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogdGhpcy50aWxlc1xyXG4gICAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1jaGFyYWN0ZXItZ3JpZFwiXX1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNyZWF0ZVRpbGUodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBoYih0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBpLnNldCh7bGFiZWw6IHQsIHdpdGhUZXh0OiB0cnVlLCBjbGFzczogXCJjay1jaGFyYWN0ZXItZ3JpZF9fdGlsZVwifSk7XHJcbiAgICAgICAgICAgICAgICBpLmV4dGVuZFRlbXBsYXRlKHthdHRyaWJ1dGVzOiB7dGl0bGU6IGV9LCBvbjoge21vdXNlb3ZlcjogaS5iaW5kVGVtcGxhdGUudG8oXCJtb3VzZW92ZXJcIil9fSk7XHJcbiAgICAgICAgICAgICAgICBpLm9uKFwibW91c2VvdmVyXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJ0aWxlSG92ZXJcIiwge25hbWU6IGUsIGNoYXJhY3RlcjogdH0pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGkub24oXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJleGVjdXRlXCIsIHtuYW1lOiBlLCBjaGFyYWN0ZXI6IHR9KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaFAgPSBpKDg4KTtcclxuXHJcbiAgICAgICAgY2xhc3MgZlAgZXh0ZW5kcyBHcCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJjaGFyYWN0ZXJcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcIm5hbWVcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmQoXCJjb2RlXCIpLnRvKHRoaXMsIFwiY2hhcmFjdGVyXCIsIGdQKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiBcInNwYW5cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJjay1jaGFyYWN0ZXItaW5mb19fbmFtZVwiXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IGUudG8oXCJuYW1lXCIsIHQgPT4gdCA/IHQgOiBcIuKAi1wiKX1dXHJcbiAgICAgICAgICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrLWNoYXJhY3Rlci1pbmZvX19jb2RlXCJdfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt7dGV4dDogZS50byhcImNvZGVcIil9XVxyXG4gICAgICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1jaGFyYWN0ZXItaW5mb1wiXX1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdQKHQpIHtcclxuICAgICAgICAgICAgaWYgKHQgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuY29kZVBvaW50QXQoMCkudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgICAgICByZXR1cm4gXCJVK1wiICsgKFwiMDAwMFwiICsgZSkuc2xpY2UoLTQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbVAgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMTAgMi41YTcuNDcgNy40NyAwIDAgMSA0LjIzMSAxLjMxIDcuMjY4IDcuMjY4IDAgMCAxIDIuNzAzIDMuNDU0IDcuMTI4IDcuMTI4IDAgMCAxIC4xOTkgNC4zNTNjLS4zOSAxLjQzNi0xLjQ3NSAyLjcyLTIuNjMzIDMuNjc3aDIuMDEzYzAtLjIyNi4wOTItLjQ0My4yNTQtLjYwM2EuODc2Ljg3NiAwIDAgMSAxLjIyOSAwYy4xNjMuMTYuMjU0LjM3Ny4yNTQuNjAzdi44NTNjMCAuMjA5LS4wNzguNDEtLjIyLjU2N2EuODczLjg3MyAwIDAgMS0uNTQ3LjI4bC0uMTAxLjAwNmgtNC42OTVhLjUxNy41MTcgMCAwIDEtLjUxNi0uNTE4di0xLjI2NWMwLS4yMS4xMjgtLjM5OC4zMTctLjQ4OWE1LjYwMSA1LjYwMSAwIDAgMCAyLjQ5Mi0yLjM3MSA1LjQ1OSA1LjQ1OSAwIDAgMCAuNTUyLTMuNjkzIDUuNTMgNS41MyAwIDAgMC0xLjk1NS0zLjJBNS43MSA1LjcxIDAgMCAwIDEwIDQuMjA2IDUuNzA4IDUuNzA4IDAgMCAwIDYuNDE5IDUuNDYgNS41MjcgNS41MjcgMCAwIDAgNC40NiA4LjY2M2E1LjQ1NyA1LjQ1NyAwIDAgMCAuNTU0IDMuNjk1IDUuNiA1LjYgMCAwIDAgMi40OTcgMi4zNy41NS41NSAwIDAgMSAuMzE3LjQ5djEuMjY0YzAgLjI4Ni0uMjMuNTE4LS41MTYuNTE4SDIuNjE4YS44NzcuODc3IDAgMCAxLS42MTQtLjI1Ljg0NS44NDUgMCAwIDEtLjI1NC0uNjAzdi0uODUzYzAtLjIyNi4wOTEtLjQ0My4yNTQtLjYwM2EuODc2Ljg3NiAwIDAgMSAxLjIyOCAwYy4xNjMuMTYuMjU1LjM3Ny4yNTUuNjAzaDEuOTI1Yy0xLjE1OC0uOTU4LTIuMTU1LTIuMjQxLTIuNTQ1LTMuNjc4YTcuMTI4IDcuMTI4IDAgMCAxIC4xOTktNC4zNTIgNy4yNjggNy4yNjggMCAwIDEgMi43MDMtMy40NTVBNy40NzUgNy40NzUgMCAwIDEgMTAgMi41elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciBwUCA9IGkoOTApO1xyXG4gICAgICAgIGNvbnN0IGJQID0gXCLQktGB0LVcIjtcclxuXHJcbiAgICAgICAgY2xhc3Mgd1AgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2NQXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJTcGVjaWFsQ2hhcmFjdGVyc1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hhcmFjdGVycyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9ncm91cHMgPSBuZXcgTWFwXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuY29tbWFuZHMuZ2V0KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKFwic3BlY2lhbENoYXJhY3RlcnNcIiwgbiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IFdiKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCByO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYnV0dG9uVmlldy5zZXQoe2xhYmVsOiBlKFwiYlwiKSwgaWNvbjogbVAsIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc0VuYWJsZWRcIikudG8oaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5vbihcImV4ZWN1dGVcIiwgKGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKFwiaW5wdXRcIiwge3RleHQ6IGkuY2hhcmFjdGVyfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLm9uKFwiY2hhbmdlOmlzT3BlblwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IHRoaXMuX2NyZWF0ZURyb3Bkb3duUGFuZWxDb250ZW50KG4sIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5wYW5lbFZpZXcuY2hpbGRyZW4uYWRkKHIubmF2aWdhdGlvblZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5wYW5lbFZpZXcuY2hpbGRyZW4uYWRkKHIuZ3JpZFZpZXcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5wYW5lbFZpZXcuY2hpbGRyZW4uYWRkKHIuaW5mb1ZpZXcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgci5pbmZvVmlldy5zZXQoe2NoYXJhY3RlcjogbnVsbCwgbmFtZTogbnVsbH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFkZEl0ZW1zKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09PSBiUCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBzc1tcImJcIl0oYHNwZWNpYWwtY2hhcmFjdGVyLWludmFsaWQtZ3JvdXAtbmFtZTogVGhlIG5hbWUgXCIke2JQfVwiIGlzIHJlc2VydmVkIGFuZCBjYW5ub3QgYmUgdXNlZC5gKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2dldEdyb3VwKHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLmFkZCh0LnRpdGxlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGFyYWN0ZXJzLnNldCh0LnRpdGxlLCB0LmNoYXJhY3RlcilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0R3JvdXBzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dyb3Vwcy5rZXlzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hhcmFjdGVyc0Zvckdyb3VwKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0ID09PSBiUCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgU2V0KHRoaXMuX2NoYXJhY3RlcnMua2V5cygpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dyb3Vwcy5nZXQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2hhcmFjdGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGFyYWN0ZXJzLmdldCh0KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0R3JvdXAodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9ncm91cHMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZ3JvdXBzLnNldCh0LCBuZXcgU2V0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dyb3Vwcy5nZXQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3VwZGF0ZUdyaWQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgZS50aWxlcy5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZ2V0Q2hhcmFjdGVyc0Zvckdyb3VwKHQpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRDaGFyYWN0ZXIodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS50aWxlcy5hZGQoZS5jcmVhdGVUaWxlKGksIHQpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlRHJvcGRvd25QYW5lbENvbnRlbnQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFsuLi50aGlzLmdldEdyb3VwcygpXTtcclxuICAgICAgICAgICAgICAgIGkudW5zaGlmdChiUCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IGxQKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyB1UCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgZlAodCk7XHJcbiAgICAgICAgICAgICAgICBvLmRlbGVnYXRlKFwiZXhlY3V0ZVwiKS50byhlKTtcclxuICAgICAgICAgICAgICAgIG8ub24oXCJ0aWxlSG92ZXJcIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByLnNldChlKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBuLm9uKFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlR3JpZChuLmN1cnJlbnRHcm91cE5hbWUsIG8pXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZUdyaWQobi5jdXJyZW50R3JvdXBOYW1lLCBvKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7bmF2aWdhdGlvblZpZXc6IG4sIGdyaWRWaWV3OiBvLCBpbmZvVmlldzogcn1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3Mga1AgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgdC5wbHVnaW5zLmdldChcIlNwZWNpYWxDaGFyYWN0ZXJzXCIpLmFkZEl0ZW1zKFwi0JLQsNC70Y7RgtCwXCIsIFt7Y2hhcmFjdGVyOiBcIiRcIiwgdGl0bGU6IGUoXCJ1XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLigqxcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcInZcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwiwqVcIiwgdGl0bGU6IGUoXCJ3XCIpfSwge2NoYXJhY3RlcjogXCLCo1wiLCB0aXRsZTogZShcInhcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsKiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJ5XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKCoFwiLCB0aXRsZTogZShcInpcIil9LCB7Y2hhcmFjdGVyOiBcIuKCoVwiLCB0aXRsZTogZShcImFhXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLigqJcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImFiXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKCo1wiLCB0aXRsZTogZShcImFjXCIpfSwge2NoYXJhY3RlcjogXCLigqRcIiwgdGl0bGU6IGUoXCJhZFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwiwqRcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImFlXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKCv1wiLCB0aXRsZTogZShcImFmXCIpfSwge2NoYXJhY3RlcjogXCLigqVcIiwgdGl0bGU6IGUoXCJhZ1wiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oKmXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJhaFwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLigqdcIiwgdGl0bGU6IGUoXCJhaVwiKX0sIHtjaGFyYWN0ZXI6IFwi4oKoXCIsIHRpdGxlOiBlKFwiYWpcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKCqVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiYWtcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oKqXCIsIHRpdGxlOiBlKFwiYWxcIil9LCB7Y2hhcmFjdGVyOiBcIuKCq1wiLCB0aXRsZTogZShcImFtXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLigq1cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImFuXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKCrlwiLCB0aXRsZTogZShcImFvXCIpfSwge2NoYXJhY3RlcjogXCLigq9cIiwgdGl0bGU6IGUoXCJhcFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oKwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJhcVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLigrFcIiwgdGl0bGU6IGUoXCJhclwiKX0sIHtjaGFyYWN0ZXI6IFwi4oKyXCIsIHRpdGxlOiBlKFwiYXNcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKCs1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiYXRcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oK0XCIsIHRpdGxlOiBlKFwiYXVcIil9LCB7Y2hhcmFjdGVyOiBcIuKCtVwiLCB0aXRsZTogZShcImF2XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLigrZcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImF3XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKCt1wiLCB0aXRsZTogZShcImF4XCIpfSwge2NoYXJhY3RlcjogXCLigrhcIiwgdGl0bGU6IGUoXCJheVwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oK5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJhelwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLigrpcIiwgdGl0bGU6IGUoXCJiYVwiKX0sIHtjaGFyYWN0ZXI6IFwi4oK7XCIsIHRpdGxlOiBlKFwiYmJcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKCvFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiYmNcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oK9XCIsIHRpdGxlOiBlKFwiYmRcIil9XSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgX1AgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgdC5wbHVnaW5zLmdldChcIlNwZWNpYWxDaGFyYWN0ZXJzXCIpLmFkZEl0ZW1zKFwi0JzQsNGC0LXQvNCw0YLQuNGH0LXRgdC60LjQtVwiLCBbe1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCI8XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJnY1wiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCI+XCIsIHRpdGxlOiBlKFwiZ2RcIil9LCB7Y2hhcmFjdGVyOiBcIuKJpFwiLCB0aXRsZTogZShcImdlXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLiiaVcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImdmXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKAk1wiLCB0aXRsZTogZShcImdnXCIpfSwge2NoYXJhY3RlcjogXCLigJRcIiwgdGl0bGU6IGUoXCJnaFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwiwq9cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImdpXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKAvlwiLCB0aXRsZTogZShcImdqXCIpfSwge2NoYXJhY3RlcjogXCLCsFwiLCB0aXRsZTogZShcImdrXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLiiJJcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImdsXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsKxXCIsIHRpdGxlOiBlKFwiZ21cIil9LCB7Y2hhcmFjdGVyOiBcIsO3XCIsIHRpdGxlOiBlKFwiZ25cIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKBhFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZ29cIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwiw5dcIiwgdGl0bGU6IGUoXCJncFwiKX0sIHtjaGFyYWN0ZXI6IFwixpJcIiwgdGl0bGU6IGUoXCJncVwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oirXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJnclwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLiiJFcIiwgdGl0bGU6IGUoXCJnc1wiKX0sIHtjaGFyYWN0ZXI6IFwi4oieXCIsIHRpdGxlOiBlKFwiZ3RcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKImlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZ3VcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oi8XCIsIHRpdGxlOiBlKFwiZ3ZcIil9LCB7Y2hhcmFjdGVyOiBcIuKJhVwiLCB0aXRsZTogZShcImd3XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLiiYhcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImd4XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKJoFwiLCB0aXRsZTogZShcImd5XCIpfSwge2NoYXJhY3RlcjogXCLiiaFcIiwgdGl0bGU6IGUoXCJnelwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oiIXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJoYVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLiiIlcIiwgdGl0bGU6IGUoXCJoYlwiKX0sIHtjaGFyYWN0ZXI6IFwi4oiLXCIsIHRpdGxlOiBlKFwiaGNcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKIj1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiaGRcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oinXCIsIHRpdGxlOiBlKFwiaGVcIil9LCB7Y2hhcmFjdGVyOiBcIuKIqFwiLCB0aXRsZTogZShcImhmXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLCrFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiaGdcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oipXCIsIHRpdGxlOiBlKFwiaGhcIil9LCB7Y2hhcmFjdGVyOiBcIuKIqlwiLCB0aXRsZTogZShcImhpXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLiiIJcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImhqXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKIgFwiLCB0aXRsZTogZShcImhrXCIpfSwge2NoYXJhY3RlcjogXCLiiINcIiwgdGl0bGU6IGUoXCJobFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oiFXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJobVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLiiIdcIiwgdGl0bGU6IGUoXCJoblwiKX0sIHtjaGFyYWN0ZXI6IFwi4oiXXCIsIHRpdGxlOiBlKFwiaG9cIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKInVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiaHBcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oigXCIsIHRpdGxlOiBlKFwiaHFcIil9LCB7Y2hhcmFjdGVyOiBcIsK8XCIsIHRpdGxlOiBlKFwiaHJcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsK9XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJoc1wiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLCvlwiLCB0aXRsZTogZShcImh0XCIpfV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHZQIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHQucGx1Z2lucy5nZXQoXCJTcGVjaWFsQ2hhcmFjdGVyc1wiKS5hZGRJdGVtcyhcItCh0YLRgNC10LvQutC4XCIsIFt7dGl0bGU6IGUoXCJjXCIpLCBjaGFyYWN0ZXI6IFwi4oeQXCJ9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJkXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLih5JcIlxyXG4gICAgICAgICAgICAgICAgfSwge3RpdGxlOiBlKFwiZVwiKSwgY2hhcmFjdGVyOiBcIuKHkVwifSwge3RpdGxlOiBlKFwiZlwiKSwgY2hhcmFjdGVyOiBcIuKHk1wifSwge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZ1wiKSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oegXCJcclxuICAgICAgICAgICAgICAgIH0sIHt0aXRsZTogZShcImhcIiksIGNoYXJhY3RlcjogXCLih6JcIn0sIHt0aXRsZTogZShcImlcIiksIGNoYXJhY3RlcjogXCLih6FcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImpcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKHo1wiXHJcbiAgICAgICAgICAgICAgICB9LCB7dGl0bGU6IGUoXCJrXCIpLCBjaGFyYWN0ZXI6IFwi4oekXCJ9LCB7dGl0bGU6IGUoXCJsXCIpLCBjaGFyYWN0ZXI6IFwi4oelXCJ9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJtXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLipJJcIlxyXG4gICAgICAgICAgICAgICAgfSwge3RpdGxlOiBlKFwiblwiKSwgY2hhcmFjdGVyOiBcIuKkk1wifSwge3RpdGxlOiBlKFwib1wiKSwgY2hhcmFjdGVyOiBcIuKGqFwifSwge1xyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwicFwiKSxcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi8J+UmVwiXHJcbiAgICAgICAgICAgICAgICB9LCB7dGl0bGU6IGUoXCJxXCIpLCBjaGFyYWN0ZXI6IFwi8J+UmlwifSwge3RpdGxlOiBlKFwiclwiKSwgY2hhcmFjdGVyOiBcIvCflJtcIn0sIHtcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcInNcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIvCflJxcIlxyXG4gICAgICAgICAgICAgICAgfSwge3RpdGxlOiBlKFwidFwiKSwgY2hhcmFjdGVyOiBcIvCflJ1cIn1dKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB5UCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0LnBsdWdpbnMuZ2V0KFwiU3BlY2lhbENoYXJhY3RlcnNcIikuYWRkSXRlbXMoXCLQm9Cw0YLQuNC90YHQutC40LUg0YHQuNC80LLQvtC70YtcIiwgW3tcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixIBcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImJlXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsSBXCIsIHRpdGxlOiBlKFwiYmZcIil9LCB7Y2hhcmFjdGVyOiBcIsSCXCIsIHRpdGxlOiBlKFwiYmdcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsSDXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJiaFwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEhFwiLCB0aXRsZTogZShcImJpXCIpfSwge2NoYXJhY3RlcjogXCLEhVwiLCB0aXRsZTogZShcImJqXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEhlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiYmtcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixIdcIiwgdGl0bGU6IGUoXCJibFwiKX0sIHtjaGFyYWN0ZXI6IFwixIhcIiwgdGl0bGU6IGUoXCJibVwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixIlcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImJuXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsSKXCIsIHRpdGxlOiBlKFwiYm9cIil9LCB7Y2hhcmFjdGVyOiBcIsSLXCIsIHRpdGxlOiBlKFwiYnBcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsSMXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJicVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEjVwiLCB0aXRsZTogZShcImJyXCIpfSwge2NoYXJhY3RlcjogXCLEjlwiLCB0aXRsZTogZShcImJzXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEj1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiYnRcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixJBcIiwgdGl0bGU6IGUoXCJidVwiKX0sIHtjaGFyYWN0ZXI6IFwixJFcIiwgdGl0bGU6IGUoXCJidlwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixJJcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImJ3XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsSTXCIsIHRpdGxlOiBlKFwiYnhcIil9LCB7Y2hhcmFjdGVyOiBcIsSUXCIsIHRpdGxlOiBlKFwiYnlcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsSVXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJielwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEllwiLCB0aXRsZTogZShcImNhXCIpfSwge2NoYXJhY3RlcjogXCLEl1wiLCB0aXRsZTogZShcImNiXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEmFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiY2NcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixJlcIiwgdGl0bGU6IGUoXCJjZFwiKX0sIHtjaGFyYWN0ZXI6IFwixJpcIiwgdGl0bGU6IGUoXCJjZVwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixJtcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImNmXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsScXCIsIHRpdGxlOiBlKFwiY2dcIil9LCB7Y2hhcmFjdGVyOiBcIsSdXCIsIHRpdGxlOiBlKFwiY2hcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsSeXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJjaVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEn1wiLCB0aXRsZTogZShcImNqXCIpfSwge2NoYXJhY3RlcjogXCLEoFwiLCB0aXRsZTogZShcImNrXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEoVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiY2xcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixKJcIiwgdGl0bGU6IGUoXCJjbVwiKX0sIHtjaGFyYWN0ZXI6IFwixKNcIiwgdGl0bGU6IGUoXCJjblwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixKRcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImNvXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsSlXCIsIHRpdGxlOiBlKFwiY3BcIil9LCB7Y2hhcmFjdGVyOiBcIsSmXCIsIHRpdGxlOiBlKFwiY3FcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsSnXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJjclwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEqFwiLCB0aXRsZTogZShcImNzXCIpfSwge2NoYXJhY3RlcjogXCLEqVwiLCB0aXRsZTogZShcImN0XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEqlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiY3VcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixKtcIiwgdGl0bGU6IGUoXCJjdlwiKX0sIHtjaGFyYWN0ZXI6IFwixKxcIiwgdGl0bGU6IGUoXCJjd1wiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixK1cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImN4XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsSuXCIsIHRpdGxlOiBlKFwiY3lcIil9LCB7Y2hhcmFjdGVyOiBcIsSvXCIsIHRpdGxlOiBlKFwiY3pcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsSwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJkYVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEsVwiLCB0aXRsZTogZShcImRiXCIpfSwge2NoYXJhY3RlcjogXCLEslwiLCB0aXRsZTogZShcImRjXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEs1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZGRcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixLRcIiwgdGl0bGU6IGUoXCJkZVwiKX0sIHtjaGFyYWN0ZXI6IFwixLVcIiwgdGl0bGU6IGUoXCJkZlwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixLZcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImRnXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsS3XCIsIHRpdGxlOiBlKFwiZGhcIil9LCB7Y2hhcmFjdGVyOiBcIsS4XCIsIHRpdGxlOiBlKFwiZGlcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsS5XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJkalwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLEulwiLCB0aXRsZTogZShcImRrXCIpfSwge2NoYXJhY3RlcjogXCLEu1wiLCB0aXRsZTogZShcImRsXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLEvFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZG1cIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixL1cIiwgdGl0bGU6IGUoXCJkblwiKX0sIHtjaGFyYWN0ZXI6IFwixL5cIiwgdGl0bGU6IGUoXCJkb1wiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixL9cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImRwXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsWAXCIsIHRpdGxlOiBlKFwiZHFcIil9LCB7Y2hhcmFjdGVyOiBcIsWBXCIsIHRpdGxlOiBlKFwiZHJcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsWCXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJkc1wiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFg1wiLCB0aXRsZTogZShcImR0XCIpfSwge2NoYXJhY3RlcjogXCLFhFwiLCB0aXRsZTogZShcImR1XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFhVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZHZcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixYZcIiwgdGl0bGU6IGUoXCJkd1wiKX0sIHtjaGFyYWN0ZXI6IFwixYdcIiwgdGl0bGU6IGUoXCJkeFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixYhcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImR5XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsWJXCIsIHRpdGxlOiBlKFwiZHpcIil9LCB7Y2hhcmFjdGVyOiBcIsWKXCIsIHRpdGxlOiBlKFwiZWFcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsWLXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJlYlwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFjFwiLCB0aXRsZTogZShcImVjXCIpfSwge2NoYXJhY3RlcjogXCLFjVwiLCB0aXRsZTogZShcImVkXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFjlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZWVcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixY9cIiwgdGl0bGU6IGUoXCJlZlwiKX0sIHtjaGFyYWN0ZXI6IFwixZBcIiwgdGl0bGU6IGUoXCJlZ1wiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixZFcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImVoXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsWSXCIsIHRpdGxlOiBlKFwiZWlcIil9LCB7Y2hhcmFjdGVyOiBcIsWTXCIsIHRpdGxlOiBlKFwiZWpcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsWUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJla1wiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFlVwiLCB0aXRsZTogZShcImVsXCIpfSwge2NoYXJhY3RlcjogXCLFllwiLCB0aXRsZTogZShcImVtXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFl1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZW5cIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixZhcIiwgdGl0bGU6IGUoXCJlb1wiKX0sIHtjaGFyYWN0ZXI6IFwixZlcIiwgdGl0bGU6IGUoXCJlcFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixZpcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImVxXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsWbXCIsIHRpdGxlOiBlKFwiZXJcIil9LCB7Y2hhcmFjdGVyOiBcIsWcXCIsIHRpdGxlOiBlKFwiZXNcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsWdXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJldFwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFnlwiLCB0aXRsZTogZShcImV1XCIpfSwge2NoYXJhY3RlcjogXCLFn1wiLCB0aXRsZTogZShcImV2XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFoFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZXdcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixaFcIiwgdGl0bGU6IGUoXCJleFwiKX0sIHtjaGFyYWN0ZXI6IFwixaJcIiwgdGl0bGU6IGUoXCJleVwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixaNcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImV6XCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsWkXCIsIHRpdGxlOiBlKFwiZmFcIil9LCB7Y2hhcmFjdGVyOiBcIsWlXCIsIHRpdGxlOiBlKFwiZmJcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsWmXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJmY1wiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFp1wiLCB0aXRsZTogZShcImZkXCIpfSwge2NoYXJhY3RlcjogXCLFqFwiLCB0aXRsZTogZShcImZlXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFqVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZmZcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixapcIiwgdGl0bGU6IGUoXCJmZ1wiKX0sIHtjaGFyYWN0ZXI6IFwixatcIiwgdGl0bGU6IGUoXCJmaFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixaxcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImZpXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsWtXCIsIHRpdGxlOiBlKFwiZmpcIil9LCB7Y2hhcmFjdGVyOiBcIsWuXCIsIHRpdGxlOiBlKFwiZmtcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsWvXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJmbFwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFsFwiLCB0aXRsZTogZShcImZtXCIpfSwge2NoYXJhY3RlcjogXCLFsVwiLCB0aXRsZTogZShcImZuXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFslwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZm9cIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixbNcIiwgdGl0bGU6IGUoXCJmcFwiKX0sIHtjaGFyYWN0ZXI6IFwixbRcIiwgdGl0bGU6IGUoXCJmcVwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixbVcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImZyXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsW2XCIsIHRpdGxlOiBlKFwiZnNcIil9LCB7Y2hhcmFjdGVyOiBcIsW3XCIsIHRpdGxlOiBlKFwiZnRcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsW4XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJmdVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLFuVwiLCB0aXRsZTogZShcImZ2XCIpfSwge2NoYXJhY3RlcjogXCLFulwiLCB0aXRsZTogZShcImZ3XCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLFu1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiZnhcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwixbxcIiwgdGl0bGU6IGUoXCJmeVwiKX0sIHtjaGFyYWN0ZXI6IFwixb1cIiwgdGl0bGU6IGUoXCJmelwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwixb5cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImdhXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsW/XCIsIHRpdGxlOiBlKFwiZ2JcIil9XSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgeFAgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50O1xyXG4gICAgICAgICAgICAgICAgdC5wbHVnaW5zLmdldChcIlNwZWNpYWxDaGFyYWN0ZXJzXCIpLmFkZEl0ZW1zKFwi0KLQtdC60YHRgtC+0LLRi9C1INGB0LjQvNCy0L7Qu9GLXCIsIFt7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKAuVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiaHVcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oC6XCIsIHRpdGxlOiBlKFwiaHZcIil9LCB7Y2hhcmFjdGVyOiBcIsKrXCIsIHRpdGxlOiBlKFwiaHdcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsK7XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJoeFwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLigJhcIiwgdGl0bGU6IGUoXCJoeVwiKX0sIHtjaGFyYWN0ZXI6IFwi4oCZXCIsIHRpdGxlOiBlKFwiaHpcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKAnFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiaWFcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oCdXCIsIHRpdGxlOiBlKFwiaWJcIil9LCB7Y2hhcmFjdGVyOiBcIuKAmlwiLCB0aXRsZTogZShcImljXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLigJ5cIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImlkXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsKhXCIsIHRpdGxlOiBlKFwiaWVcIil9LCB7Y2hhcmFjdGVyOiBcIsK/XCIsIHRpdGxlOiBlKFwiaWZcIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIuKApVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBlKFwiaWdcIilcclxuICAgICAgICAgICAgICAgIH0sIHtjaGFyYWN0ZXI6IFwi4oCmXCIsIHRpdGxlOiBlKFwiaWhcIil9LCB7Y2hhcmFjdGVyOiBcIuKAoVwiLCB0aXRsZTogZShcImlpXCIpfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogXCLigLBcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImlqXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIuKAsVwiLCB0aXRsZTogZShcImlrXCIpfSwge2NoYXJhY3RlcjogXCLigLxcIiwgdGl0bGU6IGUoXCJpbFwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwi4oGIXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJpbVwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLigYlcIiwgdGl0bGU6IGUoXCJpblwiKX0sIHtjaGFyYWN0ZXI6IFwi4oGHXCIsIHRpdGxlOiBlKFwiaW9cIil9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBcIsKpXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGUoXCJpcFwiKVxyXG4gICAgICAgICAgICAgICAgfSwge2NoYXJhY3RlcjogXCLCrlwiLCB0aXRsZTogZShcImlxXCIpfSwge2NoYXJhY3RlcjogXCLihKJcIiwgdGl0bGU6IGUoXCJpclwiKX0sIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXI6IFwiwqdcIixcclxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogZShcImlzXCIpXHJcbiAgICAgICAgICAgICAgICB9LCB7Y2hhcmFjdGVyOiBcIsK2XCIsIHRpdGxlOiBlKFwiaXRcIil9LCB7Y2hhcmFjdGVyOiBcIuKBi1wiLCB0aXRsZTogZShcIml1XCIpfV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIENQIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrUCwgeFAsIF9QLCB2UCwgeVBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IEFQID0gXCJzdHJpa2V0aHJvdWdoXCI7XHJcblxyXG4gICAgICAgIGNsYXNzIFRQIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJTdHJpa2V0aHJvdWdoRWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5leHRlbmQoXCIkdGV4dFwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBBUH0pO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEuc2V0QXR0cmlidXRlUHJvcGVydGllcyhBUCwge2lzRm9ybWF0dGluZzogdHJ1ZSwgY29weU9uRW50ZXI6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5hdHRyaWJ1dGVUb0VsZW1lbnQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiBBUCxcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiBcInNcIixcclxuICAgICAgICAgICAgICAgICAgICB1cGNhc3RBbHNvOiBbXCJkZWxcIiwgXCJzdHJpa2VcIiwge3N0eWxlczoge1widGV4dC1kZWNvcmF0aW9uXCI6IFwibGluZS10aHJvdWdoXCJ9fV1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoQVAsIG5ldyB5ayh0LCBBUCkpO1xyXG4gICAgICAgICAgICAgICAgdC5rZXlzdHJva2VzLnNldChcIkNUUkwrU0hJRlQrWFwiLCBcInN0cmlrZXRocm91Z2hcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFBQID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTcgMTYuNGMtLjgtLjQtMS41LS45LTIuMi0xLjVhLjYuNiAwIDAgMS0uMi0uNWwuMy0uNmgxYzEgMS4yIDIuMSAxLjcgMy43IDEuNyAxIDAgMS44LS4zIDIuMy0uNi42LS40LjYtMS4yLjYtMS4zLjItMS4yLS45LTIuMS0uOS0yLjFoMi4xYy4zLjcuNCAxLjIuNCAxLjd2LjhsLS42IDEuMmMtLjYuOC0xLjEgMS0xLjYgMS4yYTYgNiAwIDAgMS0yLjQuNmMtMSAwLTEuOC0uMy0yLjUtLjZ6TTYuOCA5TDYgOC4zYy0uNC0uNS0uNS0uOC0uNS0xLjYgMC0uNy4xLTEuMy41LTEuOC40LS42IDEtMSAxLjYtMS4zYTYuMyA2LjMgMCAwIDEgNC43IDAgNCA0IDAgMCAxIDEuNyAxbC4zLjdjMCAuMS4yLjQtLjIuNy0uNC4yLS45LjEtMSAwYTMgMyAwIDAgMC0xLjItMWMtLjQtLjItMS0uMy0yLS40LS43IDAtMS40LjItMiAuNi0uOC42LTEgLjgtMSAxLjUgMCAuOC41IDEgMS4yIDEuNS42LjQgMS4xLjcgMS45IDFINi44elwiLz48cGF0aCBkPVwiTTMgMTAuNVY5aDE0djEuNXpcIi8+PC9zdmc+JztcclxuICAgICAgICBjb25zdCBTUCA9IFwic3RyaWtldGhyb3VnaFwiO1xyXG5cclxuICAgICAgICBjbGFzcyBFUCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKFNQLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb21tYW5kcy5nZXQoU1ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiBlKFwiamtcIiksIGljb246IFBQLCBrZXlzdHJva2U6IFwiQ1RSTCtTSElGVCtYXCIsIHRvb2x0aXA6IHRydWUsIGlzVG9nZ2xlYWJsZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYmluZChcImlzT25cIiwgXCJpc0VuYWJsZWRcIikudG8obiwgXCJ2YWx1ZVwiLCBcImlzRW5hYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG8sIFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY3V0ZShTUCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgUlAgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1RQLCBFUF1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiU3RyaWtldGhyb3VnaFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IE9QID0gXCJzdWJzY3JpcHRcIjtcclxuXHJcbiAgICAgICAgY2xhc3MgSVAgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlN1YnNjcmlwdEVkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEuZXh0ZW5kKFwiJHRleHRcIiwge2FsbG93QXR0cmlidXRlczogT1B9KTtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLnNldEF0dHJpYnV0ZVByb3BlcnRpZXMoT1AsIHtpc0Zvcm1hdHRpbmc6IHRydWUsIGNvcHlPbkVudGVyOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbnZlcnNpb24uYXR0cmlidXRlVG9FbGVtZW50KHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogT1AsXHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzogXCJzdWJcIixcclxuICAgICAgICAgICAgICAgICAgICB1cGNhc3RBbHNvOiBbe3N0eWxlczoge1widmVydGljYWwtYWxpZ25cIjogXCJzdWJcIn19XVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChPUCwgbmV3IHlrKHQsIE9QKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFZQID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTcuMDMgMTAuMzQ5bDMuODE4LTMuODE5YS44LjggMCAxIDEgMS4xMzIgMS4xMzJMOC4xNiAxMS40OGwzLjgxOSAzLjgxOGEuOC44IDAgMSAxLTEuMTMyIDEuMTMyTDcuMDMgMTIuNjFsLTMuODE4IDMuODJhLjguOCAwIDEgMS0xLjEzMi0xLjEzMkw1LjkgMTEuNDggMi4wOCA3LjY2MkEuOC44IDAgMSAxIDMuMjEyIDYuNTNsMy44MTggMy44MnptOC4xNDcgNy44MjloMi41NDljLjI1NCAwIC40NDcuMDUuNTguMTUyYS40OS40OSAwIDAgMSAuMjAxLjQxMy41NC41NCAwIDAgMS0uMTU5LjM5M2MtLjEwNS4xMDgtLjI2Ni4xNjItLjQ4LjE2MmgtMy41OTRjLS4yNDUgMC0uNDM1LS4wNjYtLjU3Mi0uMTk3YS42MjEuNjIxIDAgMCAxLS4yMDUtLjQ2M2MwLS4xMTQuMDQ0LS4yNjUuMTMyLS40NTNhMS42MiAxLjYyIDAgMCAxIC4yODgtLjQ0NGMuNDMzLS40MzYuODI0LS44MSAxLjE3Mi0xLjEyMi4zNDgtLjMxMi41OTctLjUxNy43NDctLjYxNS4yNjctLjE4My40OS0uMzY4LjY2Ny0uNTUzLjE3Ny0uMTg1LjMxMi0uMzc1LjQwNS0uNTcuMDkzLS4xOTQuMTM5LS4zODQuMTM5LS41N2ExLjAwOCAxLjAwOCAwIDAgMC0uNTU0LS45MTcgMS4xOTcgMS4xOTcgMCAwIDAtLjU2LS4xMzNjLS40MjYgMC0uNzYxLjE4Mi0xLjAwNS41NDZhMi4zMzIgMi4zMzIgMCAwIDAtLjE2NC4zOSAxLjYwOSAxLjYwOSAwIDAgMS0uMjU4LjQ4OGMtLjA5Ni4xMTQtLjIzNy4xNy0uNDIzLjE3YS41NTguNTU4IDAgMCAxLS40MDUtLjE1Ni41NjguNTY4IDAgMCAxLS4xNjEtLjQyN2MwLS4yMTguMDUtLjQ0Ni4xNTEtLjY4My4xMDEtLjIzOC4yNTItLjQ1My40NTItLjY0NnMuNDU0LS4zNDkuNzYyLS40NjdhMi45OTggMi45OTggMCAwIDEgMS4wODEtLjE3OGMuNDk4IDAgLjkyMy4wNzYgMS4yNzQuMjI4YTEuOTE2IDEuOTE2IDAgMCAxIDEuMDA0IDEuMDMyIDEuOTg0IDEuOTg0IDAgMCAxLS4xNTYgMS43OTRjLS4yLjMyLS40MDUuNTcyLS42MTMuNzU0LS4yMDguMTgyLS41NTguNDY4LTEuMDQ4Ljg1Ny0uNDkuMzktLjgyNi42OTEtMS4wMDguOTA2YTIuNzAzIDIuNzAzIDAgMCAwLS4yNC4zMDl6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgTlAgPSBcInN1YnNjcmlwdFwiO1xyXG5cclxuICAgICAgICBjbGFzcyBNUCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKE5QLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb21tYW5kcy5nZXQoTlApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiBlKFwiamxcIiksIGljb246IFZQLCB0b29sdGlwOiB0cnVlLCBpc1RvZ2dsZWFibGU6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc09uXCIsIFwiaXNFbmFibGVkXCIpLnRvKG4sIFwidmFsdWVcIiwgXCJpc0VuYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhvLCBcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoTlApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEJQIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtJUCwgTVBdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlN1YnNjcmlwdFwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHpQID0gXCJzdXBlcnNjcmlwdFwiO1xyXG5cclxuICAgICAgICBjbGFzcyBMUCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiU3VwZXJzY3JpcHRFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHQubW9kZWwuc2NoZW1hLmV4dGVuZChcIiR0ZXh0XCIsIHthbGxvd0F0dHJpYnV0ZXM6IHpQfSk7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5zZXRBdHRyaWJ1dGVQcm9wZXJ0aWVzKHpQLCB7aXNGb3JtYXR0aW5nOiB0cnVlLCBjb3B5T25FbnRlcjogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgdC5jb252ZXJzaW9uLmF0dHJpYnV0ZVRvRWxlbWVudCh7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHpQLFxyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IFwic3VwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdXBjYXN0QWxzbzogW3tzdHlsZXM6IHtcInZlcnRpY2FsLWFsaWduXCI6IFwic3VwZXJcIn19XVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZCh6UCwgbmV3IHlrKHQsIHpQKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEZQID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTE1LjY3NyA4LjY3OGgyLjU0OWMuMjU0IDAgLjQ0Ny4wNS41OC4xNTJhLjQ5LjQ5IDAgMCAxIC4yMDEuNDEzLjU0LjU0IDAgMCAxLS4xNTkuMzkzYy0uMTA1LjEwOC0uMjY2LjE2Mi0uNDguMTYyaC0zLjU5NGMtLjI0NSAwLS40MzUtLjA2Ni0uNTcyLS4xOTdhLjYyMS42MjEgMCAwIDEtLjIwNS0uNDYzYzAtLjExNC4wNDQtLjI2NS4xMzItLjQ1M2ExLjYyIDEuNjIgMCAwIDEgLjI4OC0uNDQ0Yy40MzMtLjQzNi44MjQtLjgxIDEuMTcyLTEuMTIyLjM0OC0uMzEyLjU5Ny0uNTE3Ljc0Ny0uNjE1LjI2Ny0uMTgzLjQ5LS4zNjguNjY3LS41NTMuMTc3LS4xODUuMzEyLS4zNzUuNDA1LS41Ny4wOTMtLjE5NC4xMzktLjM4NC4xMzktLjU3YTEuMDA4IDEuMDA4IDAgMCAwLS41NTQtLjkxNyAxLjE5NyAxLjE5NyAwIDAgMC0uNTYtLjEzM2MtLjQyNiAwLS43NjEuMTgyLTEuMDA1LjU0NmEyLjMzMiAyLjMzMiAwIDAgMC0uMTY0LjM5IDEuNjA5IDEuNjA5IDAgMCAxLS4yNTguNDg4Yy0uMDk2LjExNC0uMjM3LjE3LS40MjMuMTdhLjU1OC41NTggMCAwIDEtLjQwNS0uMTU2LjU2OC41NjggMCAwIDEtLjE2MS0uNDI3YzAtLjIxOC4wNS0uNDQ2LjE1MS0uNjgzLjEwMS0uMjM4LjI1Mi0uNDUzLjQ1Mi0uNjQ2cy40NTQtLjM0OS43NjItLjQ2N2EyLjk5OCAyLjk5OCAwIDAgMSAxLjA4MS0uMTc4Yy40OTggMCAuOTIzLjA3NiAxLjI3NC4yMjhhMS45MTYgMS45MTYgMCAwIDEgMS4wMDQgMS4wMzIgMS45ODQgMS45ODQgMCAwIDEtLjE1NiAxLjc5NGMtLjIuMzItLjQwNS41NzItLjYxMy43NTQtLjIwOC4xODItLjU1OC40NjgtMS4wNDguODU3LS40OS4zOS0uODI2LjY5MS0xLjAwOC45MDZhMi43MDMgMi43MDMgMCAwIDAtLjI0LjMwOXpNNy4wMyAxMC4zNDlsMy44MTgtMy44MTlhLjguOCAwIDEgMSAxLjEzMiAxLjEzMkw4LjE2IDExLjQ4bDMuODE5IDMuODE4YS44LjggMCAxIDEtMS4xMzIgMS4xMzJMNy4wMyAxMi42MWwtMy44MTggMy44MmEuOC44IDAgMSAxLTEuMTMyLTEuMTMyTDUuOSAxMS40OCAyLjA4IDcuNjYyQS44LjggMCAxIDEgMy4yMTIgNi41M2wzLjgxOCAzLjgyelwiLz48L3N2Zz4nO1xyXG4gICAgICAgIGNvbnN0IERQID0gXCJzdXBlcnNjcmlwdFwiO1xyXG5cclxuICAgICAgICBjbGFzcyBqUCBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKERQLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb21tYW5kcy5nZXQoRFApO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiBlKFwiam1cIiksIGljb246IEZQLCB0b29sdGlwOiB0cnVlLCBpc1RvZ2dsZWFibGU6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc09uXCIsIFwiaXNFbmFibGVkXCIpLnRvKG4sIFwidmFsdWVcIiwgXCJpc0VuYWJsZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhvLCBcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoRFApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEhQIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtMUCwgalBdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlN1cGVyc2NyaXB0XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gV1AodCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IGUucGFyZW50O1xyXG4gICAgICAgICAgICB3aGlsZSAoaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkubmFtZSA9PT0gdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpID0gaS5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcVAodCwgZSwgaSwgbiwgbyA9IDEpIHtcclxuICAgICAgICAgICAgaWYgKGUgPiBvKSB7XHJcbiAgICAgICAgICAgICAgICBuLnNldEF0dHJpYnV0ZSh0LCBlLCBpKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbi5yZW1vdmVBdHRyaWJ1dGUodCwgaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVVAodCwgZSwgaSA9IHt9KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZUNlbGxcIiwgaSk7XHJcbiAgICAgICAgICAgIHQuaW5zZXJ0RWxlbWVudChcInBhcmFncmFwaFwiLCBuKTtcclxuICAgICAgICAgICAgdC5pbnNlcnQobiwgZSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uICRQKHQpIHtcclxuICAgICAgICAgICAgaWYgKCF0IHx8ICFjdCh0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCB7dG9wOiBlLCByaWdodDogaSwgYm90dG9tOiBuLCBsZWZ0OiBvfSA9IHQ7XHJcbiAgICAgICAgICAgIGlmIChlID09IGkgJiYgaSA9PSBuICYmIG4gPT0gbykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gR1AodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gcGFyc2VGbG9hdCh0KTtcclxuICAgICAgICAgICAgaWYgKE51bWJlci5pc05hTihpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoU3RyaW5nKGkpICE9PSBTdHJpbmcodCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGAke2l9JHtlfWBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtQKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IGUucGFyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHBhcnNlSW50KGkuZ2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIikgfHwgMCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHtjb2x1bW46IG99ID0gdC5nZXRDZWxsTG9jYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHJldHVybiAhIW4gJiYgbyA8IG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEpQKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCA9PiB7XHJcbiAgICAgICAgICAgICAgICB0Lm9uKFwiZWxlbWVudDp0YWJsZVwiLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLnZpZXdJdGVtO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaS5jb25zdW1hYmxlLnRlc3Qobiwge25hbWU6IHRydWV9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qge3Jvd3M6IG8sIGhlYWRpbmdSb3dzOiByLCBoZWFkaW5nQ29sdW1uczogc30gPSBRUChuKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5oZWFkaW5nQ29sdW1ucyA9IHNcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5oZWFkaW5nUm93cyA9IHJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IGkud3JpdGVyLmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZVwiLCBhKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsID0gaS5zcGxpdFRvQWxsb3dlZFBhcmVudChjLCBlLm1vZGVsQ3Vyc29yKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGkud3JpdGVyLmluc2VydChjLCBsLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBpLmNvbnN1bWFibGUuY29uc3VtZShuLCB7bmFtZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLmZvckVhY2godCA9PiBpLmNvbnZlcnRJdGVtKHQsIGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQoYywgXCJlbmRcIikpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLndyaXRlci5jcmVhdGVFbGVtZW50KFwidGFibGVSb3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkud3JpdGVyLmluc2VydCh0LCBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KGMsIFwiZW5kXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgVVAoaS53cml0ZXIsIGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQodCwgXCJlbmRcIikpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGUubW9kZWxSYW5nZSA9IGkud3JpdGVyLmNyZWF0ZVJhbmdlKGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKGMpLCBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkFmdGVyKGMpKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobC5jdXJzb3JQYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5tb2RlbEN1cnNvciA9IGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQobC5jdXJzb3JQYXJlbnQsIDApXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5tb2RlbEN1cnNvciA9IGUubW9kZWxSYW5nZS5lbmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBZUCh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IHtcclxuICAgICAgICAgICAgICAgIGUub24oYGVsZW1lbnQ6JHt0fWAsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGUudmlld0l0ZW07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpLmNvbnN1bWFibGUudGVzdChuLCB7bmFtZTogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gaS53cml0ZXIuY3JlYXRlRWxlbWVudChcInRhYmxlQ2VsbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gaS5zcGxpdFRvQWxsb3dlZFBhcmVudChvLCBlLm1vZGVsQ3Vyc29yKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGkud3JpdGVyLmluc2VydChvLCByLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICBpLmNvbnN1bWFibGUuY29uc3VtZShuLCB7bmFtZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBpLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KG8sIDApO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuY29udmVydENoaWxkcmVuKG4sIHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghby5jaGlsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkud3JpdGVyLmluc2VydEVsZW1lbnQoXCJwYXJhZ3JhcGhcIiwgcylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZS5tb2RlbFJhbmdlID0gaS53cml0ZXIuY3JlYXRlUmFuZ2UoaS53cml0ZXIuY3JlYXRlUG9zaXRpb25CZWZvcmUobyksIGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIobykpO1xyXG4gICAgICAgICAgICAgICAgICAgIGUubW9kZWxDdXJzb3IgPSBlLm1vZGVsUmFuZ2UuZW5kXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBRUCh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB7aGVhZGluZ1Jvd3M6IDAsIGhlYWRpbmdDb2x1bW5zOiAwfTtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gW107XHJcbiAgICAgICAgICAgIGxldCBvO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHIgb2YgQXJyYXkuZnJvbSh0LmdldENoaWxkcmVuKCkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoci5uYW1lID09PSBcInRib2R5XCIgfHwgci5uYW1lID09PSBcInRoZWFkXCIgfHwgci5uYW1lID09PSBcInRmb290XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoci5uYW1lID09PSBcInRoZWFkXCIgJiYgIW8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IHJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IEFycmF5LmZyb20oci5nZXRDaGlsZHJlbigpKS5maWx0ZXIodCA9PiB0LmlzKFwiZWxlbWVudFwiLCBcInRyXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHIgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoci5wYXJlbnQubmFtZSA9PT0gXCJ0aGVhZFwiICYmIHIucGFyZW50ID09PSBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLmhlYWRpbmdSb3dzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gocilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ucHVzaChyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBYUChyLCBlLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID4gZS5oZWFkaW5nQ29sdW1ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuaGVhZGluZ0NvbHVtbnMgPSB0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZS5yb3dzID0gWy4uLmksIC4uLm5dO1xyXG4gICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWFAodCkge1xyXG4gICAgICAgICAgICBsZXQgZSA9IDA7XHJcbiAgICAgICAgICAgIGxldCBpID0gMDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IEFycmF5LmZyb20odC5nZXRDaGlsZHJlbigpKS5maWx0ZXIodCA9PiB0Lm5hbWUgPT09IFwidGhcIiB8fCB0Lm5hbWUgPT09IFwidGRcIik7XHJcbiAgICAgICAgICAgIHdoaWxlIChpIDwgbi5sZW5ndGggJiYgbltpXS5uYW1lID09PSBcInRoXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuW2ldO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwiY29sc3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgIGUgPSBlICsgbztcclxuICAgICAgICAgICAgICAgIGkrK1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBaUCB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YWJsZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0Um93ID0gZS5zdGFydFJvdyB8fCAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmRSb3cgPSB0eXBlb2YgZS5lbmRSb3cgPT0gXCJudW1iZXJcIiA/IGUuZW5kUm93IDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbmNsdWRlU3Bhbm5lZCA9ICEhZS5pbmNsdWRlU3Bhbm5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29sdW1uID0gdHlwZW9mIGUuY29sdW1uID09IFwibnVtYmVyXCIgPyBlLmNvbHVtbiA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NraXBSb3dzID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JvdyA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jb2x1bW4gPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2VsbEluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NwYW5uZWRDZWxscyA9IG5ldyBNYXA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9uZXh0Q2VsbEF0Q29sdW1uID0gLTFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBuZXh0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMudGFibGUuZ2V0Q2hpbGQodGhpcy5fcm93KTtcclxuICAgICAgICAgICAgICAgIGlmICghdCB8fCB0aGlzLl9pc092ZXJFbmRSb3coKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7ZG9uZTogdHJ1ZX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCBlLCBpLCBuO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzU3Bhbm5lZCh0aGlzLl9yb3csIHRoaXMuX2NvbHVtbikpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gdGhpcy5fZ2V0U3Bhbm5lZCh0aGlzLl9yb3csIHRoaXMuX2NvbHVtbik7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9ICF0aGlzLmluY2x1ZGVTcGFubmVkIHx8IHRoaXMuX3Nob3VsZFNraXBSb3coKSB8fCB0aGlzLl9zaG91bGRTa2lwQ29sdW1uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IHRoaXMuX2Zvcm1hdE91dFZhbHVlKGUsIHRoaXMuX2NvbHVtbiwgdHJ1ZSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IHQuZ2V0Q2hpbGQodGhpcy5fY2VsbEluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcm93Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbHVtbiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NlbGxJbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX25leHRDZWxsQXRDb2x1bW4gPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubmV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBwYXJzZUludChlLmdldEF0dHJpYnV0ZShcImNvbHNwYW5cIikgfHwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHBhcnNlSW50KGUuZ2V0QXR0cmlidXRlKFwicm93c3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobyA+IDEgfHwgciA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVjb3JkU3BhbnModGhpcy5fcm93LCB0aGlzLl9jb2x1bW4sIHIsIG8sIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX25leHRDZWxsQXRDb2x1bW4gPSB0aGlzLl9jb2x1bW4gKyBvO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLl9zaG91bGRTa2lwUm93KCkgfHwgdGhpcy5fc2hvdWxkU2tpcENvbHVtbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLl9mb3JtYXRPdXRWYWx1ZShlLCB0aGlzLl9jb2x1bW4sIGZhbHNlLCByLCBvKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29sdW1uKys7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY29sdW1uID09IHRoaXMuX25leHRDZWxsQXRDb2x1bW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jZWxsSW5kZXgrK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgPyB0aGlzLm5leHQoKSA6IG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2tpcFJvdyh0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9za2lwUm93cy5hZGQodClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2lzT3ZlckVuZFJvdygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVuZFJvdyAhPT0gdW5kZWZpbmVkICYmIHRoaXMuX3JvdyA+IHRoaXMuZW5kUm93XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9mb3JtYXRPdXRWYWx1ZSh0LCBlLCBpLCBuID0gMSwgbyA9IDEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbDogdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm93OiB0aGlzLl9yb3csXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNTcGFubmVkOiBpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dzcGFuOiBuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xzcGFuOiBvLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsSW5kZXg6IHRoaXMuX2NlbGxJbmRleFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3Nob3VsZFNraXBSb3coKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fcm93IDwgdGhpcy5zdGFydFJvdztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLl9za2lwUm93cy5oYXModGhpcy5fcm93KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0IHx8IGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3Nob3VsZFNraXBDb2x1bW4oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2x1bW4gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29sdW1uICE9IHRoaXMuX2NvbHVtblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaXNTcGFubmVkKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc3Bhbm5lZENlbGxzLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3NwYW5uZWRDZWxscy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaS5oYXMoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFNwYW5uZWQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NwYW5uZWRDZWxscy5nZXQodCkuZ2V0KGUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9yZWNvcmRTcGFucyh0LCBlLCBpLCBuLCBvKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gZSArIDE7IGkgPD0gZSArIG4gLSAxOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrU3Bhbm5lZENlbGwodCwgaSwgbylcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHIgPSB0ICsgMTsgciA8IHQgKyBpOyByKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gZTsgdCA8PSBlICsgbiAtIDE7IHQrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tYXJrU3Bhbm5lZENlbGwociwgdCwgbylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9tYXJrU3Bhbm5lZENlbGwodCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9zcGFubmVkQ2VsbHMuaGFzKHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Bhbm5lZENlbGxzLnNldCh0LCBuZXcgTWFwKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuX3NwYW5uZWRDZWxscy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICBuLnNldChlLCBpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0Uyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGUuc2V0Q3VzdG9tUHJvcGVydHkoXCJ0YWJsZVwiLCB0cnVlLCB0KTtcclxuICAgICAgICAgICAgcmV0dXJuIFhfKHQsIGUsIHtoYXNTZWxlY3Rpb25IYW5kbGU6IHRydWV9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZVModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISF0LmdldEN1c3RvbVByb3BlcnR5KFwidGFibGVcIikgJiYgUV8odClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlTKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIGlmIChlICYmIGVTKGUpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBuUyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBXUChcInRhYmxlXCIsIHQuZ2V0Rmlyc3RQb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgaWYgKGUgJiYgZVMoZS5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5wYXJlbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb1ModCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBhUyh0LmdldFJhbmdlcygpKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGkuZ2V0Q29udGFpbmVkRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQgJiYgdC5pcyhcInRhYmxlQ2VsbFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByUyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQuZ2V0UmFuZ2VzKCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBXUChcInRhYmxlQ2VsbFwiLCBpLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wdXNoKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNTKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IG9TKHQpO1xyXG4gICAgICAgICAgICBpZiAoZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJTKHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBhUyh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5mcm9tKHQpLnNvcnQoY1MpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjUyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnN0YXJ0O1xyXG4gICAgICAgICAgICBjb25zdCBuID0gZS5zdGFydDtcclxuICAgICAgICAgICAgaWYgKGkuaXNFcXVhbChuKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaS5pc0JlZm9yZShuKSA/IC0xIDogMVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbFModCA9IHt9KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IGUub24oXCJpbnNlcnQ6dGFibGVcIiwgKGUsIGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLml0ZW07XHJcbiAgICAgICAgICAgICAgICBpZiAoIW4uY29uc3VtYWJsZS5jb25zdW1lKG8sIFwiaW5zZXJ0XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBuLmNvbnN1bWFibGUuY29uc3VtZShvLCBcImF0dHJpYnV0ZTpoZWFkaW5nUm93czp0YWJsZVwiKTtcclxuICAgICAgICAgICAgICAgIG4uY29uc3VtYWJsZS5jb25zdW1lKG8sIFwiYXR0cmlidXRlOmhlYWRpbmdDb2x1bW5zOnRhYmxlXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHQgJiYgdC5hc1dpZGdldDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuLndyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KFwiZmlndXJlXCIsIHtjbGFzczogXCJ0YWJsZVwifSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gbi53cml0ZXIuY3JlYXRlQ29udGFpbmVyRWxlbWVudChcInRhYmxlXCIpO1xyXG4gICAgICAgICAgICAgICAgbi53cml0ZXIuaW5zZXJ0KG4ud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQocywgMCksIGEpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGM7XHJcbiAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGMgPSB0UyhzLCBuLndyaXRlcilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBuZXcgWlAobyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRpbmdSb3dzOiBvLmdldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIpIHx8IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZ0NvbHVtbnM6IG8uZ2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIikgfHwgMFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB7cm93OiBpLCBjZWxsOiByfSA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHZTKF9TKGksIGQpLCBhLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gby5nZXRDaGlsZChpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsID0gdS5nZXQoaSkgfHwgd1MoYywgaSwgcywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgdS5zZXQoaSwgbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5jb25zdW1hYmxlLmNvbnN1bWUociwgXCJpbnNlcnRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaCA9IG4ud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQobCwgXCJlbmRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgYlMoZSwgZCwgaCwgbiwgdClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGggPSBuLm1hcHBlci50b1ZpZXdQb3NpdGlvbihpLnJhbmdlLnN0YXJ0KTtcclxuICAgICAgICAgICAgICAgIG4ubWFwcGVyLmJpbmRFbGVtZW50cyhvLCByID8gYyA6IHMpO1xyXG4gICAgICAgICAgICAgICAgbi53cml0ZXIuaW5zZXJ0KGgsIHIgPyBjIDogcylcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRTKHQgPSB7fSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiBlLm9uKFwiaW5zZXJ0OnRhYmxlUm93XCIsIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5pdGVtO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnN1bWFibGUuY29uc3VtZShvLCBcImluc2VydFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG8ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG4ubWFwcGVyLnRvVmlld0VsZW1lbnQocik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gVFMocyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gci5nZXRDaGlsZEluZGV4KG8pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IG5ldyBaUChyLCB7c3RhcnRSb3c6IGMsIGVuZFJvdzogY30pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBoZWFkaW5nUm93czogci5nZXRBdHRyaWJ1dGUoXCJoZWFkaW5nUm93c1wiKSB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRpbmdDb2x1bW5zOiByLmdldEF0dHJpYnV0ZShcImhlYWRpbmdDb2x1bW5zXCIpIHx8IDBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBjb25zdCB1ID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHZTKF9TKGMsIGQpLCBhLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gdS5nZXQoYykgfHwgd1MobywgYywgaSwgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgdS5zZXQoYywgcik7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5jb25zdW1hYmxlLmNvbnN1bWUoZS5jZWxsLCBcImluc2VydFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbi53cml0ZXIuY3JlYXRlUG9zaXRpb25BdChyLCBcImVuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBiUyhlLCBkLCBzLCBuLCB0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdVModCA9IHt9KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IGUub24oXCJpbnNlcnQ6dGFibGVDZWxsXCIsIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5pdGVtO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnN1bWFibGUuY29uc3VtZShvLCBcImluc2VydFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG8ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHIucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IHMuZ2V0Q2hpbGRJbmRleChyKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBuZXcgWlAocywge3N0YXJ0Um93OiBhLCBlbmRSb3c6IGF9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGwgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZ1Jvd3M6IHMuZ2V0QXR0cmlidXRlKFwiaGVhZGluZ1Jvd3NcIikgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkaW5nQ29sdW1uczogcy5nZXRBdHRyaWJ1dGUoXCJoZWFkaW5nQ29sdW1uc1wiKSB8fCAwXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5jZWxsID09PSBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuLm1hcHBlci50b1ZpZXdFbGVtZW50KHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbi53cml0ZXIuY3JlYXRlUG9zaXRpb25BdChpLCByLmdldENoaWxkSW5kZXgobykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiUyhlLCBsLCBzLCBuLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaFModCA9IHt9KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSAhIXQuYXNXaWRnZXQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0ID0+IHQub24oXCJhdHRyaWJ1dGU6aGVhZGluZ1Jvd3M6dGFibGVcIiwgKHQsIGksIG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLml0ZW07XHJcbiAgICAgICAgICAgICAgICBpZiAoIW4uY29uc3VtYWJsZS5jb25zdW1lKGkuaXRlbSwgdC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4ubWFwcGVyLnRvVmlld0VsZW1lbnQobyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gVFMocik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gaS5hdHRyaWJ1dGVPbGRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBpLmF0dHJpYnV0ZU5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgaWYgKGMgPiBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IEFycmF5LmZyb20oby5nZXRDaGlsZHJlbigpKS5maWx0ZXIoKHtpbmRleDogdH0pID0+IGwodCwgYSAtIDEsIGMpKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdlMoXCJ0aGVhZFwiLCBzLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBBUyh0LCBpLCBuLCBcImVuZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgaS5nZXRDaGlsZHJlbigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtUyh0LCBcInRoXCIsIG4sIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgQ1MoXCJ0Ym9keVwiLCBzLCBuKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gQXJyYXkuZnJvbShvLmdldENoaWxkcmVuKCkpLmZpbHRlcigoe2luZGV4OiB0fSkgPT4gbCh0LCBjIC0gMSwgYSkpLnJldmVyc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdlMoXCJ0Ym9keVwiLCBzLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBBUyh0LCBpLCBuLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFpQKG8sIHtzdGFydFJvdzogYyA/IGMgLSAxIDogYywgZW5kUm93OiBhIC0gMX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRpbmdSb3dzOiBvLmdldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIpIHx8IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRpbmdDb2x1bW5zOiBvLmdldEF0dHJpYnV0ZShcImhlYWRpbmdDb2x1bW5zXCIpIHx8IDBcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBTKHQsIGQsIG4sIGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIENTKFwidGhlYWRcIiwgcywgbilcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBsKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCA+IGUgJiYgdCA8IGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZTKHQgPSB7fSkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gISF0LmFzV2lkZ2V0O1xyXG4gICAgICAgICAgICByZXR1cm4gdCA9PiB0Lm9uKFwiYXR0cmlidXRlOmhlYWRpbmdDb2x1bW5zOnRhYmxlXCIsICh0LCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaS5pdGVtO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmNvbnN1bWFibGUuY29uc3VtZShpLml0ZW0sIHQubmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGluZ1Jvd3M6IG8uZ2V0QXR0cmlidXRlKFwiaGVhZGluZ1Jvd3NcIikgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkaW5nQ29sdW1uczogby5nZXRBdHRyaWJ1dGUoXCJoZWFkaW5nQ29sdW1uc1wiKSB8fCAwXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGkuYXR0cmlidXRlT2xkVmFsdWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gaS5hdHRyaWJ1dGVOZXdWYWx1ZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSAocyA+IGEgPyBzIDogYSkgLSAxO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG5ldyBaUChvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0LmNvbHVtbiA+IGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcFModCwgciwgbiwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdTKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCA9PiB0Lm9uKFwicmVtb3ZlOnRhYmxlUm93XCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0LnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLndyaXRlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLm1hcHBlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBvLnRvVmlld1Bvc2l0aW9uKGUucG9zaXRpb24pLmdldExhc3RNYXRjaGluZ1Bvc2l0aW9uKHQgPT4gIXQuaXRlbS5pcyhcInRyXCIpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSByLm5vZGVBZnRlcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBuLmNyZWF0ZVJhbmdlT24ocyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gbi5yZW1vdmUoYyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi5jcmVhdGVSYW5nZUluKGwpLmdldEl0ZW1zKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBvLnVuYmluZFZpZXdFbGVtZW50KHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIWEuY2hpbGRDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4ucmVtb3ZlKG4uY3JlYXRlUmFuZ2VPbihhKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImhpZ2hlclwifSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1TKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGkud3JpdGVyO1xyXG4gICAgICAgICAgICBjb25zdCByID0gaS5tYXBwZXIudG9WaWV3RWxlbWVudCh0KTtcclxuICAgICAgICAgICAgaWYgKCFyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgcztcclxuICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBvLmNyZWF0ZUVkaXRhYmxlRWxlbWVudChlLCByLmdldEF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBzID0gaXYodCwgbyk7XHJcbiAgICAgICAgICAgICAgICBvLmluc2VydChvLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIociksIHMpO1xyXG4gICAgICAgICAgICAgICAgby5tb3ZlKG8uY3JlYXRlUmFuZ2VJbihyKSwgby5jcmVhdGVQb3NpdGlvbkF0KHMsIDApKTtcclxuICAgICAgICAgICAgICAgIG8ucmVtb3ZlKG8uY3JlYXRlUmFuZ2VPbihyKSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHMgPSBvLnJlbmFtZShlLCByKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkubWFwcGVyLnVuYmluZFZpZXdFbGVtZW50KHIpO1xyXG4gICAgICAgICAgICBpLm1hcHBlci5iaW5kRWxlbWVudHModCwgcylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHBTKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3Qge2NlbGw6IG99ID0gdDtcclxuICAgICAgICAgICAgY29uc3QgciA9IGtTKHQsIGUpO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gaS5tYXBwZXIudG9WaWV3RWxlbWVudChvKTtcclxuICAgICAgICAgICAgaWYgKHMgJiYgcy5uYW1lICE9PSByKSB7XHJcbiAgICAgICAgICAgICAgICBtUyhvLCByLCBpLCBuKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBiUyh0LCBlLCBpLCBuLCBvKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBvICYmIG8uYXNXaWRnZXQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSBrUyh0LCBlKTtcclxuICAgICAgICAgICAgY29uc3QgYSA9IHIgPyBpdihuLndyaXRlci5jcmVhdGVFZGl0YWJsZUVsZW1lbnQocyksIG4ud3JpdGVyKSA6IG4ud3JpdGVyLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQocyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSB0LmNlbGw7XHJcbiAgICAgICAgICAgIGNvbnN0IGwgPSBjLmdldENoaWxkKDApO1xyXG4gICAgICAgICAgICBjb25zdCBkID0gYy5jaGlsZENvdW50ID09PSAxICYmIGwubmFtZSA9PT0gXCJwYXJhZ3JhcGhcIjtcclxuICAgICAgICAgICAgbi53cml0ZXIuaW5zZXJ0KGksIGEpO1xyXG4gICAgICAgICAgICBpZiAoZCAmJiAhUFMobCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBjLmdldENoaWxkKDApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG4ud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQoYSwgXCJlbmRcIik7XHJcbiAgICAgICAgICAgICAgICBuLmNvbnN1bWFibGUuY29uc3VtZSh0LCBcImluc2VydFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChvLmFzV2lkZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG4ud3JpdGVyLmNyZWF0ZUNvbnRhaW5lckVsZW1lbnQoXCJzcGFuXCIsIHtzdHlsZTogXCJkaXNwbGF5OmlubGluZS1ibG9ja1wifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5tYXBwZXIuYmluZEVsZW1lbnRzKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4ud3JpdGVyLmluc2VydChlLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICBuLm1hcHBlci5iaW5kRWxlbWVudHMoYywgYSlcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5tYXBwZXIuYmluZEVsZW1lbnRzKGMsIGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4ubWFwcGVyLmJpbmRFbGVtZW50cyh0LCBhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbi5tYXBwZXIuYmluZEVsZW1lbnRzKGMsIGEpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHdTKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgbi5jb25zdW1hYmxlLmNvbnN1bWUodCwgXCJpbnNlcnRcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuLndyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KFwidHJcIik7XHJcbiAgICAgICAgICAgIG4ubWFwcGVyLmJpbmRFbGVtZW50cyh0LCBvKTtcclxuICAgICAgICAgICAgY29uc3QgciA9IHQucGFyZW50LmdldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIpIHx8IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSByID4gMCAmJiBlID49IHIgPyBlIC0gciA6IGU7XHJcbiAgICAgICAgICAgIGNvbnN0IGEgPSBuLndyaXRlci5jcmVhdGVQb3NpdGlvbkF0KGksIHMpO1xyXG4gICAgICAgICAgICBuLndyaXRlci5pbnNlcnQoYSwgbyk7XHJcbiAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBrUyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHtyb3c6IGksIGNvbHVtbjogbn0gPSB0O1xyXG4gICAgICAgICAgICBjb25zdCB7aGVhZGluZ0NvbHVtbnM6IG8sIGhlYWRpbmdSb3dzOiByfSA9IGU7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSByICYmIHIgPiBpO1xyXG4gICAgICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidGhcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGEgPSBvICYmIG8gPiBuO1xyXG4gICAgICAgICAgICByZXR1cm4gYSA/IFwidGhcIiA6IFwidGRcIlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX1ModCwgZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdCA8IGUuaGVhZGluZ1Jvd3MgPyBcInRoZWFkXCIgOiBcInRib2R5XCJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHZTKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHlTKHQsIGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbiA/IG4gOiB4Uyh0LCBlLCBpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24geVModCwgZSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgZS5nZXRDaGlsZHJlbigpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5uYW1lID09IHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB4Uyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpLndyaXRlci5jcmVhdGVDb250YWluZXJFbGVtZW50KHQpO1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaS53cml0ZXIuY3JlYXRlUG9zaXRpb25BdChlLCB0ID09IFwidGJvZHlcIiA/IFwiZW5kXCIgOiAwKTtcclxuICAgICAgICAgICAgaS53cml0ZXIuaW5zZXJ0KG8sIG4pO1xyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQ1ModCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0geVModCwgZSk7XHJcbiAgICAgICAgICAgIGlmIChuICYmIG4uY2hpbGRDb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgaS53cml0ZXIucmVtb3ZlKGkud3JpdGVyLmNyZWF0ZVJhbmdlT24obikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEFTKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBvIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBpLm1hcHBlci50b1ZpZXdFbGVtZW50KG8pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLndyaXRlci5tb3ZlKGkud3JpdGVyLmNyZWF0ZVJhbmdlT24odCksIGkud3JpdGVyLmNyZWF0ZVBvc2l0aW9uQXQoZSwgbikpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFRTKHQpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUubmFtZSA9PT0gXCJ0YWJsZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUFModCkge1xyXG4gICAgICAgICAgICByZXR1cm4gISFbLi4udC5nZXRBdHRyaWJ1dGVLZXlzKCldLmxlbmd0aFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgU1MgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5zY2hlbWE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gRVMoZS5nZXRGaXJzdFBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSBpLmNoZWNrQ2hpbGQobiwgXCJ0YWJsZVwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVVdGlsc1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBwYXJzZUludCh0LnJvd3MpIHx8IDI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gcGFyc2VJbnQodC5jb2x1bW5zKSB8fCAyO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG52KGksIGUpO1xyXG4gICAgICAgICAgICAgICAgZS5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG4uY3JlYXRlVGFibGUodCwgbywgcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5pbnNlcnRDb250ZW50KGksIHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKHQuY3JlYXRlUG9zaXRpb25BdChpLmdldE5vZGVCeVBhdGgoWzAsIDAsIDBdKSwgMCkpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBFUyh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPT09IGUucm9vdCA/IGUgOiBlLnBhcmVudFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgUlMgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yZGVyID0gZS5vcmRlciB8fCBcImJlbG93XCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gV1AoXCJ0YWJsZVwiLCB0LmdldEZpcnN0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9ICEhZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGx1Z2lucy5nZXQoXCJUYWJsZVV0aWxzXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMub3JkZXIgPT09IFwiYWJvdmVcIjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuID8gZS5nZXRGaXJzdFBvc2l0aW9uKCkgOiBlLmdldExhc3RQb3NpdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4gPyBlLmdldEZpcnN0UmFuZ2UoKSA6IGUuZ2V0TGFzdFJhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gci5nZXRDb250YWluZWRFbGVtZW50KCkgfHwgV1AoXCJ0YWJsZUNlbGxcIiwgbyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gcy5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gYS5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gYy5nZXRDaGlsZEluZGV4KGEpO1xyXG4gICAgICAgICAgICAgICAgaS5pbnNlcnRSb3dzKGMsIHtyb3dzOiAxLCBhdDogdGhpcy5vcmRlciA9PT0gXCJiZWxvd1wiID8gbCArIDEgOiBsfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgT1MgZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQsIGUgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9yZGVyID0gZS5vcmRlciB8fCBcInJpZ2h0XCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gV1AoXCJ0YWJsZVwiLCB0LmdldEZpcnN0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9ICEhZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGx1Z2lucy5nZXQoXCJUYWJsZVV0aWxzXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMub3JkZXIgPT09IFwibGVmdFwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4gPyBlLmdldEZpcnN0UG9zaXRpb24oKSA6IGUuZ2V0TGFzdFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbiA/IGUuZ2V0Rmlyc3RSYW5nZSgpIDogZS5nZXRMYXN0UmFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSByLmdldENvbnRhaW5lZEVsZW1lbnQoKSB8fCBXUChcInRhYmxlQ2VsbFwiLCBvKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzLnBhcmVudC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7Y29sdW1uOiBjfSA9IGkuZ2V0Q2VsbExvY2F0aW9uKHMpO1xyXG4gICAgICAgICAgICAgICAgaS5pbnNlcnRDb2x1bW5zKGEsIHtjb2x1bW5zOiAxLCBhdDogbiA/IGMgOiBjICsgMX0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIElTIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBlLmRpcmVjdGlvbiB8fCBcImhvcml6b250YWxseVwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gc1ModGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gdC5sZW5ndGggPT09IDFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzUyh0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24pWzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZGlyZWN0aW9uID09PSBcImhvcml6b250YWxseVwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVVdGlsc1wiKTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zcGxpdENlbGxIb3Jpem9udGFsbHkodCwgMilcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zcGxpdENlbGxWZXJ0aWNhbGx5KHQsIDIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFZTIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gZS5kaXJlY3Rpb247XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzSG9yaXpvbnRhbCA9IHRoaXMuZGlyZWN0aW9uID09IFwicmlnaHRcIiB8fCB0aGlzLmRpcmVjdGlvbiA9PSBcImxlZnRcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuX2dldE1lcmdlYWJsZUNlbGwoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSAhIXRcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHJTKGUuc2VsZWN0aW9uKVswXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuZGlyZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgdC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG8gPT0gXCJyaWdodFwiIHx8IG8gPT0gXCJkb3duXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IGUgPyBpIDogbjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gZSA/IG4gOiBpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICB6UyhzLCByLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gdGhpcy5pc0hvcml6b250YWwgPyBcImNvbHNwYW5cIiA6IFwicm93c3BhblwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBwYXJzZUludChpLmdldEF0dHJpYnV0ZShjKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkID0gcGFyc2VJbnQobi5nZXRBdHRyaWJ1dGUoYykgfHwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUoYywgbCArIGQsIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKHQuY3JlYXRlUmFuZ2VJbihyKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhLmNoaWxkQ291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgQlMoYSwgdClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0TWVyZ2VhYmxlQ2VsbCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHJTKGUuc2VsZWN0aW9uKVswXTtcclxuICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVVdGlsc1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmlzSG9yaXpvbnRhbCA/IE5TKGksIHRoaXMuZGlyZWN0aW9uLCBuKSA6IE1TKGksIHRoaXMuZGlyZWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuaXNIb3Jpem9udGFsID8gXCJyb3dzcGFuXCIgOiBcImNvbHNwYW5cIjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBwYXJzZUludChpLmdldEF0dHJpYnV0ZShyKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBwYXJzZUludChvLmdldEF0dHJpYnV0ZShyKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgIGlmIChhID09PSBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gTlModCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuLnBhcmVudDtcclxuICAgICAgICAgICAgY29uc3QgciA9IGUgPT0gXCJyaWdodFwiID8gdC5uZXh0U2libGluZyA6IHQucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gKG8uZ2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIikgfHwgMCkgPiAwO1xyXG4gICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGEgPSBlID09IFwicmlnaHRcIiA/IHQgOiByO1xyXG4gICAgICAgICAgICBjb25zdCBjID0gZSA9PSBcInJpZ2h0XCIgPyByIDogdDtcclxuICAgICAgICAgICAgY29uc3Qge2NvbHVtbjogbH0gPSBpLmdldENlbGxMb2NhdGlvbihhKTtcclxuICAgICAgICAgICAgY29uc3Qge2NvbHVtbjogZH0gPSBpLmdldENlbGxMb2NhdGlvbihjKTtcclxuICAgICAgICAgICAgY29uc3QgdSA9IHBhcnNlSW50KGEuZ2V0QXR0cmlidXRlKFwiY29sc3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgY29uc3QgaCA9IEtQKGksIGEsIG8pO1xyXG4gICAgICAgICAgICBjb25zdCBmID0gS1AoaSwgYywgbyk7XHJcbiAgICAgICAgICAgIGlmIChzICYmIGggIT0gZikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZyA9IGwgKyB1ID09PSBkO1xyXG4gICAgICAgICAgICByZXR1cm4gZyA/IHIgOiB1bmRlZmluZWRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE1TKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBuID0gaS5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuLmdldENoaWxkSW5kZXgoaSk7XHJcbiAgICAgICAgICAgIGlmIChlID09IFwiZG93blwiICYmIG8gPT09IG4uY2hpbGRDb3VudCAtIDEgfHwgZSA9PSBcInVwXCIgJiYgbyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgciA9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwicm93c3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgY29uc3QgcyA9IG4uZ2V0QXR0cmlidXRlKFwiaGVhZGluZ1Jvd3NcIikgfHwgMDtcclxuICAgICAgICAgICAgY29uc3QgYSA9IGUgPT0gXCJkb3duXCIgJiYgbyArIHIgPT09IHM7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSBlID09IFwidXBcIiAmJiBvID09PSBzO1xyXG4gICAgICAgICAgICBpZiAocyAmJiAoYSB8fCBjKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbCA9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwicm93c3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgY29uc3QgZCA9IGUgPT0gXCJkb3duXCIgPyBvICsgbCA6IG87XHJcbiAgICAgICAgICAgIGNvbnN0IHUgPSBbLi4ubmV3IFpQKG4sIHtlbmRSb3c6IGR9KV07XHJcbiAgICAgICAgICAgIGNvbnN0IGggPSB1LmZpbmQoZSA9PiBlLmNlbGwgPT09IHQpO1xyXG4gICAgICAgICAgICBjb25zdCBmID0gaC5jb2x1bW47XHJcbiAgICAgICAgICAgIGNvbnN0IGcgPSB1LmZpbmQoKHtyb3c6IHQsIHJvd3NwYW46IGksIGNvbHVtbjogbn0pID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChuICE9PSBmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZSA9PSBcImRvd25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ID09PSBkXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkID09PSB0ICsgaVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGcgJiYgZy5jZWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBCUyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGkuZ2V0Q2hpbGRJbmRleCh0KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB7Y2VsbDogdCwgcm93OiBvLCByb3dzcGFuOiByfSBvZiBuZXcgWlAoaSwge2VuZFJvdzogbn0pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbyArIHIgLSAxID49IG47XHJcbiAgICAgICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHFQKFwicm93c3BhblwiLCByIC0gMSwgdCwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlLnJlbW92ZSh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gelModCwgZSwgaSkge1xyXG4gICAgICAgICAgICBpZiAoIUxTKHQpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoTFMoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnJlbW92ZShpLmNyZWF0ZVJhbmdlSW4oZSkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpLm1vdmUoaS5jcmVhdGVSYW5nZUluKHQpLCBpLmNyZWF0ZVBvc2l0aW9uQXQoZSwgXCJlbmRcIikpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaS5yZW1vdmUodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIExTKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQuY2hpbGRDb3VudCA9PSAxICYmIHQuZ2V0Q2hpbGQoMCkuaXMoXCJwYXJhZ3JhcGhcIikgJiYgdC5nZXRDaGlsZCgwKS5pc0VtcHR5XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBGUyBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBzUyh0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRbMF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnBhcmVudC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVVdGlsc1wiKS5nZXRSb3dzKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbLi4ubmV3IFpQKGkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gby5maWx0ZXIoZSA9PiB0LmluY2x1ZGVzKGUuY2VsbCkpLm1hcCh0ID0+IHQucm93KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gclswXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gcltyLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gYSAtIHMgPCBuIC0gMVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gc1ModGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBEUyh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0WzBdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGkucGFyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbLi4ubmV3IFpQKG4sIHtlbmRSb3c6IGUubGFzdH0pXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmVkaXRvci5tb2RlbC5jcmVhdGVCYXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IEhTKG8sIGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IubW9kZWwuZW5xdWV1ZUNoYW5nZShyLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbih0LmNyZWF0ZVNlbGVjdGlvbihuLCBcIm9uXCIpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgYTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IHQgPSBlLmxhc3Q7IHQgPj0gZS5maXJzdDsgdC0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IubW9kZWwuZW5xdWV1ZUNoYW5nZShyLCBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbW92ZVJvdyhpLCBuLCBlLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGpTKG4sIGksIHMpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm1vZGVsLmVucXVldWVDaGFuZ2UociwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24odC5jcmVhdGVQb3NpdGlvbkF0KGEsIDApKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3JlbW92ZVJvdyh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBlLmdldENoaWxkKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IGUuZ2V0QXR0cmlidXRlKFwiaGVhZGluZ1Jvd3NcIikgfHwgMDtcclxuICAgICAgICAgICAgICAgIGlmIChzICYmIHQgPCBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcVAoXCJoZWFkaW5nUm93c1wiLCBzIC0gMSwgZSwgaSwgMClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG4uZmlsdGVyKCh7cm93OiBlLCByb3dzcGFuOiBpfSkgPT4gZSA9PT0gdCAmJiBpID4gMSkuZm9yRWFjaCgoe2NvbHVtbjogdCwgY2VsbDogZSwgcm93c3BhbjogaX0pID0+IG8uc2V0KHQsIHtcclxuICAgICAgICAgICAgICAgICAgICBjZWxsOiBlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJvd3NwYW5Ub1NldDogaSAtIDFcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIG4uZmlsdGVyKCh7cm93OiBlLCByb3dzcGFuOiBpfSkgPT4gZSA8PSB0IC0gMSAmJiBlICsgaSA+IHQpLmZvckVhY2goKHtjZWxsOiB0LCByb3dzcGFuOiBlfSkgPT4gcVAoXCJyb3dzcGFuXCIsIGUgLSAxLCB0LCBpKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gdCArIDE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjID0gbmV3IFpQKGUsIHtpbmNsdWRlU3Bhbm5lZDogdHJ1ZSwgc3RhcnRSb3c6IGEsIGVuZFJvdzogYX0pO1xyXG4gICAgICAgICAgICAgICAgbGV0IGw7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHtyb3c6IHQsIGNvbHVtbjogbiwgY2VsbDogcn0gb2YgWy4uLmNdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8uaGFzKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHtjZWxsOiByLCByb3dzcGFuVG9TZXQ6IHN9ID0gby5nZXQobik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBsID8gaS5jcmVhdGVQb3NpdGlvbkFmdGVyKGwpIDogaS5jcmVhdGVQb3NpdGlvbkF0KGUuZ2V0Q2hpbGQodCksIDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLm1vdmUoaS5jcmVhdGVSYW5nZU9uKHIpLCBhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcVAoXCJyb3dzcGFuXCIsIHMsIHIsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsID0gclxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSByXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5yZW1vdmUocilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRFModCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gdC5tYXAodCA9PiB0LnBhcmVudC5pbmRleCkuc29ydCgpO1xyXG4gICAgICAgICAgICByZXR1cm4ge2ZpcnN0OiBlWzBdLCBsYXN0OiBlW2UubGVuZ3RoIC0gMV19XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBqUyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmdldENoaWxkKGUpIHx8IHQuZ2V0Q2hpbGQodC5jaGlsZENvdW50IC0gMSk7XHJcbiAgICAgICAgICAgIGxldCBvID0gbi5nZXRDaGlsZCgwKTtcclxuICAgICAgICAgICAgbGV0IHIgPSAwO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi5nZXRDaGlsZHJlbigpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAociA+IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbyA9IHQ7XHJcbiAgICAgICAgICAgICAgICByICs9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwiY29sc3BhblwiKSB8fCAxKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBIUyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmZpbmQodCA9PiB0LmNlbGwgPT09IGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gaS5jb2x1bW5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFdTIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICByZWZyZXNoKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHNTKHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFswXTtcclxuICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUucGFyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoXCJUYWJsZVV0aWxzXCIpLmdldENvbHVtbnMoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IFsuLi5uZXcgWlAoaSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBvLmZpbHRlcihlID0+IHQuaW5jbHVkZXMoZS5jZWxsKSkubWFwKHQgPT4gdC5jb2x1bW4pLnNvcnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gclswXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gcltyLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gYSAtIHMgPCBuIC0gMVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBbdCwgZV0gPSAkUyh0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQucGFyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBbLi4ubmV3IFpQKGkpXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB7Zmlyc3Q6IG4uZmluZChlID0+IGUuY2VsbCA9PT0gdCkuY29sdW1uLCBsYXN0OiBuLmZpbmQodCA9PiB0LmNlbGwgPT09IGUpLmNvbHVtbn07XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gVVMobiwgdCwgZSwgbyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5tb2RlbC5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24odC5jcmVhdGVSYW5nZU9uKGkpKTtcclxuICAgICAgICAgICAgICAgICAgICBxUyhpLCBvLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gby5sYXN0OyBlID49IG8uZmlyc3Q7IGUtLSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHtjZWxsOiBpLCBjb2x1bW46IG8sIGNvbHNwYW46IHJ9IG9mIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvIDw9IGUgJiYgciA+IDEgJiYgbyArIHIgPiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcVAoXCJjb2xzcGFuXCIsIHIgLSAxLCBpLCB0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChvID09PSBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IGkucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZS5jaGlsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlKGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKHQuY3JlYXRlUG9zaXRpb25BdChyLCAwKSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHFTKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIikgfHwgMDtcclxuICAgICAgICAgICAgaWYgKG4gJiYgZS5maXJzdCA8PSBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gTWF0aC5taW4obiAtIDEsIGUubGFzdCkgLSBlLmZpcnN0ICsgMTtcclxuICAgICAgICAgICAgICAgIGkuc2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIiwgbiAtIG8sIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFVTKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IHBhcnNlSW50KGkuZ2V0QXR0cmlidXRlKFwiY29sc3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgaWYgKG8gPiAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUucHJldmlvdXNTaWJsaW5nIHx8IGkubmV4dFNpYmxpbmcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpLm5leHRTaWJsaW5nIHx8IGUucHJldmlvdXNTaWJsaW5nXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobi5maXJzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnJldmVyc2UoKS5maW5kKCh7Y29sdW1uOiB0fSkgPT4gdCA8IG4uZmlyc3QpLmNlbGxcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQucmV2ZXJzZSgpLmZpbmQoKHtjb2x1bW46IHR9KSA9PiB0ID4gbi5sYXN0KS5jZWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uICRTKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHNTKHQpO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gZVswXTtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUucG9wKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBbaSwgbl07XHJcbiAgICAgICAgICAgIHJldHVybiBpLmlzQmVmb3JlKG4pID8gbyA6IG8ucmV2ZXJzZSgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBHUyBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBzUyh0LmRvY3VtZW50LnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5sZW5ndGggPiAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZWQgPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGkgJiYgZS5ldmVyeSh0ID0+IHRoaXMuX2lzSW5IZWFkaW5nKHQsIHQucGFyZW50LnBhcmVudCkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGV4ZWN1dGUodCA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gc1MoZS5kb2N1bWVudC5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGlbMF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gaVtpLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4ucGFyZW50LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSByLmdldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIpIHx8IDA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBbYSwgY10gPSBbbi5wYXJlbnQuaW5kZXgsIG8ucGFyZW50LmluZGV4XS5zb3J0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5mb3JjZVZhbHVlID09PSB0aGlzLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gdGhpcy52YWx1ZSA/IGEgOiBjICsgMTtcclxuICAgICAgICAgICAgICAgIGUuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBLUyhyLCBsLCBzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTKGksIGwsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcVAoXCJoZWFkaW5nUm93c1wiLCBsLCByLCB0LCAwKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2lzSW5IZWFkaW5nKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBwYXJzZUludChlLmdldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIpIHx8IDApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhaSAmJiB0LnBhcmVudC5pbmRleCA8IGlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gS1ModCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBlID4gaSA/IGkgOiAwO1xyXG4gICAgICAgICAgICBjb25zdCByID0gZSAtIDE7XHJcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgWlAodCwge3N0YXJ0Um93OiBvLCBlbmRSb3c6IHJ9KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB7cm93OiB0LCByb3dzcGFuOiBpLCBjZWxsOiBvfSBvZiBzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+IDEgJiYgdCArIGkgPiBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKG8pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEpTKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBvID0gbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuLmluZGV4O1xyXG4gICAgICAgICAgICBjb25zdCBzID0gcGFyc2VJbnQodC5nZXRBdHRyaWJ1dGUoXCJyb3dzcGFuXCIpKTtcclxuICAgICAgICAgICAgY29uc3QgYSA9IGUgLSByO1xyXG4gICAgICAgICAgICBjb25zdCBjID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IGwgPSBzIC0gYTtcclxuICAgICAgICAgICAgaWYgKGwgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBjLnJvd3NwYW4gPSBsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZCA9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwiY29sc3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgaWYgKGQgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBjLmNvbHNwYW4gPSBkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgdSA9IG8uZ2V0Q2hpbGRJbmRleChuKTtcclxuICAgICAgICAgICAgY29uc3QgaCA9IHUgKyBhO1xyXG4gICAgICAgICAgICBjb25zdCBmID0gWy4uLm5ldyBaUChvLCB7c3RhcnRSb3c6IHUsIGVuZFJvdzogaCwgaW5jbHVkZVNwYW5uZWQ6IHRydWV9KV07XHJcbiAgICAgICAgICAgIGxldCBnO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHtyb3c6IGUsIGNvbHVtbjogbiwgY2VsbDogciwgY2VsbEluZGV4OiBzfSBvZiBmKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAociA9PT0gdCAmJiBnID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBnID0gblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGcgIT09IHVuZGVmaW5lZCAmJiBnID09PSBuICYmIGUgPT09IGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gby5nZXRDaGlsZChlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gaS5jcmVhdGVQb3NpdGlvbkF0KHQsIHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIFVQKGksIG4sIGMpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcVAoXCJyb3dzcGFuXCIsIGEsIHQsIGkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBZUyBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBzUyh0LmRvY3VtZW50LnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoXCJUYWJsZVV0aWxzXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUubGVuZ3RoID4gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gbjtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBuICYmIGUuZXZlcnkodCA9PiBLUChpLCB0KSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChcIlRhYmxlVXRpbHNcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gc1MoZS5kb2N1bWVudC5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5bMF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbltuLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG8ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IHMucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgW2MsIGxdID0gW2kuZ2V0Q2VsbExvY2F0aW9uKG8pLmNvbHVtbiwgaS5nZXRDZWxsTG9jYXRpb24ocikuY29sdW1uXS5zb3J0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5mb3JjZVZhbHVlID09PSB0aGlzLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0gdGhpcy52YWx1ZSA/IGMgOiBsICsgMTtcclxuICAgICAgICAgICAgICAgIGUuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHFQKFwiaGVhZGluZ0NvbHVtbnNcIiwgZCwgYSwgdCwgMClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFFTIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUYWJsZVV0aWxzXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q2VsbExvY2F0aW9uKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLnBhcmVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmdldENoaWxkSW5kZXgoZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3IFpQKGksIHtzdGFydFJvdzogbiwgZW5kUm93OiBufSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHtjZWxsOiBlLCByb3c6IGksIGNvbHVtbjogbn0gb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlID09PSB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7cm93OiBpLCBjb2x1bW46IG59XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjcmVhdGVUYWJsZSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jcmVhdGVFbGVtZW50KFwidGFibGVcIik7XHJcbiAgICAgICAgICAgICAgICBYUyh0LCBuLCAwLCBlLCBpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluc2VydFJvd3ModCwgZSA9IHt9KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZS5hdCB8fCAwO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUucm93cyB8fCAxO1xyXG4gICAgICAgICAgICAgICAgaS5jaGFuZ2UoZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0QXR0cmlidXRlKFwiaGVhZGluZ1Jvd3NcIikgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJoZWFkaW5nUm93c1wiLCBpICsgbywgdClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4gPT09IDAgfHwgbiA9PT0gdC5jaGlsZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFhTKGUsIHQsIG4sIG8sIHRoaXMuZ2V0Q29sdW1ucyh0KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFpQKHQsIHtlbmRSb3c6IG59KTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB7cm93OiB0LCByb3dzcGFuOiBpLCBjb2xzcGFuOiBhLCBjZWxsOiBjfSBvZiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0IDwgbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbCA9IHQgKyBpID4gbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgJiYgbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJyb3dzcGFuXCIsIGkgKyBvLCBjKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID09PSBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzICs9IGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBYUyhlLCB0LCBuLCBvLCBzKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5zZXJ0Q29sdW1ucyh0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmF0IHx8IDA7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS5jb2x1bW5zIHx8IDE7XHJcbiAgICAgICAgICAgICAgICBpLmNoYW5nZShlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5nZXRBdHRyaWJ1dGUoXCJoZWFkaW5nQ29sdW1uc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobiA8IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRBdHRyaWJ1dGUoXCJoZWFkaW5nQ29sdW1uc1wiLCBpICsgbywgdClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuZ2V0Q29sdW1ucyh0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobiA9PT0gMCB8fCByID09PSBuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0LmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFpTKG8sIGUsIGUuY3JlYXRlUG9zaXRpb25BdChpLCBuID8gXCJlbmRcIiA6IDApKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IFpQKHQsIHtjb2x1bW46IG4sIGluY2x1ZGVTcGFubmVkOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB7cm93OiBpLCBjZWxsOiByLCBjZWxsSW5kZXg6IGF9IG9mIHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYyA9IHBhcnNlSW50KHIuZ2V0QXR0cmlidXRlKFwicm93c3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbCA9IHBhcnNlSW50KHIuZ2V0QXR0cmlidXRlKFwiY29sc3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIuaW5kZXggIT09IG4gJiYgbCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc2V0QXR0cmlidXRlKFwiY29sc3BhblwiLCBsICsgbywgcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnNraXBSb3coaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYyA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gaSArIDE7IHQgPCBpICsgYzsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMuc2tpcFJvdyh0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmNyZWF0ZVBvc2l0aW9uQXQodC5nZXRDaGlsZChpKSwgYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBaUyhvLCBlLCBuKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3BsaXRDZWxsVmVydGljYWxseSh0LCBlID0gMikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwicm93c3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBwYXJzZUludCh0LmdldEF0dHJpYnV0ZShcImNvbHNwYW5cIikgfHwgMSk7XHJcbiAgICAgICAgICAgICAgICBpLmNoYW5nZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocyA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qge25ld0NlbGxzU3BhbjogbiwgdXBkYXRlZFNwYW46IG99ID0gdEUocywgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHFQKFwiY29sc3BhblwiLCBvLCB0LCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobiA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuY29sc3BhbiA9IG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAociA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEucm93c3BhbiA9IHJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gcyA+IGUgPyBlIC0gMSA6IHMgLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBaUyhjLCBpLCBpLmNyZWF0ZVBvc2l0aW9uQWZ0ZXIodCksIGEpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzIDwgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZSAtIHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBbLi4ubmV3IFpQKG8pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qge2NvbHVtbjogY30gPSBhLmZpbmQoKHtjZWxsOiBlfSkgPT4gZSA9PT0gdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBhLmZpbHRlcigoe2NlbGw6IGUsIGNvbHNwYW46IGksIGNvbHVtbjogbn0pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlICE9PSB0ICYmIG4gPT09IGM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbiA8IGMgJiYgbiArIGkgPiBjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG8gfHwgclxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB7Y2VsbDogdCwgY29sc3BhbjogZX0gb2YgbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5zZXRBdHRyaWJ1dGUoXCJjb2xzcGFuXCIsIGUgKyBuLCB0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGQgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnJvd3NwYW4gPSByXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgWlMobiwgaSwgaS5jcmVhdGVQb3NpdGlvbkFmdGVyKHQpLCBkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdSA9IG8uZ2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIikgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHUgPiBjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxUChcImhlYWRpbmdDb2x1bW5zXCIsIHUgKyBuLCBvLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3BsaXRDZWxsSG9yaXpvbnRhbGx5KHQsIGUgPSAyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5wYXJlbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gby5nZXRDaGlsZEluZGV4KG4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKFwicm93c3BhblwiKSB8fCAxKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBwYXJzZUludCh0LmdldEF0dHJpYnV0ZShcImNvbHNwYW5cIikgfHwgMSk7XHJcbiAgICAgICAgICAgICAgICBpLmNoYW5nZShpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocyA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IFsuLi5uZXcgWlAobywge3N0YXJ0Um93OiByLCBlbmRSb3c6IHIgKyBzIC0gMSwgaW5jbHVkZVNwYW5uZWQ6IHRydWV9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHtuZXdDZWxsc1NwYW46IGMsIHVwZGF0ZWRTcGFuOiBsfSA9IHRFKHMsIGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxUChcInJvd3NwYW5cIiwgbCwgdCwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHtjb2x1bW46IGR9ID0gbi5maW5kKCh7Y2VsbDogZX0pID0+IGUgPT09IHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdS5yb3dzcGFuID0gY1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdS5jb2xzcGFuID0gYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qge2NvbHVtbjogdCwgcm93OiBlLCBjZWxsSW5kZXg6IHN9IG9mIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlID49IHIgKyBsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYSA9IHQgPT09IGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoID0gKGUgKyByICsgbCkgJSBjID09PSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gJiYgYSAmJiBoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGkuY3JlYXRlUG9zaXRpb25BdChvLmdldENoaWxkKGUpLCBzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBaUygxLCBpLCB0LCB1KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzIDwgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZSAtIHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBbLi4ubmV3IFpQKG8sIHtzdGFydFJvdzogMCwgZW5kUm93OiByfSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHtjZWxsOiBlLCByb3dzcGFuOiBvLCByb3c6IHN9IG9mIGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlICE9PSB0ICYmIHMgKyBvID4gcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBvICsgbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnNldEF0dHJpYnV0ZShcInJvd3NwYW5cIiwgdCwgZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbC5jb2xzcGFuID0gYVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFhTKGksIG8sIHIgKyAxLCBuLCAxLCBsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZCA9IG8uZ2V0QXR0cmlidXRlKFwiaGVhZGluZ1Jvd3NcIikgfHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQgPiByKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxUChcImhlYWRpbmdSb3dzXCIsIGQgKyBuLCBvLCBpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Q29sdW1ucyh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5nZXRDaGlsZCgwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbLi4uZS5nZXRDaGlsZHJlbigpXS5yZWR1Y2UoKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gcGFyc2VJbnQoZS5nZXRBdHRyaWJ1dGUoXCJjb2xzcGFuXCIpIHx8IDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ICsgaVxyXG4gICAgICAgICAgICAgICAgfSwgMClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0Um93cyh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5jaGlsZENvdW50XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFhTKHQsIGUsIGksIG4sIG8sIHIgPSB7fSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IG47IHMrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuY3JlYXRlRWxlbWVudChcInRhYmxlUm93XCIpO1xyXG4gICAgICAgICAgICAgICAgdC5pbnNlcnQobiwgZSwgaSk7XHJcbiAgICAgICAgICAgICAgICBaUyhvLCB0LCB0LmNyZWF0ZVBvc2l0aW9uQXQobiwgXCJlbmRcIiksIHIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFpTKHQsIGUsIGksIG4gPSB7fSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBvID0gMDsgbyA8IHQ7IG8rKykge1xyXG4gICAgICAgICAgICAgICAgVVAoZSwgaSwgbilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdEUodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodCA8IGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7bmV3Q2VsbHNTcGFuOiAxLCB1cGRhdGVkU3BhbjogMX1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBpID0gTWF0aC5mbG9vcih0IC8gZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0IC0gaSAqIGUgKyBpO1xyXG4gICAgICAgICAgICByZXR1cm4ge25ld0NlbGxzU3BhbjogaSwgdXBkYXRlZFNwYW46IG59XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlRSh0KSB7XHJcbiAgICAgICAgICAgIHQuZG9jdW1lbnQucmVnaXN0ZXJQb3N0Rml4ZXIoZSA9PiBpRShlLCB0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlFKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQuZGlmZmVyLmdldENoYW5nZXMoKTtcclxuICAgICAgICAgICAgbGV0IG4gPSBmYWxzZTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBTZXQ7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaTtcclxuICAgICAgICAgICAgICAgIGlmIChlLm5hbWUgPT0gXCJ0YWJsZVwiICYmIGUudHlwZSA9PSBcImluc2VydFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IGUucG9zaXRpb24ubm9kZUFmdGVyXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5uYW1lID09IFwidGFibGVSb3dcIiB8fCBlLm5hbWUgPT0gXCJ0YWJsZUNlbGxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSBXUChcInRhYmxlXCIsIGUucG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoYUUoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gV1AoXCJ0YWJsZVwiLCBlLnJhbmdlLnN0YXJ0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgJiYgIW8uaGFzKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IG5FKGksIHQpIHx8IG47XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IG9FKGksIHQpIHx8IG47XHJcbiAgICAgICAgICAgICAgICAgICAgby5hZGQoaSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbkUodCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gckUodCk7XHJcbiAgICAgICAgICAgIGlmIChuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgaSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHFQKFwicm93c3BhblwiLCB0LnJvd3NwYW4sIHQuY2VsbCwgZSwgMSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb0UodCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gc0UodCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuWzBdO1xyXG4gICAgICAgICAgICBjb25zdCByID0gT2JqZWN0LnZhbHVlcyhuKS5ldmVyeSh0ID0+IHQgPT09IG8pO1xyXG4gICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBPYmplY3QudmFsdWVzKG4pLnJlZHVjZSgodCwgZSkgPT4gZSA+IHQgPyBlIDogdCwgMCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtyLCBzXSBvZiBPYmplY3QuZW50cmllcyhuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBvIC0gcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVVAoZSwgZS5jcmVhdGVQb3NpdGlvbkF0KHQuZ2V0Q2hpbGQociksIFwiZW5kXCIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiByRSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSBwYXJzZUludCh0LmdldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIpIHx8IDApO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gdC5jaGlsZENvdW50O1xyXG4gICAgICAgICAgICBjb25zdCBuID0gW107XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qge3Jvdzogbywgcm93c3BhbjogciwgY2VsbDogc30gb2YgbmV3IFpQKHQpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAociA8IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG8gPCBlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IHQgPyBlIDogaTtcclxuICAgICAgICAgICAgICAgIGlmIChvICsgciA+IGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gYSAtIG87XHJcbiAgICAgICAgICAgICAgICAgICAgbi5wdXNoKHtjZWxsOiBzLCByb3dzcGFuOiB0fSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc0UodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0ge307XHJcbiAgICAgICAgICAgIGZvciAoY29uc3Qge3JvdzogaX0gb2YgbmV3IFpQKHQsIHtpbmNsdWRlU3Bhbm5lZDogdHJ1ZX0pKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWVbaV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBlW2ldID0gMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZVtpXSArPSAxXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFFKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQudHlwZSA9PT0gXCJhdHRyaWJ1dGVcIjtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuYXR0cmlidXRlS2V5O1xyXG4gICAgICAgICAgICByZXR1cm4gZSAmJiAoaSA9PT0gXCJoZWFkaW5nUm93c1wiIHx8IGkgPT09IFwiY29sc3BhblwiIHx8IGkgPT09IFwicm93c3BhblwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY0UodCkge1xyXG4gICAgICAgICAgICB0LmRvY3VtZW50LnJlZ2lzdGVyUG9zdEZpeGVyKGUgPT4gbEUoZSwgdCkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsRSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBlLmRvY3VtZW50LmRpZmZlci5nZXRDaGFuZ2VzKCk7XHJcbiAgICAgICAgICAgIGxldCBuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiBpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS50eXBlID09IFwiaW5zZXJ0XCIgJiYgZS5uYW1lID09IFwidGFibGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBkRShlLnBvc2l0aW9uLm5vZGVBZnRlciwgdCkgfHwgblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGUudHlwZSA9PSBcImluc2VydFwiICYmIGUubmFtZSA9PSBcInRhYmxlUm93XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBuID0gdUUoZS5wb3NpdGlvbi5ub2RlQWZ0ZXIsIHQpIHx8IG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT0gXCJpbnNlcnRcIiAmJiBlLm5hbWUgPT0gXCJ0YWJsZUNlbGxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBoRShlLnBvc2l0aW9uLm5vZGVBZnRlciwgdCkgfHwgblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGZFKGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IGhFKGUucG9zaXRpb24ucGFyZW50LCB0KSB8fCBuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRFKHQsIGUpIHtcclxuICAgICAgICAgICAgbGV0IGkgPSBmYWxzZTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgaSA9IHVFKG4sIGUpIHx8IGlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdUUodCwgZSkge1xyXG4gICAgICAgICAgICBsZXQgaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5nZXRDaGlsZHJlbigpKSB7XHJcbiAgICAgICAgICAgICAgICBpID0gaEUobiwgZSkgfHwgaVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoRSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0LmNoaWxkQ291bnQgPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgZS5pbnNlcnRFbGVtZW50KFwicGFyYWdyYXBoXCIsIHQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBpID0gQXJyYXkuZnJvbSh0LmdldENoaWxkcmVuKCkpLmZpbHRlcih0ID0+IHQuaXMoXCJ0ZXh0XCIpKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgIGUud3JhcChlLmNyZWF0ZVJhbmdlT24odCksIFwicGFyYWdyYXBoXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICEhaS5sZW5ndGhcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZFKHQpIHtcclxuICAgICAgICAgICAgaWYgKCF0LnBvc2l0aW9uIHx8ICF0LnBvc2l0aW9uLnBhcmVudC5pcyhcInRhYmxlQ2VsbFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHQudHlwZSA9PSBcImluc2VydFwiICYmIHQubmFtZSA9PSBcIiR0ZXh0XCIgfHwgdC50eXBlID09IFwicmVtb3ZlXCJcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdFKHQpIHtcclxuICAgICAgICAgICAgdC5kb2N1bWVudC5yZWdpc3RlclBvc3RGaXhlcigoKSA9PiBtRSh0KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG1FKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHQuZG9jdW1lbnQuZGlmZmVyO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gbmV3IFNldDtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUuZ2V0Q2hhbmdlcygpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50eXBlID09IFwiaW5zZXJ0XCIgfHwgdC50eXBlID09IFwicmVtb3ZlXCIgPyB0LnBvc2l0aW9uLnBhcmVudCA6IHQucmFuZ2Uuc3RhcnQucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuaXMoXCJ0YWJsZUNlbGxcIikgJiYgcEUoZSwgdC50eXBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYWRkKGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGkuc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkudmFsdWVzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLnJlZnJlc2hJdGVtKHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcEUodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gQXJyYXkuZnJvbSh0LmdldENoaWxkcmVuKCkpLnNvbWUodCA9PiB0LmlzKFwicGFyYWdyYXBoXCIpKTtcclxuICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZSA9PSBcImF0dHJpYnV0ZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gQXJyYXkuZnJvbSh0LmdldENoaWxkKDApLmdldEF0dHJpYnV0ZUtleXMoKSkubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHQuY2hpbGRDb3VudCA9PT0gMSAmJiBlIDwgMlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0LmNoaWxkQ291bnQgPD0gKGUgPT0gXCJpbnNlcnRcIiA/IDIgOiAxKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGJFID0gaSg5Mik7XHJcblxyXG4gICAgICAgIGNsYXNzIHdFIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUYWJsZUVkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5zY2hlbWE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb252ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgaS5yZWdpc3RlcihcInRhYmxlXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGxvd1doZXJlOiBcIiRibG9ja1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGFsbG93QXR0cmlidXRlczogW1wiaGVhZGluZ1Jvd3NcIiwgXCJoZWFkaW5nQ29sdW1uc1wiXSxcclxuICAgICAgICAgICAgICAgICAgICBpc0xpbWl0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzT2JqZWN0OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzQmxvY2s6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaS5yZWdpc3RlcihcInRhYmxlUm93XCIsIHthbGxvd0luOiBcInRhYmxlXCIsIGlzTGltaXQ6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIGkucmVnaXN0ZXIoXCJ0YWJsZUNlbGxcIiwge2FsbG93SW46IFwidGFibGVSb3dcIiwgYWxsb3dBdHRyaWJ1dGVzOiBbXCJjb2xzcGFuXCIsIFwicm93c3BhblwiXSwgaXNPYmplY3Q6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIGkuZXh0ZW5kKFwiJGJsb2NrXCIsIHthbGxvd0luOiBcInRhYmxlQ2VsbFwifSk7XHJcbiAgICAgICAgICAgICAgICBpLmFkZENoaWxkQ2hlY2soKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZS5uYW1lID09IFwidGFibGVcIiAmJiBBcnJheS5mcm9tKHQuZ2V0TmFtZXMoKSkuaW5jbHVkZXMoXCJ0YWJsZVwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwidXBjYXN0XCIpLmFkZChKUCgpKTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwiZWRpdGluZ0Rvd25jYXN0XCIpLmFkZChsUyh7YXNXaWRnZXQ6IHRydWV9KSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImRhdGFEb3duY2FzdFwiKS5hZGQobFMoKSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcInVwY2FzdFwiKS5lbGVtZW50VG9FbGVtZW50KHttb2RlbDogXCJ0YWJsZVJvd1wiLCB2aWV3OiBcInRyXCJ9KTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwiZWRpdGluZ0Rvd25jYXN0XCIpLmFkZChkUyh7YXNXaWRnZXQ6IHRydWV9KSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImRhdGFEb3duY2FzdFwiKS5hZGQoZFMoKSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImRvd25jYXN0XCIpLmFkZChnUygpKTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwidXBjYXN0XCIpLmFkZChZUChcInRkXCIpKTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwidXBjYXN0XCIpLmFkZChZUChcInRoXCIpKTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwiZWRpdGluZ0Rvd25jYXN0XCIpLmFkZCh1Uyh7YXNXaWRnZXQ6IHRydWV9KSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImRhdGFEb3duY2FzdFwiKS5hZGQodVMoKSk7XHJcbiAgICAgICAgICAgICAgICBuLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHttb2RlbDogXCJjb2xzcGFuXCIsIHZpZXc6IFwiY29sc3BhblwifSk7XHJcbiAgICAgICAgICAgICAgICBuLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHttb2RlbDogXCJyb3dzcGFuXCIsIHZpZXc6IFwicm93c3BhblwifSk7XHJcbiAgICAgICAgICAgICAgICBuLmZvcihcImVkaXRpbmdEb3duY2FzdFwiKS5hZGQoZlMoe2FzV2lkZ2V0OiB0cnVlfSkpO1xyXG4gICAgICAgICAgICAgICAgbi5mb3IoXCJkYXRhRG93bmNhc3RcIikuYWRkKGZTKCkpO1xyXG4gICAgICAgICAgICAgICAgbi5mb3IoXCJlZGl0aW5nRG93bmNhc3RcIikuYWRkKGhTKHthc1dpZGdldDogdHJ1ZX0pKTtcclxuICAgICAgICAgICAgICAgIG4uZm9yKFwiZGF0YURvd25jYXN0XCIpLmFkZChoUygpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiaW5zZXJ0VGFibGVcIiwgbmV3IFNTKHQpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwiaW5zZXJ0VGFibGVSb3dBYm92ZVwiLCBuZXcgUlModCwge29yZGVyOiBcImFib3ZlXCJ9KSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImluc2VydFRhYmxlUm93QmVsb3dcIiwgbmV3IFJTKHQsIHtvcmRlcjogXCJiZWxvd1wifSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJpbnNlcnRUYWJsZUNvbHVtbkxlZnRcIiwgbmV3IE9TKHQsIHtvcmRlcjogXCJsZWZ0XCJ9KSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcImluc2VydFRhYmxlQ29sdW1uUmlnaHRcIiwgbmV3IE9TKHQsIHtvcmRlcjogXCJyaWdodFwifSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJyZW1vdmVUYWJsZVJvd1wiLCBuZXcgRlModCkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJyZW1vdmVUYWJsZUNvbHVtblwiLCBuZXcgV1ModCkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJzcGxpdFRhYmxlQ2VsbFZlcnRpY2FsbHlcIiwgbmV3IElTKHQsIHtkaXJlY3Rpb246IFwidmVydGljYWxseVwifSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJzcGxpdFRhYmxlQ2VsbEhvcml6b250YWxseVwiLCBuZXcgSVModCwge2RpcmVjdGlvbjogXCJob3Jpem9udGFsbHlcIn0pKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwibWVyZ2VUYWJsZUNlbGxSaWdodFwiLCBuZXcgVlModCwge2RpcmVjdGlvbjogXCJyaWdodFwifSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJtZXJnZVRhYmxlQ2VsbExlZnRcIiwgbmV3IFZTKHQsIHtkaXJlY3Rpb246IFwibGVmdFwifSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJtZXJnZVRhYmxlQ2VsbERvd25cIiwgbmV3IFZTKHQsIHtkaXJlY3Rpb246IFwiZG93blwifSkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJtZXJnZVRhYmxlQ2VsbFVwXCIsIG5ldyBWUyh0LCB7ZGlyZWN0aW9uOiBcInVwXCJ9KSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInNldFRhYmxlQ29sdW1uSGVhZGVyXCIsIG5ldyBZUyh0KSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInNldFRhYmxlUm93SGVhZGVyXCIsIG5ldyBHUyh0KSk7XHJcbiAgICAgICAgICAgICAgICBlRShlKTtcclxuICAgICAgICAgICAgICAgIGdFKGUpO1xyXG4gICAgICAgICAgICAgICAgY0UoZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVkaXRvci5rZXlzdHJva2VzLnNldChcIlRhYlwiLCAoLi4udCkgPT4gdGhpcy5faGFuZGxlVGFiT25TZWxlY3RlZFRhYmxlKC4uLnQpLCB7cHJpb3JpdHk6IFwibG93XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmtleXN0cm9rZXMuc2V0KFwiVGFiXCIsIHRoaXMuX2dldFRhYkhhbmRsZXIodHJ1ZSksIHtwcmlvcml0eTogXCJsb3dcIn0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3Iua2V5c3Ryb2tlcy5zZXQoXCJTaGlmdCtUYWJcIiwgdGhpcy5fZ2V0VGFiSGFuZGxlcihmYWxzZSksIHtwcmlvcml0eTogXCJsb3dcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1FTXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGFuZGxlVGFiT25TZWxlY3RlZFRhYmxlKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGlmICghbi5pc0NvbGxhcHNlZCAmJiBuLnJhbmdlQ291bnQgPT09IDEgJiYgbi5nZXRGaXJzdFJhbmdlKCkuaXNGbGF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IG4uZ2V0U2VsZWN0ZWRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0IHx8ICF0LmlzKFwidGFibGVcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBpLm1vZGVsLmNoYW5nZShlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRTZWxlY3Rpb24oZS5jcmVhdGVSYW5nZUluKHQuZ2V0Q2hpbGQoMCkuZ2V0Q2hpbGQoMCkpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRUYWJIYW5kbGVyKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoaSwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gclMobylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHIucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzLnBhcmVudDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gYS5nZXRDaGlsZEluZGV4KHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGwgPSBzLmdldENoaWxkSW5kZXgocik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZCA9IGwgPT09IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0ICYmIGQgJiYgYyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdSA9IGwgPT09IHMuY2hpbGRDb3VudCAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaCA9IGMgPT09IGEuY2hpbGRDb3VudCAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgaCAmJiB1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZXhlY3V0ZShcImluc2VydFRhYmxlUm93QmVsb3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjID09PSBhLmNoaWxkQ291bnQgLSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgZjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiB1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBhLmdldENoaWxkKGMgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHQuZ2V0Q2hpbGQoMClcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCF0ICYmIGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGEuZ2V0Q2hpbGQoYyAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gdC5nZXRDaGlsZCh0LmNoaWxkQ291bnQgLSAxKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBzLmdldENoaWxkKGwgKyAodCA/IDEgOiAtMSkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGUubW9kZWwuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbih0LmNyZWF0ZVJhbmdlSW4oZikpXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGtFID0gaSg5NCk7XHJcblxyXG4gICAgICAgIGNsYXNzIF9FIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwicm93c1wiLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiY29sdW1uc1wiLCAwKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZChcImxhYmVsXCIpLnRvKHRoaXMsIFwiY29sdW1uc1wiLCB0aGlzLCBcInJvd3NcIiwgKHQsIGUpID0+IGAke2V9IMOXICR7dH1gKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCJdfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrLWluc2VydC10YWJsZS1kcm9wZG93bl9fZ3JpZFwiXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLml0ZW1zXHJcbiAgICAgICAgICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duX19sYWJlbFwiXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IGUudG8oXCJsYWJlbFwiKX1dXHJcbiAgICAgICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICAgICAgb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW91c2Vkb3duOiBlLnRvKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBjbGljazogZS50bygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJleGVjdXRlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IDEwMDsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyB2RTtcclxuICAgICAgICAgICAgICAgICAgICBlLm9uKFwib3ZlclwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBNYXRoLmZsb29yKHQgLyAxMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0ICUgMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwicm93c1wiLCBlICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiY29sdW1uc1wiLCBpICsgMSlcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLmFkZChlKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTpjb2x1bW5zXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oaWdobGlnaHRHcmlkQm94ZXMoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwiY2hhbmdlOnJvd3NcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hpZ2hsaWdodEdyaWRCb3hlcygpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXNMYXN0KCkge1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGlnaGxpZ2h0R3JpZEJveGVzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMucm93cztcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmNvbHVtbnM7XHJcbiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLm1hcCgoaSwgbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBNYXRoLmZsb29yKG4gLyAxMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IG4gJSAxMDtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gbyA8IHQgJiYgciA8IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zZXQoXCJpc09uXCIsIHMpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB2RSBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImlzT25cIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2staW5zZXJ0LXRhYmxlLWRyb3Bkb3duLWdyaWQtYm94XCIsIGUuaWYoXCJpc09uXCIsIFwiY2stb25cIildfSxcclxuICAgICAgICAgICAgICAgICAgICBvbjoge21vdXNlb3ZlcjogZS50byhcIm92ZXJcIil9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgeUUgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMyA2djNoNFY2SDN6bTAgNHYzaDR2LTNIM3ptMCA0djNoNHYtM0gzem01IDNoNHYtM0g4djN6bTUgMGg0di0zaC00djN6bTQtNHYtM2gtNHYzaDR6bTAtNFY2aC00djNoNHptMS41IDhhMS41IDEuNSAwIDAgMS0xLjUgMS41SDNBMS41IDEuNSAwIDAgMSAxLjUgMTdWNGMuMjIyLS44NjMgMS4wNjgtMS41IDItMS41aDEzYy45MzIgMCAxLjc3OC42MzcgMiAxLjV2MTN6TTEyIDEzdi0zSDh2M2g0em0wLTRWNkg4djNoNHpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgeEUgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNMi41IDFoMTVBMS41IDEuNSAwIDAgMSAxOSAyLjV2MTVhMS41IDEuNSAwIDAgMS0xLjUgMS41aC0xNUExLjUgMS41IDAgMCAxIDEgMTcuNXYtMTVBMS41IDEuNSAwIDAgMSAyLjUgMXpNMiAydjE2aDE2VjJIMnpcIiBvcGFjaXR5PVwiLjZcIi8+PHBhdGggZD1cIk0xOCA3djFIMlY3aDE2em0wIDV2MUgydi0xaDE2elwiIG9wYWNpdHk9XCIuNlwiLz48cGF0aCBkPVwiTTE0IDF2MThhMSAxIDAgMCAxLTEgMUg3YTEgMSAwIDAgMS0xLTFWMWExIDEgMCAwIDEgMS0xaDZhMSAxIDAgMCAxIDEgMXptLTIgMUg4djRoNFYyem0wIDZIOHY0aDRWOHptMCA2SDh2NGg0di00elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciBDRSA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0yLjUgMWgxNUExLjUgMS41IDAgMCAxIDE5IDIuNXYxNWExLjUgMS41IDAgMCAxLTEuNSAxLjVoLTE1QTEuNSAxLjUgMCAwIDEgMSAxNy41di0xNUExLjUgMS41IDAgMCAxIDIuNSAxek0yIDJ2MTZoMTZWMkgyelwiIG9wYWNpdHk9XCIuNlwiLz48cGF0aCBkPVwiTTcgMmgxdjE2SDdWMnptNSAwaDF2MTZoLTFWMnpcIiBvcGFjaXR5PVwiLjZcIi8+PHBhdGggZD1cIk0xIDZoMThhMSAxIDAgMCAxIDEgMXY2YTEgMSAwIDAgMS0xIDFIMWExIDEgMCAwIDEtMS0xVjdhMSAxIDAgMCAxIDEtMXptMSAydjRoNFY4SDJ6bTYgMHY0aDRWOEg4em02IDB2NGg0VjhoLTR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgdmFyIEFFID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTIuNSAxaDE1QTEuNSAxLjUgMCAwIDEgMTkgMi41djE1YTEuNSAxLjUgMCAwIDEtMS41IDEuNWgtMTVBMS41IDEuNSAwIDAgMSAxIDE3LjV2LTE1QTEuNSAxLjUgMCAwIDEgMi41IDF6TTIgMnYxNmgxNlYySDJ6XCIgb3BhY2l0eT1cIi42XCIvPjxwYXRoIGQ9XCJNNyAyaDF2MTZIN1Yyem01IDBoMXY3aC0xVjJ6bTYgNXYxSDJWN2gxNnpNOCAxMnYxSDJ2LTFoNnpcIiBvcGFjaXR5PVwiLjZcIi8+PHBhdGggZD1cIk03IDdoMTJhMSAxIDAgMCAxIDEgMXYxMWExIDEgMCAwIDEtMSAxSDdhMSAxIDAgMCAxLTEtMVY4YTEgMSAwIDAgMSAxLTF6bTEgMnY5aDEwVjlIOHpcIi8+PC9zdmc+JztcclxuXHJcbiAgICAgICAgY2xhc3MgVEUgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3IudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmxvY2FsZS5jb250ZW50TGFuZ3VhZ2VEaXJlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gaSA9PT0gXCJsdHJcIjtcclxuICAgICAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoXCJpbnNlcnRUYWJsZVwiLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb21tYW5kcy5nZXQoXCJpbnNlcnRUYWJsZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gV2IoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYnV0dG9uVmlldy5zZXQoe2ljb246IHlFLCBsYWJlbDogZShcImtpXCIpLCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHI7XHJcbiAgICAgICAgICAgICAgICAgICAgby5vbihcImNoYW5nZTppc09wZW5cIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgciA9IG5ldyBfRShpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5wYW5lbFZpZXcuY2hpbGRyZW4uYWRkKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByLmRlbGVnYXRlKFwiZXhlY3V0ZVwiKS50byhvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5idXR0b25WaWV3Lm9uKFwib3BlblwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnJvd3MgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgci5jb2x1bW5zID0gMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5vbihcImV4ZWN1dGVcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKFwiaW5zZXJ0VGFibGVcIiwge3Jvd3M6IHIucm93cywgY29sdW1uczogci5jb2x1bW5zfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC51aS5jb21wb25lbnRGYWN0b3J5LmFkZChcInRhYmxlQ29sdW1uXCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN3aXRjaGJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBcInNldFRhYmxlQ29sdW1uSGVhZGVyXCIsIGxhYmVsOiBlKFwia2pcIiksIGJpbmRJc09uOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHt0eXBlOiBcInNlcGFyYXRvclwifSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBuID8gXCJpbnNlcnRUYWJsZUNvbHVtbkxlZnRcIiA6IFwiaW5zZXJ0VGFibGVDb2x1bW5SaWdodFwiLCBsYWJlbDogZShcImtrXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJidXR0b25cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHtjb21tYW5kTmFtZTogbiA/IFwiaW5zZXJ0VGFibGVDb2x1bW5SaWdodFwiIDogXCJpbnNlcnRUYWJsZUNvbHVtbkxlZnRcIiwgbGFiZWw6IGUoXCJrbFwiKX1cclxuICAgICAgICAgICAgICAgICAgICB9LCB7dHlwZTogXCJidXR0b25cIiwgbW9kZWw6IHtjb21tYW5kTmFtZTogXCJyZW1vdmVUYWJsZUNvbHVtblwiLCBsYWJlbDogZShcImttXCIpfX1dO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9wcmVwYXJlRHJvcGRvd24oZShcImtuXCIpLCB4RSwgaSwgdClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC51aS5jb21wb25lbnRGYWN0b3J5LmFkZChcInRhYmxlUm93XCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN3aXRjaGJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBcInNldFRhYmxlUm93SGVhZGVyXCIsIGxhYmVsOiBlKFwia29cIiksIGJpbmRJc09uOiB0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHt0eXBlOiBcInNlcGFyYXRvclwifSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBcImluc2VydFRhYmxlUm93QmVsb3dcIiwgbGFiZWw6IGUoXCJrcFwiKX1cclxuICAgICAgICAgICAgICAgICAgICB9LCB7dHlwZTogXCJidXR0b25cIiwgbW9kZWw6IHtjb21tYW5kTmFtZTogXCJpbnNlcnRUYWJsZVJvd0Fib3ZlXCIsIGxhYmVsOiBlKFwia3FcIil9fSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBcInJlbW92ZVRhYmxlUm93XCIsIGxhYmVsOiBlKFwia3JcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgfV07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ByZXBhcmVEcm9wZG93bihlKFwia3NcIiksIENFLCBpLCB0KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKFwibWVyZ2VUYWJsZUNlbGxzXCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBcIm1lcmdlVGFibGVDZWxsVXBcIiwgbGFiZWw6IGUoXCJrdFwiKX1cclxuICAgICAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYnV0dG9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiB7Y29tbWFuZE5hbWU6IG4gPyBcIm1lcmdlVGFibGVDZWxsUmlnaHRcIiA6IFwibWVyZ2VUYWJsZUNlbGxMZWZ0XCIsIGxhYmVsOiBlKFwia3VcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwge3R5cGU6IFwiYnV0dG9uXCIsIG1vZGVsOiB7Y29tbWFuZE5hbWU6IFwibWVyZ2VUYWJsZUNlbGxEb3duXCIsIGxhYmVsOiBlKFwia3ZcIil9fSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBuID8gXCJtZXJnZVRhYmxlQ2VsbExlZnRcIiA6IFwibWVyZ2VUYWJsZUNlbGxSaWdodFwiLCBsYWJlbDogZShcImt3XCIpfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHt0eXBlOiBcInNlcGFyYXRvclwifSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJ1dHRvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDoge2NvbW1hbmROYW1lOiBcInNwbGl0VGFibGVDZWxsVmVydGljYWxseVwiLCBsYWJlbDogZShcImt4XCIpfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHt0eXBlOiBcImJ1dHRvblwiLCBtb2RlbDoge2NvbW1hbmROYW1lOiBcInNwbGl0VGFibGVDZWxsSG9yaXpvbnRhbGx5XCIsIGxhYmVsOiBlKFwia3lcIil9fV07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ByZXBhcmVEcm9wZG93bihlKFwia3pcIiksIEFFLCBpLCB0KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX3ByZXBhcmVEcm9wZG93bih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gV2Iobik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gW107XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gbmV3IHlzO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBQRSh0LCBvLCBzLCBhKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgVWIociwgYSwgby51aS5jb21wb25lbnRGYWN0b3J5KTtcclxuICAgICAgICAgICAgICAgIHIuYnV0dG9uVmlldy5zZXQoe2xhYmVsOiB0LCBpY29uOiBlLCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICByLmJpbmQoXCJpc0VuYWJsZWRcIikudG9NYW55KHMsIFwiaXNFbmFibGVkXCIsICguLi50KSA9PiB0LnNvbWUodCA9PiB0KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHIsIFwiZXhlY3V0ZVwiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBvLmV4ZWN1dGUodC5zb3VyY2UuY29tbWFuZE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUEUodCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICBjb25zdCBvID0gdC5tb2RlbCA9IG5ldyBlXyh0Lm1vZGVsKTtcclxuICAgICAgICAgICAgY29uc3Qge2NvbW1hbmROYW1lOiByLCBiaW5kSXNPbjogc30gPSB0Lm1vZGVsO1xyXG4gICAgICAgICAgICBpZiAodC50eXBlID09PSBcImJ1dHRvblwiIHx8IHQudHlwZSA9PT0gXCJzd2l0Y2hidXR0b25cIikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuY29tbWFuZHMuZ2V0KHIpO1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKHQpO1xyXG4gICAgICAgICAgICAgICAgby5zZXQoe2NvbW1hbmROYW1lOiByfSk7XHJcbiAgICAgICAgICAgICAgICBvLmJpbmQoXCJpc0VuYWJsZWRcIikudG8odCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYmluZChcImlzT25cIikudG8odCwgXCJ2YWx1ZVwiKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG8uc2V0KHt3aXRoVGV4dDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICBuLmFkZCh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgU0UgZXh0ZW5kcyBKdSB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudFR5cGUgPSBbXCJtb3VzZW1vdmVcIiwgXCJtb3VzZXVwXCIsIFwibW91c2VsZWF2ZVwiXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvbkRvbUV2ZW50KHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlyZSh0LnR5cGUsIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEVFKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IEFycmF5LmZyb20odCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuWzBdO1xyXG4gICAgICAgICAgICBjb25zdCByID0gbltuLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBjb25zdCB7cm93OiBzLCBjb2x1bW46IGF9ID0gZS5nZXRDZWxsTG9jYXRpb24obyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSBSRShuLCBhLCBpLCBlKTtcclxuICAgICAgICAgICAgY29uc3Qge3JvdzogbCwgY29sdW1uOiBkfSA9IGUuZ2V0Q2VsbExvY2F0aW9uKHIpO1xyXG4gICAgICAgICAgICBjb25zdCB1ID0gZCAtIGEgKyAxO1xyXG4gICAgICAgICAgICBjb25zdCBoID0gbCAtIHMgKyAxO1xyXG4gICAgICAgICAgICBJRShjLCB1LCBoLCBpLCBlKTtcclxuICAgICAgICAgICAgY29uc3QgZiA9IFdQKFwidGFibGVcIiwgbyk7XHJcbiAgICAgICAgICAgIFZFKGMsIGYsIHMsIGEsIGkpO1xyXG4gICAgICAgICAgICByZXR1cm4gY1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gUkUodCwgZSwgaSwgbikge1xyXG4gICAgICAgICAgICBjb25zdCBvID0gaS5jcmVhdGVFbGVtZW50KFwidGFibGVcIik7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBXUChcInRhYmxlUm93XCIsIGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFyLmhhcyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Ll9jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuYXBwZW5kKGUsIG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIHIuc2V0KHQsIGUpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gZS5fY2xvbmUodHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7Y29sdW1uOiBjfSA9IG4uZ2V0Q2VsbExvY2F0aW9uKGUpO1xyXG4gICAgICAgICAgICAgICAgcy5zZXQoYSwgYyk7XHJcbiAgICAgICAgICAgICAgICBpLmFwcGVuZChhLCByLmdldCh0KSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBPRShvLCBlLCBzLCBpLCBuKTtcclxuICAgICAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE9FKHQsIGUsIGksIG4sIG8pIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIHQuZ2V0Q2hpbGRyZW4oKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIEFycmF5LmZyb20oci5nZXRDaGlsZHJlbigpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHtjb2x1bW46IHJ9ID0gby5nZXRDZWxsTG9jYXRpb24odCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IGkuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzIC0gZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAociAhPT0gYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IGEgLSByOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuLmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZUNlbGxcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmluc2VydChlLCBuLmNyZWF0ZVBvc2l0aW9uQmVmb3JlKHQpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuLmNyZWF0ZUVsZW1lbnQoXCJwYXJhZ3JhcGhcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmluc2VydChpLCBlLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uaW5zZXJ0VGV4dChcIlwiLCBpLCAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBJRSh0LCBlLCBpLCBuLCBvKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgciBvZiB0LmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiByLmdldENoaWxkcmVuKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gcGFyc2VJbnQodC5nZXRBdHRyaWJ1dGUoXCJjb2xzcGFuXCIpIHx8IDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBwYXJzZUludCh0LmdldEF0dHJpYnV0ZShcInJvd3NwYW5cIikgfHwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qge3JvdzogYSwgY29sdW1uOiBjfSA9IG8uZ2V0Q2VsbExvY2F0aW9uKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjICsgciA+IGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IGUgLSBjO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc2V0QXR0cmlidXRlKFwiY29sc3BhblwiLCBpLCB0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5yZW1vdmVBdHRyaWJ1dGUoXCJjb2xzcGFuXCIsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgKyBzID4gaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaSAtIGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5zZXRBdHRyaWJ1dGUoXCJyb3dzcGFuXCIsIGUsIHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnJlbW92ZUF0dHJpYnV0ZShcInJvd3NwYW5cIiwgdClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gVkUodCwgZSwgaSwgbiwgbykge1xyXG4gICAgICAgICAgICBjb25zdCByID0gcGFyc2VJbnQoZS5nZXRBdHRyaWJ1dGUoXCJoZWFkaW5nUm93c1wiKSB8fCAwKTtcclxuICAgICAgICAgICAgaWYgKHIgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gciAtIGk7XHJcbiAgICAgICAgICAgICAgICBvLnNldEF0dHJpYnV0ZShcImhlYWRpbmdSb3dzXCIsIGUsIHQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgcyA9IHBhcnNlSW50KGUuZ2V0QXR0cmlidXRlKFwiaGVhZGluZ0NvbHVtbnNcIikgfHwgMCk7XHJcbiAgICAgICAgICAgIGlmIChzID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHMgLSBuO1xyXG4gICAgICAgICAgICAgICAgby5zZXRBdHRyaWJ1dGUoXCJoZWFkaW5nQ29sdW1uc1wiLCBlLCB0KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgTkUgPSBpKDk2KTtcclxuXHJcbiAgICAgICAgY2xhc3MgTUUgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlRhYmxlU2VsZWN0aW9uXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbUVNdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oZSwgXCJkZWxldGVDb250ZW50XCIsICh0LCBlKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDb250ZW50KHQsIGUpLCB7cHJpb3JpdHk6IFwiaGlnaFwifSk7XHJcbiAgICAgICAgICAgICAgICB0LmVkaXRpbmcudmlldy5hZGRPYnNlcnZlcihTRSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZpbmVTZWxlY3Rpb25Db252ZXJ0ZXIoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZVNoaWZ0Q2xpY2tTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZU1vdXNlRHJhZ1NlbGVjdGlvbigpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldFNlbGVjdGVkVGFibGVDZWxscygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gb1ModCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRTZWxlY3Rpb25Bc0ZyYWdtZW50KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZ2V0U2VsZWN0ZWRUYWJsZUNlbGxzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdG9yLm1vZGVsLmNoYW5nZShlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IEVFKHQsIHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVVdGlsc1wiKSwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5pbnNlcnQobiwgaSwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9kZWZpbmVTZWxlY3Rpb25Db252ZXJ0ZXIoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFNldDtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5mb3IoXCJlZGl0aW5nRG93bmNhc3RcIikuYWRkKHQgPT4gdC5vbihcInNlbGVjdGlvblwiLCAodCwgbiwgbykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBvLndyaXRlcjtcclxuICAgICAgICAgICAgICAgICAgICBpKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLmdldFNlbGVjdGVkVGFibGVDZWxscygpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG8ubWFwcGVyLnRvVmlld0VsZW1lbnQodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIuYWRkQ2xhc3MoXCJjay1lZGl0b3JfX2VkaXRhYmxlX3NlbGVjdGVkXCIsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmFkZChpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gby5tYXBwZXIudG9WaWV3RWxlbWVudChzW3MubGVuZ3RoIC0gMV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHIuc2V0U2VsZWN0aW9uKGEsIDApXHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93ZXN0XCJ9KSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gaSh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5yZW1vdmVDbGFzcyhcImNrLWVkaXRvcl9fZWRpdGFibGVfc2VsZWN0ZWRcIiwgaSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZS5jbGVhcigpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9lbmFibGVTaGlmdENsaWNrU2VsZWN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgbGV0IGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQsIFwibW91c2Vkb3duXCIsIChpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzRW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuLmRvbUV2ZW50LnNoaWZ0S2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gclModC5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb24pWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuX2dldE1vZGVsVGFibGVDZWxsRnJvbURvbUV2ZW50KG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyICYmIHpFKG8sIHIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRDZWxsU2VsZWN0aW9uKG8sIHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLnByZXZlbnREZWZhdWx0KClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQsIFwibW91c2V1cFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZSA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQsIFwic2VsZWN0aW9uQ2hhbmdlXCIsIHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuc3RvcCgpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImhpZ2hlc3RcIn0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9lbmFibGVNb3VzZURyYWdTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBsZXQgZSwgaTtcclxuICAgICAgICAgICAgICAgIGxldCBuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBsZXQgbyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LmVkaXRpbmcudmlldy5kb2N1bWVudCwgXCJtb3VzZWRvd25cIiwgKHQsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNFbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoaS5kb21FdmVudC5zaGlmdEtleSB8fCBpLmRvbUV2ZW50LmN0cmxLZXkgfHwgaS5kb21FdmVudC5hbHRLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLl9nZXRNb2RlbFRhYmxlQ2VsbEZyb21Eb21FdmVudChpKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQuZWRpdGluZy52aWV3LmRvY3VtZW50LCBcIm1vdXNlbW92ZVwiLCAodCwgcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghci5kb21FdmVudC5idXR0b25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0aGlzLl9nZXRNb2RlbFRhYmxlQ2VsbEZyb21Eb21FdmVudChyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocyAmJiB6RShlLCBzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFuICYmIGkgIT0gZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIG8gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldENlbGxTZWxlY3Rpb24oZSwgaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgci5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQsIFwibW91c2V1cFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICBpID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQuZWRpdGluZy52aWV3LmRvY3VtZW50LCBcInNlbGVjdGlvbkNoYW5nZVwiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfaGFuZGxlRGVsZXRlQ29udGVudCh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBbaSwgbl0gPSBlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9ICFuIHx8IG4uZGlyZWN0aW9uID09IFwiYmFja3dhcmRcIjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvUyhpKTtcclxuICAgICAgICAgICAgICAgIGlmICghcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQuc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgby5jaGFuZ2UodCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHNbciA/IHMubGVuZ3RoIC0gMSA6IDBdO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kZWxldGVDb250ZW50KHQuY3JlYXRlU2VsZWN0aW9uKGUsIFwiaW5cIikpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gby5zY2hlbWEuZ2V0TmVhcmVzdFNlbGVjdGlvblJhbmdlKHQuY3JlYXRlUG9zaXRpb25BdChlLCAwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkuaXMoXCJkb2N1bWVudFNlbGVjdGlvblwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24obilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkuc2V0VG8obilcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9zZXRDZWxsU2VsZWN0aW9uKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLl9nZXRDZWxsc1RvU2VsZWN0KHQsIGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IubW9kZWwuY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc2V0U2VsZWN0aW9uKGkuY2VsbHMubWFwKGUgPT4gdC5jcmVhdGVSYW5nZU9uKGUpKSwge2JhY2t3YXJkOiBpLmJhY2t3YXJkfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRNb2RlbFRhYmxlQ2VsbEZyb21Eb21FdmVudCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5lZGl0b3IuZWRpdGluZy52aWV3LmNyZWF0ZVBvc2l0aW9uQXQoZSwgMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5lZGl0b3IuZWRpdGluZy5tYXBwZXIudG9Nb2RlbFBvc2l0aW9uKGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoby5pcyhcInRhYmxlQ2VsbFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gV1AoXCJ0YWJsZUNlbGxcIiwgbylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldENlbGxzVG9TZWxlY3QodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVVdGlsc1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmdldENlbGxMb2NhdGlvbih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBpLmdldENlbGxMb2NhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBNYXRoLm1pbihuLnJvdywgby5yb3cpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IE1hdGgubWF4KG4ucm93LCBvLnJvdyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gTWF0aC5taW4obi5jb2x1bW4sIG8uY29sdW1uKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBNYXRoLm1heChuLmNvbHVtbiwgby5jb2x1bW4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIG5ldyBaUChXUChcInRhYmxlXCIsIHQpLCB7c3RhcnRSb3c6IHIsIGVuZFJvdzogc30pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuY29sdW1uID49IGEgJiYgZS5jb2x1bW4gPD0gYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsLnB1c2goZS5jZWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChCRShuLCBvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7Y2VsbHM6IGwucmV2ZXJzZSgpLCBiYWNrd2FyZDogdHJ1ZX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB7Y2VsbHM6IGwsIGJhY2t3YXJkOiBmYWxzZX1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQkUodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAodC5yb3cgPiBlLnJvdykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5yb3cgPT0gZS5yb3cgJiYgdC5jb2x1bW4gPiBlLmNvbHVtbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHpFKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQucGFyZW50LnBhcmVudCA9PSBlLnBhcmVudC5wYXJlbnRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIExFIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUYWJsZUNsaXBib2FyZFwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW01FXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZWRpdGluZy52aWV3LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhlLCBcImNvcHlcIiwgKHQsIGUpID0+IHRoaXMuX29uQ29weUN1dCh0LCBlKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGUsIFwiY3V0XCIsICh0LCBlKSA9PiB0aGlzLl9vbkNvcHlDdXQodCwgZSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9vbkNvcHlDdXQodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFwiVGFibGVTZWxlY3Rpb25cIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuZ2V0U2VsZWN0ZWRUYWJsZUNlbGxzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0Lm5hbWUgPT0gXCJjdXRcIiAmJiB0aGlzLmVkaXRvci5pc1JlYWRPbmx5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0LnN0b3AoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLnRvVmlldyhpLmdldFNlbGVjdGlvbkFzRnJhZ21lbnQoKSk7XHJcbiAgICAgICAgICAgICAgICBvLmZpcmUoXCJjbGlwYm9hcmRPdXRwdXRcIiwge2RhdGFUcmFuc2ZlcjogZS5kYXRhVHJhbnNmZXIsIGNvbnRlbnQ6IHIsIG1ldGhvZDogdC5uYW1lfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEZFID0gaSg5OCk7XHJcblxyXG4gICAgICAgIGNsYXNzIERFIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt3RSwgVEUsIE1FLCBMRSwgRnZdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlRhYmxlXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGpFID0gaSgxMDApO1xyXG5cclxuICAgICAgICBjbGFzcyBIRSBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gYGNrLWxhYmVsZWQtdmlldy0ke2lzKCl9YDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBgY2stbGFiZWxlZC12aWV3LXN0YXR1cy0ke2lzKCl9YDtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldyA9IGUodGhpcywgaSwgbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpc0VuYWJsZWRcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImVycm9yVGV4dFwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaW5mb1RleHRcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImNsYXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYWJlbFZpZXcgPSB0aGlzLl9jcmVhdGVMYWJlbFZpZXcoaSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXR1c1ZpZXcgPSB0aGlzLl9jcmVhdGVTdGF0dXNWaWV3KG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5iaW5kKFwiX3N0YXR1c1RleHRcIikudG8odGhpcywgXCJlcnJvclRleHRcIiwgdGhpcywgXCJpbmZvVGV4dFwiLCAodCwgZSkgPT4gdCB8fCBlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLmJpbmRUZW1wbGF0ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2stbGFiZWxlZC12aWV3XCIsIG8udG8oXCJjbGFzc1wiKSwgby5pZihcImlzRW5hYmxlZFwiLCBcImNrLWRpc2FibGVkXCIsIHQgPT4gIXQpXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFt0aGlzLmxhYmVsVmlldywgdGhpcy52aWV3LCB0aGlzLnN0YXR1c1ZpZXddXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlTGFiZWxWaWV3KHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgTWsodGhpcy5sb2NhbGUpO1xyXG4gICAgICAgICAgICAgICAgZS5mb3IgPSB0O1xyXG4gICAgICAgICAgICAgICAgZS5iaW5kKFwidGV4dFwiKS50byh0aGlzLCBcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVN0YXR1c1ZpZXcodCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBHcCh0aGlzLmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICBlLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZGl2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogW1wiY2tcIiwgXCJjay1sYWJlbGVkLXZpZXdfX3N0YXR1c1wiLCBpLmlmKFwiZXJyb3JUZXh0XCIsIFwiY2stbGFiZWxlZC12aWV3X19zdGF0dXNfZXJyb3JcIiksIGkuaWYoXCJfc3RhdHVzVGV4dFwiLCBcImNrLWhpZGRlblwiLCB0ID0+ICF0KV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb2xlOiBpLmlmKFwiZXJyb3JUZXh0XCIsIFwiYWxlcnRcIilcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IGkudG8oXCJfc3RhdHVzVGV4dFwiKX1dXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvY3VzKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gV0UodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IFl2KHQubG9jYWxlKTtcclxuICAgICAgICAgICAgbi5zZXQoe2lkOiBlLCBhcmlhRGVzY3JpYmVkQnlJZDogaX0pO1xyXG4gICAgICAgICAgICBuLmJpbmQoXCJpc1JlYWRPbmx5XCIpLnRvKHQsIFwiaXNFbmFibGVkXCIsIHQgPT4gIXQpO1xyXG4gICAgICAgICAgICBuLmJpbmQoXCJoYXNFcnJvclwiKS50byh0LCBcImVycm9yVGV4dFwiLCB0ID0+ICEhdCk7XHJcbiAgICAgICAgICAgIG4ub24oXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0LmVycm9yVGV4dCA9IG51bGxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBxRSh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBXYih0LmxvY2FsZSk7XHJcbiAgICAgICAgICAgIG4uc2V0KHtpZDogZSwgYXJpYURlc2NyaWJlZEJ5SWQ6IGl9KTtcclxuICAgICAgICAgICAgbi5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIFVFID0gaSgxMDIpO1xyXG5cclxuICAgICAgICBjbGFzcyAkRSBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5iaW5kVGVtcGxhdGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcInZhbHVlXCIsIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJpZFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiaXNSZWFkT25seVwiLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcImhhc0Vycm9yXCIsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiYXJpYURlc2NyaWJlZEJ5SWRcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZHJvcGRvd25WaWV3ID0gdGhpcy5fY3JlYXRlRHJvcGRvd25WaWV3KHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5wdXRWaWV3ID0gdGhpcy5fY3JlYXRlSW5wdXRUZXh0Vmlldyh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBbXCJja1wiLCBcImNrLWlucHV0LWNvbG9yXCIsIGkuaWYoXCJoYXNFcnJvclwiLCBcImNrLWVycm9yXCIpXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGkudG8oXCJpZFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcmlhLWludmFsaWRcIjogaS5pZihcImhhc0Vycm9yXCIsIHRydWUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFyaWEtZGVzY3JpYmVkYnlcIjogaS50byhcImFyaWFEZXNjcmliZWRCeUlkXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3RoaXMuX2lucHV0VmlldywgdGhpcy5fZHJvcGRvd25WaWV3XVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZm9jdXMoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnB1dFZpZXcuZm9jdXMoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlRHJvcGRvd25WaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX2NyZWF0ZUNvbG9yR3JpZCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBXYih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgR3A7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5fY3JlYXRlUmVtb3ZlQ29sb3JCdXR0b24odCk7XHJcbiAgICAgICAgICAgICAgICBvLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFtcImNrXCIsIFwiY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlld1wiXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHtiYWNrZ3JvdW5kQ29sb3I6IGUudG8oXCJ2YWx1ZVwiKX1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWc6IFwic3BhblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7Y2xhc3M6IFtcImNrXCIsIFwiY2staW5wdXQtY29sb3JfX2J1dHRvbl9fcHJldmlld19fbm8tY29sb3ItaW5kaWNhdG9yXCIsIGUuaWYoXCJ2YWx1ZVwiLCBcImNrLWhpZGRlblwiLCB0ID0+IHQgIT0gXCJcIildfVxyXG4gICAgICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIG4uYnV0dG9uVmlldy5leHRlbmRUZW1wbGF0ZSh7YXR0cmlidXRlczoge2NsYXNzOiBcImNrLWlucHV0LWNvbG9yX19idXR0b25cIn19KTtcclxuICAgICAgICAgICAgICAgIG4uYnV0dG9uVmlldy5jaGlsZHJlbi5hZGQobyk7XHJcbiAgICAgICAgICAgICAgICBuLnBhbmVsUG9zaXRpb24gPSB0LnVpTGFuZ3VhZ2VEaXJlY3Rpb24gPT09IFwicnRsXCIgPyBcInNlXCIgOiBcInN3XCI7XHJcbiAgICAgICAgICAgICAgICBuLnBhbmVsVmlldy5jaGlsZHJlbi5hZGQocik7XHJcbiAgICAgICAgICAgICAgICBuLnBhbmVsVmlldy5jaGlsZHJlbi5hZGQoaSk7XHJcbiAgICAgICAgICAgICAgICBuLmJpbmQoXCJpc0VuYWJsZWRcIikudG8odGhpcywgXCJpc1JlYWRPbmx5XCIsIHQgPT4gIXQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUlucHV0VGV4dFZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5sb2NhbGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFl2KHQpO1xyXG4gICAgICAgICAgICAgICAgZS5iaW5kKFwidmFsdWVcIikudG8odGhpcyk7XHJcbiAgICAgICAgICAgICAgICBlLmJpbmQoXCJpc1JlYWRPbmx5XCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgZS5iaW5kKFwiaGFzRXJyb3JcIikudG8odGhpcyk7XHJcbiAgICAgICAgICAgICAgICBlLm9uKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBlLmVsZW1lbnQudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgZS5kZWxlZ2F0ZShcImlucHV0XCIpLnRvKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVJlbW92ZUNvbG9yQnV0dG9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgaGIodCk7XHJcbiAgICAgICAgICAgICAgICBpLmNsYXNzID0gXCJjay1pbnB1dC1jb2xvcl9fcmVtb3ZlLWNvbG9yXCI7XHJcbiAgICAgICAgICAgICAgICBpLndpdGhUZXh0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGkuaWNvbiA9IHprO1xyXG4gICAgICAgICAgICAgICAgaS5sYWJlbCA9IGUoXCJsaVwiKTtcclxuICAgICAgICAgICAgICAgIGkub24oXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kcm9wZG93blZpZXcuaXNPcGVuID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maXJlKFwiaW5wdXRcIilcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUNvbG9yR3JpZCh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IFZrKHQsIHtjb2xvckRlZmluaXRpb25zOiB0aGlzLm9wdGlvbnMuY29sb3JEZWZpbml0aW9ucywgY29sdW1uczogdGhpcy5vcHRpb25zLmNvbHVtbnN9KTtcclxuICAgICAgICAgICAgICAgIGUub24oXCJleGVjdXRlXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGUudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHJvcGRvd25WaWV3LmlzT3BlbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImlucHV0XCIpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGUuYmluZChcInNlbGVjdGVkQ29sb3JcIikudG8odGhpcywgXCJ2YWx1ZVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IEdFID0gbmIuZGVmYXVsdFBvc2l0aW9ucztcclxuICAgICAgICBjb25zdCBLRSA9IFtHRS5ub3J0aEFycm93U291dGgsIEdFLm5vcnRoQXJyb3dTb3V0aFdlc3QsIEdFLm5vcnRoQXJyb3dTb3V0aEVhc3QsIEdFLnNvdXRoQXJyb3dOb3J0aCwgR0Uuc291dGhBcnJvd05vcnRoV2VzdCwgR0Uuc291dGhBcnJvd05vcnRoRWFzdF07XHJcbiAgICAgICAgY29uc3QgSkUgPSB0ID0+IHQgPT09IFwiXCI7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFlFKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQucGx1Z2lucy5nZXQoXCJDb250ZXh0dWFsQmFsbG9vblwiKTtcclxuICAgICAgICAgICAgaWYgKG5TKHQuZWRpdGluZy52aWV3LmRvY3VtZW50LnNlbGVjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGxldCBuO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT09IFwiY2VsbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbiA9IFhFKHQpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG4gPSBRRSh0KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS51cGRhdGVQb3NpdGlvbihuKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBRRSh0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbi5nZXRGaXJzdFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBXUChcInRhYmxlXCIsIGUpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5lZGl0aW5nLm1hcHBlci50b1ZpZXdFbGVtZW50KGkpO1xyXG4gICAgICAgICAgICByZXR1cm4ge3RhcmdldDogdC5lZGl0aW5nLnZpZXcuZG9tQ29udmVydGVyLnZpZXdUb0RvbShuKSwgcG9zaXRpb25zOiBLRX1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFhFKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHVSKHQubW9kZWwuZG9jdW1lbnQuc2VsZWN0aW9uLmdldEZpcnN0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0LmVkaXRpbmcubWFwcGVyLnRvVmlld0VsZW1lbnQoZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB7dGFyZ2V0OiB0LmVkaXRpbmcudmlldy5kb21Db252ZXJ0ZXIudmlld1RvRG9tKGkpLCBwb3NpdGlvbnM6IEtFfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gWkUodCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgbm9uZTogdChcIm1xXCIpLFxyXG4gICAgICAgICAgICAgICAgc29saWQ6IHQoXCJtclwiKSxcclxuICAgICAgICAgICAgICAgIGRvdHRlZDogdChcIm1zXCIpLFxyXG4gICAgICAgICAgICAgICAgZGFzaGVkOiB0KFwibXRcIiksXHJcbiAgICAgICAgICAgICAgICBkb3VibGU6IHQoXCJtdVwiKSxcclxuICAgICAgICAgICAgICAgIGdyb292ZTogdChcIm12XCIpLFxyXG4gICAgICAgICAgICAgICAgcmlkZ2U6IHQoXCJtd1wiKSxcclxuICAgICAgICAgICAgICAgIGluc2V0OiB0KFwibXhcIiksXHJcbiAgICAgICAgICAgICAgICBvdXRzZXQ6IHQoXCJteVwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0Uih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0KFwibXpcIilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVSKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQoXCJuYVwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaVIodCkge1xyXG4gICAgICAgICAgICB0ID0gdC50cmltKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBKRSh0KSB8fCB0Qyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gblIodCkge1xyXG4gICAgICAgICAgICB0ID0gdC50cmltKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBKRSh0KSB8fCBsUih0KSB8fCBvQyh0KSB8fCBzQyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb1IodCkge1xyXG4gICAgICAgICAgICB0ID0gdC50cmltKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBKRSh0KSB8fCBsUih0KSB8fCBvQyh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gclIodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IHlzO1xyXG4gICAgICAgICAgICBjb25zdCBpID0gWkUodC50KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBuIGluIGkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJidXR0b25cIixcclxuICAgICAgICAgICAgICAgICAgICBtb2RlbDogbmV3IGVfKHtfYm9yZGVyU3R5bGVWYWx1ZTogbiA9PT0gXCJub25lXCIgPyBcIlwiIDogbiwgbGFiZWw6IGlbbl0sIHdpdGhUZXh0OiB0cnVlfSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBpZiAobiA9PT0gXCJub25lXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvLm1vZGVsLmJpbmQoXCJpc09uXCIpLnRvKHQsIFwiYm9yZGVyU3R5bGVcIiwgdCA9PiAhdClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgby5tb2RlbC5iaW5kKFwiaXNPblwiKS50byh0LCBcImJvcmRlclN0eWxlXCIsIHQgPT4gdCA9PT0gbilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUuYWRkKG8pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNSKHt2aWV3OiB0LCBpY29uczogZSwgdG9vbGJhcjogaSwgbGFiZWxzOiBuLCBwcm9wZXJ0eU5hbWU6IG8sIG5hbWVUb1ZhbHVlOiByfSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHMgaW4gbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IG5ldyBoYih0LmxvY2FsZSk7XHJcbiAgICAgICAgICAgICAgICBhLnNldCh7bGFiZWw6IG5bc10sIGljb246IGVbc119KTtcclxuICAgICAgICAgICAgICAgIGEuYmluZChcImlzT25cIikudG8odCwgbywgdCA9PiB0ID09PSByKHMpKTtcclxuICAgICAgICAgICAgICAgIGEub24oXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0W29dID0gcihzKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpLml0ZW1zLmFkZChhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBhUiA9IFt7Y29sb3I6IFwiaHNsKDAsIDAlLCAwJSlcIiwgbGFiZWw6IFwiQmxhY2tcIn0sIHtcclxuICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDAlLCAzMCUpXCIsXHJcbiAgICAgICAgICAgIGxhYmVsOiBcIkRpbSBncmV5XCJcclxuICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDAsIDAlLCA2MCUpXCIsIGxhYmVsOiBcIkdyZXlcIn0sIHtcclxuICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDAlLCA5MCUpXCIsXHJcbiAgICAgICAgICAgIGxhYmVsOiBcIkxpZ2h0IGdyZXlcIlxyXG4gICAgICAgIH0sIHtjb2xvcjogXCJoc2woMCwgMCUsIDEwMCUpXCIsIGxhYmVsOiBcIldoaXRlXCIsIGhhc0JvcmRlcjogdHJ1ZX0sIHtcclxuICAgICAgICAgICAgY29sb3I6IFwiaHNsKDAsIDc1JSwgNjAlKVwiLFxyXG4gICAgICAgICAgICBsYWJlbDogXCJSZWRcIlxyXG4gICAgICAgIH0sIHtjb2xvcjogXCJoc2woMzAsIDc1JSwgNjAlKVwiLCBsYWJlbDogXCJPcmFuZ2VcIn0sIHtcclxuICAgICAgICAgICAgY29sb3I6IFwiaHNsKDYwLCA3NSUsIDYwJSlcIixcclxuICAgICAgICAgICAgbGFiZWw6IFwiWWVsbG93XCJcclxuICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDkwLCA3NSUsIDYwJSlcIiwgbGFiZWw6IFwiTGlnaHQgZ3JlZW5cIn0sIHtcclxuICAgICAgICAgICAgY29sb3I6IFwiaHNsKDEyMCwgNzUlLCA2MCUpXCIsXHJcbiAgICAgICAgICAgIGxhYmVsOiBcIkdyZWVuXCJcclxuICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDE1MCwgNzUlLCA2MCUpXCIsIGxhYmVsOiBcIkFxdWFtYXJpbmVcIn0sIHtcclxuICAgICAgICAgICAgY29sb3I6IFwiaHNsKDE4MCwgNzUlLCA2MCUpXCIsXHJcbiAgICAgICAgICAgIGxhYmVsOiBcIlR1cnF1b2lzZVwiXHJcbiAgICAgICAgfSwge2NvbG9yOiBcImhzbCgyMTAsIDc1JSwgNjAlKVwiLCBsYWJlbDogXCJMaWdodCBibHVlXCJ9LCB7XHJcbiAgICAgICAgICAgIGNvbG9yOiBcImhzbCgyNDAsIDc1JSwgNjAlKVwiLFxyXG4gICAgICAgICAgICBsYWJlbDogXCJCbHVlXCJcclxuICAgICAgICB9LCB7Y29sb3I6IFwiaHNsKDI3MCwgNzUlLCA2MCUpXCIsIGxhYmVsOiBcIlB1cnBsZVwifV07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNSKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbmV3ICRFKGUubG9jYWxlLCB7Y29sb3JEZWZpbml0aW9uczogZFIodC5jb2xvckNvbmZpZyksIGNvbHVtbnM6IHQuY29sdW1uc30pO1xyXG4gICAgICAgICAgICAgICAgby5zZXQoe2lkOiBpLCBhcmlhRGVzY3JpYmVkQnlJZDogbn0pO1xyXG4gICAgICAgICAgICAgICAgby5iaW5kKFwiaXNSZWFkT25seVwiKS50byhlLCBcImlzRW5hYmxlZFwiLCB0ID0+ICF0KTtcclxuICAgICAgICAgICAgICAgIG8uYmluZChcImVycm9yVGV4dFwiKS50byhlKTtcclxuICAgICAgICAgICAgICAgIG8ub24oXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5lcnJvclRleHQgPSBudWxsXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxSKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IHBhcnNlRmxvYXQodCk7XHJcbiAgICAgICAgICAgIHJldHVybiAhTnVtYmVyLmlzTmFOKGUpICYmIHQgPT09IFN0cmluZyhlKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZFIodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdC5tYXAodCA9PiAoe2NvbG9yOiB0Lm1vZGVsLCBsYWJlbDogdC5sYWJlbCwgb3B0aW9uczoge2hhc0JvcmRlcjogdC5oYXNCb3JkZXJ9fSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB1Uih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm5vZGVBZnRlciAmJiB0Lm5vZGVBZnRlci5pcyhcInRhYmxlQ2VsbFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPyB0Lm5vZGVBZnRlciA6IFdQKFwidGFibGVDZWxsXCIsIHQpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaFIgPSBpKDEwNCk7XHJcblxyXG4gICAgICAgIGNsYXNzIGZSIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJjbGFzc1wiLCBlLmNsYXNzIHx8IG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmNoaWxkcmVuLmZvckVhY2godCA9PiB0aGlzLmNoaWxkcmVuLmFkZCh0KSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KFwiX3JvbGVcIiwgbnVsbCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldChcIl9hcmlhTGFiZWxsZWRCeVwiLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIGlmIChlLmxhYmVsVmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0KHtfcm9sZTogXCJncm91cFwiLCBfYXJpYUxhYmVsbGVkQnk6IGUubGFiZWxWaWV3LmlkfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJkaXZcIixcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBbXCJja1wiLCBcImNrLWZvcm1fX3Jvd1wiLCBpLnRvKFwiY2xhc3NcIildLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb2xlOiBpLnRvKFwiX3JvbGVcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IGkudG8oXCJfYXJpYUxhYmVsbGVkQnlcIilcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiB0aGlzLmNoaWxkcmVuXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgZ1IgPSBpKDEwNik7XHJcblxyXG4gICAgICAgIGNsYXNzIG1SIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlID0ge30pIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuYmluZFRlbXBsYXRlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuY3JlYXRlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJjbGFzc1wiLCBlLmNsYXNzIHx8IG51bGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoXCJsYWJlbFwiLCBlLmxhYmVsIHx8IFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBHcCh0KTtcclxuICAgICAgICAgICAgICAgIG4uc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJzcGFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJja1wiLCBcImNrLWZvcm1fX2hlYWRlcl9fbGFiZWxcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IGkudG8oXCJsYWJlbFwiKX1dXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uYWRkKG4pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRUZW1wbGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFnOiBcImRpdlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1mb3JtX19oZWFkZXJcIiwgaS50byhcImNsYXNzXCIpXX0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBwUiA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xMC4yNjEgNy4wNjJsMi44OCAxLjY2M2EuNzUuNzUgMCAwIDEtLjc1IDEuM0wxMC41IDguOTMzdjcuMzE3YS43NS43NSAwIDEgMS0xLjUgMFY4LjkzMmwtMS44OSAxLjA5M2EuNzUuNzUgMCAwIDEtLjc1LTEuM2wyLjg3OS0xLjY2M2EuNzUyLjc1MiAwIDAgMSAuNTExLS4xODcuNzUyLjc1MiAwIDAgMSAuNTExLjE4N3pNMTUuMjUgNGEuNzUuNzUgMCAxIDEgMCAxLjVINC43NWEuNzUuNzUgMCAwIDEgMC0xLjVoMTAuNXpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgYlIgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNOS43NSAxMS44NzVhLjc1Mi43NTIgMCAwIDEgLjUwOC4xODRsMi44ODMgMS42NjZhLjc1Ljc1IDAgMCAxLS42NTkgMS4zNDRsLS4wOTEtLjA0NC0xLjg5Mi0xLjA5My4wMDEgNC4zMThhLjc1Ljc1IDAgMSAxLTEuNSAwdi00LjMxN2wtMS44OSAxLjA5MmEuNzUuNzUgMCAwIDEtLjc1LTEuM2wyLjg3OS0xLjY2M2EuNzUyLjc1MiAwIDAgMSAuNTEtLjE4N3pNMTUuMjUgOWEuNzUuNzUgMCAxIDEgMCAxLjVINC43NWEuNzUuNzUgMCAxIDEgMC0xLjVoMTAuNXpNOS43NS4zNzVhLjc1Ljc1IDAgMCAxIC43NS43NXY0LjMxOGwxLjg5LTEuMDkzLjA5Mi0uMDQ1YS43NS43NSAwIDAgMSAuNjU5IDEuMzQ0bC0yLjg4MyAxLjY2N2EuNzUyLjc1MiAwIDAgMS0uNTA4LjE4NC43NTIuNzUyIDAgMCAxLS41MTEtLjE4N0w2LjM1OSA1LjY1YS43NS43NSAwIDAgMSAuNzUtMS4yOTlMOSA1LjQ0MlYxLjEyNWEuNzUuNzUgMCAwIDEgLjc1LS43NXpcIi8+PC9zdmc+JztcclxuICAgICAgICB2YXIgd1IgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJNOS4yMzkgMTMuOTM4bC0yLjg4LTEuNjYzYS43NS43NSAwIDAgMSAuNzUtMS4zTDkgMTIuMDY3VjQuNzVhLjc1Ljc1IDAgMSAxIDEuNSAwdjcuMzE4bDEuODktMS4wOTNhLjc1Ljc1IDAgMCAxIC43NSAxLjNsLTIuODc5IDEuNjYzYS43NTIuNzUyIDAgMCAxLS41MTEuMTg3Ljc1Mi43NTIgMCAwIDEtLjUxMS0uMTg3ek00LjI1IDE3YS43NS43NSAwIDEgMSAwLTEuNWgxMC41YS43NS43NSAwIDAgMSAwIDEuNUg0LjI1elwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciBrUiA9IGkoMTIpO1xyXG4gICAgICAgIHZhciBfUiA9IGkoMTMpO1xyXG4gICAgICAgIHZhciB2UiA9IGkoMTEwKTtcclxuICAgICAgICBjb25zdCB5UiA9IHtsZWZ0OiBadywgY2VudGVyOiBlaywgcmlnaHQ6IHRrLCBqdXN0aWZ5OiBpaywgdG9wOiBwUiwgbWlkZGxlOiBiUiwgYm90dG9tOiB3Un07XHJcblxyXG4gICAgICAgIGNsYXNzIHhSIGV4dGVuZHMgR3Age1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0KHtcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJTdHlsZTogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaG9yaXpvbnRhbEFsaWdubWVudDogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbEFsaWdubWVudDogXCJcIlxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBlO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge2JvcmRlclN0eWxlRHJvcGRvd246IGksIGJvcmRlcldpZHRoSW5wdXQ6IG4sIGJvcmRlckNvbG9ySW5wdXQ6IG8sIGJvcmRlclJvd0xhYmVsOiByfSA9IHRoaXMuX2NyZWF0ZUJvcmRlckZpZWxkcygpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge3dpZHRoSW5wdXQ6IHMsIG9wZXJhdG9yTGFiZWw6IGEsIGhlaWdodElucHV0OiBjLCBkaW1lbnNpb25zTGFiZWw6IGx9ID0gdGhpcy5fY3JlYXRlRGltZW5zaW9uRmllbGRzKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7aG9yaXpvbnRhbEFsaWdubWVudFRvb2xiYXI6IGQsIHZlcnRpY2FsQWxpZ25tZW50VG9vbGJhcjogdSwgYWxpZ25tZW50TGFiZWw6IGh9ID0gdGhpcy5fY3JlYXRlQWxpZ25tZW50RmllbGRzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlciA9IG5ldyBmYjtcclxuICAgICAgICAgICAgICAgIHRoaXMua2V5c3Ryb2tlcyA9IG5ldyBkcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSB0aGlzLmNyZWF0ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyU3R5bGVEcm9wZG93biA9IGk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvcmRlcldpZHRoSW5wdXQgPSBuO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib3JkZXJDb2xvcklucHV0ID0gbztcclxuICAgICAgICAgICAgICAgIHRoaXMuYmFja2dyb3VuZElucHV0ID0gdGhpcy5fY3JlYXRlQmFja2dyb3VuZEZpZWxkKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhZGRpbmdJbnB1dCA9IHRoaXMuX2NyZWF0ZVBhZGRpbmdGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aElucHV0ID0gcztcclxuICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0SW5wdXQgPSBjO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ob3Jpem9udGFsQWxpZ25tZW50VG9vbGJhciA9IGQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZlcnRpY2FsQWxpZ25tZW50VG9vbGJhciA9IHU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7c2F2ZUJ1dHRvblZpZXc6IGYsIGNhbmNlbEJ1dHRvblZpZXc6IGd9ID0gdGhpcy5fY3JlYXRlQWN0aW9uQnV0dG9ucygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlQnV0dG9uVmlldyA9IGY7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvblZpZXcgPSBnO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNhYmxlcyA9IG5ldyBicDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyID0gbmV3IHliKHtcclxuICAgICAgICAgICAgICAgICAgICBmb2N1c2FibGVzOiB0aGlzLl9mb2N1c2FibGVzLFxyXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzVHJhY2tlcjogdGhpcy5mb2N1c1RyYWNrZXIsXHJcbiAgICAgICAgICAgICAgICAgICAga2V5c3Ryb2tlSGFuZGxlcjogdGhpcy5rZXlzdHJva2VzLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IHtmb2N1c1ByZXZpb3VzOiBcInNoaWZ0ICsgdGFiXCIsIGZvY3VzTmV4dDogXCJ0YWJcIn1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQobmV3IG1SKHQsIHtsYWJlbDogdGhpcy50KFwi0KHQstC+0LnRgdGC0LLQsCDRj9GH0LXQudC60LhcIil9KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmFkZChuZXcgZlIodCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsVmlldzogcixcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3IsIGksIG8sIG5dLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImNrLXRhYmxlLWZvcm1fX2JvcmRlci1yb3dcIlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQobmV3IGZSKHQsIHtjaGlsZHJlbjogW3RoaXMuYmFja2dyb3VuZElucHV0XX0pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uYWRkKG5ldyBmUih0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtuZXcgZlIodCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFZpZXc6IGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbbCwgcywgYSwgY10sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93XCJcclxuICAgICAgICAgICAgICAgICAgICB9KSwgbmV3IGZSKHQsIHtjaGlsZHJlbjogW3RoaXMucGFkZGluZ0lucHV0XSwgY2xhc3M6IFwiY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm1fX3BhZGRpbmctcm93XCJ9KV1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uYWRkKG5ldyBmUih0LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxWaWV3OiBoLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbaCwgZCwgdV0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFwiY2stdGFibGUtY2VsbC1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3dcIlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQobmV3IGZSKHQsIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3RoaXMuc2F2ZUJ1dHRvblZpZXcsIHRoaXMuY2FuY2VsQnV0dG9uVmlld10sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFwiY2stdGFibGUtZm9ybV9fYWN0aW9uLXJvd1wiXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZm9ybVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFtcImNrXCIsIFwiY2stZm9ybVwiLCBcImNrLXRhYmxlLWZvcm1cIiwgXCJjay10YWJsZS1jZWxsLXByb3BlcnRpZXMtZm9ybVwiXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFiaW5kZXg6IFwiLTFcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgUXYoe3ZpZXc6IHRoaXN9KTtcclxuICAgICAgICAgICAgICAgIFt0aGlzLmJvcmRlclN0eWxlRHJvcGRvd24sIHRoaXMuYm9yZGVyQ29sb3JJbnB1dCwgdGhpcy5ib3JkZXJXaWR0aElucHV0LCB0aGlzLmJhY2tncm91bmRJbnB1dCwgdGhpcy53aWR0aElucHV0LCB0aGlzLmhlaWdodElucHV0LCB0aGlzLnBhZGRpbmdJbnB1dCwgdGhpcy5ob3Jpem9udGFsQWxpZ25tZW50VG9vbGJhciwgdGhpcy52ZXJ0aWNhbEFsaWdubWVudFRvb2xiYXIsIHRoaXMuc2F2ZUJ1dHRvblZpZXcsIHRoaXMuY2FuY2VsQnV0dG9uVmlld10uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c2FibGVzLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodC5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyLmZvY3VzRmlyc3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlQm9yZGVyRmllbGRzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGNSKHtjb2xvckNvbmZpZzogdGhpcy5vcHRpb25zLmJvcmRlckNvbG9ycywgY29sdW1uczogNX0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWsoZSk7XHJcbiAgICAgICAgICAgICAgICBuLnRleHQgPSBpKFwibmJcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gWkUoaSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IEhFKGUsIHFFKTtcclxuICAgICAgICAgICAgICAgIHIuc2V0KHtsYWJlbDogaShcIm5jXCIpLCBjbGFzczogXCJjay10YWJsZS1mb3JtX19ib3JkZXItc3R5bGVcIn0pO1xyXG4gICAgICAgICAgICAgICAgci52aWV3LmJ1dHRvblZpZXcuc2V0KHtpc09uOiBmYWxzZSwgd2l0aFRleHQ6IHRydWUsIHRvb2x0aXA6IGkoXCJuY1wiKX0pO1xyXG4gICAgICAgICAgICAgICAgci52aWV3LmJ1dHRvblZpZXcuYmluZChcImxhYmVsXCIpLnRvKHRoaXMsIFwiYm9yZGVyU3R5bGVcIiwgdCA9PiBvW3QgPyB0IDogXCJub25lXCJdKTtcclxuICAgICAgICAgICAgICAgIHIudmlldy5vbihcImV4ZWN1dGVcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3JkZXJTdHlsZSA9IHQuc291cmNlLl9ib3JkZXJTdHlsZVZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFViKHIudmlldywgclIodGhpcykpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBIRShlLCBXRSk7XHJcbiAgICAgICAgICAgICAgICBzLnNldCh7bGFiZWw6IGkoXCJuZFwiKSwgY2xhc3M6IFwiY2stdGFibGUtZm9ybV9fYm9yZGVyLXdpZHRoXCJ9KTtcclxuICAgICAgICAgICAgICAgIHMudmlldy5iaW5kKFwidmFsdWVcIikudG8odGhpcywgXCJib3JkZXJXaWR0aFwiKTtcclxuICAgICAgICAgICAgICAgIHMuYmluZChcImlzRW5hYmxlZFwiKS50byh0aGlzLCBcImJvcmRlclN0eWxlXCIsIENSKTtcclxuICAgICAgICAgICAgICAgIHMudmlldy5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlcldpZHRoID0gcy52aWV3LmVsZW1lbnQudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IG5ldyBIRShlLCB0KTtcclxuICAgICAgICAgICAgICAgIGEuc2V0KHtsYWJlbDogaShcIm5lXCIpLCBjbGFzczogXCJjay10YWJsZS1mb3JtX19ib3JkZXItY29sb3JcIn0pO1xyXG4gICAgICAgICAgICAgICAgYS52aWV3LmJpbmQoXCJ2YWx1ZVwiKS50byh0aGlzLCBcImJvcmRlckNvbG9yXCIpO1xyXG4gICAgICAgICAgICAgICAgYS5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKHRoaXMsIFwiYm9yZGVyU3R5bGVcIiwgQ1IpO1xyXG4gICAgICAgICAgICAgICAgYS52aWV3Lm9uKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyQ29sb3IgPSBhLnZpZXcudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbihcImNoYW5nZTpib3JkZXJTdHlsZVwiLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghQ1IoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyV2lkdGggPSBcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge2JvcmRlclJvd0xhYmVsOiBuLCBib3JkZXJTdHlsZURyb3Bkb3duOiByLCBib3JkZXJDb2xvcklucHV0OiBhLCBib3JkZXJXaWR0aElucHV0OiBzfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlQmFja2dyb3VuZEZpZWxkKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBjUih7Y29sb3JDb25maWc6IHRoaXMub3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3JzLCBjb2x1bW5zOiA1fSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IEhFKHQsIGkpO1xyXG4gICAgICAgICAgICAgICAgbi5zZXQoe2xhYmVsOiBlKFwibmZcIiksIGNsYXNzOiBcImNrLXRhYmxlLWNlbGwtcHJvcGVydGllcy1mb3JtX19iYWNrZ3JvdW5kXCJ9KTtcclxuICAgICAgICAgICAgICAgIG4udmlldy5iaW5kKFwidmFsdWVcIikudG8odGhpcywgXCJiYWNrZ3JvdW5kQ29sb3JcIik7XHJcbiAgICAgICAgICAgICAgICBuLnZpZXcub24oXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBuLnZpZXcudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZURpbWVuc2lvbkZpZWxkcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IE1rKHQpO1xyXG4gICAgICAgICAgICAgICAgaS50ZXh0ID0gZShcIm5nXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBIRSh0LCBXRSk7XHJcbiAgICAgICAgICAgICAgICBuLnNldCh7bGFiZWw6IGUoXCJuZFwiKSwgY2xhc3M6IFwiY2stdGFibGUtZm9ybV9fZGltZW5zaW9ucy1yb3dfX3dpZHRoXCJ9KTtcclxuICAgICAgICAgICAgICAgIG4udmlldy5iaW5kKFwidmFsdWVcIikudG8odGhpcywgXCJ3aWR0aFwiKTtcclxuICAgICAgICAgICAgICAgIG4udmlldy5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gbi52aWV3LmVsZW1lbnQudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBHcCh0KTtcclxuICAgICAgICAgICAgICAgIG8uc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJzcGFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJjay10YWJsZS1mb3JtX19kaW1lbnNpb24tb3BlcmF0b3JcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IFwiw5dcIn1dXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgSEUodCwgV0UpO1xyXG4gICAgICAgICAgICAgICAgci5zZXQoe2xhYmVsOiBlKFwibmhcIiksIGNsYXNzOiBcImNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93X19oZWlnaHRcIn0pO1xyXG4gICAgICAgICAgICAgICAgci52aWV3LmJpbmQoXCJ2YWx1ZVwiKS50byh0aGlzLCBcImhlaWdodFwiKTtcclxuICAgICAgICAgICAgICAgIHIudmlldy5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCA9IHIudmlldy5lbGVtZW50LnZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7ZGltZW5zaW9uc0xhYmVsOiBpLCB3aWR0aElucHV0OiBuLCBvcGVyYXRvckxhYmVsOiBvLCBoZWlnaHRJbnB1dDogcn1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVBhZGRpbmdGaWVsZCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IEhFKHQsIFdFKTtcclxuICAgICAgICAgICAgICAgIGkuc2V0KHtsYWJlbDogZShcIm5pXCIpLCBjbGFzczogXCJjay10YWJsZS1jZWxsLXByb3BlcnRpZXMtZm9ybV9fcGFkZGluZ1wifSk7XHJcbiAgICAgICAgICAgICAgICBpLnZpZXcuYmluZChcInZhbHVlXCIpLnRvKHRoaXMsIFwicGFkZGluZ1wiKTtcclxuICAgICAgICAgICAgICAgIGkudmlldy5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZGRpbmcgPSBpLnZpZXcuZWxlbWVudC52YWx1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlQWxpZ25tZW50RmllbGRzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgTWsodCk7XHJcbiAgICAgICAgICAgICAgICBpLnRleHQgPSBlKFwibmpcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IFhiKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMubG9jYWxlLmNvbnRlbnRMYW5ndWFnZURpcmVjdGlvbiA9PT0gXCJydGxcIjtcclxuICAgICAgICAgICAgICAgIG4uc2V0KHtpc0NvbXBhY3Q6IHRydWUsIGFyaWFMYWJlbDogZShcIm5rXCIpfSk7XHJcbiAgICAgICAgICAgICAgICBzUih7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzogdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uczogeVIsXHJcbiAgICAgICAgICAgICAgICAgICAgdG9vbGJhcjogbixcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbHM6IHRoaXMuX2hvcml6b250YWxBbGlnbm1lbnRMYWJlbHMsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lOiBcImhvcml6b250YWxBbGlnbm1lbnRcIixcclxuICAgICAgICAgICAgICAgICAgICBuYW1lVG9WYWx1ZTogdCA9PiB0ID09PSAobyA/IFwicmlnaHRcIiA6IFwibGVmdFwiKSA/IFwiXCIgOiB0XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgWGIodCk7XHJcbiAgICAgICAgICAgICAgICByLnNldCh7aXNDb21wYWN0OiB0cnVlLCBhcmlhTGFiZWw6IGUoXCJubFwiKX0pO1xyXG4gICAgICAgICAgICAgICAgc1Ioe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXc6IHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbnM6IHlSLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvb2xiYXI6IHIsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWxzOiB0aGlzLl92ZXJ0aWNhbEFsaWdubWVudExhYmVscyxcclxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWU6IFwidmVydGljYWxBbGlnbm1lbnRcIixcclxuICAgICAgICAgICAgICAgICAgICBuYW1lVG9WYWx1ZTogdCA9PiB0ID09PSBcIm1pZGRsZVwiID8gXCJcIiA6IHRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtob3Jpem9udGFsQWxpZ25tZW50VG9vbGJhcjogbiwgdmVydGljYWxBbGlnbm1lbnRUb29sYmFyOiByLCBhbGlnbm1lbnRMYWJlbDogaX1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUFjdGlvbkJ1dHRvbnMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5sb2NhbGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBoYih0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgaGIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gW3RoaXMuYm9yZGVyV2lkdGhJbnB1dCwgdGhpcy5ib3JkZXJDb2xvcklucHV0LCB0aGlzLmJhY2tncm91bmRJbnB1dCwgdGhpcy5wYWRkaW5nSW5wdXRdO1xyXG4gICAgICAgICAgICAgICAgaS5zZXQoe2xhYmVsOiBlKFwibG9cIiksIGljb246IFh2LCBjbGFzczogXCJjay1idXR0b24tc2F2ZVwiLCB0eXBlOiBcInN1Ym1pdFwiLCB3aXRoVGV4dDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgaS5iaW5kKFwiaXNFbmFibGVkXCIpLnRvTWFueShvLCBcImVycm9yVGV4dFwiLCAoLi4udCkgPT4gdC5ldmVyeSh0ID0+ICF0KSk7XHJcbiAgICAgICAgICAgICAgICBuLnNldCh7bGFiZWw6IGUoXCJscFwiKSwgaWNvbjogWnYsIGNsYXNzOiBcImNrLWJ1dHRvbi1jYW5jZWxcIiwgdHlwZTogXCJjYW5jZWxcIiwgd2l0aFRleHQ6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIG4uZGVsZWdhdGUoXCJleGVjdXRlXCIpLnRvKHRoaXMsIFwiY2FuY2VsXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtzYXZlQnV0dG9uVmlldzogaSwgY2FuY2VsQnV0dG9uVmlldzogbn1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9ob3Jpem9udGFsQWxpZ25tZW50TGFiZWxzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlKFwibm1cIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gZShcIm5uXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUoXCJub1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBlKFwibnBcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAodC51aUxhbmd1YWdlRGlyZWN0aW9uID09PSBcInJ0bFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtyaWdodDogbywgY2VudGVyOiBuLCBsZWZ0OiBpLCBqdXN0aWZ5OiByfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2xlZnQ6IGksIGNlbnRlcjogbiwgcmlnaHQ6IG8sIGp1c3RpZnk6IHJ9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfdmVydGljYWxBbGlnbm1lbnRMYWJlbHMoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy50O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt0b3A6IHQoXCJucVwiKSwgbWlkZGxlOiB0KFwibnJcIiksIGJvdHRvbTogdChcIm5zXCIpfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBDUih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhIXRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBBUiA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xMS4xMDUgMThsLS4xNyAxSDIuNUExLjUgMS41IDAgMCAxIDEgMTcuNXYtMTVBMS41IDEuNSAwIDAgMSAyLjUgMWgxNUExLjUgMS41IDAgMCAxIDE5IDIuNXY5Ljk3NWwtLjg1LS4xMjQtLjE1LS4zMDJWOGgtNXY0aC4wMjFsLS4xNzIuMzUxLTEuOTE2LjI4LS4xNTEuMDI3Yy0uMjg3LjA2My0uNTQuMTgyLS43NTUuMzQxTDggMTN2NWgzLjEwNXpNMiAxMmg1VjhIMnY0em0xMC00SDh2NGg0Vjh6TTIgMnY1aDVWMkgyem0wIDE2aDV2LTVIMnY1ek0xMyA3aDVWMmgtNXY1ek04IDJ2NWg0VjJIOHpcIiBvcGFjaXR5PVwiLjZcIi8+PHBhdGggZD1cIk0xNS41IDExLjVsMS4zMjMgMi42OCAyLjk1Ny40My0yLjE0IDIuMDg1LjUwNSAyLjk0NkwxNS41IDE4LjI1bC0yLjY0NSAxLjM5LjUwNS0yLjk0NS0yLjE0LTIuMDg2IDIuOTU3LS40M0wxNS41IDExLjV6TTEzIDZhMSAxIDAgMCAxIDEgMXYzLjE3MmEyLjA0NyAyLjA0NyAwIDAgMC0uMjkzLjQ0M2wtLjg1OCAxLjczNi0xLjkxNi4yOC0uMTUxLjAyN0ExLjk3NiAxLjk3NiAwIDAgMCA5LjMxNSAxNEg3YTEgMSAwIDAgMS0xLTFWN2ExIDEgMCAwIDEgMS0xaDZ6bS0xIDJIOHY0aDRWOHpcIi8+PC9zdmc+JztcclxuICAgICAgICBjb25zdCBUUiA9IDUwMDtcclxuXHJcbiAgICAgICAgY2xhc3MgUFIgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2tiXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUYWJsZUNlbGxQcm9wZXJ0aWVzVUlcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHQuY29uZmlnLmRlZmluZShcInRhYmxlLnRhYmxlQ2VsbFByb3BlcnRpZXNcIiwge2JvcmRlckNvbG9yczogYVIsIGJhY2tncm91bmRDb2xvcnM6IGFSfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uID0gdC5wbHVnaW5zLmdldChrYik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXcgPSB0aGlzLl9jcmVhdGVQcm9wZXJ0aWVzVmlldygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdW5kb1N0ZXBCYXRjaCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKFwidGFibGVDZWxsUHJvcGVydGllc1wiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IGhiKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc2V0KHtsYWJlbDogZShcImtoXCIpLCBpY29uOiBBUiwgdG9vbHRpcDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oaSwgXCJleGVjdXRlXCIsICgpID0+IHRoaXMuX3Nob3dWaWV3KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkZXN0cm95KCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmRlc3Ryb3koKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlUHJvcGVydGllc1ZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5lZGl0aW5nLnZpZXcuZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jb25maWcuZ2V0KFwidGFibGUudGFibGVDZWxsUHJvcGVydGllc1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBfXyhpLmJvcmRlckNvbG9ycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0ga18odC5sb2NhbGUsIG4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IF9fKGkuYmFja2dyb3VuZENvbG9ycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0ga18odC5sb2NhbGUsIHIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IG5ldyB4Uih0LmxvY2FsZSwge2JvcmRlckNvbG9yczogbywgYmFja2dyb3VuZENvbG9yczogc30pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IHQudDtcclxuICAgICAgICAgICAgICAgIGEucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGEsIFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oaWRlVmlldygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oYSwgXCJjYW5jZWxcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl91bmRvU3RlcEJhdGNoLm9wZXJhdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY3V0ZShcInVuZG9cIiwgdGhpcy5fdW5kb1N0ZXBCYXRjaClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVZpZXcoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhLmtleXN0cm9rZXMuc2V0KFwiRXNjXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LnVpLCBcInVwZGF0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuUyhlLnNlbGVjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVZpZXcoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNWaWV3VmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBZRSh0LCBcImNlbGxcIilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIERiKHtcclxuICAgICAgICAgICAgICAgICAgICBlbWl0dGVyOiBhLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2YXRvcjogKCkgPT4gdGhpcy5faXNWaWV3SW5CYWxsb29uLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRFbGVtZW50czogW3RoaXMuX2JhbGxvb24udmlldy5lbGVtZW50XSxcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogKCkgPT4gdGhpcy5faGlkZVZpZXcoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsID0gdFIoYyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkID0gZVIoYyk7XHJcbiAgICAgICAgICAgICAgICBhLm9uKFwiY2hhbmdlOmJvcmRlclN0eWxlXCIsIHRoaXMuX2dldFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soXCJ0YWJsZUNlbGxCb3JkZXJTdHlsZVwiKSk7XHJcbiAgICAgICAgICAgICAgICBhLm9uKFwiY2hhbmdlOmJvcmRlckNvbG9yXCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS5ib3JkZXJDb2xvcklucHV0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmROYW1lOiBcInRhYmxlQ2VsbEJvcmRlckNvbG9yXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBsLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRvcjogaVJcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGEub24oXCJjaGFuZ2U6Ym9yZGVyV2lkdGhcIiwgdGhpcy5fZ2V0VmFsaWRhdGVkUHJvcGVydHlDaGFuZ2VDYWxsYmFjayh7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld0ZpZWxkOiBhLmJvcmRlcldpZHRoSW5wdXQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE5hbWU6IFwidGFibGVDZWxsQm9yZGVyV2lkdGhcIixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvclRleHQ6IGQsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yOiBvUlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgYS5vbihcImNoYW5nZTpwYWRkaW5nXCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS5wYWRkaW5nSW5wdXQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE5hbWU6IFwidGFibGVDZWxsUGFkZGluZ1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogZCxcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0b3I6IG5SXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICBhLm9uKFwiY2hhbmdlOndpZHRoXCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS53aWR0aElucHV0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmROYW1lOiBcInRhYmxlQ2VsbFdpZHRoXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBkLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRvcjogblJcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGEub24oXCJjaGFuZ2U6aGVpZ2h0XCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS5oZWlnaHRJbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kTmFtZTogXCJ0YWJsZUNlbGxIZWlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvclRleHQ6IGQsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yOiBuUlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgYS5vbihcImNoYW5nZTpiYWNrZ3JvdW5kQ29sb3JcIiwgdGhpcy5fZ2V0VmFsaWRhdGVkUHJvcGVydHlDaGFuZ2VDYWxsYmFjayh7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld0ZpZWxkOiBhLmJhY2tncm91bmRJbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kTmFtZTogXCJ0YWJsZUNlbGxCYWNrZ3JvdW5kQ29sb3JcIixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvclRleHQ6IGwsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yOiBpUlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgYS5vbihcImNoYW5nZTpob3Jpem9udGFsQWxpZ25tZW50XCIsIHRoaXMuX2dldFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soXCJ0YWJsZUNlbGxIb3Jpem9udGFsQWxpZ25tZW50XCIpKTtcclxuICAgICAgICAgICAgICAgIGEub24oXCJjaGFuZ2U6dmVydGljYWxBbGlnbm1lbnRcIiwgdGhpcy5fZ2V0UHJvcGVydHlDaGFuZ2VDYWxsYmFjayhcInRhYmxlQ2VsbFZlcnRpY2FsQWxpZ25tZW50XCIpKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9maWxsVmlld0Zvcm1Gcm9tQ29tbWFuZFZhbHVlcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5jb21tYW5kcztcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlclN0eWxlOiB0LmdldChcInRhYmxlQ2VsbEJvcmRlclN0eWxlXCIpLnZhbHVlIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IHQuZ2V0KFwidGFibGVDZWxsQm9yZGVyQ29sb3JcIikudmFsdWUgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogdC5nZXQoXCJ0YWJsZUNlbGxCb3JkZXJXaWR0aFwiKS52YWx1ZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0LmdldChcInRhYmxlQ2VsbFdpZHRoXCIpLnZhbHVlIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiB0LmdldChcInRhYmxlQ2VsbEhlaWdodFwiKS52YWx1ZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IHQuZ2V0KFwidGFibGVDZWxsUGFkZGluZ1wiKS52YWx1ZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogdC5nZXQoXCJ0YWJsZUNlbGxCYWNrZ3JvdW5kQ29sb3JcIikudmFsdWUgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBob3Jpem9udGFsQWxpZ25tZW50OiB0LmdldChcInRhYmxlQ2VsbEhvcml6b250YWxBbGlnbm1lbnRcIikudmFsdWUgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgICAgICB2ZXJ0aWNhbEFsaWdubWVudDogdC5nZXQoXCJ0YWJsZUNlbGxWZXJ0aWNhbEFsaWdubWVudFwiKS52YWx1ZSB8fCBcIlwiXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2hvd1ZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uLmFkZCh7dmlldzogdGhpcy52aWV3LCBwb3NpdGlvbjogWEUodCl9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VuZG9TdGVwQmF0Y2ggPSB0Lm1vZGVsLmNyZWF0ZUJhdGNoKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxsVmlld0Zvcm1Gcm9tQ29tbWFuZFZhbHVlcygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2hpZGVWaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc1ZpZXdJbkJhbGxvb24pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZyh0LnVpLCBcInVwZGF0ZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5zYXZlQnV0dG9uVmlldy5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi5yZW1vdmUodGhpcy52aWV3KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfaXNWaWV3VmlzaWJsZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWxsb29uLnZpc2libGVWaWV3ID09PSB0aGlzLnZpZXdcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9pc1ZpZXdJbkJhbGxvb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFsbG9vbi5oYXNWaWV3KHRoaXMudmlldylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2sodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZXhlY3V0ZSh0LCB7dmFsdWU6IG4sIGJhdGNoOiB0aGlzLl91bmRvU3RlcEJhdGNofSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe2NvbW1hbmROYW1lOiB0LCB2aWV3RmllbGQ6IGUsIHZhbGlkYXRvcjogaSwgZXJyb3JUZXh0OiBufSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHVoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLmVycm9yVGV4dCA9IG5cclxuICAgICAgICAgICAgICAgIH0sIFRSKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAobiwgciwgcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG8uY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkocykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZXhlY3V0ZSh0LCB7dmFsdWU6IHMsIGJhdGNoOiB0aGlzLl91bmRvU3RlcEJhdGNofSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZXJyb3JUZXh0ID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8oKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gU1IodCkge1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJib3JkZXJcIiwgRVIpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJib3JkZXItdG9wXCIsIFJSKFwidG9wXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLXJpZ2h0XCIsIFJSKFwicmlnaHRcIikpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJib3JkZXItYm90dG9tXCIsIFJSKFwiYm90dG9tXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLWxlZnRcIiwgUlIoXCJsZWZ0XCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLWNvbG9yXCIsIE9SKFwiY29sb3JcIikpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJib3JkZXItd2lkdGhcIiwgT1IoXCJ3aWR0aFwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcImJvcmRlci1zdHlsZVwiLCBPUihcInN0eWxlXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLXRvcC1jb2xvclwiLCBWUihcImNvbG9yXCIsIFwidG9wXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLXRvcC1zdHlsZVwiLCBWUihcInN0eWxlXCIsIFwidG9wXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLXRvcC13aWR0aFwiLCBWUihcIndpZHRoXCIsIFwidG9wXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLXJpZ2h0LWNvbG9yXCIsIFZSKFwiY29sb3JcIiwgXCJyaWdodFwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcImJvcmRlci1yaWdodC1zdHlsZVwiLCBWUihcInN0eWxlXCIsIFwicmlnaHRcIikpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJib3JkZXItcmlnaHQtd2lkdGhcIiwgVlIoXCJ3aWR0aFwiLCBcInJpZ2h0XCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLWJvdHRvbS1jb2xvclwiLCBWUihcImNvbG9yXCIsIFwiYm90dG9tXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLWJvdHRvbS1zdHlsZVwiLCBWUihcInN0eWxlXCIsIFwiYm90dG9tXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLWJvdHRvbS13aWR0aFwiLCBWUihcIndpZHRoXCIsIFwiYm90dG9tXCIpKTtcclxuICAgICAgICAgICAgdC5zZXROb3JtYWxpemVyKFwiYm9yZGVyLWxlZnQtY29sb3JcIiwgVlIoXCJjb2xvclwiLCBcImxlZnRcIikpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJib3JkZXItbGVmdC1zdHlsZVwiLCBWUihcInN0eWxlXCIsIFwibGVmdFwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcImJvcmRlci1sZWZ0LXdpZHRoXCIsIFZSKFwid2lkdGhcIiwgXCJsZWZ0XCIpKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItdG9wXCIsIE5SKFwidG9wXCIpKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItcmlnaHRcIiwgTlIoXCJyaWdodFwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWJvdHRvbVwiLCBOUihcImJvdHRvbVwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWxlZnRcIiwgTlIoXCJsZWZ0XCIpKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItdG9wLWNvbG9yXCIsIFwiYm9yZGVyLmNvbG9yLnRvcFwiKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItcmlnaHQtY29sb3JcIiwgXCJib3JkZXIuY29sb3IucmlnaHRcIik7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWJvdHRvbS1jb2xvclwiLCBcImJvcmRlci5jb2xvci5ib3R0b21cIik7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWxlZnQtY29sb3JcIiwgXCJib3JkZXIuY29sb3IubGVmdFwiKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItdG9wLXdpZHRoXCIsIFwiYm9yZGVyLndpZHRoLnRvcFwiKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItcmlnaHQtd2lkdGhcIiwgXCJib3JkZXIud2lkdGgucmlnaHRcIik7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWJvdHRvbS13aWR0aFwiLCBcImJvcmRlci53aWR0aC5ib3R0b21cIik7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWxlZnQtd2lkdGhcIiwgXCJib3JkZXIud2lkdGgubGVmdFwiKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItdG9wLXN0eWxlXCIsIFwiYm9yZGVyLnN0eWxlLnRvcFwiKTtcclxuICAgICAgICAgICAgdC5zZXRFeHRyYWN0b3IoXCJib3JkZXItcmlnaHQtc3R5bGVcIiwgXCJib3JkZXIuc3R5bGUucmlnaHRcIik7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWJvdHRvbS1zdHlsZVwiLCBcImJvcmRlci5zdHlsZS5ib3R0b21cIik7XHJcbiAgICAgICAgICAgIHQuc2V0RXh0cmFjdG9yKFwiYm9yZGVyLWxlZnQtc3R5bGVcIiwgXCJib3JkZXIuc3R5bGUubGVmdFwiKTtcclxuICAgICAgICAgICAgdC5zZXRSZWR1Y2VyKFwiYm9yZGVyLWNvbG9yXCIsIHBDKFwiYm9yZGVyLWNvbG9yXCIpKTtcclxuICAgICAgICAgICAgdC5zZXRSZWR1Y2VyKFwiYm9yZGVyLXN0eWxlXCIsIHBDKFwiYm9yZGVyLXN0eWxlXCIpKTtcclxuICAgICAgICAgICAgdC5zZXRSZWR1Y2VyKFwiYm9yZGVyLXdpZHRoXCIsIHBDKFwiYm9yZGVyLXdpZHRoXCIpKTtcclxuICAgICAgICAgICAgdC5zZXRSZWR1Y2VyKFwiYm9yZGVyLXRvcFwiLCBMUihcInRvcFwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0UmVkdWNlcihcImJvcmRlci1yaWdodFwiLCBMUihcInJpZ2h0XCIpKTtcclxuICAgICAgICAgICAgdC5zZXRSZWR1Y2VyKFwiYm9yZGVyLWJvdHRvbVwiLCBMUihcImJvdHRvbVwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0UmVkdWNlcihcImJvcmRlci1sZWZ0XCIsIExSKFwibGVmdFwiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0UmVkdWNlcihcImJvcmRlclwiLCB6Uik7XHJcbiAgICAgICAgICAgIHQuc2V0U3R5bGVSZWxhdGlvbihcImJvcmRlclwiLCBbXCJib3JkZXItY29sb3JcIiwgXCJib3JkZXItc3R5bGVcIiwgXCJib3JkZXItd2lkdGhcIiwgXCJib3JkZXItdG9wXCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXRvcC1jb2xvclwiLCBcImJvcmRlci1yaWdodC1jb2xvclwiLCBcImJvcmRlci1ib3R0b20tY29sb3JcIiwgXCJib3JkZXItbGVmdC1jb2xvclwiLCBcImJvcmRlci10b3Atc3R5bGVcIiwgXCJib3JkZXItcmlnaHQtc3R5bGVcIiwgXCJib3JkZXItYm90dG9tLXN0eWxlXCIsIFwiYm9yZGVyLWxlZnQtc3R5bGVcIiwgXCJib3JkZXItdG9wLXdpZHRoXCIsIFwiYm9yZGVyLXJpZ2h0LXdpZHRoXCIsIFwiYm9yZGVyLWJvdHRvbS13aWR0aFwiLCBcImJvcmRlci1sZWZ0LXdpZHRoXCJdKTtcclxuICAgICAgICAgICAgdC5zZXRTdHlsZVJlbGF0aW9uKFwiYm9yZGVyLWNvbG9yXCIsIFtcImJvcmRlci10b3AtY29sb3JcIiwgXCJib3JkZXItcmlnaHQtY29sb3JcIiwgXCJib3JkZXItYm90dG9tLWNvbG9yXCIsIFwiYm9yZGVyLWxlZnQtY29sb3JcIl0pO1xyXG4gICAgICAgICAgICB0LnNldFN0eWxlUmVsYXRpb24oXCJib3JkZXItc3R5bGVcIiwgW1wiYm9yZGVyLXRvcC1zdHlsZVwiLCBcImJvcmRlci1yaWdodC1zdHlsZVwiLCBcImJvcmRlci1ib3R0b20tc3R5bGVcIiwgXCJib3JkZXItbGVmdC1zdHlsZVwiXSk7XHJcbiAgICAgICAgICAgIHQuc2V0U3R5bGVSZWxhdGlvbihcImJvcmRlci13aWR0aFwiLCBbXCJib3JkZXItdG9wLXdpZHRoXCIsIFwiYm9yZGVyLXJpZ2h0LXdpZHRoXCIsIFwiYm9yZGVyLWJvdHRvbS13aWR0aFwiLCBcImJvcmRlci1sZWZ0LXdpZHRoXCJdKTtcclxuICAgICAgICAgICAgdC5zZXRTdHlsZVJlbGF0aW9uKFwiYm9yZGVyLXRvcFwiLCBbXCJib3JkZXItdG9wLWNvbG9yXCIsIFwiYm9yZGVyLXRvcC1zdHlsZVwiLCBcImJvcmRlci10b3Atd2lkdGhcIl0pO1xyXG4gICAgICAgICAgICB0LnNldFN0eWxlUmVsYXRpb24oXCJib3JkZXItcmlnaHRcIiwgW1wiYm9yZGVyLXJpZ2h0LWNvbG9yXCIsIFwiYm9yZGVyLXJpZ2h0LXN0eWxlXCIsIFwiYm9yZGVyLXJpZ2h0LXdpZHRoXCJdKTtcclxuICAgICAgICAgICAgdC5zZXRTdHlsZVJlbGF0aW9uKFwiYm9yZGVyLWJvdHRvbVwiLCBbXCJib3JkZXItYm90dG9tLWNvbG9yXCIsIFwiYm9yZGVyLWJvdHRvbS1zdHlsZVwiLCBcImJvcmRlci1ib3R0b20td2lkdGhcIl0pO1xyXG4gICAgICAgICAgICB0LnNldFN0eWxlUmVsYXRpb24oXCJib3JkZXItbGVmdFwiLCBbXCJib3JkZXItbGVmdC1jb2xvclwiLCBcImJvcmRlci1sZWZ0LXN0eWxlXCIsIFwiYm9yZGVyLWxlZnQtd2lkdGhcIl0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBFUih0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHtjb2xvcjogZSwgc3R5bGU6IGksIHdpZHRoOiBufSA9IEJSKHQpO1xyXG4gICAgICAgICAgICByZXR1cm4ge3BhdGg6IFwiYm9yZGVyXCIsIHZhbHVlOiB7Y29sb3I6IG1DKGUpLCBzdHlsZTogbUMoaSksIHdpZHRoOiBtQyhuKX19XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBSUih0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtjb2xvcjogaSwgc3R5bGU6IG4sIHdpZHRoOiBvfSA9IEJSKGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHt9O1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHIuY29sb3IgPSB7W3RdOiBpfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHIuc3R5bGUgPSB7W3RdOiBufVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG8gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHIud2lkdGggPSB7W3RdOiBvfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtwYXRoOiBcImJvcmRlclwiLCB2YWx1ZTogcn1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gT1IodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZSA9PiAoe3BhdGg6IFwiYm9yZGVyXCIsIHZhbHVlOiBJUihlLCB0KX0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBJUih0LCBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7W2VdOiBtQyh0KX1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFZSKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGkgPT4gKHtwYXRoOiBcImJvcmRlclwiLCB2YWx1ZToge1t0XToge1tlXTogaX19fSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE5SKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5ib3JkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTVIoaS5ib3JkZXIsIHQpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIE1SKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHt9O1xyXG4gICAgICAgICAgICBpZiAodC53aWR0aCAmJiB0LndpZHRoW2VdKSB7XHJcbiAgICAgICAgICAgICAgICBpLndpZHRoID0gdC53aWR0aFtlXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnN0eWxlICYmIHQuc3R5bGVbZV0pIHtcclxuICAgICAgICAgICAgICAgIGkuc3R5bGUgPSB0LnN0eWxlW2VdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQuY29sb3IgJiYgdC5jb2xvcltlXSkge1xyXG4gICAgICAgICAgICAgICAgaS5jb2xvciA9IHQuY29sb3JbZV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gQlIodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBrQyh0KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvQyh0KSB8fCAvdGhpbnxtZWRpdW18dGhpY2svLnRlc3QodCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLndpZHRoID0gdFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpQyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3R5bGUgPSB0XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuY29sb3IgPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHpSKHQpIHtcclxuICAgICAgICAgICAgY29uc3QgZSA9IFtdO1xyXG4gICAgICAgICAgICBlLnB1c2goLi4uRlIoTVIodCwgXCJ0b3BcIiksIFwidG9wXCIpKTtcclxuICAgICAgICAgICAgZS5wdXNoKC4uLkZSKE1SKHQsIFwicmlnaHRcIiksIFwicmlnaHRcIikpO1xyXG4gICAgICAgICAgICBlLnB1c2goLi4uRlIoTVIodCwgXCJib3R0b21cIiksIFwiYm90dG9tXCIpKTtcclxuICAgICAgICAgICAgZS5wdXNoKC4uLkZSKE1SKHQsIFwibGVmdFwiKSwgXCJsZWZ0XCIpKTtcclxuICAgICAgICAgICAgcmV0dXJuIGVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIExSKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUgPT4gRlIoZSwgdClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEZSKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFtdO1xyXG4gICAgICAgICAgICBpZiAodCAmJiB0LndpZHRoICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGkucHVzaCh0LndpZHRoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0ICYmIHQuc3R5bGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKHQuc3R5bGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQgJiYgdC5jb2xvciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBpLnB1c2godC5jb2xvcilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbW2Bib3JkZXItJHtlfWAsIGkuam9pbihcIiBcIildXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBbXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gRFIodCkge1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJwYWRkaW5nXCIsIHdDKFwicGFkZGluZ1wiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcInBhZGRpbmctdG9wXCIsIHQgPT4gKHtwYXRoOiBcInBhZGRpbmcudG9wXCIsIHZhbHVlOiB0fSkpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJwYWRkaW5nLXJpZ2h0XCIsIHQgPT4gKHtwYXRoOiBcInBhZGRpbmcucmlnaHRcIiwgdmFsdWU6IHR9KSk7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcInBhZGRpbmctYm90dG9tXCIsIHQgPT4gKHtwYXRoOiBcInBhZGRpbmcuYm90dG9tXCIsIHZhbHVlOiB0fSkpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJwYWRkaW5nLWxlZnRcIiwgdCA9PiAoe3BhdGg6IFwicGFkZGluZy5sZWZ0XCIsIHZhbHVlOiB0fSkpO1xyXG4gICAgICAgICAgICB0LnNldFJlZHVjZXIoXCJwYWRkaW5nXCIsIHBDKFwicGFkZGluZ1wiKSk7XHJcbiAgICAgICAgICAgIHQuc2V0U3R5bGVSZWxhdGlvbihcInBhZGRpbmdcIiwgW1wicGFkZGluZy10b3BcIiwgXCJwYWRkaW5nLXJpZ2h0XCIsIFwicGFkZGluZy1ib3R0b21cIiwgXCJwYWRkaW5nLWxlZnRcIl0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBqUih0KSB7XHJcbiAgICAgICAgICAgIHQuc2V0Tm9ybWFsaXplcihcImJhY2tncm91bmRcIiwgSFIpO1xyXG4gICAgICAgICAgICB0LnNldE5vcm1hbGl6ZXIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIHQgPT4gKHtwYXRoOiBcImJhY2tncm91bmQuY29sb3JcIiwgdmFsdWU6IHR9KSk7XHJcbiAgICAgICAgICAgIHQuc2V0UmVkdWNlcihcImJhY2tncm91bmRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gW107XHJcbiAgICAgICAgICAgICAgICBlLnB1c2goW1wiYmFja2dyb3VuZC1jb2xvclwiLCB0LmNvbG9yXSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gSFIodCkge1xyXG4gICAgICAgICAgICBjb25zdCBlID0ge307XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBrQyh0KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjQyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucmVwZWF0ID0gZS5yZXBlYXQgfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgZS5yZXBlYXQucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkQyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucG9zaXRpb24gPSBlLnBvc2l0aW9uIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGUucG9zaXRpb24ucHVzaCh0KVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChoQyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuYXR0YWNobWVudCA9IHRcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodEModCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlLmNvbG9yID0gdFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChnQyh0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuaW1hZ2UgPSB0XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHtwYXRoOiBcImJhY2tncm91bmRcIiwgdmFsdWU6IGV9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBXUih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIHQuZm9yKFwidXBjYXN0XCIpLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHtcclxuICAgICAgICAgICAgICAgIHZpZXc6IHtzdHlsZXM6IHtbbl06IC9bXFxzXFxTXSsvfX0sXHJcbiAgICAgICAgICAgICAgICBtb2RlbDoge25hbWU6IGUsIGtleTogaSwgdmFsdWU6IHQgPT4gdC5nZXROb3JtYWxpemVkU3R5bGUobil9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBxUih0LCBlKSB7XHJcbiAgICAgICAgICAgIHQuZm9yKFwidXBjYXN0XCIpLmFkZCh0ID0+IHQub24oXCJlbGVtZW50OlwiICsgZSwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBbXCJib3JkZXItdG9wXCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImJvcmRlci1sZWZ0XCJdLmZpbHRlcih0ID0+IGUudmlld0l0ZW0uaGFzU3R5bGUodCkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHtzdHlsZXM6IG59O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpLmNvbnN1bWFibGUudGVzdChlLnZpZXdJdGVtLCBvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFlLm1vZGVsUmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBlID0gT2JqZWN0LmFzc2lnbihlLCBpLmNvbnZlcnRDaGlsZHJlbihlLnZpZXdJdGVtLCBlLm1vZGVsQ3Vyc29yKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBbLi4uZS5tb2RlbFJhbmdlLmdldEl0ZW1zKHtzaGFsbG93OiB0cnVlfSldLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgaS5jb25zdW1hYmxlLmNvbnN1bWUoZS52aWV3SXRlbSwgbyk7XHJcbiAgICAgICAgICAgICAgICBpLndyaXRlci5zZXRBdHRyaWJ1dGUoXCJib3JkZXJTdHlsZVwiLCBlLnZpZXdJdGVtLmdldE5vcm1hbGl6ZWRTdHlsZShcImJvcmRlci1zdHlsZVwiKSwgcik7XHJcbiAgICAgICAgICAgICAgICBpLndyaXRlci5zZXRBdHRyaWJ1dGUoXCJib3JkZXJDb2xvclwiLCBlLnZpZXdJdGVtLmdldE5vcm1hbGl6ZWRTdHlsZShcImJvcmRlci1jb2xvclwiKSwgcik7XHJcbiAgICAgICAgICAgICAgICBpLndyaXRlci5zZXRBdHRyaWJ1dGUoXCJib3JkZXJXaWR0aFwiLCBlLnZpZXdJdGVtLmdldE5vcm1hbGl6ZWRTdHlsZShcImJvcmRlci13aWR0aFwiKSwgcilcclxuICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBVUih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIHQuZm9yKFwiZG93bmNhc3RcIikuYXR0cmlidXRlVG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgbW9kZWw6IHtuYW1lOiBlLCBrZXk6IGl9LFxyXG4gICAgICAgICAgICAgICAgdmlldzogdCA9PiAoe2tleTogXCJzdHlsZVwiLCB2YWx1ZToge1tuXTogdH19KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gJFIodCwgZSwgaSkge1xyXG4gICAgICAgICAgICB0LmZvcihcImRvd25jYXN0XCIpLmFkZCh0ID0+IHQub24oYGF0dHJpYnV0ZToke2V9OnRhYmxlYCwgKHQsIGUsIG4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtpdGVtOiBvLCBhdHRyaWJ1dGVOZXdWYWx1ZTogcn0gPSBlO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge21hcHBlcjogcywgd3JpdGVyOiBhfSA9IG47XHJcbiAgICAgICAgICAgICAgICBpZiAoIW4uY29uc3VtYWJsZS5jb25zdW1lKGUuaXRlbSwgdC5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IFsuLi5zLnRvVmlld0VsZW1lbnQobykuZ2V0Q2hpbGRyZW4oKV0uZmluZCh0ID0+IHQuaXMoXCJ0YWJsZVwiKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc2V0U3R5bGUoaSwgciwgYylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5yZW1vdmVTdHlsZShpLCBjKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEdSIGV4dGVuZHMgancge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlTmFtZSA9IGVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBzUyh0Lm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9ICEhZS5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5fZ2V0U2luZ2xlVmFsdWUoZSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZXhlY3V0ZSh0ID0ge30pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHt2YWx1ZTogZSwgYmF0Y2g6IGl9ID0gdDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBzUyhuLmRvY3VtZW50LnNlbGVjdGlvbik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gdGhpcy5fZ2V0VmFsdWVUb1NldChlKTtcclxuICAgICAgICAgICAgICAgIG4uZW5xdWV1ZUNoYW5nZShpIHx8IFwiZGVmYXVsdFwiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLmZvckVhY2goZSA9PiB0LnNldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUsIHIsIGUpKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8uZm9yRWFjaChlID0+IHQucmVtb3ZlQXR0cmlidXRlKHRoaXMuYXR0cmlidXRlTmFtZSwgZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldEF0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0LmdldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRWYWx1ZVRvU2V0KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRTaW5nbGVWYWx1ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fZ2V0QXR0cmlidXRlKHRbMF0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuZXZlcnkodCA9PiB0aGlzLl9nZXRBdHRyaWJ1dGUodCkgPT09IGUpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgPyBlIDogdW5kZWZpbmVkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIEtSIGV4dGVuZHMgR1Ige1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBcInBhZGRpbmdcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldEF0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAkUCh0LmdldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VmFsdWVUb1NldCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gR1AodCwgXCJweFwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBKUiBleHRlbmRzIEdSIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgXCJ3aWR0aFwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VmFsdWVUb1NldCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gR1AodCwgXCJweFwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBZUiBleHRlbmRzIEdSIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgXCJoZWlnaHRcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlVG9TZXQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEdQKHQsIFwicHhcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgUVIgZXh0ZW5kcyBHUiB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIFwiYmFja2dyb3VuZENvbG9yXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFhSIGV4dGVuZHMgR1Ige1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBcInZlcnRpY2FsQWxpZ25tZW50XCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIFpSIGV4dGVuZHMgR1Ige1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBcImhvcml6b250YWxBbGlnbm1lbnRcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgdE8gZXh0ZW5kcyBHUiB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIFwiYm9yZGVyU3R5bGVcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldEF0dHJpYnV0ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAkUCh0LmdldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBlTyBleHRlbmRzIEdSIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgXCJib3JkZXJDb2xvclwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0QXR0cmlidXRlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRQKHQuZ2V0QXR0cmlidXRlKHRoaXMuYXR0cmlidXRlTmFtZSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGlPIGV4dGVuZHMgR1Ige1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBcImJvcmRlcldpZHRoXCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRBdHRyaWJ1dGUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJFAodC5nZXRBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVOYW1lKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlVG9TZXQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEdQKHQsIFwicHhcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgbk8gPSAvXih0b3B8Ym90dG9tKSQvO1xyXG5cclxuICAgICAgICBjbGFzcyBvTyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiVGFibGVDZWxsUHJvcGVydGllc0VkaXRpbmdcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt3RV1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0Lm1vZGVsLnNjaGVtYTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmNvbnZlcnNpb247XHJcbiAgICAgICAgICAgICAgICB0LmRhdGEuYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyhTUik7XHJcbiAgICAgICAgICAgICAgICByTyhlLCBpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVDZWxsQm9yZGVyU3R5bGVcIiwgbmV3IHRPKHQpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVDZWxsQm9yZGVyQ29sb3JcIiwgbmV3IGVPKHQpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVDZWxsQm9yZGVyV2lkdGhcIiwgbmV3IGlPKHQpKTtcclxuICAgICAgICAgICAgICAgIHNPKGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJ0YWJsZUNlbGxIb3Jpem9udGFsQWxpZ25tZW50XCIsIG5ldyBaUih0KSk7XHJcbiAgICAgICAgICAgICAgICBjTyhlLCBpLCBcIndpZHRoXCIsIFwid2lkdGhcIik7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInRhYmxlQ2VsbFdpZHRoXCIsIG5ldyBKUih0KSk7XHJcbiAgICAgICAgICAgICAgICBjTyhlLCBpLCBcImhlaWdodFwiLCBcImhlaWdodFwiKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVDZWxsSGVpZ2h0XCIsIG5ldyBZUih0KSk7XHJcbiAgICAgICAgICAgICAgICB0LmRhdGEuYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyhEUik7XHJcbiAgICAgICAgICAgICAgICBjTyhlLCBpLCBcInBhZGRpbmdcIiwgXCJwYWRkaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJ0YWJsZUNlbGxQYWRkaW5nXCIsIG5ldyBLUih0KSk7XHJcbiAgICAgICAgICAgICAgICB0LmRhdGEuYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyhqUik7XHJcbiAgICAgICAgICAgICAgICBjTyhlLCBpLCBcImJhY2tncm91bmRDb2xvclwiLCBcImJhY2tncm91bmQtY29sb3JcIik7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInRhYmxlQ2VsbEJhY2tncm91bmRDb2xvclwiLCBuZXcgUVIodCkpO1xyXG4gICAgICAgICAgICAgICAgYU8oZSwgaSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInRhYmxlQ2VsbFZlcnRpY2FsQWxpZ25tZW50XCIsIG5ldyBYUih0KSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gck8odCwgZSkge1xyXG4gICAgICAgICAgICB0LmV4dGVuZChcInRhYmxlQ2VsbFwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBbXCJib3JkZXJXaWR0aFwiLCBcImJvcmRlckNvbG9yXCIsIFwiYm9yZGVyU3R5bGVcIl19KTtcclxuICAgICAgICAgICAgcVIoZSwgXCJ0ZFwiKTtcclxuICAgICAgICAgICAgcVIoZSwgXCJ0aFwiKTtcclxuICAgICAgICAgICAgVVIoZSwgXCJ0YWJsZUNlbGxcIiwgXCJib3JkZXJTdHlsZVwiLCBcImJvcmRlci1zdHlsZVwiKTtcclxuICAgICAgICAgICAgVVIoZSwgXCJ0YWJsZUNlbGxcIiwgXCJib3JkZXJDb2xvclwiLCBcImJvcmRlci1jb2xvclwiKTtcclxuICAgICAgICAgICAgVVIoZSwgXCJ0YWJsZUNlbGxcIiwgXCJib3JkZXJXaWR0aFwiLCBcImJvcmRlci13aWR0aFwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc08odCwgZSkge1xyXG4gICAgICAgICAgICB0LmV4dGVuZChcInRhYmxlQ2VsbFwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBbXCJob3Jpem9udGFsQWxpZ25tZW50XCJdfSk7XHJcbiAgICAgICAgICAgIGUuYXR0cmlidXRlVG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgbW9kZWw6IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcInRhYmxlQ2VsbFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGtleTogXCJob3Jpem9udGFsQWxpZ25tZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbXCJyaWdodFwiLCBcImNlbnRlclwiLCBcImp1c3RpZnlcIl1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB2aWV3OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHtrZXk6IFwic3R5bGVcIiwgdmFsdWU6IHtcInRleHQtYWxpZ25cIjogXCJyaWdodFwifX0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2VudGVyOiB7a2V5OiBcInN0eWxlXCIsIHZhbHVlOiB7XCJ0ZXh0LWFsaWduXCI6IFwiY2VudGVyXCJ9fSxcclxuICAgICAgICAgICAgICAgICAgICBqdXN0aWZ5OiB7a2V5OiBcInN0eWxlXCIsIHZhbHVlOiB7XCJ0ZXh0LWFsaWduXCI6IFwianVzdGlmeVwifX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFPKHQsIGUpIHtcclxuICAgICAgICAgICAgdC5leHRlbmQoXCJ0YWJsZUNlbGxcIiwge2FsbG93QXR0cmlidXRlczogW1widmVydGljYWxBbGlnbm1lbnRcIl19KTtcclxuICAgICAgICAgICAgZS5hdHRyaWJ1dGVUb0F0dHJpYnV0ZSh7XHJcbiAgICAgICAgICAgICAgICBtb2RlbDoge25hbWU6IFwidGFibGVDZWxsXCIsIGtleTogXCJ2ZXJ0aWNhbEFsaWdubWVudFwiLCB2YWx1ZXM6IFtcInRvcFwiLCBcImJvdHRvbVwiXX0sXHJcbiAgICAgICAgICAgICAgICB2aWV3OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wOiB7a2V5OiBcInN0eWxlXCIsIHZhbHVlOiB7XCJ2ZXJ0aWNhbC1hbGlnblwiOiBcInRvcFwifX0sXHJcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tOiB7a2V5OiBcInN0eWxlXCIsIHZhbHVlOiB7XCJ2ZXJ0aWNhbC1hbGlnblwiOiBcImJvdHRvbVwifX1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGUuZm9yKFwidXBjYXN0XCIpLmF0dHJpYnV0ZVRvQXR0cmlidXRlKHtcclxuICAgICAgICAgICAgICAgIHZpZXc6IHthdHRyaWJ1dGVzOiB7dmFsaWduOiBuT319LFxyXG4gICAgICAgICAgICAgICAgbW9kZWw6IHtuYW1lOiBcInRhYmxlQ2VsbFwiLCBrZXk6IFwidmVydGljYWxBbGlnbm1lbnRcIiwgdmFsdWU6IHQgPT4gdC5nZXRBdHRyaWJ1dGUoXCJ2YWxpZ25cIil9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjTyh0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgIHQuZXh0ZW5kKFwidGFibGVDZWxsXCIsIHthbGxvd0F0dHJpYnV0ZXM6IFtpXX0pO1xyXG4gICAgICAgICAgICBXUihlLCBcInRhYmxlQ2VsbFwiLCBpLCBuKTtcclxuICAgICAgICAgICAgVVIoZSwgXCJ0YWJsZUNlbGxcIiwgaSwgbilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGxPIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUYWJsZUNlbGxQcm9wZXJ0aWVzXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbb08sIFBSXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBkTyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbbHldXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlRhYmxlVG9vbGJhclwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGFmdGVySW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5wbHVnaW5zLmdldChseSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb25maWcuZ2V0KFwidGFibGUuY29udGVudFRvb2xiYXJcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdC5jb25maWcuZ2V0KFwidGFibGUudGFibGVUb29sYmFyXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnJlZ2lzdGVyKFwidGFibGVDb250ZW50XCIsIHthcmlhTGFiZWw6IGUoXCJpdlwiKSwgaXRlbXM6IG4sIGdldFJlbGF0ZWRFbGVtZW50OiBuU30pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIGkucmVnaXN0ZXIoXCJ0YWJsZVwiLCB7YXJpYUxhYmVsOiBlKFwiaXZcIiksIGl0ZW1zOiBvLCBnZXRSZWxhdGVkRWxlbWVudDogaVN9KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyB1TyBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZU5hbWUgPSBlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbC5kb2N1bWVudC5zZWxlY3Rpb247XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gV1AoXCJ0YWJsZVwiLCBlLmdldEZpcnN0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9ICEhaTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLl9nZXRWYWx1ZShpKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBleGVjdXRlKHQgPSB7fSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZG9jdW1lbnQuc2VsZWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge3ZhbHVlOiBuLCBiYXRjaDogb30gPSB0O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IFdQKFwidGFibGVcIiwgaS5nZXRGaXJzdFBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuX2dldFZhbHVlVG9TZXQobik7XHJcbiAgICAgICAgICAgICAgICBlLmVucXVldWVDaGFuZ2UobyB8fCBcImRlZmF1bHRcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5zZXRBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVOYW1lLCBzLCByKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucmVtb3ZlQXR0cmlidXRlKHRoaXMuYXR0cmlidXRlTmFtZSwgcilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VmFsdWUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5nZXRBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVOYW1lKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VmFsdWVUb1NldCh0KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBoTyBleHRlbmRzIHVPIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgXCJiYWNrZ3JvdW5kQ29sb3JcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZk8gZXh0ZW5kcyB1TyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIFwiYm9yZGVyQ29sb3JcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlKHQpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRQKHQuZ2V0QXR0cmlidXRlKHRoaXMuYXR0cmlidXRlTmFtZSkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGdPIGV4dGVuZHMgdU8ge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBcImJvcmRlclN0eWxlXCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRWYWx1ZSh0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAkUCh0LmdldEF0dHJpYnV0ZSh0aGlzLmF0dHJpYnV0ZU5hbWUpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBtTyBleHRlbmRzIHVPIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCwgXCJib3JkZXJXaWR0aFwiKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0VmFsdWUodCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJFAodC5nZXRBdHRyaWJ1dGUodGhpcy5hdHRyaWJ1dGVOYW1lKSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlVG9TZXQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEdQKHQsIFwicHhcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgcE8gZXh0ZW5kcyB1TyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIFwid2lkdGhcIilcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbHVlVG9TZXQodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIEdQKHQsIFwicHhcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgYk8gZXh0ZW5kcyB1TyB7XHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQsIFwiaGVpZ2h0XCIpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9nZXRWYWx1ZVRvU2V0KHQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBHUCh0LCBcInB4XCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHdPIGV4dGVuZHMgdU8ge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0LCBcImFsaWdubWVudFwiKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBrTyA9IC9eKGxlZnR8cmlnaHQpJC87XHJcblxyXG4gICAgICAgIGNsYXNzIF9PIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJUYWJsZVByb3BlcnRpZXNFZGl0aW5nXCJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbd0VdXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbC5zY2hlbWE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jb252ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgdC5kYXRhLmFkZFN0eWxlUHJvY2Vzc29yUnVsZXMoU1IpO1xyXG4gICAgICAgICAgICAgICAgdk8oZSwgaSk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInRhYmxlQm9yZGVyQ29sb3JcIiwgbmV3IGZPKHQpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVCb3JkZXJTdHlsZVwiLCBuZXcgZ08odCkpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJ0YWJsZUJvcmRlcldpZHRoXCIsIG5ldyBtTyh0KSk7XHJcbiAgICAgICAgICAgICAgICB5TyhlLCBpKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVBbGlnbm1lbnRcIiwgbmV3IHdPKHQpKTtcclxuICAgICAgICAgICAgICAgIENPKGUsIGksIFwid2lkdGhcIiwgXCJ3aWR0aFwiKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwidGFibGVXaWR0aFwiLCBuZXcgcE8odCkpO1xyXG4gICAgICAgICAgICAgICAgQ08oZSwgaSwgXCJoZWlnaHRcIiwgXCJoZWlnaHRcIik7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInRhYmxlSGVpZ2h0XCIsIG5ldyBiTyh0KSk7XHJcbiAgICAgICAgICAgICAgICB0LmRhdGEuYWRkU3R5bGVQcm9jZXNzb3JSdWxlcyhqUik7XHJcbiAgICAgICAgICAgICAgICB4TyhlLCBpLCBcImJhY2tncm91bmRDb2xvclwiLCBcImJhY2tncm91bmQtY29sb3JcIik7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInRhYmxlQmFja2dyb3VuZENvbG9yXCIsIG5ldyBoTyh0KSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdk8odCwgZSkge1xyXG4gICAgICAgICAgICB0LmV4dGVuZChcInRhYmxlXCIsIHthbGxvd0F0dHJpYnV0ZXM6IFtcImJvcmRlcldpZHRoXCIsIFwiYm9yZGVyQ29sb3JcIiwgXCJib3JkZXJTdHlsZVwiXX0pO1xyXG4gICAgICAgICAgICBxUihlLCBcInRhYmxlXCIpO1xyXG4gICAgICAgICAgICAkUihlLCBcImJvcmRlckNvbG9yXCIsIFwiYm9yZGVyLWNvbG9yXCIpO1xyXG4gICAgICAgICAgICAkUihlLCBcImJvcmRlclN0eWxlXCIsIFwiYm9yZGVyLXN0eWxlXCIpO1xyXG4gICAgICAgICAgICAkUihlLCBcImJvcmRlcldpZHRoXCIsIFwiYm9yZGVyLXdpZHRoXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB5Tyh0LCBlKSB7XHJcbiAgICAgICAgICAgIHQuZXh0ZW5kKFwidGFibGVcIiwge2FsbG93QXR0cmlidXRlczogW1wiYWxpZ25tZW50XCJdfSk7XHJcbiAgICAgICAgICAgIGUuYXR0cmlidXRlVG9BdHRyaWJ1dGUoe1xyXG4gICAgICAgICAgICAgICAgbW9kZWw6IHtuYW1lOiBcInRhYmxlXCIsIGtleTogXCJhbGlnbm1lbnRcIiwgdmFsdWVzOiBbXCJsZWZ0XCIsIFwicmlnaHRcIl19LFxyXG4gICAgICAgICAgICAgICAgdmlldzoge2xlZnQ6IHtrZXk6IFwic3R5bGVcIiwgdmFsdWU6IHtmbG9hdDogXCJsZWZ0XCJ9fSwgcmlnaHQ6IHtrZXk6IFwic3R5bGVcIiwgdmFsdWU6IHtmbG9hdDogXCJyaWdodFwifX19LFxyXG4gICAgICAgICAgICAgICAgY29udmVydGVyUHJpb3JpdHk6IFwiaGlnaFwiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBlLmZvcihcInVwY2FzdFwiKS5hdHRyaWJ1dGVUb0F0dHJpYnV0ZSh7XHJcbiAgICAgICAgICAgICAgICB2aWV3OiB7YXR0cmlidXRlczoge2FsaWduOiBrT319LFxyXG4gICAgICAgICAgICAgICAgbW9kZWw6IHtuYW1lOiBcInRhYmxlXCIsIGtleTogXCJhbGlnbm1lbnRcIiwgdmFsdWU6IHQgPT4gdC5nZXRBdHRyaWJ1dGUoXCJhbGlnblwiKX1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHhPKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgdC5leHRlbmQoXCJ0YWJsZVwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBbaV19KTtcclxuICAgICAgICAgICAgV1IoZSwgXCJ0YWJsZVwiLCBpLCBuKTtcclxuICAgICAgICAgICAgJFIoZSwgaSwgbilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIENPKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgdC5leHRlbmQoXCJ0YWJsZVwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBbaV19KTtcclxuICAgICAgICAgICAgV1IoZSwgXCJ0YWJsZVwiLCBpLCBuKTtcclxuICAgICAgICAgICAgVVIoZSwgXCJ0YWJsZVwiLCBpLCBuKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEFPID0gaSgxMTIpO1xyXG4gICAgICAgIGNvbnN0IFRPID0ge2xlZnQ6IGt5LCBjZW50ZXI6IF95LCByaWdodDogdnl9O1xyXG5cclxuICAgICAgICBjbGFzcyBQTyBleHRlbmRzIEdwIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyU3R5bGU6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQ29sb3I6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBhbGlnbm1lbnQ6IFwiXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtib3JkZXJTdHlsZURyb3Bkb3duOiBpLCBib3JkZXJXaWR0aElucHV0OiBuLCBib3JkZXJDb2xvcklucHV0OiBvLCBib3JkZXJSb3dMYWJlbDogcn0gPSB0aGlzLl9jcmVhdGVCb3JkZXJGaWVsZHMoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHt3aWR0aElucHV0OiBzLCBvcGVyYXRvckxhYmVsOiBhLCBoZWlnaHRJbnB1dDogYywgZGltZW5zaW9uc0xhYmVsOiBsfSA9IHRoaXMuX2NyZWF0ZURpbWVuc2lvbkZpZWxkcygpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qge2FsaWdubWVudFRvb2xiYXI6IGQsIGFsaWdubWVudExhYmVsOiB1fSA9IHRoaXMuX2NyZWF0ZUFsaWdubWVudEZpZWxkcygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c1RyYWNrZXIgPSBuZXcgZmI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMgPSBuZXcgZHA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gdGhpcy5jcmVhdGVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvcmRlclN0eWxlRHJvcGRvd24gPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib3JkZXJXaWR0aElucHV0ID0gbjtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyQ29sb3JJbnB1dCA9IG87XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJhY2tncm91bmRJbnB1dCA9IHRoaXMuX2NyZWF0ZUJhY2tncm91bmRGaWVsZCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aWR0aElucHV0ID0gcztcclxuICAgICAgICAgICAgICAgIHRoaXMuaGVpZ2h0SW5wdXQgPSBjO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGlnbm1lbnRUb29sYmFyID0gZDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHtzYXZlQnV0dG9uVmlldzogaCwgY2FuY2VsQnV0dG9uVmlldzogZn0gPSB0aGlzLl9jcmVhdGVBY3Rpb25CdXR0b25zKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVCdXR0b25WaWV3ID0gaDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsQnV0dG9uVmlldyA9IGY7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c2FibGVzID0gbmV3IGJwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9jdXNDeWNsZXIgPSBuZXcgeWIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzYWJsZXM6IHRoaXMuX2ZvY3VzYWJsZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNUcmFja2VyOiB0aGlzLmZvY3VzVHJhY2tlcixcclxuICAgICAgICAgICAgICAgICAgICBrZXlzdHJva2VIYW5kbGVyOiB0aGlzLmtleXN0cm9rZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uczoge2ZvY3VzUHJldmlvdXM6IFwic2hpZnQgKyB0YWJcIiwgZm9jdXNOZXh0OiBcInRhYlwifVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmFkZChuZXcgbVIodCwge2xhYmVsOiB0aGlzLnQoXCLQodCy0L7QudGB0YLQstCwINGC0LDQsdC70LjRhtGLXCIpfSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQobmV3IGZSKHQsIHtcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbFZpZXc6IHIsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtyLCBpLCBvLCBuXSxcclxuICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJjay10YWJsZS1mb3JtX19ib3JkZXItcm93XCJcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4uYWRkKG5ldyBmUih0LCB7Y2hpbGRyZW46IFt0aGlzLmJhY2tncm91bmRJbnB1dF19KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLmFkZChuZXcgZlIodCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbbmV3IGZSKHQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxWaWV3OiBsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW2wsIHMsIGEsIGNdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJjay10YWJsZS1mb3JtX19kaW1lbnNpb25zLXJvd1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfSksIG5ldyBmUih0LCB7bGFiZWxWaWV3OiB1LCBjaGlsZHJlbjogW3UsIGRdLCBjbGFzczogXCJjay10YWJsZS1wcm9wZXJ0aWVzLWZvcm1fX2FsaWdubWVudC1yb3dcIn0pXVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5hZGQobmV3IGZSKHQsIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3RoaXMuc2F2ZUJ1dHRvblZpZXcsIHRoaXMuY2FuY2VsQnV0dG9uVmlld10sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IFwiY2stdGFibGUtZm9ybV9fYWN0aW9uLXJvd1wiXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFRlbXBsYXRlKHtcclxuICAgICAgICAgICAgICAgICAgICB0YWc6IFwiZm9ybVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtjbGFzczogW1wiY2tcIiwgXCJjay1mb3JtXCIsIFwiY2stdGFibGUtZm9ybVwiLCBcImNrLXRhYmxlLXByb3BlcnRpZXMtZm9ybVwiXSwgdGFiaW5kZXg6IFwiLTFcIn0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IHRoaXMuY2hpbGRyZW5cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlbmRlcigpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLnJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgUXYoe3ZpZXc6IHRoaXN9KTtcclxuICAgICAgICAgICAgICAgIFt0aGlzLmJvcmRlclN0eWxlRHJvcGRvd24sIHRoaXMuYm9yZGVyQ29sb3JJbnB1dCwgdGhpcy5ib3JkZXJXaWR0aElucHV0LCB0aGlzLmJhY2tncm91bmRJbnB1dCwgdGhpcy53aWR0aElucHV0LCB0aGlzLmhlaWdodElucHV0LCB0aGlzLmFsaWdubWVudFRvb2xiYXIsIHRoaXMuc2F2ZUJ1dHRvblZpZXcsIHRoaXMuY2FuY2VsQnV0dG9uVmlld10uZm9yRWFjaCh0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9mb2N1c2FibGVzLmFkZCh0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzVHJhY2tlci5hZGQodC5lbGVtZW50KVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmtleXN0cm9rZXMubGlzdGVuVG8odGhpcy5lbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb2N1cygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2ZvY3VzQ3ljbGVyLmZvY3VzRmlyc3QoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfY3JlYXRlQm9yZGVyRmllbGRzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGNSKHtjb2xvckNvbmZpZzogdGhpcy5vcHRpb25zLmJvcmRlckNvbG9ycywgY29sdW1uczogNX0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWsoZSk7XHJcbiAgICAgICAgICAgICAgICBuLnRleHQgPSBpKFwibmJcIik7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gWkUodGhpcy50KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgSEUoZSwgcUUpO1xyXG4gICAgICAgICAgICAgICAgci5zZXQoe2xhYmVsOiBpKFwibmNcIiksIGNsYXNzOiBcImNrLXRhYmxlLWZvcm1fX2JvcmRlci1zdHlsZVwifSk7XHJcbiAgICAgICAgICAgICAgICByLnZpZXcuYnV0dG9uVmlldy5zZXQoe2lzT246IGZhbHNlLCB3aXRoVGV4dDogdHJ1ZSwgdG9vbHRpcDogaShcIm5jXCIpfSk7XHJcbiAgICAgICAgICAgICAgICByLnZpZXcuYnV0dG9uVmlldy5iaW5kKFwibGFiZWxcIikudG8odGhpcywgXCJib3JkZXJTdHlsZVwiLCB0ID0+IG9bdCA/IHQgOiBcIm5vbmVcIl0pO1xyXG4gICAgICAgICAgICAgICAgci52aWV3Lm9uKFwiZXhlY3V0ZVwiLCB0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlclN0eWxlID0gdC5zb3VyY2UuX2JvcmRlclN0eWxlVmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgVWIoci52aWV3LCByUih0aGlzKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbmV3IEhFKGUsIFdFKTtcclxuICAgICAgICAgICAgICAgIHMuc2V0KHtsYWJlbDogaShcIm5kXCIpLCBjbGFzczogXCJjay10YWJsZS1mb3JtX19ib3JkZXItd2lkdGhcIn0pO1xyXG4gICAgICAgICAgICAgICAgcy52aWV3LmJpbmQoXCJ2YWx1ZVwiKS50byh0aGlzLCBcImJvcmRlcldpZHRoXCIpO1xyXG4gICAgICAgICAgICAgICAgcy5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKHRoaXMsIFwiYm9yZGVyU3R5bGVcIiwgU08pO1xyXG4gICAgICAgICAgICAgICAgcy52aWV3Lm9uKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYm9yZGVyV2lkdGggPSBzLnZpZXcuZWxlbWVudC52YWx1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gbmV3IEhFKGUsIHQpO1xyXG4gICAgICAgICAgICAgICAgYS5zZXQoe2xhYmVsOiBpKFwibmVcIiksIGNsYXNzOiBcImNrLXRhYmxlLWZvcm1fX2JvcmRlci1jb2xvclwifSk7XHJcbiAgICAgICAgICAgICAgICBhLnZpZXcuYmluZChcInZhbHVlXCIpLnRvKHRoaXMsIFwiYm9yZGVyQ29sb3JcIik7XHJcbiAgICAgICAgICAgICAgICBhLmJpbmQoXCJpc0VuYWJsZWRcIikudG8odGhpcywgXCJib3JkZXJTdHlsZVwiLCBTTyk7XHJcbiAgICAgICAgICAgICAgICBhLnZpZXcub24oXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3JkZXJDb2xvciA9IGEudmlldy52YWx1ZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uKFwiY2hhbmdlOmJvcmRlclN0eWxlXCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFTTyhpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvcmRlckNvbG9yID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3JkZXJXaWR0aCA9IFwiXCJcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7Ym9yZGVyUm93TGFiZWw6IG4sIGJvcmRlclN0eWxlRHJvcGRvd246IHIsIGJvcmRlckNvbG9ySW5wdXQ6IGEsIGJvcmRlcldpZHRoSW5wdXQ6IHN9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVCYWNrZ3JvdW5kRmllbGQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gY1Ioe2NvbG9yQ29uZmlnOiB0aGlzLm9wdGlvbnMuYmFja2dyb3VuZENvbG9ycywgY29sdW1uczogNX0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgSEUoZSwgdCk7XHJcbiAgICAgICAgICAgICAgICBuLnNldCh7bGFiZWw6IGkoXCJuZlwiKSwgY2xhc3M6IFwiY2stdGFibGUtcHJvcGVydGllcy1mb3JtX19iYWNrZ3JvdW5kXCJ9KTtcclxuICAgICAgICAgICAgICAgIG4udmlldy5iaW5kKFwidmFsdWVcIikudG8odGhpcywgXCJiYWNrZ3JvdW5kQ29sb3JcIik7XHJcbiAgICAgICAgICAgICAgICBuLnZpZXcub24oXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBuLnZpZXcudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZURpbWVuc2lvbkZpZWxkcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IE1rKHQpO1xyXG4gICAgICAgICAgICAgICAgaS50ZXh0ID0gZShcIm5nXCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBIRSh0LCBXRSk7XHJcbiAgICAgICAgICAgICAgICBuLnNldCh7bGFiZWw6IGUoXCJuZFwiKSwgY2xhc3M6IFwiY2stdGFibGUtZm9ybV9fZGltZW5zaW9ucy1yb3dfX3dpZHRoXCJ9KTtcclxuICAgICAgICAgICAgICAgIG4udmlldy5iaW5kKFwidmFsdWVcIikudG8odGhpcywgXCJ3aWR0aFwiKTtcclxuICAgICAgICAgICAgICAgIG4udmlldy5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLndpZHRoID0gbi52aWV3LmVsZW1lbnQudmFsdWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBHcCh0KTtcclxuICAgICAgICAgICAgICAgIG8uc2V0VGVtcGxhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHRhZzogXCJzcGFuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge2NsYXNzOiBbXCJjay10YWJsZS1mb3JtX19kaW1lbnNpb24tb3BlcmF0b3JcIl19LFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbe3RleHQ6IFwiw5dcIn1dXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgSEUodCwgV0UpO1xyXG4gICAgICAgICAgICAgICAgci5zZXQoe2xhYmVsOiBlKFwibmhcIiksIGNsYXNzOiBcImNrLXRhYmxlLWZvcm1fX2RpbWVuc2lvbnMtcm93X19oZWlnaHRcIn0pO1xyXG4gICAgICAgICAgICAgICAgci52aWV3LmJpbmQoXCJ2YWx1ZVwiKS50byh0aGlzLCBcImhlaWdodFwiKTtcclxuICAgICAgICAgICAgICAgIHIudmlldy5vbihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlaWdodCA9IHIudmlldy5lbGVtZW50LnZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7ZGltZW5zaW9uc0xhYmVsOiBpLCB3aWR0aElucHV0OiBuLCBvcGVyYXRvckxhYmVsOiBvLCBoZWlnaHRJbnB1dDogcn1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZUFsaWdubWVudEZpZWxkcygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gbmV3IE1rKHQpO1xyXG4gICAgICAgICAgICAgICAgaS50ZXh0ID0gZShcIm50XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBYYih0KTtcclxuICAgICAgICAgICAgICAgIG4uc2V0KHtpc0NvbXBhY3Q6IHRydWUsIGFyaWFMYWJlbDogZShcIm51XCIpfSk7XHJcbiAgICAgICAgICAgICAgICBzUih7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlldzogdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICBpY29uczogVE8sXHJcbiAgICAgICAgICAgICAgICAgICAgdG9vbGJhcjogbixcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbHM6IHRoaXMuX2FsaWdubWVudExhYmVscyxcclxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWU6IFwiYWxpZ25tZW50XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZVRvVmFsdWU6IHQgPT4gdCA9PT0gXCJjZW50ZXJcIiA/IFwiXCIgOiB0XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7YWxpZ25tZW50TGFiZWw6IGksIGFsaWdubWVudFRvb2xiYXI6IG59XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF9jcmVhdGVBY3Rpb25CdXR0b25zKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMubG9jYWxlO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgaGIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gbmV3IGhiKHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IFt0aGlzLmJvcmRlcldpZHRoSW5wdXQsIHRoaXMuYm9yZGVyQ29sb3JJbnB1dCwgdGhpcy5iYWNrZ3JvdW5kSW5wdXQsIHRoaXMud2lkdGhJbnB1dCwgdGhpcy5oZWlnaHRJbnB1dF07XHJcbiAgICAgICAgICAgICAgICBpLnNldCh7bGFiZWw6IGUoXCJsb1wiKSwgaWNvbjogWHYsIGNsYXNzOiBcImNrLWJ1dHRvbi1zYXZlXCIsIHR5cGU6IFwic3VibWl0XCIsIHdpdGhUZXh0OiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICBpLmJpbmQoXCJpc0VuYWJsZWRcIikudG9NYW55KG8sIFwiZXJyb3JUZXh0XCIsICguLi50KSA9PiB0LmV2ZXJ5KHQgPT4gIXQpKTtcclxuICAgICAgICAgICAgICAgIG4uc2V0KHtsYWJlbDogZShcImxwXCIpLCBpY29uOiBadiwgY2xhc3M6IFwiY2stYnV0dG9uLWNhbmNlbFwiLCB0eXBlOiBcImNhbmNlbFwiLCB3aXRoVGV4dDogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgbi5kZWxlZ2F0ZShcImV4ZWN1dGVcIikudG8odGhpcywgXCJjYW5jZWxcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge3NhdmVCdXR0b25WaWV3OiBpLCBjYW5jZWxCdXR0b25WaWV3OiBufVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXQgX2FsaWdubWVudExhYmVscygpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmxvY2FsZTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZShcIm52XCIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUoXCJud1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlKFwibnhcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAodC51aUxhbmd1YWdlRGlyZWN0aW9uID09PSBcInJ0bFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtyaWdodDogbywgY2VudGVyOiBuLCBsZWZ0OiBpfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2xlZnQ6IGksIGNlbnRlcjogbiwgcmlnaHQ6IG99XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFNPKHQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhdFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIEVPID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTggMnY1aDRWMmgxdjVoNXYxaC01djRoLjAyMWwtLjE3Mi4zNTEtMS45MTYuMjgtLjE1MS4wMjdjLS4yODcuMDYzLS41NC4xODItLjc1NS4zNDFMOCAxM3Y1SDd2LTVIMnYtMWg1VjhIMlY3aDVWMmgxem00IDZIOHY0aDRWOHpcIiBvcGFjaXR5PVwiLjZcIi8+PHBhdGggZD1cIk0xNS41IDExLjVsMS4zMjMgMi42OCAyLjk1Ny40My0yLjE0IDIuMDg1LjUwNSAyLjk0NkwxNS41IDE4LjI1bC0yLjY0NSAxLjM5LjUwNS0yLjk0NS0yLjE0LTIuMDg2IDIuOTU3LS40M0wxNS41IDExLjV6TTE3IDFhMiAyIDAgMCAxIDIgMnY5LjQ3NWwtLjg1LS4xMjQtLjg1Ny0xLjczNmEyLjA0OCAyLjA0OCAwIDAgMC0uMjkyLS40NEwxNyAzSDN2MTRoNy44MDhsLjQwMi4zOTJMMTAuOTM1IDE5SDNhMiAyIDAgMCAxLTItMlYzYTIgMiAwIDAgMSAyLTJoMTR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgUk8gPSA1MDA7XHJcblxyXG4gICAgICAgIGNsYXNzIE9PIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtrYl1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiVGFibGVQcm9wZXJ0aWVzVUlcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0KSB7XHJcbiAgICAgICAgICAgICAgICBzdXBlcih0KTtcclxuICAgICAgICAgICAgICAgIHQuY29uZmlnLmRlZmluZShcInRhYmxlLnRhYmxlUHJvcGVydGllc1wiLCB7Ym9yZGVyQ29sb3JzOiBhUiwgYmFja2dyb3VuZENvbG9yczogYVJ9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpbml0KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2JhbGxvb24gPSB0LnBsdWdpbnMuZ2V0KGtiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldyA9IHRoaXMuX2NyZWF0ZVByb3BlcnRpZXNWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91bmRvU3RlcEJhdGNoID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHQudWkuY29tcG9uZW50RmFjdG9yeS5hZGQoXCJ0YWJsZVByb3BlcnRpZXNcIiwgdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IG5ldyBoYih0KTtcclxuICAgICAgICAgICAgICAgICAgICBpLnNldCh7bGFiZWw6IGUoXCJrZ1wiKSwgaWNvbjogRU8sIHRvb2x0aXA6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGksIFwiZXhlY3V0ZVwiLCAoKSA9PiB0aGlzLl9zaG93VmlldygpKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVzdHJveSgpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5kZXN0cm95KClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2NyZWF0ZVByb3BlcnRpZXNWaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZWRpdGluZy52aWV3LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuY29uZmlnLmdldChcInRhYmxlLnRhYmxlUHJvcGVydGllc1wiKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBfXyhpLmJvcmRlckNvbG9ycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0ga18odC5sb2NhbGUsIG4pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IF9fKGkuYmFja2dyb3VuZENvbG9ycyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0ga18odC5sb2NhbGUsIHIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYSA9IG5ldyBQTyh0LmxvY2FsZSwge2JvcmRlckNvbG9yczogbywgYmFja2dyb3VuZENvbG9yczogc30pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IHQudDtcclxuICAgICAgICAgICAgICAgIGEucmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKGEsIFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oaWRlVmlldygpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oYSwgXCJjYW5jZWxcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl91bmRvU3RlcEJhdGNoLm9wZXJhdGlvbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY3V0ZShcInVuZG9cIiwgdGhpcy5fdW5kb1N0ZXBCYXRjaClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVZpZXcoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBhLmtleXN0cm9rZXMuc2V0KFwiRXNjXCIsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICBlKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Ubyh0LnVpLCBcInVwZGF0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFuUyhlLnNlbGVjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGlkZVZpZXcoKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNWaWV3VmlzaWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBZRSh0LCBcInRhYmxlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBEYih7XHJcbiAgICAgICAgICAgICAgICAgICAgZW1pdHRlcjogYSxcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmF0b3I6ICgpID0+IHRoaXMuX2lzVmlld0luQmFsbG9vbixcclxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0RWxlbWVudHM6IFt0aGlzLl9iYWxsb29uLnZpZXcuZWxlbWVudF0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuX2hpZGVWaWV3KClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IHRSKGMpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZCA9IGVSKGMpO1xyXG4gICAgICAgICAgICAgICAgYS5vbihcImNoYW5nZTpib3JkZXJTdHlsZVwiLCB0aGlzLl9nZXRQcm9wZXJ0eUNoYW5nZUNhbGxiYWNrKFwidGFibGVCb3JkZXJTdHlsZVwiKSk7XHJcbiAgICAgICAgICAgICAgICBhLm9uKFwiY2hhbmdlOmJvcmRlckNvbG9yXCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS5ib3JkZXJDb2xvcklucHV0LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmROYW1lOiBcInRhYmxlQm9yZGVyQ29sb3JcIixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvclRleHQ6IGwsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yOiBpUlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgYS5vbihcImNoYW5nZTpib3JkZXJXaWR0aFwiLCB0aGlzLl9nZXRWYWxpZGF0ZWRQcm9wZXJ0eUNoYW5nZUNhbGxiYWNrKHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3RmllbGQ6IGEuYm9yZGVyV2lkdGhJbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kTmFtZTogXCJ0YWJsZUJvcmRlcldpZHRoXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBkLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRvcjogb1JcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGEub24oXCJjaGFuZ2U6YmFja2dyb3VuZENvbG9yXCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS5iYWNrZ3JvdW5kSW5wdXQsXHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWFuZE5hbWU6IFwidGFibGVCYWNrZ3JvdW5kQ29sb3JcIixcclxuICAgICAgICAgICAgICAgICAgICBlcnJvclRleHQ6IGwsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdG9yOiBpUlxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgYS5vbihcImNoYW5nZTp3aWR0aFwiLCB0aGlzLl9nZXRWYWxpZGF0ZWRQcm9wZXJ0eUNoYW5nZUNhbGxiYWNrKHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3RmllbGQ6IGEud2lkdGhJbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kTmFtZTogXCJ0YWJsZVdpZHRoXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiBkLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkYXRvcjogblJcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIGEub24oXCJjaGFuZ2U6aGVpZ2h0XCIsIHRoaXMuX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdGaWVsZDogYS5oZWlnaHRJbnB1dCxcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kTmFtZTogXCJ0YWJsZUhlaWdodFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yVGV4dDogZCxcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZGF0b3I6IG5SXHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgICAgICBhLm9uKFwiY2hhbmdlOmFsaWdubWVudFwiLCB0aGlzLl9nZXRQcm9wZXJ0eUNoYW5nZUNhbGxiYWNrKFwidGFibGVBbGlnbm1lbnRcIikpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2ZpbGxWaWV3Rm9ybUZyb21Db21tYW5kVmFsdWVzKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuZWRpdG9yLmNvbW1hbmRzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LnNldCh7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyU3R5bGU6IHQuZ2V0KFwidGFibGVCb3JkZXJTdHlsZVwiKS52YWx1ZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiB0LmdldChcInRhYmxlQm9yZGVyQ29sb3JcIikudmFsdWUgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJXaWR0aDogdC5nZXQoXCJ0YWJsZUJvcmRlcldpZHRoXCIpLnZhbHVlIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiB0LmdldChcInRhYmxlQmFja2dyb3VuZENvbG9yXCIpLnZhbHVlIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHQuZ2V0KFwidGFibGVXaWR0aFwiKS52YWx1ZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogdC5nZXQoXCJ0YWJsZUhlaWdodFwiKS52YWx1ZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGFsaWdubWVudDogdC5nZXQoXCJ0YWJsZUFsaWdubWVudFwiKS52YWx1ZSB8fCBcIlwiXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2hvd1ZpZXcoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWxsb29uLmFkZCh7dmlldzogdGhpcy52aWV3LCBwb3NpdGlvbjogUUUodCl9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3VuZG9TdGVwQmF0Y2ggPSB0Lm1vZGVsLmNyZWF0ZUJhdGNoKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9maWxsVmlld0Zvcm1Gcm9tQ29tbWFuZFZhbHVlcygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2hpZGVWaWV3KCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc1ZpZXdJbkJhbGxvb24pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RvcExpc3RlbmluZyh0LnVpLCBcInVwZGF0ZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5zYXZlQnV0dG9uVmlldy5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmFsbG9vbi5yZW1vdmUodGhpcy52aWV3KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdldCBfaXNWaWV3VmlzaWJsZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9iYWxsb29uLnZpc2libGVWaWV3ID09PSB0aGlzLnZpZXdcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZ2V0IF9pc1ZpZXdJbkJhbGxvb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFsbG9vbi5oYXNWaWV3KHRoaXMudmlldylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2sodCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIChlLCBpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZXhlY3V0ZSh0LCB7dmFsdWU6IG4sIGJhdGNoOiB0aGlzLl91bmRvU3RlcEJhdGNofSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2dldFZhbGlkYXRlZFByb3BlcnR5Q2hhbmdlQ2FsbGJhY2soe2NvbW1hbmROYW1lOiB0LCB2aWV3RmllbGQ6IGUsIHZhbGlkYXRvcjogaSwgZXJyb3JUZXh0OiBufSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHVoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLmVycm9yVGV4dCA9IG5cclxuICAgICAgICAgICAgICAgIH0sIFJPKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAobiwgciwgcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG8uY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkocykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IuZXhlY3V0ZSh0LCB7dmFsdWU6IHMsIGJhdGNoOiB0aGlzLl91bmRvU3RlcEJhdGNofSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZXJyb3JUZXh0ID0gbnVsbFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8oKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgSU8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlRhYmxlUHJvcGVydGllc1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW19PLCBPT11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgVk8gPSBcInVuZGVybGluZVwiO1xyXG5cclxuICAgICAgICBjbGFzcyBOTyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiVW5kZXJsaW5lRWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0Lm1vZGVsLnNjaGVtYS5leHRlbmQoXCIkdGV4dFwiLCB7YWxsb3dBdHRyaWJ1dGVzOiBWT30pO1xyXG4gICAgICAgICAgICAgICAgdC5tb2RlbC5zY2hlbWEuc2V0QXR0cmlidXRlUHJvcGVydGllcyhWTywge2lzRm9ybWF0dGluZzogdHJ1ZSwgY29weU9uRW50ZXI6IHRydWV9KTtcclxuICAgICAgICAgICAgICAgIHQuY29udmVyc2lvbi5hdHRyaWJ1dGVUb0VsZW1lbnQoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiBWTyxcclxuICAgICAgICAgICAgICAgICAgICB2aWV3OiBcInVcIixcclxuICAgICAgICAgICAgICAgICAgICB1cGNhc3RBbHNvOiB7c3R5bGVzOiB7XCJ0ZXh0LWRlY29yYXRpb25cIjogXCJ1bmRlcmxpbmVcIn19XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFZPLCBuZXcgeWsodCwgVk8pKTtcclxuICAgICAgICAgICAgICAgIHQua2V5c3Ryb2tlcy5zZXQoXCJDVFJMK1VcIiwgXCJ1bmRlcmxpbmVcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIE1PID0gJzxzdmcgdmlld0JveD1cIjAgMCAyMCAyMFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwiTTMgMTh2LTEuNWgxNFYxOHptMi4yLThWMy42YzAtLjQuNC0uNi44LS42LjMgMCAuNy4yLjcuNnY2LjJjMCAyIDEuMyAyLjggMy4yIDIuOCAxLjkgMCAzLjQtLjkgMy40LTIuOVYzLjZjMC0uMy40LS41LjgtLjUuMyAwIC43LjIuNy41VjEwYzAgMi43LTIuMiA0LTQuOSA0LTIuNiAwLTQuNy0xLjItNC43LTR6XCIvPjwvc3ZnPic7XHJcbiAgICAgICAgY29uc3QgQk8gPSBcInVuZGVybGluZVwiO1xyXG5cclxuICAgICAgICBjbGFzcyB6TyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgaW5pdCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvcjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LnQ7XHJcbiAgICAgICAgICAgICAgICB0LnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKEJPLCBpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5jb21tYW5kcy5nZXQoQk8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuZXcgaGIoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgby5zZXQoe2xhYmVsOiBlKFwiam5cIiksIGljb246IE1PLCBrZXlzdHJva2U6IFwiQ1RSTCtVXCIsIHRvb2x0aXA6IHRydWUsIGlzVG9nZ2xlYWJsZTogdHJ1ZX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG8uYmluZChcImlzT25cIiwgXCJpc0VuYWJsZWRcIikudG8obiwgXCJ2YWx1ZVwiLCBcImlzRW5hYmxlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKG8sIFwiZXhlY3V0ZVwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZXhlY3V0ZShCTyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZWRpdGluZy52aWV3LmZvY3VzKClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgTE8gZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcmVxdWlyZXMoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW05PLCB6T11cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiVW5kZXJsaW5lXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24qIEZPKHQsIGUpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpICYmIHQuZ2V0QXR0cmlidXRlUHJvcGVydGllcyhpWzBdKS5jb3B5T25FbnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgRE8gZXh0ZW5kcyBqdyB7XHJcbiAgICAgICAgICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHQuY2hhbmdlKGkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGpPKHRoaXMuZWRpdG9yLm1vZGVsLCBpLCBlLnNlbGVjdGlvbiwgdC5zY2hlbWEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImFmdGVyRXhlY3V0ZVwiLCB7d3JpdGVyOiBpfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGpPKHQsIGUsIGksIG4pIHtcclxuICAgICAgICAgICAgY29uc3QgbyA9IGkuaXNDb2xsYXBzZWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBpLmdldEZpcnN0UmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgcyA9IHIuc3RhcnQucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBhID0gci5lbmQucGFyZW50O1xyXG4gICAgICAgICAgICBpZiAobi5pc0xpbWl0KHMpIHx8IG4uaXNMaW1pdChhKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvICYmIHMgPT0gYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuZGVsZXRlQ29udGVudChpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBGTyhlLm1vZGVsLnNjaGVtYSwgaS5nZXRBdHRyaWJ1dGVzKCkpO1xyXG4gICAgICAgICAgICAgICAgSE8oZSwgci5zdGFydCk7XHJcbiAgICAgICAgICAgICAgICBlLnNldFNlbGVjdGlvbkF0dHJpYnV0ZSh0KVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9ICEoci5zdGFydC5pc0F0U3RhcnQgJiYgci5lbmQuaXNBdEVuZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gcyA9PSBhO1xyXG4gICAgICAgICAgICAgICAgdC5kZWxldGVDb250ZW50KGksIHtsZWF2ZVVubWVyZ2VkOiBufSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEhPKGUsIGkuZm9jdXMpXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRTZWxlY3Rpb24oYSwgMClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEhPKHQsIGUpIHtcclxuICAgICAgICAgICAgdC5zcGxpdChlKTtcclxuICAgICAgICAgICAgdC5zZXRTZWxlY3Rpb24oZS5wYXJlbnQubmV4dFNpYmxpbmcsIDApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBXTyBleHRlbmRzIEdkIHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGUub24oXCJrZXlkb3duXCIsICh0LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVkICYmIGkua2V5Q29kZSA9PSBObC5lbnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5vbmNlKFwiZW50ZXJcIiwgdCA9PiBuID0gdCwge3ByaW9yaXR5OiBcImhpZ2hlc3RcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLmZpcmUoXCJlbnRlclwiLCBuZXcgS3UoZSwgaS5kb21FdmVudCwge2lzU29mdDogaS5zaGlmdEtleX0pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gJiYgbi5zdG9wLmNhbGxlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zdG9wKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG9ic2VydmUoKSB7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHFPIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJFbnRlclwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5lZGl0aW5nLnZpZXc7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGUuYWRkT2JzZXJ2ZXIoV08pO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJlbnRlclwiLCBuZXcgRE8odCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5UbyhpLCBcImVudGVyXCIsIChpLCBuKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuLmlzU29mdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdC5leGVjdXRlKFwiZW50ZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5zY3JvbGxUb1RoZVNlbGVjdGlvbigpXHJcbiAgICAgICAgICAgICAgICB9LCB7cHJpb3JpdHk6IFwibG93XCJ9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBVTyBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgZXhlY3V0ZSgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0LmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgdC5jaGFuZ2UoaSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgR08odCwgaSwgZS5zZWxlY3Rpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlyZShcImFmdGVyRXhlY3V0ZVwiLCB7d3JpdGVyOiBpfSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNFbmFibGVkID0gJE8odC5zY2hlbWEsIGUuc2VsZWN0aW9uKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiAkTyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnJhbmdlQ291bnQgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBpID0gZS5hbmNob3I7XHJcbiAgICAgICAgICAgIGlmICghaSB8fCAhdC5jaGVja0NoaWxkKGksIFwic29mdEJyZWFrXCIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBuID0gZS5nZXRGaXJzdFJhbmdlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBuLnN0YXJ0LnBhcmVudDtcclxuICAgICAgICAgICAgY29uc3QgciA9IG4uZW5kLnBhcmVudDtcclxuICAgICAgICAgICAgaWYgKChKTyhvLCB0KSB8fCBKTyhyLCB0KSkgJiYgbyAhPT0gcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEdPKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGkuaXNDb2xsYXBzZWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSBpLmdldEZpcnN0UmFuZ2UoKTtcclxuICAgICAgICAgICAgY29uc3QgciA9IG8uc3RhcnQucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBzID0gby5lbmQucGFyZW50O1xyXG4gICAgICAgICAgICBjb25zdCBhID0gciA9PSBzO1xyXG4gICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEZPKHQuc2NoZW1hLCBpLmdldEF0dHJpYnV0ZXMoKSk7XHJcbiAgICAgICAgICAgICAgICBLTyh0LCBlLCBvLmVuZCk7XHJcbiAgICAgICAgICAgICAgICBlLnJlbW92ZVNlbGVjdGlvbkF0dHJpYnV0ZShpLmdldEF0dHJpYnV0ZUtleXMoKSk7XHJcbiAgICAgICAgICAgICAgICBlLnNldFNlbGVjdGlvbkF0dHJpYnV0ZShuKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9ICEoby5zdGFydC5pc0F0U3RhcnQgJiYgby5lbmQuaXNBdEVuZCk7XHJcbiAgICAgICAgICAgICAgICB0LmRlbGV0ZUNvbnRlbnQoaSwge2xlYXZlVW5tZXJnZWQ6IG59KTtcclxuICAgICAgICAgICAgICAgIGlmIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgS08odCwgZSwgaS5mb2N1cylcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zZXRTZWxlY3Rpb24ocywgMClcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIEtPKHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUuY3JlYXRlRWxlbWVudChcInNvZnRCcmVha1wiKTtcclxuICAgICAgICAgICAgdC5pbnNlcnRDb250ZW50KG4sIGkpO1xyXG4gICAgICAgICAgICBlLnNldFNlbGVjdGlvbihuLCBcImFmdGVyXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBKTyh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICh0LmlzKFwicm9vdEVsZW1lbnRcIikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBlLmlzTGltaXQodCkgfHwgSk8odC5wYXJlbnQsIGUpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBZTyBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCBwbHVnaW5OYW1lKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiU2hpZnRFbnRlclwiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5tb2RlbC5zY2hlbWE7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jb252ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuZWRpdGluZy52aWV3O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG4uZG9jdW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBlLnJlZ2lzdGVyKFwic29mdEJyZWFrXCIsIHthbGxvd1doZXJlOiBcIiR0ZXh0XCIsIGlzSW5saW5lOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICBpLmZvcihcInVwY2FzdFwiKS5lbGVtZW50VG9FbGVtZW50KHttb2RlbDogXCJzb2Z0QnJlYWtcIiwgdmlldzogXCJiclwifSk7XHJcbiAgICAgICAgICAgICAgICBpLmZvcihcImRvd25jYXN0XCIpLmVsZW1lbnRUb0VsZW1lbnQoe21vZGVsOiBcInNvZnRCcmVha1wiLCB2aWV3OiAodCwgZSkgPT4gZS5jcmVhdGVFbXB0eUVsZW1lbnQoXCJiclwiKX0pO1xyXG4gICAgICAgICAgICAgICAgbi5hZGRPYnNlcnZlcihXTyk7XHJcbiAgICAgICAgICAgICAgICB0LmNvbW1hbmRzLmFkZChcInNoaWZ0RW50ZXJcIiwgbmV3IFVPKHQpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8obywgXCJlbnRlclwiLCAoZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGkucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuaXNTb2Z0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0LmV4ZWN1dGUoXCJzaGlmdEVudGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIG4uc2Nyb2xsVG9UaGVTZWxlY3Rpb24oKVxyXG4gICAgICAgICAgICAgICAgfSwge3ByaW9yaXR5OiBcImxvd1wifSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgUU8gPSBuZXcgTWFwO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBYTyh0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgIGxldCBuID0gUU8uZ2V0KHQpO1xyXG4gICAgICAgICAgICBpZiAoIW4pIHtcclxuICAgICAgICAgICAgICAgIG4gPSBuZXcgTWFwO1xyXG4gICAgICAgICAgICAgICAgUU8uc2V0KHQsIG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbi5zZXQoZSwgaSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIFpPKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IFFPLmdldCh0KTtcclxuICAgICAgICAgICAgaWYgKGkgJiYgaS5oYXMoZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpLmdldChlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0SVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdEkodCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlSSh0LCBlLCBpID0ge30pIHtcclxuICAgICAgICAgICAgY29uc3QgbiA9IFpPKHQuY29uc3RydWN0b3IsIGUuY29uc3RydWN0b3IpO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdCA9IHQuY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuKHQsIGUsIGkpXHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaUkodCwgZSwgaSkge1xyXG4gICAgICAgICAgICB0ID0gdC5zbGljZSgpO1xyXG4gICAgICAgICAgICBlID0gZS5zbGljZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IG5JKGkuZG9jdW1lbnQsIGkudXNlUmVsYXRpb25zLCBpLmZvcmNlV2Vha1JlbW92ZSk7XHJcbiAgICAgICAgICAgIG4uc2V0T3JpZ2luYWxPcGVyYXRpb25zKHQpO1xyXG4gICAgICAgICAgICBuLnNldE9yaWdpbmFsT3BlcmF0aW9ucyhlKTtcclxuICAgICAgICAgICAgY29uc3QgbyA9IG4ub3JpZ2luYWxPcGVyYXRpb25zO1xyXG4gICAgICAgICAgICBpZiAodC5sZW5ndGggPT0gMCB8fCBlLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge29wZXJhdGlvbnNBOiB0LCBvcGVyYXRpb25zQjogZSwgb3JpZ2luYWxPcGVyYXRpb25zOiBvfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgV2Vha01hcDtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcclxuICAgICAgICAgICAgICAgIHIuc2V0KGUsIDApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgcyA9IHtcclxuICAgICAgICAgICAgICAgIG5leHRCYXNlVmVyc2lvbkE6IHRbdC5sZW5ndGggLSAxXS5iYXNlVmVyc2lvbiArIDEsXHJcbiAgICAgICAgICAgICAgICBuZXh0QmFzZVZlcnNpb25COiBlW2UubGVuZ3RoIC0gMV0uYmFzZVZlcnNpb24gKyAxLFxyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxPcGVyYXRpb25zQUNvdW50OiB0Lmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsT3BlcmF0aW9uc0JDb3VudDogZS5sZW5ndGhcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbGV0IGEgPSAwO1xyXG4gICAgICAgICAgICB3aGlsZSAoYSA8IHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdFthXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSByLmdldChpKTtcclxuICAgICAgICAgICAgICAgIGlmIChvID09IGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYSsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZVtvXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSBlSShpLCBzLCBuLmdldENvbnRleHQoaSwgcywgdHJ1ZSkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbCA9IGVJKHMsIGksIG4uZ2V0Q29udGV4dChzLCBpLCBmYWxzZSkpO1xyXG4gICAgICAgICAgICAgICAgbi51cGRhdGVSZWxhdGlvbihpLCBzKTtcclxuICAgICAgICAgICAgICAgIG4uc2V0T3JpZ2luYWxPcGVyYXRpb25zKGMsIGkpO1xyXG4gICAgICAgICAgICAgICAgbi5zZXRPcmlnaW5hbE9wZXJhdGlvbnMobCwgcyk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgYykge1xyXG4gICAgICAgICAgICAgICAgICAgIHIuc2V0KHQsIG8gKyBsLmxlbmd0aClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQuc3BsaWNlKGEsIDEsIC4uLmMpO1xyXG4gICAgICAgICAgICAgICAgZS5zcGxpY2UobywgMSwgLi4ubClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaS5wYWRXaXRoTm9PcHMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0Lmxlbmd0aCAtIHMub3JpZ2luYWxPcGVyYXRpb25zQUNvdW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUubGVuZ3RoIC0gcy5vcmlnaW5hbE9wZXJhdGlvbnNCQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBySSh0LCBuIC0gaSk7XHJcbiAgICAgICAgICAgICAgICBySShlLCBpIC0gbilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvSSh0LCBzLm5leHRCYXNlVmVyc2lvbkIpO1xyXG4gICAgICAgICAgICBvSShlLCBzLm5leHRCYXNlVmVyc2lvbkEpO1xyXG4gICAgICAgICAgICByZXR1cm4ge29wZXJhdGlvbnNBOiB0LCBvcGVyYXRpb25zQjogZSwgb3JpZ2luYWxPcGVyYXRpb25zOiBvfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3Mgbkkge1xyXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih0LCBlLCBpID0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luYWxPcGVyYXRpb25zID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnkgPSB0Lmhpc3Rvcnk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91c2VSZWxhdGlvbnMgPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9yY2VXZWFrUmVtb3ZlID0gISFpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVsYXRpb25zID0gbmV3IE1hcFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzZXRPcmlnaW5hbE9wZXJhdGlvbnModCwgZSA9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlID8gdGhpcy5vcmlnaW5hbE9wZXJhdGlvbnMuZ2V0KGUpIDogbnVsbDtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbE9wZXJhdGlvbnMuc2V0KGUsIGkgfHwgZSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXBkYXRlUmVsYXRpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoICh0LmNvbnN0cnVjdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBaZzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGUuY29uc3RydWN0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ugb206IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC50YXJnZXRQb3NpdGlvbi5pc0VxdWFsKGUuc291cmNlUG9zaXRpb24pIHx8IGUubW92ZWRSYW5nZS5jb250YWluc1Bvc2l0aW9uKHQudGFyZ2V0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJlbGF0aW9uKHQsIGUsIFwiaW5zZXJ0QXRTb3VyY2VcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHQudGFyZ2V0UG9zaXRpb24uaXNFcXVhbChlLmRlbGV0aW9uUG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJlbGF0aW9uKHQsIGUsIFwiaW5zZXJ0QmV0d2VlblwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodC50YXJnZXRQb3NpdGlvbi5pc0FmdGVyKGUuc291cmNlUG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJlbGF0aW9uKHQsIGUsIFwibW92ZVRhcmdldEFmdGVyXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFpnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudGFyZ2V0UG9zaXRpb24uaXNFcXVhbChlLnNvdXJjZVBvc2l0aW9uKSB8fCB0LnRhcmdldFBvc2l0aW9uLmlzQmVmb3JlKGUuc291cmNlUG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJlbGF0aW9uKHQsIGUsIFwiaW5zZXJ0QmVmb3JlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmVsYXRpb24odCwgZSwgXCJpbnNlcnRBZnRlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2Ugcm06IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlLmNvbnN0cnVjdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIG9tOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuc3BsaXRQb3NpdGlvbi5pc0JlZm9yZShlLnNvdXJjZVBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZWxhdGlvbih0LCBlLCBcInNwbGl0QmVmb3JlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFpnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuc3BsaXRQb3NpdGlvbi5pc0VxdWFsKGUuc291cmNlUG9zaXRpb24pIHx8IHQuc3BsaXRQb3NpdGlvbi5pc0JlZm9yZShlLnNvdXJjZVBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZWxhdGlvbih0LCBlLCBcInNwbGl0QmVmb3JlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBvbToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGUuY29uc3RydWN0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ugb206IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXQudGFyZ2V0UG9zaXRpb24uaXNFcXVhbChlLnNvdXJjZVBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZWxhdGlvbih0LCBlLCBcIm1lcmdlVGFyZ2V0Tm90TW92ZWRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuc291cmNlUG9zaXRpb24uaXNFcXVhbChlLnRhcmdldFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZWxhdGlvbih0LCBlLCBcIm1lcmdlU291cmNlTm90TW92ZWRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuc291cmNlUG9zaXRpb24uaXNFcXVhbChlLnNvdXJjZVBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZXRSZWxhdGlvbih0LCBlLCBcIm1lcmdlU2FtZUVsZW1lbnRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2Ugcm06IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodC5zb3VyY2VQb3NpdGlvbi5pc0VxdWFsKGUuc3BsaXRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmVsYXRpb24odCwgZSwgXCJzcGxpdEF0U291cmNlXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZW06IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQubmV3UmFuZ2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlLmNvbnN0cnVjdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFpnOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdChlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBuLmNvbnRhaW5zUG9zaXRpb24oaS5zdGFydCkgfHwgbi5zdGFydC5pc0VxdWFsKGkuc3RhcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuLmNvbnRhaW5zUG9zaXRpb24oaS5lbmQpIHx8IG4uZW5kLmlzRXF1YWwoaS5lbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgobyB8fCByKSAmJiAhbi5jb250YWluc1JhbmdlKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldFJlbGF0aW9uKHQsIGUsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZGU6IG8gPyBcImxlZnRcIiA6IFwicmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IG8gPyBpLnN0YXJ0LnBhdGguc2xpY2UoKSA6IGkuZW5kLnBhdGguc2xpY2UoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBvbToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLnN0YXJ0LmlzRXF1YWwoZS50YXJnZXRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IGkuc3RhcnQuaXNFcXVhbChlLmRlbGV0aW9uUG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBpLmVuZC5pc0VxdWFsKGUuZGVsZXRpb25Qb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IGkuZW5kLmlzRXF1YWwoZS5zb3VyY2VQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gfHwgbyB8fCByIHx8IHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2V0UmVsYXRpb24odCwgZSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FzSW5MZWZ0RWxlbWVudDogbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhc1N0YXJ0QmVmb3JlTWVyZ2VkRWxlbWVudDogbyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhc0VuZEJlZm9yZU1lcmdlZEVsZW1lbnQ6IHIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YXNJblJpZ2h0RWxlbWVudDogc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnZXRDb250ZXh0KHQsIGUsIGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYUlzU3Ryb25nOiBpLFxyXG4gICAgICAgICAgICAgICAgICAgIGFXYXNVbmRvbmU6IHRoaXMuX3dhc1VuZG9uZSh0KSxcclxuICAgICAgICAgICAgICAgICAgICBiV2FzVW5kb25lOiB0aGlzLl93YXNVbmRvbmUoZSksXHJcbiAgICAgICAgICAgICAgICAgICAgYWJSZWxhdGlvbjogdGhpcy5fdXNlUmVsYXRpb25zID8gdGhpcy5fZ2V0UmVsYXRpb24odCwgZSkgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGJhUmVsYXRpb246IHRoaXMuX3VzZVJlbGF0aW9ucyA/IHRoaXMuX2dldFJlbGF0aW9uKGUsIHQpIDogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBmb3JjZVdlYWtSZW1vdmU6IHRoaXMuX2ZvcmNlV2Vha1JlbW92ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfd2FzVW5kb25lKHQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLm9yaWdpbmFsT3BlcmF0aW9ucy5nZXQodCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS53YXNVbmRvbmUgfHwgdGhpcy5faGlzdG9yeS5pc1VuZG9uZU9wZXJhdGlvbihlKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfZ2V0UmVsYXRpb24odCwgZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMub3JpZ2luYWxPcGVyYXRpb25zLmdldChlKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9oaXN0b3J5LmdldFVuZG9uZU9wZXJhdGlvbihpKTtcclxuICAgICAgICAgICAgICAgIGlmICghbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5vcmlnaW5hbE9wZXJhdGlvbnMuZ2V0KHQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuX3JlbGF0aW9ucy5nZXQobyk7XHJcbiAgICAgICAgICAgICAgICBpZiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByLmdldChuKSB8fCBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfc2V0UmVsYXRpb24odCwgZSwgaSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMub3JpZ2luYWxPcGVyYXRpb25zLmdldCh0KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLm9yaWdpbmFsT3BlcmF0aW9ucy5nZXQoZSk7XHJcbiAgICAgICAgICAgICAgICBsZXQgciA9IHRoaXMuX3JlbGF0aW9ucy5nZXQobik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByID0gbmV3IE1hcDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWxhdGlvbnMuc2V0KG4sIHIpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByLnNldChvLCBpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvSSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICBpLmJhc2VWZXJzaW9uID0gZSsrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJJKHQsIGUpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHQucHVzaChuZXcgU20oMCkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIFhPKFFnLCBRZywgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHQua2V5ID09PSBlLmtleSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQucmFuZ2UuZ2V0RGlmZmVyZW5jZShlLnJhbmdlKS5tYXAoZSA9PiBuZXcgUWcoZSwgdC5rZXksIHQub2xkVmFsdWUsIHQubmV3VmFsdWUsIDApKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSB0LnJhbmdlLmdldEludGVyc2VjdGlvbihlLnJhbmdlKTtcclxuICAgICAgICAgICAgICAgIGlmIChvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuYUlzU3Ryb25nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4ucHVzaChuZXcgUWcobywgZS5rZXksIGUubmV3VmFsdWUsIHQubmV3VmFsdWUsIDApKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgU20oMCldXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8oUWcsIHRtLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodC5yYW5nZS5zdGFydC5oYXNTYW1lUGFyZW50QXMoZS5wb3NpdGlvbikgJiYgdC5yYW5nZS5jb250YWluc1Bvc2l0aW9uKGUucG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5yYW5nZS5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbihlLnBvc2l0aW9uLCBlLmhvd01hbnksICFlLnNob3VsZFJlY2VpdmVBdHRyaWJ1dGVzKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLm1hcChlID0+IG5ldyBRZyhlLCB0LmtleSwgdC5vbGRWYWx1ZSwgdC5uZXdWYWx1ZSwgdC5iYXNlVmVyc2lvbikpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGUuc2hvdWxkUmVjZWl2ZUF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gc0koZSwgdC5rZXksIHQub2xkVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4udW5zaGlmdChpKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5yYW5nZSA9IHQucmFuZ2UuX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRpb24oZS5wb3NpdGlvbiwgZS5ob3dNYW55LCBmYWxzZSlbMF07XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc0kodCwgZSwgaSkge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gdC5ub2RlcztcclxuICAgICAgICAgICAgY29uc3QgbyA9IG4uZ2V0Tm9kZSgwKS5nZXRBdHRyaWJ1dGUoZSk7XHJcbiAgICAgICAgICAgIGlmIChvID09IGkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgciA9IG5ldyAkaCh0LnBvc2l0aW9uLCB0LnBvc2l0aW9uLmdldFNoaWZ0ZWRCeSh0Lmhvd01hbnkpKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBRZyhyLCBlLCBvLCBpLCAwKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgWE8oUWcsIG9tLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgIGlmICh0LnJhbmdlLnN0YXJ0Lmhhc1NhbWVQYXJlbnRBcyhlLmRlbGV0aW9uUG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5yYW5nZS5jb250YWluc1Bvc2l0aW9uKGUuZGVsZXRpb25Qb3NpdGlvbikgfHwgdC5yYW5nZS5zdGFydC5pc0VxdWFsKGUuZGVsZXRpb25Qb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpLnB1c2goJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KGUuZ3JhdmV5YXJkUG9zaXRpb24sIDEpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnJhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5TWVyZ2VPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIGlmICghbi5pc0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKG4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGkubWFwKGUgPT4gbmV3IFFnKGUsIHQua2V5LCB0Lm9sZFZhbHVlLCB0Lm5ld1ZhbHVlLCB0LmJhc2VWZXJzaW9uKSlcclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhRZywgWmcsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBhSSh0LnJhbmdlLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGkubWFwKGUgPT4gbmV3IFFnKGUsIHQua2V5LCB0Lm9sZFZhbHVlLCB0Lm5ld1ZhbHVlLCB0LmJhc2VWZXJzaW9uKSlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYUkodCwgZSkge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KGUuc291cmNlUG9zaXRpb24sIGUuaG93TWFueSk7XHJcbiAgICAgICAgICAgIGxldCBuID0gbnVsbDtcclxuICAgICAgICAgICAgbGV0IG8gPSBbXTtcclxuICAgICAgICAgICAgaWYgKGkuY29udGFpbnNSYW5nZSh0LCB0cnVlKSkge1xyXG4gICAgICAgICAgICAgICAgbiA9IHRcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0LnN0YXJ0Lmhhc1NhbWVQYXJlbnRBcyhpLnN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgbyA9IHQuZ2V0RGlmZmVyZW5jZShpKTtcclxuICAgICAgICAgICAgICAgIG4gPSB0LmdldEludGVyc2VjdGlvbihpKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbyA9IFt0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgdCBvZiBvKSB7XHJcbiAgICAgICAgICAgICAgICB0ID0gdC5fZ2V0VHJhbnNmb3JtZWRCeURlbGV0aW9uKGUuc291cmNlUG9zaXRpb24sIGUuaG93TWFueSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5nZXRNb3ZlZFJhbmdlU3RhcnQoKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnN0YXJ0Lmhhc1NhbWVQYXJlbnRBcyhpKTtcclxuICAgICAgICAgICAgICAgIHQgPSB0Ll9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0aW9uKGksIGUuaG93TWFueSwgbik7XHJcbiAgICAgICAgICAgICAgICByLnB1c2goLi4udClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgci5wdXNoKG4uX2dldFRyYW5zZm9ybWVkQnlNb3ZlKGUuc291cmNlUG9zaXRpb24sIGUudGFyZ2V0UG9zaXRpb24sIGUuaG93TWFueSwgZmFsc2UpWzBdKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBYTyhRZywgcm0sICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0LnJhbmdlLmVuZC5pc0VxdWFsKGUuaW5zZXJ0aW9uUG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWUuZ3JhdmV5YXJkUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnJhbmdlLmVuZC5vZmZzZXQrK1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnJhbmdlLnN0YXJ0Lmhhc1NhbWVQYXJlbnRBcyhlLnNwbGl0UG9zaXRpb24pICYmIHQucmFuZ2UuY29udGFpbnNQb3NpdGlvbihlLnNwbGl0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgaS5yYW5nZSA9IG5ldyAkaChlLm1vdmVUYXJnZXRQb3NpdGlvbi5jbG9uZSgpLCB0LnJhbmdlLmVuZC5fZ2V0Q29tYmluZWQoZS5zcGxpdFBvc2l0aW9uLCBlLm1vdmVUYXJnZXRQb3NpdGlvbikpO1xyXG4gICAgICAgICAgICAgICAgdC5yYW5nZS5lbmQgPSBlLnNwbGl0UG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHQucmFuZ2UuZW5kLnN0aWNraW5lc3MgPSBcInRvUHJldmlvdXNcIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbdCwgaV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnJhbmdlID0gdC5yYW5nZS5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8odG0sIFFnLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpID0gW3RdO1xyXG4gICAgICAgICAgICBpZiAodC5zaG91bGRSZWNlaXZlQXR0cmlidXRlcyAmJiB0LnBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyhlLnJhbmdlLnN0YXJ0KSAmJiBlLnJhbmdlLmNvbnRhaW5zUG9zaXRpb24odC5wb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBzSSh0LCBlLmtleSwgZS5uZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAobikge1xyXG4gICAgICAgICAgICAgICAgICAgIGkucHVzaChuKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8odG0sIHRtLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodC5wb3NpdGlvbi5pc0VxdWFsKGUucG9zaXRpb24pICYmIGkuYUlzU3Ryb25nKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5wb3NpdGlvbiA9IHQucG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyh0bSwgWmcsICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgIHQucG9zaXRpb24gPSB0LnBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKHRtLCBybSwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgdC5wb3NpdGlvbiA9IHQucG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlTcGxpdE9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKHRtLCBvbSwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgdC5wb3NpdGlvbiA9IHQucG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKGVtLCB0bSwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHQub2xkUmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHQub2xkUmFuZ2UgPSB0Lm9sZFJhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0T3BlcmF0aW9uKGUpWzBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQubmV3UmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHQubmV3UmFuZ2UgPSB0Lm5ld1JhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5SW5zZXJ0T3BlcmF0aW9uKGUpWzBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKGVtLCBlbSwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHQubmFtZSA9PSBlLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpLmFJc1N0cm9uZykge1xyXG4gICAgICAgICAgICAgICAgICAgIHQub2xkUmFuZ2UgPSBlLm5ld1JhbmdlID8gZS5uZXdSYW5nZS5jbG9uZSgpIDogbnVsbFxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBTbSgwKV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8oZW0sIG9tLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodC5vbGRSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgdC5vbGRSYW5nZSA9IHQub2xkUmFuZ2UuX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0Lm5ld1JhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICB0Lm5ld1JhbmdlID0gdC5uZXdSYW5nZS5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKGVtLCBaZywgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHQub2xkUmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIHQub2xkUmFuZ2UgPSAkaC5fY3JlYXRlRnJvbVJhbmdlcyh0Lm9sZFJhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5uZXdSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGkuYWJSZWxhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSAkaC5fY3JlYXRlRnJvbVJhbmdlcyh0Lm5ld1JhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkuYWJSZWxhdGlvbi5zaWRlID09IFwibGVmdFwiICYmIGUudGFyZ2V0UG9zaXRpb24uaXNFcXVhbCh0Lm5ld1JhbmdlLnN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm5ld1JhbmdlLnN0YXJ0LnBhdGggPSBpLmFiUmVsYXRpb24ucGF0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5uZXdSYW5nZS5lbmQgPSBuLmVuZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaS5hYlJlbGF0aW9uLnNpZGUgPT0gXCJyaWdodFwiICYmIGUudGFyZ2V0UG9zaXRpb24uaXNFcXVhbCh0Lm5ld1JhbmdlLmVuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5uZXdSYW5nZS5zdGFydCA9IG4uc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQubmV3UmFuZ2UuZW5kLnBhdGggPSBpLmFiUmVsYXRpb24ucGF0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQubmV3UmFuZ2UgPSAkaC5fY3JlYXRlRnJvbVJhbmdlcyh0Lm5ld1JhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8oZW0sIHJtLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodC5vbGRSYW5nZSkge1xyXG4gICAgICAgICAgICAgICAgdC5vbGRSYW5nZSA9IHQub2xkUmFuZ2UuX2dldFRyYW5zZm9ybWVkQnlTcGxpdE9wZXJhdGlvbihlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0Lm5ld1JhbmdlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5hYlJlbGF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IHQubmV3UmFuZ2UuX2dldFRyYW5zZm9ybWVkQnlTcGxpdE9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodC5uZXdSYW5nZS5zdGFydC5pc0VxdWFsKGUuc3BsaXRQb3NpdGlvbikgJiYgaS5hYlJlbGF0aW9uLndhc1N0YXJ0QmVmb3JlTWVyZ2VkRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm5ld1JhbmdlLnN0YXJ0ID0gVWguX2NyZWF0ZUF0KGUuaW5zZXJ0aW9uUG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm5ld1JhbmdlLnN0YXJ0LmlzRXF1YWwoZS5zcGxpdFBvc2l0aW9uKSAmJiAhaS5hYlJlbGF0aW9uLndhc0luTGVmdEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5uZXdSYW5nZS5zdGFydCA9IFVoLl9jcmVhdGVBdChlLm1vdmVUYXJnZXRQb3NpdGlvbilcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQubmV3UmFuZ2UuZW5kLmlzRXF1YWwoZS5zcGxpdFBvc2l0aW9uKSAmJiBpLmFiUmVsYXRpb24ud2FzSW5SaWdodEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5uZXdSYW5nZS5lbmQgPSBVaC5fY3JlYXRlQXQoZS5tb3ZlVGFyZ2V0UG9zaXRpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm5ld1JhbmdlLmVuZC5pc0VxdWFsKGUuc3BsaXRQb3NpdGlvbikgJiYgaS5hYlJlbGF0aW9uLndhc0VuZEJlZm9yZU1lcmdlZEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5uZXdSYW5nZS5lbmQgPSBVaC5fY3JlYXRlQXQoZS5pbnNlcnRpb25Qb3NpdGlvbilcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0Lm5ld1JhbmdlLmVuZCA9IG4uZW5kXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQubmV3UmFuZ2UgPSB0Lm5ld1JhbmdlLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8ob20sIHRtLCAodCwgZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodC5zb3VyY2VQb3NpdGlvbi5oYXNTYW1lUGFyZW50QXMoZS5wb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIHQuaG93TWFueSArPSBlLmhvd01hbnlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnNvdXJjZVBvc2l0aW9uID0gdC5zb3VyY2VQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydE9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgdC50YXJnZXRQb3NpdGlvbiA9IHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhvbSwgb20sICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0LnNvdXJjZVBvc2l0aW9uLmlzRXF1YWwoZS5zb3VyY2VQb3NpdGlvbikgJiYgdC50YXJnZXRQb3NpdGlvbi5pc0VxdWFsKGUudGFyZ2V0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWkuYldhc1VuZG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IFNtKDApXVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5ncmF2ZXlhcmRQb3NpdGlvbi5wYXRoLnNsaWNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5wdXNoKDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHQuc291cmNlUG9zaXRpb24gPSBuZXcgVWgoZS5ncmF2ZXlhcmRQb3NpdGlvbi5yb290LCBpKTtcclxuICAgICAgICAgICAgICAgICAgICB0Lmhvd01hbnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zb3VyY2VQb3NpdGlvbi5pc0VxdWFsKGUuc291cmNlUG9zaXRpb24pICYmICF0LnRhcmdldFBvc2l0aW9uLmlzRXF1YWwoZS50YXJnZXRQb3NpdGlvbikgJiYgIWkuYldhc1VuZG9uZSAmJiBpLmFiUmVsYXRpb24gIT0gXCJzcGxpdEF0U291cmNlXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRhcmdldFBvc2l0aW9uLnJvb3Qucm9vdE5hbWUgPT0gXCIkZ3JhdmV5YXJkXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gZS50YXJnZXRQb3NpdGlvbi5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4gJiYgIW87XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbyAmJiAhbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzIHx8ICFyICYmIGkuYUlzU3Ryb25nO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZS50YXJnZXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRhcmdldFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5TWVyZ2VPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgWmcoaSwgdC5ob3dNYW55LCBuLCAwKV1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgU20oMCldXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQuc291cmNlUG9zaXRpb24uaGFzU2FtZVBhcmVudEFzKGUudGFyZ2V0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICB0Lmhvd01hbnkgKz0gZS5ob3dNYW55XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5zb3VyY2VQb3NpdGlvbiA9IHQuc291cmNlUG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgdC50YXJnZXRQb3NpdGlvbiA9IHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgaWYgKCF0LmdyYXZleWFyZFBvc2l0aW9uLmlzRXF1YWwoZS5ncmF2ZXlhcmRQb3NpdGlvbikgfHwgIWkuYUlzU3Ryb25nKSB7XHJcbiAgICAgICAgICAgICAgICB0LmdyYXZleWFyZFBvc2l0aW9uID0gdC5ncmF2ZXlhcmRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKG9tLCBaZywgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbiA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdChlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpO1xyXG4gICAgICAgICAgICBpZiAoZS50eXBlID09IFwicmVtb3ZlXCIgJiYgIWkuYldhc1VuZG9uZSAmJiAhaS5mb3JjZVdlYWtSZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LmRlbGV0aW9uUG9zaXRpb24uaGFzU2FtZVBhcmVudEFzKGUuc291cmNlUG9zaXRpb24pICYmIG4uY29udGFpbnNQb3NpdGlvbih0LnNvdXJjZVBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IFNtKDApXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnNvdXJjZVBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyhlLnRhcmdldFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5ob3dNYW55ICs9IGUuaG93TWFueVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnNvdXJjZVBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyhlLnNvdXJjZVBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5ob3dNYW55IC09IGUuaG93TWFueVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQuc291cmNlUG9zaXRpb24gPSB0LnNvdXJjZVBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgdC50YXJnZXRQb3NpdGlvbiA9IHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNb3ZlT3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICBpZiAoIXQuZ3JhdmV5YXJkUG9zaXRpb24uaXNFcXVhbChlLnRhcmdldFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5ncmF2ZXlhcmRQb3NpdGlvbiA9IHQuZ3JhdmV5YXJkUG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNb3ZlT3BlcmF0aW9uKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKG9tLCBybSwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKGUuZ3JhdmV5YXJkUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHQuZ3JhdmV5YXJkUG9zaXRpb24gPSB0LmdyYXZleWFyZFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5RGVsZXRpb24oZS5ncmF2ZXlhcmRQb3NpdGlvbiwgMSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5kZWxldGlvblBvc2l0aW9uLmlzRXF1YWwoZS5ncmF2ZXlhcmRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lmhvd01hbnkgPSBlLmhvd01hbnlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC50YXJnZXRQb3NpdGlvbi5pc0VxdWFsKGUuc3BsaXRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmhvd01hbnkgIT0gMDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLmdyYXZleWFyZFBvc2l0aW9uICYmIHQuZGVsZXRpb25Qb3NpdGlvbi5pc0VxdWFsKGUuZ3JhdmV5YXJkUG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG4gfHwgbyB8fCBpLmFiUmVsYXRpb24gPT0gXCJtZXJnZVRhcmdldE5vdE1vdmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnNvdXJjZVBvc2l0aW9uID0gdC5zb3VyY2VQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zb3VyY2VQb3NpdGlvbi5pc0VxdWFsKGUuc3BsaXRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpLmFiUmVsYXRpb24gPT0gXCJtZXJnZVNvdXJjZU5vdE1vdmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lmhvd01hbnkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHQudGFyZ2V0UG9zaXRpb24gPSB0LnRhcmdldFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGkuYWJSZWxhdGlvbiA9PSBcIm1lcmdlU2FtZUVsZW1lbnRcIiB8fCB0LnNvdXJjZVBvc2l0aW9uLm9mZnNldCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnNvdXJjZVBvc2l0aW9uID0gZS5tb3ZlVGFyZ2V0UG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB0LnRhcmdldFBvc2l0aW9uID0gdC50YXJnZXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zb3VyY2VQb3NpdGlvbi5oYXNTYW1lUGFyZW50QXMoZS5zcGxpdFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5ob3dNYW55ID0gZS5zcGxpdFBvc2l0aW9uLm9mZnNldFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQuc291cmNlUG9zaXRpb24gPSB0LnNvdXJjZVBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHQudGFyZ2V0UG9zaXRpb24gPSB0LnRhcmdldFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhaZywgdG0sICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSAkaC5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQodC5zb3VyY2VQb3NpdGlvbiwgdC5ob3dNYW55KTtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGkuX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRPcGVyYXRpb24oZSwgZmFsc2UpWzBdO1xyXG4gICAgICAgICAgICB0LnNvdXJjZVBvc2l0aW9uID0gbi5zdGFydDtcclxuICAgICAgICAgICAgdC5ob3dNYW55ID0gbi5lbmQub2Zmc2V0IC0gbi5zdGFydC5vZmZzZXQ7XHJcbiAgICAgICAgICAgIGlmICghdC50YXJnZXRQb3NpdGlvbi5pc0VxdWFsKGUucG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICB0LnRhcmdldFBvc2l0aW9uID0gdC50YXJnZXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydE9wZXJhdGlvbihlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhaZywgWmcsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSAkaC5fY3JlYXRlRnJvbVBvc2l0aW9uQW5kU2hpZnQodC5zb3VyY2VQb3NpdGlvbiwgdC5ob3dNYW55KTtcclxuICAgICAgICAgICAgY29uc3QgbyA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdChlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpO1xyXG4gICAgICAgICAgICBsZXQgciA9IGkuYUlzU3Ryb25nO1xyXG4gICAgICAgICAgICBsZXQgcyA9ICFpLmFJc1N0cm9uZztcclxuICAgICAgICAgICAgaWYgKGkuYWJSZWxhdGlvbiA9PSBcImluc2VydEJlZm9yZVwiIHx8IGkuYmFSZWxhdGlvbiA9PSBcImluc2VydEFmdGVyXCIpIHtcclxuICAgICAgICAgICAgICAgIHMgPSB0cnVlXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaS5hYlJlbGF0aW9uID09IFwiaW5zZXJ0QWZ0ZXJcIiB8fCBpLmJhUmVsYXRpb24gPT0gXCJpbnNlcnRCZWZvcmVcIikge1xyXG4gICAgICAgICAgICAgICAgcyA9IGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IGE7XHJcbiAgICAgICAgICAgIGlmICh0LnRhcmdldFBvc2l0aW9uLmlzRXF1YWwoZS50YXJnZXRQb3NpdGlvbikgJiYgcykge1xyXG4gICAgICAgICAgICAgICAgYSA9IHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbihlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBhID0gdC50YXJnZXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeU1vdmUoZS5zb3VyY2VQb3NpdGlvbiwgZS50YXJnZXRQb3NpdGlvbiwgZS5ob3dNYW55KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjSSh0LCBlKSAmJiBjSShlLCB0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtlLmdldFJldmVyc2VkKCldXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgYyA9IG4uY29udGFpbnNQb3NpdGlvbihlLnRhcmdldFBvc2l0aW9uKTtcclxuICAgICAgICAgICAgaWYgKGMgJiYgbi5jb250YWluc1JhbmdlKG8sIHRydWUpKSB7XHJcbiAgICAgICAgICAgICAgICBuLnN0YXJ0ID0gbi5zdGFydC5fZ2V0VHJhbnNmb3JtZWRCeU1vdmUoZS5zb3VyY2VQb3NpdGlvbiwgZS50YXJnZXRQb3NpdGlvbiwgZS5ob3dNYW55KTtcclxuICAgICAgICAgICAgICAgIG4uZW5kID0gbi5lbmQuX2dldFRyYW5zZm9ybWVkQnlNb3ZlKGUuc291cmNlUG9zaXRpb24sIGUudGFyZ2V0UG9zaXRpb24sIGUuaG93TWFueSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbEkoW25dLCBhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGwgPSBvLmNvbnRhaW5zUG9zaXRpb24odC50YXJnZXRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgIGlmIChsICYmIG8uY29udGFpbnNSYW5nZShuLCB0cnVlKSkge1xyXG4gICAgICAgICAgICAgICAgbi5zdGFydCA9IG4uc3RhcnQuX2dldENvbWJpbmVkKGUuc291cmNlUG9zaXRpb24sIGUuZ2V0TW92ZWRSYW5nZVN0YXJ0KCkpO1xyXG4gICAgICAgICAgICAgICAgbi5lbmQgPSBuLmVuZC5fZ2V0Q29tYmluZWQoZS5zb3VyY2VQb3NpdGlvbiwgZS5nZXRNb3ZlZFJhbmdlU3RhcnQoKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbEkoW25dLCBhKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGQgPSBWcyh0LnNvdXJjZVBvc2l0aW9uLmdldFBhcmVudFBhdGgoKSwgZS5zb3VyY2VQb3NpdGlvbi5nZXRQYXJlbnRQYXRoKCkpO1xyXG4gICAgICAgICAgICBpZiAoZCA9PSBcInByZWZpeFwiIHx8IGQgPT0gXCJleHRlbnNpb25cIikge1xyXG4gICAgICAgICAgICAgICAgbi5zdGFydCA9IG4uc3RhcnQuX2dldFRyYW5zZm9ybWVkQnlNb3ZlKGUuc291cmNlUG9zaXRpb24sIGUudGFyZ2V0UG9zaXRpb24sIGUuaG93TWFueSk7XHJcbiAgICAgICAgICAgICAgICBuLmVuZCA9IG4uZW5kLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZShlLnNvdXJjZVBvc2l0aW9uLCBlLnRhcmdldFBvc2l0aW9uLCBlLmhvd01hbnkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxJKFtuXSwgYSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC50eXBlID09IFwicmVtb3ZlXCIgJiYgZS50eXBlICE9IFwicmVtb3ZlXCIgJiYgIWkuYVdhc1VuZG9uZSAmJiAhaS5mb3JjZVdlYWtSZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIHIgPSB0cnVlXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodC50eXBlICE9IFwicmVtb3ZlXCIgJiYgZS50eXBlID09IFwicmVtb3ZlXCIgJiYgIWkuYldhc1VuZG9uZSAmJiAhaS5mb3JjZVdlYWtSZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgIHIgPSBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHUgPSBbXTtcclxuICAgICAgICAgICAgY29uc3QgaCA9IG4uZ2V0RGlmZmVyZW5jZShvKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGgpIHtcclxuICAgICAgICAgICAgICAgIHQuc3RhcnQgPSB0LnN0YXJ0Ll9nZXRUcmFuc2Zvcm1lZEJ5RGVsZXRpb24oZS5zb3VyY2VQb3NpdGlvbiwgZS5ob3dNYW55KTtcclxuICAgICAgICAgICAgICAgIHQuZW5kID0gdC5lbmQuX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbihlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFZzKHQuc3RhcnQuZ2V0UGFyZW50UGF0aCgpLCBlLmdldE1vdmVkUmFuZ2VTdGFydCgpLmdldFBhcmVudFBhdGgoKSkgPT0gXCJzYW1lXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydGlvbihlLmdldE1vdmVkUmFuZ2VTdGFydCgpLCBlLmhvd01hbnksIGkpO1xyXG4gICAgICAgICAgICAgICAgdS5wdXNoKC4uLm4pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgZiA9IG4uZ2V0SW50ZXJzZWN0aW9uKG8pO1xyXG4gICAgICAgICAgICBpZiAoZiAhPT0gbnVsbCAmJiByKSB7XHJcbiAgICAgICAgICAgICAgICBmLnN0YXJ0ID0gZi5zdGFydC5fZ2V0Q29tYmluZWQoZS5zb3VyY2VQb3NpdGlvbiwgZS5nZXRNb3ZlZFJhbmdlU3RhcnQoKSk7XHJcbiAgICAgICAgICAgICAgICBmLmVuZCA9IGYuZW5kLl9nZXRDb21iaW5lZChlLnNvdXJjZVBvc2l0aW9uLCBlLmdldE1vdmVkUmFuZ2VTdGFydCgpKTtcclxuICAgICAgICAgICAgICAgIGlmICh1Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHUucHVzaChmKVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1Lmxlbmd0aCA9PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8uc3RhcnQuaXNCZWZvcmUobi5zdGFydCkgfHwgby5zdGFydC5pc0VxdWFsKG4uc3RhcnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHUudW5zaGlmdChmKVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHUucHVzaChmKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdS5zcGxpY2UoMSwgMCwgZilcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IFNtKHQuYmFzZVZlcnNpb24pXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBsSSh1LCBhKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKFpnLCBybSwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgbGV0IG4gPSB0LnRhcmdldFBvc2l0aW9uLmNsb25lKCk7XHJcbiAgICAgICAgICAgIGlmICghdC50YXJnZXRQb3NpdGlvbi5pc0VxdWFsKGUuaW5zZXJ0aW9uUG9zaXRpb24pIHx8ICFlLmdyYXZleWFyZFBvc2l0aW9uIHx8IGkuYWJSZWxhdGlvbiA9PSBcIm1vdmVUYXJnZXRBZnRlclwiKSB7XHJcbiAgICAgICAgICAgICAgICBuID0gdC50YXJnZXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKGUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbyA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdCh0LnNvdXJjZVBvc2l0aW9uLCB0Lmhvd01hbnkpO1xyXG4gICAgICAgICAgICBpZiAoby5lbmQuaXNFcXVhbChlLmluc2VydGlvblBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlLmdyYXZleWFyZFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5ob3dNYW55KytcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQudGFyZ2V0UG9zaXRpb24gPSBuO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChvLnN0YXJ0Lmhhc1NhbWVQYXJlbnRBcyhlLnNwbGl0UG9zaXRpb24pICYmIG8uY29udGFpbnNQb3NpdGlvbihlLnNwbGl0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdCA9IG5ldyAkaChlLnNwbGl0UG9zaXRpb24sIG8uZW5kKTtcclxuICAgICAgICAgICAgICAgIHQgPSB0Ll9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gW25ldyAkaChvLnN0YXJ0LCBlLnNwbGl0UG9zaXRpb24pLCB0XTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBsSShpLCBuKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnRhcmdldFBvc2l0aW9uLmlzRXF1YWwoZS5zcGxpdFBvc2l0aW9uKSAmJiBpLmFiUmVsYXRpb24gPT0gXCJpbnNlcnRBdFNvdXJjZVwiKSB7XHJcbiAgICAgICAgICAgICAgICBuID0gZS5tb3ZlVGFyZ2V0UG9zaXRpb25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC50YXJnZXRQb3NpdGlvbi5pc0VxdWFsKGUuaW5zZXJ0aW9uUG9zaXRpb24pICYmIGkuYWJSZWxhdGlvbiA9PSBcImluc2VydEJldHdlZW5cIikge1xyXG4gICAgICAgICAgICAgICAgbiA9IHQudGFyZ2V0UG9zaXRpb25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCByID0gby5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICBjb25zdCBzID0gW3JdO1xyXG4gICAgICAgICAgICBpZiAoZS5ncmF2ZXlhcmRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG8uc3RhcnQuaXNFcXVhbChlLmdyYXZleWFyZFBvc2l0aW9uKSB8fCBvLmNvbnRhaW5zUG9zaXRpb24oZS5ncmF2ZXlhcmRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5ob3dNYW55ID4gMSAmJiBuICYmICFpLmFXYXNVbmRvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLnB1c2goJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KGUuaW5zZXJ0aW9uUG9zaXRpb24sIDEpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBsSShzLCBuKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKFpnLCBvbSwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbiA9ICRoLl9jcmVhdGVGcm9tUG9zaXRpb25BbmRTaGlmdCh0LnNvdXJjZVBvc2l0aW9uLCB0Lmhvd01hbnkpO1xyXG4gICAgICAgICAgICBpZiAoZS5kZWxldGlvblBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyh0LnNvdXJjZVBvc2l0aW9uKSAmJiBuLmNvbnRhaW5zUG9zaXRpb24oZS5zb3VyY2VQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LnR5cGUgPT0gXCJyZW1vdmVcIiAmJiAhaS5mb3JjZVdlYWtSZW1vdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuYVdhc1VuZG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuID0gZS5ncmF2ZXlhcmRQb3NpdGlvbi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IGUudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuaG93TWFueSA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChuZXcgWmcodC5zb3VyY2VQb3NpdGlvbiwgdC5ob3dNYW55IC0gMSwgdC50YXJnZXRQb3NpdGlvbiwgMCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IG4uX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQuc291cmNlUG9zaXRpb24sIHQudGFyZ2V0UG9zaXRpb24sIHQuaG93TWFueSAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG8uX2dldFRyYW5zZm9ybWVkQnlNb3ZlKHQuc291cmNlUG9zaXRpb24sIHQudGFyZ2V0UG9zaXRpb24sIHQuaG93TWFueSAtIDEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IGUuZGVsZXRpb25Qb3NpdGlvbi5fZ2V0Q29tYmluZWQodC5zb3VyY2VQb3NpdGlvbiwgdC50YXJnZXRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgWmcobiwgMSwgciwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzLmdldE1vdmVkUmFuZ2VTdGFydCgpLnBhdGguc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5wdXNoKDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gbmV3IFVoKHMudGFyZ2V0UG9zaXRpb24ucm9vdCwgYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBvLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZShuLCByLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbCA9IG5ldyBaZyhvLCBlLmhvd01hbnksIGMsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gocyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkucHVzaChsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lmhvd01hbnkgPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWkuYldhc1VuZG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgU20oMCldXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnNvdXJjZVBvc2l0aW9uID0gZS5ncmF2ZXlhcmRQb3NpdGlvbi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC50YXJnZXRQb3NpdGlvbiA9IHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBvID0gJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KHQuc291cmNlUG9zaXRpb24sIHQuaG93TWFueSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBvLl9nZXRUcmFuc2Zvcm1lZEJ5TWVyZ2VPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHQuc291cmNlUG9zaXRpb24gPSByLnN0YXJ0O1xyXG4gICAgICAgICAgICB0Lmhvd01hbnkgPSByLmVuZC5vZmZzZXQgLSByLnN0YXJ0Lm9mZnNldDtcclxuICAgICAgICAgICAgdC50YXJnZXRQb3NpdGlvbiA9IHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKGltLCB0bSwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgdC5wb3NpdGlvbiA9IHQucG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlJbnNlcnRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhpbSwgb20sICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0LnBvc2l0aW9uLmlzRXF1YWwoZS5kZWxldGlvblBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5wb3NpdGlvbiA9IGUuZ3JhdmV5YXJkUG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHQucG9zaXRpb24uc3RpY2tpbmVzcyA9IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5wb3NpdGlvbiA9IHQucG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKGltLCBaZywgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgdC5wb3NpdGlvbiA9IHQucG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNb3ZlT3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8oaW0sIGltLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodC5wb3NpdGlvbi5pc0VxdWFsKGUucG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaS5hSXNTdHJvbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9sZE5hbWUgPSBlLm5ld05hbWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgU20oMCldXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKGltLCBybSwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQucG9zaXRpb24ucGF0aDtcclxuICAgICAgICAgICAgY29uc3QgbiA9IGUuc3BsaXRQb3NpdGlvbi5nZXRQYXJlbnRQYXRoKCk7XHJcbiAgICAgICAgICAgIGlmIChWcyhpLCBuKSA9PSBcInNhbWVcIiAmJiAhZS5ncmF2ZXlhcmRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBpbSh0LnBvc2l0aW9uLmdldFNoaWZ0ZWRCeSgxKSwgdC5vbGROYW1lLCB0Lm5ld05hbWUsIDApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0LCBlXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQucG9zaXRpb24gPSB0LnBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhubSwgbm0sICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0LnJvb3QgPT09IGUucm9vdCAmJiB0LmtleSA9PT0gZS5rZXkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghaS5hSXNTdHJvbmcgfHwgdC5uZXdWYWx1ZSA9PT0gZS5uZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IFNtKDApXVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9sZFZhbHVlID0gZS5uZXdWYWx1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhybSwgdG0sICh0LCBlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0LnNwbGl0UG9zaXRpb24uaGFzU2FtZVBhcmVudEFzKGUucG9zaXRpb24pICYmIHQuc3BsaXRQb3NpdGlvbi5vZmZzZXQgPCBlLnBvc2l0aW9uLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgdC5ob3dNYW55ICs9IGUuaG93TWFueVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQuc3BsaXRQb3NpdGlvbiA9IHQuc3BsaXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeUluc2VydE9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgdC5pbnNlcnRpb25Qb3NpdGlvbiA9IHJtLmdldEluc2VydGlvblBvc2l0aW9uKHQuc3BsaXRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICB9KTtcclxuICAgICAgICBYTyhybSwgb20sICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdC5ncmF2ZXlhcmRQb3NpdGlvbiAmJiAhaS5iV2FzVW5kb25lICYmIHQuc3BsaXRQb3NpdGlvbi5oYXNTYW1lUGFyZW50QXMoZS5zb3VyY2VQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBlLmdyYXZleWFyZFBvc2l0aW9uLnBhdGguc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgIGkucHVzaCgwKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgVWgoZS5ncmF2ZXlhcmRQb3NpdGlvbi5yb290LCBpKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBybS5nZXRJbnNlcnRpb25Qb3NpdGlvbihuZXcgVWgoZS5ncmF2ZXlhcmRQb3NpdGlvbi5yb290LCBpKSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IHJtKG4sIDAsIG51bGwsIDApO1xyXG4gICAgICAgICAgICAgICAgci5pbnNlcnRpb25Qb3NpdGlvbiA9IG87XHJcbiAgICAgICAgICAgICAgICB0LnNwbGl0UG9zaXRpb24gPSB0LnNwbGl0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNZXJnZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgIHQuaW5zZXJ0aW9uUG9zaXRpb24gPSBybS5nZXRJbnNlcnRpb25Qb3NpdGlvbih0LnNwbGl0UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgdC5ncmF2ZXlhcmRQb3NpdGlvbiA9IHIuaW5zZXJ0aW9uUG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHQuZ3JhdmV5YXJkUG9zaXRpb24uc3RpY2tpbmVzcyA9IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3IsIHRdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHQuc3BsaXRQb3NpdGlvbi5oYXNTYW1lUGFyZW50QXMoZS5kZWxldGlvblBvc2l0aW9uKSAmJiAhdC5zcGxpdFBvc2l0aW9uLmlzQWZ0ZXIoZS5kZWxldGlvblBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5ob3dNYW55LS1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zcGxpdFBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyhlLnRhcmdldFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgdC5ob3dNYW55ICs9IGUuaG93TWFueVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQuc3BsaXRQb3NpdGlvbiA9IHQuc3BsaXRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeU1lcmdlT3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICB0Lmluc2VydGlvblBvc2l0aW9uID0gcm0uZ2V0SW5zZXJ0aW9uUG9zaXRpb24odC5zcGxpdFBvc2l0aW9uKTtcclxuICAgICAgICAgICAgaWYgKHQuZ3JhdmV5YXJkUG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHQuZ3JhdmV5YXJkUG9zaXRpb24gPSB0LmdyYXZleWFyZFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5TWVyZ2VPcGVyYXRpb24oZSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgWE8ocm0sIFpnLCAodCwgZSwgaSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBuID0gJGguX2NyZWF0ZUZyb21Qb3NpdGlvbkFuZFNoaWZ0KGUuc291cmNlUG9zaXRpb24sIGUuaG93TWFueSk7XHJcbiAgICAgICAgICAgIGlmICh0LmdyYXZleWFyZFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5zdGFydC5pc0VxdWFsKHQuZ3JhdmV5YXJkUG9zaXRpb24pIHx8IG4uY29udGFpbnNQb3NpdGlvbih0LmdyYXZleWFyZFBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGlmICghaS5iV2FzVW5kb25lICYmIG8pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gdC5zcGxpdFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gdC5ncmF2ZXlhcmRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeU1vdmVPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IG4ucGF0aC5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG8ucHVzaCgwKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IFVoKG4ucm9vdCwgbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBaZyhpLCB0Lmhvd01hbnksIHIsIDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbc11cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQuZ3JhdmV5YXJkUG9zaXRpb24gPSB0LmdyYXZleWFyZFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZU9wZXJhdGlvbihlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnNwbGl0UG9zaXRpb24uaGFzU2FtZVBhcmVudEFzKGUuc291cmNlUG9zaXRpb24pICYmIG4uY29udGFpbnNQb3NpdGlvbih0LnNwbGl0UG9zaXRpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gZS5ob3dNYW55IC0gKHQuc3BsaXRQb3NpdGlvbi5vZmZzZXQgLSBlLnNvdXJjZVBvc2l0aW9uLm9mZnNldCk7XHJcbiAgICAgICAgICAgICAgICB0Lmhvd01hbnkgLT0gaTtcclxuICAgICAgICAgICAgICAgIGlmICh0LnNwbGl0UG9zaXRpb24uaGFzU2FtZVBhcmVudEFzKGUudGFyZ2V0UG9zaXRpb24pICYmIHQuc3BsaXRQb3NpdGlvbi5vZmZzZXQgPCBlLnRhcmdldFBvc2l0aW9uLm9mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuaG93TWFueSArPSBlLmhvd01hbnlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHQuc3BsaXRQb3NpdGlvbiA9IGUuc291cmNlUG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICAgICAgICAgIHQuaW5zZXJ0aW9uUG9zaXRpb24gPSBybS5nZXRJbnNlcnRpb25Qb3NpdGlvbih0LnNwbGl0UG9zaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0LnNwbGl0UG9zaXRpb24uaXNFcXVhbChlLnRhcmdldFBvc2l0aW9uKTtcclxuICAgICAgICAgICAgaWYgKG8gJiYgKGkuYmFSZWxhdGlvbiA9PSBcImluc2VydEF0U291cmNlXCIgfHwgaS5hYlJlbGF0aW9uID09IFwic3BsaXRCZWZvcmVcIikpIHtcclxuICAgICAgICAgICAgICAgIHQuaG93TWFueSArPSBlLmhvd01hbnk7XHJcbiAgICAgICAgICAgICAgICB0LnNwbGl0UG9zaXRpb24gPSB0LnNwbGl0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbihlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpO1xyXG4gICAgICAgICAgICAgICAgdC5pbnNlcnRpb25Qb3NpdGlvbiA9IHJtLmdldEluc2VydGlvblBvc2l0aW9uKHQuc3BsaXRQb3NpdGlvbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFlLnNvdXJjZVBvc2l0aW9uLmlzRXF1YWwoZS50YXJnZXRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0LnNwbGl0UG9zaXRpb24uaGFzU2FtZVBhcmVudEFzKGUuc291cmNlUG9zaXRpb24pICYmIHQuc3BsaXRQb3NpdGlvbi5vZmZzZXQgPD0gZS5zb3VyY2VQb3NpdGlvbi5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lmhvd01hbnkgLT0gZS5ob3dNYW55XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodC5zcGxpdFBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyhlLnRhcmdldFBvc2l0aW9uKSAmJiB0LnNwbGl0UG9zaXRpb24ub2Zmc2V0IDwgZS50YXJnZXRQb3NpdGlvbi5vZmZzZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lmhvd01hbnkgKz0gZS5ob3dNYW55XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5zcGxpdFBvc2l0aW9uLnN0aWNraW5lc3MgPSBcInRvTm9uZVwiO1xyXG4gICAgICAgICAgICB0LnNwbGl0UG9zaXRpb24gPSB0LnNwbGl0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlNb3ZlT3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICB0LnNwbGl0UG9zaXRpb24uc3RpY2tpbmVzcyA9IFwidG9OZXh0XCI7XHJcbiAgICAgICAgICAgIGlmICh0LmdyYXZleWFyZFBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0Lmluc2VydGlvblBvc2l0aW9uID0gdC5pbnNlcnRpb25Qb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeU1vdmVPcGVyYXRpb24oZSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHQuaW5zZXJ0aW9uUG9zaXRpb24gPSBybS5nZXRJbnNlcnRpb25Qb3NpdGlvbih0LnNwbGl0UG9zaXRpb24pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFt0XVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFhPKHJtLCBybSwgKHQsIGUsIGkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHQuc3BsaXRQb3NpdGlvbi5pc0VxdWFsKGUuc3BsaXRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdC5ncmF2ZXlhcmRQb3NpdGlvbiAmJiAhZS5ncmF2ZXlhcmRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IFNtKDApXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHQuZ3JhdmV5YXJkUG9zaXRpb24gJiYgZS5ncmF2ZXlhcmRQb3NpdGlvbiAmJiB0LmdyYXZleWFyZFBvc2l0aW9uLmlzRXF1YWwoZS5ncmF2ZXlhcmRQb3NpdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBTbSgwKV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChpLmFiUmVsYXRpb24gPT0gXCJzcGxpdEJlZm9yZVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5ob3dNYW55ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0LmdyYXZleWFyZFBvc2l0aW9uID0gdC5ncmF2ZXlhcmRQb3NpdGlvbi5fZ2V0VHJhbnNmb3JtZWRCeVNwbGl0T3BlcmF0aW9uKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5ncmF2ZXlhcmRQb3NpdGlvbiAmJiBlLmdyYXZleWFyZFBvc2l0aW9uICYmIHQuZ3JhdmV5YXJkUG9zaXRpb24uaXNFcXVhbChlLmdyYXZleWFyZFBvc2l0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQuc3BsaXRQb3NpdGlvbi5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IGUuc3BsaXRQb3NpdGlvbi5yb290LnJvb3ROYW1lID09IFwiJGdyYXZleWFyZFwiO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG4gJiYgIW87XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbyAmJiAhbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzIHx8ICFyICYmIGkuYUlzU3Ryb25nO1xyXG4gICAgICAgICAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaG93TWFueSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnB1c2gobmV3IFpnKGUubW92ZVRhcmdldFBvc2l0aW9uLCBlLmhvd01hbnksIGUuc3BsaXRQb3NpdGlvbiwgMCkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0Lmhvd01hbnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5wdXNoKG5ldyBaZyh0LnNwbGl0UG9zaXRpb24sIHQuaG93TWFueSwgdC5tb3ZlVGFyZ2V0UG9zaXRpb24sIDApKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW25ldyBTbSgwKV1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5ncmF2ZXlhcmRQb3NpdGlvbikge1xyXG4gICAgICAgICAgICAgICAgdC5ncmF2ZXlhcmRQb3NpdGlvbiA9IHQuZ3JhdmV5YXJkUG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlTcGxpdE9wZXJhdGlvbihlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0LnNwbGl0UG9zaXRpb24uaXNFcXVhbChlLmluc2VydGlvblBvc2l0aW9uKSAmJiBpLmFiUmVsYXRpb24gPT0gXCJzcGxpdEJlZm9yZVwiKSB7XHJcbiAgICAgICAgICAgICAgICB0Lmhvd01hbnkrKztcclxuICAgICAgICAgICAgICAgIHJldHVybiBbdF1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZS5zcGxpdFBvc2l0aW9uLmlzRXF1YWwodC5pbnNlcnRpb25Qb3NpdGlvbikgJiYgaS5iYVJlbGF0aW9uID09IFwic3BsaXRCZWZvcmVcIikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuaW5zZXJ0aW9uUG9zaXRpb24ucGF0aC5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKDApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IG5ldyBVaChlLmluc2VydGlvblBvc2l0aW9uLnJvb3QsIGkpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IG5ldyBaZyh0Lmluc2VydGlvblBvc2l0aW9uLCAxLCBuLCAwKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbdCwgb11cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodC5zcGxpdFBvc2l0aW9uLmhhc1NhbWVQYXJlbnRBcyhlLnNwbGl0UG9zaXRpb24pICYmIHQuc3BsaXRQb3NpdGlvbi5vZmZzZXQgPCBlLnNwbGl0UG9zaXRpb24ub2Zmc2V0KSB7XHJcbiAgICAgICAgICAgICAgICB0Lmhvd01hbnkgLT0gZS5ob3dNYW55XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5zcGxpdFBvc2l0aW9uID0gdC5zcGxpdFBvc2l0aW9uLl9nZXRUcmFuc2Zvcm1lZEJ5U3BsaXRPcGVyYXRpb24oZSk7XHJcbiAgICAgICAgICAgIHQuaW5zZXJ0aW9uUG9zaXRpb24gPSBybS5nZXRJbnNlcnRpb25Qb3NpdGlvbih0LnNwbGl0UG9zaXRpb24pO1xyXG4gICAgICAgICAgICByZXR1cm4gW3RdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNJKHQsIGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHQudGFyZ2V0UG9zaXRpb24uX2dldFRyYW5zZm9ybWVkQnlEZWxldGlvbihlLnNvdXJjZVBvc2l0aW9uLCBlLmhvd01hbnkpID09PSBudWxsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsSSh0LCBlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGkgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lmxlbmd0aDsgbisrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdFtuXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgWmcoby5zdGFydCwgby5lbmQub2Zmc2V0IC0gby5zdGFydC5vZmZzZXQsIGUsIDApO1xyXG4gICAgICAgICAgICAgICAgaS5wdXNoKHIpO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IG4gKyAxOyBlIDwgdC5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRbZV0gPSB0W2VdLl9nZXRUcmFuc2Zvcm1lZEJ5TW92ZShyLnNvdXJjZVBvc2l0aW9uLCByLnRhcmdldFBvc2l0aW9uLCByLmhvd01hbnkpWzBdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlID0gZS5fZ2V0VHJhbnNmb3JtZWRCeU1vdmUoci5zb3VyY2VQb3NpdGlvbiwgci50YXJnZXRQb3NpdGlvbiwgci5ob3dNYW55KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBkSSBleHRlbmRzIGp3IHtcclxuICAgICAgICAgICAgY29uc3RydWN0b3IodCkge1xyXG4gICAgICAgICAgICAgICAgc3VwZXIodCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFjayA9IFtdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlZEJhdGNoZXMgPSBuZXcgV2Vha1NldDtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzRW5hYmxlZCA9IHRoaXMuX3N0YWNrLmxlbmd0aCA+IDBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWRkQmF0Y2godCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZWRpdG9yLm1vZGVsLmRvY3VtZW50LnNlbGVjdGlvbjtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB7cmFuZ2VzOiBlLmhhc093blJhbmdlID8gQXJyYXkuZnJvbShlLmdldFJhbmdlcygpKSA6IFtdLCBpc0JhY2t3YXJkOiBlLmlzQmFja3dhcmR9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhY2sucHVzaCh7YmF0Y2g6IHQsIHNlbGVjdGlvbjogaX0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY2xlYXJTdGFjaygpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWNrID0gW107XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBfcmVzdG9yZVNlbGVjdGlvbih0LCBlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gdGhpcy5lZGl0b3IubW9kZWw7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gbi5kb2N1bWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHVJKGUsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LmZpbmQodCA9PiB0LnN0YXJ0LnJvb3QgIT0gby5ncmF2ZXlhcmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHIucHVzaChuKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG4uY2hhbmdlKHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnNldFNlbGVjdGlvbihyLCB7YmFja3dhcmQ6IGV9KVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIF91bmRvKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLmVkaXRvci5tb2RlbDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmRvY3VtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3JlYXRlZEJhdGNoZXMuYWRkKGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IHQub3BlcmF0aW9ucy5zbGljZSgpLmZpbHRlcih0ID0+IHQuaXNEb2N1bWVudE9wZXJhdGlvbik7XHJcbiAgICAgICAgICAgICAgICBvLnJldmVyc2UoKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHQuYmFzZVZlcnNpb24gKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBBcnJheS5mcm9tKG4uaGlzdG9yeS5nZXRPcGVyYXRpb25zKG8pKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gaUkoW3QuZ2V0UmV2ZXJzZWQoKV0sIHIsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlUmVsYXRpb25zOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDogdGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZFdpdGhOb09wczogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlV2Vha1JlbW92ZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBzLm9wZXJhdGlvbnNBO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbyBvZiBhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuYWRkT3BlcmF0aW9uKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmFwcGx5T3BlcmF0aW9uKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuLmhpc3Rvcnkuc2V0T3BlcmF0aW9uQXNVbmRvbmUodCwgbylcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHVJKHQsIGUpIHtcclxuICAgICAgICAgICAgY29uc3QgaSA9IHQuZ2V0VHJhbnNmb3JtZWRCeU9wZXJhdGlvbnMoZSk7XHJcbiAgICAgICAgICAgIGkuc29ydCgodCwgZSkgPT4gdC5zdGFydC5pc0JlZm9yZShlLnN0YXJ0KSA/IC0xIDogMSk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAxOyB0IDwgaS5sZW5ndGg7IHQrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGlbdCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGlbdF07XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5lbmQuaXNUb3VjaGluZyhuLnN0YXJ0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuZW5kID0gbi5lbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zcGxpY2UodCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdC0tXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGhJIGV4dGVuZHMgZEkge1xyXG4gICAgICAgICAgICBleGVjdXRlKHQgPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdCA/IHRoaXMuX3N0YWNrLmZpbmRJbmRleChlID0+IGUuYmF0Y2ggPT0gdCkgOiB0aGlzLl9zdGFjay5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuX3N0YWNrLnNwbGljZShlLCAxKVswXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLmVkaXRvci5tb2RlbC5jcmVhdGVCYXRjaChcInRyYW5zcGFyZW50XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lZGl0b3IubW9kZWwuZW5xdWV1ZUNoYW5nZShuLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdW5kbyhpLmJhdGNoLCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuaGlzdG9yeS5nZXRPcGVyYXRpb25zKGkuYmF0Y2guYmFzZVZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3RvcmVTZWxlY3Rpb24oaS5zZWxlY3Rpb24ucmFuZ2VzLCBpLnNlbGVjdGlvbi5pc0JhY2t3YXJkLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpcmUoXCJyZXZlcnRcIiwgaS5iYXRjaCwgbilcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgZkkgZXh0ZW5kcyBkSSB7XHJcbiAgICAgICAgICAgIGV4ZWN1dGUoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5fc3RhY2sucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5lZGl0b3IubW9kZWwuY3JlYXRlQmF0Y2goXCJ0cmFuc3BhcmVudFwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLm1vZGVsLmVucXVldWVDaGFuZ2UoZSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LmJhdGNoLm9wZXJhdGlvbnNbdC5iYXRjaC5vcGVyYXRpb25zLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBpLmJhc2VWZXJzaW9uICsgMTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5lZGl0b3IubW9kZWwuZG9jdW1lbnQuaGlzdG9yeS5nZXRPcGVyYXRpb25zKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3RvcmVTZWxlY3Rpb24odC5zZWxlY3Rpb24ucmFuZ2VzLCB0LnNlbGVjdGlvbi5pc0JhY2t3YXJkLCBvKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91bmRvKHQuYmF0Y2gsIGUpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIGdJIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJVbmRvRWRpdGluZ1wiXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0cnVjdG9yKHQpIHtcclxuICAgICAgICAgICAgICAgIHN1cGVyKHQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYmF0Y2hSZWdpc3RyeSA9IG5ldyBXZWFrU2V0XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl91bmRvQ29tbWFuZCA9IG5ldyBoSSh0KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlZG9Db21tYW5kID0gbmV3IGZJKHQpO1xyXG4gICAgICAgICAgICAgICAgdC5jb21tYW5kcy5hZGQoXCJ1bmRvXCIsIHRoaXMuX3VuZG9Db21tYW5kKTtcclxuICAgICAgICAgICAgICAgIHQuY29tbWFuZHMuYWRkKFwicmVkb1wiLCB0aGlzLl9yZWRvQ29tbWFuZCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlblRvKHQubW9kZWwsIFwiYXBwbHlPcGVyYXRpb25cIiwgKHQsIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpID0gZVswXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWkuaXNEb2N1bWVudE9wZXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGkuYmF0Y2g7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbyA9IHRoaXMuX3JlZG9Db21tYW5kLl9jcmVhdGVkQmF0Y2hlcy5oYXMobik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuX3VuZG9Db21tYW5kLl9jcmVhdGVkQmF0Y2hlcy5oYXMobik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuX2JhdGNoUmVnaXN0cnkuaGFzKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzIHx8IG4udHlwZSA9PSBcInRyYW5zcGFyZW50XCIgJiYgIW8gJiYgIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3VuZG9Db21tYW5kLmFkZEJhdGNoKG4pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3VuZG9Db21tYW5kLmFkZEJhdGNoKG4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVkb0NvbW1hbmQuY2xlYXJTdGFjaygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmF0Y2hSZWdpc3RyeS5hZGQobilcclxuICAgICAgICAgICAgICAgIH0sIHtwcmlvcml0eTogXCJoaWdoZXN0XCJ9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5fdW5kb0NvbW1hbmQsIFwicmV2ZXJ0XCIsICh0LCBlLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVkb0NvbW1hbmQuYWRkQmF0Y2goaSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgdC5rZXlzdHJva2VzLnNldChcIkNUUkwrWlwiLCBcInVuZG9cIik7XHJcbiAgICAgICAgICAgICAgICB0LmtleXN0cm9rZXMuc2V0KFwiQ1RSTCtZXCIsIFwicmVkb1wiKTtcclxuICAgICAgICAgICAgICAgIHQua2V5c3Ryb2tlcy5zZXQoXCJDVFJMK1NISUZUK1pcIiwgXCJyZWRvXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBtSSA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk01LjA0MiA5LjM2N2wyLjE4OSAxLjgzN2EuNzUuNzUgMCAwIDEtLjk2NSAxLjE0OWwtMy43ODgtMy4xOGEuNzQ3Ljc0NyAwIDAgMS0uMjEtLjI4NC43NS43NSAwIDAgMSAuMTctLjk0NUw2LjIzIDQuNzYyYS43NS43NSAwIDEgMSAuOTY0IDEuMTVMNC44NjMgNy44NjZoOC45MTdBLjc1Ljc1IDAgMCAxIDE0IDcuOWE0IDQgMCAxIDEtMS40NzcgNy43MThsLjM0NC0xLjQ4OWEyLjUgMi41IDAgMSAwIDEuMDk0LTQuNzNsLjAwOC0uMDMySDUuMDQyelwiLz48L3N2Zz4nO1xyXG4gICAgICAgIHZhciBwSSA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjAgMjBcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI+PHBhdGggZD1cIk0xNC45NTggOS4zNjdsLTIuMTg5IDEuODM3YS43NS43NSAwIDAgMCAuOTY1IDEuMTQ5bDMuNzg4LTMuMThhLjc0Ny43NDcgMCAwIDAgLjIxLS4yODQuNzUuNzUgMCAwIDAtLjE3LS45NDVMMTMuNzcgNC43NjJhLjc1Ljc1IDAgMSAwLS45NjQgMS4xNWwyLjMzMSAxLjk1NUg2LjIyQS43NS43NSAwIDAgMCA2IDcuOWE0IDQgMCAxIDAgMS40NzcgNy43MThsLS4zNDQtMS40ODlBMi41IDIuNSAwIDEgMSA2LjAzOSA5LjRsLS4wMDgtLjAzMmg4LjkyN3pcIi8+PC9zdmc+JztcclxuXHJcbiAgICAgICAgY2xhc3MgYkkgZXh0ZW5kcyBtcCB7XHJcbiAgICAgICAgICAgIGluaXQoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sb2NhbGU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdC50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGUudWlMYW5ndWFnZURpcmVjdGlvbiA9PSBcImx0clwiID8gbUkgOiBwSTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBlLnVpTGFuZ3VhZ2VEaXJlY3Rpb24gPT0gXCJsdHJcIiA/IHBJIDogbUk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRCdXR0b24oXCJ1bmRvXCIsIGkoXCJtb1wiKSwgXCJDVFJMK1pcIiwgbik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRCdXR0b24oXCJyZWRvXCIsIGkoXCJtcFwiKSwgXCJDVFJMK1lcIiwgbylcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgX2FkZEJ1dHRvbih0LCBlLCBpLCBuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gdGhpcy5lZGl0b3I7XHJcbiAgICAgICAgICAgICAgICBvLnVpLmNvbXBvbmVudEZhY3RvcnkuYWRkKHQsIHIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvLmNvbW1hbmRzLmdldCh0KTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0gbmV3IGhiKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc2V0KHtsYWJlbDogZSwgaWNvbjogbiwga2V5c3Ryb2tlOiBpLCB0b29sdGlwOiB0cnVlfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS5iaW5kKFwiaXNFbmFibGVkXCIpLnRvKHMsIFwiaXNFbmFibGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuVG8oYSwgXCJleGVjdXRlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgby5leGVjdXRlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvLmVkaXRpbmcudmlldy5mb2N1cygpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsYXNzIHdJIGV4dGVuZHMgbXAge1xyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHJlcXVpcmVzKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtnSSwgYkldXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHN0YXRpYyBnZXQgcGx1Z2luTmFtZSgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIlVuZG9cIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGFzcyBrSSBleHRlbmRzIG1wIHtcclxuICAgICAgICAgICAgc3RhdGljIGdldCByZXF1aXJlcygpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbUngsIHFPLCBZTywgY1AsIHdJXVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBzdGF0aWMgZ2V0IHBsdWdpbk5hbWUoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJFc3NlbnRpYWxzXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xhc3MgX0kgZXh0ZW5kcyBGdyB7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBfSS5idWlsdGluUGx1Z2lucyA9IFtyaywgdWssIHZrLCBTaywgcl8sIHBfLCBBXywgUl8sIFdfLCBidiwgY3ksIGZ5LCBSeSwgS3ksIHp4LCBXeCwgdkMsIFBDLCB0VCwgelQsIFdULCB3UCwgQ1AsIHZQLCBrUCwgeVAsIF9QLCB4UCwgUlAsIEJQLCBIUCwgREUsIGxPLCBkTywgSU8sIExPLCBrSSwgVl9dXHJcbiAgICB9XSlbXCJkZWZhdWx0XCJdXHJcbn0pKTtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSAge1xyXG4gICAgYTogXCJJbWFnZSB0b29sYmFyXCIsXHJcbiAgICBiOiBcItCh0L/QtdGG0YHQuNC80LLQvtC70YtcIixcclxuICAgIGM6IFwibGVmdHdhcmRzIGRvdWJsZSBhcnJvd1wiLFxyXG4gICAgZDogXCJyaWdodHdhcmRzIGRvdWJsZSBhcnJvd1wiLFxyXG4gICAgZTogXCJ1cHdhcmRzIGRvdWJsZSBhcnJvd1wiLFxyXG4gICAgZjogXCJkb3dud2FyZHMgZG91YmxlIGFycm93XCIsXHJcbiAgICBnOiBcImxlZnR3YXJkcyBkYXNoZWQgYXJyb3dcIixcclxuICAgIGg6IFwicmlnaHR3YXJkcyBkYXNoZWQgYXJyb3dcIixcclxuICAgIGk6IFwidXB3YXJkcyBkYXNoZWQgYXJyb3dcIixcclxuICAgIGo6IFwiZG93bndhcmRzIGRhc2hlZCBhcnJvd1wiLFxyXG4gICAgazogXCJsZWZ0d2FyZHMgYXJyb3cgdG8gYmFyXCIsXHJcbiAgICBsOiBcInJpZ2h0d2FyZHMgYXJyb3cgdG8gYmFyXCIsXHJcbiAgICBtOiBcInVwd2FyZHMgYXJyb3cgdG8gYmFyXCIsXHJcbiAgICBuOiBcImRvd253YXJkcyBhcnJvdyB0byBiYXJcIixcclxuICAgIG86IFwidXAgZG93biBhcnJvdyB3aXRoIGJhc2VcIixcclxuICAgIHA6IFwiYmFjayB3aXRoIGxlZnR3YXJkcyBhcnJvdyBhYm92ZVwiLFxyXG4gICAgcTogXCJlbmQgd2l0aCBsZWZ0d2FyZHMgYXJyb3cgYWJvdmVcIixcclxuICAgIHI6IFwib24gd2l0aCBleGNsYW1hdGlvbiBtYXJrIHdpdGggbGVmdCByaWdodCBhcnJvdyBhYm92ZVwiLFxyXG4gICAgczogXCJzb29uIHdpdGggcmlnaHR3YXJkcyBhcnJvdyBhYm92ZVwiLFxyXG4gICAgdDogXCJ0b3Agd2l0aCB1cHdhcmRzIGFycm93IGFib3ZlXCIsXHJcbiAgICB1OiBcIkRvbGxhciBzaWduXCIsXHJcbiAgICB2OiBcIkV1cm8gc2lnblwiLFxyXG4gICAgdzogXCJZZW4gc2lnblwiLFxyXG4gICAgeDogXCJQb3VuZCBzaWduXCIsXHJcbiAgICB5OiBcIkNlbnQgc2lnblwiLFxyXG4gICAgejogXCJFdXJvLWN1cnJlbmN5IHNpZ25cIixcclxuICAgIGFhOiBcIkNvbG9uIHNpZ25cIixcclxuICAgIGFiOiBcIkNydXplaXJvIHNpZ25cIixcclxuICAgIGFjOiBcIkZyZW5jaCBmcmFuYyBzaWduXCIsXHJcbiAgICBhZDogXCJMaXJhIHNpZ25cIixcclxuICAgIGFlOiBcIkN1cnJlbmN5IHNpZ25cIixcclxuICAgIGFmOiBcIkJpdGNvaW4gc2lnblwiLFxyXG4gICAgYWc6IFwiTWlsbCBzaWduXCIsXHJcbiAgICBhaDogXCJOYWlyYSBzaWduXCIsXHJcbiAgICBhaTogXCJQZXNldGEgc2lnblwiLFxyXG4gICAgYWo6IFwiUnVwZWUgc2lnblwiLFxyXG4gICAgYWs6IFwiV29uIHNpZ25cIixcclxuICAgIGFsOiBcIk5ldyBzaGVxZWwgc2lnblwiLFxyXG4gICAgYW06IFwiRG9uZyBzaWduXCIsXHJcbiAgICBhbjogXCJLaXAgc2lnblwiLFxyXG4gICAgYW86IFwiVHVncmlrIHNpZ25cIixcclxuICAgIGFwOiBcIkRyYWNobWEgc2lnblwiLFxyXG4gICAgYXE6IFwiR2VybWFuIHBlbm55IHNpZ25cIixcclxuICAgIGFyOiBcIlBlc28gc2lnblwiLFxyXG4gICAgYXM6IFwiR3VhcmFuaSBzaWduXCIsXHJcbiAgICBhdDogXCJBdXN0cmFsIHNpZ25cIixcclxuICAgIGF1OiBcIkhyeXZuaWEgc2lnblwiLFxyXG4gICAgYXY6IFwiQ2VkaSBzaWduXCIsXHJcbiAgICBhdzogXCJMaXZyZSB0b3Vybm9pcyBzaWduXCIsXHJcbiAgICBheDogXCJTcGVzbWlsbyBzaWduXCIsXHJcbiAgICBheTogXCJUZW5nZSBzaWduXCIsXHJcbiAgICBhejogXCJJbmRpYW4gcnVwZWUgc2lnblwiLFxyXG4gICAgYmE6IFwiVHVya2lzaCBsaXJhIHNpZ25cIixcclxuICAgIGJiOiBcIk5vcmRpYyBtYXJrIHNpZ25cIixcclxuICAgIGJjOiBcIk1hbmF0IHNpZ25cIixcclxuICAgIGJkOiBcIlJ1YmxlIHNpZ25cIixcclxuICAgIGJlOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGEgd2l0aCBtYWNyb25cIixcclxuICAgIGJmOiBcIkxhdGluIHNtYWxsIGxldHRlciBhIHdpdGggbWFjcm9uXCIsXHJcbiAgICBiZzogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBhIHdpdGggYnJldmVcIixcclxuICAgIGJoOiBcIkxhdGluIHNtYWxsIGxldHRlciBhIHdpdGggYnJldmVcIixcclxuICAgIGJpOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGEgd2l0aCBvZ29uZWtcIixcclxuICAgIGJqOiBcIkxhdGluIHNtYWxsIGxldHRlciBhIHdpdGggb2dvbmVrXCIsXHJcbiAgICBiazogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBjIHdpdGggYWN1dGVcIixcclxuICAgIGJsOiBcIkxhdGluIHNtYWxsIGxldHRlciBjIHdpdGggYWN1dGVcIixcclxuICAgIGJtOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGMgd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBibjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgYyB3aXRoIGNpcmN1bWZsZXhcIixcclxuICAgIGJvOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGMgd2l0aCBkb3QgYWJvdmVcIixcclxuICAgIGJwOiBcIkxhdGluIHNtYWxsIGxldHRlciBjIHdpdGggZG90IGFib3ZlXCIsXHJcbiAgICBicTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBjIHdpdGggY2Fyb25cIixcclxuICAgIGJyOiBcIkxhdGluIHNtYWxsIGxldHRlciBjIHdpdGggY2Fyb25cIixcclxuICAgIGJzOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGQgd2l0aCBjYXJvblwiLFxyXG4gICAgYnQ6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGQgd2l0aCBjYXJvblwiLFxyXG4gICAgYnU6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgZCB3aXRoIHN0cm9rZVwiLFxyXG4gICAgYnY6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGQgd2l0aCBzdHJva2VcIixcclxuICAgIGJ3OiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGUgd2l0aCBtYWNyb25cIixcclxuICAgIGJ4OiBcIkxhdGluIHNtYWxsIGxldHRlciBlIHdpdGggbWFjcm9uXCIsXHJcbiAgICBieTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBlIHdpdGggYnJldmVcIixcclxuICAgIGJ6OiBcIkxhdGluIHNtYWxsIGxldHRlciBlIHdpdGggYnJldmVcIixcclxuICAgIGNhOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGUgd2l0aCBkb3QgYWJvdmVcIixcclxuICAgIGNiOiBcIkxhdGluIHNtYWxsIGxldHRlciBlIHdpdGggZG90IGFib3ZlXCIsXHJcbiAgICBjYzogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBlIHdpdGggb2dvbmVrXCIsXHJcbiAgICBjZDogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgZSB3aXRoIG9nb25la1wiLFxyXG4gICAgY2U6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgZSB3aXRoIGNhcm9uXCIsXHJcbiAgICBjZjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgZSB3aXRoIGNhcm9uXCIsXHJcbiAgICBjZzogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBnIHdpdGggY2lyY3VtZmxleFwiLFxyXG4gICAgY2g6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGcgd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBjaTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBnIHdpdGggYnJldmVcIixcclxuICAgIGNqOiBcIkxhdGluIHNtYWxsIGxldHRlciBnIHdpdGggYnJldmVcIixcclxuICAgIGNrOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGcgd2l0aCBkb3QgYWJvdmVcIixcclxuICAgIGNsOiBcIkxhdGluIHNtYWxsIGxldHRlciBnIHdpdGggZG90IGFib3ZlXCIsXHJcbiAgICBjbTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBnIHdpdGggY2VkaWxsYVwiLFxyXG4gICAgY246IFwiTGF0aW4gc21hbGwgbGV0dGVyIGcgd2l0aCBjZWRpbGxhXCIsXHJcbiAgICBjbzogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBoIHdpdGggY2lyY3VtZmxleFwiLFxyXG4gICAgY3A6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGggd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBjcTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBoIHdpdGggc3Ryb2tlXCIsXHJcbiAgICBjcjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgaCB3aXRoIHN0cm9rZVwiLFxyXG4gICAgY3M6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgaSB3aXRoIHRpbGRlXCIsXHJcbiAgICBjdDogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgaSB3aXRoIHRpbGRlXCIsXHJcbiAgICBjdTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBpIHdpdGggbWFjcm9uXCIsXHJcbiAgICBjdjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgaSB3aXRoIG1hY3JvblwiLFxyXG4gICAgY3c6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgaSB3aXRoIGJyZXZlXCIsXHJcbiAgICBjeDogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgaSB3aXRoIGJyZXZlXCIsXHJcbiAgICBjeTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBpIHdpdGggb2dvbmVrXCIsXHJcbiAgICBjejogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgaSB3aXRoIG9nb25la1wiLFxyXG4gICAgZGE6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgaSB3aXRoIGRvdCBhYm92ZVwiLFxyXG4gICAgZGI6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGRvdGxlc3MgaVwiLFxyXG4gICAgZGM6IFwiTGF0aW4gY2FwaXRhbCBsaWdhdHVyZSBpalwiLFxyXG4gICAgZGQ6IFwiTGF0aW4gc21hbGwgbGlnYXR1cmUgaWpcIixcclxuICAgIGRlOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGogd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBkZjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgaiB3aXRoIGNpcmN1bWZsZXhcIixcclxuICAgIGRnOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGsgd2l0aCBjZWRpbGxhXCIsXHJcbiAgICBkaDogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgayB3aXRoIGNlZGlsbGFcIixcclxuICAgIGRpOiBcIkxhdGluIHNtYWxsIGxldHRlciBrcmFcIixcclxuICAgIGRqOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGwgd2l0aCBhY3V0ZVwiLFxyXG4gICAgZGs6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGwgd2l0aCBhY3V0ZVwiLFxyXG4gICAgZGw6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgbCB3aXRoIGNlZGlsbGFcIixcclxuICAgIGRtOiBcIkxhdGluIHNtYWxsIGxldHRlciBsIHdpdGggY2VkaWxsYVwiLFxyXG4gICAgZG46IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgbCB3aXRoIGNhcm9uXCIsXHJcbiAgICBkbzogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgbCB3aXRoIGNhcm9uXCIsXHJcbiAgICBkcDogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBsIHdpdGggbWlkZGxlIGRvdFwiLFxyXG4gICAgZHE6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGwgd2l0aCBtaWRkbGUgZG90XCIsXHJcbiAgICBkcjogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBsIHdpdGggc3Ryb2tlXCIsXHJcbiAgICBkczogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgbCB3aXRoIHN0cm9rZVwiLFxyXG4gICAgZHQ6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgbiB3aXRoIGFjdXRlXCIsXHJcbiAgICBkdTogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgbiB3aXRoIGFjdXRlXCIsXHJcbiAgICBkdjogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBuIHdpdGggY2VkaWxsYVwiLFxyXG4gICAgZHc6IFwiTGF0aW4gc21hbGwgbGV0dGVyIG4gd2l0aCBjZWRpbGxhXCIsXHJcbiAgICBkeDogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBuIHdpdGggY2Fyb25cIixcclxuICAgIGR5OiBcIkxhdGluIHNtYWxsIGxldHRlciBuIHdpdGggY2Fyb25cIixcclxuICAgIGR6OiBcIkxhdGluIHNtYWxsIGxldHRlciBuIHByZWNlZGVkIGJ5IGFwb3N0cm9waGVcIixcclxuICAgIGVhOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIGVuZ1wiLFxyXG4gICAgZWI6IFwiTGF0aW4gc21hbGwgbGV0dGVyIGVuZ1wiLFxyXG4gICAgZWM6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgbyB3aXRoIG1hY3JvblwiLFxyXG4gICAgZWQ6IFwiTGF0aW4gc21hbGwgbGV0dGVyIG8gd2l0aCBtYWNyb25cIixcclxuICAgIGVlOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIG8gd2l0aCBicmV2ZVwiLFxyXG4gICAgZWY6IFwiTGF0aW4gc21hbGwgbGV0dGVyIG8gd2l0aCBicmV2ZVwiLFxyXG4gICAgZWc6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgbyB3aXRoIGRvdWJsZSBhY3V0ZVwiLFxyXG4gICAgZWg6IFwiTGF0aW4gc21hbGwgbGV0dGVyIG8gd2l0aCBkb3VibGUgYWN1dGVcIixcclxuICAgIGVpOiBcIkxhdGluIGNhcGl0YWwgbGlnYXR1cmUgb2VcIixcclxuICAgIGVqOiBcIkxhdGluIHNtYWxsIGxpZ2F0dXJlIG9lXCIsXHJcbiAgICBlazogXCJMYXRpbiBjYXBpdGFsIGxldHRlciByIHdpdGggYWN1dGVcIixcclxuICAgIGVsOiBcIkxhdGluIHNtYWxsIGxldHRlciByIHdpdGggYWN1dGVcIixcclxuICAgIGVtOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHIgd2l0aCBjZWRpbGxhXCIsXHJcbiAgICBlbjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgciB3aXRoIGNlZGlsbGFcIixcclxuICAgIGVvOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHIgd2l0aCBjYXJvblwiLFxyXG4gICAgZXA6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHIgd2l0aCBjYXJvblwiLFxyXG4gICAgZXE6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgcyB3aXRoIGFjdXRlXCIsXHJcbiAgICBlcjogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgcyB3aXRoIGFjdXRlXCIsXHJcbiAgICBlczogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBzIHdpdGggY2lyY3VtZmxleFwiLFxyXG4gICAgZXQ6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHMgd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBldTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBzIHdpdGggY2VkaWxsYVwiLFxyXG4gICAgZXY6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHMgd2l0aCBjZWRpbGxhXCIsXHJcbiAgICBldzogXCJMYXRpbiBjYXBpdGFsIGxldHRlciBzIHdpdGggY2Fyb25cIixcclxuICAgIGV4OiBcIkxhdGluIHNtYWxsIGxldHRlciBzIHdpdGggY2Fyb25cIixcclxuICAgIGV5OiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHQgd2l0aCBjZWRpbGxhXCIsXHJcbiAgICBlejogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgdCB3aXRoIGNlZGlsbGFcIixcclxuICAgIGZhOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHQgd2l0aCBjYXJvblwiLFxyXG4gICAgZmI6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHQgd2l0aCBjYXJvblwiLFxyXG4gICAgZmM6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgdCB3aXRoIHN0cm9rZVwiLFxyXG4gICAgZmQ6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHQgd2l0aCBzdHJva2VcIixcclxuICAgIGZlOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHUgd2l0aCB0aWxkZVwiLFxyXG4gICAgZmY6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHUgd2l0aCB0aWxkZVwiLFxyXG4gICAgZmc6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgdSB3aXRoIG1hY3JvblwiLFxyXG4gICAgZmg6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHUgd2l0aCBtYWNyb25cIixcclxuICAgIGZpOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHUgd2l0aCBicmV2ZVwiLFxyXG4gICAgZmo6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHUgd2l0aCBicmV2ZVwiLFxyXG4gICAgZms6IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgdSB3aXRoIHJpbmcgYWJvdmVcIixcclxuICAgIGZsOiBcIkxhdGluIHNtYWxsIGxldHRlciB1IHdpdGggcmluZyBhYm92ZVwiLFxyXG4gICAgZm06IFwiTGF0aW4gY2FwaXRhbCBsZXR0ZXIgdSB3aXRoIGRvdWJsZSBhY3V0ZVwiLFxyXG4gICAgZm46IFwiTGF0aW4gc21hbGwgbGV0dGVyIHUgd2l0aCBkb3VibGUgYWN1dGVcIixcclxuICAgIGZvOiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHUgd2l0aCBvZ29uZWtcIixcclxuICAgIGZwOiBcIkxhdGluIHNtYWxsIGxldHRlciB1IHdpdGggb2dvbmVrXCIsXHJcbiAgICBmcTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciB3IHdpdGggY2lyY3VtZmxleFwiLFxyXG4gICAgZnI6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHcgd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBmczogXCJMYXRpbiBjYXBpdGFsIGxldHRlciB5IHdpdGggY2lyY3VtZmxleFwiLFxyXG4gICAgZnQ6IFwiTGF0aW4gc21hbGwgbGV0dGVyIHkgd2l0aCBjaXJjdW1mbGV4XCIsXHJcbiAgICBmdTogXCJMYXRpbiBjYXBpdGFsIGxldHRlciB5IHdpdGggZGlhZXJlc2lzXCIsXHJcbiAgICBmdjogXCJMYXRpbiBjYXBpdGFsIGxldHRlciB6IHdpdGggYWN1dGVcIixcclxuICAgIGZ3OiBcIkxhdGluIHNtYWxsIGxldHRlciB6IHdpdGggYWN1dGVcIixcclxuICAgIGZ4OiBcIkxhdGluIGNhcGl0YWwgbGV0dGVyIHogd2l0aCBkb3QgYWJvdmVcIixcclxuICAgIGZ5OiBcIkxhdGluIHNtYWxsIGxldHRlciB6IHdpdGggZG90IGFib3ZlXCIsXHJcbiAgICBmejogXCJMYXRpbiBjYXBpdGFsIGxldHRlciB6IHdpdGggY2Fyb25cIixcclxuICAgIGdhOiBcIkxhdGluIHNtYWxsIGxldHRlciB6IHdpdGggY2Fyb25cIixcclxuICAgIGdiOiBcIkxhdGluIHNtYWxsIGxldHRlciBsb25nIHNcIixcclxuICAgIGdjOiBcIkxlc3MtdGhhbiBzaWduXCIsXHJcbiAgICBnZDogXCJHcmVhdGVyLXRoYW4gc2lnblwiLFxyXG4gICAgZ2U6IFwiTGVzcy10aGFuIG9yIGVxdWFsIHRvXCIsXHJcbiAgICBnZjogXCJHcmVhdGVyLXRoYW4gb3IgZXF1YWwgdG9cIixcclxuICAgIGdnOiBcIkVuIGRhc2hcIixcclxuICAgIGdoOiBcIkVtIGRhc2hcIixcclxuICAgIGdpOiBcIk1hY3JvblwiLFxyXG4gICAgZ2o6IFwiT3ZlcmxpbmVcIixcclxuICAgIGdrOiBcIkRlZ3JlZSBzaWduXCIsXHJcbiAgICBnbDogXCJNaW51cyBzaWduXCIsXHJcbiAgICBnbTogXCJQbHVzLW1pbnVzIHNpZ25cIixcclxuICAgIGduOiBcIkRpdmlzaW9uIHNpZ25cIixcclxuICAgIGdvOiBcIkZyYWN0aW9uIHNsYXNoXCIsXHJcbiAgICBncDogXCJNdWx0aXBsaWNhdGlvbiBzaWduXCIsXHJcbiAgICBncTogXCJMYXRpbiBzbWFsbCBsZXR0ZXIgZiB3aXRoIGhvb2tcIixcclxuICAgIGdyOiBcIkludGVncmFsXCIsXHJcbiAgICBnczogXCJOLWFyeSBzdW1tYXRpb25cIixcclxuICAgIGd0OiBcIkluZmluaXR5XCIsXHJcbiAgICBndTogXCJTcXVhcmUgcm9vdFwiLFxyXG4gICAgZ3Y6IFwiVGlsZGUgb3BlcmF0b3JcIixcclxuICAgIGd3OiBcIkFwcHJveGltYXRlbHkgZXF1YWwgdG9cIixcclxuICAgIGd4OiBcIkFsbW9zdCBlcXVhbCB0b1wiLFxyXG4gICAgZ3k6IFwiTm90IGVxdWFsIHRvXCIsXHJcbiAgICBnejogXCJJZGVudGljYWwgdG9cIixcclxuICAgIGhhOiBcIkVsZW1lbnQgb2ZcIixcclxuICAgIGhiOiBcIk5vdCBhbiBlbGVtZW50IG9mXCIsXHJcbiAgICBoYzogXCJDb250YWlucyBhcyBtZW1iZXJcIixcclxuICAgIGhkOiBcIk4tYXJ5IHByb2R1Y3RcIixcclxuICAgIGhlOiBcIkxvZ2ljYWwgYW5kXCIsXHJcbiAgICBoZjogXCJMb2dpY2FsIG9yXCIsXHJcbiAgICBoZzogXCJOb3Qgc2lnblwiLFxyXG4gICAgaGg6IFwiSW50ZXJzZWN0aW9uXCIsXHJcbiAgICBoaTogXCJVbmlvblwiLFxyXG4gICAgaGo6IFwiUGFydGlhbCBkaWZmZXJlbnRpYWxcIixcclxuICAgIGhrOiBcIkZvciBhbGxcIixcclxuICAgIGhsOiBcIlRoZXJlIGV4aXN0c1wiLFxyXG4gICAgaG06IFwiRW1wdHkgc2V0XCIsXHJcbiAgICBobjogXCJOYWJsYVwiLFxyXG4gICAgaG86IFwiQXN0ZXJpc2sgb3BlcmF0b3JcIixcclxuICAgIGhwOiBcIlByb3BvcnRpb25hbCB0b1wiLFxyXG4gICAgaHE6IFwiQW5nbGVcIixcclxuICAgIGhyOiBcIlZ1bGdhciBmcmFjdGlvbiBvbmUgcXVhcnRlclwiLFxyXG4gICAgaHM6IFwiVnVsZ2FyIGZyYWN0aW9uIG9uZSBoYWxmXCIsXHJcbiAgICBodDogXCJWdWxnYXIgZnJhY3Rpb24gdGhyZWUgcXVhcnRlcnNcIixcclxuICAgIGh1OiBcIlNpbmdsZSBsZWZ0LXBvaW50aW5nIGFuZ2xlIHF1b3RhdGlvbiBtYXJrXCIsXHJcbiAgICBodjogXCJTaW5nbGUgcmlnaHQtcG9pbnRpbmcgYW5nbGUgcXVvdGF0aW9uIG1hcmtcIixcclxuICAgIGh3OiBcIkxlZnQtcG9pbnRpbmcgZG91YmxlIGFuZ2xlIHF1b3RhdGlvbiBtYXJrXCIsXHJcbiAgICBoeDogXCJSaWdodC1wb2ludGluZyBkb3VibGUgYW5nbGUgcXVvdGF0aW9uIG1hcmtcIixcclxuICAgIGh5OiBcIkxlZnQgc2luZ2xlIHF1b3RhdGlvbiBtYXJrXCIsXHJcbiAgICBoejogXCJSaWdodCBzaW5nbGUgcXVvdGF0aW9uIG1hcmtcIixcclxuICAgIGlhOiBcIkxlZnQgZG91YmxlIHF1b3RhdGlvbiBtYXJrXCIsXHJcbiAgICBpYjogXCJSaWdodCBkb3VibGUgcXVvdGF0aW9uIG1hcmtcIixcclxuICAgIGljOiBcIlNpbmdsZSBsb3ctOSBxdW90YXRpb24gbWFya1wiLFxyXG4gICAgaWQ6IFwiRG91YmxlIGxvdy05IHF1b3RhdGlvbiBtYXJrXCIsXHJcbiAgICBpZTogXCJJbnZlcnRlZCBleGNsYW1hdGlvbiBtYXJrXCIsXHJcbiAgICBpZjogXCJJbnZlcnRlZCBxdWVzdGlvbiBtYXJrXCIsXHJcbiAgICBpZzogXCJUd28gZG90IGxlYWRlclwiLFxyXG4gICAgaWg6IFwiSG9yaXpvbnRhbCBlbGxpcHNpc1wiLFxyXG4gICAgaWk6IFwiRG91YmxlIGRhZ2dlclwiLFxyXG4gICAgaWo6IFwiUGVyIG1pbGxlIHNpZ25cIixcclxuICAgIGlrOiBcIlBlciB0ZW4gdGhvdXNhbmQgc2lnblwiLFxyXG4gICAgaWw6IFwiRG91YmxlIGV4Y2xhbWF0aW9uIG1hcmtcIixcclxuICAgIGltOiBcIlF1ZXN0aW9uIGV4Y2xhbWF0aW9uIG1hcmtcIixcclxuICAgIGluOiBcIkV4Y2xhbWF0aW9uIHF1ZXN0aW9uIG1hcmtcIixcclxuICAgIGlvOiBcIkRvdWJsZSBxdWVzdGlvbiBtYXJrXCIsXHJcbiAgICBpcDogXCJDb3B5cmlnaHQgc2lnblwiLFxyXG4gICAgaXE6IFwiUmVnaXN0ZXJlZCBzaWduXCIsXHJcbiAgICBpcjogXCJUcmFkZSBtYXJrIHNpZ25cIixcclxuICAgIGlzOiBcIlNlY3Rpb24gc2lnblwiLFxyXG4gICAgaXQ6IFwiUGFyYWdyYXBoIHNpZ25cIixcclxuICAgIGl1OiBcIlJldmVyc2VkIHBhcmFncmFwaCBzaWduXCIsXHJcbiAgICBpdjogXCJUYWJsZSB0b29sYmFyXCIsXHJcbiAgICBpdzogXCLQktGL0YDQsNCy0L3QuNCy0LDQvdC40LUg0L/QviDQu9C10LLQvtC80YMg0LrRgNCw0Y5cIixcclxuICAgIGl4OiBcItCS0YvRgNCw0LLQvdC40LLQsNC90LjQtSDQv9C+INC/0YDQsNCy0L7QvNGDINC60YDQsNGOXCIsXHJcbiAgICBpeTogXCLQktGL0YDQsNCy0L3QuNCy0LDQvdC40LUg0L/QviDRhtC10L3RgtGA0YNcIixcclxuICAgIGl6OiBcItCS0YvRgNCw0LLQvdC40LLQsNC90LjQtSDQv9C+INGI0LjRgNC40L3QtVwiLFxyXG4gICAgamE6IFwi0JLRi9GA0LDQstC90LjQstCw0L3QuNC1INGC0LXQutGB0YLQsFwiLFxyXG4gICAgamI6IFwi0JLRi9GA0LDQstC90LjQstCw0L3QuNC1XCIsXHJcbiAgICBqYzogXCLQptC40YLQsNGC0LBcIixcclxuICAgIGpkOiBcItCS0YvQsdGA0LDRgtGMINC30LDQs9C+0LvQvtCy0L7QulwiLFxyXG4gICAgamU6IFwi0JfQsNCz0L7Qu9C+0LLQvtC6XCIsXHJcbiAgICBqZjogXCLQk9C+0YDQuNC30L7QvdGC0LDQu9GM0L3QsNGPINC70LjQvdC40Y9cIixcclxuICAgIGpnOiBcItCj0LLQtdC70LjRh9C40YLRjCDQvtGC0YHRgtGD0L9cIixcclxuICAgIGpoOiBcItCj0LzQtdC90YzRiNC40YLRjCDQvtGC0YHRgtGD0L9cIixcclxuICAgIGppOiBcItCW0LjRgNC90YvQuVwiLFxyXG4gICAgamo6IFwi0JrRg9GA0YHQuNCyXCIsXHJcbiAgICBqazogXCLQl9Cw0YfQtdGA0LrQvdGD0YLRi9C5XCIsXHJcbiAgICBqbDogXCLQn9C+0LTRgdGC0YDQvtGH0L3Ri9C5XCIsXHJcbiAgICBqbTogXCLQndCw0LTRgdGC0YDQvtGH0L3Ri9C5XCIsXHJcbiAgICBqbjogXCLQn9C+0LTRh9C10YDQutC90YPRgtGL0LlcIixcclxuICAgIGpvOiBcItCh0LXQvNC10LnRgdGC0LLQviDRiNGA0LjRhNGC0L7QslwiLFxyXG4gICAganA6IFwi0J/QviDRg9C80L7Qu9GH0LDQvdC40Y5cIixcclxuICAgIGpxOiBcItCg0LDQt9C80LXRgCDRiNGA0LjRhNGC0LBcIixcclxuICAgIGpyOiBcItCe0YfQtdC90Ywg0LzQtdC70LrQuNC5XCIsXHJcbiAgICBqczogXCLQnNC10LvQutC40LlcIixcclxuICAgIGp0OiBcItCa0YDRg9C/0L3Ri9C5XCIsXHJcbiAgICBqdTogXCLQntGH0LXQvdGMINC60YDRg9C/0L3Ri9C5XCIsXHJcbiAgICBqdjogXCLQptCy0LXRgiDRiNGA0LjRhNGC0LBcIixcclxuICAgIGp3OiBcItCm0LLQtdGCINGE0L7QvdCwXCIsXHJcbiAgICBqeDogXCLQktC40LTQttC10YIg0LjQt9C+0LHRgNCw0LbQtdC90LjQuVwiLFxyXG4gICAgank6IFwi0J7RgNC40LPQuNC90LDQu9GM0L3Ri9C5INGA0LDQt9C80LXRgCDQuNC30L7QsdGA0LDQttC10L3QuNGPXCIsXHJcbiAgICBqejogXCLQkdC+0LrQvtCy0L7QtSDQuNC30L7QsdGA0LDQttC10L3QuNC1XCIsXHJcbiAgICBrYTogXCLQktGL0YDQsNCy0L3QuNCy0LDQvdC40LUg0L/QviDQu9C10LLQvtC80YMg0LrRgNCw0Y5cIixcclxuICAgIGtiOiBcItCS0YvRgNCw0LLQvdC40LLQsNC90LjQtSDQv9C+INGG0LXQvdGC0YDRg1wiLFxyXG4gICAga2M6IFwi0JLRi9GA0LDQstC90LjQstCw0L3QuNC1INC/0L4g0L/RgNCw0LLQvtC80YMg0LrRgNCw0Y5cIixcclxuICAgIGtkOiBcItCS0YHRgtCw0LLQuNGC0Ywg0LjQt9C+0LHRgNCw0LbQtdC90LjQtVwiLFxyXG4gICAga2U6IFwi0JfQsNCz0YDRg9C30LrQsCDQvdC1INCy0YvQv9C+0LvQvdC10L3QsFwiLFxyXG4gICAga2Y6IFwiV2lkZ2V0IHRvb2xiYXJcIixcclxuICAgIGtnOiBcItCh0LLQvtC50YHRgtCy0LAg0YLQsNCx0LvQuNGG0YtcIixcclxuICAgIGtoOiBcItCh0LLQvtC50YHRgtCy0LAg0Y/Rh9C10LnQutC4XCIsXHJcbiAgICBraTogXCLQktGB0YLQsNCy0LjRgtGMINGC0LDQsdC70LjRhtGDXCIsXHJcbiAgICBrajogXCLQodGC0L7Qu9Cx0LXRhiDQt9Cw0LPQvtC70L7QstC60L7QslwiLFxyXG4gICAga2s6IFwi0JLRgdGC0LDQstC40YLRjCDRgdGC0L7Qu9Cx0LXRhiDRgdC70LXQstCwXCIsXHJcbiAgICBrbDogXCLQktGB0YLQsNCy0LjRgtGMINGB0YLQvtC70LHQtdGGINGB0L/RgNCw0LLQsFwiLFxyXG4gICAga206IFwi0KPQtNCw0LvQuNGC0Ywg0YHRgtC+0LvQsdC10YZcIixcclxuICAgIGtuOiBcItCh0YLQvtC70LHQtdGGXCIsXHJcbiAgICBrbzogXCLQodGC0YDQvtC60LAg0LfQsNCz0L7Qu9C+0LLQutC+0LJcIixcclxuICAgIGtwOiBcItCS0YHRgtCw0LLQuNGC0Ywg0YHRgtGA0L7QutGDINC90LjQttC1XCIsXHJcbiAgICBrcTogXCLQktGB0YLQsNCy0LjRgtGMINGB0YLRgNC+0LrRgyDQstGL0YjQtVwiLFxyXG4gICAga3I6IFwi0KPQtNCw0LvQuNGC0Ywg0YHRgtGA0L7QutGDXCIsXHJcbiAgICBrczogXCLQodGC0YDQvtC60LBcIixcclxuICAgIGt0OiBcItCe0LHRitC10LTQuNC90LjRgtGMINGBINGP0YfQtdC50LrQvtC5INGB0LLQtdGA0YXRg1wiLFxyXG4gICAga3U6IFwi0J7QsdGK0LXQtNC40L3QuNGC0Ywg0YEg0Y/Rh9C10LnQutC+0Lkg0YHQv9GA0LDQstCwXCIsXHJcbiAgICBrdjogXCLQntCx0YrQtdC00LjQvdC40YLRjCDRgSDRj9GH0LXQudC60L7QuSDRgdC90LjQt9GDXCIsXHJcbiAgICBrdzogXCLQntCx0YrQtdC00LjQvdC40YLRjCDRgSDRj9GH0LXQudC60L7QuSDRgdC70LXQstCwXCIsXHJcbiAgICBreDogXCLQoNCw0LfQtNC10LvQuNGC0Ywg0Y/Rh9C10LnQutGDINCy0LXRgNGC0LjQutCw0LvRjNC90L5cIixcclxuICAgIGt5OiBcItCg0LDQt9C00LXQu9C40YLRjCDRj9GH0LXQudC60YMg0LPQvtGA0LjQt9C+0L3RgtCw0LvRjNC90L5cIixcclxuICAgIGt6OiBcItCe0LHRitC10LTQuNC90LjRgtGMINGP0YfQtdC50LrQuFwiLFxyXG4gICAgbGE6IFwi0KPQsdGA0LDRgtGMINGE0L7RgNC80LDRgtC40YDQvtCy0LDQvdC40LVcIixcclxuICAgIGxiOiBcItCY0LTRkdGCINC30LDQs9GA0YPQt9C60LBcIixcclxuICAgIGxjOiBcItCd0YPQvNC10YDQvtCy0LDQvdC90YvQuSDRgdC/0LjRgdC+0LpcIixcclxuICAgIGxkOiBcItCc0LDRgNC60LjRgNC+0LLQsNC90L3Ri9C5INGB0L/QuNGB0L7QulwiLFxyXG4gICAgbGU6IFwiQ2hhcmFjdGVyIGNhdGVnb3JpZXNcIixcclxuICAgIGxmOiBcItCh0YHRi9C70LrQsFwiLFxyXG4gICAgbGc6IFwiRHJvcGRvd24gdG9vbGJhclwiLFxyXG4gICAgbGg6IFwi0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0Ywg0LDQu9GM0YLQtdGA0L3QsNGC0LjQstC90YvQuSDRgtC10LrRgdGCXCIsXHJcbiAgICBsaTogXCLQo9Cx0YDQsNGC0Ywg0YbQstC10YJcIixcclxuICAgIGxqOiBcItCm0LLQtdGCINGB0YLRgNCw0L3QuNGG0YtcIixcclxuICAgIGxrOiBcItCj0LHRgNCw0YLRjCDRgdGB0YvQu9C60YNcIixcclxuICAgIGxsOiBcItCg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMINGB0YHRi9C70LrRg1wiLFxyXG4gICAgbG06IFwi0J7RgtC60YDRi9GC0Ywg0YHRgdGL0LvQutGDINCyINC90L7QstC+0Lkg0LLQutC70LDQtNC60LVcIixcclxuICAgIGxuOiBcItCU0LvRjyDRjdGC0L7QuSDRgdGB0YvQu9C60Lgg0L3QtSDRg9GB0YLQsNC90L7QstC70LXQvSDQsNC00YDQtdGBIFVSTFwiLFxyXG4gICAgbG86IFwi0KHQvtGF0YDQsNC90LjRgtGMXCIsXHJcbiAgICBscDogXCLQntGC0LzQtdC90LBcIixcclxuICAgIGxxOiBcItCh0YHRi9C70LrQsCBVUkxcIixcclxuICAgIGxyOiBcIkVkaXRvciB0b29sYmFyXCIsXHJcbiAgICBsczogXCLQlNGA0YPQs9C40LUg0LjQvdGB0YLRgNGD0LzQtdC90YLRi1wiLFxyXG4gICAgbHQ6IFwi0JDQu9GM0YLQtdGA0L3QsNGC0LjQstC90YvQuSDRgtC10LrRgdGCXCIsXHJcbiAgICBsdTogXCIlMCBvZiAlMVwiLFxyXG4gICAgbHY6IFwiUHJldmlvdXNcIixcclxuICAgIGx3OiBcIk5leHRcIixcclxuICAgIGx4OiBcItCn0ZHRgNC90YvQuVwiLFxyXG4gICAgbHk6IFwi0KLRkdC80L3Qvi3RgdC10YDRi9C5XCIsXHJcbiAgICBsejogXCLQodC10YDRi9C5XCIsXHJcbiAgICBtYTogXCLQodCy0LXRgtC70L4t0YHQtdGA0YvQuVwiLFxyXG4gICAgbWI6IFwi0JHQtdC70YvQuVwiLFxyXG4gICAgbWM6IFwi0JrRgNCw0YHQvdGL0LlcIixcclxuICAgIG1kOiBcItCe0YDQsNC90LbQtdCy0YvQuVwiLFxyXG4gICAgbWU6IFwi0JbRkdC70YLRi9C5XCIsXHJcbiAgICBtZjogXCLQodCw0LvQsNGC0L7QstGL0LlcIixcclxuICAgIG1nOiBcItCX0LXQu9GR0L3Ri9C5XCIsXHJcbiAgICBtaDogXCLQkNC60LLQsNC80LDRgNC40L3QvtCy0YvQuVwiLFxyXG4gICAgbWk6IFwi0JHQuNGA0Y7Qt9C+0LLRi9C5XCIsXHJcbiAgICBtajogXCLQk9C+0LvRg9Cx0L7QuVwiLFxyXG4gICAgbWs6IFwi0KHQuNC90LjQuVwiLFxyXG4gICAgbWw6IFwi0KTQuNC+0LvQtdGC0L7QstGL0LlcIixcclxuICAgIG1tOiBcIk9wZW4gaW4gYSBuZXcgdGFiXCIsXHJcbiAgICBtbjogXCJEb3dubG9hZGFibGVcIixcclxuICAgIG1vOiBcItCe0YLQvNC10L3QuNGC0YxcIixcclxuICAgIG1wOiBcItCf0L7QstGC0L7RgNC40YLRjFwiLFxyXG4gICAgbXE6IFwi0J3QtdGCXCIsXHJcbiAgICBtcjogXCLQodC/0LvQvtGI0L3QsNGPXCIsXHJcbiAgICBtczogXCLQotC+0YfQutC4XCIsXHJcbiAgICBtdDogXCLQn9GD0L3QutGC0LjRgFwiLFxyXG4gICAgbXU6IFwi0JTQstC+0LnQvdCw0Y9cIixcclxuICAgIG12OiBcIkdyb292ZVwiLFxyXG4gICAgbXc6IFwiUmlkZ2VcIixcclxuICAgIG14OiBcIkluc2V0XCIsXHJcbiAgICBteTogXCJPdXRzZXRcIixcclxuICAgIG16OiAnVGhlIGNvbG9yIGlzIGludmFsaWQuIFRyeSBcIiNGRjAwMDBcIiBvciBcInJnYigyNTUsMCwwKVwiIG9yIFwicmVkXCIuJyxcclxuICAgIG5hOiAnVGhlIHZhbHVlIGlzIGludmFsaWQuIFRyeSBcIjEwcHhcIiBvciBcIjJlbVwiIG9yIHNpbXBseSBcIjJcIi4nLFxyXG4gICAgbmI6IFwi0JPRgNCw0L3QuNGG0LBcIixcclxuICAgIG5jOiBcItCh0YLQuNC70YxcIixcclxuICAgIG5kOiBcItCo0LjRgNC40L3QsFwiLFxyXG4gICAgbmU6IFwi0KbQstC10YJcIixcclxuICAgIG5mOiBcItCm0LLQtdGCINGE0L7QvdCwXCIsXHJcbiAgICBuZzogXCLQk9Cw0LHQsNGA0LjRgtGLXCIsXHJcbiAgICBuaDogXCLQktGL0YHQvtGC0LBcIixcclxuICAgIG5pOiBcItCe0YLRgdGC0YPQv9GLXCIsXHJcbiAgICBuajogXCLQktGL0YDQsNCy0L3QuNCy0LDQvdC40LUg0LIg0Y/Rh9C10LnQutC1XCIsXHJcbiAgICBuazogXCJIb3Jpem9udGFsIHRleHQgYWxpZ25tZW50IHRvb2xiYXJcIixcclxuICAgIG5sOiBcIlZlcnRpY2FsIHRleHQgYWxpZ25tZW50IHRvb2xiYXJcIixcclxuICAgIG5tOiBcIkFsaWduIGNlbGwgdGV4dCB0byB0aGUgbGVmdFwiLFxyXG4gICAgbm46IFwiQWxpZ24gY2VsbCB0ZXh0IHRvIHRoZSBjZW50ZXJcIixcclxuICAgIG5vOiBcIkFsaWduIGNlbGwgdGV4dCB0byB0aGUgcmlnaHRcIixcclxuICAgIG5wOiBcIkp1c3RpZnkgY2VsbCB0ZXh0XCIsXHJcbiAgICBucTogXCJBbGlnbiBjZWxsIHRleHQgdG8gdGhlIHRvcFwiLFxyXG4gICAgbnI6IFwiQWxpZ24gY2VsbCB0ZXh0IHRvIHRoZSBtaWRkbGVcIixcclxuICAgIG5zOiBcIkFsaWduIGNlbGwgdGV4dCB0byB0aGUgYm90dG9tXCIsXHJcbiAgICBudDogXCLQktGL0YDQsNCy0L3QuNCy0LDQvdC40LVcIixcclxuICAgIG51OiBcItCS0YvRgNCw0LLQvdC40LLQsNC90LjQtVwiLFxyXG4gICAgbnY6IFwi0J/QviDQu9C10LLQvtC80YMg0LrRgNCw0Y5cIixcclxuICAgIG53OiBcItCf0L4g0YbQtdC90YLRgNGDXCIsXHJcbiAgICBueDogXCLQn9C+INC/0YDQsNCy0L7QvNGDINC60YDQsNGOXCIsXHJcbiAgICBueTogXCLQn9Cw0YDQsNCz0YDQsNGEXCIsXHJcbiAgICBuejogXCLQl9Cw0LPQvtC70L7QstC+0LogMVwiLFxyXG4gICAgb2E6IFwi0JfQsNCz0L7Qu9C+0LLQvtC6IDJcIixcclxuICAgIG9iOiBcItCX0LDQs9C+0LvQvtCy0L7QuiAzXCIsXHJcbiAgICBvYzogXCLQl9Cw0LPQvtC70L7QstC+0LogNFwiLFxyXG4gICAgb2Q6IFwi0JfQsNCz0L7Qu9C+0LLQvtC6IDVcIixcclxuICAgIG9lOiBcItCX0LDQs9C+0LvQvtCy0L7QuiA2XCIsXHJcbiAgICBvZjogXCLQoNC10LTQsNC60YLQvtGALCAlMFwiXHJcbn07IiwidmFyIGNzcyA9IFwiLmNvbnRhaW5lcixcXG4uY29udGFpbmVyLWZsdWlkIHtcXG4gIG1hcmdpbi1yaWdodDogYXV0bztcXG4gIG1hcmdpbi1sZWZ0OiBhdXRvO1xcbn1cXG4uY29udGFpbmVyLWZsdWlkIHtcXG4gIHBhZGRpbmctcmlnaHQ6IDJyZW07XFxuICBwYWRkaW5nLWxlZnQ6IDJyZW07XFxufVxcbi5yb3cge1xcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gIGRpc3BsYXk6IC13ZWJraXQtYm94O1xcbiAgZGlzcGxheTogLW1zLWZsZXhib3g7XFxuICBkaXNwbGF5OiBmbGV4O1xcbiAgLXdlYmtpdC1ib3gtZmxleDogMDtcXG4gIC1tcy1mbGV4OiAwIDEgYXV0bztcXG4gIGZsZXg6IDAgMSBhdXRvO1xcbiAgLXdlYmtpdC1ib3gtb3JpZW50OiBob3Jpem9udGFsO1xcbiAgLXdlYmtpdC1ib3gtZGlyZWN0aW9uOiBub3JtYWw7XFxuICAtbXMtZmxleC1kaXJlY3Rpb246IHJvdztcXG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XFxuICAtbXMtZmxleC13cmFwOiB3cmFwO1xcbiAgZmxleC13cmFwOiB3cmFwO1xcbiAgbWFyZ2luLXJpZ2h0OiAtLjVyZW07XFxuICBtYXJnaW4tbGVmdDogLS41cmVtO1xcbn1cXG4ucm93LnJldmVyc2Uge1xcbiAgLXdlYmtpdC1ib3gtb3JpZW50OiBob3Jpem9udGFsO1xcbiAgLXdlYmtpdC1ib3gtZGlyZWN0aW9uOiByZXZlcnNlO1xcbiAgLW1zLWZsZXgtZGlyZWN0aW9uOiByb3ctcmV2ZXJzZTtcXG4gIGZsZXgtZGlyZWN0aW9uOiByb3ctcmV2ZXJzZTtcXG59XFxuLmNvbC5yZXZlcnNlIHtcXG4gIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7XFxuICAtd2Via2l0LWJveC1kaXJlY3Rpb246IHJldmVyc2U7XFxuICAtbXMtZmxleC1kaXJlY3Rpb246IGNvbHVtbi1yZXZlcnNlO1xcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbi1yZXZlcnNlO1xcbn1cXG4uY29sLXhzLFxcbi5jb2wteHMtMSxcXG4uY29sLXhzLTEwLFxcbi5jb2wteHMtMTEsXFxuLmNvbC14cy0xMixcXG4uY29sLXhzLTIsXFxuLmNvbC14cy0zLFxcbi5jb2wteHMtNCxcXG4uY29sLXhzLTUsXFxuLmNvbC14cy02LFxcbi5jb2wteHMtNyxcXG4uY29sLXhzLTgsXFxuLmNvbC14cy05LFxcbi5jb2wteHMtb2Zmc2V0LTAsXFxuLmNvbC14cy1vZmZzZXQtMSxcXG4uY29sLXhzLW9mZnNldC0xMCxcXG4uY29sLXhzLW9mZnNldC0xMSxcXG4uY29sLXhzLW9mZnNldC0xMixcXG4uY29sLXhzLW9mZnNldC0yLFxcbi5jb2wteHMtb2Zmc2V0LTMsXFxuLmNvbC14cy1vZmZzZXQtNCxcXG4uY29sLXhzLW9mZnNldC01LFxcbi5jb2wteHMtb2Zmc2V0LTYsXFxuLmNvbC14cy1vZmZzZXQtNyxcXG4uY29sLXhzLW9mZnNldC04LFxcbi5jb2wteHMtb2Zmc2V0LTkge1xcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gIC13ZWJraXQtYm94LWZsZXg6IDA7XFxuICAtbXMtZmxleDogMCAwIGF1dG87XFxuICBmbGV4OiAwIDAgYXV0bztcXG4gIHBhZGRpbmctcmlnaHQ6IC41cmVtO1xcbiAgcGFkZGluZy1sZWZ0OiAuNXJlbTtcXG59XFxuLmNvbC14cyB7XFxuICAtd2Via2l0LWJveC1mbGV4OiAxO1xcbiAgLW1zLWZsZXgtcG9zaXRpdmU6IDE7XFxuICBmbGV4LWdyb3c6IDE7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMDtcXG4gIGZsZXgtYmFzaXM6IDA7XFxuICBtYXgtd2lkdGg6IDEwMCU7XFxufVxcbi5jb2wteHMtMSB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogOC4zMzMzMzMzMyU7XFxuICBmbGV4LWJhc2lzOiA4LjMzMzMzMzMzJTtcXG4gIG1heC13aWR0aDogOC4zMzMzMzMzMyU7XFxufVxcbi5jb2wteHMtMiB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMTYuNjY2NjY2NjclO1xcbiAgZmxleC1iYXNpczogMTYuNjY2NjY2NjclO1xcbiAgbWF4LXdpZHRoOiAxNi42NjY2NjY2NyU7XFxufVxcbi5jb2wteHMtMyB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMjUlO1xcbiAgZmxleC1iYXNpczogMjUlO1xcbiAgbWF4LXdpZHRoOiAyNSU7XFxufVxcbi5jb2wteHMtNCB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMzMuMzMzMzMzMzMlO1xcbiAgZmxleC1iYXNpczogMzMuMzMzMzMzMzMlO1xcbiAgbWF4LXdpZHRoOiAzMy4zMzMzMzMzMyU7XFxufVxcbi5jb2wteHMtNSB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNDEuNjY2NjY2NjclO1xcbiAgZmxleC1iYXNpczogNDEuNjY2NjY2NjclO1xcbiAgbWF4LXdpZHRoOiA0MS42NjY2NjY2NyU7XFxufVxcbi5jb2wteHMtNiB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNTAlO1xcbiAgZmxleC1iYXNpczogNTAlO1xcbiAgbWF4LXdpZHRoOiA1MCU7XFxufVxcbi5jb2wteHMtNyB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNTguMzMzMzMzMzMlO1xcbiAgZmxleC1iYXNpczogNTguMzMzMzMzMzMlO1xcbiAgbWF4LXdpZHRoOiA1OC4zMzMzMzMzMyU7XFxufVxcbi5jb2wteHMtOCB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNjYuNjY2NjY2NjclO1xcbiAgZmxleC1iYXNpczogNjYuNjY2NjY2NjclO1xcbiAgbWF4LXdpZHRoOiA2Ni42NjY2NjY2NyU7XFxufVxcbi5jb2wteHMtOSB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNzUlO1xcbiAgZmxleC1iYXNpczogNzUlO1xcbiAgbWF4LXdpZHRoOiA3NSU7XFxufVxcbi5jb2wteHMtMTAge1xcbiAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDgzLjMzMzMzMzMzJTtcXG4gIGZsZXgtYmFzaXM6IDgzLjMzMzMzMzMzJTtcXG4gIG1heC13aWR0aDogODMuMzMzMzMzMzMlO1xcbn1cXG4uY29sLXhzLTExIHtcXG4gIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA5MS42NjY2NjY2NyU7XFxuICBmbGV4LWJhc2lzOiA5MS42NjY2NjY2NyU7XFxuICBtYXgtd2lkdGg6IDkxLjY2NjY2NjY3JTtcXG59XFxuLmNvbC14cy0xMiB7XFxuICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMTAwJTtcXG4gIGZsZXgtYmFzaXM6IDEwMCU7XFxuICBtYXgtd2lkdGg6IDEwMCU7XFxufVxcbi5jb2wteHMtb2Zmc2V0LTAge1xcbiAgbWFyZ2luLWxlZnQ6IDA7XFxufVxcbi5jb2wteHMtb2Zmc2V0LTEge1xcbiAgbWFyZ2luLWxlZnQ6IDguMzMzMzMzMzMlO1xcbn1cXG4uY29sLXhzLW9mZnNldC0yIHtcXG4gIG1hcmdpbi1sZWZ0OiAxNi42NjY2NjY2NyU7XFxufVxcbi5jb2wteHMtb2Zmc2V0LTMge1xcbiAgbWFyZ2luLWxlZnQ6IDI1JTtcXG59XFxuLmNvbC14cy1vZmZzZXQtNCB7XFxuICBtYXJnaW4tbGVmdDogMzMuMzMzMzMzMzMlO1xcbn1cXG4uY29sLXhzLW9mZnNldC01IHtcXG4gIG1hcmdpbi1sZWZ0OiA0MS42NjY2NjY2NyU7XFxufVxcbi5jb2wteHMtb2Zmc2V0LTYge1xcbiAgbWFyZ2luLWxlZnQ6IDUwJTtcXG59XFxuLmNvbC14cy1vZmZzZXQtNyB7XFxuICBtYXJnaW4tbGVmdDogNTguMzMzMzMzMzMlO1xcbn1cXG4uY29sLXhzLW9mZnNldC04IHtcXG4gIG1hcmdpbi1sZWZ0OiA2Ni42NjY2NjY2NyU7XFxufVxcbi5jb2wteHMtb2Zmc2V0LTkge1xcbiAgbWFyZ2luLWxlZnQ6IDc1JTtcXG59XFxuLmNvbC14cy1vZmZzZXQtMTAge1xcbiAgbWFyZ2luLWxlZnQ6IDgzLjMzMzMzMzMzJTtcXG59XFxuLmNvbC14cy1vZmZzZXQtMTEge1xcbiAgbWFyZ2luLWxlZnQ6IDkxLjY2NjY2NjY3JTtcXG59XFxuLnN0YXJ0LXhzIHtcXG4gIC13ZWJraXQtYm94LXBhY2s6IHN0YXJ0O1xcbiAgLW1zLWZsZXgtcGFjazogc3RhcnQ7XFxuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtc3RhcnQ7XFxuICB0ZXh0LWFsaWduOiBzdGFydDtcXG59XFxuLmNlbnRlci14cyB7XFxuICAtd2Via2l0LWJveC1wYWNrOiBjZW50ZXI7XFxuICAtbXMtZmxleC1wYWNrOiBjZW50ZXI7XFxuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuLmVuZC14cyB7XFxuICAtd2Via2l0LWJveC1wYWNrOiBlbmQ7XFxuICAtbXMtZmxleC1wYWNrOiBlbmQ7XFxuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xcbiAgdGV4dC1hbGlnbjogZW5kO1xcbn1cXG4udG9wLXhzIHtcXG4gIC13ZWJraXQtYm94LWFsaWduOiBzdGFydDtcXG4gIC1tcy1mbGV4LWFsaWduOiBzdGFydDtcXG4gIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xcbn1cXG4ubWlkZGxlLXhzIHtcXG4gIC13ZWJraXQtYm94LWFsaWduOiBjZW50ZXI7XFxuICAtbXMtZmxleC1hbGlnbjogY2VudGVyO1xcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG59XFxuLmJvdHRvbS14cyB7XFxuICAtd2Via2l0LWJveC1hbGlnbjogZW5kO1xcbiAgLW1zLWZsZXgtYWxpZ246IGVuZDtcXG4gIGFsaWduLWl0ZW1zOiBmbGV4LWVuZDtcXG59XFxuLmFyb3VuZC14cyB7XFxuICAtbXMtZmxleC1wYWNrOiBkaXN0cmlidXRlO1xcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XFxufVxcbi5iZXR3ZWVuLXhzIHtcXG4gIC13ZWJraXQtYm94LXBhY2s6IGp1c3RpZnk7XFxuICAtbXMtZmxleC1wYWNrOiBqdXN0aWZ5O1xcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xcbn1cXG4uZmlyc3QteHMge1xcbiAgLXdlYmtpdC1ib3gtb3JkaW5hbC1ncm91cDogMDtcXG4gIC1tcy1mbGV4LW9yZGVyOiAtMTtcXG4gIG9yZGVyOiAtMTtcXG59XFxuLmxhc3QteHMge1xcbiAgLXdlYmtpdC1ib3gtb3JkaW5hbC1ncm91cDogMjtcXG4gIC1tcy1mbGV4LW9yZGVyOiAxO1xcbiAgb3JkZXI6IDE7XFxufVxcbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDo0OGVtKSB7XFxuICAuY29udGFpbmVyIHtcXG4gICAgd2lkdGg6IDQ5cmVtO1xcbiAgfVxcblxcbiAgLmNvbC1zbSxcXG4gIC5jb2wtc20tMSxcXG4gIC5jb2wtc20tMTAsXFxuICAuY29sLXNtLTExLFxcbiAgLmNvbC1zbS0xMixcXG4gIC5jb2wtc20tMixcXG4gIC5jb2wtc20tMyxcXG4gIC5jb2wtc20tNCxcXG4gIC5jb2wtc20tNSxcXG4gIC5jb2wtc20tNixcXG4gIC5jb2wtc20tNyxcXG4gIC5jb2wtc20tOCxcXG4gIC5jb2wtc20tOSxcXG4gIC5jb2wtc20tb2Zmc2V0LTAsXFxuICAuY29sLXNtLW9mZnNldC0xLFxcbiAgLmNvbC1zbS1vZmZzZXQtMTAsXFxuICAuY29sLXNtLW9mZnNldC0xMSxcXG4gIC5jb2wtc20tb2Zmc2V0LTEyLFxcbiAgLmNvbC1zbS1vZmZzZXQtMixcXG4gIC5jb2wtc20tb2Zmc2V0LTMsXFxuICAuY29sLXNtLW9mZnNldC00LFxcbiAgLmNvbC1zbS1vZmZzZXQtNSxcXG4gIC5jb2wtc20tb2Zmc2V0LTYsXFxuICAuY29sLXNtLW9mZnNldC03LFxcbiAgLmNvbC1zbS1vZmZzZXQtOCxcXG4gIC5jb2wtc20tb2Zmc2V0LTkge1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICAtd2Via2l0LWJveC1mbGV4OiAwO1xcbiAgICAtbXMtZmxleDogMCAwIGF1dG87XFxuICAgIGZsZXg6IDAgMCBhdXRvO1xcbiAgICBwYWRkaW5nLXJpZ2h0OiAuNXJlbTtcXG4gICAgcGFkZGluZy1sZWZ0OiAuNXJlbTtcXG4gIH1cXG5cXG4gIC5jb2wtc20ge1xcbiAgICAtd2Via2l0LWJveC1mbGV4OiAxO1xcbiAgICAtbXMtZmxleC1wb3NpdGl2ZTogMTtcXG4gICAgZmxleC1ncm93OiAxO1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMDtcXG4gICAgZmxleC1iYXNpczogMDtcXG4gICAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgfVxcblxcbiAgLmNvbC1zbS0xIHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDguMzMzMzMzMzMlO1xcbiAgICBmbGV4LWJhc2lzOiA4LjMzMzMzMzMzJTtcXG4gICAgbWF4LXdpZHRoOiA4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tMiB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiAxNi42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDE2LjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiAxNi42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLXNtLTMge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMjUlO1xcbiAgICBmbGV4LWJhc2lzOiAyNSU7XFxuICAgIG1heC13aWR0aDogMjUlO1xcbiAgfVxcblxcbiAgLmNvbC1zbS00IHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDMzLjMzMzMzMzMzJTtcXG4gICAgZmxleC1iYXNpczogMzMuMzMzMzMzMzMlO1xcbiAgICBtYXgtd2lkdGg6IDMzLjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tNSB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA0MS42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDQxLjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiA0MS42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLXNtLTYge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNTAlO1xcbiAgICBmbGV4LWJhc2lzOiA1MCU7XFxuICAgIG1heC13aWR0aDogNTAlO1xcbiAgfVxcblxcbiAgLmNvbC1zbS03IHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDU4LjMzMzMzMzMzJTtcXG4gICAgZmxleC1iYXNpczogNTguMzMzMzMzMzMlO1xcbiAgICBtYXgtd2lkdGg6IDU4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tOCB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA2Ni42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDY2LjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiA2Ni42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLXNtLTkge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNzUlO1xcbiAgICBmbGV4LWJhc2lzOiA3NSU7XFxuICAgIG1heC13aWR0aDogNzUlO1xcbiAgfVxcblxcbiAgLmNvbC1zbS0xMCB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA4My4zMzMzMzMzMyU7XFxuICAgIGZsZXgtYmFzaXM6IDgzLjMzMzMzMzMzJTtcXG4gICAgbWF4LXdpZHRoOiA4My4zMzMzMzMzMyU7XFxuICB9XFxuXFxuICAuY29sLXNtLTExIHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDkxLjY2NjY2NjY3JTtcXG4gICAgZmxleC1iYXNpczogOTEuNjY2NjY2NjclO1xcbiAgICBtYXgtd2lkdGg6IDkxLjY2NjY2NjY3JTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tMTIge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMTAwJTtcXG4gICAgZmxleC1iYXNpczogMTAwJTtcXG4gICAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgfVxcblxcbiAgLmNvbC1zbS1vZmZzZXQtMCB7XFxuICAgIG1hcmdpbi1sZWZ0OiAwO1xcbiAgfVxcblxcbiAgLmNvbC1zbS1vZmZzZXQtMSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tb2Zmc2V0LTIge1xcbiAgICBtYXJnaW4tbGVmdDogMTYuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1zbS1vZmZzZXQtMyB7XFxuICAgIG1hcmdpbi1sZWZ0OiAyNSU7XFxuICB9XFxuXFxuICAuY29sLXNtLW9mZnNldC00IHtcXG4gICAgbWFyZ2luLWxlZnQ6IDMzLjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tb2Zmc2V0LTUge1xcbiAgICBtYXJnaW4tbGVmdDogNDEuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1zbS1vZmZzZXQtNiB7XFxuICAgIG1hcmdpbi1sZWZ0OiA1MCU7XFxuICB9XFxuXFxuICAuY29sLXNtLW9mZnNldC03IHtcXG4gICAgbWFyZ2luLWxlZnQ6IDU4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtc20tb2Zmc2V0LTgge1xcbiAgICBtYXJnaW4tbGVmdDogNjYuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1zbS1vZmZzZXQtOSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA3NSU7XFxuICB9XFxuXFxuICAuY29sLXNtLW9mZnNldC0xMCB7XFxuICAgIG1hcmdpbi1sZWZ0OiA4My4zMzMzMzMzMyU7XFxuICB9XFxuXFxuICAuY29sLXNtLW9mZnNldC0xMSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA5MS42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuc3RhcnQtc20ge1xcbiAgICAtd2Via2l0LWJveC1wYWNrOiBzdGFydDtcXG4gICAgLW1zLWZsZXgtcGFjazogc3RhcnQ7XFxuICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcXG4gICAgdGV4dC1hbGlnbjogc3RhcnQ7XFxuICB9XFxuXFxuICAuY2VudGVyLXNtIHtcXG4gICAgLXdlYmtpdC1ib3gtcGFjazogY2VudGVyO1xcbiAgICAtbXMtZmxleC1wYWNrOiBjZW50ZXI7XFxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICB9XFxuXFxuICAuZW5kLXNtIHtcXG4gICAgLXdlYmtpdC1ib3gtcGFjazogZW5kO1xcbiAgICAtbXMtZmxleC1wYWNrOiBlbmQ7XFxuICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XFxuICAgIHRleHQtYWxpZ246IGVuZDtcXG4gIH1cXG5cXG4gIC50b3Atc20ge1xcbiAgICAtd2Via2l0LWJveC1hbGlnbjogc3RhcnQ7XFxuICAgIC1tcy1mbGV4LWFsaWduOiBzdGFydDtcXG4gICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XFxuICB9XFxuXFxuICAubWlkZGxlLXNtIHtcXG4gICAgLXdlYmtpdC1ib3gtYWxpZ246IGNlbnRlcjtcXG4gICAgLW1zLWZsZXgtYWxpZ246IGNlbnRlcjtcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gIH1cXG5cXG4gIC5ib3R0b20tc20ge1xcbiAgICAtd2Via2l0LWJveC1hbGlnbjogZW5kO1xcbiAgICAtbXMtZmxleC1hbGlnbjogZW5kO1xcbiAgICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XFxuICB9XFxuXFxuICAuYXJvdW5kLXNtIHtcXG4gICAgLW1zLWZsZXgtcGFjazogZGlzdHJpYnV0ZTtcXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XFxuICB9XFxuXFxuICAuYmV0d2Vlbi1zbSB7XFxuICAgIC13ZWJraXQtYm94LXBhY2s6IGp1c3RpZnk7XFxuICAgIC1tcy1mbGV4LXBhY2s6IGp1c3RpZnk7XFxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcXG4gIH1cXG5cXG4gIC5maXJzdC1zbSB7XFxuICAgIC13ZWJraXQtYm94LW9yZGluYWwtZ3JvdXA6IDA7XFxuICAgIC1tcy1mbGV4LW9yZGVyOiAtMTtcXG4gICAgb3JkZXI6IC0xO1xcbiAgfVxcblxcbiAgLmxhc3Qtc20ge1xcbiAgICAtd2Via2l0LWJveC1vcmRpbmFsLWdyb3VwOiAyO1xcbiAgICAtbXMtZmxleC1vcmRlcjogMTtcXG4gICAgb3JkZXI6IDE7XFxuICB9XFxufVxcbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDo2NGVtKSB7XFxuICAuY29udGFpbmVyIHtcXG4gICAgd2lkdGg6IDY1cmVtO1xcbiAgfVxcblxcbiAgLmNvbC1tZCxcXG4gIC5jb2wtbWQtMSxcXG4gIC5jb2wtbWQtMTAsXFxuICAuY29sLW1kLTExLFxcbiAgLmNvbC1tZC0xMixcXG4gIC5jb2wtbWQtMixcXG4gIC5jb2wtbWQtMyxcXG4gIC5jb2wtbWQtNCxcXG4gIC5jb2wtbWQtNSxcXG4gIC5jb2wtbWQtNixcXG4gIC5jb2wtbWQtNyxcXG4gIC5jb2wtbWQtOCxcXG4gIC5jb2wtbWQtOSxcXG4gIC5jb2wtbWQtb2Zmc2V0LTAsXFxuICAuY29sLW1kLW9mZnNldC0xLFxcbiAgLmNvbC1tZC1vZmZzZXQtMTAsXFxuICAuY29sLW1kLW9mZnNldC0xMSxcXG4gIC5jb2wtbWQtb2Zmc2V0LTEyLFxcbiAgLmNvbC1tZC1vZmZzZXQtMixcXG4gIC5jb2wtbWQtb2Zmc2V0LTMsXFxuICAuY29sLW1kLW9mZnNldC00LFxcbiAgLmNvbC1tZC1vZmZzZXQtNSxcXG4gIC5jb2wtbWQtb2Zmc2V0LTYsXFxuICAuY29sLW1kLW9mZnNldC03LFxcbiAgLmNvbC1tZC1vZmZzZXQtOCxcXG4gIC5jb2wtbWQtb2Zmc2V0LTkge1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICAtd2Via2l0LWJveC1mbGV4OiAwO1xcbiAgICAtbXMtZmxleDogMCAwIGF1dG87XFxuICAgIGZsZXg6IDAgMCBhdXRvO1xcbiAgICBwYWRkaW5nLXJpZ2h0OiAuNXJlbTtcXG4gICAgcGFkZGluZy1sZWZ0OiAuNXJlbTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQge1xcbiAgICAtd2Via2l0LWJveC1mbGV4OiAxO1xcbiAgICAtbXMtZmxleC1wb3NpdGl2ZTogMTtcXG4gICAgZmxleC1ncm93OiAxO1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMDtcXG4gICAgZmxleC1iYXNpczogMDtcXG4gICAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgfVxcblxcbiAgLmNvbC1tZC0xIHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDguMzMzMzMzMzMlO1xcbiAgICBmbGV4LWJhc2lzOiA4LjMzMzMzMzMzJTtcXG4gICAgbWF4LXdpZHRoOiA4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtMiB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiAxNi42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDE2LjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiAxNi42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLW1kLTMge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMjUlO1xcbiAgICBmbGV4LWJhc2lzOiAyNSU7XFxuICAgIG1heC13aWR0aDogMjUlO1xcbiAgfVxcblxcbiAgLmNvbC1tZC00IHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDMzLjMzMzMzMzMzJTtcXG4gICAgZmxleC1iYXNpczogMzMuMzMzMzMzMzMlO1xcbiAgICBtYXgtd2lkdGg6IDMzLjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtNSB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA0MS42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDQxLjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiA0MS42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLW1kLTYge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNTAlO1xcbiAgICBmbGV4LWJhc2lzOiA1MCU7XFxuICAgIG1heC13aWR0aDogNTAlO1xcbiAgfVxcblxcbiAgLmNvbC1tZC03IHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDU4LjMzMzMzMzMzJTtcXG4gICAgZmxleC1iYXNpczogNTguMzMzMzMzMzMlO1xcbiAgICBtYXgtd2lkdGg6IDU4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtOCB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA2Ni42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDY2LjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiA2Ni42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLW1kLTkge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNzUlO1xcbiAgICBmbGV4LWJhc2lzOiA3NSU7XFxuICAgIG1heC13aWR0aDogNzUlO1xcbiAgfVxcblxcbiAgLmNvbC1tZC0xMCB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA4My4zMzMzMzMzMyU7XFxuICAgIGZsZXgtYmFzaXM6IDgzLjMzMzMzMzMzJTtcXG4gICAgbWF4LXdpZHRoOiA4My4zMzMzMzMzMyU7XFxuICB9XFxuXFxuICAuY29sLW1kLTExIHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDkxLjY2NjY2NjY3JTtcXG4gICAgZmxleC1iYXNpczogOTEuNjY2NjY2NjclO1xcbiAgICBtYXgtd2lkdGg6IDkxLjY2NjY2NjY3JTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtMTIge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMTAwJTtcXG4gICAgZmxleC1iYXNpczogMTAwJTtcXG4gICAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgfVxcblxcbiAgLmNvbC1tZC1vZmZzZXQtMCB7XFxuICAgIG1hcmdpbi1sZWZ0OiAwO1xcbiAgfVxcblxcbiAgLmNvbC1tZC1vZmZzZXQtMSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtb2Zmc2V0LTIge1xcbiAgICBtYXJnaW4tbGVmdDogMTYuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1tZC1vZmZzZXQtMyB7XFxuICAgIG1hcmdpbi1sZWZ0OiAyNSU7XFxuICB9XFxuXFxuICAuY29sLW1kLW9mZnNldC00IHtcXG4gICAgbWFyZ2luLWxlZnQ6IDMzLjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtb2Zmc2V0LTUge1xcbiAgICBtYXJnaW4tbGVmdDogNDEuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1tZC1vZmZzZXQtNiB7XFxuICAgIG1hcmdpbi1sZWZ0OiA1MCU7XFxuICB9XFxuXFxuICAuY29sLW1kLW9mZnNldC03IHtcXG4gICAgbWFyZ2luLWxlZnQ6IDU4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbWQtb2Zmc2V0LTgge1xcbiAgICBtYXJnaW4tbGVmdDogNjYuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1tZC1vZmZzZXQtOSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA3NSU7XFxuICB9XFxuXFxuICAuY29sLW1kLW9mZnNldC0xMCB7XFxuICAgIG1hcmdpbi1sZWZ0OiA4My4zMzMzMzMzMyU7XFxuICB9XFxuXFxuICAuY29sLW1kLW9mZnNldC0xMSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA5MS42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuc3RhcnQtbWQge1xcbiAgICAtd2Via2l0LWJveC1wYWNrOiBzdGFydDtcXG4gICAgLW1zLWZsZXgtcGFjazogc3RhcnQ7XFxuICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcXG4gICAgdGV4dC1hbGlnbjogc3RhcnQ7XFxuICB9XFxuXFxuICAuY2VudGVyLW1kIHtcXG4gICAgLXdlYmtpdC1ib3gtcGFjazogY2VudGVyO1xcbiAgICAtbXMtZmxleC1wYWNrOiBjZW50ZXI7XFxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICB9XFxuXFxuICAuZW5kLW1kIHtcXG4gICAgLXdlYmtpdC1ib3gtcGFjazogZW5kO1xcbiAgICAtbXMtZmxleC1wYWNrOiBlbmQ7XFxuICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XFxuICAgIHRleHQtYWxpZ246IGVuZDtcXG4gIH1cXG5cXG4gIC50b3AtbWQge1xcbiAgICAtd2Via2l0LWJveC1hbGlnbjogc3RhcnQ7XFxuICAgIC1tcy1mbGV4LWFsaWduOiBzdGFydDtcXG4gICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XFxuICB9XFxuXFxuICAubWlkZGxlLW1kIHtcXG4gICAgLXdlYmtpdC1ib3gtYWxpZ246IGNlbnRlcjtcXG4gICAgLW1zLWZsZXgtYWxpZ246IGNlbnRlcjtcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gIH1cXG5cXG4gIC5ib3R0b20tbWQge1xcbiAgICAtd2Via2l0LWJveC1hbGlnbjogZW5kO1xcbiAgICAtbXMtZmxleC1hbGlnbjogZW5kO1xcbiAgICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XFxuICB9XFxuXFxuICAuYXJvdW5kLW1kIHtcXG4gICAgLW1zLWZsZXgtcGFjazogZGlzdHJpYnV0ZTtcXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XFxuICB9XFxuXFxuICAuYmV0d2Vlbi1tZCB7XFxuICAgIC13ZWJraXQtYm94LXBhY2s6IGp1c3RpZnk7XFxuICAgIC1tcy1mbGV4LXBhY2s6IGp1c3RpZnk7XFxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcXG4gIH1cXG5cXG4gIC5maXJzdC1tZCB7XFxuICAgIC13ZWJraXQtYm94LW9yZGluYWwtZ3JvdXA6IDA7XFxuICAgIC1tcy1mbGV4LW9yZGVyOiAtMTtcXG4gICAgb3JkZXI6IC0xO1xcbiAgfVxcblxcbiAgLmxhc3QtbWQge1xcbiAgICAtd2Via2l0LWJveC1vcmRpbmFsLWdyb3VwOiAyO1xcbiAgICAtbXMtZmxleC1vcmRlcjogMTtcXG4gICAgb3JkZXI6IDE7XFxuICB9XFxufVxcbkBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDo3NWVtKSB7XFxuICAuY29udGFpbmVyIHtcXG4gICAgd2lkdGg6IDc2cmVtO1xcbiAgfVxcblxcbiAgLmNvbC1sZyxcXG4gIC5jb2wtbGctMSxcXG4gIC5jb2wtbGctMTAsXFxuICAuY29sLWxnLTExLFxcbiAgLmNvbC1sZy0xMixcXG4gIC5jb2wtbGctMixcXG4gIC5jb2wtbGctMyxcXG4gIC5jb2wtbGctNCxcXG4gIC5jb2wtbGctNSxcXG4gIC5jb2wtbGctNixcXG4gIC5jb2wtbGctNyxcXG4gIC5jb2wtbGctOCxcXG4gIC5jb2wtbGctOSxcXG4gIC5jb2wtbGctb2Zmc2V0LTAsXFxuICAuY29sLWxnLW9mZnNldC0xLFxcbiAgLmNvbC1sZy1vZmZzZXQtMTAsXFxuICAuY29sLWxnLW9mZnNldC0xMSxcXG4gIC5jb2wtbGctb2Zmc2V0LTEyLFxcbiAgLmNvbC1sZy1vZmZzZXQtMixcXG4gIC5jb2wtbGctb2Zmc2V0LTMsXFxuICAuY29sLWxnLW9mZnNldC00LFxcbiAgLmNvbC1sZy1vZmZzZXQtNSxcXG4gIC5jb2wtbGctb2Zmc2V0LTYsXFxuICAuY29sLWxnLW9mZnNldC03LFxcbiAgLmNvbC1sZy1vZmZzZXQtOCxcXG4gIC5jb2wtbGctb2Zmc2V0LTkge1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICAtd2Via2l0LWJveC1mbGV4OiAwO1xcbiAgICAtbXMtZmxleDogMCAwIGF1dG87XFxuICAgIGZsZXg6IDAgMCBhdXRvO1xcbiAgICBwYWRkaW5nLXJpZ2h0OiAuNXJlbTtcXG4gICAgcGFkZGluZy1sZWZ0OiAuNXJlbTtcXG4gIH1cXG5cXG4gIC5jb2wtbGcge1xcbiAgICAtd2Via2l0LWJveC1mbGV4OiAxO1xcbiAgICAtbXMtZmxleC1wb3NpdGl2ZTogMTtcXG4gICAgZmxleC1ncm93OiAxO1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMDtcXG4gICAgZmxleC1iYXNpczogMDtcXG4gICAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgfVxcblxcbiAgLmNvbC1sZy0xIHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDguMzMzMzMzMzMlO1xcbiAgICBmbGV4LWJhc2lzOiA4LjMzMzMzMzMzJTtcXG4gICAgbWF4LXdpZHRoOiA4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctMiB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiAxNi42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDE2LjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiAxNi42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLWxnLTMge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMjUlO1xcbiAgICBmbGV4LWJhc2lzOiAyNSU7XFxuICAgIG1heC13aWR0aDogMjUlO1xcbiAgfVxcblxcbiAgLmNvbC1sZy00IHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDMzLjMzMzMzMzMzJTtcXG4gICAgZmxleC1iYXNpczogMzMuMzMzMzMzMzMlO1xcbiAgICBtYXgtd2lkdGg6IDMzLjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctNSB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA0MS42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDQxLjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiA0MS42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLWxnLTYge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNTAlO1xcbiAgICBmbGV4LWJhc2lzOiA1MCU7XFxuICAgIG1heC13aWR0aDogNTAlO1xcbiAgfVxcblxcbiAgLmNvbC1sZy03IHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDU4LjMzMzMzMzMzJTtcXG4gICAgZmxleC1iYXNpczogNTguMzMzMzMzMzMlO1xcbiAgICBtYXgtd2lkdGg6IDU4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctOCB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA2Ni42NjY2NjY2NyU7XFxuICAgIGZsZXgtYmFzaXM6IDY2LjY2NjY2NjY3JTtcXG4gICAgbWF4LXdpZHRoOiA2Ni42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuY29sLWxnLTkge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogNzUlO1xcbiAgICBmbGV4LWJhc2lzOiA3NSU7XFxuICAgIG1heC13aWR0aDogNzUlO1xcbiAgfVxcblxcbiAgLmNvbC1sZy0xMCB7XFxuICAgIC1tcy1mbGV4LXByZWZlcnJlZC1zaXplOiA4My4zMzMzMzMzMyU7XFxuICAgIGZsZXgtYmFzaXM6IDgzLjMzMzMzMzMzJTtcXG4gICAgbWF4LXdpZHRoOiA4My4zMzMzMzMzMyU7XFxuICB9XFxuXFxuICAuY29sLWxnLTExIHtcXG4gICAgLW1zLWZsZXgtcHJlZmVycmVkLXNpemU6IDkxLjY2NjY2NjY3JTtcXG4gICAgZmxleC1iYXNpczogOTEuNjY2NjY2NjclO1xcbiAgICBtYXgtd2lkdGg6IDkxLjY2NjY2NjY3JTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctMTIge1xcbiAgICAtbXMtZmxleC1wcmVmZXJyZWQtc2l6ZTogMTAwJTtcXG4gICAgZmxleC1iYXNpczogMTAwJTtcXG4gICAgbWF4LXdpZHRoOiAxMDAlO1xcbiAgfVxcblxcbiAgLmNvbC1sZy1vZmZzZXQtMCB7XFxuICAgIG1hcmdpbi1sZWZ0OiAwO1xcbiAgfVxcblxcbiAgLmNvbC1sZy1vZmZzZXQtMSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctb2Zmc2V0LTIge1xcbiAgICBtYXJnaW4tbGVmdDogMTYuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1sZy1vZmZzZXQtMyB7XFxuICAgIG1hcmdpbi1sZWZ0OiAyNSU7XFxuICB9XFxuXFxuICAuY29sLWxnLW9mZnNldC00IHtcXG4gICAgbWFyZ2luLWxlZnQ6IDMzLjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctb2Zmc2V0LTUge1xcbiAgICBtYXJnaW4tbGVmdDogNDEuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1sZy1vZmZzZXQtNiB7XFxuICAgIG1hcmdpbi1sZWZ0OiA1MCU7XFxuICB9XFxuXFxuICAuY29sLWxnLW9mZnNldC03IHtcXG4gICAgbWFyZ2luLWxlZnQ6IDU4LjMzMzMzMzMzJTtcXG4gIH1cXG5cXG4gIC5jb2wtbGctb2Zmc2V0LTgge1xcbiAgICBtYXJnaW4tbGVmdDogNjYuNjY2NjY2NjclO1xcbiAgfVxcblxcbiAgLmNvbC1sZy1vZmZzZXQtOSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA3NSU7XFxuICB9XFxuXFxuICAuY29sLWxnLW9mZnNldC0xMCB7XFxuICAgIG1hcmdpbi1sZWZ0OiA4My4zMzMzMzMzMyU7XFxuICB9XFxuXFxuICAuY29sLWxnLW9mZnNldC0xMSB7XFxuICAgIG1hcmdpbi1sZWZ0OiA5MS42NjY2NjY2NyU7XFxuICB9XFxuXFxuICAuc3RhcnQtbGcge1xcbiAgICAtd2Via2l0LWJveC1wYWNrOiBzdGFydDtcXG4gICAgLW1zLWZsZXgtcGFjazogc3RhcnQ7XFxuICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcXG4gICAgdGV4dC1hbGlnbjogc3RhcnQ7XFxuICB9XFxuXFxuICAuY2VudGVyLWxnIHtcXG4gICAgLXdlYmtpdC1ib3gtcGFjazogY2VudGVyO1xcbiAgICAtbXMtZmxleC1wYWNrOiBjZW50ZXI7XFxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICB9XFxuXFxuICAuZW5kLWxnIHtcXG4gICAgLXdlYmtpdC1ib3gtcGFjazogZW5kO1xcbiAgICAtbXMtZmxleC1wYWNrOiBlbmQ7XFxuICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XFxuICAgIHRleHQtYWxpZ246IGVuZDtcXG4gIH1cXG5cXG4gIC50b3AtbGcge1xcbiAgICAtd2Via2l0LWJveC1hbGlnbjogc3RhcnQ7XFxuICAgIC1tcy1mbGV4LWFsaWduOiBzdGFydDtcXG4gICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XFxuICB9XFxuXFxuICAubWlkZGxlLWxnIHtcXG4gICAgLXdlYmtpdC1ib3gtYWxpZ246IGNlbnRlcjtcXG4gICAgLW1zLWZsZXgtYWxpZ246IGNlbnRlcjtcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gIH1cXG5cXG4gIC5ib3R0b20tbGcge1xcbiAgICAtd2Via2l0LWJveC1hbGlnbjogZW5kO1xcbiAgICAtbXMtZmxleC1hbGlnbjogZW5kO1xcbiAgICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XFxuICB9XFxuXFxuICAuYXJvdW5kLWxnIHtcXG4gICAgLW1zLWZsZXgtcGFjazogZGlzdHJpYnV0ZTtcXG4gICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XFxuICB9XFxuXFxuICAuYmV0d2Vlbi1sZyB7XFxuICAgIC13ZWJraXQtYm94LXBhY2s6IGp1c3RpZnk7XFxuICAgIC1tcy1mbGV4LXBhY2s6IGp1c3RpZnk7XFxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcXG4gIH1cXG5cXG4gIC5maXJzdC1sZyB7XFxuICAgIC13ZWJraXQtYm94LW9yZGluYWwtZ3JvdXA6IDA7XFxuICAgIC1tcy1mbGV4LW9yZGVyOiAtMTtcXG4gICAgb3JkZXI6IC0xO1xcbiAgfVxcblxcbiAgLmxhc3QtbGcge1xcbiAgICAtd2Via2l0LWJveC1vcmRpbmFsLWdyb3VwOiAyO1xcbiAgICAtbXMtZmxleC1vcmRlcjogMTtcXG4gICAgb3JkZXI6IDE7XFxuICB9XFxufVxcblwiOyAocmVxdWlyZShcImJyb3dzZXJpZnktY3NzXCIpLmNyZWF0ZVN0eWxlKGNzcywgeyBcImhyZWZcIjogXCJkZXBlbmRlbmNpZXNcXFxcZmxleGJveGdyaWRcXFxcZmxleGJveGdyaWQubWluLmNzc1wiIH0sIHsgXCJpbnNlcnRBdFwiOiBcImJvdHRvbVwiIH0pKTsgbW9kdWxlLmV4cG9ydHMgPSBjc3M7IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBhdG9hIChhLCBuKSB7IHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhLCBuKTsgfVxuIiwiJ3VzZSBzdHJpY3QnO1xuLy8gRm9yIG1vcmUgaW5mb3JtYXRpb24gYWJvdXQgYnJvd3NlciBmaWVsZCwgY2hlY2sgb3V0IHRoZSBicm93c2VyIGZpZWxkIGF0IGh0dHBzOi8vZ2l0aHViLmNvbS9zdWJzdGFjay9icm93c2VyaWZ5LWhhbmRib29rI2Jyb3dzZXItZmllbGQuXG5cbnZhciBzdHlsZUVsZW1lbnRzSW5zZXJ0ZWRBdFRvcCA9IFtdO1xuXG52YXIgaW5zZXJ0U3R5bGVFbGVtZW50ID0gZnVuY3Rpb24oc3R5bGVFbGVtZW50LCBvcHRpb25zKSB7XG4gICAgdmFyIGhlYWQgPSBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF07XG4gICAgdmFyIGxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wID0gc3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3Bbc3R5bGVFbGVtZW50c0luc2VydGVkQXRUb3AubGVuZ3RoIC0gMV07XG5cbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgICBvcHRpb25zLmluc2VydEF0ID0gb3B0aW9ucy5pbnNlcnRBdCB8fCAnYm90dG9tJztcblxuICAgIGlmIChvcHRpb25zLmluc2VydEF0ID09PSAndG9wJykge1xuICAgICAgICBpZiAoIWxhc3RTdHlsZUVsZW1lbnRJbnNlcnRlZEF0VG9wKSB7XG4gICAgICAgICAgICBoZWFkLmluc2VydEJlZm9yZShzdHlsZUVsZW1lbnQsIGhlYWQuZmlyc3RDaGlsZCk7XG4gICAgICAgIH0gZWxzZSBpZiAobGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKHN0eWxlRWxlbWVudCwgbGFzdFN0eWxlRWxlbWVudEluc2VydGVkQXRUb3AubmV4dFNpYmxpbmcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHN0eWxlRWxlbWVudHNJbnNlcnRlZEF0VG9wLnB1c2goc3R5bGVFbGVtZW50KTtcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuaW5zZXJ0QXQgPT09ICdib3R0b20nKSB7XG4gICAgICAgIGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yIHBhcmFtZXRlciBcXCdpbnNlcnRBdFxcJy4gTXVzdCBiZSBcXCd0b3BcXCcgb3IgXFwnYm90dG9tXFwnLicpO1xuICAgIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIC8vIENyZWF0ZSBhIDxsaW5rPiB0YWcgd2l0aCBvcHRpb25hbCBkYXRhIGF0dHJpYnV0ZXNcbiAgICBjcmVhdGVMaW5rOiBmdW5jdGlvbihocmVmLCBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHZhciBoZWFkID0gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdO1xuICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcblxuICAgICAgICBsaW5rLmhyZWYgPSBocmVmO1xuICAgICAgICBsaW5rLnJlbCA9ICdzdHlsZXNoZWV0JztcblxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICAgICAgaWYgKCAhIGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2RhdGEtJyArIGtleSwgdmFsdWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaGVhZC5hcHBlbmRDaGlsZChsaW5rKTtcbiAgICB9LFxuICAgIC8vIENyZWF0ZSBhIDxzdHlsZT4gdGFnIHdpdGggb3B0aW9uYWwgZGF0YSBhdHRyaWJ1dGVzXG4gICAgY3JlYXRlU3R5bGU6IGZ1bmN0aW9uKGNzc1RleHQsIGF0dHJpYnV0ZXMsIGV4dHJhT3B0aW9ucykge1xuICAgICAgICBleHRyYU9wdGlvbnMgPSBleHRyYU9wdGlvbnMgfHwge307XG5cbiAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgc3R5bGUudHlwZSA9ICd0ZXh0L2Nzcyc7XG5cbiAgICAgICAgZm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGlmICggISBhdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgICAgIHN0eWxlLnNldEF0dHJpYnV0ZSgnZGF0YS0nICsga2V5LCB2YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3R5bGUuc2hlZXQpIHsgLy8gZm9yIGpzZG9tIGFuZCBJRTkrXG4gICAgICAgICAgICBzdHlsZS5pbm5lckhUTUwgPSBjc3NUZXh0O1xuICAgICAgICAgICAgc3R5bGUuc2hlZXQuY3NzVGV4dCA9IGNzc1RleHQ7XG4gICAgICAgICAgICBpbnNlcnRTdHlsZUVsZW1lbnQoc3R5bGUsIHsgaW5zZXJ0QXQ6IGV4dHJhT3B0aW9ucy5pbnNlcnRBdCB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChzdHlsZS5zdHlsZVNoZWV0KSB7IC8vIGZvciBJRTggYW5kIGJlbG93XG4gICAgICAgICAgICBpbnNlcnRTdHlsZUVsZW1lbnQoc3R5bGUsIHsgaW5zZXJ0QXQ6IGV4dHJhT3B0aW9ucy5pbnNlcnRBdCB9KTtcbiAgICAgICAgICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzc1RleHQ7XG4gICAgICAgIH0gZWxzZSB7IC8vIGZvciBDaHJvbWUsIEZpcmVmb3gsIGFuZCBTYWZhcmlcbiAgICAgICAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzc1RleHQpKTtcbiAgICAgICAgICAgIGluc2VydFN0eWxlRWxlbWVudChzdHlsZSwgeyBpbnNlcnRBdDogZXh0cmFPcHRpb25zLmluc2VydEF0IH0pO1xuICAgICAgICB9XG4gICAgfVxufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHRpY2t5ID0gcmVxdWlyZSgndGlja3knKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkZWJvdW5jZSAoZm4sIGFyZ3MsIGN0eCkge1xuICBpZiAoIWZuKSB7IHJldHVybjsgfVxuICB0aWNreShmdW5jdGlvbiBydW4gKCkge1xuICAgIGZuLmFwcGx5KGN0eCB8fCBudWxsLCBhcmdzIHx8IFtdKTtcbiAgfSk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXRvYSA9IHJlcXVpcmUoJ2F0b2EnKTtcbnZhciBkZWJvdW5jZSA9IHJlcXVpcmUoJy4vZGVib3VuY2UnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlbWl0dGVyICh0aGluZywgb3B0aW9ucykge1xuICB2YXIgb3B0cyA9IG9wdGlvbnMgfHwge307XG4gIHZhciBldnQgPSB7fTtcbiAgaWYgKHRoaW5nID09PSB1bmRlZmluZWQpIHsgdGhpbmcgPSB7fTsgfVxuICB0aGluZy5vbiA9IGZ1bmN0aW9uICh0eXBlLCBmbikge1xuICAgIGlmICghZXZ0W3R5cGVdKSB7XG4gICAgICBldnRbdHlwZV0gPSBbZm5dO1xuICAgIH0gZWxzZSB7XG4gICAgICBldnRbdHlwZV0ucHVzaChmbik7XG4gICAgfVxuICAgIHJldHVybiB0aGluZztcbiAgfTtcbiAgdGhpbmcub25jZSA9IGZ1bmN0aW9uICh0eXBlLCBmbikge1xuICAgIGZuLl9vbmNlID0gdHJ1ZTsgLy8gdGhpbmcub2ZmKGZuKSBzdGlsbCB3b3JrcyFcbiAgICB0aGluZy5vbih0eXBlLCBmbik7XG4gICAgcmV0dXJuIHRoaW5nO1xuICB9O1xuICB0aGluZy5vZmYgPSBmdW5jdGlvbiAodHlwZSwgZm4pIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgaWYgKGMgPT09IDEpIHtcbiAgICAgIGRlbGV0ZSBldnRbdHlwZV07XG4gICAgfSBlbHNlIGlmIChjID09PSAwKSB7XG4gICAgICBldnQgPSB7fTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGV0ID0gZXZ0W3R5cGVdO1xuICAgICAgaWYgKCFldCkgeyByZXR1cm4gdGhpbmc7IH1cbiAgICAgIGV0LnNwbGljZShldC5pbmRleE9mKGZuKSwgMSk7XG4gICAgfVxuICAgIHJldHVybiB0aGluZztcbiAgfTtcbiAgdGhpbmcuZW1pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXJncyA9IGF0b2EoYXJndW1lbnRzKTtcbiAgICByZXR1cm4gdGhpbmcuZW1pdHRlclNuYXBzaG90KGFyZ3Muc2hpZnQoKSkuYXBwbHkodGhpcywgYXJncyk7XG4gIH07XG4gIHRoaW5nLmVtaXR0ZXJTbmFwc2hvdCA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgdmFyIGV0ID0gKGV2dFt0eXBlXSB8fCBbXSkuc2xpY2UoMCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBhcmdzID0gYXRvYShhcmd1bWVudHMpO1xuICAgICAgdmFyIGN0eCA9IHRoaXMgfHwgdGhpbmc7XG4gICAgICBpZiAodHlwZSA9PT0gJ2Vycm9yJyAmJiBvcHRzLnRocm93cyAhPT0gZmFsc2UgJiYgIWV0Lmxlbmd0aCkgeyB0aHJvdyBhcmdzLmxlbmd0aCA9PT0gMSA/IGFyZ3NbMF0gOiBhcmdzOyB9XG4gICAgICBldC5mb3JFYWNoKGZ1bmN0aW9uIGVtaXR0ZXIgKGxpc3Rlbikge1xuICAgICAgICBpZiAob3B0cy5hc3luYykgeyBkZWJvdW5jZShsaXN0ZW4sIGFyZ3MsIGN0eCk7IH0gZWxzZSB7IGxpc3Rlbi5hcHBseShjdHgsIGFyZ3MpOyB9XG4gICAgICAgIGlmIChsaXN0ZW4uX29uY2UpIHsgdGhpbmcub2ZmKHR5cGUsIGxpc3Rlbik7IH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaW5nO1xuICAgIH07XG4gIH07XG4gIHJldHVybiB0aGluZztcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjdXN0b21FdmVudCA9IHJlcXVpcmUoJ2N1c3RvbS1ldmVudCcpO1xudmFyIGV2ZW50bWFwID0gcmVxdWlyZSgnLi9ldmVudG1hcCcpO1xudmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDtcbnZhciBhZGRFdmVudCA9IGFkZEV2ZW50RWFzeTtcbnZhciByZW1vdmVFdmVudCA9IHJlbW92ZUV2ZW50RWFzeTtcbnZhciBoYXJkQ2FjaGUgPSBbXTtcblxuaWYgKCFnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICBhZGRFdmVudCA9IGFkZEV2ZW50SGFyZDtcbiAgcmVtb3ZlRXZlbnQgPSByZW1vdmVFdmVudEhhcmQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBhZGQ6IGFkZEV2ZW50LFxuICByZW1vdmU6IHJlbW92ZUV2ZW50LFxuICBmYWJyaWNhdGU6IGZhYnJpY2F0ZUV2ZW50XG59O1xuXG5mdW5jdGlvbiBhZGRFdmVudEVhc3kgKGVsLCB0eXBlLCBmbiwgY2FwdHVyaW5nKSB7XG4gIHJldHVybiBlbC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZuLCBjYXB0dXJpbmcpO1xufVxuXG5mdW5jdGlvbiBhZGRFdmVudEhhcmQgKGVsLCB0eXBlLCBmbikge1xuICByZXR1cm4gZWwuYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIHdyYXAoZWwsIHR5cGUsIGZuKSk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUV2ZW50RWFzeSAoZWwsIHR5cGUsIGZuLCBjYXB0dXJpbmcpIHtcbiAgcmV0dXJuIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGNhcHR1cmluZyk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUV2ZW50SGFyZCAoZWwsIHR5cGUsIGZuKSB7XG4gIHZhciBsaXN0ZW5lciA9IHVud3JhcChlbCwgdHlwZSwgZm4pO1xuICBpZiAobGlzdGVuZXIpIHtcbiAgICByZXR1cm4gZWwuZGV0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGxpc3RlbmVyKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBmYWJyaWNhdGVFdmVudCAoZWwsIHR5cGUsIG1vZGVsKSB7XG4gIHZhciBlID0gZXZlbnRtYXAuaW5kZXhPZih0eXBlKSA9PT0gLTEgPyBtYWtlQ3VzdG9tRXZlbnQoKSA6IG1ha2VDbGFzc2ljRXZlbnQoKTtcbiAgaWYgKGVsLmRpc3BhdGNoRXZlbnQpIHtcbiAgICBlbC5kaXNwYXRjaEV2ZW50KGUpO1xuICB9IGVsc2Uge1xuICAgIGVsLmZpcmVFdmVudCgnb24nICsgdHlwZSwgZSk7XG4gIH1cbiAgZnVuY3Rpb24gbWFrZUNsYXNzaWNFdmVudCAoKSB7XG4gICAgdmFyIGU7XG4gICAgaWYgKGRvYy5jcmVhdGVFdmVudCkge1xuICAgICAgZSA9IGRvYy5jcmVhdGVFdmVudCgnRXZlbnQnKTtcbiAgICAgIGUuaW5pdEV2ZW50KHR5cGUsIHRydWUsIHRydWUpO1xuICAgIH0gZWxzZSBpZiAoZG9jLmNyZWF0ZUV2ZW50T2JqZWN0KSB7XG4gICAgICBlID0gZG9jLmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgfVxuICAgIHJldHVybiBlO1xuICB9XG4gIGZ1bmN0aW9uIG1ha2VDdXN0b21FdmVudCAoKSB7XG4gICAgcmV0dXJuIG5ldyBjdXN0b21FdmVudCh0eXBlLCB7IGRldGFpbDogbW9kZWwgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gd3JhcHBlckZhY3RvcnkgKGVsLCB0eXBlLCBmbikge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcHBlciAob3JpZ2luYWxFdmVudCkge1xuICAgIHZhciBlID0gb3JpZ2luYWxFdmVudCB8fCBnbG9iYWwuZXZlbnQ7XG4gICAgZS50YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCA9IGUucHJldmVudERlZmF1bHQgfHwgZnVuY3Rpb24gcHJldmVudERlZmF1bHQgKCkgeyBlLnJldHVyblZhbHVlID0gZmFsc2U7IH07XG4gICAgZS5zdG9wUHJvcGFnYXRpb24gPSBlLnN0b3BQcm9wYWdhdGlvbiB8fCBmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24gKCkgeyBlLmNhbmNlbEJ1YmJsZSA9IHRydWU7IH07XG4gICAgZS53aGljaCA9IGUud2hpY2ggfHwgZS5rZXlDb2RlO1xuICAgIGZuLmNhbGwoZWwsIGUpO1xuICB9O1xufVxuXG5mdW5jdGlvbiB3cmFwIChlbCwgdHlwZSwgZm4pIHtcbiAgdmFyIHdyYXBwZXIgPSB1bndyYXAoZWwsIHR5cGUsIGZuKSB8fCB3cmFwcGVyRmFjdG9yeShlbCwgdHlwZSwgZm4pO1xuICBoYXJkQ2FjaGUucHVzaCh7XG4gICAgd3JhcHBlcjogd3JhcHBlcixcbiAgICBlbGVtZW50OiBlbCxcbiAgICB0eXBlOiB0eXBlLFxuICAgIGZuOiBmblxuICB9KTtcbiAgcmV0dXJuIHdyYXBwZXI7XG59XG5cbmZ1bmN0aW9uIHVud3JhcCAoZWwsIHR5cGUsIGZuKSB7XG4gIHZhciBpID0gZmluZChlbCwgdHlwZSwgZm4pO1xuICBpZiAoaSkge1xuICAgIHZhciB3cmFwcGVyID0gaGFyZENhY2hlW2ldLndyYXBwZXI7XG4gICAgaGFyZENhY2hlLnNwbGljZShpLCAxKTsgLy8gZnJlZSB1cCBhIHRhZCBvZiBtZW1vcnlcbiAgICByZXR1cm4gd3JhcHBlcjtcbiAgfVxufVxuXG5mdW5jdGlvbiBmaW5kIChlbCwgdHlwZSwgZm4pIHtcbiAgdmFyIGksIGl0ZW07XG4gIGZvciAoaSA9IDA7IGkgPCBoYXJkQ2FjaGUubGVuZ3RoOyBpKyspIHtcbiAgICBpdGVtID0gaGFyZENhY2hlW2ldO1xuICAgIGlmIChpdGVtLmVsZW1lbnQgPT09IGVsICYmIGl0ZW0udHlwZSA9PT0gdHlwZSAmJiBpdGVtLmZuID09PSBmbikge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG59XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBldmVudG1hcCA9IFtdO1xudmFyIGV2ZW50bmFtZSA9ICcnO1xudmFyIHJvbiA9IC9eb24vO1xuXG5mb3IgKGV2ZW50bmFtZSBpbiBnbG9iYWwpIHtcbiAgaWYgKHJvbi50ZXN0KGV2ZW50bmFtZSkpIHtcbiAgICBldmVudG1hcC5wdXNoKGV2ZW50bmFtZS5zbGljZSgyKSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBldmVudG1hcDtcbiIsIlxudmFyIE5hdGl2ZUN1c3RvbUV2ZW50ID0gZ2xvYmFsLkN1c3RvbUV2ZW50O1xuXG5mdW5jdGlvbiB1c2VOYXRpdmUgKCkge1xuICB0cnkge1xuICAgIHZhciBwID0gbmV3IE5hdGl2ZUN1c3RvbUV2ZW50KCdjYXQnLCB7IGRldGFpbDogeyBmb286ICdiYXInIH0gfSk7XG4gICAgcmV0dXJuICAnY2F0JyA9PT0gcC50eXBlICYmICdiYXInID09PSBwLmRldGFpbC5mb287XG4gIH0gY2F0Y2ggKGUpIHtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQ3Jvc3MtYnJvd3NlciBgQ3VzdG9tRXZlbnRgIGNvbnN0cnVjdG9yLlxuICpcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DdXN0b21FdmVudC5DdXN0b21FdmVudFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IHVzZU5hdGl2ZSgpID8gTmF0aXZlQ3VzdG9tRXZlbnQgOlxuXG4vLyBJRSA+PSA5XG4nZnVuY3Rpb24nID09PSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRXZlbnQgPyBmdW5jdGlvbiBDdXN0b21FdmVudCAodHlwZSwgcGFyYW1zKSB7XG4gIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gIGlmIChwYXJhbXMpIHtcbiAgICBlLmluaXRDdXN0b21FdmVudCh0eXBlLCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuICB9IGVsc2Uge1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIGZhbHNlLCBmYWxzZSwgdm9pZCAwKTtcbiAgfVxuICByZXR1cm4gZTtcbn0gOlxuXG4vLyBJRSA8PSA4XG5mdW5jdGlvbiBDdXN0b21FdmVudCAodHlwZSwgcGFyYW1zKSB7XG4gIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcbiAgZS50eXBlID0gdHlwZTtcbiAgaWYgKHBhcmFtcykge1xuICAgIGUuYnViYmxlcyA9IEJvb2xlYW4ocGFyYW1zLmJ1YmJsZXMpO1xuICAgIGUuY2FuY2VsYWJsZSA9IEJvb2xlYW4ocGFyYW1zLmNhbmNlbGFibGUpO1xuICAgIGUuZGV0YWlsID0gcGFyYW1zLmRldGFpbDtcbiAgfSBlbHNlIHtcbiAgICBlLmJ1YmJsZXMgPSBmYWxzZTtcbiAgICBlLmNhbmNlbGFibGUgPSBmYWxzZTtcbiAgICBlLmRldGFpbCA9IHZvaWQgMDtcbiAgfVxuICByZXR1cm4gZTtcbn1cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGNhY2hlID0ge307XG52YXIgc3RhcnQgPSAnKD86XnxcXFxccyknO1xudmFyIGVuZCA9ICcoPzpcXFxcc3wkKSc7XG5cbmZ1bmN0aW9uIGxvb2t1cENsYXNzIChjbGFzc05hbWUpIHtcbiAgdmFyIGNhY2hlZCA9IGNhY2hlW2NsYXNzTmFtZV07XG4gIGlmIChjYWNoZWQpIHtcbiAgICBjYWNoZWQubGFzdEluZGV4ID0gMDtcbiAgfSBlbHNlIHtcbiAgICBjYWNoZVtjbGFzc05hbWVdID0gY2FjaGVkID0gbmV3IFJlZ0V4cChzdGFydCArIGNsYXNzTmFtZSArIGVuZCwgJ2cnKTtcbiAgfVxuICByZXR1cm4gY2FjaGVkO1xufVxuXG5mdW5jdGlvbiBhZGRDbGFzcyAoZWwsIGNsYXNzTmFtZSkge1xuICB2YXIgY3VycmVudCA9IGVsLmNsYXNzTmFtZTtcbiAgaWYgKCFjdXJyZW50Lmxlbmd0aCkge1xuICAgIGVsLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcbiAgfSBlbHNlIGlmICghbG9va3VwQ2xhc3MoY2xhc3NOYW1lKS50ZXN0KGN1cnJlbnQpKSB7XG4gICAgZWwuY2xhc3NOYW1lICs9ICcgJyArIGNsYXNzTmFtZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBybUNsYXNzIChlbCwgY2xhc3NOYW1lKSB7XG4gIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKGxvb2t1cENsYXNzKGNsYXNzTmFtZSksICcgJykudHJpbSgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYWRkOiBhZGRDbGFzcyxcbiAgcm06IHJtQ2xhc3Ncbn07XG4iLCJ2YXIgY3NzID0gXCIuZ3UtbWlycm9yIHtcXG4gIHBvc2l0aW9uOiBmaXhlZCFpbXBvcnRhbnQ7XFxuICBtYXJnaW46IDAhaW1wb3J0YW50O1xcbiAgei1pbmRleDogOTk5OSFpbXBvcnRhbnQ7XFxuICBvcGFjaXR5OiAuODtcXG4gIC1tcy1maWx0ZXI6IFxcXCJwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuQWxwaGEoT3BhY2l0eT04MClcXFwiO1xcbiAgZmlsdGVyOiBhbHBoYShvcGFjaXR5PTgwKTtcXG59XFxuLmd1LWhpZGUge1xcbiAgZGlzcGxheTogbm9uZSFpbXBvcnRhbnQ7XFxufVxcbi5ndS11bnNlbGVjdGFibGUge1xcbiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZSFpbXBvcnRhbnQ7XFxuICAtbW96LXVzZXItc2VsZWN0OiBub25lIWltcG9ydGFudDtcXG4gIC1tcy11c2VyLXNlbGVjdDogbm9uZSFpbXBvcnRhbnQ7XFxuICB1c2VyLXNlbGVjdDogbm9uZSFpbXBvcnRhbnQ7XFxufVxcbi5ndS10cmFuc2l0IHtcXG4gIG9wYWNpdHk6IC4yO1xcbiAgLW1zLWZpbHRlcjogXFxcInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYShPcGFjaXR5PTIwKVxcXCI7XFxuICBmaWx0ZXI6IGFscGhhKG9wYWNpdHk9MjApO1xcbn1cXG5cIjsgKHJlcXVpcmUoXCJicm93c2VyaWZ5LWNzc1wiKS5jcmVhdGVTdHlsZShjc3MsIHsgXCJocmVmXCI6IFwibm9kZV9tb2R1bGVzXFxcXGRyYWd1bGFcXFxcZGlzdFxcXFxkcmFndWxhLm1pbi5jc3NcIiB9LCB7IFwiaW5zZXJ0QXRcIjogXCJib3R0b21cIiB9KSk7IG1vZHVsZS5leHBvcnRzID0gY3NzOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIGVtaXR0ZXIgPSByZXF1aXJlKCdjb250cmEvZW1pdHRlcicpO1xudmFyIGNyb3NzdmVudCA9IHJlcXVpcmUoJ2Nyb3NzdmVudCcpO1xudmFyIGNsYXNzZXMgPSByZXF1aXJlKCcuL2NsYXNzZXMnKTtcbnZhciBkb2MgPSBkb2N1bWVudDtcbnZhciBkb2N1bWVudEVsZW1lbnQgPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xuXG5mdW5jdGlvbiBkcmFndWxhIChpbml0aWFsQ29udGFpbmVycywgb3B0aW9ucykge1xuICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgaWYgKGxlbiA9PT0gMSAmJiBBcnJheS5pc0FycmF5KGluaXRpYWxDb250YWluZXJzKSA9PT0gZmFsc2UpIHtcbiAgICBvcHRpb25zID0gaW5pdGlhbENvbnRhaW5lcnM7XG4gICAgaW5pdGlhbENvbnRhaW5lcnMgPSBbXTtcbiAgfVxuICB2YXIgX21pcnJvcjsgLy8gbWlycm9yIGltYWdlXG4gIHZhciBfc291cmNlOyAvLyBzb3VyY2UgY29udGFpbmVyXG4gIHZhciBfaXRlbTsgLy8gaXRlbSBiZWluZyBkcmFnZ2VkXG4gIHZhciBfb2Zmc2V0WDsgLy8gcmVmZXJlbmNlIHhcbiAgdmFyIF9vZmZzZXRZOyAvLyByZWZlcmVuY2UgeVxuICB2YXIgX21vdmVYOyAvLyByZWZlcmVuY2UgbW92ZSB4XG4gIHZhciBfbW92ZVk7IC8vIHJlZmVyZW5jZSBtb3ZlIHlcbiAgdmFyIF9pbml0aWFsU2libGluZzsgLy8gcmVmZXJlbmNlIHNpYmxpbmcgd2hlbiBncmFiYmVkXG4gIHZhciBfY3VycmVudFNpYmxpbmc7IC8vIHJlZmVyZW5jZSBzaWJsaW5nIG5vd1xuICB2YXIgX2NvcHk7IC8vIGl0ZW0gdXNlZCBmb3IgY29weWluZ1xuICB2YXIgX3JlbmRlclRpbWVyOyAvLyB0aW1lciBmb3Igc2V0VGltZW91dCByZW5kZXJNaXJyb3JJbWFnZVxuICB2YXIgX2xhc3REcm9wVGFyZ2V0ID0gbnVsbDsgLy8gbGFzdCBjb250YWluZXIgaXRlbSB3YXMgb3ZlclxuICB2YXIgX2dyYWJiZWQ7IC8vIGhvbGRzIG1vdXNlZG93biBjb250ZXh0IHVudGlsIGZpcnN0IG1vdXNlbW92ZVxuXG4gIHZhciBvID0gb3B0aW9ucyB8fCB7fTtcbiAgaWYgKG8ubW92ZXMgPT09IHZvaWQgMCkgeyBvLm1vdmVzID0gYWx3YXlzOyB9XG4gIGlmIChvLmFjY2VwdHMgPT09IHZvaWQgMCkgeyBvLmFjY2VwdHMgPSBhbHdheXM7IH1cbiAgaWYgKG8uaW52YWxpZCA9PT0gdm9pZCAwKSB7IG8uaW52YWxpZCA9IGludmFsaWRUYXJnZXQ7IH1cbiAgaWYgKG8uY29udGFpbmVycyA9PT0gdm9pZCAwKSB7IG8uY29udGFpbmVycyA9IGluaXRpYWxDb250YWluZXJzIHx8IFtdOyB9XG4gIGlmIChvLmlzQ29udGFpbmVyID09PSB2b2lkIDApIHsgby5pc0NvbnRhaW5lciA9IG5ldmVyOyB9XG4gIGlmIChvLmNvcHkgPT09IHZvaWQgMCkgeyBvLmNvcHkgPSBmYWxzZTsgfVxuICBpZiAoby5jb3B5U29ydFNvdXJjZSA9PT0gdm9pZCAwKSB7IG8uY29weVNvcnRTb3VyY2UgPSBmYWxzZTsgfVxuICBpZiAoby5yZXZlcnRPblNwaWxsID09PSB2b2lkIDApIHsgby5yZXZlcnRPblNwaWxsID0gZmFsc2U7IH1cbiAgaWYgKG8ucmVtb3ZlT25TcGlsbCA9PT0gdm9pZCAwKSB7IG8ucmVtb3ZlT25TcGlsbCA9IGZhbHNlOyB9XG4gIGlmIChvLmRpcmVjdGlvbiA9PT0gdm9pZCAwKSB7IG8uZGlyZWN0aW9uID0gJ3ZlcnRpY2FsJzsgfVxuICBpZiAoby5pZ25vcmVJbnB1dFRleHRTZWxlY3Rpb24gPT09IHZvaWQgMCkgeyBvLmlnbm9yZUlucHV0VGV4dFNlbGVjdGlvbiA9IHRydWU7IH1cbiAgaWYgKG8ubWlycm9yQ29udGFpbmVyID09PSB2b2lkIDApIHsgby5taXJyb3JDb250YWluZXIgPSBkb2MuYm9keTsgfVxuXG4gIHZhciBkcmFrZSA9IGVtaXR0ZXIoe1xuICAgIGNvbnRhaW5lcnM6IG8uY29udGFpbmVycyxcbiAgICBzdGFydDogbWFudWFsU3RhcnQsXG4gICAgZW5kOiBlbmQsXG4gICAgY2FuY2VsOiBjYW5jZWwsXG4gICAgcmVtb3ZlOiByZW1vdmUsXG4gICAgZGVzdHJveTogZGVzdHJveSxcbiAgICBjYW5Nb3ZlOiBjYW5Nb3ZlLFxuICAgIGRyYWdnaW5nOiBmYWxzZVxuICB9KTtcblxuICBpZiAoby5yZW1vdmVPblNwaWxsID09PSB0cnVlKSB7XG4gICAgZHJha2Uub24oJ292ZXInLCBzcGlsbE92ZXIpLm9uKCdvdXQnLCBzcGlsbE91dCk7XG4gIH1cblxuICBldmVudHMoKTtcblxuICByZXR1cm4gZHJha2U7XG5cbiAgZnVuY3Rpb24gaXNDb250YWluZXIgKGVsKSB7XG4gICAgcmV0dXJuIGRyYWtlLmNvbnRhaW5lcnMuaW5kZXhPZihlbCkgIT09IC0xIHx8IG8uaXNDb250YWluZXIoZWwpO1xuICB9XG5cbiAgZnVuY3Rpb24gZXZlbnRzIChyZW1vdmUpIHtcbiAgICB2YXIgb3AgPSByZW1vdmUgPyAncmVtb3ZlJyA6ICdhZGQnO1xuICAgIHRvdWNoeShkb2N1bWVudEVsZW1lbnQsIG9wLCAnbW91c2Vkb3duJywgZ3JhYik7XG4gICAgdG91Y2h5KGRvY3VtZW50RWxlbWVudCwgb3AsICdtb3VzZXVwJywgcmVsZWFzZSk7XG4gIH1cblxuICBmdW5jdGlvbiBldmVudHVhbE1vdmVtZW50cyAocmVtb3ZlKSB7XG4gICAgdmFyIG9wID0gcmVtb3ZlID8gJ3JlbW92ZScgOiAnYWRkJztcbiAgICB0b3VjaHkoZG9jdW1lbnRFbGVtZW50LCBvcCwgJ21vdXNlbW92ZScsIHN0YXJ0QmVjYXVzZU1vdXNlTW92ZWQpO1xuICB9XG5cbiAgZnVuY3Rpb24gbW92ZW1lbnRzIChyZW1vdmUpIHtcbiAgICB2YXIgb3AgPSByZW1vdmUgPyAncmVtb3ZlJyA6ICdhZGQnO1xuICAgIGNyb3NzdmVudFtvcF0oZG9jdW1lbnRFbGVtZW50LCAnc2VsZWN0c3RhcnQnLCBwcmV2ZW50R3JhYmJlZCk7IC8vIElFOFxuICAgIGNyb3NzdmVudFtvcF0oZG9jdW1lbnRFbGVtZW50LCAnY2xpY2snLCBwcmV2ZW50R3JhYmJlZCk7XG4gIH1cblxuICBmdW5jdGlvbiBkZXN0cm95ICgpIHtcbiAgICBldmVudHModHJ1ZSk7XG4gICAgcmVsZWFzZSh7fSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcmV2ZW50R3JhYmJlZCAoZSkge1xuICAgIGlmIChfZ3JhYmJlZCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdyYWIgKGUpIHtcbiAgICBfbW92ZVggPSBlLmNsaWVudFg7XG4gICAgX21vdmVZID0gZS5jbGllbnRZO1xuXG4gICAgdmFyIGlnbm9yZSA9IHdoaWNoTW91c2VCdXR0b24oZSkgIT09IDEgfHwgZS5tZXRhS2V5IHx8IGUuY3RybEtleTtcbiAgICBpZiAoaWdub3JlKSB7XG4gICAgICByZXR1cm47IC8vIHdlIG9ubHkgY2FyZSBhYm91dCBob25lc3QtdG8tZ29kIGxlZnQgY2xpY2tzIGFuZCB0b3VjaCBldmVudHNcbiAgICB9XG4gICAgdmFyIGl0ZW0gPSBlLnRhcmdldDtcbiAgICB2YXIgY29udGV4dCA9IGNhblN0YXJ0KGl0ZW0pO1xuICAgIGlmICghY29udGV4dCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBfZ3JhYmJlZCA9IGNvbnRleHQ7XG4gICAgZXZlbnR1YWxNb3ZlbWVudHMoKTtcbiAgICBpZiAoZS50eXBlID09PSAnbW91c2Vkb3duJykge1xuICAgICAgaWYgKGlzSW5wdXQoaXRlbSkpIHsgLy8gc2VlIGFsc286IGh0dHBzOi8vZ2l0aHViLmNvbS9iZXZhY3F1YS9kcmFndWxhL2lzc3Vlcy8yMDhcbiAgICAgICAgaXRlbS5mb2N1cygpOyAvLyBmaXhlcyBodHRwczovL2dpdGh1Yi5jb20vYmV2YWNxdWEvZHJhZ3VsYS9pc3N1ZXMvMTc2XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7IC8vIGZpeGVzIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXZhY3F1YS9kcmFndWxhL2lzc3Vlcy8xNTVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzdGFydEJlY2F1c2VNb3VzZU1vdmVkIChlKSB7XG4gICAgaWYgKCFfZ3JhYmJlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAod2hpY2hNb3VzZUJ1dHRvbihlKSA9PT0gMCkge1xuICAgICAgcmVsZWFzZSh7fSk7XG4gICAgICByZXR1cm47IC8vIHdoZW4gdGV4dCBpcyBzZWxlY3RlZCBvbiBhbiBpbnB1dCBhbmQgdGhlbiBkcmFnZ2VkLCBtb3VzZXVwIGRvZXNuJ3QgZmlyZS4gdGhpcyBpcyBvdXIgb25seSBob3BlXG4gICAgfVxuICAgIC8vIHRydXRoeSBjaGVjayBmaXhlcyAjMjM5LCBlcXVhbGl0eSBmaXhlcyAjMjA3XG4gICAgaWYgKGUuY2xpZW50WCAhPT0gdm9pZCAwICYmIGUuY2xpZW50WCA9PT0gX21vdmVYICYmIGUuY2xpZW50WSAhPT0gdm9pZCAwICYmIGUuY2xpZW50WSA9PT0gX21vdmVZKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChvLmlnbm9yZUlucHV0VGV4dFNlbGVjdGlvbikge1xuICAgICAgdmFyIGNsaWVudFggPSBnZXRDb29yZCgnY2xpZW50WCcsIGUpO1xuICAgICAgdmFyIGNsaWVudFkgPSBnZXRDb29yZCgnY2xpZW50WScsIGUpO1xuICAgICAgdmFyIGVsZW1lbnRCZWhpbmRDdXJzb3IgPSBkb2MuZWxlbWVudEZyb21Qb2ludChjbGllbnRYLCBjbGllbnRZKTtcbiAgICAgIGlmIChpc0lucHV0KGVsZW1lbnRCZWhpbmRDdXJzb3IpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZ3JhYmJlZCA9IF9ncmFiYmVkOyAvLyBjYWxsIHRvIGVuZCgpIHVuc2V0cyBfZ3JhYmJlZFxuICAgIGV2ZW50dWFsTW92ZW1lbnRzKHRydWUpO1xuICAgIG1vdmVtZW50cygpO1xuICAgIGVuZCgpO1xuICAgIHN0YXJ0KGdyYWJiZWQpO1xuXG4gICAgdmFyIG9mZnNldCA9IGdldE9mZnNldChfaXRlbSk7XG4gICAgX29mZnNldFggPSBnZXRDb29yZCgncGFnZVgnLCBlKSAtIG9mZnNldC5sZWZ0O1xuICAgIF9vZmZzZXRZID0gZ2V0Q29vcmQoJ3BhZ2VZJywgZSkgLSBvZmZzZXQudG9wO1xuXG4gICAgY2xhc3Nlcy5hZGQoX2NvcHkgfHwgX2l0ZW0sICdndS10cmFuc2l0Jyk7XG4gICAgcmVuZGVyTWlycm9ySW1hZ2UoKTtcbiAgICBkcmFnKGUpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2FuU3RhcnQgKGl0ZW0pIHtcbiAgICBpZiAoZHJha2UuZHJhZ2dpbmcgJiYgX21pcnJvcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaXNDb250YWluZXIoaXRlbSkpIHtcbiAgICAgIHJldHVybjsgLy8gZG9uJ3QgZHJhZyBjb250YWluZXIgaXRzZWxmXG4gICAgfVxuICAgIHZhciBoYW5kbGUgPSBpdGVtO1xuICAgIHdoaWxlIChnZXRQYXJlbnQoaXRlbSkgJiYgaXNDb250YWluZXIoZ2V0UGFyZW50KGl0ZW0pKSA9PT0gZmFsc2UpIHtcbiAgICAgIGlmIChvLmludmFsaWQoaXRlbSwgaGFuZGxlKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpdGVtID0gZ2V0UGFyZW50KGl0ZW0pOyAvLyBkcmFnIHRhcmdldCBzaG91bGQgYmUgYSB0b3AgZWxlbWVudFxuICAgICAgaWYgKCFpdGVtKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgdmFyIHNvdXJjZSA9IGdldFBhcmVudChpdGVtKTtcbiAgICBpZiAoIXNvdXJjZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoby5pbnZhbGlkKGl0ZW0sIGhhbmRsZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgbW92YWJsZSA9IG8ubW92ZXMoaXRlbSwgc291cmNlLCBoYW5kbGUsIG5leHRFbChpdGVtKSk7XG4gICAgaWYgKCFtb3ZhYmxlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGl0ZW06IGl0ZW0sXG4gICAgICBzb3VyY2U6IHNvdXJjZVxuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBjYW5Nb3ZlIChpdGVtKSB7XG4gICAgcmV0dXJuICEhY2FuU3RhcnQoaXRlbSk7XG4gIH1cblxuICBmdW5jdGlvbiBtYW51YWxTdGFydCAoaXRlbSkge1xuICAgIHZhciBjb250ZXh0ID0gY2FuU3RhcnQoaXRlbSk7XG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIHN0YXJ0KGNvbnRleHQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0IChjb250ZXh0KSB7XG4gICAgaWYgKGlzQ29weShjb250ZXh0Lml0ZW0sIGNvbnRleHQuc291cmNlKSkge1xuICAgICAgX2NvcHkgPSBjb250ZXh0Lml0ZW0uY2xvbmVOb2RlKHRydWUpO1xuICAgICAgZHJha2UuZW1pdCgnY2xvbmVkJywgX2NvcHksIGNvbnRleHQuaXRlbSwgJ2NvcHknKTtcbiAgICB9XG5cbiAgICBfc291cmNlID0gY29udGV4dC5zb3VyY2U7XG4gICAgX2l0ZW0gPSBjb250ZXh0Lml0ZW07XG4gICAgX2luaXRpYWxTaWJsaW5nID0gX2N1cnJlbnRTaWJsaW5nID0gbmV4dEVsKGNvbnRleHQuaXRlbSk7XG5cbiAgICBkcmFrZS5kcmFnZ2luZyA9IHRydWU7XG4gICAgZHJha2UuZW1pdCgnZHJhZycsIF9pdGVtLCBfc291cmNlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGludmFsaWRUYXJnZXQgKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGVuZCAoKSB7XG4gICAgaWYgKCFkcmFrZS5kcmFnZ2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaXRlbSA9IF9jb3B5IHx8IF9pdGVtO1xuICAgIGRyb3AoaXRlbSwgZ2V0UGFyZW50KGl0ZW0pKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVuZ3JhYiAoKSB7XG4gICAgX2dyYWJiZWQgPSBmYWxzZTtcbiAgICBldmVudHVhbE1vdmVtZW50cyh0cnVlKTtcbiAgICBtb3ZlbWVudHModHJ1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiByZWxlYXNlIChlKSB7XG4gICAgdW5ncmFiKCk7XG5cbiAgICBpZiAoIWRyYWtlLmRyYWdnaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBpdGVtID0gX2NvcHkgfHwgX2l0ZW07XG4gICAgdmFyIGNsaWVudFggPSBnZXRDb29yZCgnY2xpZW50WCcsIGUpO1xuICAgIHZhciBjbGllbnRZID0gZ2V0Q29vcmQoJ2NsaWVudFknLCBlKTtcbiAgICB2YXIgZWxlbWVudEJlaGluZEN1cnNvciA9IGdldEVsZW1lbnRCZWhpbmRQb2ludChfbWlycm9yLCBjbGllbnRYLCBjbGllbnRZKTtcbiAgICB2YXIgZHJvcFRhcmdldCA9IGZpbmREcm9wVGFyZ2V0KGVsZW1lbnRCZWhpbmRDdXJzb3IsIGNsaWVudFgsIGNsaWVudFkpO1xuICAgIGlmIChkcm9wVGFyZ2V0ICYmICgoX2NvcHkgJiYgby5jb3B5U29ydFNvdXJjZSkgfHwgKCFfY29weSB8fCBkcm9wVGFyZ2V0ICE9PSBfc291cmNlKSkpIHtcbiAgICAgIGRyb3AoaXRlbSwgZHJvcFRhcmdldCk7XG4gICAgfSBlbHNlIGlmIChvLnJlbW92ZU9uU3BpbGwpIHtcbiAgICAgIHJlbW92ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYW5jZWwoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkcm9wIChpdGVtLCB0YXJnZXQpIHtcbiAgICB2YXIgcGFyZW50ID0gZ2V0UGFyZW50KGl0ZW0pO1xuICAgIGlmIChfY29weSAmJiBvLmNvcHlTb3J0U291cmNlICYmIHRhcmdldCA9PT0gX3NvdXJjZSkge1xuICAgICAgcGFyZW50LnJlbW92ZUNoaWxkKF9pdGVtKTtcbiAgICB9XG4gICAgaWYgKGlzSW5pdGlhbFBsYWNlbWVudCh0YXJnZXQpKSB7XG4gICAgICBkcmFrZS5lbWl0KCdjYW5jZWwnLCBpdGVtLCBfc291cmNlLCBfc291cmNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZHJha2UuZW1pdCgnZHJvcCcsIGl0ZW0sIHRhcmdldCwgX3NvdXJjZSwgX2N1cnJlbnRTaWJsaW5nKTtcbiAgICB9XG4gICAgY2xlYW51cCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlICgpIHtcbiAgICBpZiAoIWRyYWtlLmRyYWdnaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBpdGVtID0gX2NvcHkgfHwgX2l0ZW07XG4gICAgdmFyIHBhcmVudCA9IGdldFBhcmVudChpdGVtKTtcbiAgICBpZiAocGFyZW50KSB7XG4gICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoaXRlbSk7XG4gICAgfVxuICAgIGRyYWtlLmVtaXQoX2NvcHkgPyAnY2FuY2VsJyA6ICdyZW1vdmUnLCBpdGVtLCBwYXJlbnQsIF9zb3VyY2UpO1xuICAgIGNsZWFudXAoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbmNlbCAocmV2ZXJ0KSB7XG4gICAgaWYgKCFkcmFrZS5kcmFnZ2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcmV2ZXJ0cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwID8gcmV2ZXJ0IDogby5yZXZlcnRPblNwaWxsO1xuICAgIHZhciBpdGVtID0gX2NvcHkgfHwgX2l0ZW07XG4gICAgdmFyIHBhcmVudCA9IGdldFBhcmVudChpdGVtKTtcbiAgICB2YXIgaW5pdGlhbCA9IGlzSW5pdGlhbFBsYWNlbWVudChwYXJlbnQpO1xuICAgIGlmIChpbml0aWFsID09PSBmYWxzZSAmJiByZXZlcnRzKSB7XG4gICAgICBpZiAoX2NvcHkpIHtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChfY29weSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIF9zb3VyY2UuaW5zZXJ0QmVmb3JlKGl0ZW0sIF9pbml0aWFsU2libGluZyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChpbml0aWFsIHx8IHJldmVydHMpIHtcbiAgICAgIGRyYWtlLmVtaXQoJ2NhbmNlbCcsIGl0ZW0sIF9zb3VyY2UsIF9zb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkcmFrZS5lbWl0KCdkcm9wJywgaXRlbSwgcGFyZW50LCBfc291cmNlLCBfY3VycmVudFNpYmxpbmcpO1xuICAgIH1cbiAgICBjbGVhbnVwKCk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhbnVwICgpIHtcbiAgICB2YXIgaXRlbSA9IF9jb3B5IHx8IF9pdGVtO1xuICAgIHVuZ3JhYigpO1xuICAgIHJlbW92ZU1pcnJvckltYWdlKCk7XG4gICAgaWYgKGl0ZW0pIHtcbiAgICAgIGNsYXNzZXMucm0oaXRlbSwgJ2d1LXRyYW5zaXQnKTtcbiAgICB9XG4gICAgaWYgKF9yZW5kZXJUaW1lcikge1xuICAgICAgY2xlYXJUaW1lb3V0KF9yZW5kZXJUaW1lcik7XG4gICAgfVxuICAgIGRyYWtlLmRyYWdnaW5nID0gZmFsc2U7XG4gICAgaWYgKF9sYXN0RHJvcFRhcmdldCkge1xuICAgICAgZHJha2UuZW1pdCgnb3V0JywgaXRlbSwgX2xhc3REcm9wVGFyZ2V0LCBfc291cmNlKTtcbiAgICB9XG4gICAgZHJha2UuZW1pdCgnZHJhZ2VuZCcsIGl0ZW0pO1xuICAgIF9zb3VyY2UgPSBfaXRlbSA9IF9jb3B5ID0gX2luaXRpYWxTaWJsaW5nID0gX2N1cnJlbnRTaWJsaW5nID0gX3JlbmRlclRpbWVyID0gX2xhc3REcm9wVGFyZ2V0ID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzSW5pdGlhbFBsYWNlbWVudCAodGFyZ2V0LCBzKSB7XG4gICAgdmFyIHNpYmxpbmc7XG4gICAgaWYgKHMgIT09IHZvaWQgMCkge1xuICAgICAgc2libGluZyA9IHM7XG4gICAgfSBlbHNlIGlmIChfbWlycm9yKSB7XG4gICAgICBzaWJsaW5nID0gX2N1cnJlbnRTaWJsaW5nO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaWJsaW5nID0gbmV4dEVsKF9jb3B5IHx8IF9pdGVtKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldCA9PT0gX3NvdXJjZSAmJiBzaWJsaW5nID09PSBfaW5pdGlhbFNpYmxpbmc7XG4gIH1cblxuICBmdW5jdGlvbiBmaW5kRHJvcFRhcmdldCAoZWxlbWVudEJlaGluZEN1cnNvciwgY2xpZW50WCwgY2xpZW50WSkge1xuICAgIHZhciB0YXJnZXQgPSBlbGVtZW50QmVoaW5kQ3Vyc29yO1xuICAgIHdoaWxlICh0YXJnZXQgJiYgIWFjY2VwdGVkKCkpIHtcbiAgICAgIHRhcmdldCA9IGdldFBhcmVudCh0YXJnZXQpO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0O1xuXG4gICAgZnVuY3Rpb24gYWNjZXB0ZWQgKCkge1xuICAgICAgdmFyIGRyb3BwYWJsZSA9IGlzQ29udGFpbmVyKHRhcmdldCk7XG4gICAgICBpZiAoZHJvcHBhYmxlID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIHZhciBpbW1lZGlhdGUgPSBnZXRJbW1lZGlhdGVDaGlsZCh0YXJnZXQsIGVsZW1lbnRCZWhpbmRDdXJzb3IpO1xuICAgICAgdmFyIHJlZmVyZW5jZSA9IGdldFJlZmVyZW5jZSh0YXJnZXQsIGltbWVkaWF0ZSwgY2xpZW50WCwgY2xpZW50WSk7XG4gICAgICB2YXIgaW5pdGlhbCA9IGlzSW5pdGlhbFBsYWNlbWVudCh0YXJnZXQsIHJlZmVyZW5jZSk7XG4gICAgICBpZiAoaW5pdGlhbCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gc2hvdWxkIGFsd2F5cyBiZSBhYmxlIHRvIGRyb3AgaXQgcmlnaHQgYmFjayB3aGVyZSBpdCB3YXNcbiAgICAgIH1cbiAgICAgIHJldHVybiBvLmFjY2VwdHMoX2l0ZW0sIHRhcmdldCwgX3NvdXJjZSwgcmVmZXJlbmNlKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkcmFnIChlKSB7XG4gICAgaWYgKCFfbWlycm9yKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIHZhciBjbGllbnRYID0gZ2V0Q29vcmQoJ2NsaWVudFgnLCBlKTtcbiAgICB2YXIgY2xpZW50WSA9IGdldENvb3JkKCdjbGllbnRZJywgZSk7XG4gICAgdmFyIHggPSBjbGllbnRYIC0gX29mZnNldFg7XG4gICAgdmFyIHkgPSBjbGllbnRZIC0gX29mZnNldFk7XG5cbiAgICBfbWlycm9yLnN0eWxlLmxlZnQgPSB4ICsgJ3B4JztcbiAgICBfbWlycm9yLnN0eWxlLnRvcCA9IHkgKyAncHgnO1xuXG4gICAgdmFyIGl0ZW0gPSBfY29weSB8fCBfaXRlbTtcbiAgICB2YXIgZWxlbWVudEJlaGluZEN1cnNvciA9IGdldEVsZW1lbnRCZWhpbmRQb2ludChfbWlycm9yLCBjbGllbnRYLCBjbGllbnRZKTtcbiAgICB2YXIgZHJvcFRhcmdldCA9IGZpbmREcm9wVGFyZ2V0KGVsZW1lbnRCZWhpbmRDdXJzb3IsIGNsaWVudFgsIGNsaWVudFkpO1xuICAgIHZhciBjaGFuZ2VkID0gZHJvcFRhcmdldCAhPT0gbnVsbCAmJiBkcm9wVGFyZ2V0ICE9PSBfbGFzdERyb3BUYXJnZXQ7XG4gICAgaWYgKGNoYW5nZWQgfHwgZHJvcFRhcmdldCA9PT0gbnVsbCkge1xuICAgICAgb3V0KCk7XG4gICAgICBfbGFzdERyb3BUYXJnZXQgPSBkcm9wVGFyZ2V0O1xuICAgICAgb3ZlcigpO1xuICAgIH1cbiAgICB2YXIgcGFyZW50ID0gZ2V0UGFyZW50KGl0ZW0pO1xuICAgIGlmIChkcm9wVGFyZ2V0ID09PSBfc291cmNlICYmIF9jb3B5ICYmICFvLmNvcHlTb3J0U291cmNlKSB7XG4gICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChpdGVtKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJlZmVyZW5jZTtcbiAgICB2YXIgaW1tZWRpYXRlID0gZ2V0SW1tZWRpYXRlQ2hpbGQoZHJvcFRhcmdldCwgZWxlbWVudEJlaGluZEN1cnNvcik7XG4gICAgaWYgKGltbWVkaWF0ZSAhPT0gbnVsbCkge1xuICAgICAgcmVmZXJlbmNlID0gZ2V0UmVmZXJlbmNlKGRyb3BUYXJnZXQsIGltbWVkaWF0ZSwgY2xpZW50WCwgY2xpZW50WSk7XG4gICAgfSBlbHNlIGlmIChvLnJldmVydE9uU3BpbGwgPT09IHRydWUgJiYgIV9jb3B5KSB7XG4gICAgICByZWZlcmVuY2UgPSBfaW5pdGlhbFNpYmxpbmc7XG4gICAgICBkcm9wVGFyZ2V0ID0gX3NvdXJjZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKF9jb3B5ICYmIHBhcmVudCkge1xuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoaXRlbSk7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChcbiAgICAgIChyZWZlcmVuY2UgPT09IG51bGwgJiYgY2hhbmdlZCkgfHxcbiAgICAgIHJlZmVyZW5jZSAhPT0gaXRlbSAmJlxuICAgICAgcmVmZXJlbmNlICE9PSBuZXh0RWwoaXRlbSlcbiAgICApIHtcbiAgICAgIF9jdXJyZW50U2libGluZyA9IHJlZmVyZW5jZTtcbiAgICAgIGRyb3BUYXJnZXQuaW5zZXJ0QmVmb3JlKGl0ZW0sIHJlZmVyZW5jZSk7XG4gICAgICBkcmFrZS5lbWl0KCdzaGFkb3cnLCBpdGVtLCBkcm9wVGFyZ2V0LCBfc291cmNlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gbW92ZWQgKHR5cGUpIHsgZHJha2UuZW1pdCh0eXBlLCBpdGVtLCBfbGFzdERyb3BUYXJnZXQsIF9zb3VyY2UpOyB9XG4gICAgZnVuY3Rpb24gb3ZlciAoKSB7IGlmIChjaGFuZ2VkKSB7IG1vdmVkKCdvdmVyJyk7IH0gfVxuICAgIGZ1bmN0aW9uIG91dCAoKSB7IGlmIChfbGFzdERyb3BUYXJnZXQpIHsgbW92ZWQoJ291dCcpOyB9IH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNwaWxsT3ZlciAoZWwpIHtcbiAgICBjbGFzc2VzLnJtKGVsLCAnZ3UtaGlkZScpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3BpbGxPdXQgKGVsKSB7XG4gICAgaWYgKGRyYWtlLmRyYWdnaW5nKSB7IGNsYXNzZXMuYWRkKGVsLCAnZ3UtaGlkZScpOyB9XG4gIH1cblxuICBmdW5jdGlvbiByZW5kZXJNaXJyb3JJbWFnZSAoKSB7XG4gICAgaWYgKF9taXJyb3IpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHJlY3QgPSBfaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBfbWlycm9yID0gX2l0ZW0uY2xvbmVOb2RlKHRydWUpO1xuICAgIF9taXJyb3Iuc3R5bGUud2lkdGggPSBnZXRSZWN0V2lkdGgocmVjdCkgKyAncHgnO1xuICAgIF9taXJyb3Iuc3R5bGUuaGVpZ2h0ID0gZ2V0UmVjdEhlaWdodChyZWN0KSArICdweCc7XG4gICAgY2xhc3Nlcy5ybShfbWlycm9yLCAnZ3UtdHJhbnNpdCcpO1xuICAgIGNsYXNzZXMuYWRkKF9taXJyb3IsICdndS1taXJyb3InKTtcbiAgICBvLm1pcnJvckNvbnRhaW5lci5hcHBlbmRDaGlsZChfbWlycm9yKTtcbiAgICB0b3VjaHkoZG9jdW1lbnRFbGVtZW50LCAnYWRkJywgJ21vdXNlbW92ZScsIGRyYWcpO1xuICAgIGNsYXNzZXMuYWRkKG8ubWlycm9yQ29udGFpbmVyLCAnZ3UtdW5zZWxlY3RhYmxlJyk7XG4gICAgZHJha2UuZW1pdCgnY2xvbmVkJywgX21pcnJvciwgX2l0ZW0sICdtaXJyb3InKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZU1pcnJvckltYWdlICgpIHtcbiAgICBpZiAoX21pcnJvcikge1xuICAgICAgY2xhc3Nlcy5ybShvLm1pcnJvckNvbnRhaW5lciwgJ2d1LXVuc2VsZWN0YWJsZScpO1xuICAgICAgdG91Y2h5KGRvY3VtZW50RWxlbWVudCwgJ3JlbW92ZScsICdtb3VzZW1vdmUnLCBkcmFnKTtcbiAgICAgIGdldFBhcmVudChfbWlycm9yKS5yZW1vdmVDaGlsZChfbWlycm9yKTtcbiAgICAgIF9taXJyb3IgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEltbWVkaWF0ZUNoaWxkIChkcm9wVGFyZ2V0LCB0YXJnZXQpIHtcbiAgICB2YXIgaW1tZWRpYXRlID0gdGFyZ2V0O1xuICAgIHdoaWxlIChpbW1lZGlhdGUgIT09IGRyb3BUYXJnZXQgJiYgZ2V0UGFyZW50KGltbWVkaWF0ZSkgIT09IGRyb3BUYXJnZXQpIHtcbiAgICAgIGltbWVkaWF0ZSA9IGdldFBhcmVudChpbW1lZGlhdGUpO1xuICAgIH1cbiAgICBpZiAoaW1tZWRpYXRlID09PSBkb2N1bWVudEVsZW1lbnQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gaW1tZWRpYXRlO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0UmVmZXJlbmNlIChkcm9wVGFyZ2V0LCB0YXJnZXQsIHgsIHkpIHtcbiAgICB2YXIgaG9yaXpvbnRhbCA9IG8uZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCc7XG4gICAgdmFyIHJlZmVyZW5jZSA9IHRhcmdldCAhPT0gZHJvcFRhcmdldCA/IGluc2lkZSgpIDogb3V0c2lkZSgpO1xuICAgIHJldHVybiByZWZlcmVuY2U7XG5cbiAgICBmdW5jdGlvbiBvdXRzaWRlICgpIHsgLy8gc2xvd2VyLCBidXQgYWJsZSB0byBmaWd1cmUgb3V0IGFueSBwb3NpdGlvblxuICAgICAgdmFyIGxlbiA9IGRyb3BUYXJnZXQuY2hpbGRyZW4ubGVuZ3RoO1xuICAgICAgdmFyIGk7XG4gICAgICB2YXIgZWw7XG4gICAgICB2YXIgcmVjdDtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBlbCA9IGRyb3BUYXJnZXQuY2hpbGRyZW5baV07XG4gICAgICAgIHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgaWYgKGhvcml6b250YWwgJiYgKHJlY3QubGVmdCArIHJlY3Qud2lkdGggLyAyKSA+IHgpIHsgcmV0dXJuIGVsOyB9XG4gICAgICAgIGlmICghaG9yaXpvbnRhbCAmJiAocmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDIpID4geSkgeyByZXR1cm4gZWw7IH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc2lkZSAoKSB7IC8vIGZhc3RlciwgYnV0IG9ubHkgYXZhaWxhYmxlIGlmIGRyb3BwZWQgaW5zaWRlIGEgY2hpbGQgZWxlbWVudFxuICAgICAgdmFyIHJlY3QgPSB0YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICBpZiAoaG9yaXpvbnRhbCkge1xuICAgICAgICByZXR1cm4gcmVzb2x2ZSh4ID4gcmVjdC5sZWZ0ICsgZ2V0UmVjdFdpZHRoKHJlY3QpIC8gMik7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzb2x2ZSh5ID4gcmVjdC50b3AgKyBnZXRSZWN0SGVpZ2h0KHJlY3QpIC8gMik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVzb2x2ZSAoYWZ0ZXIpIHtcbiAgICAgIHJldHVybiBhZnRlciA/IG5leHRFbCh0YXJnZXQpIDogdGFyZ2V0O1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGlzQ29weSAoaXRlbSwgY29udGFpbmVyKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBvLmNvcHkgPT09ICdib29sZWFuJyA/IG8uY29weSA6IG8uY29weShpdGVtLCBjb250YWluZXIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRvdWNoeSAoZWwsIG9wLCB0eXBlLCBmbikge1xuICB2YXIgdG91Y2ggPSB7XG4gICAgbW91c2V1cDogJ3RvdWNoZW5kJyxcbiAgICBtb3VzZWRvd246ICd0b3VjaHN0YXJ0JyxcbiAgICBtb3VzZW1vdmU6ICd0b3VjaG1vdmUnXG4gIH07XG4gIHZhciBwb2ludGVycyA9IHtcbiAgICBtb3VzZXVwOiAncG9pbnRlcnVwJyxcbiAgICBtb3VzZWRvd246ICdwb2ludGVyZG93bicsXG4gICAgbW91c2Vtb3ZlOiAncG9pbnRlcm1vdmUnXG4gIH07XG4gIHZhciBtaWNyb3NvZnQgPSB7XG4gICAgbW91c2V1cDogJ01TUG9pbnRlclVwJyxcbiAgICBtb3VzZWRvd246ICdNU1BvaW50ZXJEb3duJyxcbiAgICBtb3VzZW1vdmU6ICdNU1BvaW50ZXJNb3ZlJ1xuICB9O1xuICBpZiAoZ2xvYmFsLm5hdmlnYXRvci5wb2ludGVyRW5hYmxlZCkge1xuICAgIGNyb3NzdmVudFtvcF0oZWwsIHBvaW50ZXJzW3R5cGVdLCBmbik7XG4gIH0gZWxzZSBpZiAoZ2xvYmFsLm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkKSB7XG4gICAgY3Jvc3N2ZW50W29wXShlbCwgbWljcm9zb2Z0W3R5cGVdLCBmbik7XG4gIH0gZWxzZSB7XG4gICAgY3Jvc3N2ZW50W29wXShlbCwgdG91Y2hbdHlwZV0sIGZuKTtcbiAgICBjcm9zc3ZlbnRbb3BdKGVsLCB0eXBlLCBmbik7XG4gIH1cbn1cblxuZnVuY3Rpb24gd2hpY2hNb3VzZUJ1dHRvbiAoZSkge1xuICBpZiAoZS50b3VjaGVzICE9PSB2b2lkIDApIHsgcmV0dXJuIGUudG91Y2hlcy5sZW5ndGg7IH1cbiAgaWYgKGUud2hpY2ggIT09IHZvaWQgMCAmJiBlLndoaWNoICE9PSAwKSB7IHJldHVybiBlLndoaWNoOyB9IC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vYmV2YWNxdWEvZHJhZ3VsYS9pc3N1ZXMvMjYxXG4gIGlmIChlLmJ1dHRvbnMgIT09IHZvaWQgMCkgeyByZXR1cm4gZS5idXR0b25zOyB9XG4gIHZhciBidXR0b24gPSBlLmJ1dHRvbjtcbiAgaWYgKGJ1dHRvbiAhPT0gdm9pZCAwKSB7IC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vanF1ZXJ5L2pxdWVyeS9ibG9iLzk5ZThmZjFiYWE3YWUzNDFlOTRiYjg5YzNlODQ1NzBjN2MzYWQ5ZWEvc3JjL2V2ZW50LmpzI0w1NzMtTDU3NVxuICAgIHJldHVybiBidXR0b24gJiAxID8gMSA6IGJ1dHRvbiAmIDIgPyAzIDogKGJ1dHRvbiAmIDQgPyAyIDogMCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0T2Zmc2V0IChlbCkge1xuICB2YXIgcmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4ge1xuICAgIGxlZnQ6IHJlY3QubGVmdCArIGdldFNjcm9sbCgnc2Nyb2xsTGVmdCcsICdwYWdlWE9mZnNldCcpLFxuICAgIHRvcDogcmVjdC50b3AgKyBnZXRTY3JvbGwoJ3Njcm9sbFRvcCcsICdwYWdlWU9mZnNldCcpXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldFNjcm9sbCAoc2Nyb2xsUHJvcCwgb2Zmc2V0UHJvcCkge1xuICBpZiAodHlwZW9mIGdsb2JhbFtvZmZzZXRQcm9wXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZ2xvYmFsW29mZnNldFByb3BdO1xuICB9XG4gIGlmIChkb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XG4gICAgcmV0dXJuIGRvY3VtZW50RWxlbWVudFtzY3JvbGxQcm9wXTtcbiAgfVxuICByZXR1cm4gZG9jLmJvZHlbc2Nyb2xsUHJvcF07XG59XG5cbmZ1bmN0aW9uIGdldEVsZW1lbnRCZWhpbmRQb2ludCAocG9pbnQsIHgsIHkpIHtcbiAgdmFyIHAgPSBwb2ludCB8fCB7fTtcbiAgdmFyIHN0YXRlID0gcC5jbGFzc05hbWU7XG4gIHZhciBlbDtcbiAgcC5jbGFzc05hbWUgKz0gJyBndS1oaWRlJztcbiAgZWwgPSBkb2MuZWxlbWVudEZyb21Qb2ludCh4LCB5KTtcbiAgcC5jbGFzc05hbWUgPSBzdGF0ZTtcbiAgcmV0dXJuIGVsO1xufVxuXG5mdW5jdGlvbiBuZXZlciAoKSB7IHJldHVybiBmYWxzZTsgfVxuZnVuY3Rpb24gYWx3YXlzICgpIHsgcmV0dXJuIHRydWU7IH1cbmZ1bmN0aW9uIGdldFJlY3RXaWR0aCAocmVjdCkgeyByZXR1cm4gcmVjdC53aWR0aCB8fCAocmVjdC5yaWdodCAtIHJlY3QubGVmdCk7IH1cbmZ1bmN0aW9uIGdldFJlY3RIZWlnaHQgKHJlY3QpIHsgcmV0dXJuIHJlY3QuaGVpZ2h0IHx8IChyZWN0LmJvdHRvbSAtIHJlY3QudG9wKTsgfVxuZnVuY3Rpb24gZ2V0UGFyZW50IChlbCkgeyByZXR1cm4gZWwucGFyZW50Tm9kZSA9PT0gZG9jID8gbnVsbCA6IGVsLnBhcmVudE5vZGU7IH1cbmZ1bmN0aW9uIGlzSW5wdXQgKGVsKSB7IHJldHVybiBlbC50YWdOYW1lID09PSAnSU5QVVQnIHx8IGVsLnRhZ05hbWUgPT09ICdURVhUQVJFQScgfHwgZWwudGFnTmFtZSA9PT0gJ1NFTEVDVCcgfHwgaXNFZGl0YWJsZShlbCk7IH1cbmZ1bmN0aW9uIGlzRWRpdGFibGUgKGVsKSB7XG4gIGlmICghZWwpIHsgcmV0dXJuIGZhbHNlOyB9IC8vIG5vIHBhcmVudHMgd2VyZSBlZGl0YWJsZVxuICBpZiAoZWwuY29udGVudEVkaXRhYmxlID09PSAnZmFsc2UnKSB7IHJldHVybiBmYWxzZTsgfSAvLyBzdG9wIHRoZSBsb29rdXBcbiAgaWYgKGVsLmNvbnRlbnRFZGl0YWJsZSA9PT0gJ3RydWUnKSB7IHJldHVybiB0cnVlOyB9IC8vIGZvdW5kIGEgY29udGVudEVkaXRhYmxlIGVsZW1lbnQgaW4gdGhlIGNoYWluXG4gIHJldHVybiBpc0VkaXRhYmxlKGdldFBhcmVudChlbCkpOyAvLyBjb250ZW50RWRpdGFibGUgaXMgc2V0IHRvICdpbmhlcml0J1xufVxuXG5mdW5jdGlvbiBuZXh0RWwgKGVsKSB7XG4gIHJldHVybiBlbC5uZXh0RWxlbWVudFNpYmxpbmcgfHwgbWFudWFsbHkoKTtcbiAgZnVuY3Rpb24gbWFudWFsbHkgKCkge1xuICAgIHZhciBzaWJsaW5nID0gZWw7XG4gICAgZG8ge1xuICAgICAgc2libGluZyA9IHNpYmxpbmcubmV4dFNpYmxpbmc7XG4gICAgfSB3aGlsZSAoc2libGluZyAmJiBzaWJsaW5nLm5vZGVUeXBlICE9PSAxKTtcbiAgICByZXR1cm4gc2libGluZztcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRFdmVudEhvc3QgKGUpIHtcbiAgLy8gb24gdG91Y2hlbmQgZXZlbnQsIHdlIGhhdmUgdG8gdXNlIGBlLmNoYW5nZWRUb3VjaGVzYFxuICAvLyBzZWUgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy83MTkyNTYzL3RvdWNoZW5kLWV2ZW50LXByb3BlcnRpZXNcbiAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9iZXZhY3F1YS9kcmFndWxhL2lzc3Vlcy8zNFxuICBpZiAoZS50YXJnZXRUb3VjaGVzICYmIGUudGFyZ2V0VG91Y2hlcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gZS50YXJnZXRUb3VjaGVzWzBdO1xuICB9XG4gIGlmIChlLmNoYW5nZWRUb3VjaGVzICYmIGUuY2hhbmdlZFRvdWNoZXMubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGUuY2hhbmdlZFRvdWNoZXNbMF07XG4gIH1cbiAgcmV0dXJuIGU7XG59XG5cbmZ1bmN0aW9uIGdldENvb3JkIChjb29yZCwgZSkge1xuICB2YXIgaG9zdCA9IGdldEV2ZW50SG9zdChlKTtcbiAgdmFyIG1pc3NNYXAgPSB7XG4gICAgcGFnZVg6ICdjbGllbnRYJywgLy8gSUU4XG4gICAgcGFnZVk6ICdjbGllbnRZJyAvLyBJRThcbiAgfTtcbiAgaWYgKGNvb3JkIGluIG1pc3NNYXAgJiYgIShjb29yZCBpbiBob3N0KSAmJiBtaXNzTWFwW2Nvb3JkXSBpbiBob3N0KSB7XG4gICAgY29vcmQgPSBtaXNzTWFwW2Nvb3JkXTtcbiAgfVxuICByZXR1cm4gaG9zdFtjb29yZF07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZHJhZ3VsYTtcbiIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCJ2YXIgc2kgPSB0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSAnZnVuY3Rpb24nLCB0aWNrO1xuaWYgKHNpKSB7XG4gIHRpY2sgPSBmdW5jdGlvbiAoZm4pIHsgc2V0SW1tZWRpYXRlKGZuKTsgfTtcbn0gZWxzZSB7XG4gIHRpY2sgPSBmdW5jdGlvbiAoZm4pIHsgc2V0VGltZW91dChmbiwgMCk7IH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdGljazsiLCJ2YXIgbmV4dFRpY2sgPSByZXF1aXJlKCdwcm9jZXNzL2Jyb3dzZXIuanMnKS5uZXh0VGljaztcbnZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTtcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBpbW1lZGlhdGVJZHMgPSB7fTtcbnZhciBuZXh0SW1tZWRpYXRlSWQgPSAwO1xuXG4vLyBET00gQVBJcywgZm9yIGNvbXBsZXRlbmVzc1xuXG5leHBvcnRzLnNldFRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0VGltZW91dCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhclRpbWVvdXQpO1xufTtcbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0SW50ZXJ2YWwsIHdpbmRvdywgYXJndW1lbnRzKSwgY2xlYXJJbnRlcnZhbCk7XG59O1xuZXhwb3J0cy5jbGVhclRpbWVvdXQgPVxuZXhwb3J0cy5jbGVhckludGVydmFsID0gZnVuY3Rpb24odGltZW91dCkgeyB0aW1lb3V0LmNsb3NlKCk7IH07XG5cbmZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHtcbiAgdGhpcy5faWQgPSBpZDtcbiAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47XG59XG5UaW1lb3V0LnByb3RvdHlwZS51bnJlZiA9IFRpbWVvdXQucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKCkge307XG5UaW1lb3V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLl9jbGVhckZuLmNhbGwod2luZG93LCB0aGlzLl9pZCk7XG59O1xuXG4vLyBEb2VzIG5vdCBzdGFydCB0aGUgdGltZSwganVzdCBzZXRzIHVwIHRoZSBtZW1iZXJzIG5lZWRlZC5cbmV4cG9ydHMuZW5yb2xsID0gZnVuY3Rpb24oaXRlbSwgbXNlY3MpIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IG1zZWNzO1xufTtcblxuZXhwb3J0cy51bmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IC0xO1xufTtcblxuZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuXG4gIHZhciBtc2VjcyA9IGl0ZW0uX2lkbGVUaW1lb3V0O1xuICBpZiAobXNlY3MgPj0gMCkge1xuICAgIGl0ZW0uX2lkbGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgIGlmIChpdGVtLl9vblRpbWVvdXQpXG4gICAgICAgIGl0ZW0uX29uVGltZW91dCgpO1xuICAgIH0sIG1zZWNzKTtcbiAgfVxufTtcblxuLy8gVGhhdCdzIG5vdCBob3cgbm9kZS5qcyBpbXBsZW1lbnRzIGl0IGJ1dCB0aGUgZXhwb3NlZCBhcGkgaXMgdGhlIHNhbWUuXG5leHBvcnRzLnNldEltbWVkaWF0ZSA9IHR5cGVvZiBzZXRJbW1lZGlhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHNldEltbWVkaWF0ZSA6IGZ1bmN0aW9uKGZuKSB7XG4gIHZhciBpZCA9IG5leHRJbW1lZGlhdGVJZCsrO1xuICB2YXIgYXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPCAyID8gZmFsc2UgOiBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgaW1tZWRpYXRlSWRzW2lkXSA9IHRydWU7XG5cbiAgbmV4dFRpY2soZnVuY3Rpb24gb25OZXh0VGljaygpIHtcbiAgICBpZiAoaW1tZWRpYXRlSWRzW2lkXSkge1xuICAgICAgLy8gZm4uY2FsbCgpIGlzIGZhc3RlciBzbyB3ZSBvcHRpbWl6ZSBmb3IgdGhlIGNvbW1vbiB1c2UtY2FzZVxuICAgICAgLy8gQHNlZSBodHRwOi8vanNwZXJmLmNvbS9jYWxsLWFwcGx5LXNlZ3VcbiAgICAgIGlmIChhcmdzKSB7XG4gICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm4uY2FsbChudWxsKTtcbiAgICAgIH1cbiAgICAgIC8vIFByZXZlbnQgaWRzIGZyb20gbGVha2luZ1xuICAgICAgZXhwb3J0cy5jbGVhckltbWVkaWF0ZShpZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaWQ7XG59O1xuXG5leHBvcnRzLmNsZWFySW1tZWRpYXRlID0gdHlwZW9mIGNsZWFySW1tZWRpYXRlID09PSBcImZ1bmN0aW9uXCIgPyBjbGVhckltbWVkaWF0ZSA6IGZ1bmN0aW9uKGlkKSB7XG4gIGRlbGV0ZSBpbW1lZGlhdGVJZHNbaWRdO1xufTsiLCJtb2R1bGUuZXhwb3J0cz17XHJcbiAgXCJuYW1lXCI6IFwicGRmLWJ1aWxkZXItMjAyMFwiLFxyXG4gIFwidmVyc2lvblwiOiBcIjAuMC4xNS1zbmFwc2hvdFwiLFxyXG4gIFwiZGVzY3JpcHRpb25cIjogXCJcIixcclxuICBcIm1haW5cIjogXCJpbmRleC5qc1wiLFxyXG4gIFwic2NyaXB0c1wiOiB7XHJcbiAgICBcImJ1aWxkLWFsbFwiOiBcIm5wbSBydW4gYnVpbGQtcGRmLWVkaXRvciAmJiBucG0gcnVuIGJ1aWxkLW1hbmFnZXIgJiBucG0gcnVuIGRlcGxveVwiLFxyXG4gICAgXCJidWlsZC1wZGYtZWRpdG9yXCI6IFwiYnJvd3NlcmlmeSAtZCBzcmMvcGRmLWVkaXRvci9QZGZFZGl0b3IuanMgPiBwdWJsaWMvcGRmLWVkaXRvci9wZGYtZWRpdG9yLmpzXCIsXHJcbiAgICBcImJ1aWxkLW1hbmFnZXJcIjogXCJicm93c2VyaWZ5IC1kIHNyYy9tYW5hZ2UtYXBwbGljYXRpb24vTWFuYWdlQXBwbGljYXRpb24uanMgPiBwdWJsaWMvbWFuYWdlLWFwcGxpY2F0aW9uL21hbmFnZXIuanNcIixcclxuICAgIFwiZGVwbG95XCI6IFwieGNvcHkgL1MgL1kgIFxcXCIuL3B1YmxpY1xcXCIgXFxcIkM6L1VzZXJzL1N0cmFuZ2VyX2luX3RoZV9RL0lkZWFQcm9qZWN0cy9pdGV4dC1zZXJ2ZXIvc3RhdGljXFxcIlwiXHJcbiAgfSxcclxuICBcImRldkRlcGVuZGVuY2llc1wiOiB7XHJcbiAgICBcImJhYmVsLXByZXNldC1lczIwMTVcIjogXCJeNi4yNC4xXCIsXHJcbiAgICBcImJyb3dzZXJpZnlcIjogXCJeMTYuMi4zXCIsXHJcbiAgICBcImJyb3dzZXJpZnktY3NzXCI6IFwiXjAuMTQuMFwiLFxyXG4gICAgXCJleHBvcnRzLWxvYWRlclwiOiBcIl4wLjcuMFwiLFxyXG4gICAgXCJncmFjZWZ1bC1mc1wiOiBcIl40LjEuMTNcIixcclxuICAgIFwiaW1wb3J0cy1sb2FkZXJcIjogXCJeMC44LjBcIixcclxuICAgIFwic3RyaXBpZnlcIjogXCJeNi4wLjBcIlxyXG4gIH0sXHJcbiAgXCJicm93c2VyaWZ5XCI6IHtcclxuICAgIFwidHJhbnNmb3JtXCI6IFtcclxuICAgICAgXCJicm93c2VyaWZ5LWNzc1wiXHJcbiAgICBdXHJcbiAgfSxcclxuICBcImF1dGhvclwiOiBcIlwiLFxyXG4gIFwibGljZW5zZVwiOiBcIklTQ1wiLFxyXG4gIFwiZGVwZW5kZW5jaWVzXCI6IHtcclxuICAgIFwiZDMtc2VsZWN0aW9uXCI6IFwiXjEuNC4wXCIsXHJcbiAgICBcImRyYWd1bGFcIjogXCJeMy43LjJcIlxyXG4gIH1cclxufVxyXG4iLCIvLyB2YXIgSW5saW5lRWRpdG9yID0gcmVxdWlyZSgnLi4vLi4vZGVwZW5kZW5jaWVzL2NrZWRpdG9yL2NrZWRpdG9yNS1pbmxpbmUtZnVsbC9idWlsZC9ja2VkaXRvcicpXHJcbnZhciBCYWxsb29uRWRpdG9yID0gcmVxdWlyZSgnLi4vLi4vZGVwZW5kZW5jaWVzL2NrZWRpdG9yL2NrZWRpdG9yLWJhbG9vbi9idWlsZC9ja2VkaXRvcicpXHJcbi8vIHJlcXVpcmUoJy4uLy4uL2RlcGVuZGVuY2llcy9ja2VkaXRvci9ja2VkaXRvcjUtaW5saW5lLWZ1bGwvYnVpbGQvdHJhbnNsYXRpb25zL3J1JylcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcblxyXG4gICAgcmVtb3ZlVGV4dEVkaXRvcjogZnVuY3Rpb24gcmVtb3ZlKGVsKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBpbml0VGV4dEVkaXRvcjogZnVuY3Rpb24gKGVsKSB7XHJcbiAgICAgICAgY2tFZGl0b3IoZWwpXHJcbiAgICB9XHJcbn07XHJcblxyXG5cclxuZnVuY3Rpb24gY2tFZGl0b3IoZWwpIHtcclxuXHJcbiAgICBpZighZWwgfHwgZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdpbml0aWFsaXplZCcpKVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgZWwuY2xhc3NMaXN0LmFkZCgnaW5pdGlhbGl6ZWQnKTtcclxuICAgIC8vIElubGluZUVkaXRvclxyXG4gICAgQmFsbG9vbkVkaXRvclxyXG4gICAgICAgIC5jcmVhdGUoZWwsIHtcclxuXHJcbiAgICAgICAgICAgIHRvb2xiYXI6IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ3VuZG8nLFxyXG4gICAgICAgICAgICAgICAgICAgICdyZWRvJyxcclxuICAgICAgICAgICAgICAgICAgICAnfCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2JvbGQnLFxyXG4gICAgICAgICAgICAgICAgICAgICdpdGFsaWMnLFxyXG4gICAgICAgICAgICAgICAgICAgICd1bmRlcmxpbmUnLFxyXG4gICAgICAgICAgICAgICAgICAgICdzdHJpa2V0aHJvdWdoJyxcclxuICAgICAgICAgICAgICAgICAgICAnc3Vic2NyaXB0JyxcclxuICAgICAgICAgICAgICAgICAgICAnc3VwZXJzY3JpcHQnLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICdibG9ja1F1b3RlJyxcclxuICAgICAgICAgICAgICAgICAgICAvLyAnYnVsbGV0ZWRMaXN0JyxcclxuICAgICAgICAgICAgICAgICAgICAvLyAnbnVtYmVyZWRMaXN0JyxcclxuICAgICAgICAgICAgICAgICAgICAnfCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2FsaWdubWVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2luZGVudCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ291dGRlbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICdmb250RmFtaWx5JyxcclxuICAgICAgICAgICAgICAgICAgICAnZm9udFNpemUnLFxyXG4gICAgICAgICAgICAgICAgICAgICdmb250QmFja2dyb3VuZENvbG9yJyxcclxuICAgICAgICAgICAgICAgICAgICAnZm9udENvbG9yJyxcclxuICAgICAgICAgICAgICAgICAgICAnfCcsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gJ2ltYWdlVXBsb2FkJyxcclxuICAgICAgICAgICAgICAgICAgICAvLyAnaW5zZXJ0VGFibGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICdzcGVjaWFsQ2hhcmFjdGVycycsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2hvcml6b250YWxMaW5lJyxcclxuICAgICAgICAgICAgICAgICAgICAnbGluaydcclxuICAgICAgICAgICAgICAgIF1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbGFuZ3VhZ2U6ICdydScsXHJcbiAgICAgICAgICAgIGltYWdlOiB7XHJcbiAgICAgICAgICAgICAgICAvLyBZb3UgbmVlZCB0byBjb25maWd1cmUgdGhlIGltYWdlIHRvb2xiYXIsIHRvbywgc28gaXQgdXNlcyB0aGUgbmV3IHN0eWxlIGJ1dHRvbnMuXHJcbiAgICAgICAgICAgICAgICB0b29sYmFyOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ2ltYWdlVXBsb2FkJyxcclxuICAgICAgICAgICAgICAgICAgICAvLyAnaW1hZ2VUZXh0QWx0ZXJuYXRpdmUnLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICd8JyxcclxuICAgICAgICAgICAgICAgICAgICAnaW1hZ2VTdHlsZTphbGlnbkxlZnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICdpbWFnZVN0eWxlOmZ1bGwnLFxyXG4gICAgICAgICAgICAgICAgICAgICdpbWFnZVN0eWxlOmFsaWduUmlnaHQnXHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgc3R5bGVzOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgJ2Z1bGwnLFxyXG4gICAgICAgICAgICAgICAgICAgICdhbGlnbkxlZnQnLFxyXG4gICAgICAgICAgICAgICAgICAgICdhbGlnblJpZ2h0J1xyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0YWJsZToge1xyXG4gICAgICAgICAgICAgICAgY29udGVudFRvb2xiYXI6IFtcclxuICAgICAgICAgICAgICAgICAgICAndGFibGVDb2x1bW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICd0YWJsZVJvdycsXHJcbiAgICAgICAgICAgICAgICAgICAgJ21lcmdlVGFibGVDZWxscycsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RhYmxlQ2VsbFByb3BlcnRpZXMnLFxyXG4gICAgICAgICAgICAgICAgICAgICd0YWJsZVByb3BlcnRpZXMnXHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxpY2Vuc2VLZXk6ICcnLFxyXG5cclxuICAgICAgICB9KS50aGVuKGVkaXRvciA9PiB7XHJcbiAgICAgICAgICAgIGVsLmVkaXRvciA9IGVkaXRvcjtcclxuICAgICAgICB9KVxyXG59XHJcbiIsImxldCBwYWdlU3R5bGVzID0gcmVxdWlyZSgnLi9wYWdlLXN0eWxlcycpO1xyXG5cclxuZnVuY3Rpb24gZml4UGFnZUJyZWFrc19ieV9BU3RhbmlzbGF2c2t5KHRtcCkge1xyXG4gICAgbGV0IHMgPSB0bXAucXVlcnlTZWxlY3RvcignLnBhZ2UuY29udGFpbmVyJykuc3R5bGU7XHJcbiAgICBzLmhlaWdodCA9ICcyMDBweCc7XHJcbiAgICBzLmRpc3BsYXkgPSAndGFibGUtY2VsbCdcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaHRtbCkge1xyXG4gICAgbGV0IHRtcCA9IHRtcEVsZW1lbnQoaHRtbCk7XHJcbiAgICBmaXhQYWdlQnJlYWtzX2J5X0FTdGFuaXNsYXZza3kodG1wKTtcclxuICAgIGZpeEZsZXgodG1wKTtcclxuICAgIGZpeEltYWdlc0FsaWduKHRtcCk7XHJcbiAgICBmaXhUYWJsZXNBbGlnbih0bXApO1xyXG4gICAgcGFnZUJyZWFrcyh0bXApO1xyXG4gICAgcmV0dXJuIHBhZ2UodG1wKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcGFnZShlbCkge1xyXG4gICAgcmV0dXJuIGBcclxuICAgICAgICA8aHRtbD5cclxuICAgICAgICAgICAgPGhlYWQ+JHtzdHlsZSgpfTwvaGVhZD5cclxuICAgICAgICAgICAgPGJvZHk+JHtlbC5pbm5lckhUTUx9PC9ib2R5PlxyXG4gICAgICAgIDwvaHRtbD5cclxuICAgIGA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0eWxlKCkge1xyXG4gICAgcmV0dXJuIGBcclxuICAgICAgICAke3BhZ2VTdHlsZXN9XHJcbiAgICAgICAgPHN0eWxlPlxyXG4gICAgICAgICAgIFxyXG4gICAgICAgICAgICBmaWd1cmUgPiBpbWcge1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XHJcbiAgICAgICAgICAgICAgICBtYXJnaW46IDAgYXV0bztcclxuICAgICAgICAgICAgICAgIG1heC13aWR0aDogMTAwJTtcclxuICAgICAgICAgICAgICAgIG1pbi13aWR0aDogNTBweDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmaWd1cmUuaW1hZ2UuaW1hZ2VfcmVzaXplZCBpbWcge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAuaW1hZ2Utc3R5bGUtYWxpZ24tbGVmdCB7XHJcbiAgICAgICAgICAgICAgICBmbG9hdDogbGVmdDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgIC5pbWFnZS1zdHlsZS1hbGlnbi1yaWdodCB7XHJcbiAgICAgICAgICAgICAgICBmbG9hdDogcmlnaHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgPC9zdHlsZT5cclxuICAgIGA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBhZ2VCcmVha3ModG1wKSB7XHJcbiAgICB0bXAucXVlcnlTZWxlY3RvckFsbCgnLnBhZ2UtYnJlYWsnKS5mb3JFYWNoKGVsID0+IHtcclxuICAgICAgICBlbC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdwYWdlLWJyZWFrJylcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpeEZsZXgoZWwpIHtcclxuICAgIGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5yb3cnKS5mb3JFYWNoKHJvdyA9PiB7XHJcbiAgICAgICAgbGV0IGNvbHVtbnMgPSByb3cucXVlcnlTZWxlY3RvckFsbCgnLmNvbC14cycpXHJcbiAgICAgICAgY29sdW1ucy5mb3JFYWNoKGNvbCA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzID0gY29sLnN0eWxlO1xyXG4gICAgICAgICAgICBzLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcclxuICAgICAgICAgICAgcy5mbG9hdCA9IFwibGVmdFwiO1xyXG4gICAgICAgICAgICBzLm1pbldpZHRoID0gcy53aWR0aCA9IDEwMCAvIGNvbHVtbnMubGVuZ3RoICsgJyUnO1xyXG4gICAgICAgICAgICBzLnZlcnRpY2FsQWxpZ24gPSAndG9wJztcclxuICAgICAgICAgICAgLy8gcy5wYWRkaW5nID0gXCIwIDNweFwiO1xyXG4gICAgICAgICAgICAvLyBzLmJhY2tncm91bmRDb2xvciA9IGBoc2woJHtNYXRoLnJhbmRvbSgpKjM2MH0sNTUlLDg1JSlgXHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpeEltYWdlc0FsaWduKGVsKSB7XHJcbiAgICBlbC5xdWVyeVNlbGVjdG9yQWxsKCdmaWd1cmUuaW1hZ2UnKS5mb3JFYWNoKGltZ0Jsb2NrID0+IHtcclxuICAgICAgICBsZXQgY2VudGVyQWxpZ24gPSAhaW1nQmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdpbWFnZS1zdHlsZS1hbGlnbi1sZWZ0JylcclxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgIWltZ0Jsb2NrLmNsYXNzTGlzdC5jb250YWlucygnaW1hZ2Utc3R5bGUtYWxpZ24tcmlnaHQnKTtcclxuICAgICAgICBpZiAoY2VudGVyQWxpZ24pXHJcbiAgICAgICAgICAgIGltZ0Jsb2NrLnBhcmVudE5vZGUuc3R5bGUudGV4dEFsaWduID0gXCJjZW50ZXJcIlxyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gZml4VGFibGVzQWxpZ24oZWwpIHtcclxuICAgIGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZpZ3VyZS50YWJsZScpLmZvckVhY2godGFibGVCbG9jayA9PiB7XHJcbiAgICAgICAgbGV0IGNlbnRlckFsaWduID0gIXRhYmxlQmxvY2suc3R5bGUuZmxvYXQ7XHJcbiAgICAgICAgaWYgKCFjZW50ZXJBbGlnbikgcmV0dXJuXHJcbiAgICAgICAgdGFibGVCbG9jay5wYXJlbnROb2RlLnN0eWxlLnRleHRBbGlnbiA9IFwiY2VudGVyXCJcclxuICAgICAgICB0YWJsZUJsb2NrLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZS1ibG9ja1wiXHJcbiAgICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiB0bXBFbGVtZW50KGh0bWwpIHtcclxuICAgIGxldCB0bXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHRtcC5pbm5lckhUTUwgPSBodG1sO1xyXG4gICAgcmV0dXJuIHRtcDtcclxufSIsImxldCBmaWxsID0gJyM0MzJjMTInXHJcblxyXG5sZXQgbW92ZSA9IGBcclxuICAgIDxwYXRoIGQ9XCJNMzUyLjIwMSA0MjUuNzc1bC03OS4xOTYgNzkuMTk2Yy05LjM3MyA5LjM3My0yNC41NjggOS4zNzMtMzMuOTQxIFxyXG4gICAgICAgIDBsLTc5LjE5Ni03OS4xOTZjLTE1LjExOS0xNS4xMTktNC40MTEtNDAuOTcxIDE2Ljk3MS00MC45N2g1MS4xNjJMMjI4IDI4NEgxMjcuMTk2djUxLjE2MmMwIFxyXG4gICAgICAgIDIxLjM4Mi0yNS44NTEgMzIuMDktNDAuOTcxIDE2Ljk3MUw3LjAyOSAyNzIuOTM3Yy05LjM3My05LjM3My05LjM3My0yNC41NjkgMC0zMy45NDFMODYuMjI1IFxyXG4gICAgICAgIDE1OS44YzE1LjExOS0xNS4xMTkgNDAuOTcxLTQuNDExIDQwLjk3MSAxNi45NzFWMjI4SDIyOFYxMjcuMTk2aC01MS4yM2MtMjEuMzgyIFxyXG4gICAgICAgIDAtMzIuMDktMjUuODUxLTE2Ljk3MS00MC45NzFsNzkuMTk2LTc5LjE5NmM5LjM3My05LjM3MyAyNC41NjgtOS4zNzMgMzMuOTQxIDBsNzkuMTk2IDc5LjE5NmMxNS4xMTkgXHJcbiAgICAgICAgMTUuMTE5IDQuNDExIDQwLjk3MS0xNi45NzEgNDAuOTcxaC01MS4xNjJWMjI4aDEwMC44MDR2LTUxLjE2MmMwLTIxLjM4MiAyNS44NTEtMzIuMDkgXHJcbiAgICAgICAgNDAuOTctMTYuOTcxbDc5LjE5NiA3OS4xOTZjOS4zNzMgOS4zNzMgOS4zNzMgMjQuNTY5IDAgMzMuOTQxTDQyNS43NzMgMzUyLjJjLTE1LjExOSAxNS4xMTktNDAuOTcxIFxyXG4gICAgICAgIDQuNDExLTQwLjk3LTE2Ljk3MVYyODRIMjg0djEwMC44MDRoNTEuMjNjMjEuMzgyIDAgMzIuMDkgMjUuODUxIDE2Ljk3MSA0MC45NzF6XCIvPlxyXG5gO1xyXG5cclxubGV0IGNvcHkgPSBgXHJcbiAgICA8cGF0aCBmaWxsPVwiJHtmaWxsfVwiIGQ9XCJNMzIwIDQ0OHY0MGMwIDEzLjI1NS0xMC43NDUgMjQtMjQgMjRIMjRjLTEzLjI1NSBcclxuICAgICAgICAwLTI0LTEwLjc0NS0yNC0yNFYxMjBjMC0xMy4yNTUgMTAuNzQ1LTI0IDI0LTI0aDcydjI5NmMwIFxyXG4gICAgICAgIDMwLjg3OSAyNS4xMjEgNTYgNTYgNTZoMTY4em0wLTM0NFYwSDE1MmMtMTMuMjU1IDAtMjQgMTAuNzQ1LTI0IDI0djM2OGMwIFxyXG4gICAgICAgIDEzLjI1NSAxMC43NDUgMjQgMjQgMjRoMjcyYzEzLjI1NSAwIDI0LTEwLjc0NSAyNC0yNFYxMjhIMzQ0Yy0xMy4yIFxyXG4gICAgICAgIDAtMjQtMTAuOC0yNC0yNHptMTIwLjk3MS0zMS4wMjlMMzc1LjAyOSA3LjAyOUEyNCAyNCAwIDAgMCAzNTguMDU5IFxyXG4gICAgICAgIDBIMzUydjk2aDk2di02LjA1OWEyNCAyNCAwIDAgMC03LjAyOS0xNi45N3pcIi8+XHJcbmA7XHJcblxyXG5sZXQgZGVsID0gYFxyXG4gICAgPHBhdGggZmlsbD1cIiR7ZmlsbH1cIiBkPVwiTTgxICA4MSBsMzUwICAzNTAgbC00MCA0MCBsLTM1MCAtMzUwelwiLz5cclxuICAgIDxwYXRoIGZpbGw9XCIke2ZpbGx9XCIgZD1cIk00MTEgODEgbC0zNTAgMzUwIGw0MCAgNDAgbDM1MCAgLTM1MHpcIi8+XHJcbmA7XHJcblxyXG5sZXQgZG93biA9IGBcclxuICAgIDxwYXRoIGZpbGw9XCIke2ZpbGx9XCIgZD1cIk01MCAxNTAgbDIwMCAyMDAgbDIwMCAtMjAwelwiLz5cclxuYDtcclxuXHJcbmxldCB1cCA9IGBcclxuICAgIDxwYXRoIGZpbGw9XCIke2ZpbGx9XCIgZD1cIk01MCAzNTAgbDIwMCAtMjAwIGwyMDAgMjAwelwiLz5cclxuYDtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgbW92ZTogKHcsIGgpID0+IHN2Zyh3LCBoLCBtb3ZlLCBbLTUwLCAtNTAsIDYxMiwgNjEyXSksXHJcbiAgICBjb3B5OiAodywgaCkgPT4gc3ZnKHcsIGgsIGNvcHkpLFxyXG4gICAgZGVsOiAodywgaCkgPT4gc3ZnKHcsIGgsIGRlbCksXHJcbiAgICB1cDogKHcsIGgpID0+IHN2Zyh3LCBoLCB1cCksXHJcbiAgICBkb3duOiAodywgaCkgPT4gc3ZnKHcsIGgsZG93bilcclxufTtcclxuXHJcbmZ1bmN0aW9uIHN2Zyh3LCBoLCBodG1sLCB2Yikge1xyXG4gICAgdmIgPSB2YiB8fCBbLTUwLCAtNTAsIDU0OCwgNjEyXTtcclxuICAgIHJldHVybiBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgXHJcbiAgICAgICAgICAgICAgICB2aWV3Qm94PVwiJHt2Yn1cIiBcclxuICAgICAgICAgICAgICAgIHdpZHRoPVwiJHt3fXB4XCIgIFxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0PVwiJHtofXB4XCI+XHJcbiAgICAgICAgICAgICR7aHRtbH1cclxuICAgICAgICA8L3N2Zz5gXHJcbn0iLCJyZXF1aXJlKCcuL3BkZi1lZGl0b3IuY3NzJyk7XHJcbnJlcXVpcmUoJy4uLy4uL2RlcGVuZGVuY2llcy9mbGV4Ym94Z3JpZC9mbGV4Ym94Z3JpZC5taW4uY3NzJyk7XHJcbmxldCB2ZXIgPSByZXF1aXJlKCcuLi8uLi9wYWNrYWdlLmpzb24nKS52ZXJzaW9uXHJcblxyXG5sZXQgZG5kID0gcmVxdWlyZSgnLi9kbmQnKVxyXG5sZXQgaHRtbFRlbXBsYXRlID0gcmVxdWlyZSgnLi9odG1sLXRlbXBsYXRlJyk7XHJcbmxldCBUZXh0RWRpdG9yID0gcmVxdWlyZSgnLi9Da0VkaXRvcjUnKTtcclxubGV0IGJsb2NrcyA9IHJlcXVpcmUoJy4vYmxvY2tzJyk7XHJcbmxldCBzdmdPdmVybGF5ID0gcmVxdWlyZSgnLi9zdmdPdmVybGF5L3N2Z092ZXJsYXknKTtcclxubGV0IGRvY3VtZW50Q2xlYW5lciA9IHJlcXVpcmUoJy4vZG9jdW1lbnRDbGVhbmVyJyk7XHJcbmxldCBmb3JJdGV4dEZvcm1hdHRlciA9IHJlcXVpcmUoJy4vRm9ySXRleHRGb3JtYXR0ZXInKTtcclxubGV0IG1vdXNlb3ZlckJ1dHRvbnMgPSByZXF1aXJlKCcuL21vdXNlb3ZlckJ1dHRvbnMnKTtcclxubGV0IHBhZ2VTdHlsZXMgPSByZXF1aXJlKCcuL3BhZ2Utc3R5bGVzJyk7XHJcbmxldCBUZW1wbGF0ZXNGYWN0b3J5ID0gcmVxdWlyZSgnLi9UZW1wbGF0ZXNGYWN0b3J5Jyk7XHJcbmxldCB0ZW1wbGF0ZXNGYWN0b3J5ID0gbmV3IFRlbXBsYXRlc0ZhY3RvcnkoKTtcclxuXHJcbmNsYXNzIFBkZkVkaXRvciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcGVydGllcykge1xyXG4gICAgICAgIHRoaXMucHJvcGVydGllcyA9IHByb3BlcnRpZXMgfHwge307XHJcbiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzLmJsb2NrUHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllcy5ibG9ja1Byb3BlcnRpZXMgfHwge31cclxuICAgICAgICB0aGlzLnByb3BlcnRpZXMuYnV0dG9uc1NpemUgPSB0aGlzLnByb3BlcnRpZXMuYnV0dG9uc1NpemUgfHwgMjU7XHJcbiAgICAgICAgdGhpcy5pbml0UGRmRWRpdG9yKCk7XHJcbiAgICAgICAgdGhpcy53cml0ZVZlcnNpb24oKTtcclxuICAgICAgICBkbmQuaW5pdERuRCh0aGlzKVxyXG5cclxuICAgICAgICB0aGlzLmluaXRDb2xsYXBzZVBhbmVscygpXHJcbiAgICAgICAgdGhpcy5pbml0Q2xlYXJCbG9ja1NlbGVjdGlvbk9uQ2xpY2tJbk1pbGtMaXN0ZW5lcigpO1xyXG5cclxuICAgICAgICBibG9ja3MuaW5pdEJsb2Nrcyh0aGlzKTtcclxuICAgICAgICBzdmdPdmVybGF5LmluaXRTdmdPdmVybGF5KHRoaXMpO1xyXG5cclxuICAgICAgICBhZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm1hbmFnZUhvdmVyU3RhdGUoKVxyXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUVtcHR5Um93cygpXHJcbiAgICAgICAgfSlcclxuICAgICAgICBjb25zb2xlLmxvZygncGRmLWVkaXRvcjogJyArIHZlcilcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVFbXB0eVJvd3MoKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBhbGxCbG9ja3MgPSB0aGlzLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBkZi1lZGl0b3IgLnBhZ2UgPiAudGVtcGxhdGUnKTtcclxuICAgICAgICAgICAgYWxsQmxvY2tzLmZvckVhY2goYiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWIuZmlyc3RDaGlsZClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJOb3ROZWVkZWRSb3dzKGIuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYi5jaGlsZEVsZW1lbnRDb3VudCA9PT0gMSlcclxuICAgICAgICAgICAgICAgICAgICBiLmZpcnN0Q2hpbGQuY2xhc3NMaXN0LnJlbW92ZSgnZW1wdHktZHJvcC16b25lJylcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1hbmFnZUV4dHJhUm93cyhiLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tYXJrRW1wdHlSb3dzKGIuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBpbml0UGRmRWRpdG9yKCkge1xyXG4gICAgICAgIGxldCB0YXJnZXRFbGVtZW50ID0gdGhpcy5wcm9wZXJ0aWVzLnRhcmdldDtcclxuICAgICAgICBpZiAodHlwZW9mIHRhcmdldEVsZW1lbnQgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgIHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldEVsZW1lbnQpO1xyXG4gICAgICAgIHRhcmdldEVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbFRlbXBsYXRlKHRoaXMucHJvcGVydGllcyk7XHJcbiAgICAgICAgdGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuc2lkZVBhbmVsICNibG9ja3MnKVxyXG4gICAgICAgICAgICAuaW5uZXJIVE1MID0gdGVtcGxhdGVzRmFjdG9yeS5jcmVhdGVCbG9ja3MoKTtcclxuICAgICAgICB0YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zaWRlUGFuZWwgI2VsZW1lbnRzJylcclxuICAgICAgICAgICAgLmlubmVySFRNTCA9IHRlbXBsYXRlc0ZhY3RvcnkuY3JlYXRlRWxlbWVudHMoKTtcclxuICAgICAgICB0YXJnZXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsXHJcbiAgICAgICAgICAgIGUgPT4gbW91c2VvdmVyQnV0dG9ucy5tYW5hZ2UoZSwgdGhpcykpO1xyXG5cclxuICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnQgPSB0YXJnZXRFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHdyaXRlVmVyc2lvbigpe1xyXG4gICAgICAgIGxldCBwYWdlID0gdGhpcy50YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJyk7XHJcbiAgICAgICAgaWYgKCFwYWdlLmdldEF0dHJpYnV0ZSgnY3JlYXRlZC12ZXInKSlcclxuICAgICAgICAgICAgcGFnZS5zZXRBdHRyaWJ1dGUoJ2NyZWF0ZWQtdmVyJywgdmVyKTtcclxuICAgICAgICBwYWdlLnNldEF0dHJpYnV0ZSgnbGFzdC1lZGl0ZWQtdmVyJywgdmVyKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0Q2xlYXJCbG9ja1NlbGVjdGlvbk9uQ2xpY2tJbk1pbGtMaXN0ZW5lcigpIHtcclxuICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2xlYXIgPSBbJ2NvbnRlbnQnLCAncGFnZSddLmZpbmQoYyA9PiBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYykpXHJcbiAgICAgICAgICAgIGNsZWFyIHw9IGUudGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlLWJyZWFrJyk7XHJcbiAgICAgICAgICAgIGlmIChjbGVhcilcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xpY2tPbkJsb2NrKG51bGwpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdENvbGxhcHNlUGFuZWxzKCkge1xyXG4gICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3JvdXBOYW1lJykuZm9yRWFjaChncm91cE5hbWUgPT4ge1xyXG4gICAgICAgICAgICBncm91cE5hbWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBncm91cE5hbWUuY2xhc3NMaXN0LnRvZ2dsZSgnY29sbGFwc2VkJylcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgbWFuYWdlSG92ZXJTdGF0ZSh0YXJnZXQpIHtcclxuICAgICAgICBpZiAodGFyZ2V0ID09PSB0aGlzLmxhc3RIb3ZlcilcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMubGFzdEhvdmVyID0gdGFyZ2V0O1xyXG4gICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGFnZS5jb250YWluZXIgPiAudGVtcGxhdGUnKVxyXG4gICAgICAgICAgICAuZm9yRWFjaCh0cGwgPT4gdHBsLmNsYXNzTGlzdC5yZW1vdmUoJ2hvdmVyLXN0YXRlJykpXHJcbiAgICAgICAgaWYgKCF0YXJnZXQpXHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKCdob3Zlci1zdGF0ZScpXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1hcmtFbXB0eVJvd3ModGFyZ2V0KSB7XHJcbiAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCgnLmRyb3B6b25lJykuZm9yRWFjaChkeiA9PiB7XHJcbiAgICAgICAgICAgIGxldCBlbXB0eSA9IGR6LmlubmVySFRNTC50cmltKCkgPT09ICcnO1xyXG4gICAgICAgICAgICBkei5jbGFzc0xpc3QudG9nZ2xlKCdlbXB0eS1kcm9wLXpvbmUnLCBlbXB0eSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBtYW5hZ2VFeHRyYVJvd3ModGFyZ2V0KSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ21hbmFnZUV4dHJhUm93cycpXHJcbiAgICAgICAgbGV0IGZpcnN0ID0gWy4uLnRhcmdldC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJy5kcm9wem9uZScpXS5zaGlmdCgpXHJcbiAgICAgICAgaWYgKGZpcnN0ICYmIGZpcnN0LmlubmVySFRNTC50cmltKCkgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLm5ld0Ryb3Bab25lKCksIGZpcnN0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGxhc3QgPSBbLi4udGFyZ2V0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCgnLmRyb3B6b25lJyldLnBvcCgpXHJcbiAgICAgICAgaWYgKGxhc3QgJiYgbGFzdC5pbm5lckhUTUwudHJpbSgpICE9PSAnJykge1xyXG4gICAgICAgICAgICB0YXJnZXQucGFyZW50Tm9kZS5hcHBlbmQodGhpcy5uZXdEcm9wWm9uZSgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJOb3ROZWVkZWRSb3dzKHRhcmdldCkge1xyXG4gICAgICAgIHRyeSB7IC8vIGNvbnNvbGUubG9nKCdjbGVhck5vdE5lZWRlZFJvd3MnKVxyXG4gICAgICAgICAgICBsZXQgZHJvcFpvbmVzID0gdGFyZ2V0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCgnLmRyb3B6b25lJyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZHJvcFpvbmVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZHJvcFpvbmVzLmxlbmd0aCA+IDEgJiYgZHJvcFpvbmVzW2ldLmlubmVySFRNTC50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcFpvbmVzW2ldLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRuZC5yZW1vdmVFbGVtZW50KGRyb3Bab25lc1tpXSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBuZXdEcm9wWm9uZSgpIHtcclxuICAgICAgICBsZXQgZHogPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBkei5jbGFzc05hbWUgPSAnZHJvcHpvbmUgcm93JztcclxuICAgICAgICB0aGlzLmluaXREeihkeik7XHJcbiAgICAgICAgcmV0dXJuIGR6XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdEVkaXRvcihlbCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQnlTZWwoJy5kei1idXR0b25zLCAudGVtcGxhdGUtYnV0dG9ucycpO1xyXG4gICAgICAgIFRleHRFZGl0b3IuaW5pdFRleHRFZGl0b3IoZWwpXHJcbiAgICB9XHJcblxyXG4gICAgaW5pdER6KGRyb3Bab25lKSB7XHJcbiAgICAgICAgZG5kLnB1c2hFbGVtZW50KGRyb3Bab25lKTtcclxuICAgICAgICBkcm9wWm9uZS5jbGFzc0xpc3QucmVtb3ZlKCdvcmlnaW4nKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVCeVNlbChzZWwpIHtcclxuICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWwpXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKGUgPT4gZS5yZW1vdmUoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xpY2tPbkJsb2NrKGVsKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEJsb2NrID0gZWw7XHJcbiAgICAgICAgYmxvY2tzLmhhbmRsZUNsaWNrKGVsKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBwdWJsaWMgYXBpXHJcblxyXG4gICAgZ2V0RG9jdW1lbnQoKSB7XHJcbiAgICAgICAgbGV0IHBhZ2VDb250ZW50ID0gdGhpcy50YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJykub3V0ZXJIVE1MO1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudENsZWFuZXIocGFnZUNvbnRlbnQpLmlubmVySFRNTDtcclxuICAgIH1cclxuXHJcbiAgICBmb3JJdGV4dChodG1sKXtcclxuICAgICAgICByZXR1cm4gZm9ySXRleHRGb3JtYXR0ZXIoaHRtbCB8fCB0aGlzLmdldERvY3VtZW50KCkpXHJcbiAgICB9XHJcblxyXG4gICAgbG9hZERvY3VtZW50KGRhdGEpIHtcclxuICAgICAgICBpZiAoIWRhdGEpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBsZXQgY29udGVudCA9IHRoaXMudGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpO1xyXG4gICAgICAgIGNvbnRlbnQuaW5uZXJIVE1MID0gcGFnZVN0eWxlcyArIGRhdGE7XHJcbiAgICAgICAgY29udGVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGVhZGVyQmxvY2ssIC50ZXh0QmxvY2ssIC5pbWdCbG9jaywgLnRhYmxlQmxvY2snKS5mb3JFYWNoKGVsID0+IHtcclxuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnYWRkX2VkaXRvcl9oZXJlJylcclxuICAgICAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnY2stZWRpdG9yX19lZGl0YWJsZV9pbmxpbmUnKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgbGV0IHRlbXBsYXRlcyA9IGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnLnRlbXBsYXRlJyk7XHJcbiAgICAgICAgdGVtcGxhdGVzLmZvckVhY2godHBsID0+IGJsb2Nrcy5pbml0VGVtcGxhdGUodHBsLCAnLmRyb3B6b25lJykpO1xyXG5cclxuICAgICAgICBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wYWdlID4gLnRlbXBsYXRlJykuZm9yRWFjaChibG9jayA9PiB7XHJcbiAgICAgICAgICAgIGlmKCFibG9jay5maXJzdENoaWxkKXJldHVyblxyXG4gICAgICAgICAgICB0aGlzLm1hbmFnZUV4dHJhUm93cyhibG9jay5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgdGhpcy5tYXJrRW1wdHlSb3dzKGJsb2NrLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGRuZC5wdXNoRWxlbWVudChjb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJykpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFBhZ2VTdHlsZXMoKXtcclxuICAgICAgICByZXR1cm4gcGFnZVN0eWxlcztcclxuICAgIH1cclxufVxyXG5cclxud2luZG93LlBkZkVkaXRvciA9IFBkZkVkaXRvcjsiLCJjbGFzcyBUZW1wbGF0ZXNGYWN0b3J5IHtcclxuXHJcbiAgICBjcmVhdGVCbG9ja3MoKSB7XHJcbiAgICAgICAgbGV0IHJvdyA9IGA8ZGl2IGNsYXNzPSdkcm9wem9uZSBvcmlnaW4gcm93Jz48L2Rpdj5gO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZVRlbXBsYXRlKHJvdykgKyB0aGlzLmNyZWF0ZVRlbXBsYXRlKHRoaXMucGFnZUJyZWFrQmxvY2soKSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgICBjcmVhdGVUZW1wbGF0ZShjb250ZW50LCBjb2wpIHtcclxuICAgICAgICByZXR1cm4gYDxkaXYgY2xhc3M9J3RlbXBsYXRlICR7Y29sPydjb2wteHMnOicnfSc+JHtjb250ZW50fTwvZGl2PmA7XHJcbiAgICB9XHJcblxyXG4gICAgIGltZ0Jsb2NrKCkge1xyXG4gICAgICAgIGxldCBzdmcgPSBgPHN2ZyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSd4TWlkWU1pZCBtZWV0JyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9JzEwMHB4JyBoZWlnaHQ9JzEwMHB4JyB2aWV3Ym94PScwIDAgMTAwIDEwMCc+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggc3Ryb2tlPSdibGFjaycgZmlsbD0nbm9uZScgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZD0nTTEwLDkwdi0yMGwzMCwtMzBsMTUsMTVsMzUsLTM1djcweiBNNSw1aDkwdjkwaC05MHogTTMwLDEwYTEwLDEwLDAsMSwwLDAuMDAxLDB6Jz48L3BhdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvc3ZnPmA7XHJcbiAgICAgICAgcmV0dXJuIGA8aW1nIGRyYWdnYWJsZT1cImZhbHNlXCIgY2xhc3M9XCJpbWdcIiB3aWR0aD1cIjEwMHB4XCIgaGVpZ2h0PVwiMTAwcHhcIiAgc3JjPVwiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCwke2J0b2Eoc3ZnKX1cIiA+YDtcclxuICAgIH1cclxuXHJcbiAgICAgdGV4dEJsb2NrKCkge1xyXG4gICAgICAgIHJldHVybiBgPHNwYW4+XHJcbiAgICAgICAgICAgICAgICAgICAg0JXRgdC70Lgg0YMg0LzQtdC90Y8g0LzQvdC+0LPQviDQmtCmINC10YHRgtGMLCDRjyDQuNC80LXRjiDQv9GA0LDQstC+INC90L7RgdC40YLRjCDQvNCw0LvQuNC90L7QstGL0LUg0YjRgtCw0L3RiywgXHJcbiAgICAgICAgICAgICAgICAgICAg0Lgg0L/QtdGA0LXQtNC+INC80L3QvtC5INC4INC/0LDRhtCw0Log0LTQvtC70LbQtdC9IDIg0YDQsNC30LAg0L/RgNC40YHQtdC00LDRgtGMLCDQuCDRh9Cw0YLQu9Cw0L3QuNC9INC60YMg0LTQtdC70LDRgtGMLCBcclxuICAgICAgICAgICAgICAgICAgICDQuCDRjdGG0LjQu9C+0L8g0LzQtdC90Y8g0L3QtSDQuNC80LXQtdGCINC/0YDQsNCy0LAg0LHQuNGC0Ywg0L/QviDQvdC+0YfQsNC8LCDQvdC40LrQvtCz0LTQsCFcclxuICAgICAgICAgICAgICAgIDwvc3Bhbj5gXHJcbiAgICB9XHJcblxyXG4gICAgIHRhYmxlQmxvY2soKSB7XHJcbiAgICAgICAgbGV0IHQgPSB0aGlzLnRkKCk7XHJcbiAgICAgICAgdCArPSB0ICsgdCArIHQ7XHJcbiAgICAgICAgdCA9IGA8dHI+JHt0fTwvdHI+YDtcclxuICAgICAgICB0ICs9IHQgKyB0O1xyXG4gICAgICAgIHJldHVybiBgPHRhYmxlIHN0eWxlPVwiYm9yZGVyOiAxLjVweCBzb2xpZFwiPjx0Ym9keT4ke3R9PC90Ym9keT48L3RhYmxlPmBcclxuICAgIH1cclxuXHJcbiAgICB0ZCgpIHtcclxuICAgICAgICByZXR1cm4gYDx0ZCBzdHlsZT1cImJvcmRlcjogMS41cHggc29saWRcIj48L3RkPmBcclxuICAgIH1cclxuXHJcbiAgICAgaGVhZGVyQmxvY2soKSB7XHJcbiAgICAgICAgcmV0dXJuIGA8cCBzdHlsZT1cInRleHQtYWxpZ246Y2VudGVyO1wiPjxzcGFuIGNsYXNzPVwidGV4dC1odWdlXCI+PHN0cm9uZz7Ql9Cw0LPQvtC70L7QstC+0Lo8L3N0cm9uZz48L3NwYW4+PC9wPmA7XHJcbiAgICB9XHJcblxyXG4gICAgIHBhZ2VCcmVha0Jsb2NrKCkge1xyXG4gICAgICAgIHJldHVybiBgPGRpdiBjbGFzcz1cInBhZ2UtYnJlYWtcIiBzdHlsZT1cInBhZ2UtYnJlYWstYWZ0ZXI6IGFsd2F5c1wiPtGA0LDQt9GA0YvQsiDRgdGC0YDQsNC90LjRhtGLPC9kaXY+YDtcclxuICAgIH1cclxuXHJcbiAgICAgY3JlYXRlRWxlbWVudHMoKSB7XHJcbiAgICAgICAgcmV0dXJuICBbXHJcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyQmxvY2ssXHJcbiAgICAgICAgICAgIHRoaXMudGV4dEJsb2NrLFxyXG4gICAgICAgICAgICB0aGlzLmltZ0Jsb2NrLFxyXG4gICAgICAgICAgICB0aGlzLnRhYmxlQmxvY2tcclxuICAgICAgICBdLm1hcChmbiA9PiB7XHJcbiAgICAgICAgICAgIGxldCBjb250ZW50ID0gYDxkaXYgY2xhc3M9XCIke2ZuLm5hbWV9IGFkZF9lZGl0b3JfaGVyZVwiPiR7Zm4uY2FsbCh0aGlzKX08L2Rpdj5gO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVUZW1wbGF0ZShjb250ZW50LCB0cnVlKVxyXG4gICAgICAgIH0pLmpvaW4oJycpXHJcbiAgICB9XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVGVtcGxhdGVzRmFjdG9yeTsiLCJsZXQgdGVtcGxhdGVzID0ge1xyXG5cclxuICAgIGJsb2NrX25hbWUgOiBgXHJcbiAgICAgICAgPGRpdiBjbGFzcz1cInN1Yi1sYWJlbFwiPtCd0LDQt9Cy0LDQvdC40LUg0LHQu9C+0LrQsDwvZGl2PlxyXG4gICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwiYmxvY2tfbmFtZVwiPlxyXG4gICAgYCxcclxuXHJcbiAgICBibG9ja19kZXNjciA6IGBcclxuICAgICAgICA8ZGl2IGNsYXNzPVwic3ViLWxhYmVsXCI+0J7Qv9C40YHQsNC90LjQtSDQsdC70L7QutCwPC9kaXY+XHJcbiAgICAgICAgPHRleHRhcmVhIGlkPVwiYmxvY2tfZGVzY3JcIj48L3RleHRhcmVhPlxyXG4gICAgYCxcclxuXHJcbiAgICBibG9ja19ub19lZGl0OiBgXHJcbiAgICAgICAgPGJyPlxyXG4gICAgICAgIDxpbnB1dCBpZD1cImJsb2NrX25vX2VkaXRcIiB0eXBlPVwiY2hlY2tib3hcIj5cclxuICAgICAgICA8bGFiZWwgZm9yPVwiYmxvY2tfbm9fZWRpdFwiIGNsYXNzPVwic3ViLWxhYmVsXCI+0KDQsNC30YDQtdGI0LjRgtGMINGA0LXQtNCw0LrRgtC40YDQvtCy0LDQvdC40LU8L2xhYmVsPlxyXG4gICAgYCxcclxuICAgIGJsb2NrX25vX21vdmU6IGBcclxuICAgICAgICA8YnI+XHJcbiAgICAgICAgPGlucHV0IGlkPVwiYmxvY2tfbm9fbW92ZVwiIHR5cGU9XCJjaGVja2JveFwiPlxyXG4gICAgICAgIDxsYWJlbCBmb3I9XCJibG9ja19ub19tb3ZlXCIgY2xhc3M9XCJzdWItbGFiZWxcIj7QoNCw0LfRgNC10YjQuNGC0Ywg0L/QtdGA0LXQvNC10YnQtdC90LjQtTwvbGFiZWw+ICAgICBcclxuICAgIGAsXHJcblxyXG4gICAgYmxvY2tfbm9fY29weTogYFxyXG4gICAgICAgIDxicj5cclxuICAgICAgICA8aW5wdXQgaWQ9XCJibG9ja19ub19jb3B5XCIgdHlwZT1cImNoZWNrYm94XCI+XHJcbiAgICAgICAgPGxhYmVsIGZvcj1cImJsb2NrX25vX2NvcHlcIiAgY2xhc3M9XCJzdWItbGFiZWxcIj7QoNCw0LfRgNC10YjQuNGC0Ywg0LrQvtC/0LjRgNC+0LLQsNC90LjQtTwvbGFiZWw+XHJcbiAgICBgLFxyXG4gICAgYmxvY2tfYXR0YWNoX2J1dHRvbjpgXHJcbiAgICAgICAgPGJyPlxyXG4gICAgICAgIDxicj5cclxuICAgICAgICA8YnV0dG9uPtCf0YDQuNC60YDQtdC/0LjRgtGMINC40Lcg0LHQsNC30Ys8L2J1dHRvbj5cclxuICAgIGBcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcblxyXG4gICAgaHRtbFRlbXBsYXRlOiBwcm9wZXJ0aWVzID0+IGBcclxuICAgICAgICAgPGRpdiBzdHlsZT1cInBhZGRpbmc6ICAwIDEwcHg7IGNvbG9yOndoaXRlOyB3aWR0aDoxMDAlXCI+XHJcbiAgICAgICAgICAgICR7T2JqZWN0LmVudHJpZXMocHJvcGVydGllcy5ibG9ja1Byb3BlcnRpZXMpLm1hcChwcm9wZXJ0eUJsb2NrKS5qb2luKCcnKX1cclxuICAgICAgICA8L2Rpdj5cclxuICAgIGAsXHJcblxyXG59O1xyXG5cclxuZnVuY3Rpb24gcHJvcGVydHlCbG9jayhlbnRyeSkge1xyXG4gICAgcmV0dXJuIGVudHJ5WzFdICE9PSBmYWxzZSA/IHRlbXBsYXRlc1tlbnRyeVswXV0gOiAnJztcclxufSIsIm1vZHVsZS5leHBvcnRzID0ge1xyXG5cclxuICAgIHBkZkVkaXRvcjogbnVsbCxcclxuXHJcbiAgICBuZXdCbG9ja05hbWVUZXh0OiAn0J3QvtCy0YvQuSDQsdC70L7QuiAnLFxyXG5cclxuICAgIHByb3BlcnR5S2V5czoge1xyXG4gICAgICAgIGJsb2NrX25hbWU6ICdibG9ja19uYW1lJyxcclxuICAgICAgICBibG9ja19kZXNjcjogJ2Jsb2NrX2Rlc2NyJyxcclxuICAgICAgICBibG9ja19ub19lZGl0OiAnYmxvY2tfbm9fZWRpdCcsXHJcbiAgICAgICAgYmxvY2tfbm9fbW92ZTogJ2Jsb2NrX25vX21vdmUnLFxyXG4gICAgICAgIGJsb2NrX25vX2NvcHk6ICdibG9ja19ub19jb3B5JyxcclxuICAgIH0sXHJcblxyXG4gICAgaW5pdEJsb2NrcyhwZGZFZGl0b3Ipe1xyXG4gICAgICAgIHRoaXMucGRmRWRpdG9yID0gcGRmRWRpdG9yO1xyXG4gICAgICAgIHRoaXMuaW5pdEJsb2NrRWRpdG9ycygpXHJcbiAgICB9LFxyXG5cclxuICAgIGhhbmRsZUNsaWNrKGVsKSB7XHJcbiAgICAgICAgbGV0IHBkZkVkaXRvciA9IHRoaXMucGRmRWRpdG9yO1xyXG5cclxuICAgICAgICBpZiAoIXBkZkVkaXRvci5wcm9wZXJ0aWVzLnByb3BlcnRpZXNQYWdlKVxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgaWYgKCFlbCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBsZXQga2V5cyA9IHRoaXMucHJvcGVydHlLZXlzO1xyXG5cclxuICAgICAgICBba2V5cy4gYmxvY2tfbmFtZSwga2V5cy4gYmxvY2tfZGVzY3JdLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgaWYgKHBkZkVkaXRvci5wcm9wZXJ0aWVzLmJsb2NrUHJvcGVydGllc1trZXldKVxyXG4gICAgICAgICAgICAgICAgcGRmRWRpdG9yLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignIycra2V5KS52YWx1ZSA9IGVsLmdldEF0dHJpYnV0ZShrZXkpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIFtrZXlzLiBibG9ja19ub19lZGl0LCBrZXlzLiBibG9ja19ub19tb3ZlLCBrZXlzLmJsb2NrX25vX2NvcHldLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgaWYgKHBkZkVkaXRvci5wcm9wZXJ0aWVzLmJsb2NrUHJvcGVydGllc1trZXldKVxyXG4gICAgICAgICAgICAgICAgcGRmRWRpdG9yLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignIycra2V5KS5jaGVja2VkID0gXCJ0cnVlXCIgIT09IGVsLmdldEF0dHJpYnV0ZShrZXkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBjb3B5QmxvY2soZSkge1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgbGV0IHRwbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50ZW1wbGF0ZScpO1xyXG4gICAgICAgIGxldCBjbG9uZWQgPSB0cGwuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgICAgICB0cGwucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUoY2xvbmVkLCB0cGwpO1xyXG4gICAgICAgIHRwbC5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZSh0cGwsIGNsb25lZCk7IC8vIHN0dXBpZCBoYWNrXHJcbiAgICAgICAgY2xvbmVkLmlkID0gXCJcIjtcclxuICAgICAgICBsZXQgbmFtZSA9IHRoaXMucHJvcGVydHlLZXlzLmJsb2NrX25hbWU7XHJcbiAgICAgICAgY2xvbmVkLnNldEF0dHJpYnV0ZShuYW1lLCBjbG9uZWQuZ2V0QXR0cmlidXRlKG5hbWUpICsgJyDQutC+0L/QuNGPJylcclxuICAgICAgICB0aGlzLmluaXRUZW1wbGF0ZShjbG9uZWQsICcuZHJvcHpvbmUnKTtcclxuXHJcbiAgICAgICAgY2xvbmVkLnF1ZXJ5U2VsZWN0b3JBbGwoJ2Rpdi5hZGRfZWRpdG9yX2hlcmUnKS5mb3JFYWNoKGVsID0+e1xyXG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdpbml0aWFsaXplZCcpO1xyXG4gICAgICAgICAgICB0aGlzLnBkZkVkaXRvci5pbml0RWRpdG9yKGVsKTtcclxuICAgICAgICB9KVxyXG4gICAgfSxcclxuXHJcbiAgICBpbml0VGVtcGxhdGUoZWwsIGRyb3Bab25lU2VsZWN0b3IpIHtcclxuICAgICAgICBpZiAoZWwucXVlcnlTZWxlY3RvcignLmRyb3B6b25lJykpIHtcclxuXHJcbiAgICAgICAgICAgIGlmICghZWwuaWQpXHJcbiAgICAgICAgICAgICAgICBlbC5pZCA9ICdibG9ja18nICsgdGhpcy5ybmQoKSArIHRoaXMucm5kKCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRoaXMucHJvcGVydHlLZXlzLmJsb2NrX25hbWU7XHJcbiAgICAgICAgICAgIGlmICghZWwuZ2V0QXR0cmlidXRlKG5hbWUpKVxyXG4gICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKG5hbWUsIHRoaXMuZmluZE5leHROdW1iZXIoKSk7XHJcblxyXG4gICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMucGRmRWRpdG9yLmNsaWNrT25CbG9jayhlbCkpO1xyXG4gICAgICAgICAgICBlbC5xdWVyeVNlbGVjdG9yQWxsKGRyb3Bab25lU2VsZWN0b3IpLmZvckVhY2goZHogPT4gdGhpcy5wZGZFZGl0b3IuaW5pdER6KGR6KSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wZGZFZGl0b3IuaW5pdEVkaXRvcihlbC5xdWVyeVNlbGVjdG9yKCdkaXYuYWRkX2VkaXRvcl9oZXJlJykpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgcm5kKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMik7XHJcbiAgICB9LFxyXG5cclxuICAgIGZpbmROZXh0TnVtYmVyKCkge1xyXG4gICAgICAgIGxldCBudW1iZXJzID0gWy4uLnRoaXMucGRmRWRpdG9yLnRhcmdldEVsZW1lbnQgLnF1ZXJ5U2VsZWN0b3JBbGwoJy5wYWdlID4gLnRlbXBsYXRlJyldLm1hcChlbCA9PiB7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gZWwuZ2V0QXR0cmlidXRlKHRoaXMucHJvcGVydHlLZXlzLmJsb2NrX25hbWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmFtZSAmJiBwYXJzZUludChuYW1lLnNwbGl0KHRoaXMubmV3QmxvY2tOYW1lVGV4dCkucG9wKCkpO1xyXG4gICAgICAgIH0pLmZpbHRlcihuID0+IG4pO1xyXG4gICAgICAgIGxldCBpID0gMTtcclxuICAgICAgICBmb3IgKDsgaSA8IDFlNTsgaSsrKVxyXG4gICAgICAgICAgICBpZiAobnVtYmVycy5pbmRleE9mKGkpID09PSAtMSlcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5ld0Jsb2NrTmFtZVRleHQgKyBpO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbml0QmxvY2tFZGl0b3JzKCkge1xyXG4gICAgICAgIGxldCAgcGRmRWRpdG9yID0gdGhpcy5wZGZFZGl0b3I7XHJcbiAgICAgICAgaWYgKCFwZGZFZGl0b3IucHJvcGVydGllcy5wcm9wZXJ0aWVzUGFnZSlcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5wcm9wZXJ0eUtleXMpLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgICAgIGlmIChwZGZFZGl0b3IucHJvcGVydGllcy5ibG9ja1Byb3BlcnRpZXNbaWRdKVxyXG4gICAgICAgICAgICAgICAgcGRmRWRpdG9yLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignIycraWQpLm9uaW5wdXQgPSBvbklucHV0O1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbklucHV0KCkge1xyXG4gICAgICAgICAgICBpZiAoIXBkZkVkaXRvci5zZWxlY3RlZEJsb2NrIHx8ICFwZGZFZGl0b3IucHJvcGVydGllcy5ibG9ja1Byb3BlcnRpZXNbdGhpcy5pZF0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coc2VsZi5zZWxlY3RlZERyb3B6b25lKVxyXG4gICAgICAgICAgICBwZGZFZGl0b3Iuc2VsZWN0ZWRCbG9jay5zZXRBdHRyaWJ1dGUodGhpcy5pZCxcclxuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9PT0gJ2NoZWNrYm94JyA/ICF0aGlzLmNoZWNrZWQgOiB0aGlzLnZhbHVlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlkICE9PSAnYmxvY2tfbm9fZWRpdCcpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIHBkZkVkaXRvci5zZWxlY3RlZEJsb2NrXHJcbiAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbCgnLmFkZF9lZGl0b3JfaGVyZScpXHJcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tlZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCB0cnVlKVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnKVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcbiIsInJlcXVpcmUoJy4uLy4uL25vZGVfbW9kdWxlcy9kcmFndWxhL2Rpc3QvZHJhZ3VsYS5taW4uY3NzJyk7XHJcbmxldCBkcmFndWxhID0gcmVxdWlyZSgnZHJhZ3VsYScpO1xyXG5sZXQgYmxvY2tzID0gcmVxdWlyZSgnLi9ibG9ja3MnKTtcclxuXHJcbmxldCBkcmFrZTtcclxubGV0IHBkZkVkaXRvcjtcclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBpbml0RG5EKHBkZkVkaXRvckluc3RhbmNlKSB7XHJcbiAgICAgICAgcGRmRWRpdG9yID0gcGRmRWRpdG9ySW5zdGFuY2U7XHJcbiAgICAgICAgZHJha2UgPSBkcmFndWxhKFtcclxuICAgICAgICAgICAgcGRmRWRpdG9yLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Jsb2NrcycpLFxyXG4gICAgICAgICAgICBwZGZFZGl0b3IudGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjZWxlbWVudHMnKSxcclxuICAgICAgICAgICAgcGRmRWRpdG9yLnRhcmdldEVsZW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2UnKVxyXG4gICAgICAgIF0sIHtcclxuICAgICAgICAgICAgcmVtb3ZlT25TcGlsbDogdHJ1ZSxcclxuICAgICAgICAgICAgY29weTogZnVuY3Rpb24gKGVsLCBzb3VyY2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2UuY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZW1wbGF0ZXMnKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgYWNjZXB0czogKGVsLCB0YXJnZXQpID0+IGRyb3BBY2NlcHRzKGVsLCB0YXJnZXQpLFxyXG4gICAgICAgICAgICBtb3ZlczogZnVuY3Rpb24gKGVsLCBjb250YWluZXIsIGhhbmRsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZS5jbGFzc0xpc3QuY29udGFpbnMoJ2hhbmRsZScpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygndGVtcGxhdGVzJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZHJha2Uub24oJ2RyYWcnLCBlID0+IGRyYWdTdGFydChlKSk7XHJcbiAgICAgICAgZHJha2Uub24oJ2Ryb3AnLCAoZWwsIHRhcmdldCkgPT4gaGFuZGxlRHJvcChlbCwgdGFyZ2V0KSk7XHJcbiAgICB9LFxyXG4gICAgcHVzaEVsZW1lbnQoZWxlbWVudCkge1xyXG4gICAgICAgIGRyYWtlLmNvbnRhaW5lcnMucHVzaChlbGVtZW50KVxyXG4gICAgfSxcclxuICAgIHJlbW92ZUVsZW1lbnQoZWxlbWVudCkge1xyXG4gICAgICAgIGRyYWtlLmNvbnRhaW5lcnMuc3BsaWNlKCBkcmFrZS5jb250YWluZXJzLmluZGV4T2YoZWxlbWVudCksIDEgKTtcclxuICAgIH1cclxufTtcclxuXHJcbmZ1bmN0aW9uIGRyYWdTdGFydChlKXtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRyb3BBY2NlcHRzKGVsLCB0YXJnZXQpIHtcclxuICAgIGxldCB0ID0gdGFyZ2V0LmNsYXNzTGlzdDtcclxuICAgIGlmICh0LmNvbnRhaW5zKCd0ZW1wbGF0ZXMnKSlcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAoZWwucXVlcnlTZWxlY3RvcignLmRyb3B6b25lJykgfHwgZWwucXVlcnlTZWxlY3RvcignLnBhZ2UtYnJlYWsnKSkge1xyXG4gICAgICAgIHJldHVybiB0LmNvbnRhaW5zKCdwYWdlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCBjYW5FZGl0ID0gdC5jb250YWlucygnZHJvcHpvbmUnKSAmJlxyXG4gICAgICAgICAgICB0YXJnZXQucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ2Jsb2NrX25vX2VkaXQnKSAhPT0gJ3RydWUnO1xyXG4gICAgICAgIGNhbkVkaXQgJiYgcGRmRWRpdG9yLm1hbmFnZUhvdmVyU3RhdGUodGFyZ2V0LnBhcmVudE5vZGUsIHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYW5FZGl0O1xyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRHJvcChlbCwgdGFyZ2V0KSB7XHJcbiAgICBpZiAoIXRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BhZ2UnKSl7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIHBkZkVkaXRvci5jbGVhck5vdE5lZWRlZFJvd3ModGFyZ2V0KTtcclxuICAgICAgICAgICAgcGRmRWRpdG9yLm1hbmFnZUV4dHJhUm93cyh0YXJnZXQpO1xyXG4gICAgICAgICAgICBwZGZFZGl0b3IubWFya0VtcHR5Um93cyh0YXJnZXQpO1xyXG4gICAgICAgIH0sIDEwKTtcclxuICAgIH1cclxuICAgIHBkZkVkaXRvci5jbGlja09uQmxvY2socGRmRWRpdG9yLnNlbGVjdGVkQmxvY2spXHJcbiAgICBibG9ja3MuaW5pdFRlbXBsYXRlKGVsLCAnLm9yaWdpbicpO1xyXG59XHJcblxyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwYWdlQ29udGVudCkge1xyXG4gICAgbGV0IHRtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgdG1wLmlubmVySFRNTCA9IHBhZ2VDb250ZW50O1xyXG4gICAgcmVtb3ZlRWxlbWVudHModG1wKTtcclxuICAgIGNsZWFuQ2xhc3Nlcyh0bXApO1xyXG4gICAgY2xlYW5BdHRyaWJ1dGVzKHRtcCk7XHJcbiAgICByZW1vdmVFbXB0eUNsYXNzQXR0cih0bXApO1xyXG4gICAgcmVtb3ZlSW1hZ2VXaWRnZXRUZXh0KHRtcCk7XHJcbiAgICAvLyBwdWxsVXBGaWd1cmVUYWdDaGlsZHJlbih0bXApXHJcbiAgICAvLyBjb25zb2xlLmxvZyh0bXAuaW5uZXJIVE1MKVxyXG4gICAgcmV0dXJuIHRtcDtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlRW1wdHlDbGFzc0F0dHIodG1wKSB7XHJcbiAgICB0bXAucXVlcnlTZWxlY3RvckFsbChgW2NsYXNzPVwiXCJdYClcclxuICAgICAgICAuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmVBdHRyaWJ1dGUoJ2NsYXNzJykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVFbGVtZW50cyh0bXApIHtcclxuICAgIHRtcC5xdWVyeVNlbGVjdG9yQWxsKFtcclxuICAgICAgICAnc3R5bGUnLFxyXG4gICAgICAgICcuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxlJyxcclxuICAgICAgICAnLmNrLXdpZGdldF9fcmVzaXplcicsXHJcbiAgICAgICAgJy5kei1idXR0b25zJyxcclxuICAgICAgICAnLnRlbXBsYXRlLWJ1dHRvbnMnLFxyXG4gICAgICAgICcuZW1wdHktZHJvcC16b25lOmZpcnN0LWNoaWxkJyxcclxuICAgICAgICAnLmVtcHR5LWRyb3Atem9uZTpsYXN0LWNoaWxkJ1xyXG4gICAgXS5qb2luKCcsICcpKS5mb3JFYWNoKGVsID0+IGVsLnJlbW92ZSgpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYW5DbGFzc2VzKHRtcCkge1xyXG4gICAgW1xyXG4gICAgICAgICdpbml0aWFsaXplZCcsXHJcbiAgICAgICAgJ2NrLWJsdXJyZWQnLFxyXG4gICAgICAgICdjaycsXHJcbiAgICAgICAgJ2NrLWNvbnRlbnQnLFxyXG4gICAgICAgICdjay1lZGl0b3JfX2VkaXRhYmxlJyxcclxuICAgICAgICAnY2stcm91bmRlZC1jb3JuZXJzJyxcclxuICAgICAgICAnY2stZWRpdG9yX19lZGl0YWJsZV9pbmxpbmUnLFxyXG4gICAgICAgICdjay1lZGl0b3JfX25lc3RlZC1lZGl0YWJsZScsXHJcbiAgICAgICAgJ2NrLXdpZGdldCcsXHJcbiAgICAgICAgJ2NrLXdpZGdldF93aXRoLXJlc2l6ZXInLFxyXG4gICAgICAgICdjay13aWRnZXRfc2VsZWN0ZWQnLFxyXG4gICAgICAgICdjay13aWRnZXRfd2l0aC1zZWxlY3Rpb24taGFuZGxlJyxcclxuICAgICAgICAnYWRkX2VkaXRvcl9oZXJlJ1xyXG4gICAgXS5mb3JFYWNoKGMgPT4gdG1wLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgYylcclxuICAgICAgICAuZm9yRWFjaChlbCA9PiBlbC5jbGFzc0xpc3QucmVtb3ZlKGMpKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsZWFuQXR0cmlidXRlcyh0bXApIHtcclxuICAgIFtcclxuICAgICAgICAnYXJpYS1sYWJlbCcsXHJcbiAgICAgICAgJ2NvbnRlbnRlZGl0YWJsZScsXHJcbiAgICAgICAgJ3JvbGUnLFxyXG4gICAgICAgICdsYW5nJyxcclxuICAgICAgICAnZGlyJyxcclxuICAgICAgICAnZGF0YS1ja2UtZmlsbGVyJ1xyXG4gICAgXS5mb3JFYWNoKGF0dHIgPT4gdG1wLnF1ZXJ5U2VsZWN0b3JBbGwoYFske2F0dHJ9XWApXHJcbiAgICAgICAgLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlQXR0cmlidXRlKGF0dHIpKSlcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlSW1hZ2VXaWRnZXRUZXh0KHRtcCkge1xyXG4gICAgdG1wLnF1ZXJ5U2VsZWN0b3JBbGwoJ3AsIGRpdicpXHJcbiAgICAgICAgLmZvckVhY2goZWwgPT4gZWwuaW5uZXJIVE1MID09PSAn0JLQuNC00LbQtdGCINC40LfQvtCx0YDQsNC20LXQvdC40LknICYmIGVsLnJlbW92ZSgpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHVsbFVwRmlndXJlVGFnQ2hpbGRyZW4odG1wKSB7XHJcbiAgICB0bXAucXVlcnlTZWxlY3RvckFsbCgnZmlndXJlJylcclxuICAgICAgICAuZm9yRWFjaChmID0+IHtcclxuICAgICAgICAgICAgZi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShmLmZpcnN0Q2hpbGQsIGYpO1xyXG4gICAgICAgICAgICBmLnJlbW92ZSgpXHJcbiAgICAgICAgfSlcclxuXHJcbn0iLCJcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcHJvcGVydGllcyA9PiBgXHJcbiAgICAke3JlcXVpcmUoJy4vbW91c2VvdmVyQnV0dG9ucycpLnN0eWxlcyhwcm9wZXJ0aWVzKX1cclxuICAgIDxkaXYgY2xhc3M9XCJwZGYtZWRpdG9yIHdyYXBwZXJcIj5cclxuICAgIFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJzaWRlUGFuZWwgYmcxXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJncm91cE5hbWVcIj7QkdC70L7QutC4PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgaWQ9XCJibG9ja3NcIiBjbGFzcz1cInRlbXBsYXRlc1wiPjwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZ3JvdXBOYW1lXCI+0K3Qu9C10LzQtdC90YLRizwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGlkPVwiZWxlbWVudHNcIiBjbGFzcz1cInRlbXBsYXRlc1wiPjwvZGl2PlxyXG4gICAgICAgICAgICAke3Byb3BlcnRpZXMucHJvcGVydGllc1BhZ2UgPyBgXHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZ3JvdXBOYW1lXCI+0KHQstC+0LnRgdGC0LLQsDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgJHtyZXF1aXJlKCcuL2Jsb2NrUHJvcGVydGllcycpLmh0bWxUZW1wbGF0ZShwcm9wZXJ0aWVzKX1cclxuICAgICAgICAgICAgYCA6ICcnfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIFxyXG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50XCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJwYWdlIGNvbnRhaW5lclwiPiR7cmVxdWlyZSgnLi9wYWdlLXN0eWxlcycpfTwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAke3JlcXVpcmUoJy4vc3ZnT3ZlcmxheS9zdmdPdmVybGF5JykuaHRtbFRlbXBsYXRlKHByb3BlcnRpZXMpfVxyXG5cclxuICAgIDwvZGl2PlxyXG5gO1xyXG4iLCJsZXQgSWNvbnMgPSByZXF1aXJlKCcuL0ljb25zJyk7XHJcbmxldCBibG9ja3MgPSByZXF1aXJlKCcuL2Jsb2NrcycpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7XHJcbiAgICBtYW5hZ2U6IGZ1bmN0aW9uKGUsIHBkZkVkaXRvcikge1xyXG4gICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2hhbmRsZScpKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgZWxlbWVudEJ1dHRvbnMoZSwgcGRmRWRpdG9yLCBibG9ja0J1dHRvbnMoZSwgcGRmRWRpdG9yKSk7XHJcbiAgICB9LFxyXG4gICAgc3R5bGVzOiBwcm9wcyA9PiBgXHJcbiAgICAgICAgPHN0eWxlPlxyXG4gICAgICAgICAgICAucGRmLWVkaXRvciAucGFnZSAudGVtcGxhdGU6aG92ZXIgIC5kei1idXR0b25zLFxyXG4gICAgICAgICAgICAucGRmLWVkaXRvciAucGFnZSAudGVtcGxhdGU6aG92ZXIgIC50ZW1wbGF0ZS1idXR0b25zIHtcclxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAuZHotYnV0dG9ucywgLnRlbXBsYXRlLWJ1dHRvbnMge1xyXG4gICAgICAgICAgICAgICAgei1pbmRleDogMTExO1xyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAuZHotYnV0dG9ucyA+IGRpdiB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgkezYwK3Byb3BzLmJ1dHRvbnNTaXplfXB4LDApO1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDUwcHg7XHJcbiAgICAgICAgICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTtcclxuICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0O1xyXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDBweDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAuZHotYnV0dG9ucyBzdmcsIC50ZW1wbGF0ZS1idXR0b25zIHN2Z3tcclxuICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRpdi5kei1idXR0b25zIHtcclxuICAgICAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiA3MDBweDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAuZHotYnV0dG9ucywgLnRlbXBsYXRlLWJ1dHRvbnMge1xyXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMDtcclxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcclxuICAgICAgICAgICAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDBweDtcclxuICAgICAgICAgICAgICAgIGhlaWdodDogMHB4O1xyXG4gICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6MDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAudGVtcGxhdGUtYnV0dG9ucyB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgkey0xMC1wcm9wcy5idXR0b25zU2l6ZX1weCwgMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLnRlbXBsYXRlLWJ1dHRvbnMgPiBkaXYge1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDQwcHg7XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDYwcHg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICA8L3N0eWxlPlxyXG4gICAgYFxyXG59XHJcblxyXG5mdW5jdGlvbiBibG9ja0J1dHRvbnMoZSwgcGRmRWRpdG9yKSB7XHJcbiAgICBsZXQgc2l6ZSA9IHBkZkVkaXRvci5wcm9wZXJ0aWVzLmJ1dHRvbnNTaXplXHJcbiAgICBsZXQgY2xvc2VzdER6ID0gZS50YXJnZXQuY2xvc2VzdCgnLnBhZ2UgLnRlbXBsYXRlOm5vdCguY29sLXhzKScpO1xyXG4gICAgY2xvc2VzdER6ID0gY2xvc2VzdER6IHx8IGUudGFyZ2V0LmNsXHJcbiAgICBpZiAoY2xvc2VzdER6ICE9PSBwZGZFZGl0b3IubW91c2VPdmVyRHopIHtcclxuICAgICAgICBwZGZFZGl0b3IucmVtb3ZlQnlTZWwoJy5kei1idXR0b25zJyk7XHJcbiAgICAgICAgcGRmRWRpdG9yLm1vdXNlT3ZlckR6ID0gY2xvc2VzdER6O1xyXG4gICAgICAgIGlmIChjbG9zZXN0RHopIHtcclxuICAgICAgICAgICAgbGV0IHRiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHRiLmNsYXNzTGlzdC5hZGQoJ2R6LWJ1dHRvbnMnKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjYW5Nb3ZlID0gY2xvc2VzdER6LmdldEF0dHJpYnV0ZSgnYmxvY2tfbm9fbW92ZScpICE9PSAndHJ1ZSc7XHJcbiAgICAgICAgICAgIGxldCBjYW5Db3B5ID0gY2xvc2VzdER6LmdldEF0dHJpYnV0ZSgnYmxvY2tfbm9fY29weScpICE9PSAndHJ1ZSc7XHJcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC5xdWVyeVNlbGVjdG9yKCcucGFnZS1icmVhaycpKVxyXG4gICAgICAgICAgICAgICAgY2FuQ29weSA9IDA7XHJcbiAgICAgICAgICAgIHRiLmlubmVySFRNTCA9IGBcclxuICAgICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAke2Nhbk1vdmUgPyBgPHNwYW4gY2xhc3M9J2hhbmRsZSc+JHtJY29ucy5tb3ZlKHNpemUsIHNpemUpfTwvc3Bhbj5gIDogJyd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR7Y2FuQ29weSA/IGA8c3BhbiBjbGFzcz0nY29weSc+JHtJY29ucy5jb3B5KHNpemUsIHNpemUpfTwvc3Bhbj5gIDogJyd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR7Y2FuTW92ZSA/IGA8c3BhbiBjbGFzcz0nZGVsJz4ke0ljb25zLmRlbChzaXplLCBzaXplKX08L3NwYW4+YCA6ICcnfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAke2Nhbk1vdmUgPyBgPHNwYW4gY2xhc3M9J3VwJz4ke0ljb25zLnVwKHNpemUsIHNpemUpfTwvc3Bhbj5gIDogJyd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR7Y2FuTW92ZSA/IGA8c3BhbiBjbGFzcz0nZG93bic+JHtJY29ucy5kb3duKHNpemUsIHNpemUpfTwvc3Bhbj5gIDogJyd9XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICBgO1xyXG4gICAgICAgICAgICBjbG9zZXN0RHouaW5zZXJ0QmVmb3JlKHRiLCBjbG9zZXN0RHouZmlyc3RDaGlsZCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY29weSA9IHRiLnF1ZXJ5U2VsZWN0b3IoJy5jb3B5JylcclxuICAgICAgICAgICAgY29weSAmJiAoY29weS5vbmNsaWNrID0gZSA9PiBibG9ja3MuY29weUJsb2NrKGUpKVxyXG5cclxuICAgICAgICAgICAgbGV0IGRlbCA9IHRiLnF1ZXJ5U2VsZWN0b3IoJy5kZWwnKVxyXG4gICAgICAgICAgICBkZWwgJiYgKGRlbC5vbmNsaWNrID0gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRwbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50ZW1wbGF0ZScpO1xyXG4gICAgICAgICAgICAgICAgdHBsLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxldCB1cCA9IHRiLnF1ZXJ5U2VsZWN0b3IoJy51cCcpXHJcbiAgICAgICAgICAgIHVwICYmICh1cC5vbmNsaWNrID0gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRwbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50ZW1wbGF0ZScpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRwbC5wcmV2aW91c1NpYmxpbmcgJiYgdHBsLnByZXZpb3VzU2libGluZy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImRpdlwiKVxyXG4gICAgICAgICAgICAgICAgICAgdHBsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRwbCwgdHBsLnByZXZpb3VzU2libGluZylcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgZG93biA9IHRiLnF1ZXJ5U2VsZWN0b3IoJy5kb3duJylcclxuICAgICAgICAgICAgZG93biAmJiAoZG93bi5vbmNsaWNrID0gZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRwbCA9IGUudGFyZ2V0LmNsb3Nlc3QoJy50ZW1wbGF0ZScpO1xyXG4gICAgICAgICAgICAgICAgdHBsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHRwbCwgdHBsLm5leHRTaWJsaW5nLm5leHRTaWJsaW5nKVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2xvc2VzdER6O1xyXG59XHJcblxyXG5mdW5jdGlvbiBlbGVtZW50QnV0dG9ucyhlLCBwZGZFZGl0b3IsIGNsb3Nlc3REeikge1xyXG4gICAgbGV0IHNpemUgPSBwZGZFZGl0b3IucHJvcGVydGllcy5idXR0b25zU2l6ZVxyXG4gICAgbGV0IGNsb3Nlc3RUcGwgPSBlLnRhcmdldC5jbG9zZXN0KCcucGFnZSAudGVtcGxhdGUuY29sLXhzJyk7XHJcbiAgICBpZiAoY2xvc2VzdFRwbCAhPT0gcGRmRWRpdG9yLm1vdXNlT3ZlclRwbCkge1xyXG4gICAgICAgIHBkZkVkaXRvci5yZW1vdmVCeVNlbCgnLnRlbXBsYXRlLWJ1dHRvbnMnKTtcclxuICAgICAgICBwZGZFZGl0b3IubW91c2VPdmVyVHBsID0gY2xvc2VzdFRwbDtcclxuICAgICAgICBsZXQgY2FuRWRpdCA9IGNsb3Nlc3REeiAmJiBjbG9zZXN0RHouZ2V0QXR0cmlidXRlKCdibG9ja19ub19lZGl0JykgIT09ICd0cnVlJztcclxuICAgICAgICBpZiAoY2xvc2VzdFRwbCAmJiBjYW5FZGl0KSB7XHJcbiAgICAgICAgICAgIGxldCBjbG9zZXN0VHBsMSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5wYWdlIC50ZW1wbGF0ZS5jb2wteHM6bm90KC5tY2UtZWRpdC1mb2N1cyknKTtcclxuICAgICAgICAgICAgbGV0IHRiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIHRiLmNsYXNzTGlzdC5hZGQoJ3RlbXBsYXRlLWJ1dHRvbnMnKTtcclxuICAgICAgICAgICAgdGIuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2hhbmRsZSc+JHtJY29ucy5tb3ZlKHNpemUsIHNpemUpfTwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgYDtcclxuICAgICAgICAgICAgY2xvc2VzdFRwbDEuaW5zZXJ0QmVmb3JlKHRiLCBjbG9zZXN0VHBsMS5maXJzdENoaWxkKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuXHJcbiIsIm1vZHVsZS5leHBvcnRzID0gYFxyXG48c3R5bGU+XHJcbnAge1xyXG4gICAgbWFyZ2luLWJsb2NrLXN0YXJ0OiAwIWltcG9ydGFudDtcclxuICAgIG1hcmdpbi1ibG9jay1lbmQ6IDAgIWltcG9ydGFudDtcclxufVxyXG4ucGFnZSB7XHJcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XHJcbiAgICBtaW4taGVpZ2h0OiAxMTEwcHg7XHJcbiAgICB3aWR0aDogMTAwJTtcclxuICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgdGV4dC1hbGlnbjogbGVmdDtcclxuICAgIHBhZGRpbmc6IDVweDtcclxufVxyXG4udGVtcGxhdGUge1xyXG4gICAgY29sb3I6IGJsYWNrO1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBwYWRkaW5nOiAwcHg7XHJcbn1cclxuLnBhZ2UgPiAudGVtcGxhdGU6bm90KDpsYXN0LWNoaWxkKSB7XHJcbiAgICBtYXJnaW4tYm90dG9tOiA1cHg7XHJcbn1cclxuZGl2LmRyb3B6b25lLnJvdyB7XHJcbiAgICBtaW4taGVpZ2h0OiAzNXB4O1xyXG4gICAgbWFyZ2luOiAwO1xyXG4gICAgdHJhbnNpdGlvbjogMzAwbXM7XHJcbn1cclxuZGl2LmRyb3B6b25lLnJvdy5lbXB0eS1kcm9wLXpvbmUge1xyXG4gICAgIG1pbi1oZWlnaHQ6IDBweDtcclxuICAgICBvcGFjaXR5OiAwO1xyXG59XHJcbmRpdi50ZW1wbGF0ZS5ob3Zlci1zdGF0ZSBkaXYuZHJvcHpvbmUucm93LmVtcHR5LWRyb3Atem9uZSB7XHJcbiAgICAgbWluLWhlaWdodDogMjVweDtcclxuICAgICBvcGFjaXR5OiAxO1xyXG4gICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDAyO1xyXG59XHJcbi5wYWdlIC5wYWdlLWJyZWFrIHtcclxuICAgIG1hcmdpbi1sZWZ0OiAtMjBweDtcclxuICAgIG1hcmdpbi1yaWdodDogLTIwcHg7XHJcbiAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iZy1jb2wpO1xyXG4gICAgY29sb3I6IG9yYW5nZTtcclxufVxyXG4ucGFnZS1icmVhayB7XHJcbiAgICBiYWNrZ3JvdW5kOiAjZWVlO1xyXG4gICAgaGVpZ2h0OiAzNXB4O1xyXG4gICAgcG9pbnRlci1ldmVudHM6bm9uZTtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgIGxpbmUtaGVpZ2h0OiAzNXB4O1xyXG59XHJcbiAuY2std2lkZ2V0X19zZWxlY3Rpb24taGFuZGxlIHtcclxuICAgIGRpc3BsYXk6IG5vbmU7XHJcbiB9XHJcbiAuY2std2lkZ2V0X3dpdGgtc2VsZWN0aW9uLWhhbmRsZXtcclxuICAgIG1hcmdpbi10b3A6IDE1cHggIWltcG9ydGFudDtcclxuIH1cclxuIC5jay13aWRnZXRfX3NlbGVjdGlvbi1oYW5kbGUgLmNrLmNrLWljb24ge1xyXG4gICAgb3BhY2l0eTogMDtcclxuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xyXG4gfVxyXG4gLyoudGVtcGxhdGUuY29sLXhzIHsqL1xyXG4gLyogICBwYWRkaW5nOiAycHghaW1wb3J0YW50OyovXHJcbiAvKn0qL1xyXG4gLyouZHJvcHpvbmUgPiAudGVtcGxhdGUgeyovXHJcbiAvKiAgIGhlaWdodDogMTAwJTsqL1xyXG4gLyp9Ki9cclxuIC5wYWdlIHRhYmxlIHtcclxuICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7XHJcbiB9XHJcbiAucGFnZSB0YWJsZSB0ZCB7XHJcbiAgICBtaW4td2lkdGg6IDQwcHg7XHJcbiB9XHJcbiBcclxuQHBhZ2Uge1xyXG4gICAgbWFyZ2luOiAwcHg7XHJcbn1cclxuXHJcbi5jb250ZW50IC5wYWdlLmNvbnRhaW5lciBkaXYuYWRkX2VkaXRvcl9oZXJle1xyXG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICAgIGhlaWdodDogMTAwJTtcclxufVxyXG48L3N0eWxlPlxyXG5gLnNwbGl0KCdcXG4nKS5qb2luKCcnKS5zcGxpdCgnICAgICcpLmpvaW4oJycpOyIsInZhciBjc3MgPSBcIi5wZGYtZWRpdG9yLndyYXBwZXIge1xcbiAgZGlzcGxheTogZmxleDtcXG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XFxuICAtLWJnLWNvbDogIzQ0NDtcXG59XFxuLnBkZi1lZGl0b3IgLmNvbnRlbnQge1xcbiAgZmxleC1ncm93OiAxO1xcbiAgYmFja2dyb3VuZDogdmFyKC0tYmctY29sKTtcXG4gIG92ZXJmbG93LXk6IHNjcm9sbDtcXG4gIHBhZGRpbmc6IDUwcHggMjBweDtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuLnBkZi1lZGl0b3IgLnBhZ2Uge1xcbiAgYm94LXNoYWRvdzogMXB4IDFweCA0cHggMXB4ICMyMjI2O1xcbn1cXG4ucGRmLWVkaXRvciAuc2lkZVBhbmVsLFxcbi5wZGYtZWRpdG9yIC5wcm9wc1BhbmVsIHtcXG4gIGRpc3BsYXk6IGZsZXg7XFxuICB3aWR0aDogMzYwcHg7XFxuICAvKmJhY2tncm91bmQ6ICM0NDQ7Ki9cXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxuICBib3JkZXItbGVmdDogMXB4IHNvbGlkIGdyYXk7XFxuICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCBncmF5O1xcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG59XFxuLnBkZi1lZGl0b3IgLnRlbXBsYXRlcyB7XFxuICAvKmZsZXgtZ3JvdzogMTsqL1xcbiAgLypvdmVyZmxvdy15OiBhdXRvOyovXFxuICAvKm92ZXJmbG93LXg6IGhpZGRlbjsqL1xcbiAgcGFkZGluZzogMTBweCAyNXB4O1xcbn1cXG4ucGRmLWVkaXRvciAudGVtcGxhdGVzIC50ZW1wbGF0ZSB7XFxuICBtYXJnaW4tYm90dG9tOiA1cHg7XFxuICAvKnBhZGRpbmc6ICA1cHggMDsqL1xcbn1cXG4ucGRmLWVkaXRvciAuYnV0dG9ucyB7XFxuICBwYWRkaW5nOiA1cHggNXB4IDAgNXB4O1xcbn1cXG4ucGRmLWVkaXRvciAuYnV0dG9ucyBidXR0b24ge1xcbiAgbGluZS1oZWlnaHQ6IDMwcHg7XFxuICBib3JkZXItcmFkaXVzOiAxMXB4O1xcbn1cXG4ucGRmLWVkaXRvciAudGVtcGxhdGUge1xcbiAgdHJhbnNpdGlvbjogMC4ycztcXG59XFxuLnBkZi1lZGl0b3IgI2VsZW1lbnRzIC50ZW1wbGF0ZSB7XFxuICB0cmFuc2l0aW9uOiAwLjJzO1xcbiAgYmFja2dyb3VuZDogI2VlZTtcXG59XFxuLnBkZi1lZGl0b3IgLnNpZGVQYW5lbCAuZHJvcHpvbmUge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTtcXG4gIG1pbi1oZWlnaHQ6IDM1cHg7XFxufVxcbi5wZGYtZWRpdG9yIC5zaWRlUGFuZWwgLnRlbXBsYXRlOmhvdmVyIHtcXG4gIHRyYW5zZm9ybTogc2NhbGUoMS4xKTtcXG4gIGN1cnNvcjogbW92ZTtcXG59XFxuLmRyb3B6b25lIHtcXG4gIGJhY2tncm91bmQtY29sb3I6ICMwMDAxO1xcbiAgLypib3JkZXI6IDFweCBzb2xpZCAjMDAwMzsqL1xcbn1cXG4vKmRpdi5kcm9wem9uZS5yb3c6Zmlyc3QtY2hpbGQsKi9cXG4vKmRpdi5kcm9wem9uZS5yb3c6bGFzdC1jaGlsZCB7Ki9cXG4vKiAgICBtaW4taGVpZ2h0OiAwOyovXFxuLyp9Ki9cXG4uaGFuZGxlIHtcXG4gIGN1cnNvcjogbW92ZTtcXG59XFxuLmNvcHkge1xcbiAgY3Vyc29yOiBwb2ludGVyO1xcbn1cXG4uaGFuZGxlLFxcbi5jb3B5LFxcbi5kZWwsXFxuLnVwLFxcbi5kb3duIHtcXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU0LCAxNzcsIDYyLCAwLjQpO1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgYm9yZGVyLXJhZGl1czogMTUlO1xcbiAgdHJhbnNpdGlvbjogMC4ycztcXG4gIG1hcmdpbjogMnB4O1xcbn1cXG4uaGFuZGxlOmhvdmVyLFxcbi5jb3B5OmhvdmVyLFxcbi5kZWw6aG92ZXIsXFxuLnVwOmhvdmVyLFxcbi5kb3duOmhvdmVyIHtcXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU0LCAxNzcsIDYyLCAwLjgpO1xcbiAgLypiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMTg3LCAxMzUsIDY0KTsqL1xcbn1cXG4uZHotYnV0dG9ucyxcXG4udGVtcGxhdGUtYnV0dG9ucyB7XFxuICBvcGFjaXR5OiAwO1xcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgb3ZlcmZsb3c6IHZpc2libGU7XFxuICB3aWR0aDogMHB4O1xcbiAgaGVpZ2h0OiAwcHg7XFxuICBsaW5lLWhlaWdodDogMDtcXG59XFxuLnRlbXBsYXRlLWJ1dHRvbnMge1xcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTQwcHgsIDApO1xcbn1cXG4udGVtcGxhdGUtYnV0dG9ucyA+IGRpdiB7XFxuICB3aWR0aDogNDBweDtcXG4gIGhlaWdodDogNjBweDtcXG4gIC8qYmFja2dyb3VuZDogcmViZWNjYXB1cnBsZTsqL1xcbn1cXG5kaXYuZHotYnV0dG9ucyB7XFxuICBtYXJnaW4tbGVmdDogNzAwcHg7XFxufVxcbi5zdmctb3ZlcmxheSB7XFxuICBwb3NpdGlvbjogZml4ZWQ7XFxuICB0b3A6IDA7XFxuICBsZWZ0OiAwO1xcbiAgcG9pbnRlci1ldmVudHM6IG5vbmU7XFxufVxcbnRhYmxlIHRkIHtcXG4gIG1pbi13aWR0aDogNTBweDtcXG4gIGhlaWdodDogMjBweDtcXG4gIGJvcmRlcjogMXB4IHNvbGlkIGJsYWNrO1xcbn1cXG4udGFibGVCbG9jayB7XFxuICBwYWRkaW5nLXRvcDogM3B4O1xcbiAgcGFkZGluZy1ib3R0b206IDNweDtcXG59XFxuLnN1Yi1sYWJlbCB7XFxuICBmb250LXNpemU6IDE2cHg7XFxuICBjb2xvcjogIzk5OTtcXG4gIGZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjtcXG59XFxuLnN1Yi1sYWJlbDpmaXJzdC1jaGlsZCB7XFxuICBwYWRkaW5nLXRvcDogNXB4O1xcbn1cXG4uc2lkZVBhbmVsICNlbGVtZW50cyA+IGRpdi50ZW1wbGF0ZSB7XFxuICBib3gtc2hhZG93OiAwIDAgMCAxcHggZ3JheTtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuLnNpZGVQYW5lbCAjZWxlbWVudHMgID4gZGl2LnRlbXBsYXRlIHtcXG4gIHRleHQtYWxpZ246IGNlbnRlcjtcXG59XFxuLnNpZGVQYW5lbCAjZWxlbWVudHMgIHRhYmxlIHtcXG4gIG1hcmdpbi10b3A6IDVweDtcXG4gIG1hcmdpbi1ib3R0b206IDVweDtcXG59XFxuLnNpZGVQYW5lbCAjZWxlbWVudHMgIGltZyB7XFxuICBtYXJnaW4tYm90dG9tOiAtNHB4O1xcbn1cXG5kaXYudGVtcGxhdGUgIHRhYmxlIHtcXG4gIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7XFxufVxcbi5zaWRlUGFuZWwgdGV4dGFyZWEge1xcbiAgd2lkdGg6IDMzM3B4O1xcbiAgaGVpZ2h0OiA4NHB4O1xcbn1cXG4uc2lkZVBhbmVsIGJ1dHRvbixcXG4uc2lkZVBhbmVsIGlucHV0W3R5cGU9XFxcInRleHRcXFwiXSB7XFxuICBoZWlnaHQ6IDI4cHg7XFxuICB3aWR0aDogMzM3cHg7XFxufVxcbi8qLnNpZGVQYW5lbCBidXR0b24geyovXFxuLyogICAgb3V0bGluZTogbm9uZTsqL1xcbi8qICAgIHBhZGRpbmctdG9wOiA1cHg7Ki9cXG4vKiAgICBib3JkZXItcmFkaXVzOiA1cHg7Ki9cXG4vKiAgICBib3JkZXI6IDFweCBzb2xpZCBvcmFuZ2U7Ki9cXG4vKiAgICBiYWNrZ3JvdW5kOiAjNDQ0OyovXFxuLyogICAgY29sb3I6IHdoaXRlOyovXFxuLyp9Ki9cXG4uc2lkZVBhbmVsIHRleHRhcmVhLFxcbi5zaWRlUGFuZWwgaW5wdXRbdHlwZT1cXFwidGV4dFxcXCJdIHtcXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcXG4gIGJhY2tncm91bmQ6ICM0NDQ7XFxuICBjb2xvcjogd2hpdGU7XFxuICBib3JkZXI6IDFweCBzb2xpZCAjOTk5O1xcbiAgbWFyZ2luLWJvdHRvbTogNXB4O1xcbn1cXG4uZ3JvdXBOYW1lIHtcXG4gIHdpZHRoOiAzNjBweDtcXG4gIHBhZGRpbmctbGVmdDogMTVweDtcXG4gIGJvcmRlci10b3A6IDFweCBzb2xpZCBncmF5O1xcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIGdyYXk7XFxuICAvKnRleHQtYWxpZ246IGNlbnRlcjsqL1xcbiAgZm9udC1zaXplOiAyMHB4O1xcbiAgbGluZS1oZWlnaHQ6IDMwcHg7XFxuICBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7XFxuICBjb2xvcjogIzk5OTtcXG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxuICBjdXJzb3I6IHBvaW50ZXI7XFxufVxcbi5ncm91cE5hbWUgKyBkaXYge1xcbiAgdHJhbnNpdGlvbjogMzAwbXM7XFxuICBtYXgtaGVpZ2h0OiAxMDB2aDtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxufVxcbi5ncm91cE5hbWUuY29sbGFwc2VkICsgZGl2IHtcXG4gIG1heC1oZWlnaHQ6IDA7XFxuICBtaW4taGVpZ2h0OiAwICFpbXBvcnRhbnQ7XFxuICBwYWRkaW5nLXRvcDogMDtcXG4gIHBhZGRpbmctYm90dG9tOiAwO1xcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcXG59XFxuLmdyb3VwTmFtZTphZnRlciB7XFxuICBjb250ZW50OiB1cmwoXFxcImRhdGE6aW1hZ2Uvc3ZnK3htbDt1dGY4LDxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB3aWR0aD0nMzAnIGhlaWdodD0nMzAnPjxjaXJjbGUgZmlsbD0nJTIzNzc3JyBjeD0nMTUnIGN5PScxNScgcj0nMTAnIC8+PHBvbHlsaW5lIHN0cm9rZS13aWR0aD0nMycgcG9pbnRzPScxMCAxMyAxNSAxOCAyMCAxMycgZmlsbD0nbm9uZScgc3Ryb2tlPSclMjM0NDQnLz48L3N2Zz5cXFwiKTtcXG4gIHRyYW5zaXRpb246IDMwMG1zO1xcbiAgZmxvYXQ6IHJpZ2h0O1xcbiAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgbGluZS1oZWlnaHQ6IDBweDtcXG59XFxuLmdyb3VwTmFtZS5jb2xsYXBzZWQ6YWZ0ZXIge1xcbiAgdHJhbnNmb3JtOiByb3RhdGUoOTBkZWcpIHNjYWxlKC0xLC0xKTtcXG59XFxuLnNpZGVQYW5lbCB0YWJsZSB7XFxuICAvKnBhZGRpbmc6IDVweDsqL1xcbiAgbWFyZ2luLWxlZnQ6IDQwcHg7XFxufVxcbi5zaWRlUGFuZWwgdHI6bnRoLWNoaWxkKDIpIHRkOm50aC1jaGlsZCgzKSB7XFxuICBiYWNrZ3JvdW5kOiBsaWdodGdyYXk7XFxufVxcbi5wZGYtZWRpdG9yIC5wYWdlIHtcXG4gIHdpZHRoOiA4MDBweDtcXG59XFxuXCI7IChyZXF1aXJlKFwiYnJvd3NlcmlmeS1jc3NcIikuY3JlYXRlU3R5bGUoY3NzLCB7IFwiaHJlZlwiOiBcInNyY1xcXFxwZGYtZWRpdG9yXFxcXHBkZi1lZGl0b3IuY3NzXCIgfSwgeyBcImluc2VydEF0XCI6IFwiYm90dG9tXCIgfSkpOyBtb2R1bGUuZXhwb3J0cyA9IGNzczsiLCJtb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICBodG1sVGVtcGxhdGU6IHByb3BlcnRpZXMgPT4gYFxyXG4gICAgICAgICA8cGF0aCBmaWxsPVwibm9uZVwiIHN0cm9rZT1cIiNmZjZlMWJcIj48L3BhdGg+XHJcbiAgICBgLFxyXG5cclxuICAgIGluaXRDb21wb25lbnQocGFyZW50Q29tcG9uZW50KSB7XHJcbiAgICAgICAgdGhpcy5ibG9ja1NlbGVjdGlvbkZyYW1lID0gcGFyZW50Q29tcG9uZW50LnF1ZXJ5U2VsZWN0b3IoJ3BhdGgnKTtcclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlQ29tcG9uZW50KHBkZkVkaXRvcikge1xyXG4gICAgICAgIGlmICghcGRmRWRpdG9yLnNlbGVjdGVkQmxvY2spXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJsb2NrU2VsZWN0aW9uRnJhbWUucmVtb3ZlQXR0cmlidXRlKCdkJyk7XHJcbiAgICAgICAgbGV0IHIgPSBwZGZFZGl0b3Iuc2VsZWN0ZWRCbG9jay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB0aGlzLmJsb2NrU2VsZWN0aW9uRnJhbWUuc2V0QXR0cmlidXRlKCdkJyxgTSR7ci54fSwke3IueX1oJHtyLndpZHRofXYke3IuaGVpZ2h0KzJ9aC0ke3Iud2lkdGh9emApXHJcbiAgICB9XHJcbn0iLCJsZXQgYmxvY2tzID0gcmVxdWlyZSgnLi4vYmxvY2tzJyk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICBodG1sVGVtcGxhdGUocHJvcGVydGllcykge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5lbmFibGVkID0gcHJvcGVydGllcy5mbG9hdGluZ0Jsb2NrTmFtZSkgPyBgXHJcbiAgICAgICAgICAgIDxnPlxyXG4gICAgICAgICAgICAgICAgPHJlY3QgeT1cIi0zMFwiIHJ4PVwiNVwiIGhlaWdodD1cIjI1XCIgZmlsbD1cInJnYigxODcsIDEzNSwgNjQpXCI+PC9yZWN0PlxyXG4gICAgICAgICAgICAgICAgPHRleHQgeT1cIi0xMFwiIHg9XCIxMFwiPjwvdGV4dD5cclxuICAgICAgICAgICAgPC9nPlxyXG4gICAgICAgIGAgOiAnJztcclxuICAgIH0sXHJcblxyXG4gICAgaW5pdENvbXBvbmVudChwYXJlbnRDb21wb25lbnQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlZClcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgdGhpcy5ibG9ja05hbWVHcm91cCA9IHBhcmVudENvbXBvbmVudC5xdWVyeVNlbGVjdG9yKCcuc3ZnLW92ZXJsYXkgZyBnJyk7XHJcbiAgICAgICAgdGhpcy5ibG9ja05hbWVCZyA9IHBhcmVudENvbXBvbmVudC5xdWVyeVNlbGVjdG9yKCcuc3ZnLW92ZXJsYXkgZyBnIHJlY3QnKTtcclxuICAgICAgICB0aGlzLmJsb2NrTmFtZVRleHQgPSBwYXJlbnRDb21wb25lbnQucXVlcnlTZWxlY3RvcignLnN2Zy1vdmVybGF5IGcgZyB0ZXh0Jyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZUNvbXBvbmVudChwZGZFZGl0b3IpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlZClcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgbGV0IHNlbGVjdGVkQmxvY2sgPSBwZGZFZGl0b3Iuc2VsZWN0ZWRCbG9jaztcclxuICAgICAgICBpZiAoIXNlbGVjdGVkQmxvY2spXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJsb2NrTmFtZUdyb3VwLnNldEF0dHJpYnV0ZShgdHJhbnNmb3JtYCwgYHRyYW5zbGF0ZSgwLC0xMDAwKWApO1xyXG4gICAgICAgIGxldCByID0gc2VsZWN0ZWRCbG9jay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB0aGlzLmJsb2NrTmFtZUdyb3VwLnNldEF0dHJpYnV0ZShgdHJhbnNmb3JtYCwgYHRyYW5zbGF0ZSgke3IueH0sJHtyLnl9KWApO1xyXG4gICAgICAgIHRoaXMuYmxvY2tOYW1lVGV4dC50ZXh0Q29udGVudCA9IHNlbGVjdGVkQmxvY2suZ2V0QXR0cmlidXRlKGJsb2Nrcy5wcm9wZXJ0eUtleXMuYmxvY2tfbmFtZSk7XHJcbiAgICAgICAgciA9IHRoaXMuYmxvY2tOYW1lVGV4dC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICB0aGlzLmJsb2NrTmFtZUJnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCByLndpZHRoICsgMjApO1xyXG4gICAgfVxyXG59IiwibGV0IGZsb2F0aW5nQmxvY2tOYW1lID0gcmVxdWlyZSgnLi9mbG9hdGluZ0Jsb2NrTmFtZScpO1xyXG5sZXQgYmxvY2tTZWxlY3Rpb24gPSByZXF1aXJlKCcuL2Jsb2NrU2VsZWN0aW9uJyk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHJcbiAgICBodG1sVGVtcGxhdGU6IHByb3BlcnRpZXMgPT4gYFxyXG4gICAgICAgIDxzdmcgY2xhc3M9XCJzdmctb3ZlcmxheVwiPlxyXG4gICAgICAgICAgICA8ZGVmcz5cclxuICAgICAgICAgICAgICAgIDxjbGlwUGF0aCBpZD1cImVkaXRvcl9jbGlwX3JlY3RcIj5cclxuICAgICAgICAgICAgICAgICAgICA8cG9seWdvbj48L3BvbHlnb24+XHJcbiAgICAgICAgICAgICAgICA8L2NsaXBQYXRoPlxyXG4gICAgICAgICAgICA8L2RlZnM+XHJcbiAgICAgICAgICAgIDxnIGNsaXAtcGF0aD1cInVybCgjZWRpdG9yX2NsaXBfcmVjdClcIj5cclxuICAgICAgICAgICAgICAgICR7YmxvY2tTZWxlY3Rpb24uaHRtbFRlbXBsYXRlKHByb3BlcnRpZXMpfVxyXG4gICAgICAgICAgICAgICAgJHtmbG9hdGluZ0Jsb2NrTmFtZS5odG1sVGVtcGxhdGUocHJvcGVydGllcyl9XHJcbiAgICAgICAgICAgIDwvZz5cclxuICAgICAgICA8L3N2Zz5cclxuICAgIGAsXHJcblxyXG4gICAgaW5pdFN2Z092ZXJsYXk6IGZ1bmN0aW9uIChwZGZFZGl0b3IpIHtcclxuICAgICAgICB0aGlzLnBkZkVkaXRvciA9IHBkZkVkaXRvcjtcclxuICAgICAgICB0aGlzLm92ZXJsYXkgPSBwZGZFZGl0b3IudGFyZ2V0RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuc3ZnLW92ZXJsYXknKTtcclxuICAgICAgICB0aGlzLm92ZXJsYXlDbGlwUG9seWdvbiA9IHRoaXMub3ZlcmxheS5xdWVyeVNlbGVjdG9yKCcjZWRpdG9yX2NsaXBfcmVjdCBwb2x5Z29uJyk7XHJcbiAgICAgICAgYmxvY2tTZWxlY3Rpb24uaW5pdENvbXBvbmVudCh0aGlzLm92ZXJsYXkpO1xyXG4gICAgICAgIGZsb2F0aW5nQmxvY2tOYW1lLmluaXRDb21wb25lbnQodGhpcy5vdmVybGF5KTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUNvbXBvbmVudCh0aGlzLnBkZkVkaXRvcik7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZUNvbXBvbmVudChwZGZFZGl0b3IpIHtcclxuXHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHRoaXMudXBkYXRlQ29tcG9uZW50KHBkZkVkaXRvcikpO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMucGRmRWRpdG9yIC50YXJnZXRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wZGYtZWRpdG9yIC5jb250ZW50JykpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgdGhpcy5vdmVybGF5LnNldEF0dHJpYnV0ZSgndmlld0JveCcsYDAgMCAke2lubmVyV2lkdGh9ICR7aW5uZXJIZWlnaHR9YCk7XHJcbiAgICAgICAgdGhpcy5vdmVybGF5LnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBpbm5lcldpZHRoKTtcclxuICAgICAgICB0aGlzLm92ZXJsYXkuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBpbm5lckhlaWdodCk7XHJcblxyXG4gICAgICAgIGxldCByID0gdGhpcy5wZGZFZGl0b3IudGFyZ2V0RWxlbWVudCAucXVlcnlTZWxlY3RvcignLnBkZi1lZGl0b3IgLmNvbnRlbnQnKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBsZXQgc2Nyb2xsV2lkdGggPSAxNztcclxuICAgICAgICBsZXQgcHRzID0gW1xyXG4gICAgICAgICAgICByLngsIHIueSxcclxuICAgICAgICAgICAgci54ICsgci53aWR0aCAtIHNjcm9sbFdpZHRoLCByLnksXHJcbiAgICAgICAgICAgIHIueCArIHIud2lkdGggLSBzY3JvbGxXaWR0aCwgci55ICsgci5oZWlnaHQsXHJcbiAgICAgICAgICAgIHIueCwgci55ICsgci5oZWlnaHRcclxuICAgICAgICBdO1xyXG4gICAgICAgIHRoaXMub3ZlcmxheUNsaXBQb2x5Z29uLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgcHRzLmpvaW4oJyAnKSk7XHJcblxyXG4gICAgICAgIGJsb2NrU2VsZWN0aW9uLnVwZGF0ZUNvbXBvbmVudCh0aGlzLnBkZkVkaXRvcilcclxuICAgICAgICBmbG9hdGluZ0Jsb2NrTmFtZS51cGRhdGVDb21wb25lbnQodGhpcy5wZGZFZGl0b3IpXHJcbiAgICB9XHJcblxyXG59Il19
