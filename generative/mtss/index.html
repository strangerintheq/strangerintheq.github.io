<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Mitosis</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        
        
<script id="fxhash-snippet">
        //---- do not edit the following code (you can indent as you wish)
        let alphabet = "123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"
        var fxhash = "oo" + Array(49).fill(0).map(_=>alphabet[(Math.random()*alphabet.length)|0]).join('')
        let b58dec = (str) => str.split('').reduce((p,c,i) => p + alphabet.indexOf(c) * (Math.pow(alphabet.length, str.length-i-1)), 0)
        let fxhashTrunc = fxhash.slice(2)
        let regex = new RegExp(".{" + ((fxhashTrunc.length/4)|0) + "}", 'g')
        let hashes = fxhashTrunc.match(regex).map(h => b58dec(h))
        let sfc32 = (a, b, c, d) => {
            return () => {
                a |= 0; b |= 0; c |= 0; d |= 0
                var t = (a + b | 0) + d | 0
                d = d + 1 | 0
                a = b ^ b >>> 9
                b = c + (c << 3) | 0
                c = c << 21 | c >>> 11
                c = c + t | 0
                return (t >>> 0) / 4294967296
            }
        }
        var fxrand = sfc32(...hashes)
        //---- /do not edit the following code
    </script>

    </head>
    <body style='margin:0;overflow:hidden'>
        <script>var N=Math,w=N.PI,X=w/2,J=2*w;var B,k=t=>B=t;var r=(t=1,o=0)=>B()*t+o,P=(t=2,o=0)=>o+r(t|0)|0,u=(t=.5)=>r()>t,c=(t=1)=>r(t)-t/2;var h;function R(t,o){let e=t.getContext("webgl"),i=e.createProgram();p(`

    attribute vec2 vertex;
    
    void main() {
        gl_Position = vec4(vertex, 0.0, 1.0);
    }

`,e.VERTEX_SHADER),p(`precision highp float;

uniform vec2 resolution;`+o,e.FRAGMENT_SHADER),e.linkProgram(i),e.useProgram(i);let l=e.getAttribLocation(i,"vertex"),x=e.getUniformLocation(i,"resolution");e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,3,-1,-1,3,-1]),e.STATIC_DRAW),e.vertexAttribPointer(l,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(l);function p(n,s){let a=e.createShader(s);e.shaderSource(a,n),e.compileShader(a);let m=e.getShaderInfoLog(a);if(m&&n.split(`
`).map(($,b)=>f($,b,m)),m)throw m;e.attachShader(i,a)}function f(n,s,a){h||(h=document.createElement("div"),h.style.fontFamily="Courier New, monospace",document.body.append(h),document.body.style.overflowY="auto",t.remove());let m=1+s,$=m===+a.split(":")[2],b=(""+m).padStart(4,"0")+": "+n.split(" ").join("&nbsp;");$&&(b="<br>"+a+"<br>"+b+"<br><br>"),h.innerHTML+=`<div ${$&&'style="height:100vh;background:#900;color:#fff"'}>${b}</div>`}let v={};function A(n){v[n]||(v[n]=e.getUniformLocation(i,n))}function I(n,s,a,m){A(n),e.uniform3f(v[n],s,a,m)}function G(n,s,a){A(n),e.uniform2f(v[n],s,a)}function U(n,s){A(n),e.uniform1f(v[n],s)}let g,y;function F(){innerWidth===g&&innerHeight===y||(g=t.width=innerWidth,y=t.height=innerHeight,e.viewport(0,0,g,y),e.uniform2f(x,g,y))}function W(){F(),e.drawArrays(e.TRIANGLES,0,3)}return{uf1:U,uf2:G,uf3:I,resize:F,draw:W}}function H(){return`
vec3 permute(vec3 x) { 
    return mod(((x*34.0)+1.0)*x, 289.0); 
}

float noise2d(vec2 v){
  const vec4 C = vec4(0.211324865405187, 0.366025403784439,
           -0.577350269189626, 0.024390243902439);
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);
  vec2 i1;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;
  i = mod(i, 289.0);
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
  + i.x + vec3(0.0, i1.x, 1.0 ));
  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy),
    dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;
  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
    `}function S(){let t=document.querySelector("canvas");t&&t.remove();let o=document.createElement("canvas");return document.body.append(o),o}(function(){let t=document.createElement("style");t.innerHTML=`
    html, body {

        width: 100%;
        height: 100%;
    }

    * {
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
    }
`,document.body.append(t)})();function V(t){let o=parseInt(t.substring(1),16);return[o>>16,o>>8,o].map(e=>e&255)}function j(t){return t.map(o=>(o/255).toFixed(8))}function D(t){return`vec3( ${t[0]}, ${t[1]}, ${t[2]} )`}function _(t,o=5){let e=t.current.map(V).map(j).map(D);return`
vec3 getColor(float i) {
    i = abs(mod(i, ${o}.));
    if (i < 1.) return ${e[0]};
    if (i < 2.) return ${e[1]};
    if (i < 3.) return ${e[2]};
    if (i < 4.) return ${e[3]};
    return ${e[4]};
}
`}var E=(t,o,e)=>parseInt(t.substr(o,e),16);var z=t=>[1,3,5].map(o=>E(t,o,2));function C(t,o,e){t/=255,o/=255,e/=255;var i=Math.max(t,o,e),d=Math.min(t,o,e),l,x,p=(i+d)/2;if(i==d)l=x=0;else{var f=i-d;switch(x=p>.5?f/(2-i-d):f/(i+d),i){case t:l=(o-e)/f+(o<e?6:0);break;case o:l=(e-t)/f+2;break;case e:l=(t-o)/f+4;break}l/=6}return[l,x,p]}var q,T=class{constructor(o,e=[]){this.palettes=o;this.excluded=e;this.b="black";this.w="white";this.index=-1}nextPalette(){do this.index=q?this.index+1:r(this.palettes.length)|0;while(this.excluded.indexOf(this.index)!==-1);this.current=this.palettes[this.index]}nextColor(){let o=this.current;return o[r(o.length)|0]}sort(){this.current=this.current.sort((o,e)=>C(...z(o))[2]-C(...z(e))[2])}};k(Math.random);var Y=["e7ecef-274c77-6096ba-a3cef1-8b8c89","7a6c5d-2a3d45-ddc9b4-bcac9b-c17c74","424b54-93a8ac-ffffff-e2b4bd-9b6a6c","fcaa67-b0413e-ffffc7-548687-473335","e3c567-c8963e-573d1c-d9ae61-d1462f","cc5803-e2711d-ff9505-ffb627-ffc971","6699cc-fff275-ff8c42-ff3c38-a23e48","bfa0a9-fffbbd-e6aa68-ca3c25-1d1a05"].map(t=>t.split("-").map(o=>"#"+o)),L=new T(Y);L.nextPalette();var O=S(),M=R(O,`

precision highp float;
uniform float time;
vec2 center = vec2(${c(1)}, ${c(1)});
float zoom = ${r(1,.2)};
float a = ${c(3)};
float b = ${c(3)};
float m = ${c(3)};
float n = ${c(3)};
float T = ${c(3)};

${_(L)}
${H()}


vec2 mul(vec2 A, vec2 B) {
    return vec2(A.x * B.x - A.y * B.y, 2.0 * A.x * B.y);
}

vec2 div(vec2 A, vec2 B) {
    return vec2(
        ((A.x*B.x + A.y*B.y)/(B.x*B.x + B.y*B.y)),
        ((A.y*B.x - A.x*B.y)/(B.x*B.x + B.y*B.y))
    );
}

vec3 calcColor(int i, vec2 z) {
    vec2 uv = gl_FragCoord.xy/resolution.xy;
    float it = float(i);
    float sl = it - log2(log2(dot(z,z))) + 4.0;
    float al = smoothstep(-0.1, 0.0, sin(0.5 * 6.2831));
    it = mix(it, sl, al);
    vec3 col1 = getColor(it + noise2d(uv*0.1+time*0.002)) ;
    vec3 col2 = getColor(2.+it + noise2d(uv*0.1+time*0.002));
    float mixing = fract(it);
    float modd = mod(it+${r(11)}, 5.);
    if (modd < 1.){
        float k = ${u()?"1.":`noise2d(vec2(${r(111)}+${u()?"it/4.":"0."},uv.${u()?"y":"x"}))`};
        mixing += fract(uv.y/${r(6,1)}*${r(50,50)}*k);
    } else if (modd > 2. && modd < 3.){
        float k = ${u()?"1.":`noise2d(vec2(${r(111)}+${u()?"it/4.":"0."},uv.${u()?"y":"x"}))`};
        mixing += fract(uv.x/${r(6,1)}*${r(50,50)}*k);
    }
    vec3 col3 = mix(col1, col2, mixing);
    return 0.5 + 0.5 * cos(3.0 + it * 0.05 + col3);
}

vec3 fractal(vec2 c) {
    c = -resolution + 2.0 * c;
    c *= zoom/resolution.y;
    c += center;
    vec2 z = c;
    vec2 ab = vec2(a,b);
    vec2 mn = vec2(m,n);
    int j;
    for (int i = 0; i < ${P(7,5)}; i++) {
        j=i;
        if (length(z) > 4.0)
            return calcColor(i, z);
        z = mul(z, z)/${r(3,.4)} + mul(mul(z, z), mul(z, z))*${r(.5)};
        // z += vec2(${c(.1)}, ${c(.1)});
        z += c*${r(.2,.1)};
        
        z /= dot(
            z+vec2(${c(.1)}, ${c(.1)}),
            z+vec2(${c(.2)}, ${c(.1)})
        );
    }
    return calcColor(j, z);
}

void main(void) {
    vec2 c = gl_FragCoord.xy;
    float k = 0.25;

    gl_FragColor = vec4(
        fractal(c+vec2(-1.,-1.)*k)+
        fractal(c+vec2(-1., 1.)*k)+
        fractal(c+vec2( 1., 1.)*k)+
        fractal(c+vec2( 1.,-1.)*k),
        1.0
    );

}

`);requestAnimationFrame(function t(o){M.uf1("time",o/1e3),M.draw(),requestAnimationFrame(t)});</script>
    </body>
</html>