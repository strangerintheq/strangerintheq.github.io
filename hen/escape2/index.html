<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Invaders</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:image" content="thumbnail.jpg" />
</head>
<body>
<style>
    html, body {
        margin: 0;
        padding: 0;
    }
    body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
    }
    * {
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        -moz-osx-font-smoothing: grayscale;
        -webkit-font-smoothing: antialiased;
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
    }
</style>
<canvas id="canvas"></canvas>
<script type="text/javascript">
    const creator = new URLSearchParams(window.location.search).get('creator')
    const viewer = new URLSearchParams(window.location.search).get('viewer')
    const rnd = n => Math.random() * n
    const sin = x => Math.sin(x)
    const cos = x => Math.cos(x)
    const canvas = document.querySelector('#canvas')
    const ctx = canvas.getContext("2d")

    let s, w, h, shape, dir;

    window.addEventListener('resize', resize);
    window.addEventListener('click', regenerate)

    resize();
    regenerate();

    function resize ()  {
        s = Math.min(innerWidth*devicePixelRatio,innerHeight*devicePixelRatio)
        w = canvas.width = innerWidth*devicePixelRatio;
        h = canvas.height = innerHeight*devicePixelRatio;
    }

    function regenerate() {
        ctx.clearRect(0, 0, w, h)
        shape = rnd(3);
        dir = rnd(6.283)
        bg(4e4);
        bg(4e4);
        triangles(33);
        planet(111111);
        frame(11);
        ctx.strokeWidth = 0.01
        ctx.strokeStyle = '#0001'
        ctx.fillStyle = '#fff'
        circles( w/2,h/2,s/3,6);
    }




    function circles(x,y,r,depth){
        if(Math.random()>0.5 && r<10) {
            for (let i = 0; i < 111; i++) {
                circle(
                    rnd(10)+x,
                    rnd(10)+y,
                    rnd(10)+r, i
                );
            }
        }


        if(!depth)
            return

        //r-=5

        let cc = rnd(3)|0 + 2;
        for (let i =0; i<cc; i++){

            let a = 6.283*i/cc + rnd(11)
            let x1 = Math.cos(a)*r+x
            let y1 = Math.sin(a)*r+y
            let r1 = r/2
            circles(x1,y1,r1, depth-1)

        }
    }


    function circle(x,y,r, i){

        ctx.beginPath();

        const pts = 4*r|0

        const shift =  rnd(11)
        for (let i = 0; i < pts; i++){

            const a = 6.283 * i/pts +shift

            const rr = r + Math.sin(a*shape)*r

            const xx = x + Math.cos(a)*rr
            const yy = y + Math.sin(a)*rr

            i?ctx.lineTo(xx,yy):
                ctx.moveTo(xx,yy+rnd(100));


        }



        if(!i){
            ctx.closePath()
            ctx.fill();
        }
        ctx.stroke();


    }

    function bg(n){
        ctx.strokeStyle = `hsla(${rnd(360)},${rnd(100)}%,55%,0.02)`
        const a = rnd(123)
        const px = cos(a)*s*2 + w/2
        const py = sin(a)*s*2 + h/2
        for (let i=0;i<n;i++) {
            ctx.beginPath();
            ctx.moveTo(
                rnd(w)-px,
                rnd(h)-py,
            )
            ctx.lineTo(
                rnd(w),
                rnd(h)
            )
            ctx.stroke()
        }
    }

    function triangles(n){
        for (let i=0;i<33;i++){

            ctx.fillStyle='#fff3'
            ctx.beginPath()
            ctx.moveTo(rnd(w),rnd(h))
            ctx.lineTo(rnd(w),rnd(h))
            ctx.lineTo(rnd(w),rnd(h))
            ctx.fill()
        }
    }

    function frame(n){
        // ctx.fillStyle=`hsla(${rnd(360)},97%,95%,0.1)`
        const sss = s/15
        for (let i=0;i<n;i++){

            ctx.beginPath()
            ctx.moveTo(0,0)
            ctx.lineTo(rnd(sss),0)
            ctx.lineTo(rnd(sss),h)
            ctx.lineTo(0,h)
            ctx.fill()

            ctx.beginPath()
            ctx.moveTo(w,0)
            ctx.lineTo(w-rnd(sss),0)
            ctx.lineTo(w-rnd(sss),h)
            ctx.lineTo(w,h)
            ctx.fill()

            ctx.beginPath()
            ctx.moveTo(0,h)
            ctx.lineTo(0,h-rnd(sss))
            ctx.lineTo(w,h-rnd(sss))
            ctx.lineTo(w,h)
            ctx.fill()

            ctx.beginPath()
            ctx.moveTo(0,0)
            ctx.lineTo(0,rnd(sss))
            ctx.lineTo(w,rnd(sss))
            ctx.lineTo(w,0)
            ctx.fill()
        }
    }


    function planet(n) {
        ctx.strokeWidth =5
        const x = rnd(w*2)-1;
        const y = rnd(h/4)+s*3;
        for (let i=0; i<n; i++) {
            if (Math.random()>0.9)
                ctx.strokeStyle = `hsla(${rnd(360)},${rnd(100)}%,${rnd(100)}%,0.1)`
            ctx.beginPath();
            ctx.arc(x+rnd(s), y+rnd(s), rnd(s)+s*1.4, 0, 2 * Math.PI);
            ctx.stroke();
        }
    }

</script>
</body>
</html>